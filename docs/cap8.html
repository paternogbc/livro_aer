<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 8 Modelos Lineares Generalizados | Análises Ecológicas no R</title>
  <meta name="description" content="Capítulo 8 Modelos Lineares Generalizados | Análises Ecológicas no R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 8 Modelos Lineares Generalizados | Análises Ecológicas no R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 8 Modelos Lineares Generalizados | Análises Ecológicas no R" />
  
  
  



<meta name="date" content="2022-02-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cap7.html"/>
<link rel="next" href="cap9.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análises Ecológicas no R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Capa</a></li>
<li class="chapter" data-level="" data-path="prefácio.html"><a href="prefácio.html"><i class="fa fa-check"></i>Prefácio</a></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html"><i class="fa fa-check"></i>Sobre os autores</a></li>
<li class="chapter" data-level="" data-path="revisores-e-colaboradores.html"><a href="revisores-e-colaboradores.html"><i class="fa fa-check"></i>Revisores e colaboradores</a></li>
<li class="chapter" data-level="1" data-path="cap1.html"><a href="cap1.html"><i class="fa fa-check"></i><b>1</b> Introdução</a>
<ul>
<li class="chapter" data-level="1.1" data-path="cap1.html"><a href="cap1.html#histórico-deste-livro"><i class="fa fa-check"></i><b>1.1</b> Histórico deste livro</a></li>
<li class="chapter" data-level="1.2" data-path="cap1.html"><a href="cap1.html#objetivo-deste-livro"><i class="fa fa-check"></i><b>1.2</b> Objetivo deste livro</a></li>
<li class="chapter" data-level="1.3" data-path="cap1.html"><a href="cap1.html#o-que-você-não-encontrará-neste-livro"><i class="fa fa-check"></i><b>1.3</b> O que você não encontrará neste livro</a></li>
<li class="chapter" data-level="1.4" data-path="cap1.html"><a href="cap1.html#por-que-usar-o-r"><i class="fa fa-check"></i><b>1.4</b> Por que usar o R?</a></li>
<li class="chapter" data-level="1.5" data-path="cap1.html"><a href="cap1.html#indo-além-da-linguagem-de-progração-para-a-ecologia"><i class="fa fa-check"></i><b>1.5</b> Indo além da linguagem de progração para a Ecologia</a></li>
<li class="chapter" data-level="1.6" data-path="cap1.html"><a href="cap1.html#como-usar-este-livro"><i class="fa fa-check"></i><b>1.6</b> Como usar este livro</a></li>
<li class="chapter" data-level="1.7" data-path="cap1.html"><a href="cap1.html#como-ensinar-e-aprender-com-esse-livro"><i class="fa fa-check"></i><b>1.7</b> Como ensinar e aprender com esse livro</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="cap1.html"><a href="cap1.html#em-laboratórios-ou-grupos-de-pesquisa"><i class="fa fa-check"></i><b>1.7.1</b> Em laboratórios ou grupos de pesquisa</a></li>
<li class="chapter" data-level="1.7.2" data-path="cap1.html"><a href="cap1.html#em-disciplinas-da-graduação-ou-pós-graduação"><i class="fa fa-check"></i><b>1.7.2</b> Em disciplinas da graduação ou pós-graduação</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cap2.html"><a href="cap2.html"><i class="fa fa-check"></i><b>2</b> Voltando ao básico: como dominar a arte de fazer perguntas cientificamente relevantes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cap2.html"><a href="cap2.html#introdução"><i class="fa fa-check"></i><b>2.1</b> Introdução</a></li>
<li class="chapter" data-level="2.2" data-path="cap2.html"><a href="cap2.html#perguntas-devem-preceder-as-análises-estatísticas"><i class="fa fa-check"></i><b>2.2</b> Perguntas devem preceder as análises estatísticas</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="cap2.html"><a href="cap2.html#um-bestiárioperguntas_ecologia-1-para-o-teste-de-hipóteses-você-está-fazendo-a-pergunta-certa"><i class="fa fa-check"></i><b>2.2.1</b> Um bestiário para o teste de hipóteses (Você está fazendo a pergunta certa?)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cap2.html"><a href="cap2.html#fluxograma-conectando-variáveis-para-melhorar-o-desenho-experimental-e-as-análises-estatísticas"><i class="fa fa-check"></i><b>2.3</b> Fluxograma: Conectando variáveis para melhorar o desenho experimental e as análises estatísticas</a></li>
<li class="chapter" data-level="2.4" data-path="cap2.html"><a href="cap2.html#questões-fundamentais-em-etnobiologia-ecologia-e-conservação"><i class="fa fa-check"></i><b>2.4</b> Questões fundamentais em etnobiologia, ecologia e conservação</a></li>
<li class="chapter" data-level="2.5" data-path="cap2.html"><a href="cap2.html#considerações-finais"><i class="fa fa-check"></i><b>2.5</b> Considerações Finais</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cap3.html"><a href="cap3.html"><i class="fa fa-check"></i><b>3</b> Pré-requisitos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cap3.html"><a href="cap3.html#introdução-1"><i class="fa fa-check"></i><b>3.1</b> Introdução</a></li>
<li class="chapter" data-level="3.2" data-path="cap3.html"><a href="cap3.html#instalação-do-r"><i class="fa fa-check"></i><b>3.2</b> Instalação do R</a></li>
<li class="chapter" data-level="3.3" data-path="cap3.html"><a href="cap3.html#instalação-do-rstudio"><i class="fa fa-check"></i><b>3.3</b> Instalação do RStudio</a></li>
<li class="chapter" data-level="3.4" data-path="cap3.html"><a href="cap3.html#versão-do-r"><i class="fa fa-check"></i><b>3.4</b> Versão do R</a></li>
<li class="chapter" data-level="3.5" data-path="cap3.html"><a href="cap3.html#pacotes"><i class="fa fa-check"></i><b>3.5</b> Pacotes</a></li>
<li class="chapter" data-level="3.6" data-path="cap3.html"><a href="cap3.html#dados"><i class="fa fa-check"></i><b>3.6</b> Dados</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cap4.html"><a href="cap4.html"><i class="fa fa-check"></i><b>4</b> Introdução ao R</a>
<ul>
<li class="chapter" data-level="" data-path="cap4.html"><a href="cap4.html#pré-requisitos-do-capítulo"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="4.1" data-path="cap4.html"><a href="cap4.html#contextualização"><i class="fa fa-check"></i><b>4.1</b> Contextualização</a></li>
<li class="chapter" data-level="4.2" data-path="cap4.html"><a href="cap4.html#r-e-rstudio"><i class="fa fa-check"></i><b>4.2</b> R e RStudio</a></li>
<li class="chapter" data-level="4.3" data-path="cap4.html"><a href="cap4.html#funcionamento-da-linguagem-r"><i class="fa fa-check"></i><b>4.3</b> Funcionamento da linguagem R</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="cap4.html"><a href="cap4.html#console"><i class="fa fa-check"></i><b>4.3.1</b> Console</a></li>
<li class="chapter" data-level="4.3.2" data-path="cap4.html"><a href="cap4.html#scripts"><i class="fa fa-check"></i><b>4.3.2</b> Scripts</a></li>
<li class="chapter" data-level="4.3.3" data-path="cap4.html"><a href="cap4.html#operadores"><i class="fa fa-check"></i><b>4.3.3</b> Operadores</a></li>
<li class="chapter" data-level="4.3.4" data-path="cap4.html"><a href="cap4.html#objetos"><i class="fa fa-check"></i><b>4.3.4</b> Objetos</a></li>
<li class="chapter" data-level="4.3.5" data-path="cap4.html"><a href="cap4.html#funções"><i class="fa fa-check"></i><b>4.3.5</b> Funções</a></li>
<li class="chapter" data-level="4.3.6" data-path="cap4.html"><a href="cap4.html#pacotes-1"><i class="fa fa-check"></i><b>4.3.6</b> Pacotes</a></li>
<li class="chapter" data-level="4.3.7" data-path="cap4.html"><a href="cap4.html#ajuda-help"><i class="fa fa-check"></i><b>4.3.7</b> Ajuda (<em>Help</em>)</a></li>
<li class="chapter" data-level="4.3.8" data-path="cap4.html"><a href="cap4.html#ambiente-environment"><i class="fa fa-check"></i><b>4.3.8</b> Ambiente (<em>Environment</em>)</a></li>
<li class="chapter" data-level="4.3.9" data-path="cap4.html"><a href="cap4.html#citações"><i class="fa fa-check"></i><b>4.3.9</b> Citações</a></li>
<li class="chapter" data-level="4.3.10" data-path="cap4.html"><a href="cap4.html#principais-erros-de-iniciantes"><i class="fa fa-check"></i><b>4.3.10</b> Principais erros de iniciantes</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="cap4.html"><a href="cap4.html#estrutura-e-manipulação-de-objetos"><i class="fa fa-check"></i><b>4.4</b> Estrutura e manipulação de objetos</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="cap4.html"><a href="cap4.html#atributo-dos-objetos"><i class="fa fa-check"></i><b>4.4.1</b> Atributo dos objetos</a></li>
<li class="chapter" data-level="4.4.2" data-path="cap4.html"><a href="cap4.html#manipulação-de-objetos-unidimensionais"><i class="fa fa-check"></i><b>4.4.2</b> Manipulação de objetos unidimensionais</a></li>
<li class="chapter" data-level="4.4.3" data-path="cap4.html"><a href="cap4.html#manipulação-de-objetos-multidimensionais"><i class="fa fa-check"></i><b>4.4.3</b> Manipulação de objetos multidimensionais</a></li>
<li class="chapter" data-level="4.4.4" data-path="cap4.html"><a href="cap4.html#valores-faltantes-e-especiais"><i class="fa fa-check"></i><b>4.4.4</b> Valores faltantes e especiais</a></li>
<li class="chapter" data-level="4.4.5" data-path="cap4.html"><a href="cap4.html#diretório-de-trabalho"><i class="fa fa-check"></i><b>4.4.5</b> Diretório de trabalho</a></li>
<li class="chapter" data-level="4.4.6" data-path="cap4.html"><a href="cap4.html#importar-dados"><i class="fa fa-check"></i><b>4.4.6</b> Importar dados</a></li>
<li class="chapter" data-level="4.4.7" data-path="cap4.html"><a href="cap4.html#conferência-dos-dados-importados"><i class="fa fa-check"></i><b>4.4.7</b> Conferência dos dados importados</a></li>
<li class="chapter" data-level="4.4.8" data-path="cap4.html"><a href="cap4.html#exportar-dados"><i class="fa fa-check"></i><b>4.4.8</b> Exportar dados</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="cap4.html"><a href="cap4.html#exercícios"><i class="fa fa-check"></i><b>4.5</b> Exercícios</a></li>
<li class="chapter" data-level="4.6" data-path="cap4.html"><a href="cap4.html#para-se-aprofundar"><i class="fa fa-check"></i><b>4.6</b> Para se aprofundar</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="cap4.html"><a href="cap4.html#livros"><i class="fa fa-check"></i><b>4.6.1</b> Livros</a></li>
<li class="chapter" data-level="4.6.2" data-path="cap4.html"><a href="cap4.html#links"><i class="fa fa-check"></i><b>4.6.2</b> Links</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cap5.html"><a href="cap5.html"><i class="fa fa-check"></i><b>5</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="" data-path="cap5.html"><a href="cap5.html#pré-requisitos-do-capítulo-1"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="5.1" data-path="cap5.html"><a href="cap5.html#contextualização-1"><i class="fa fa-check"></i><b>5.1</b> Contextualização</a></li>
<li class="chapter" data-level="5.2" data-path="cap5.html"><a href="cap5.html#tidyverse"><i class="fa fa-check"></i><b>5.2</b> <em>tidyverse</em></a></li>
<li class="chapter" data-level="5.3" data-path="cap5.html"><a href="cap5.html#here"><i class="fa fa-check"></i><b>5.3</b> here</a></li>
<li class="chapter" data-level="5.4" data-path="cap5.html"><a href="cap5.html#readr-readxl-e-writexl"><i class="fa fa-check"></i><b>5.4</b> readr, readxl e writexl</a></li>
<li class="chapter" data-level="5.5" data-path="cap5.html"><a href="cap5.html#tibble"><i class="fa fa-check"></i><b>5.5</b> tibble</a></li>
<li class="chapter" data-level="5.6" data-path="cap5.html"><a href="cap5.html#magrittr-pipe--"><i class="fa fa-check"></i><b>5.6</b> magrittr (pipe - %&gt;%)</a></li>
<li class="chapter" data-level="5.7" data-path="cap5.html"><a href="cap5.html#tidyr"><i class="fa fa-check"></i><b>5.7</b> tidyr</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="cap5.html"><a href="cap5.html#palmerpenguins"><i class="fa fa-check"></i><b>5.7.1</b> palmerpenguins</a></li>
<li class="chapter" data-level="5.7.2" data-path="cap5.html"><a href="cap5.html#glimpse"><i class="fa fa-check"></i><b>5.7.2</b> glimpse()</a></li>
<li class="chapter" data-level="5.7.3" data-path="cap5.html"><a href="cap5.html#unite"><i class="fa fa-check"></i><b>5.7.3</b> unite()</a></li>
<li class="chapter" data-level="5.7.4" data-path="cap5.html"><a href="cap5.html#separate"><i class="fa fa-check"></i><b>5.7.4</b> separate()</a></li>
<li class="chapter" data-level="5.7.5" data-path="cap5.html"><a href="cap5.html#drop_na-e-replace_na"><i class="fa fa-check"></i><b>5.7.5</b> drop_na() e replace_na()</a></li>
<li class="chapter" data-level="5.7.6" data-path="cap5.html"><a href="cap5.html#pivot_longer-e-pivot_wider"><i class="fa fa-check"></i><b>5.7.6</b> pivot_longer() e pivot_wider()</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="cap5.html"><a href="cap5.html#dplyr"><i class="fa fa-check"></i><b>5.8</b> dplyr</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="cap5.html"><a href="cap5.html#gramática"><i class="fa fa-check"></i><b>5.8.1</b> Gramática</a></li>
<li class="chapter" data-level="5.8.2" data-path="cap5.html"><a href="cap5.html#sintaxe"><i class="fa fa-check"></i><b>5.8.2</b> Sintaxe</a></li>
<li class="chapter" data-level="5.8.3" data-path="cap5.html"><a href="cap5.html#palmerpenguins-1"><i class="fa fa-check"></i><b>5.8.3</b> palmerpenguins</a></li>
<li class="chapter" data-level="5.8.4" data-path="cap5.html"><a href="cap5.html#relocate"><i class="fa fa-check"></i><b>5.8.4</b> relocate()</a></li>
<li class="chapter" data-level="5.8.5" data-path="cap5.html"><a href="cap5.html#rename"><i class="fa fa-check"></i><b>5.8.5</b> rename()</a></li>
<li class="chapter" data-level="5.8.6" data-path="cap5.html"><a href="cap5.html#select"><i class="fa fa-check"></i><b>5.8.6</b> select()</a></li>
<li class="chapter" data-level="5.8.7" data-path="cap5.html"><a href="cap5.html#pull"><i class="fa fa-check"></i><b>5.8.7</b> pull()</a></li>
<li class="chapter" data-level="5.8.8" data-path="cap5.html"><a href="cap5.html#mutate"><i class="fa fa-check"></i><b>5.8.8</b> mutate()</a></li>
<li class="chapter" data-level="5.8.9" data-path="cap5.html"><a href="cap5.html#arrange"><i class="fa fa-check"></i><b>5.8.9</b> arrange()</a></li>
<li class="chapter" data-level="5.8.10" data-path="cap5.html"><a href="cap5.html#filter"><i class="fa fa-check"></i><b>5.8.10</b> filter()</a></li>
<li class="chapter" data-level="5.8.11" data-path="cap5.html"><a href="cap5.html#slice"><i class="fa fa-check"></i><b>5.8.11</b> slice()</a></li>
<li class="chapter" data-level="5.8.12" data-path="cap5.html"><a href="cap5.html#distinct"><i class="fa fa-check"></i><b>5.8.12</b> distinct()</a></li>
<li class="chapter" data-level="5.8.13" data-path="cap5.html"><a href="cap5.html#count"><i class="fa fa-check"></i><b>5.8.13</b> count()</a></li>
<li class="chapter" data-level="5.8.14" data-path="cap5.html"><a href="cap5.html#group_by"><i class="fa fa-check"></i><b>5.8.14</b> group_by()</a></li>
<li class="chapter" data-level="5.8.15" data-path="cap5.html"><a href="cap5.html#summarise"><i class="fa fa-check"></i><b>5.8.15</b> summarise()</a></li>
<li class="chapter" data-level="5.8.16" data-path="cap5.html"><a href="cap5.html#bind_rows-e-bind_cols"><i class="fa fa-check"></i><b>5.8.16</b> bind_rows() e bind_cols()</a></li>
<li class="chapter" data-level="5.8.17" data-path="cap5.html"><a href="cap5.html#join"><i class="fa fa-check"></i><b>5.8.17</b> *_join()</a></li>
<li class="chapter" data-level="5.8.18" data-path="cap5.html"><a href="cap5.html#operações-de-conjuntos-e-comparação-de-dados"><i class="fa fa-check"></i><b>5.8.18</b> Operações de conjuntos e comparação de dados</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="cap5.html"><a href="cap5.html#stringr"><i class="fa fa-check"></i><b>5.9</b> stringr</a></li>
<li class="chapter" data-level="5.10" data-path="cap5.html"><a href="cap5.html#forcats"><i class="fa fa-check"></i><b>5.10</b> forcats</a></li>
<li class="chapter" data-level="5.11" data-path="cap5.html"><a href="cap5.html#lubridate"><i class="fa fa-check"></i><b>5.11</b> lubridate</a></li>
<li class="chapter" data-level="5.12" data-path="cap5.html"><a href="cap5.html#purrr"><i class="fa fa-check"></i><b>5.12</b> purrr</a></li>
<li class="chapter" data-level="5.13" data-path="cap5.html"><a href="cap5.html#exercícios-1"><i class="fa fa-check"></i><b>5.13</b> Exercícios</a></li>
<li class="chapter" data-level="5.14" data-path="cap5.html"><a href="cap5.html#para-se-aprofundar-1"><i class="fa fa-check"></i><b>5.14</b> Para se aprofundar</a>
<ul>
<li class="chapter" data-level="5.14.1" data-path="cap5.html"><a href="cap5.html#livros-1"><i class="fa fa-check"></i><b>5.14.1</b> Livros</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cap6.html"><a href="cap6.html"><i class="fa fa-check"></i><b>6</b> Visualização de dados</a>
<ul>
<li class="chapter" data-level="" data-path="cap6.html"><a href="cap6.html#pré-requisitos-do-capítulo-2"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="6.1" data-path="cap6.html"><a href="cap6.html#contextualização-2"><i class="fa fa-check"></i><b>6.1</b> Contextualização</a></li>
<li class="chapter" data-level="6.2" data-path="cap6.html"><a href="cap6.html#principais-pacotes"><i class="fa fa-check"></i><b>6.2</b> Principais pacotes</a></li>
<li class="chapter" data-level="6.3" data-path="cap6.html"><a href="cap6.html#grámatica-dos-gráficos"><i class="fa fa-check"></i><b>6.3</b> Grámatica dos gráficos</a></li>
<li class="chapter" data-level="6.4" data-path="cap6.html"><a href="cap6.html#tipos-de-gráficos"><i class="fa fa-check"></i><b>6.4</b> Tipos de gráficos</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="cap6.html"><a href="cap6.html#histograma-histogram"><i class="fa fa-check"></i><b>6.4.1</b> Histograma (<em>histogram</em>)</a></li>
<li class="chapter" data-level="6.4.2" data-path="cap6.html"><a href="cap6.html#gráfico-de-densidade-density-plot"><i class="fa fa-check"></i><b>6.4.2</b> Gráfico de densidade (<em>density plot</em>)</a></li>
<li class="chapter" data-level="6.4.3" data-path="cap6.html"><a href="cap6.html#diagrama-de-pontos-dot-plot"><i class="fa fa-check"></i><b>6.4.3</b> Diagrama de pontos (<em>dot plot</em>)</a></li>
<li class="chapter" data-level="6.4.4" data-path="cap6.html"><a href="cap6.html#gráfico-de-barras-bar-plot"><i class="fa fa-check"></i><b>6.4.4</b> Gráfico de barras (<em>bar plot</em>)</a></li>
<li class="chapter" data-level="6.4.5" data-path="cap6.html"><a href="cap6.html#gráfico-de-setores-pie-chart-e-donut-chart"><i class="fa fa-check"></i><b>6.4.5</b> Gráfico de setores (<em>pie chart</em> e <em>donut chart</em>)</a></li>
<li class="chapter" data-level="6.4.6" data-path="cap6.html"><a href="cap6.html#gráfico-de-caixa-boxplot"><i class="fa fa-check"></i><b>6.4.6</b> Gráfico de caixa (<em>boxplot</em>)</a></li>
<li class="chapter" data-level="6.4.7" data-path="cap6.html"><a href="cap6.html#gráfico-de-dispersão-scatter-plot"><i class="fa fa-check"></i><b>6.4.7</b> Gráfico de dispersão (<em>scatter plot</em>)</a></li>
<li class="chapter" data-level="6.4.8" data-path="cap6.html"><a href="cap6.html#visualização-de-múltiplos-gráficos-pareados"><i class="fa fa-check"></i><b>6.4.8</b> Visualização de múltiplos gráficos pareados</a></li>
<li class="chapter" data-level="6.4.9" data-path="cap6.html"><a href="cap6.html#erros-comuns-dos-usuários-do-ggplot2-e-como-evitá-los"><i class="fa fa-check"></i><b>6.4.9</b> Erros comuns dos usuários do <code>ggplot2</code> e como evitá-los</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="cap6.html"><a href="cap6.html#finalização-de-gráficos-para-publicação"><i class="fa fa-check"></i><b>6.5</b> Finalização de gráficos para publicação</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="cap6.html"><a href="cap6.html#posição-cores-e-fonte-da-legenda"><i class="fa fa-check"></i><b>6.5.1</b> Posição, cores e fonte da legenda</a></li>
<li class="chapter" data-level="6.5.2" data-path="cap6.html"><a href="cap6.html#elementos-gráficos-eixo-fonte-gride"><i class="fa fa-check"></i><b>6.5.2</b> Elementos gráficos: eixo, fonte, gride</a></li>
<li class="chapter" data-level="6.5.3" data-path="cap6.html"><a href="cap6.html#temas-personalizados-ggtheme"><i class="fa fa-check"></i><b>6.5.3</b> Temas personalizados <code>ggtheme()</code></a></li>
<li class="chapter" data-level="6.5.4" data-path="cap6.html"><a href="cap6.html#criando-seu-próprio-theme_custom"><i class="fa fa-check"></i><b>6.5.4</b> Criando seu próprio <code>theme_custom()</code></a></li>
<li class="chapter" data-level="6.5.5" data-path="cap6.html"><a href="cap6.html#exportando-dados-com-alta-qualidade-com-a-função-ggsave"><i class="fa fa-check"></i><b>6.5.5</b> Exportando dados com alta qualidade com a função <code>ggsave()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="cap6.html"><a href="cap6.html#para-se-aprofundar-2"><i class="fa fa-check"></i><b>6.6</b> Para se aprofundar</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="cap6.html"><a href="cap6.html#livros-2"><i class="fa fa-check"></i><b>6.6.1</b> Livros</a></li>
<li class="chapter" data-level="6.6.2" data-path="cap6.html"><a href="cap6.html#links-1"><i class="fa fa-check"></i><b>6.6.2</b> Links</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="cap7.html"><a href="cap7.html"><i class="fa fa-check"></i><b>7</b> Modelos lineares</a>
<ul>
<li class="chapter" data-level="" data-path="cap7.html"><a href="cap7.html#pré-requisitos-do-capítulo-3"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="7.1" data-path="cap7.html"><a href="cap7.html#teste-t-de-student-para-duas-amostras-independentes"><i class="fa fa-check"></i><b>7.1</b> Teste T (de Student) para duas amostras independentes</a></li>
<li class="chapter" data-level="7.2" data-path="cap7.html"><a href="cap7.html#teste-t-para-amostras-pareadas"><i class="fa fa-check"></i><b>7.2</b> Teste T para amostras pareadas</a></li>
<li class="chapter" data-level="7.3" data-path="cap7.html"><a href="cap7.html#correlação-de-pearson"><i class="fa fa-check"></i><b>7.3</b> Correlação de Pearson</a></li>
<li class="chapter" data-level="7.4" data-path="cap7.html"><a href="cap7.html#regressão-linear-simples"><i class="fa fa-check"></i><b>7.4</b> Regressão Linear Simples</a></li>
<li class="chapter" data-level="7.5" data-path="cap7.html"><a href="cap7.html#regressão-linear-múltipla"><i class="fa fa-check"></i><b>7.5</b> Regressão Linear Múltipla</a></li>
<li class="chapter" data-level="7.6" data-path="cap7.html"><a href="cap7.html#análises-de-variância-anova"><i class="fa fa-check"></i><b>7.6</b> Análises de Variância (ANOVA)</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="cap7.html"><a href="cap7.html#anova-de-um-fator"><i class="fa fa-check"></i><b>7.6.1</b> ANOVA de um fator</a></li>
<li class="chapter" data-level="7.6.2" data-path="cap7.html"><a href="cap7.html#anova-com-dois-fatores-ou-anova-fatorial"><i class="fa fa-check"></i><b>7.6.2</b> ANOVA com dois fatores ou ANOVA fatorial</a></li>
<li class="chapter" data-level="7.6.3" data-path="cap7.html"><a href="cap7.html#anova-em-blocos-aleatorizados"><i class="fa fa-check"></i><b>7.6.3</b> ANOVA em blocos aleatorizados</a></li>
<li class="chapter" data-level="7.6.4" data-path="cap7.html"><a href="cap7.html#análise-de-covariância-ancova"><i class="fa fa-check"></i><b>7.6.4</b> Análise de covariância (ANCOVA)</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="cap7.html"><a href="cap7.html#generalized-least-squares-gls"><i class="fa fa-check"></i><b>7.7</b> Generalized Least Squares (GLS)</a></li>
<li class="chapter" data-level="7.8" data-path="cap7.html"><a href="cap7.html#para-se-aprofundar-3"><i class="fa fa-check"></i><b>7.8</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cap8.html"><a href="cap8.html"><i class="fa fa-check"></i><b>8</b> Modelos Lineares Generalizados</a>
<ul>
<li class="chapter" data-level="" data-path="cap8.html"><a href="cap8.html#pré-requisitos-do-capítulo-4"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="8.1" data-path="cap8.html"><a href="cap8.html#introdução-2"><i class="fa fa-check"></i><b>8.1</b> Introdução</a></li>
<li class="chapter" data-level="8.2" data-path="cap8.html"><a href="cap8.html#como-um-glm-funciona"><i class="fa fa-check"></i><b>8.2</b> Como um GLM funciona?</a></li>
<li class="chapter" data-level="8.3" data-path="cap8.html"><a href="cap8.html#como-escolher-a-distribuição-correta-para-seus-dados"><i class="fa fa-check"></i><b>8.3</b> Como escolher a distribuição correta para seus dados?</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="cap8.html"><a href="cap8.html#para-dados-contínuos"><i class="fa fa-check"></i><b>8.3.1</b> Para dados contínuos</a></li>
<li class="chapter" data-level="8.3.2" data-path="cap8.html"><a href="cap8.html#para-dados-de-contagem"><i class="fa fa-check"></i><b>8.3.2</b> Para dados de contagem</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="cap8.html"><a href="cap8.html#dados-de-contagem-a-distribuição-de-poisson"><i class="fa fa-check"></i><b>8.4</b> Dados de contagem: a distribuição de Poisson</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="cap8.html"><a href="cap8.html#o-que-causa-a-overdispersion"><i class="fa fa-check"></i><b>8.4.1</b> O que causa a <em>overdispersion</em>?</a></li>
<li class="chapter" data-level="8.4.2" data-path="cap8.html"><a href="cap8.html#o-que-fazer-se-seu-modelo-tiver-overdispersion"><i class="fa fa-check"></i><b>8.4.2</b> O que fazer se seu modelo tiver <em>overdispersion</em>?</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="cap8.html"><a href="cap8.html#dados-de-contagem-modelos-quasi-likelihood"><i class="fa fa-check"></i><b>8.5</b> Dados de contagem: modelos quasi-likelihood</a></li>
<li class="chapter" data-level="8.6" data-path="cap8.html"><a href="cap8.html#dados-de-contagem-a-distribuição-binomial"><i class="fa fa-check"></i><b>8.6</b> Dados de contagem: a distribuição binomial</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="cap8.html"><a href="cap8.html#análise-com-dados-de-proporção"><i class="fa fa-check"></i><b>8.6.1</b> Análise com dados de proporção</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="cap8.html"><a href="cap8.html#análise-com-dados-de-incidência"><i class="fa fa-check"></i><b>8.7</b> Análise com dados de incidência</a></li>
<li class="chapter" data-level="8.8" data-path="cap8.html"><a href="cap8.html#dados-de-contagem-com-excesso-de-zeros"><i class="fa fa-check"></i><b>8.8</b> Dados de contagem com excesso de zeros</a></li>
<li class="chapter" data-level="8.9" data-path="cap8.html"><a href="cap8.html#dados-ordinais-os-modelos-cumulative-link"><i class="fa fa-check"></i><b>8.9</b> Dados ordinais: os modelos cumulative link</a></li>
<li class="chapter" data-level="8.10" data-path="cap8.html"><a href="cap8.html#dados-contínuos-distribuição-beta"><i class="fa fa-check"></i><b>8.10</b> Dados contínuos: distribuição beta</a></li>
<li class="chapter" data-level="8.11" data-path="cap8.html"><a href="cap8.html#para-se-aprofundar-4"><i class="fa fa-check"></i><b>8.11</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cap9.html"><a href="cap9.html"><i class="fa fa-check"></i><b>9</b> Análises Multidimensionais</a>
<ul>
<li class="chapter" data-level="" data-path="cap9.html"><a href="cap9.html#pré-requisitos-do-capítulo-5"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="9.1" data-path="cap9.html"><a href="cap9.html#aspectos-teóricos"><i class="fa fa-check"></i><b>9.1</b> Aspectos teóricos</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="cap9.html"><a href="cap9.html#coeficientes-de-associação"><i class="fa fa-check"></i><b>9.1.1</b> Coeficientes de associação</a></li>
<li class="chapter" data-level="9.1.2" data-path="cap9.html"><a href="cap9.html#métricas-de-distância"><i class="fa fa-check"></i><b>9.1.2</b> Métricas de distância</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="cap9.html"><a href="cap9.html#análises-de-agrupamento"><i class="fa fa-check"></i><b>9.2</b> Análises de agrupamento</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="cap9.html"><a href="cap9.html#agrupamento-hierárquico"><i class="fa fa-check"></i><b>9.2.1</b> Agrupamento hierárquico</a></li>
<li class="chapter" data-level="9.2.2" data-path="cap9.html"><a href="cap9.html#agrupamento-não-hierárquico-k-means"><i class="fa fa-check"></i><b>9.2.2</b> Agrupamento não-hierárquico (<em>K-means</em>)</a></li>
<li class="chapter" data-level="9.2.3" data-path="cap9.html"><a href="cap9.html#espécies-indicadoras"><i class="fa fa-check"></i><b>9.2.3</b> Espécies indicadoras</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="cap9.html"><a href="cap9.html#análises-de-ordenação"><i class="fa fa-check"></i><b>9.3</b> Análises de Ordenação</a></li>
<li class="chapter" data-level="9.4" data-path="cap9.html"><a href="cap9.html#ordenação-irrestrira"><i class="fa fa-check"></i><b>9.4</b> Ordenação irrestrira</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="cap9.html"><a href="cap9.html#análise-de-componentes-principais-pca"><i class="fa fa-check"></i><b>9.4.1</b> Análise de Componentes Principais (PCA)</a></li>
<li class="chapter" data-level="9.4.2" data-path="cap9.html"><a href="cap9.html#análises-de-coordenadas-principais-pcoa"><i class="fa fa-check"></i><b>9.4.2</b> Análises de Coordenadas Principais (PCoA)</a></li>
<li class="chapter" data-level="9.4.3" data-path="cap9.html"><a href="cap9.html#regressão-de-componentes-principais-pcr"><i class="fa fa-check"></i><b>9.4.3</b> Regressão de Componentes Principais (PCR)</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="cap9.html"><a href="cap9.html#ordenação-restrita"><i class="fa fa-check"></i><b>9.5</b> Ordenação restrita</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="cap9.html"><a href="cap9.html#análise-de-redundância-rda"><i class="fa fa-check"></i><b>9.5.1</b> Análise de Redundância (RDA)</a></li>
<li class="chapter" data-level="9.5.2" data-path="cap9.html"><a href="cap9.html#análise-de-redundância-parcial-rdap"><i class="fa fa-check"></i><b>9.5.2</b> Análise de Redundância parcial (RDAp)</a></li>
<li class="chapter" data-level="9.5.3" data-path="cap9.html"><a href="cap9.html#análise-de-redundância-baseada-em-distância-db-rda"><i class="fa fa-check"></i><b>9.5.3</b> Análise de Redundância baseada em distância (db-RDA)</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="cap9.html"><a href="cap9.html#permanova"><i class="fa fa-check"></i><b>9.6</b> PERMANOVA</a></li>
<li class="chapter" data-level="9.7" data-path="cap9.html"><a href="cap9.html#mantel-e-mantel-parcial"><i class="fa fa-check"></i><b>9.7</b> Mantel e Mantel parcial</a></li>
<li class="chapter" data-level="9.8" data-path="cap9.html"><a href="cap9.html#mantel-espacial-com-modelo-nulo-restrito-considerando-autocorrelação-espacial"><i class="fa fa-check"></i><b>9.8</b> Mantel espacial com modelo nulo restrito considerando autocorrelação espacial</a></li>
<li class="chapter" data-level="9.9" data-path="cap9.html"><a href="cap9.html#procrustes-e-protest"><i class="fa fa-check"></i><b>9.9</b> PROCRUSTES e PROTEST</a></li>
<li class="chapter" data-level="9.10" data-path="cap9.html"><a href="cap9.html#métodos-multivariados-baseados-em-modelos"><i class="fa fa-check"></i><b>9.10</b> Métodos multivariados baseados em modelos</a></li>
<li class="chapter" data-level="9.11" data-path="cap9.html"><a href="cap9.html#para-se-aprofundar-5"><i class="fa fa-check"></i><b>9.11</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cap10.html"><a href="cap10.html"><i class="fa fa-check"></i><b>10</b> Rarefação</a>
<ul>
<li class="chapter" data-level="" data-path="cap10.html"><a href="cap10.html#pré-requisitos-do-capítulo-6"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="10.1" data-path="cap10.html"><a href="cap10.html#aspectos-teóricos-1"><i class="fa fa-check"></i><b>10.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="10.2" data-path="cap10.html"><a href="cap10.html#curva-de-rarefação-baseada-no-indivíduo-individual-based"><i class="fa fa-check"></i><b>10.2</b> Curva de rarefação baseada no indivíduo (<em>individual-based</em>)</a></li>
<li class="chapter" data-level="10.3" data-path="cap10.html"><a href="cap10.html#curva-de-rarefação-baseada-em-amostras-sample-based"><i class="fa fa-check"></i><b>10.3</b> Curva de rarefação baseada em amostras (<em>sample-based</em>)</a></li>
<li class="chapter" data-level="10.4" data-path="cap10.html"><a href="cap10.html#curva-de-rarefação-coverage-based"><i class="fa fa-check"></i><b>10.4</b> Curva de rarefação <em>coverage-based</em></a></li>
<li class="chapter" data-level="10.5" data-path="cap10.html"><a href="cap10.html#para-se-aprofundar-6"><i class="fa fa-check"></i><b>10.5</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="cap11.html"><a href="cap11.html"><i class="fa fa-check"></i><b>11</b> Estimadores de riqueza</a>
<ul>
<li class="chapter" data-level="" data-path="cap11.html"><a href="cap11.html#pré-requisitos-do-capítulo-7"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="11.1" data-path="cap11.html"><a href="cap11.html#aspectos-teóricos-2"><i class="fa fa-check"></i><b>11.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="11.2" data-path="cap11.html"><a href="cap11.html#estimadores-baseados-na-abundância-das-espécies"><i class="fa fa-check"></i><b>11.2</b> Estimadores baseados na abundância das espécies</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="cap11.html"><a href="cap11.html#chao-1"><i class="fa fa-check"></i><b>11.2.1</b> CHAO 1</a></li>
<li class="chapter" data-level="11.2.2" data-path="cap11.html"><a href="cap11.html#ace---abundance-based-coverage-estimador"><i class="fa fa-check"></i><b>11.2.2</b> ACE - <em>Abundance-based Coverage Estimador</em></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="cap11.html"><a href="cap11.html#estimadores-baseados-na-incidência-das-espécies"><i class="fa fa-check"></i><b>11.3</b> Estimadores baseados na incidência das espécies</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="cap11.html"><a href="cap11.html#chao-2"><i class="fa fa-check"></i><b>11.3.1</b> CHAO 2</a></li>
<li class="chapter" data-level="11.3.2" data-path="cap11.html"><a href="cap11.html#jackknife-1"><i class="fa fa-check"></i><b>11.3.2</b> JACKKNIFE 1</a></li>
<li class="chapter" data-level="11.3.3" data-path="cap11.html"><a href="cap11.html#jackknife-2"><i class="fa fa-check"></i><b>11.3.3</b> JACKKNIFE 2</a></li>
<li class="chapter" data-level="11.3.4" data-path="cap11.html"><a href="cap11.html#bootstrap"><i class="fa fa-check"></i><b>11.3.4</b> BOOTSTRAP</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="cap11.html"><a href="cap11.html#interpolação-e-extrapolação-baseadas-em-rarefação-usando-amostragens-de-incidência-ou-abundância"><i class="fa fa-check"></i><b>11.4</b> Interpolação e extrapolação baseadas em rarefação usando amostragens de incidência ou abundância</a></li>
<li class="chapter" data-level="11.5" data-path="cap11.html"><a href="cap11.html#para-se-aprofundar-7"><i class="fa fa-check"></i><b>11.5</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="cap12.html"><a href="cap12.html"><i class="fa fa-check"></i><b>12</b> Diversidade Taxonômica</a>
<ul>
<li class="chapter" data-level="" data-path="cap12.html"><a href="cap12.html#pré-requisitos-do-capítulo-8"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="12.1" data-path="cap12.html"><a href="cap12.html#aspectos-teóricos-3"><i class="fa fa-check"></i><b>12.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="12.2" data-path="cap12.html"><a href="cap12.html#diversidade-alfa"><i class="fa fa-check"></i><b>12.2</b> Diversidade alfa</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="cap12.html"><a href="cap12.html#riqueza-de-espécies-ou-número-de-espécies"><i class="fa fa-check"></i><b>12.2.1</b> Riqueza de espécies ou número de espécies</a></li>
<li class="chapter" data-level="12.2.2" data-path="cap12.html"><a href="cap12.html#diversidade-de-espécies"><i class="fa fa-check"></i><b>12.2.2</b> Diversidade de espécies</a></li>
<li class="chapter" data-level="12.2.3" data-path="cap12.html"><a href="cap12.html#diagramas-de-whittaker-ou-curva-de-dominância"><i class="fa fa-check"></i><b>12.2.3</b> Diagramas de Whittaker ou Curva de Dominância</a></li>
<li class="chapter" data-level="12.2.4" data-path="cap12.html"><a href="cap12.html#curvas-de-distribuição-de-abundâncias"><i class="fa fa-check"></i><b>12.2.4</b> Curvas de distribuição de abundâncias</a></li>
<li class="chapter" data-level="12.2.5" data-path="cap12.html"><a href="cap12.html#números-de-hill-ou-série-de-hill"><i class="fa fa-check"></i><b>12.2.5</b> Números de Hill ou Série de Hill</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="cap12.html"><a href="cap12.html#diversidade-beta"><i class="fa fa-check"></i><b>12.3</b> Diversidade beta</a></li>
<li class="chapter" data-level="12.4" data-path="cap12.html"><a href="cap12.html#para-se-aprofundar-8"><i class="fa fa-check"></i><b>12.4</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="cap13.html"><a href="cap13.html"><i class="fa fa-check"></i><b>13</b> Diversidade Filogenética</a>
<ul>
<li class="chapter" data-level="" data-path="cap13.html"><a href="cap13.html#pré-requisitos-do-capítulo-9"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="13.1" data-path="cap13.html"><a href="cap13.html#aspectos-teóricos-4"><i class="fa fa-check"></i><b>13.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="13.2" data-path="cap13.html"><a href="cap13.html#manipulação-de-filogenias"><i class="fa fa-check"></i><b>13.2</b> Manipulação de filogenias</a></li>
<li class="chapter" data-level="13.3" data-path="cap13.html"><a href="cap13.html#métricas-de-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>13.3</b> Métricas de diversidade alfa filogenética</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="cap13.html"><a href="cap13.html#riqueza-da-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>13.3.1</b> Riqueza da diversidade alfa filogenética</a></li>
<li class="chapter" data-level="13.3.2" data-path="cap13.html"><a href="cap13.html#divergência-da-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>13.3.2</b> Divergência da diversidade alfa filogenética</a></li>
<li class="chapter" data-level="13.3.3" data-path="cap13.html"><a href="cap13.html#regularidade-da-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>13.3.3</b> Regularidade da diversidade alfa filogenética</a></li>
<li class="chapter" data-level="13.3.4" data-path="cap13.html"><a href="cap13.html#correlação-entre-as-métricas-de-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>13.3.4</b> Correlação entre as métricas de diversidade alfa filogenética</a></li>
<li class="chapter" data-level="13.3.5" data-path="cap13.html"><a href="cap13.html#associação-entre-a-diversidade-alfa-filogenética-e-o-ambiente"><i class="fa fa-check"></i><b>13.3.5</b> Associação entre a diversidade alfa filogenética e o ambiente</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="cap13.html"><a href="cap13.html#métricas-de-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>13.4</b> Métricas de diversidade beta filogenética</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="cap13.html"><a href="cap13.html#divergência-da-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>13.4.1</b> Divergência da diversidade beta filogenética</a></li>
<li class="chapter" data-level="13.4.2" data-path="cap13.html"><a href="cap13.html#correlação-entre-as-métricas-de-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>13.4.2</b> Correlação entre as métricas de diversidade beta filogenética</a></li>
<li class="chapter" data-level="13.4.3" data-path="cap13.html"><a href="cap13.html#associação-entre-a-divergência-da-diversidade-beta-filogenética-e-o-ambiente"><i class="fa fa-check"></i><b>13.4.3</b> Associação entre a divergência da diversidade beta filogenética e o ambiente</a></li>
<li class="chapter" data-level="13.4.4" data-path="cap13.html"><a href="cap13.html#riqueza-da-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>13.4.4</b> Riqueza da diversidade beta filogenética</a></li>
<li class="chapter" data-level="13.4.5" data-path="cap13.html"><a href="cap13.html#correlação-entre-phylosor-e-unifrac"><i class="fa fa-check"></i><b>13.4.5</b> Correlação entre Phylosor e Unifrac</a></li>
<li class="chapter" data-level="13.4.6" data-path="cap13.html"><a href="cap13.html#associação-entre-a-riqueza-da-diversidade-beta-filogenética-e-o-ambiente"><i class="fa fa-check"></i><b>13.4.6</b> Associação entre a riqueza da diversidade beta filogenética e o ambiente</a></li>
<li class="chapter" data-level="13.4.7" data-path="cap13.html"><a href="cap13.html#partição-da-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>13.4.7</b> Partição da diversidade beta filogenética</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="cap13.html"><a href="cap13.html#modelos-nulos"><i class="fa fa-check"></i><b>13.5</b> Modelos Nulos</a></li>
<li class="chapter" data-level="13.6" data-path="cap13.html"><a href="cap13.html#para-se-aprofundar-9"><i class="fa fa-check"></i><b>13.6</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="cap14.html"><a href="cap14.html"><i class="fa fa-check"></i><b>14</b> Diversidade Funcional</a>
<ul>
<li class="chapter" data-level="" data-path="cap14.html"><a href="cap14.html#pré-requisitos-do-capítulo-10"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="14.1" data-path="cap14.html"><a href="cap14.html#aspectos-teóricos-5"><i class="fa fa-check"></i><b>14.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="14.2" data-path="cap14.html"><a href="cap14.html#definindo-a-dissimilaridade-entre-espécies"><i class="fa fa-check"></i><b>14.2</b> Definindo a dis(similaridade) entre espécies</a></li>
<li class="chapter" data-level="14.3" data-path="cap14.html"><a href="cap14.html#métricas-de-diversidade-funcional-alfa"><i class="fa fa-check"></i><b>14.3</b> Métricas de diversidade funcional (alfa)</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="cap14.html"><a href="cap14.html#riqueza-funcional"><i class="fa fa-check"></i><b>14.3.1</b> Riqueza funcional</a></li>
<li class="chapter" data-level="14.3.2" data-path="cap14.html"><a href="cap14.html#divergência-funcional"><i class="fa fa-check"></i><b>14.3.2</b> Divergência funcional</a></li>
<li class="chapter" data-level="14.3.3" data-path="cap14.html"><a href="cap14.html#regularidade-funcional"><i class="fa fa-check"></i><b>14.3.3</b> Regularidade funcional</a></li>
<li class="chapter" data-level="14.3.4" data-path="cap14.html"><a href="cap14.html#correlação-entre-as-métricas-de-diversidade-funcional-alfa"><i class="fa fa-check"></i><b>14.3.4</b> Correlação entre as métricas de diversidade funcional (alfa)</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="cap14.html"><a href="cap14.html#métricas-de-diversidade-funcional-beta"><i class="fa fa-check"></i><b>14.4</b> Métricas de diversidade funcional (beta)</a></li>
<li class="chapter" data-level="14.5" data-path="cap14.html"><a href="cap14.html#composição-funcional-community-wegihed-means---cwm"><i class="fa fa-check"></i><b>14.5</b> Composição Funcional (<em>Community Wegihed Means</em> - CWM)</a></li>
<li class="chapter" data-level="14.6" data-path="cap14.html"><a href="cap14.html#variação-intraspecífica"><i class="fa fa-check"></i><b>14.6</b> Variação Intraspecífica</a></li>
<li class="chapter" data-level="14.7" data-path="cap14.html"><a href="cap14.html#para-se-aprofundar-10"><i class="fa fa-check"></i><b>14.7</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referências.html"><a href="referências.html"><i class="fa fa-check"></i>Referências</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análises Ecológicas no R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cap8" class="section level1" number="8">
<h1><span class="header-section-number">Capítulo 8</span> Modelos Lineares Generalizados</h1>
<div id="pré-requisitos-do-capítulo-4" class="section level2 unnumbered">
<h2>Pré-requisitos do capítulo</h2>
<p>Pacotes e dados que serão utilizados nesse capítulo.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="cap8.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecodados)</span>
<span id="cb285-2"><a href="cap8.html#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visdat)</span>
<span id="cb285-3"><a href="cap8.html#cb285-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb285-4"><a href="cap8.html#cb285-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb285-5"><a href="cap8.html#cb285-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RVAideMemoire)</span>
<span id="cb285-6"><a href="cap8.html#cb285-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb285-7"><a href="cap8.html#cb285-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb285-8"><a href="cap8.html#cb285-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb285-9"><a href="cap8.html#cb285-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(piecewiseSEM)</span>
<span id="cb285-10"><a href="cap8.html#cb285-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb285-11"><a href="cap8.html#cb285-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb285-12"><a href="cap8.html#cb285-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rmisc)</span>
<span id="cb285-13"><a href="cap8.html#cb285-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) </span>
<span id="cb285-14"><a href="cap8.html#cb285-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb285-15"><a href="cap8.html#cb285-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bbmle)</span>
<span id="cb285-16"><a href="cap8.html#cb285-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb285-17"><a href="cap8.html#cb285-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal)</span>
<span id="cb285-18"><a href="cap8.html#cb285-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb285-19"><a href="cap8.html#cb285-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-20"><a href="cap8.html#cb285-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados</span></span>
<span id="cb285-21"><a href="cap8.html#cb285-21" aria-hidden="true" tabindex="-1"></a>lagartos <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>lagartos</span>
<span id="cb285-22"><a href="cap8.html#cb285-22" aria-hidden="true" tabindex="-1"></a>parasitas <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>parasitas</span>
<span id="cb285-23"><a href="cap8.html#cb285-23" aria-hidden="true" tabindex="-1"></a>fish <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>fish</span>
<span id="cb285-24"><a href="cap8.html#cb285-24" aria-hidden="true" tabindex="-1"></a>fragmentos <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>fragmentos</span>
<span id="cb285-25"><a href="cap8.html#cb285-25" aria-hidden="true" tabindex="-1"></a>uv_cells <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>uv_cells</span></code></pre></div>
</div>
<div id="introdução-2" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Introdução</h2>
<p>No capítulo <a href="cap7.html#cap7">7</a>, descrevemos sobre os modelos lineares (também chamados de Modelos Lineares Gerais) que podem ser descritos pelo mesmo modelo matemático de uma equação da reta do tipo::</p>
<p><span class="math display">\[Y = \beta_0 + \beta_{1}X_i + \epsilon_i\]</span></p>
<p>Nesse tipo de estrutura, o que difere uma regressão linear de uma análise de variância é a natureza do elemento x<sub>i</sub>, variável contínua para a regressão lineare e variável categórica no caso da ANOVA (que é codificada numa matriz <em>design</em> para desenhos mais complexos). Nesse sentido, o que todos esses métodos têm em comum é a variável resposta Y que é um vetor numérico contínuo. Outro elemento em comum desses métodos é a distribuição de frequência do erro. Se quiser mais detalhes como sobre modelos lineares podem ser escritos na forma de matrizes, consulte a introdução de <span class="citation">(<a href="#ref-fox_ecological_2015" role="doc-biblioref">Fox et al., 2015</a>)</span>. Todos os modelos lineares assumem que a distribuição do erro seja Gaussiana (ou Normal). Isso de certa forma limita o tipo de dado que pode ser usado como variável resposta por estas análises. Por exemplo, dados de contagem (e.g., riqueza e/ou abundância de espécies), frequência (e.g., frequência de ocorrência, porcentagem de cobertura vegetal), incidência (e.g., presença ou ausência de uma espécie) ou proporção (e.g., números de animais infectados a cada 1000 animais) não são adequados para serem utilizados como variáveis resposta em modelos lineares. Uma prática comum quando nossos dados não são Normais é transformar por logarítmo ou raiz quadrada. No entanto, para dados de contagem isso não é recomendado - veja O’Hara &amp; Kotze <span class="citation">(<a href="#ref-ohara2010" role="doc-biblioref">2010</a>)</span>, Ives <span class="citation">(<a href="#ref-ives2015" role="doc-biblioref">2015</a>)</span> e Warton <span class="citation">(<a href="#ref-warton2018" role="doc-biblioref">2018</a>)</span> para mais detalhes.</p>
<p>Nestes casos, devemos recorrer a um conjunto de modelos chamados Modelos Lineares Generalizados (GLM). Nestes modelos, o usuário especifica a distribuição de frequência que deseja utilizar para modelar a variável resposta. Esta distribuição de frequência deve pertencer à família exponencial, que inclui a distribuição de Poisson, Gaussiana, binomial, binomial negativa, Gamma, Bernoulli e Beta. Ainda é possível utilizar Cumulative Link Models para modelar dados ordinais (fatores cuja ordem dos elementos importa, tais como muito baixo, baixo, alto e muito alto). Abaixo vamos ver um pouco sobre como um GLM funciona e exemplos com cada uma destas distribuições.</p>
</div>
<div id="como-um-glm-funciona" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Como um GLM funciona?</h2>
<p>Diferentemente do modelo linear, um GLM estima os parâmetros por meio de Máxima Verossimilhança (ML) ao invés dos Mínimos Quadrados Comuns, também chamados de Mínimos Quadrados Ordinários (OLS).</p>
<p>Portanto, um GLM relaciona a <strong>distribuição da variável resposta</strong> aos <strong>preditores lineares</strong> por meio de uma <strong>função de ligação</strong>. Por exemplo, no caso da distribuição de Poisson, usa-se uma ligação logarítmica (também chamada de log link) que garante que o valores ajustados são sempre não negativos. Portanto, um GLM é composto por esses três componentes: i) função de distribuição, ii) preditor linear e iii) função de ligação. A função de distribuição é uma hipótese sobre a distribuição da variável resposta Y<sub>i</sub>. Isso também define a média e a variância de Y<sub>i</sub>. Já a função de ligação define a relação entre o valor médio de Y<sub>i</sub> e da parte sistemática. Esta é também chamada de ligação entre a média e a parte sistemática do modelo. Existem três tipos de função de ligação:</p>
<ul>
<li><p><strong>Identity link</strong>, que é definido por <code>g(µ) = μ</code>, e modela a média ou valor esperado de Y. Usado em modelos lineares padrão</p></li>
<li><p><strong>Log link</strong>, que é <code>g(μ) = log(μ)</code>, e modela o log da média. É usado para dados de contagem (que não podem assumir valores negativos) em modelos log-linear</p></li>
<li><p><strong>Logit link</strong>, que é <code>g(μ) = log[μ/(1-μ)]</code>, e é usado para dados binários e regressão logística</p></li>
</ul>
<p>Logo, um modelo linear pode ser visto como um caso particular de um GLM em que utiliza distribuição Gaussiana, com <em>identity link</em>.</p>
</div>
<div id="como-escolher-a-distribuição-correta-para-seus-dados" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Como escolher a distribuição correta para seus dados?</h2>
<div id="para-dados-contínuos" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Para dados contínuos</h3>
<p>Se Y é uma variável contínua, a sua distribuição de probabilidade deve ser normal. Nesses casos as distribuições recomendadas são a <strong>Gaussiana (Normal) ou Gamma</strong>. Para essas distribuições, o parâmetro de dispersão é estimado separadamente da média e é às vezes, chamado de <em>nuisance parameter</em>. Uma particularidade da distribuição Gamma é que ela só aceita valores contínuos positivos.</p>
</div>
<div id="para-dados-de-contagem" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Para dados de contagem</h3>
<p>Se Y é binário (e.g., vivo ou morto), a distribuição de probabilidade deve ser <strong>binomial</strong>.</p>
<p>Se Y é uma contagem (e.g., abundância ou riqueza de espécies), então a distribuição de probabilidade deve ser <strong>Poisson ou binomial negativa</strong>. Existem também correções dessas distribuições quando apresentam sobredispersão (<em>overdispersion</em>), tais como quasi-Poisson ou quasi-Negative binomial. Falaremos delas no momento certo.</p>
<p>Para distribuições tais como binomial e Poisson, a variância deve ser igual à media e o parâmetro de dispersão é sempre 1. Na maioria dos dados ecológicos esse pressuposto não é cumprido, veremos estratégias para lidar com isso logo à frente.</p>
<p>As funções <code>Ord_plot()</code> e <code>goodfit()</code> do pacote <code>vcd</code> podem auxiliar na escolha da distribuição para dados de contagem.</p>
</div>
</div>
<div id="dados-de-contagem-a-distribuição-de-poisson" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Dados de contagem: a distribuição de Poisson</h2>
<p>Para casos em que estamos interessados em quantificar uma variável discreta, ou seja, uma variável positiva, representada sempre por números inteiros, contendo um número finito de possibilidades, devemos utilizar a <strong>distribuição de Poisson</strong>. Esta distribuição é peculiar por ser descrita apenas por um parâmetro livre (<span class="math inline">\(\lambda\)</span>). Isso quer dizer que tanto a média quanto a variância dos dados são descritos por um único parâmetro, o que implica em dizer que a média e a variância têm de ser iguais.</p>
<p>Vamos ver um exemplo com dados reais.</p>
<p><strong>Exemplo 1</strong></p>
<p><strong>Explicação dos dados</strong></p>
<p>Neste exemplo, iremos utilizar dados de riqueza de anfíbios anuros coletados em 40 poças, açudes e brejos ao redor de fragmentos florestais no Noroeste Paulista <span class="citation">(<a href="#ref-prado2014" role="doc-biblioref">Prado &amp; Rossa-Feres, 2014</a>)</span>. Os autores mediram seis variáveis em escala local e outras três em escala de paisagem.</p>
<p><strong>Pergunta</strong></p>
<p>A distância linear para o corpo d’água mais próximo influencia a abundância total de espécies de anuros?</p>
<p><strong>Predições</strong></p>
<p>Corpos d’água mais conectados permitem que indivíduos dispersem entre eles com maior facilidade, suportando melhor dinâmicas de metapopulações. Portanto, espero que poças que estejam mais conectadas entre si tenham maior riqueza total de anuros.</p>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variável reposta: riqueza de anuros em 40 poças</li>
<li>Variável preditora: distância da poça focal para a mais próxima na escala da paisagem</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Verificar se o seu data frame está com as unidades amostrais nas linhas (neste caso poças) e variáveis nas colunas</li>
</ul>
<p>Antes de começar com a análise, vamos primeiro explorar os dados.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="cap8.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Explorar os dados</span></span>
<span id="cb286-2"><a href="cap8.html#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fragmentos)</span>
<span id="cb286-3"><a href="cap8.html#cb286-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rows: 40</span></span>
<span id="cb286-4"><a href="cap8.html#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Columns: 40</span></span>
<span id="cb286-5"><a href="cap8.html#cb286-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ locality    &lt;chr&gt; &quot;MAC&quot;, &quot;MAC&quot;, &quot;MAC&quot;, &quot;MAC&quot;, &quot;MAC&quot;, &quot;MAC&quot;, &quot;NOV&quot;, &quot;NOV&quot;, &quot;NOV&quot;, &quot;NOV&quot;, &quot;PIN&quot;, &quot;PIN&quot;, &quot;PIN&quot;, &quot;PIN&quot;, &quot;P…</span></span>
<span id="cb286-6"><a href="cap8.html#cb286-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ site        &lt;chr&gt; &quot;MacAc1&quot;, &quot;MacAc2&quot;, &quot;MacAc3&quot;, &quot;MacAc4&quot;, &quot;MacAc5&quot;, &quot;MacBr1&quot;, &quot;NovBr1&quot;, &quot;NovBr2&quot;, &quot;NovRe2&quot;, &quot;NovRe3&quot;, …</span></span>
<span id="cb286-7"><a href="cap8.html#cb286-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Riqueza_obs &lt;int&gt; 3, 11, 10, 10, 3, 9, 2, 8, 9, 8, 6, 4, 8, 8, 6, 17, 15, 13, 8, 10, 12, 14, 14, 12, 8, 4, 10, 7, 13, …</span></span>
<span id="cb286-8"><a href="cap8.html#cb286-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Riqueza_HB  &lt;int&gt; 6, 13, 12, 13, 6, 12, 5, 11, 12, 11, 8, 7, 10, 11, 9, 18, 17, 15, 11, 13, 14, 16, 16, 13, 11, 7, 13,…</span></span>
<span id="cb286-9"><a href="cap8.html#cb286-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Bsc         &lt;int&gt; 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0…</span></span>
<span id="cb286-10"><a href="cap8.html#cb286-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Dne         &lt;int&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0…</span></span>
<span id="cb286-11"><a href="cap8.html#cb286-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Dnm         &lt;int&gt; 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1…</span></span>
<span id="cb286-12"><a href="cap8.html#cb286-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Dnn         &lt;int&gt; 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1…</span></span>
<span id="cb286-13"><a href="cap8.html#cb286-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Dns         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1…</span></span>
<span id="cb286-14"><a href="cap8.html#cb286-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Hal         &lt;int&gt; 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1…</span></span>
<span id="cb286-15"><a href="cap8.html#cb286-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Hra         &lt;int&gt; 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1…</span></span>
<span id="cb286-16"><a href="cap8.html#cb286-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Lfu         &lt;int&gt; 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1…</span></span>
<span id="cb286-17"><a href="cap8.html#cb286-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Lla         &lt;int&gt; 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0…</span></span>
<span id="cb286-18"><a href="cap8.html#cb286-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Lpo         &lt;int&gt; 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1…</span></span>
<span id="cb286-19"><a href="cap8.html#cb286-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Eun         &lt;int&gt; 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0…</span></span>
<span id="cb286-20"><a href="cap8.html#cb286-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Pce         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0…</span></span>
<span id="cb286-21"><a href="cap8.html#cb286-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Pcu         &lt;int&gt; 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span id="cb286-22"><a href="cap8.html#cb286-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Pfa1        &lt;int&gt; 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0…</span></span>
<span id="cb286-23"><a href="cap8.html#cb286-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Ppa         &lt;int&gt; 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span id="cb286-24"><a href="cap8.html#cb286-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Sfm         &lt;int&gt; 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1…</span></span>
<span id="cb286-25"><a href="cap8.html#cb286-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Sfv         &lt;int&gt; 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1…</span></span>
<span id="cb286-26"><a href="cap8.html#cb286-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Ebi         &lt;int&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1…</span></span>
<span id="cb286-27"><a href="cap8.html#cb286-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Esp         &lt;int&gt; 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1…</span></span>
<span id="cb286-28"><a href="cap8.html#cb286-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ hydrop      &lt;dbl&gt; -2.553590, 0.573255, 0.573255, 0.573255, -2.553590, 0.573255, 0.573255, 0.573255, 0.573255, 0.573255…</span></span>
<span id="cb286-29"><a href="cap8.html#cb286-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ hydrop2     &lt;dbl&gt; -2.235730, 0.606300, 0.606300, 0.606300, -2.235730, 0.606300, 0.606300, 0.606300, 0.606300, 0.606300…</span></span>
<span id="cb286-30"><a href="cap8.html#cb286-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ vegcov      &lt;dbl&gt; -1.461851, -1.145775, -0.987737, 0.908718, -1.461851, 1.382832, 1.382832, 1.698908, -0.829699, 0.118…</span></span>
<span id="cb286-31"><a href="cap8.html#cb286-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ nveg        &lt;dbl&gt; -1.965130, -0.158114, -1.061622, -0.158114, -1.965130, -0.158114, 0.745394, 1.648902, 0.745394, 1.64…</span></span>
<span id="cb286-32"><a href="cap8.html#cb286-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ fish        &lt;dbl&gt; -1.508310, 0.646419, -1.508310, 0.646419, -1.508310, -1.508310, 0.646419, 0.646419, 0.646419, 0.6464…</span></span>
<span id="cb286-33"><a href="cap8.html#cb286-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ area        &lt;dbl&gt; -2.418270, 0.147353, -0.564022, -0.348279, -2.315159, -0.601947, 1.556190, -0.255774, 0.875432, 1.29…</span></span>
<span id="cb286-34"><a href="cap8.html#cb286-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ area2       &lt;dbl&gt; -1.884470, 0.019560, -0.699829, -0.497176, -1.844802, -0.734057, 1.877820, -0.406145, 0.907959, 1.49…</span></span>
<span id="cb286-35"><a href="cap8.html#cb286-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ depth       &lt;dbl&gt; -1.232668, 0.821168, -0.704539, 0.821168, -1.306019, -1.306019, -0.645858, -0.205750, 1.554680, 1.55…</span></span>
<span id="cb286-36"><a href="cap8.html#cb286-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ forcov      &lt;dbl&gt; -0.604596, -0.020849, -0.013816, -0.171663, 0.203364, 0.203364, 0.562496, -0.157193, -0.793258, -0.3…</span></span>
<span id="cb286-37"><a href="cap8.html#cb286-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ forcov2     &lt;dbl&gt; -0.672774, -0.152952, -0.146124, -0.296136, 0.071358, 0.071358, 0.459151, -0.282666, -0.820946, -0.4…</span></span>
<span id="cb286-38"><a href="cap8.html#cb286-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ forcov10    &lt;dbl&gt; -6.045965, -0.208489, -0.138159, -1.716633, 2.033643, 2.033643, 5.624958, -1.571928, -7.932582, -3.9…</span></span>
<span id="cb286-39"><a href="cap8.html#cb286-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ dfrag       &lt;dbl&gt; 0.410084, -0.097045, -1.242271, -1.242271, -0.471888, -1.242271, 1.307931, 1.557264, 0.479895, 0.966…</span></span>
<span id="cb286-40"><a href="cap8.html#cb286-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ dfrag2      &lt;dbl&gt; 0.166782, -0.381401, -1.059858, -1.059858, -0.688845, -1.059858, 1.510271, 1.967926, 0.254153, 0.943…</span></span>
<span id="cb286-41"><a href="cap8.html#cb286-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ dwater      &lt;dbl&gt; 1.198175, 0.970207, -0.121245, -0.087507, 0.162610, -0.121245, -0.087507, -1.355308, 0.113584, -0.19…</span></span>
<span id="cb286-42"><a href="cap8.html#cb286-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ dwater2     &lt;dbl&gt; 1.166645, 0.864035, -0.299232, -0.270350, -0.042156, -0.299232, -0.270350, -1.045428, -0.088840, -0.…</span></span>
<span id="cb286-43"><a href="cap8.html#cb286-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ X           &lt;dbl&gt; -49.9376, -49.9353, -49.9348, -49.9334, -49.9270, -49.9271, -49.2742, -49.3303, -49.3084, -49.3179, …</span></span>
<span id="cb286-44"><a href="cap8.html#cb286-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Y           &lt;dbl&gt; -20.7408, -20.7410, -20.7419, -20.7462, -20.7453, -20.7451, -21.5187, -21.5282, -21.5024, -21.5148, …</span></span></code></pre></div>
<p>Percebam que o data frame contém 40 colunas. Neste conjunto de dados as variáveis preditoras já estão padronizadas com média 0 e desvio padrão 1. As variáveis com “2” indicam variáveis quadráticas (podem ser usadas para se testar relações não lineares). Também temos a riqueza observada e a estimada (<code>Riqueza_HB</code>) e as coordenadas geográficas (X e Y). Vamos agora explorar os dados e ver como é a relação entre riqueza e distância para a poça mais próxima. Sempre é recomendado visualizar os dados antes de efetivamente os modelar para se ter uma idéia da relação entre as variáveis (Figura <a href="cap8.html#fig:fig-mod-poi-pre">8.1</a>).</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="cap8.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb287-2"><a href="cap8.html#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fragmentos, <span class="fu">aes</span>(dfrag, Riqueza_obs)) <span class="sc">+</span></span>
<span id="cb287-3"><a href="cap8.html#cb287-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb287-4"><a href="cap8.html#cb287-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb287-5"><a href="cap8.html#cb287-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Distância para o fragmento mais próximo&quot;</span>, </span>
<span id="cb287-6"><a href="cap8.html#cb287-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Riqueza observada&quot;</span>) <span class="sc">+</span></span>
<span id="cb287-7"><a href="cap8.html#cb287-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-poi-pre"></span>
<img src="livro_files/figure-html/fig-mod-poi-pre-1.png" alt="Gráfico pareado para explorar as variáveis." width="100%" height="100%" />
<p class="caption">
Figura 8.1: Gráfico pareado para explorar as variáveis.
</p>
</div>
<p>Aqui vemos que há de fato uma relação linear positiva entre as duas variáveis.</p>
<ul>
<li>A partir de agora vamos sempre usar uma mesma estrutura para realizar nossos exercícios de modelagem:</li>
</ul>
<ol style="list-style-type: decimal">
<li>Primeiro vamos especificar o modelo</li>
<li>Depois realizar a diagnose</li>
<li>Por último realizar inferência a partir do nosso modelo</li>
</ol>
<p><strong>Modelagem</strong></p>
<p>O primeiro argumento da função <code>glm()</code> é uma fórmula, em que na parte esquerda temos a variável resposta seguida do símbolo <code>~</code> (lê-se: modelado em função de) seguido pelas variáveis preditoras. Aqui podemos usar uma ou mais variáveis e testar o seu efeito aditivo (usando o sinal de +) ou a interação entre elas (usando o sinal de *). Um bom resumo sobre como especificar o seu modelo pode ser encontrada <a href="https://ridiculas.wordpress.com/2012/07/23/semantica-para-descrever-modelos/">aqui neste blog</a>. Aqui optamos por um modelo bem simples modelando a riqueza de anfíbios apenas em função da distância para o fragmento mais próximo.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="cap8.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Modelo</span></span>
<span id="cb288-2"><a href="cap8.html#cb288-2" aria-hidden="true" tabindex="-1"></a>mod_pois <span class="ot">&lt;-</span> <span class="fu">glm</span>(Riqueza_obs <span class="sc">~</span> dfrag, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> fragmentos)</span></code></pre></div>
<p>Assim como modelos lineares que vimos no Capítulo <a href="cap7.html#cap7">7</a>, GLMs com distribuição de Poisson requerem que se realizem testes de pressupostos de normalidade e homogeneidade de variância dos resíduos, assim como sobredispersão e inflação de zeros.</p>
<p><strong>Diagnose básica dos resíduos do modelo</strong></p>
<p>Iremos realizar três diagnoses básicas dos GLMs, avaliando diferentes aspectos do modelo:</p>
<ol style="list-style-type: decimal">
<li>Homogeneidade da variância e normalidade dos resíduos</li>
<li>Sobredispersão (<em>Overdispersion</em>)</li>
<li>Inflação de zeros (<em>Zero-inflation</em>)</li>
</ol>
<p>Vamos começar avaliando as homogeneidade da variância e normalidade dos resíduos (Figura <a href="cap8.html#fig:fig-mod-poi-diag-bas">8.2</a>).</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="cap8.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnose básica</span></span>
<span id="cb289-2"><a href="cap8.html#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb289-3"><a href="cap8.html#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_pois) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-poi-diag-bas"></span>
<img src="livro_files/figure-html/fig-mod-poi-diag-bas-1.png" alt="Diagnose básica dos resíduos do modelo GLM Poisson." width="100%" height="100%" />
<p class="caption">
Figura 8.2: Diagnose básica dos resíduos do modelo GLM Poisson.
</p>
</div>
<p>Vemos que as linhas vermelhas (que indicam a tendência dos dados) estão praticamente retas seguindo a linha pontilhada, sugerindo que existe homogeneidade de variância dos resíduos. Vemos também que nos quatro plots alguns dados, 1, 7 e 30 (referem-se às linhas do data frame) aparecem identificados, pois apresentam ligeiro desvio da normalidade e estão distantes da média. No entanto, não é algo para nos preocuparmos, pois não são valores muito extremos. Portanto, a diagnose básica indicou que o modelo com Poisson parece ser adequado para modelar estes dados, ao menos em termos de homogeneidade de variância.</p>
<p><strong>Diagnose avançada dos resíduos do modelo</strong></p>
<p>Alguns pacotes permitem calcular outros aspectos do modelo que facilitam a diagnose, ou seja, se podemos de fato confiar nos parâmetros estimados por eles, incluindo valores de significância. Um pressuposto importante dos modelos de contagem (incluindo Poisson) é a sobredispersão (<em>overdispersion</em>).</p>
<p>Vejamos como o pacote <code>DHARMa</code> funciona (Figura <a href="cap8.html#fig:fig-mod-poi-diag-avan">8.3</a>).</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="cap8.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnose avançada</span></span>
<span id="cb290-2"><a href="cap8.html#cb290-2" aria-hidden="true" tabindex="-1"></a>simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> mod_pois, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-poi-diag-avan"></span>
<img src="livro_files/figure-html/fig-mod-poi-diag-avan-1.png" alt="Diagnose avançada dos resíduos do modelo GLM Poisson." width="100%" height="100%" />
<p class="caption">
Figura 8.3: Diagnose avançada dos resíduos do modelo GLM Poisson.
</p>
</div>
<p>O plot claramente indica que há problema com <em>overdispersion</em>, mas não em termos de desvios de normalidade (KS test) ou <em>outlier</em>, já que apenas o primeiro foi significativo (aparece em vermelho).</p>
<p><strong>Detectando e lidando com overdispersion</strong></p>
<p>O que é sobredispersão (<em>overdispersion</em>)? Ela ocorre quando a variância observada é muito maior do que aquela predita pelo modelo. Para modelos que utilizam a distribuição de Poisson, isso ocorre quando a variância aumenta com a média. Lembre-se de que esta distribuição tem apenas um único parâmetro para descrever tanto a média quanto a variância (<span class="math inline">\(\lambda\)</span>). Portanto, a variância tem de ser igual à média. No entanto, se a variância nos dados observados for muito maior do que a média, dizemos que há sobredispersão nos dados.</p>
<p>Existem duas formas de diagnosticar <em>overdispersion</em> que estão implementadas na maioria dos pacotes. Aqui vamos demonstrá-las usando as funções <code>check_overdispersion()</code> e <code>testDispersion()</code> disponíveis nos pacotes <code>performance</code> e <code>DHARMa</code>, respectivamente.</p>
<p>A função <code>testDispersion()</code> do <code>DHARMa</code> utiliza um método de aleatorização dos resíduos para determinar se há <em>overdispersion</em> nos dados, cuja vantagem é que aborda diretamente a variação nos dados, ao invés de medir o ajuste do modelo em si, com outros testes (Figura <a href="cap8.html#fig:fig-mod-poi-over-dharma">8.4</a>).</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="cap8.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Overdispersion</span></span>
<span id="cb291-2"><a href="cap8.html#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb291-3"><a href="cap8.html#cb291-3" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(mod_pois) <span class="co"># modelo tem overdispersion</span></span>
<span id="cb291-4"><a href="cap8.html#cb291-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb291-5"><a href="cap8.html#cb291-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  DHARMa nonparametric dispersion test via sd of residuals fitted vs. simulated</span></span>
<span id="cb291-6"><a href="cap8.html#cb291-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb291-7"><a href="cap8.html#cb291-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  simulationOutput</span></span>
<span id="cb291-8"><a href="cap8.html#cb291-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dispersion = 1.6489, p-value &lt; 2.2e-16</span></span>
<span id="cb291-9"><a href="cap8.html#cb291-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: two.sided</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-poi-over-dharma"></span>
<img src="livro_files/figure-html/fig-mod-poi-over-dharma-1.png" alt="Teste de overdispersion do pacote `DHARMa`." width="100%" height="100%" />
<p class="caption">
Figura 8.4: Teste de overdispersion do pacote <code>DHARMa</code>.
</p>
</div>
<p>Aqui temos um gráfico e o resultado novamente do teste de <em>overdispersion</em> (que já aparecia no gráfico anterior) mostrando que de fato há <em>overdispersion</em>: perceba que o valor de <em>P</em> é significativo. O gráfico nos mostra em cinza a distribuição dos resíduos aleatorizados e a linha vermelha o valor observado da estatística. Já que a linha está bem à direita da distribuição, isso indica <em>overdispersion</em>, se estivese à esquerda seria o caso de <em>underdispersion</em>.</p>
<p>Agora vamos utilizar a função <code>check_overdisperion()</code> que utiliza uma distribuição qui-quadradado e o valor de <em>dispersion ratio</em> para testar a presença de <em>overdispersion</em> no modelo. Esse teste também pode ser feito com a função acima ao se especificar o argumento <code>type="PearsonChisq"</code>.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="cap8.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Testar a presença de overdispersion</span></span>
<span id="cb292-2"><a href="cap8.html#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(mod_pois) <span class="co"># modelo tem overdispersion</span></span>
<span id="cb292-3"><a href="cap8.html#cb292-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Overdispersion test</span></span>
<span id="cb292-4"><a href="cap8.html#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb292-5"><a href="cap8.html#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        dispersion ratio =  1.657</span></span>
<span id="cb292-6"><a href="cap8.html#cb292-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Pearson&#39;s Chi-Squared = 62.951</span></span>
<span id="cb292-7"><a href="cap8.html#cb292-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 p-value =  0.007</span></span></code></pre></div>
<p>Quando este resultado é significativo, como vimos na última linha acima, isso indica que há <em>overdispersion</em>.</p>
<p>Usando a função <code>summary()</code> podemos ter um resumo e descrição dos parâmetros do modelo.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="cap8.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Resumo do modelo</span></span>
<span id="cb293-2"><a href="cap8.html#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_pois)</span>
<span id="cb293-3"><a href="cap8.html#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb293-4"><a href="cap8.html#cb293-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb293-5"><a href="cap8.html#cb293-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; glm(formula = Riqueza_obs ~ dfrag, family = poisson(link = &quot;log&quot;), </span></span>
<span id="cb293-6"><a href="cap8.html#cb293-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = fragmentos)</span></span>
<span id="cb293-7"><a href="cap8.html#cb293-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb293-8"><a href="cap8.html#cb293-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb293-9"><a href="cap8.html#cb293-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb293-10"><a href="cap8.html#cb293-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -3.3467  -0.9110   0.0942   0.8336   2.2773  </span></span>
<span id="cb293-11"><a href="cap8.html#cb293-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb293-12"><a href="cap8.html#cb293-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb293-13"><a href="cap8.html#cb293-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb293-14"><a href="cap8.html#cb293-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   2.3051     0.0500  46.101   &lt;2e-16 ***</span></span>
<span id="cb293-15"><a href="cap8.html#cb293-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dfrag         0.0718     0.0507   1.416    0.157    </span></span>
<span id="cb293-16"><a href="cap8.html#cb293-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb293-17"><a href="cap8.html#cb293-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb293-18"><a href="cap8.html#cb293-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb293-19"><a href="cap8.html#cb293-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for poisson family taken to be 1)</span></span>
<span id="cb293-20"><a href="cap8.html#cb293-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb293-21"><a href="cap8.html#cb293-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 70.868  on 39  degrees of freedom</span></span>
<span id="cb293-22"><a href="cap8.html#cb293-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 68.856  on 38  degrees of freedom</span></span>
<span id="cb293-23"><a href="cap8.html#cb293-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: 235.29</span></span>
<span id="cb293-24"><a href="cap8.html#cb293-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb293-25"><a href="cap8.html#cb293-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span id="cb293-26"><a href="cap8.html#cb293-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-27"><a href="cap8.html#cb293-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Dispersion parameter</span></span>
<span id="cb293-28"><a href="cap8.html#cb293-28" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(mod_pois) <span class="sc">/</span> <span class="fu">df.residual</span>(mod_pois)</span>
<span id="cb293-29"><a href="cap8.html#cb293-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.81199</span></span></code></pre></div>
<p>Na parte de baixo do output da função <code>summary()</code> também podemos calcular o <em>dispersion parameter</em> dividindo o <em>residual deviance</em> pelos graus de liberdade dos resíduos. Esta é outra maneira fácil e rápida de detectar <em>overdispersion</em>. Neste exemplo, temos que <em>Dispersion parameter</em> = 1.8119903. Quando esse valor é próximo de 1, isso sugere que não há <em>overdispersion</em>. No entanto, se ele for maior que 1.5, isso sugere que o modelo sofre de <em>overdispersion</em> e que devemos usar outra distribuição, tal como a distribuição <strong>binomial negativa</strong>, por exemplo.</p>
<p>Além disso, uma outra forma de diagnosticar o modelo é calcular os resíduos de Pearson (resíduos normalizados), que é basicamente a raiz quadrada da variância da variável resposta.</p>
<p><strong>Inflação de zeros</strong></p>
<p>Qualquer das formas mostradas acima de diagnosticar <em>overdispersion</em> pode ser usada na maioria das vezes, com exceção de dados com muitos zeros (pouca variância). Por isso, devemos também testar se o nosso modelo sofre de inflação de zeros. Vejamos como isso funciona usando as funções <code>check_zeroinflation()</code> no pacote <code>performanace</code> e <code>testZeroInflation()</code> no pacote <code>DHARMa</code> (Figura <a href="cap8.html#fig:fig-mod-poi-over-zero">8.5</a>).</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="cap8.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Inflação de zeros - performanace</span></span>
<span id="cb294-2"><a href="cap8.html#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_zeroinflation</span>(mod_pois) <span class="co"># para diagnosticar se o modelo sofre de zero inflation</span></span>
<span id="cb294-3"><a href="cap8.html#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model has no observed zeros in the response variable.</span></span>
<span id="cb294-4"><a href="cap8.html#cb294-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL</span></span>
<span id="cb294-5"><a href="cap8.html#cb294-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-6"><a href="cap8.html#cb294-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Inflação de zeros - DHARMa</span></span>
<span id="cb294-7"><a href="cap8.html#cb294-7" aria-hidden="true" tabindex="-1"></a><span class="fu">testZeroInflation</span>(mod_pois) <span class="co"># para testar se existe zero inflation</span></span>
<span id="cb294-8"><a href="cap8.html#cb294-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb294-9"><a href="cap8.html#cb294-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  DHARMa zero-inflation test via comparison to expected zeros with simulation under H0 = fitted model</span></span>
<span id="cb294-10"><a href="cap8.html#cb294-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb294-11"><a href="cap8.html#cb294-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  simulationOutput</span></span>
<span id="cb294-12"><a href="cap8.html#cb294-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ratioObsSim = NaN, p-value = 1</span></span>
<span id="cb294-13"><a href="cap8.html#cb294-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: two.sided</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-poi-over-zero"></span>
<img src="livro_files/figure-html/fig-mod-poi-over-zero-1.png" alt="Teste de inflação de zeros do pacote `DHARMa`." width="100%" height="100%" />
<p class="caption">
Figura 8.5: Teste de inflação de zeros do pacote <code>DHARMa</code>.
</p>
</div>
<p>Tanto a função do <code>DHARMa</code> quanto do <code>performance</code> conseguiram detectar que o modelo tem problemas com <em>overdispersion</em>, mas isso não é causado pelo excesso de zeros. Como já dissemos acima, no caso da distribuição Poisson, tanto a média quanto a variância são modeladas pelo mesmo parâmetro (<span class="math inline">\(\lambda\)</span>). Isso faz com que esta distribuição não seja muito útil para modelar dados de contagem em que haja muita variância em torno da média. Esse infelizmente é o caso da grande maioria dos dados ecológicos.</p>
<p>Por estes motivos, não podemos fazer inferência com este modelo porque os parâmetros estimados não são confiáveis. Mas vejamos como seria feita essa inferência <em>caso este modelo fosse adequado</em>.</p>
<p><strong>Inferência</strong></p>
<p>Aqui iremos apresentar várias funções para calcular o coeficiente de determinação (R<sup>2</sup>). No caso de GLM(M)s, não há um consenso sobre como se calcula este coeficiente, havendo várias propostas que utilizam maneiras diferentes de estimar a homogeneidade de variância e covariância entre observações dos resíduos, veja <span class="citation">(<a href="#ref-nakagawa2017" role="doc-biblioref">Nakagawa et al., 2017</a>)</span> e <span class="citation">(<a href="#ref-ives2015" role="doc-biblioref">Ives, 2015</a>)</span> para maiores detalhes, assim como o <em>help</em> das respectivas funções.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="cap8.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Coeficientes estimados pelo modelo</span></span>
<span id="cb295-2"><a href="cap8.html#cb295-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_pois)</span>
<span id="cb295-3"><a href="cap8.html#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb295-4"><a href="cap8.html#cb295-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb295-5"><a href="cap8.html#cb295-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; glm(formula = Riqueza_obs ~ dfrag, family = poisson(link = &quot;log&quot;), </span></span>
<span id="cb295-6"><a href="cap8.html#cb295-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = fragmentos)</span></span>
<span id="cb295-7"><a href="cap8.html#cb295-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb295-8"><a href="cap8.html#cb295-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb295-9"><a href="cap8.html#cb295-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb295-10"><a href="cap8.html#cb295-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -3.3467  -0.9110   0.0942   0.8336   2.2773  </span></span>
<span id="cb295-11"><a href="cap8.html#cb295-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb295-12"><a href="cap8.html#cb295-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb295-13"><a href="cap8.html#cb295-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb295-14"><a href="cap8.html#cb295-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   2.3051     0.0500  46.101   &lt;2e-16 ***</span></span>
<span id="cb295-15"><a href="cap8.html#cb295-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dfrag         0.0718     0.0507   1.416    0.157    </span></span>
<span id="cb295-16"><a href="cap8.html#cb295-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb295-17"><a href="cap8.html#cb295-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb295-18"><a href="cap8.html#cb295-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb295-19"><a href="cap8.html#cb295-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for poisson family taken to be 1)</span></span>
<span id="cb295-20"><a href="cap8.html#cb295-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb295-21"><a href="cap8.html#cb295-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 70.868  on 39  degrees of freedom</span></span>
<span id="cb295-22"><a href="cap8.html#cb295-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 68.856  on 38  degrees of freedom</span></span>
<span id="cb295-23"><a href="cap8.html#cb295-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: 235.29</span></span>
<span id="cb295-24"><a href="cap8.html#cb295-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb295-25"><a href="cap8.html#cb295-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span id="cb295-26"><a href="cap8.html#cb295-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-27"><a href="cap8.html#cb295-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculando o R2 do modelo</span></span>
<span id="cb295-28"><a href="cap8.html#cb295-28" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(mod_pois)</span>
<span id="cb295-29"><a href="cap8.html#cb295-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  R2m        R2c</span></span>
<span id="cb295-30"><a href="cap8.html#cb295-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; delta     0.04925800 0.04925800</span></span>
<span id="cb295-31"><a href="cap8.html#cb295-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lognormal 0.05154558 0.05154558</span></span>
<span id="cb295-32"><a href="cap8.html#cb295-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; trigamma  0.04696308 0.04696308</span></span>
<span id="cb295-33"><a href="cap8.html#cb295-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rsquared</span>(mod_pois)</span>
<span id="cb295-34"><a href="cap8.html#cb295-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Response  family link     method  R.squared</span></span>
<span id="cb295-35"><a href="cap8.html#cb295-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Riqueza_obs poisson  log nagelkerke 0.04919844</span></span>
<span id="cb295-36"><a href="cap8.html#cb295-36" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(mod_pois)</span>
<span id="cb295-37"><a href="cap8.html#cb295-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # R2 for Generalized Linear Regression</span></span>
<span id="cb295-38"><a href="cap8.html#cb295-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Nagelkerke&#39;s R2: 0.059</span></span></code></pre></div>
<p>Podemos ver que os valores de R<sup>2</sup> são bem baixos (em torno de 4 - 5%), independente do método que usamos pra calculá-lo.</p>
<p><strong>Plot do modelo predito</strong></p>
<p>Vamos realizar a visualização do ajusto do modelo Poisson (Figura <a href="cap8.html#fig:fig-mod-poi-model">8.6</a>).</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="cap8.html#cb296-1" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fragmentos, <span class="fu">aes</span>(dfrag, Riqueza_obs)) <span class="sc">+</span></span>
<span id="cb296-2"><a href="cap8.html#cb296-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">cex =</span> <span class="dv">4</span>,<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb296-3"><a href="cap8.html#cb296-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">formula =</span> y<span class="sc">~</span>x, </span>
<span id="cb296-4"><a href="cap8.html#cb296-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>), <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb296-5"><a href="cap8.html#cb296-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Distância para o fragmento mais próximo&quot;</span>, </span>
<span id="cb296-6"><a href="cap8.html#cb296-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Riqueza observada&quot;</span>) <span class="sc">+</span></span>
<span id="cb296-7"><a href="cap8.html#cb296-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tema_livro</span>()</span>
<span id="cb296-8"><a href="cap8.html#cb296-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-9"><a href="cap8.html#cb296-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(a1, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-poi-model"></span>
<img src="livro_files/figure-html/fig-mod-poi-model-1.png" alt="Gráfico do GLM Poisson." width="100%" height="100%" />
<p class="caption">
Figura 8.6: Gráfico do GLM Poisson.
</p>
</div>
<div class="alert alert-info">
<p><strong> 📝 Importante </strong><br />
Aqui vemos que há uma leve tendência na relação positiva entre distância para o fragmento mais próximo e a riqueza de anfíbios observada. No entanto, há uma grande dispersão nos dados ao redor da reta do modelo, fazendo com que a relação não seja de fato significativa e tenhamos um R<sup>2</sup> bem baixo.</p>
<p>Caso pudéssemos confiar nos parâmetros deste modelo, poderíamos dizer que existe uma leve tendência a um aumento da riqueza observada de anfíbios anuros à medida que aumenta a distância da poça para o fragmento mais próximo.</p>
</div>
<div id="o-que-causa-a-overdispersion" class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> O que causa a <em>overdispersion</em>?</h3>
<p>Existem dois conjuntos de causas: aparente ou real.</p>
<p>As causas aparentes são geradas pela <em>má especificação do modelo</em>, tais como:</p>
<ol style="list-style-type: decimal">
<li>não inclusão de covariáveis ou interações no modelo</li>
<li>presença de <em>outliers</em> na variável resposta, efeitos não lineares da covariável (X2, X3…)</li>
<li>escolha errada da função de ligação (<em>link function</em>)</li>
</ol>
<p>As causas reais incluem:</p>
<ol style="list-style-type: decimal">
<li>variância maior que a média</li>
<li>muitos zeros</li>
<li>agregação de observações</li>
<li>correlação entre observações (não independência)</li>
</ol>
</div>
<div id="o-que-fazer-se-seu-modelo-tiver-overdispersion" class="section level3" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> O que fazer se seu modelo tiver <em>overdispersion</em>?</h3>
<p>Depois de tentar corrigir possíveis más especificações, como as listadas acima, existem duas alternativas:</p>
<ol style="list-style-type: decimal">
<li>usar outra distribuição, tal como binomial negativa, caso o <em>dispersion parameter</em> seja maior que 15 ou 20</li>
<li>Usar um modelo com correção de erro da sobredispersão, caso 1.5 &lt; <em>dispersion</em> &gt; 15</li>
</ol>
<p>Geralmente, dados de contagem em estudos ecológicos não seguem uma distribuição Poisson, pois há muita dispersão (variância) nos dados. Logo, o pressuposto da distribuição Poisson, i.e., de que a média e variância são descritas por um mesmo parâmetro (<span class="math inline">\(\lambda\)</span>) é quebrado.</p>
<p>Como vimos, <em>overdispersion</em> é um problema comum ao analisar dados ecológicos e deve necessariamente ser diagnosticado no modelo. Uma maneira de lidar com esse tipo de problema é utilizar uma outra distribuição diferente da Poisson. A binomial negativa pode ser entendida como uma mistura da distibuição Poisson e Gamma, ou seja, ela aceita dados de contagem que sejam positivos, mas sem zero. A grande vantagem desta distribuição é que, diferentemente da Poisson, ela tem um parâmetro para modelar a média (<span class="math inline">\(\lambda\)</span>) e outro para modelar a variância (<em>k</em>). Logo, ela permite modelar dados em que a média é diferente da variância. Vejamos um exemplo.</p>
<p>Aqui vamos continuar com estes dados para ver como o modelo se comporta com essa nova distribuição especificada. Para isso vamos utilizar a função <code>glm.nb</code> do pacote <code>MASS</code>.</p>
<p><strong>Modelagem</strong></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="cap8.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ajuste do modelo</span></span>
<span id="cb297-2"><a href="cap8.html#cb297-2" aria-hidden="true" tabindex="-1"></a>mod_nb <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(Riqueza_obs <span class="sc">~</span> dfrag, <span class="at">data =</span> fragmentos)</span></code></pre></div>
<p><strong>Diagnose resíduos</strong></p>
<p>Assim como fizemos com o modelo com Poisson, vamos agora diagnosticar os resíduos (Figura <a href="cap8.html#fig:fig-mod-nb-diag-bas">8.7</a>).</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="cap8.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnose</span></span>
<span id="cb298-2"><a href="cap8.html#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb298-3"><a href="cap8.html#cb298-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_nb)</span>
<span id="cb298-4"><a href="cap8.html#cb298-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb298-5"><a href="cap8.html#cb298-5" aria-hidden="true" tabindex="-1"></a>(chat <span class="ot">&lt;-</span> <span class="fu">deviance</span>(mod_nb) <span class="sc">/</span> <span class="fu">df.residual</span>(mod_nb)) <span class="co"># DISPERSION PARAMETER</span></span>
<span id="cb298-6"><a href="cap8.html#cb298-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.126184</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-nb-diag-bas"></span>
<img src="livro_files/figure-html/fig-mod-nb-diag-bas-1.png" alt="Diagnose básica dos resíduos do modelo GLM binomial Negativo." width="100%" height="100%" />
<p class="caption">
Figura 8.7: Diagnose básica dos resíduos do modelo GLM binomial Negativo.
</p>
</div>
<p>Compare estes gráficos (Figura <a href="#fig:fig-mod-nb-diag"><strong>??</strong></a>) com os do modelo anterior com distribuição Poisson (Figura <a href="cap8.html#fig:fig-mod-poi-diag-bas">8.2</a>). Eles são praticamente idênticos, ou seja, o modelo com Poisson já tinha homogeneidade de variância e não tinha problemas com normalidade dos resíduos. Agora vejamos se o problema com <em>overdispersion</em> foi resolvido (Figura <a href="cap8.html#fig:fig-mod-bn-diag-avan">8.8</a>).</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="cap8.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnose avançada</span></span>
<span id="cb299-2"><a href="cap8.html#cb299-2" aria-hidden="true" tabindex="-1"></a>simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> mod_nb, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-bn-diag-avan"></span>
<img src="livro_files/figure-html/fig-mod-bn-diag-avan-1.png" alt="Diagnose avançada dos resíduos do modelo GLM binomial Negativo." width="100%" height="100%" />
<p class="caption">
Figura 8.8: Diagnose avançada dos resíduos do modelo GLM binomial Negativo.
</p>
</div>
<p>Na diagnose do modelo pelo <code>DHARMa</code>, vemos que bastou mudar a distribuição de probabilidade que o problema de <em>overdispersion</em> foi resolvido (nenhum teste foi significativo no quadro da esquerda), e como já sabíamos, não há problemas com homogeneidade de variância (plot da direita mostrando a tendência entre o predito e resíduos pra cada quantil), nem de <em>outliers</em>. O <em>dispersion parameter</em> é mais próximo de 1 do que no modelo com Poisson. Agora sim podemos levar em conta o R<sup>2</sup>.</p>
<p><strong>Inferência</strong></p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="cap8.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Coeficiente de determinação</span></span>
<span id="cb300-2"><a href="cap8.html#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rsquared</span>(mod_nb)</span>
<span id="cb300-3"><a href="cap8.html#cb300-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Response                     family link     method  R.squared</span></span>
<span id="cb300-4"><a href="cap8.html#cb300-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Riqueza_obs Negative Binomial(14.7068)  log nagelkerke 0.02935674</span></span></code></pre></div>
<p>Mas esse valor parece ser um pouco menor do que anteriormente. Perceba que aqui utilizamos somente uma das funções apresentadas anteriormente, já que se trata de um modelo GLM com binomial negativa, calculamos o R<sup>2</sup> pelo método de Nagelkerke.</p>
<p><strong>Interpretação dos resultados</strong></p>
<p>Usando a função <code>summary()</code> podemos ter um resumo e descrição dos parâmetros do modelo.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="cap8.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Coeficientes estimados pelo modelo</span></span>
<span id="cb301-2"><a href="cap8.html#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_nb)</span>
<span id="cb301-3"><a href="cap8.html#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb301-4"><a href="cap8.html#cb301-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb301-5"><a href="cap8.html#cb301-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; glm.nb(formula = Riqueza_obs ~ dfrag, data = fragmentos, init.theta = 14.70679964, </span></span>
<span id="cb301-6"><a href="cap8.html#cb301-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     link = log)</span></span>
<span id="cb301-7"><a href="cap8.html#cb301-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb301-8"><a href="cap8.html#cb301-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb301-9"><a href="cap8.html#cb301-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb301-10"><a href="cap8.html#cb301-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2.7569  -0.7068   0.0694   0.6194   1.6546  </span></span>
<span id="cb301-11"><a href="cap8.html#cb301-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb301-12"><a href="cap8.html#cb301-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb301-13"><a href="cap8.html#cb301-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb301-14"><a href="cap8.html#cb301-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  2.30504    0.06481  35.567   &lt;2e-16 ***</span></span>
<span id="cb301-15"><a href="cap8.html#cb301-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dfrag        0.07248    0.06571   1.103     0.27    </span></span>
<span id="cb301-16"><a href="cap8.html#cb301-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb301-17"><a href="cap8.html#cb301-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb301-18"><a href="cap8.html#cb301-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb301-19"><a href="cap8.html#cb301-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for Negative Binomial(14.7068) family taken to be 1)</span></span>
<span id="cb301-20"><a href="cap8.html#cb301-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb301-21"><a href="cap8.html#cb301-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 44.002  on 39  degrees of freedom</span></span>
<span id="cb301-22"><a href="cap8.html#cb301-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 42.795  on 38  degrees of freedom</span></span>
<span id="cb301-23"><a href="cap8.html#cb301-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: 231.68</span></span>
<span id="cb301-24"><a href="cap8.html#cb301-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb301-25"><a href="cap8.html#cb301-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 1</span></span>
<span id="cb301-26"><a href="cap8.html#cb301-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb301-27"><a href="cap8.html#cb301-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb301-28"><a href="cap8.html#cb301-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Theta:  14.71 </span></span>
<span id="cb301-29"><a href="cap8.html#cb301-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Std. Err.:  8.62 </span></span>
<span id="cb301-30"><a href="cap8.html#cb301-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb301-31"><a href="cap8.html#cb301-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 x log-likelihood:  -225.68</span></span></code></pre></div>
<div class="alert alert-info">
<p><strong> 📝 Importante </strong><br />
Aqui vemos que o resultado em termos de valor de <em>P</em> não mudou, ou seja, a distância para o fragmento mais próximo não foi significativo. Mas vejam que o coeficiente (slope) mudou um pouco, antes era 0.0718 (SE=0.0507) e com binomial negativa passa a ser 0.07248 (SE=0.06571).</p>
</div>
<p><strong>Plot do modelo predito</strong></p>
<p>Vamos realizar a visualização do ajusto do modelo binomial Negativo (Figura <a href="cap8.html#fig:fig-mod-nb-model">8.9</a>).</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="cap8.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb302-2"><a href="cap8.html#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fragmentos, <span class="fu">aes</span>(dfrag, Riqueza_obs)) <span class="sc">+</span></span>
<span id="cb302-3"><a href="cap8.html#cb302-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb302-4"><a href="cap8.html#cb302-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm.nb&quot;</span>, <span class="at">formula =</span> y<span class="sc">~</span>x, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb302-5"><a href="cap8.html#cb302-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Distância para o fragmento mais próximo&quot;</span>, </span>
<span id="cb302-6"><a href="cap8.html#cb302-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Riqueza observada&quot;</span>) <span class="sc">+</span></span>
<span id="cb302-7"><a href="cap8.html#cb302-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-nb-model"></span>
<img src="livro_files/figure-html/fig-mod-nb-model-1.png" alt="Gráfico do GLM binomial Negativo." width="100%" height="100%" />
<p class="caption">
Figura 8.9: Gráfico do GLM binomial Negativo.
</p>
</div>
<p>Aqui vemos que a reta predita pelo modelo é muito similar ao que tivemos com o modelo Poisson. No entanto, agora que sabemos que este modelo com binomial negativa foi corretamente especificado e podemos confiar nos parâmetros estimados.</p>
</div>
</div>
<div id="dados-de-contagem-modelos-quasi-likelihood" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Dados de contagem: modelos quasi-likelihood</h2>
<p>Como dissemos acima, uma outra alternativa para ajustar modelos GLM a dados de contagem são os chamados “quasi-likelihood,” tais como quasi-Poisson e quasi-binomial. Dependendo do valor do <em>dispersion parameter</em>, pode ser útil escolher este tipo de modelo. No entanto, eles vêm com uma desvantagem: não é possível calcular o valor de <em>Akaike Information Criterion</em> (AIC) porque estes modelos não retornam um valor de <em>likelihood</em> (verosimilhança). Este parâmetro é comumente utilizado em abordagens estatísticas de teoria da informação para selecionar o melhor modelo que se ajusta aos dados. Neste caso, precisamos utilizar outras funções disponíveis nos pacotes <code>MuMIn</code>, <code>AICcmodavg</code> e <code>bbmle</code> para calcular o QAIC. Para mais detalhes sobre esses modelos, veja o vignette sobre o assunto do pacote <code>bbmle</code>.</p>
<p><strong>Análise</strong></p>
<p>Aqui vamos apenas exemplificar como um modelo com distribuição quasi-poisson pode ser especificado.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="cap8.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Modelo</span></span>
<span id="cb303-2"><a href="cap8.html#cb303-2" aria-hidden="true" tabindex="-1"></a>mod_quasipois <span class="ot">&lt;-</span> <span class="fu">glm</span>(Riqueza_obs <span class="sc">~</span> dfrag, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> fragmentos)</span></code></pre></div>
<p><strong>Diagnose dos resíduos</strong></p>
<p>A função <code>resid</code> não leva em conta a sobredispersão e temos de calcular manualmente o parâmetro de dispersão e inclui-lo no plot. Portanto, não podemos realizar a diagnose de modelos quasi-Poisson apenas com a função <code>plot</code> como fazíamos até então. Então, calculamos primeiramente os resíduos de Pearson e depois dividindo-o pela raiz quadrada do parâmetro de dispersão (Figura <a href="cap8.html#fig:fig-mod-quasi-poi-diag">8.10</a>).</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="cap8.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnose dos resíduos</span></span>
<span id="cb304-2"><a href="cap8.html#cb304-2" aria-hidden="true" tabindex="-1"></a>EP <span class="ot">&lt;-</span> <span class="fu">resid</span>(mod_quasipois, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb304-3"><a href="cap8.html#cb304-3" aria-hidden="true" tabindex="-1"></a>ED <span class="ot">&lt;-</span> <span class="fu">resid</span>(mod_quasipois, <span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>)</span>
<span id="cb304-4"><a href="cap8.html#cb304-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_quasipois, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb304-5"><a href="cap8.html#cb304-5" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> fragmentos<span class="sc">$</span>Riqueza_obs <span class="sc">-</span> mu</span>
<span id="cb304-6"><a href="cap8.html#cb304-6" aria-hidden="true" tabindex="-1"></a>EP2 <span class="ot">&lt;-</span> E <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fl">1.65662</span> <span class="sc">*</span> mu) <span class="co"># dispersion parameter da quasipoisson</span></span>
<span id="cb304-7"><a href="cap8.html#cb304-7" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb304-8"><a href="cap8.html#cb304-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> mu, <span class="at">y =</span> E, <span class="at">main =</span> <span class="st">&quot;Response residuals&quot;</span>)</span>
<span id="cb304-9"><a href="cap8.html#cb304-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> mu, <span class="at">y =</span> EP, <span class="at">main =</span> <span class="st">&quot;Pearson residuals&quot;</span>)</span>
<span id="cb304-10"><a href="cap8.html#cb304-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> mu, <span class="at">y =</span> EP2, <span class="at">main =</span> <span class="st">&quot;Pearson residuals scaled&quot;</span>)</span>
<span id="cb304-11"><a href="cap8.html#cb304-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> mu, <span class="at">y =</span> ED, <span class="at">main =</span> <span class="st">&quot;Deviance residuals&quot;</span>)</span>
<span id="cb304-12"><a href="cap8.html#cb304-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op)</span>
<span id="cb304-13"><a href="cap8.html#cb304-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-quasi-poi-diag"></span>
<img src="livro_files/figure-html/fig-mod-quasi-poi-diag-1.png" alt="Diagnose dos resíduos do modelo GLM Quasi-Poisson." width="100%" height="100%" />
<p class="caption">
Figura 8.10: Diagnose dos resíduos do modelo GLM Quasi-Poisson.
</p>
</div>
<p>Aqui vemos que não existe um padrão claro nos resíduos, muito similar ao que tínhamos anteriormente. Devido às limitações de distribuições “quasi” e dado que já temos um modelo adequado com binomial negativa, sugerimos interpretar apenas o modelo anterior com binomial negativa.</p>
</div>
<div id="dados-de-contagem-a-distribuição-binomial" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Dados de contagem: a distribuição binomial</h2>
<p>Quando temos dados de proporção (e.g., número de doentes por 1000 habitantes) ou incidência (i.e., presença ou ausência), a distribuição mais adequada para modelar os dados é a distribuição binomial. No entanto, temos que especificar o modelo de acordo com o tipo dos dados no argumento <code>formula</code>. Vejamos dois exemplos.</p>
<div id="análise-com-dados-de-proporção" class="section level3" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Análise com dados de proporção</h3>
<p>Neste exemplo, vamos ver como podemos modelar a proporção de células sanguíneas em função do tipo de tratamento.</p>
<p><strong>Explicação dos dados</strong></p>
<p>Este conjunto de dados foi coletado por <span class="citation">(<a href="#ref-Franco-Belussi2018a" role="doc-biblioref">Franco-Belussi et al., 2018</a>)</span>. Os autores utilizaram um desenho experimental típico de uma 2x5 ANOVA fatorial (ou <em>two-way</em> ANOVA) em que temos dois tratamentos (fatores): pigmentação do girino com dois níveis (Yes e No) e Tempo de exposição com cinco níveis (controle sem UV, 6 h, 12 h, 18 h e 24 h de exposição à UV).</p>
<p><strong>Pergunta</strong></p>
<p>A melanina proteje girinos contra os efeitos da radiação ultravioleta?</p>
<p><strong>Predições</strong></p>
<p>Como a melanina participa do sistema imune inato, ela desempenharia um papel na resposta do organismo à radiação UV, auxiliando as células imunes a combater os seus efeitos deletérios.</p>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variável resposta: Contagem diferencial de eosinófilos</li>
<li>data frame com 10 girinos em cada tratamento, totalizando 50 girinos</li>
</ul>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="cap8.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados</span></span>
<span id="cb305-2"><a href="cap8.html#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(uv_cells)</span>
<span id="cb305-3"><a href="cap8.html#cb305-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     UV Pigmentation Total_Cell Lymphocyte Neutrophil Basophil Monocyte Eosinophil</span></span>
<span id="cb305-4"><a href="cap8.html#cb305-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1.CT          Yes        100         80         18        0        0          2</span></span>
<span id="cb305-5"><a href="cap8.html#cb305-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 1.CT          Yes        100         74         17        6        0          3</span></span>
<span id="cb305-6"><a href="cap8.html#cb305-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 1.CT          Yes        100         78         22        0        0          0</span></span>
<span id="cb305-7"><a href="cap8.html#cb305-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 1.CT          Yes        100         87         13        0        0          0</span></span>
<span id="cb305-8"><a href="cap8.html#cb305-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 1.CT          Yes        100         74         21        1        0          4</span></span>
<span id="cb305-9"><a href="cap8.html#cb305-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 2.6h          Yes        100         95          4        0        0          1</span></span>
<span id="cb305-10"><a href="cap8.html#cb305-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-11"><a href="cap8.html#cb305-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Traduzir nomes das colunas e níveis de pigmentação </span></span>
<span id="cb305-12"><a href="cap8.html#cb305-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(uv_cells) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;UV&quot;</span>, <span class="st">&quot;Pigmentacao&quot;</span>, <span class="st">&quot;n_celulas&quot;</span>, <span class="st">&quot;linfocito&quot;</span>, <span class="st">&quot;neutrofilo&quot;</span>, <span class="st">&quot;basofilo&quot;</span>, <span class="st">&quot;monocito&quot;</span>, <span class="st">&quot;eosinofilo&quot;</span>)</span>
<span id="cb305-13"><a href="cap8.html#cb305-13" aria-hidden="true" tabindex="-1"></a>uv_cells<span class="sc">$</span>Pigmentacao[uv_cells<span class="sc">$</span>Pigmentacao<span class="sc">==</span><span class="st">&quot;Yes&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;sim&quot;</span></span>
<span id="cb305-14"><a href="cap8.html#cb305-14" aria-hidden="true" tabindex="-1"></a>uv_cells<span class="sc">$</span>Pigmentacao[uv_cells<span class="sc">$</span>Pigmentacao<span class="sc">==</span><span class="st">&quot;No&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;nao&quot;</span></span></code></pre></div>
<p>Vamos explorar os dados para tentar entender como são as relações (Figura <a href="cap8.html#fig:fig-mod-bin-pre">8.11</a>).</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="cap8.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb306-2"><a href="cap8.html#cb306-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-3"><a href="cap8.html#cb306-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular média e intervalo de confiança</span></span>
<span id="cb306-4"><a href="cap8.html#cb306-4" aria-hidden="true" tabindex="-1"></a>eosinofilo <span class="ot">&lt;-</span> <span class="fu">summarySE</span>(uv_cells, </span>
<span id="cb306-5"><a href="cap8.html#cb306-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">measurevar =</span> <span class="st">&quot;eosinofilo&quot;</span>,</span>
<span id="cb306-6"><a href="cap8.html#cb306-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">groupvars =</span> <span class="fu">c</span>(<span class="st">&quot;UV&quot;</span>, <span class="st">&quot;Pigmentacao&quot;</span>))</span>
<span id="cb306-7"><a href="cap8.html#cb306-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-8"><a href="cap8.html#cb306-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir posição de linhas e pontos no gráfico</span></span>
<span id="cb306-9"><a href="cap8.html#cb306-9" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="fl">0.1</span>)</span>
<span id="cb306-10"><a href="cap8.html#cb306-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-11"><a href="cap8.html#cb306-11" aria-hidden="true" tabindex="-1"></a>eosinofilo <span class="sc">%&gt;%</span> </span>
<span id="cb306-12"><a href="cap8.html#cb306-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> UV, <span class="at">y =</span> eosinofilo, <span class="at">colour =</span> Pigmentacao,</span>
<span id="cb306-13"><a href="cap8.html#cb306-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Pigmentacao, <span class="at">fill =</span> Pigmentacao)) <span class="sc">+</span></span>
<span id="cb306-14"><a href="cap8.html#cb306-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>eosinofilo<span class="sc">-</span>se, <span class="at">ymax=</span>eosinofilo <span class="sc">+</span>se), </span>
<span id="cb306-15"><a href="cap8.html#cb306-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">width=</span>.<span class="dv">1</span>, <span class="at">size =</span> <span class="fl">1.1</span>, <span class="at">position=</span>pd) <span class="sc">+</span></span>
<span id="cb306-16"><a href="cap8.html#cb306-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">position=</span>pd, <span class="at">size =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb306-17"><a href="cap8.html#cb306-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">21</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">position=</span>pd, <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb306-18"><a href="cap8.html#cb306-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb306-19"><a href="cap8.html#cb306-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb306-20"><a href="cap8.html#cb306-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;UV&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Eosinófilo&quot;</span>, <span class="at">fill=</span><span class="st">&quot;Pigmentação&quot;</span>, <span class="at">colour=</span><span class="st">&quot;Pigmentação&quot;</span>)<span class="sc">+</span></span>
<span id="cb306-21"><a href="cap8.html#cb306-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-bin-pre"></span>
<img src="livro_files/figure-html/fig-mod-bin-pre-1.png" alt="Gráfico para explorar as relações entre as variáveis." width="100%" height="100%" />
<p class="caption">
Figura 8.11: Gráfico para explorar as relações entre as variáveis.
</p>
</div>
<p>Aqui vemos que a quantidade de eosinófilos é muito maior nos girinos sem pigmentação (“albinos”). Já que estes animais não têm pigmentação melânica, as células brancas do sangue são a única ferramenta de combate aos efeitos deletérios da UV.</p>
<p><strong>Modelagem</strong></p>
<p>Aqui vamos usar o <code>cbind</code> no argumento <code>formula</code> para dizer que queremos modelar a contagem de eosinófilos <em>em relação ao número total de células, ou seja, sua proporção.</em> Aqui temos a contagem do número de eusinófilos (um tipo de célula da série branca do sangue) em lâminas histológicas de girinos da rã-touro (<em>Lithobates catesbeianus</em>) num total de 1000 células.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="cap8.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Modelo</span></span>
<span id="cb307-2"><a href="cap8.html#cb307-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(eosinofilo, n_celulas) <span class="sc">~</span> UV <span class="sc">*</span> Pigmentacao, <span class="at">family =</span> binomial, <span class="at">data =</span> uv_cells)</span></code></pre></div>
<p><strong>Diagnose básica dos resíduos do modelo</strong></p>
<p>Vamos fazer a diagnose básica dos resíduos do modelo (Figura <a href="cap8.html#fig:fig-mod-quasi-bin-diag-bas">8.12</a>).</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="cap8.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnose dos resíduos</span></span>
<span id="cb308-2"><a href="cap8.html#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb308-3"><a href="cap8.html#cb308-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1)</span>
<span id="cb308-4"><a href="cap8.html#cb308-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-quasi-bin-diag-bas"></span>
<img src="livro_files/figure-html/fig-mod-quasi-bin-diag-bas-1.png" alt="Diagnose básica dos resíduos do modelo GLM binomial." width="100%" height="100%" />
<p class="caption">
Figura 8.12: Diagnose básica dos resíduos do modelo GLM binomial.
</p>
</div>
<p>Parece que os resíduos não sofrem de heterogeneidade de variância (linha vermelha está reta), mas parece haver um pequeno desvio da normalidade (veja pontos 19, 29 e 32 destacados no plot de quantis e no de outliers). Vejamos o que o <code>DHARMa</code> nos diz (Figura <a href="cap8.html#fig:fig-mod-quasi-bin-diag-avan">8.13</a>).</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="cap8.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnose avançada</span></span>
<span id="cb309-2"><a href="cap8.html#cb309-2" aria-hidden="true" tabindex="-1"></a>simulationBion <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> mod1, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb309-3"><a href="cap8.html#cb309-3" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(mod1)</span>
<span id="cb309-4"><a href="cap8.html#cb309-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Probably bad model fit. Only about 29% of the residuals are inside the error bounds.</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-quasi-bin-diag-avan"></span>
<img src="livro_files/figure-html/fig-mod-quasi-bin-diag-avan-1.png" alt="Diagnose avançada dos resíduos do modelo GLM binomial." width="100%" height="100%" /><img src="livro_files/figure-html/fig-mod-quasi-bin-diag-avan-2.png" alt="Diagnose avançada dos resíduos do modelo GLM binomial." width="100%" height="100%" />
<p class="caption">
Figura 8.13: Diagnose avançada dos resíduos do modelo GLM binomial.
</p>
</div>
<p>Aqui já não resta dúvidas de que os resíduos deste modelo sofrem tanto com heterogeneidade de variância, quanto <em>overdispersion</em> e problemas com <em>outliers</em>. Provavelmente o problema com <em>outliers</em> ocorreu por conta do pequeno tamanho amostral.</p>
<p><strong>Inferência</strong></p>
<p>Sabemos que o modelo não parece ser adequado para os dados, mas vamos interpretá-lo mesmo assim para que possamos entender a saída da função <code>summary()</code> e os contrastes entre os níveis dos fatores.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="cap8.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Coeficientes estimados pelo modelo</span></span>
<span id="cb310-2"><a href="cap8.html#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span>
<span id="cb310-3"><a href="cap8.html#cb310-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-4"><a href="cap8.html#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb310-5"><a href="cap8.html#cb310-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; glm(formula = cbind(eosinofilo, n_celulas) ~ UV * Pigmentacao, </span></span>
<span id="cb310-6"><a href="cap8.html#cb310-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     family = binomial, data = uv_cells)</span></span>
<span id="cb310-7"><a href="cap8.html#cb310-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-8"><a href="cap8.html#cb310-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb310-9"><a href="cap8.html#cb310-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb310-10"><a href="cap8.html#cb310-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -5.4165  -2.5266  -1.0148   0.8068   8.8233  </span></span>
<span id="cb310-11"><a href="cap8.html#cb310-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-12"><a href="cap8.html#cb310-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb310-13"><a href="cap8.html#cb310-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                        Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb310-14"><a href="cap8.html#cb310-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)            -1.84516    0.12107 -15.241  &lt; 2e-16 ***</span></span>
<span id="cb310-15"><a href="cap8.html#cb310-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; UV2.6h                 -0.17979    0.17835  -1.008   0.3134    </span></span>
<span id="cb310-16"><a href="cap8.html#cb310-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; UV3.12h                 0.38414    0.15899   2.416   0.0157 *  </span></span>
<span id="cb310-17"><a href="cap8.html#cb310-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; UV4.18h                -0.49825    0.19363  -2.573   0.0101 *  </span></span>
<span id="cb310-18"><a href="cap8.html#cb310-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; UV5.24h                -0.39916    0.18848  -2.118   0.0342 *  </span></span>
<span id="cb310-19"><a href="cap8.html#cb310-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Pigmentacaosim         -2.17222    0.35745  -6.077 1.22e-09 ***</span></span>
<span id="cb310-20"><a href="cap8.html#cb310-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; UV2.6h:Pigmentacaosim  -0.07152    0.53831  -0.133   0.8943    </span></span>
<span id="cb310-21"><a href="cap8.html#cb310-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; UV3.12h:Pigmentacaosim -0.38414    0.50150  -0.766   0.4437    </span></span>
<span id="cb310-22"><a href="cap8.html#cb310-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; UV4.18h:Pigmentacaosim  1.13424    0.45981   2.467   0.0136 *  </span></span>
<span id="cb310-23"><a href="cap8.html#cb310-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; UV5.24h:Pigmentacaosim  0.68684    0.48370   1.420   0.1556    </span></span>
<span id="cb310-24"><a href="cap8.html#cb310-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb310-25"><a href="cap8.html#cb310-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb310-26"><a href="cap8.html#cb310-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-27"><a href="cap8.html#cb310-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb310-28"><a href="cap8.html#cb310-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-29"><a href="cap8.html#cb310-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 737.36  on 49  degrees of freedom</span></span>
<span id="cb310-30"><a href="cap8.html#cb310-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 460.85  on 40  degrees of freedom</span></span>
<span id="cb310-31"><a href="cap8.html#cb310-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: 610.35</span></span>
<span id="cb310-32"><a href="cap8.html#cb310-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-33"><a href="cap8.html#cb310-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span>
<span id="cb310-34"><a href="cap8.html#cb310-34" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1)</span>
<span id="cb310-35"><a href="cap8.html#cb310-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb310-36"><a href="cap8.html#cb310-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-37"><a href="cap8.html#cb310-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: binomial, link: logit</span></span>
<span id="cb310-38"><a href="cap8.html#cb310-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-39"><a href="cap8.html#cb310-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: cbind(eosinofilo, n_celulas)</span></span>
<span id="cb310-40"><a href="cap8.html#cb310-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-41"><a href="cap8.html#cb310-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb310-42"><a href="cap8.html#cb310-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-43"><a href="cap8.html#cb310-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb310-44"><a href="cap8.html#cb310-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Df Deviance Resid. Df Resid. Dev</span></span>
<span id="cb310-45"><a href="cap8.html#cb310-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL                              49     737.36</span></span>
<span id="cb310-46"><a href="cap8.html#cb310-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; UV              4   26.034        45     711.32</span></span>
<span id="cb310-47"><a href="cap8.html#cb310-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Pigmentacao     1  235.682        44     475.64</span></span>
<span id="cb310-48"><a href="cap8.html#cb310-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; UV:Pigmentacao  4   14.789        40     460.85</span></span></code></pre></div>
<p>Aqui temos tanto a tabela com os resultados por níveis dos fatores (<code>summary()</code>), quanto a tabela com a <em>Deviance</em> que mostra os fatores e suas interações (<code>anova()</code>). Vemos que nenhum fator foi significativo. Caso houvesse algum fator significativo, poderíamos testar a significância de cada nível dos fatores usando contrastes, desta forma.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="cap8.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Parâmetros</span></span>
<span id="cb311-2"><a href="cap8.html#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">emmeans</span>(mod1, <span class="sc">~</span> UV<span class="sc">|</span>Pigmentacao))</span>
<span id="cb311-3"><a href="cap8.html#cb311-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Pigmentacao = nao:</span></span>
<span id="cb311-4"><a href="cap8.html#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast      estimate    SE  df z.ratio p.value</span></span>
<span id="cb311-5"><a href="cap8.html#cb311-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.CT - 2.6h     0.1798 0.178 Inf   1.008  0.8518</span></span>
<span id="cb311-6"><a href="cap8.html#cb311-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.CT - 3.12h   -0.3841 0.159 Inf  -2.416  0.1109</span></span>
<span id="cb311-7"><a href="cap8.html#cb311-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.CT - 4.18h    0.4982 0.194 Inf   2.573  0.0753</span></span>
<span id="cb311-8"><a href="cap8.html#cb311-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.CT - 5.24h    0.3992 0.188 Inf   2.118  0.2124</span></span>
<span id="cb311-9"><a href="cap8.html#cb311-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.6h - 3.12h   -0.5639 0.167 Inf  -3.384  0.0064</span></span>
<span id="cb311-10"><a href="cap8.html#cb311-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.6h - 4.18h    0.3185 0.200 Inf   1.593  0.5021</span></span>
<span id="cb311-11"><a href="cap8.html#cb311-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.6h - 5.24h    0.2194 0.195 Inf   1.125  0.7933</span></span>
<span id="cb311-12"><a href="cap8.html#cb311-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3.12h - 4.18h   0.8824 0.183 Inf   4.824  &lt;.0001</span></span>
<span id="cb311-13"><a href="cap8.html#cb311-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3.12h - 5.24h   0.7833 0.177 Inf   4.414  0.0001</span></span>
<span id="cb311-14"><a href="cap8.html#cb311-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4.18h - 5.24h  -0.0991 0.209 Inf  -0.474  0.9897</span></span>
<span id="cb311-15"><a href="cap8.html#cb311-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb311-16"><a href="cap8.html#cb311-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Pigmentacao = sim:</span></span>
<span id="cb311-17"><a href="cap8.html#cb311-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast      estimate    SE  df z.ratio p.value</span></span>
<span id="cb311-18"><a href="cap8.html#cb311-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.CT - 2.6h     0.2513 0.508 Inf   0.495  0.9879</span></span>
<span id="cb311-19"><a href="cap8.html#cb311-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.CT - 3.12h    0.0000 0.476 Inf   0.000  1.0000</span></span>
<span id="cb311-20"><a href="cap8.html#cb311-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.CT - 4.18h   -0.6360 0.417 Inf  -1.525  0.5461</span></span>
<span id="cb311-21"><a href="cap8.html#cb311-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.CT - 5.24h   -0.2877 0.445 Inf  -0.646  0.9675</span></span>
<span id="cb311-22"><a href="cap8.html#cb311-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.6h - 3.12h   -0.2513 0.508 Inf  -0.495  0.9879</span></span>
<span id="cb311-23"><a href="cap8.html#cb311-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.6h - 4.18h   -0.8873 0.454 Inf  -1.957  0.2876</span></span>
<span id="cb311-24"><a href="cap8.html#cb311-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.6h - 5.24h   -0.5390 0.480 Inf  -1.123  0.7942</span></span>
<span id="cb311-25"><a href="cap8.html#cb311-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3.12h - 4.18h  -0.6360 0.417 Inf  -1.525  0.5461</span></span>
<span id="cb311-26"><a href="cap8.html#cb311-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3.12h - 5.24h  -0.2877 0.445 Inf  -0.646  0.9675</span></span>
<span id="cb311-27"><a href="cap8.html#cb311-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4.18h - 5.24h   0.3483 0.382 Inf   0.911  0.8928</span></span>
<span id="cb311-28"><a href="cap8.html#cb311-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb311-29"><a href="cap8.html#cb311-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Results are given on the log odds ratio (not the response) scale. </span></span>
<span id="cb311-30"><a href="cap8.html#cb311-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; P value adjustment: tukey method for comparing a family of 5 estimates</span></span></code></pre></div>
<p>Aqui temos o valor de cada combinação de níveis dos fatores, com seu respectivo valor de contraste e o valor de <em>P</em>. Vemos que para girinos sem pigmentação, apenas três contrastes foram significativos.</p>
<p><strong>Plot do modelo predito</strong></p>
<p>Vamos realizar a visualização do ajusto do modelo binomial (Figura <a href="cap8.html#fig:fig-mod-bin-model">8.14</a>).</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="cap8.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(uv_cells, <span class="fu">aes</span>(UV, eosinofilo)) <span class="sc">+</span></span>
<span id="cb312-2"><a href="cap8.html#cb312-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">color =</span> Pigmentacao)) <span class="sc">+</span></span>
<span id="cb312-3"><a href="cap8.html#cb312-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">shape =</span> <span class="dv">16</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.1</span>), <span class="at">cex =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb312-4"><a href="cap8.html#cb312-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb312-5"><a href="cap8.html#cb312-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-bin-model"></span>
<img src="livro_files/figure-html/fig-mod-bin-model-1.png" alt="Gráfico do GLM binomial." width="100%" height="100%" />
<p class="caption">
Figura 8.14: Gráfico do GLM binomial.
</p>
</div>
<p>Usando o <code>geom_violin()</code>, podemos perceber que existe uma dispersão maior nos tratamentos que utilizaram girinos sem pigmentação do que nos tratamentos com girinos pigmentados.</p>
</div>
</div>
<div id="análise-com-dados-de-incidência" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> Análise com dados de incidência</h2>
<p>Uma outra aplicação da distribuição binomial é quando temos dados de incidência, ou seja, presença ou ausência, de alguma variável. Por exemplo, presença ou ausência de uma espécie ou indivíduo num local. Neste caso a <code>formula</code> é diferente e o modelo é similar a uma regressão logística, vejamos.</p>
<p>Aqui vamos utilizar os dados sobre autotomia da cauda de lagartos da espécie <em>Coleodactylus meridionalis</em> observados em fragmentos florestais da Mata Atlântica no estado de Pernambuco <span class="citation">(<a href="#ref-oliveira2020" role="doc-biblioref">C. N. Oliveira et al., 2020</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<p>A probabilidade de lagartos da espécie <em>Coleodactylus meridionalis</em> perderem (autotomizarem) a cauda aumenta com o tamanho do corpo e de acordo com o sexo dos lagarto?</p>
<p><strong>Predições</strong></p>
<p>Quanto maior o lagarto, maior a probabilidade de autotomia da cauda e que esta resposta poderia também diferir entre sexos devido ao dimorfismo sexual.</p>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variável resposta: Presença ou ausência de cauda autotomizada em lagartos encontrados por busca ativa</li>
</ul>
<p><strong>Exploração dos dados</strong></p>
<p>Este conjunto de dados possui muitas entradas faltantes (codificadas como <code>NA</code>). Primeiro vamos visualizar o conjunto de dados e depois precisamos remover as linhas que contêm dados faltantes. Aqui podemos usar a função interna do <code>ggplot2::remove_missing()</code> para remover linhas cujas variáveis informadas no argumento estejam faltando, vejamos (Figura <a href="cap8.html#fig:fig-mod-inc-na">8.15</a>).</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="cap8.html#cb313-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-2"><a href="cap8.html#cb313-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Traduzir nomes das colunas e níveis de pigmentação </span></span>
<span id="cb313-3"><a href="cap8.html#cb313-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lagartos)</span>
<span id="cb313-4"><a href="cap8.html#cb313-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Numero    Sex   SVL Intact_tail_length Autotomized_tail_length Tail_state</span></span>
<span id="cb313-5"><a href="cap8.html#cb313-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      2   Male 20.70                 NA                   12.88          0</span></span>
<span id="cb313-6"><a href="cap8.html#cb313-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      3   Male 21.10                 NA                   13.07          0</span></span>
<span id="cb313-7"><a href="cap8.html#cb313-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      6 Female 23.72                 NA                   17.56          0</span></span>
<span id="cb313-8"><a href="cap8.html#cb313-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      9   Male 18.84              17.38                      NA          1</span></span>
<span id="cb313-9"><a href="cap8.html#cb313-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     21   Male 22.20                 NA                   16.50          0</span></span>
<span id="cb313-10"><a href="cap8.html#cb313-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     22   &lt;NA&gt; 20.59                 NA                   12.46          0</span></span>
<span id="cb313-11"><a href="cap8.html#cb313-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(lagartos) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;numero&quot;</span>, <span class="st">&quot;sexo&quot;</span>, <span class="st">&quot;SVL&quot;</span>, <span class="st">&quot;comprimento_cauda&quot;</span>, <span class="st">&quot;cauda_autotomizada&quot;</span>, <span class="st">&quot;estado_cauda&quot;</span>)</span>
<span id="cb313-12"><a href="cap8.html#cb313-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-13"><a href="cap8.html#cb313-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-14"><a href="cap8.html#cb313-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados faltantes</span></span>
<span id="cb313-15"><a href="cap8.html#cb313-15" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_dat</span>(lagartos)</span>
<span id="cb313-16"><a href="cap8.html#cb313-16" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(lagartos, <span class="at">cluster =</span> <span class="cn">TRUE</span>) <span class="co"># 22.9% dos dados estão faltando</span></span>
<span id="cb313-17"><a href="cap8.html#cb313-17" aria-hidden="true" tabindex="-1"></a>dados_semNA <span class="ot">&lt;-</span> <span class="fu">remove_missing</span>(lagartos, <span class="at">vars =</span> <span class="st">&quot;sexo&quot;</span>) <span class="co"># excluindo linhas com dados faltantes para a variável Sex</span></span>
<span id="cb313-18"><a href="cap8.html#cb313-18" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(dados_semNA)</span>
<span id="cb313-19"><a href="cap8.html#cb313-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dados_semNA) <span class="co"># verificar as dimensões da tabela depois que os dados tiverem sido excluídos</span></span>
<span id="cb313-20"><a href="cap8.html#cb313-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 139   6</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-inc-na"></span>
<img src="livro_files/figure-html/fig-mod-inc-na-1.png" alt="Gráficos para explorar os dados faltantes." width="100%" height="100%" /><img src="livro_files/figure-html/fig-mod-inc-na-2.png" alt="Gráficos para explorar os dados faltantes." width="100%" height="100%" /><img src="livro_files/figure-html/fig-mod-inc-na-3.png" alt="Gráficos para explorar os dados faltantes." width="100%" height="100%" />
<p class="caption">
Figura 8.15: Gráficos para explorar os dados faltantes.
</p>
</div>
<p>Agora, seguindo o que já estamos acostumados a fazer, vamos vizualisar os dados com a nossa hipótese (Figura <a href="cap8.html#fig:fig-mod-inc-pre">8.16</a>).</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="cap8.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb314-2"><a href="cap8.html#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados_semNA, <span class="fu">aes</span>(SVL, estado_cauda)) <span class="sc">+</span></span>
<span id="cb314-3"><a href="cap8.html#cb314-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> sexo, <span class="at">colour =</span> sexo), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb314-4"><a href="cap8.html#cb314-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)) <span class="sc">+</span></span>
<span id="cb314-5"><a href="cap8.html#cb314-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Estado da Cauda&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Comprimento Rostro-Cloacal (mm)&quot;</span>, <span class="at">shape =</span> <span class="st">&quot;Sexo&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;Sexo&quot;</span>) <span class="sc">+</span></span>
<span id="cb314-6"><a href="cap8.html#cb314-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-inc-pre"></span>
<img src="livro_files/figure-html/fig-mod-inc-pre-1.png" alt="Gráfico para explorar as relações entre as variáveis." width="100%" height="100%" />
<p class="caption">
Figura 8.16: Gráfico para explorar as relações entre as variáveis.
</p>
</div>
<p><strong>Modelagem</strong></p>
<p>Aqui vamos construir dois modelos com a mesma distribuição binomial, mas com dois <em>link function</em>: logit e probit. A função logit possui caudas um pouco mais achatadas, isto é, a curva probit se aproxima dos eixos mais rapidamente que a logit. Geralmente não há muita diferença entre elas. Como não temos nenhuma expectativa de qual dos dois link function é o melhor, podemos fazer uma seleção de modelos.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="cap8.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Modelos</span></span>
<span id="cb315-2"><a href="cap8.html#cb315-2" aria-hidden="true" tabindex="-1"></a>mod_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(estado_cauda <span class="sc">~</span> SVL <span class="sc">*</span> sexo, <span class="at">data =</span> dados_semNA, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb315-3"><a href="cap8.html#cb315-3" aria-hidden="true" tabindex="-1"></a>mod_pro <span class="ot">&lt;-</span> <span class="fu">glm</span>(estado_cauda <span class="sc">~</span> SVL <span class="sc">*</span> sexo, <span class="at">data =</span> dados_semNA, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>))</span>
<span id="cb315-4"><a href="cap8.html#cb315-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-5"><a href="cap8.html#cb315-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleção de modelos</span></span>
<span id="cb315-6"><a href="cap8.html#cb315-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AICctab</span>(mod_log, mod_pro, <span class="at">nobs =</span> <span class="dv">139</span>)</span>
<span id="cb315-7"><a href="cap8.html#cb315-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         dAICc df</span></span>
<span id="cb315-8"><a href="cap8.html#cb315-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mod_pro 0.0   4 </span></span>
<span id="cb315-9"><a href="cap8.html#cb315-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mod_log 0.1   4</span></span></code></pre></div>
<p>Existe pouca diferença entre o modelo probit e logit. Como o modelo logit é mais simples vamos interpretá-lo apenas.</p>
<p><strong>Diagnose dos resíduos do modelo</strong></p>
<p>Vamos fazer a diagnose dos resíduos do modelo (Figura <a href="cap8.html#fig:fig-mod-inc-diag">8.17</a>).</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="cap8.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnóse avançada</span></span>
<span id="cb316-2"><a href="cap8.html#cb316-2" aria-hidden="true" tabindex="-1"></a>simulationBion <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> mod_log, <span class="at">plot =</span> T)</span>
<span id="cb316-3"><a href="cap8.html#cb316-3" aria-hidden="true" tabindex="-1"></a><span class="fu">binned_residuals</span>(mod_log)</span>
<span id="cb316-4"><a href="cap8.html#cb316-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: About 92% of the residuals are inside the error bounds (~95% or higher would be good).</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-inc-diag"></span>
<img src="livro_files/figure-html/fig-mod-inc-diag-1.png" alt="Diagnose avançada dos resíduos do modelo GLM binomial de incidência." width="100%" height="100%" /><img src="livro_files/figure-html/fig-mod-inc-diag-2.png" alt="Diagnose avançada dos resíduos do modelo GLM binomial de incidência." width="100%" height="100%" />
<p class="caption">
Figura 8.17: Diagnose avançada dos resíduos do modelo GLM binomial de incidência.
</p>
</div>
<p><strong>Inferência</strong></p>
<p>Para modelos com parâmetro de dispersão conhecida (e.g., binomial e Poisson), o chi-quadrado é a estatística mais apropriada.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="cap8.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Coeficientes estimados pelo modelo</span></span>
<span id="cb317-2"><a href="cap8.html#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_log)</span>
<span id="cb317-3"><a href="cap8.html#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb317-4"><a href="cap8.html#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb317-5"><a href="cap8.html#cb317-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; glm(formula = estado_cauda ~ SVL * sexo, family = binomial(link = &quot;logit&quot;), </span></span>
<span id="cb317-6"><a href="cap8.html#cb317-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = dados_semNA)</span></span>
<span id="cb317-7"><a href="cap8.html#cb317-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb317-8"><a href="cap8.html#cb317-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb317-9"><a href="cap8.html#cb317-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb317-10"><a href="cap8.html#cb317-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1.5694  -1.0449  -0.8196   1.2181   1.6310  </span></span>
<span id="cb317-11"><a href="cap8.html#cb317-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb317-12"><a href="cap8.html#cb317-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb317-13"><a href="cap8.html#cb317-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span id="cb317-14"><a href="cap8.html#cb317-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)    5.5834     2.5909   2.155   0.0312 *</span></span>
<span id="cb317-15"><a href="cap8.html#cb317-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SVL           -0.2678     0.1178  -2.274   0.0230 *</span></span>
<span id="cb317-16"><a href="cap8.html#cb317-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sexoMale       0.6977     4.4055   0.158   0.8742  </span></span>
<span id="cb317-17"><a href="cap8.html#cb317-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SVL:sexoMale  -0.0442     0.2085  -0.212   0.8321  </span></span>
<span id="cb317-18"><a href="cap8.html#cb317-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb317-19"><a href="cap8.html#cb317-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb317-20"><a href="cap8.html#cb317-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb317-21"><a href="cap8.html#cb317-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb317-22"><a href="cap8.html#cb317-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb317-23"><a href="cap8.html#cb317-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 191.07  on 138  degrees of freedom</span></span>
<span id="cb317-24"><a href="cap8.html#cb317-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 181.38  on 135  degrees of freedom</span></span>
<span id="cb317-25"><a href="cap8.html#cb317-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: 189.38</span></span>
<span id="cb317-26"><a href="cap8.html#cb317-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb317-27"><a href="cap8.html#cb317-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span id="cb317-28"><a href="cap8.html#cb317-28" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_log, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span> )</span>
<span id="cb317-29"><a href="cap8.html#cb317-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb317-30"><a href="cap8.html#cb317-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb317-31"><a href="cap8.html#cb317-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: binomial, link: logit</span></span>
<span id="cb317-32"><a href="cap8.html#cb317-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb317-33"><a href="cap8.html#cb317-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: estado_cauda</span></span>
<span id="cb317-34"><a href="cap8.html#cb317-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb317-35"><a href="cap8.html#cb317-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb317-36"><a href="cap8.html#cb317-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb317-37"><a href="cap8.html#cb317-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb317-38"><a href="cap8.html#cb317-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df Deviance Resid. Df Resid. Dev Pr(&gt;Chi)   </span></span>
<span id="cb317-39"><a href="cap8.html#cb317-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL                       138     191.07            </span></span>
<span id="cb317-40"><a href="cap8.html#cb317-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SVL       1   9.2563       137     181.82 0.002347 **</span></span>
<span id="cb317-41"><a href="cap8.html#cb317-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sexo      1   0.3920       136     181.43 0.531262   </span></span>
<span id="cb317-42"><a href="cap8.html#cb317-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SVL:sexo  1   0.0454       135     181.38 0.831292   </span></span>
<span id="cb317-43"><a href="cap8.html#cb317-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb317-44"><a href="cap8.html#cb317-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p><strong>Interpretação dos resultados</strong></p>
<p>A interpretação dos resultados é que o tamanho de corpo (SVL) afeta negativamente a probabilidade da cauda estar intacta, i.e., com o aumento do tamanho, a probabilidade da cauda permanecer intacta diminui. A interação não foi significativa, então o efeito é independente do sexo dos lagartos.</p>
</div>
<div id="dados-de-contagem-com-excesso-de-zeros" class="section level2" number="8.8">
<h2><span class="header-section-number">8.8</span> Dados de contagem com excesso de zeros</h2>
<p>Quando se analisa a abundância ou riqueza de espécies é comum que tenhamos dados com muitos zeros. Esse fenômeno pode ser causado por vários processos ecológicos, tais como locais fora do nicho da espécie, falha na detecção, amostras feitas fora do habitat ou em locais onde não se espera encontrar a espécie <span class="citation">(<a href="#ref-blascomoreno2019" role="doc-biblioref">Blasco‐Moreno et al., 2019</a>)</span>. Esse tipo de dado é problemático porque rompe com os pressupostos da distribuição Poisson e binomial negativa, podendo inclusive ser uma das causas da <em>overdispersion</em>.</p>
<p>Nesses casos, temos de ajustar modelos que levam em conta esse excesso de zeros nos dados. Esses modelos são chamados de <strong>zero-inflated</strong> e <strong>hurdle models</strong> (também chamados de <em>zero-altered models</em>), dependendo de como o processo que causou os zeros é modelado.</p>
<p><em>Hurdle models</em> (ou <em>zero-altered models</em>) modelam os dados dividindo-os em dois subconjuntos: um no qual reduzimos os dados à presença-ausência, ou seja, todos os dados maiores que 1 são transformados em 1 e usamos, por exemplo, uma distribuição binomial; e uma outra parte que só considera os valores positivos sem zero, utilizando uma Poisson ou binomial negativa truncadas. Ao fazer isso, a distribuição truncada assume que os zeros são gerados tanto por processos ecológicos, quanto erros de amostragem (ou seja, é impossível distinguir entre essas duas fontes). Portanto, esses zeros são excluídos da distribuição com dados de contagem. Por exemplo, se uma distribuição binomial negativa for usada para modelar a parte quantitativa, chamamos o modelo de <em>Zero-altered Negative binomial</em>. A interpretação dos modelos deve ser feita de forma conjunta.</p>
<p>Modelos com zero inflados funcionam de maneira similar, mas permitem que a distribuição Poisson contenha zeros, ou seja, <em>não é utilizada uma distribuição truncada</em>. Ao fazer isso, esta distribuição de Poisson pressupõe que os zeros foram gerados por um processo ecológico real, tal como, ausência de habitat adequado.</p>
<p>Para ilustrar como podemos lidar com conjuntos de dados complexos, vamos utilizar os dados do parasita <em>Raillietiella mottae</em> infectando duas espécies de lagartos que ocorrem no Nordeste Brasileiro <span class="citation">(<a href="#ref-lima2018" role="doc-biblioref">Lima et al., 2018</a>)</span>. Ao todo, 63 indivíduos de <em>Hemidactylus agrius</em> e 132 de <em>Phyllopezus pollicaris</em> foram amostrados.</p>
<p><strong>Pergunta</strong></p>
<p>Quais atributos de história de vida dos lagartos são relacionados com o volume (<em>load</em>) de infecção, tais como tamanho e sexo?</p>
<p><strong>Predições</strong></p>
<p>Quanto maior o lagarto, maior o número de parasitas encontrados, esta resposta poderia também diferir entre sexos devido ao dimorfismo sexual.</p>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variável resposta: número do parasita <em>Raillietiella mottae</em>, que é um crustáceo parasita, infectando o aparelho respiratório e intestinal de lagartos.</li>
</ul>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="cap8.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Cabeçalho dos dados</span></span>
<span id="cb318-2"><a href="cap8.html#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(parasitas)</span>
<span id="cb318-3"><a href="cap8.html#cb318-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Especie Sexo CRC Raillietiella_mottae</span></span>
<span id="cb318-4"><a href="cap8.html#cb318-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; W124 Phyllopezus_pollicaris    F  61                    3</span></span>
<span id="cb318-5"><a href="cap8.html#cb318-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; W125 Phyllopezus_pollicaris    F  56                    0</span></span>
<span id="cb318-6"><a href="cap8.html#cb318-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; W127 Phyllopezus_pollicaris    M  61                    0</span></span>
<span id="cb318-7"><a href="cap8.html#cb318-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; W128 Phyllopezus_pollicaris    M  48                    0</span></span>
<span id="cb318-8"><a href="cap8.html#cb318-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; W129 Phyllopezus_pollicaris    F  40                    0</span></span>
<span id="cb318-9"><a href="cap8.html#cb318-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; W130 Phyllopezus_pollicaris    M  62                    0</span></span></code></pre></div>
<p>Vamos explorar os dados (Figura <a href="cap8.html#fig:fig-mod-zero-pre">8.18</a>).</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="cap8.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráficos</span></span>
<span id="cb319-2"><a href="cap8.html#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parasitas, <span class="fu">aes</span>(Raillietiella_mottae, <span class="at">fill =</span> Especie)) <span class="sc">+</span></span>
<span id="cb319-3"><a href="cap8.html#cb319-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb319-4"><a href="cap8.html#cb319-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(Especie <span class="sc">~</span> Sexo) <span class="sc">+</span></span>
<span id="cb319-5"><a href="cap8.html#cb319-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb319-6"><a href="cap8.html#cb319-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tema_livro</span>() <span class="sc">+</span></span>
<span id="cb319-7"><a href="cap8.html#cb319-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb319-8"><a href="cap8.html#cb319-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-9"><a href="cap8.html#cb319-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parasitas, <span class="fu">aes</span>(CRC, Raillietiella_mottae, <span class="at">fill =</span> Especie)) <span class="sc">+</span></span>
<span id="cb319-10"><a href="cap8.html#cb319-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb319-11"><a href="cap8.html#cb319-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(Sexo <span class="sc">~</span> Especie) <span class="sc">+</span></span>
<span id="cb319-12"><a href="cap8.html#cb319-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb319-13"><a href="cap8.html#cb319-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb319-14"><a href="cap8.html#cb319-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Comprimento Rostro-Cloacal&quot;</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;Raillietiella mottae&quot;</span>)))<span class="sc">+</span></span>
<span id="cb319-15"><a href="cap8.html#cb319-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-zero-pre"></span>
<img src="livro_files/figure-html/fig-mod-zero-pre-1.png" alt="Gráfico para explorar as relações entre as variáveis." width="100%" height="100%" /><img src="livro_files/figure-html/fig-mod-zero-pre-2.png" alt="Gráfico para explorar as relações entre as variáveis." width="100%" height="100%" />
<p class="caption">
Figura 8.18: Gráfico para explorar as relações entre as variáveis.
</p>
</div>
<p>Os gráfico acima mostram a contagem do parasita <em>Raillietiella mottae</em> nos dois sexos (F e M para fêmea e macho) nas duas espécies de lagartos (<em>Hemidactylus agrius</em> e <em>Phyllopezus pollicaris</em>), tanto na forma de uma distribuição de densidade, quanto de gráfico de dispersão. Aqui podemos ver que de fato existe um excesso de zeros principalmente em <em>P. pollicaris</em>.</p>
<p>Quando nos deparamos com dados complexos assim, a estratégia é sempre começar com um modelo simples e depois adicionar mais parâmetros. Portanto, vamos iniciar com um modelo Poisson, mesmo sabendo que ele muito provavelmente não será adequado para modelar estes dados.</p>
<p><strong>Modelagem</strong></p>
<p>Ajuste do modelo Poisson.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="cap8.html#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Modelo</span></span>
<span id="cb320-2"><a href="cap8.html#cb320-2" aria-hidden="true" tabindex="-1"></a>pois_plain <span class="ot">&lt;-</span> <span class="fu">glm</span>(Raillietiella_mottae <span class="sc">~</span> CRC <span class="sc">+</span> Sexo <span class="sc">*</span> Especie, <span class="at">data =</span> parasitas, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>)</span></code></pre></div>
<p><strong>Diagnose</strong></p>
<p>Aqui vamos utilizar as funções do pacote <code>performance</code> novamente (Figura <a href="#fig:fig-mod-pois-zero-diag"><strong>??</strong></a>) para o GLM Poisson.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="cap8.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnose avançada</span></span>
<span id="cb321-2"><a href="cap8.html#cb321-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_zeroinflation</span>(pois_plain) <span class="co"># para diagnosticar se o modelo sofre de zero inflation</span></span>
<span id="cb321-3"><a href="cap8.html#cb321-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Check for zero-inflation</span></span>
<span id="cb321-4"><a href="cap8.html#cb321-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb321-5"><a href="cap8.html#cb321-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Observed zeros: 156</span></span>
<span id="cb321-6"><a href="cap8.html#cb321-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Predicted zeros: 140</span></span>
<span id="cb321-7"><a href="cap8.html#cb321-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Ratio: 0.90</span></span>
<span id="cb321-8"><a href="cap8.html#cb321-8" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(pois_plain)</span>
<span id="cb321-9"><a href="cap8.html#cb321-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Overdispersion test</span></span>
<span id="cb321-10"><a href="cap8.html#cb321-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb321-11"><a href="cap8.html#cb321-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        dispersion ratio =   1.932</span></span>
<span id="cb321-12"><a href="cap8.html#cb321-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Pearson&#39;s Chi-Squared = 367.133</span></span>
<span id="cb321-13"><a href="cap8.html#cb321-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 p-value = &lt; 0.001</span></span></code></pre></div>
<p>A diagnose não só nos disse que o modelo possui <em>overdispersion</em>, como também de <em>zero-inflation</em>, como já esperávamos. Vejamos então como melhorar o nosso modelo para lidar com esses dois problemas. Especificamente, vamos utilizar um modelo <em>Hurdle</em> com binomial negativa truncada (ou seja, desconsiderando os zeros), e um outro modelo <em>zero-inflated</em> usando uma distribuição binomial negativa.
Aqui vamos utilizar o pacote <code>glmmTMB</code>.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="cap8.html#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Modelos</span></span>
<span id="cb322-2"><a href="cap8.html#cb322-2" aria-hidden="true" tabindex="-1"></a>hur_NB <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Raillietiella_mottae <span class="sc">~</span> CRC <span class="sc">+</span> Sexo <span class="sc">*</span> Especie, <span class="at">zi =</span> <span class="sc">~</span>., <span class="at">data =</span> parasitas, <span class="at">family =</span> truncated_nbinom2) <span class="co"># Hurdle model</span></span>
<span id="cb322-3"><a href="cap8.html#cb322-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-4"><a href="cap8.html#cb322-4" aria-hidden="true" tabindex="-1"></a>ziNB_mod2 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Raillietiella_mottae <span class="sc">~</span> CRC <span class="sc">+</span> Sexo <span class="sc">*</span> Especie, <span class="at">zi =</span> <span class="sc">~</span>., <span class="at">data =</span> parasitas, <span class="at">family =</span> nbinom2) <span class="co"># zero-inflated Poisson</span></span>
<span id="cb322-5"><a href="cap8.html#cb322-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-6"><a href="cap8.html#cb322-6" aria-hidden="true" tabindex="-1"></a>ziP_mod2 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Raillietiella_mottae <span class="sc">~</span> CRC <span class="sc">+</span> Sexo <span class="sc">*</span> Especie, <span class="at">zi =</span> <span class="sc">~</span>., <span class="at">data =</span> parasitas, <span class="at">family =</span> poisson) <span class="co"># zero-inflated Negative binomial</span></span></code></pre></div>
<p><strong>Diagnose</strong></p>
<p>Vamos fazer a diagnose desses três modelos ajustados anteriormente.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="cap8.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnose de inflação de zeros</span></span>
<span id="cb323-2"><a href="cap8.html#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_zeroinflation</span>(hur_NB) <span class="co"># prediz melhor os zeros</span></span>
<span id="cb323-3"><a href="cap8.html#cb323-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Check for zero-inflation</span></span>
<span id="cb323-4"><a href="cap8.html#cb323-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-5"><a href="cap8.html#cb323-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Observed zeros: 156</span></span>
<span id="cb323-6"><a href="cap8.html#cb323-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Predicted zeros: 157</span></span>
<span id="cb323-7"><a href="cap8.html#cb323-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Ratio: 1.01</span></span>
<span id="cb323-8"><a href="cap8.html#cb323-8" aria-hidden="true" tabindex="-1"></a><span class="fu">check_zeroinflation</span>(ziP_mod2)</span>
<span id="cb323-9"><a href="cap8.html#cb323-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Check for zero-inflation</span></span>
<span id="cb323-10"><a href="cap8.html#cb323-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-11"><a href="cap8.html#cb323-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Observed zeros: 156</span></span>
<span id="cb323-12"><a href="cap8.html#cb323-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Predicted zeros: 140</span></span>
<span id="cb323-13"><a href="cap8.html#cb323-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Ratio: 0.90</span></span>
<span id="cb323-14"><a href="cap8.html#cb323-14" aria-hidden="true" tabindex="-1"></a><span class="fu">check_zeroinflation</span>(ziNB_mod2)</span>
<span id="cb323-15"><a href="cap8.html#cb323-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Check for zero-inflation</span></span>
<span id="cb323-16"><a href="cap8.html#cb323-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb323-17"><a href="cap8.html#cb323-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Observed zeros: 156</span></span>
<span id="cb323-18"><a href="cap8.html#cb323-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Predicted zeros: 142</span></span>
<span id="cb323-19"><a href="cap8.html#cb323-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Ratio: 0.91</span></span></code></pre></div>
<p>Aqui vemos que o modelo zero-altered (Hurdle Model) conseguiu predizer exatamente a quantidade de zeros observada, fazendo com que o modelo seja suficiente para usarmos com esses dados.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="cap8.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Seleção de modelos</span></span>
<span id="cb324-2"><a href="cap8.html#cb324-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ICtab</span>(pois_plain, hur_NB, ziP_mod2, ziNB_mod2, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;AICc&quot;</span>), <span class="at">weights =</span> <span class="cn">TRUE</span>)</span>
<span id="cb324-3"><a href="cap8.html#cb324-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            dAICc df weight</span></span>
<span id="cb324-4"><a href="cap8.html#cb324-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ziP_mod2    0.0  10 0.62  </span></span>
<span id="cb324-5"><a href="cap8.html#cb324-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ziNB_mod2   1.6  11 0.28  </span></span>
<span id="cb324-6"><a href="cap8.html#cb324-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; hur_NB      3.6  11 0.10  </span></span>
<span id="cb324-7"><a href="cap8.html#cb324-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pois_plain 44.6  5  &lt;0.001</span></span></code></pre></div>
<p>Mas quando comparamos o AICc entre modelos, os modelos zero-inflated (tanto Poisson, quanto binomial negativa) que tem menos parâmetros, são ranqueados ligeiramente melhor do que o modelo binomial negativa zero-altered (ou hurdle). Não podemos distinguir entre os dois modelos com zero-inflated porque o dAICc &lt; 2, ou seja, o ajuste deles aos dados são praticamente iguais. Vejam que a diferença de Akaike Weights entre os dois primeiros modelos e o hurdle é bastante substancial (0.34 e 0.52). Além disso, vemos que os modelos que levam em conta o excesso de zeros se ajustam bem melhor aos dados do que o modelo simples com distribuição Poisson.
Vamos ver como os modelos se saem em relação aos outros pressupostos (Figura <a href="cap8.html#fig:fig-mod-zero-diag">8.19</a>).</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="cap8.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnoses</span></span>
<span id="cb325-2"><a href="cap8.html#cb325-2" aria-hidden="true" tabindex="-1"></a>simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> hur_NB, <span class="at">plot =</span> T)</span>
<span id="cb325-3"><a href="cap8.html#cb325-3" aria-hidden="true" tabindex="-1"></a>simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> ziP_mod2, <span class="at">plot =</span> T)</span>
<span id="cb325-4"><a href="cap8.html#cb325-4" aria-hidden="true" tabindex="-1"></a>simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> ziNB_mod2, <span class="at">plot =</span> T) <span class="co"># tem um outlier nos resíduos (asterisco vermelho)</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-zero-diag"></span>
<img src="livro_files/figure-html/fig-mod-zero-diag-1.png" alt="Diagnose avançada dos resíduos do modelo GLM Hurdle e zero-inflated binomial negativa." width="100%" height="100%" /><img src="livro_files/figure-html/fig-mod-zero-diag-2.png" alt="Diagnose avançada dos resíduos do modelo GLM Hurdle e zero-inflated binomial negativa." width="100%" height="100%" /><img src="livro_files/figure-html/fig-mod-zero-diag-3.png" alt="Diagnose avançada dos resíduos do modelo GLM Hurdle e zero-inflated binomial negativa." width="100%" height="100%" />
<p class="caption">
Figura 8.19: Diagnose avançada dos resíduos do modelo GLM Hurdle e zero-inflated binomial negativa.
</p>
</div>
<p>Os gráficos de diagnose do <code>DHARMa</code> são outra evidência de que tanto o modelo hurdle quanto o zero-inflated Poisson são adequados para os dados, em termos de homogeneidade de variância, <em>outliers</em> e <em>overdispersion</em>.</p>
<p><strong>Interpretação dos resultados</strong></p>
<p>Apesar de não ter um ajuste tão bom aos dados, o modelo hurdle prediz melhor a quantidade de zeros. Portanto, vamos interpretar os coeficientes apenas deste modelo.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="cap8.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Coeficientes estimados pelo modelo</span></span>
<span id="cb326-2"><a href="cap8.html#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hur_NB)</span>
<span id="cb326-3"><a href="cap8.html#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Family: truncated_nbinom2  ( log )</span></span>
<span id="cb326-4"><a href="cap8.html#cb326-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula:          Raillietiella_mottae ~ CRC + Sexo * Especie</span></span>
<span id="cb326-5"><a href="cap8.html#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Zero inflation:                        ~.</span></span>
<span id="cb326-6"><a href="cap8.html#cb326-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data: parasitas</span></span>
<span id="cb326-7"><a href="cap8.html#cb326-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb326-8"><a href="cap8.html#cb326-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span id="cb326-9"><a href="cap8.html#cb326-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    277.8    313.8   -127.9    255.8      184 </span></span>
<span id="cb326-10"><a href="cap8.html#cb326-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb326-11"><a href="cap8.html#cb326-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb326-12"><a href="cap8.html#cb326-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dispersion parameter for truncated_nbinom2 family (): 4.64 </span></span>
<span id="cb326-13"><a href="cap8.html#cb326-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb326-14"><a href="cap8.html#cb326-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conditional model:</span></span>
<span id="cb326-15"><a href="cap8.html#cb326-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                     Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span id="cb326-16"><a href="cap8.html#cb326-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                          3.03428    2.36511   1.283   0.1995  </span></span>
<span id="cb326-17"><a href="cap8.html#cb326-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CRC                                 -0.05041    0.04861  -1.037   0.2997  </span></span>
<span id="cb326-18"><a href="cap8.html#cb326-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SexoM                               -1.49505    0.71440  -2.093   0.0364 *</span></span>
<span id="cb326-19"><a href="cap8.html#cb326-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; EspeciePhyllopezus_pollicaris        0.68945    1.09380   0.630   0.5285  </span></span>
<span id="cb326-20"><a href="cap8.html#cb326-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SexoM:EspeciePhyllopezus_pollicaris  1.75281    0.94217   1.860   0.0628 .</span></span>
<span id="cb326-21"><a href="cap8.html#cb326-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb326-22"><a href="cap8.html#cb326-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb326-23"><a href="cap8.html#cb326-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb326-24"><a href="cap8.html#cb326-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Zero-inflation model:</span></span>
<span id="cb326-25"><a href="cap8.html#cb326-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                     Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb326-26"><a href="cap8.html#cb326-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                           7.6283     1.8529   4.117 3.84e-05 ***</span></span>
<span id="cb326-27"><a href="cap8.html#cb326-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CRC                                  -0.1291     0.0369  -3.499 0.000468 ***</span></span>
<span id="cb326-28"><a href="cap8.html#cb326-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SexoM                                -1.0893     0.5867  -1.856 0.063386 .  </span></span>
<span id="cb326-29"><a href="cap8.html#cb326-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; EspeciePhyllopezus_pollicaris         2.2701     0.9140   2.484 0.013003 *  </span></span>
<span id="cb326-30"><a href="cap8.html#cb326-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SexoM:EspeciePhyllopezus_pollicaris   2.2002     0.8192   2.686 0.007239 ** </span></span>
<span id="cb326-31"><a href="cap8.html#cb326-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb326-32"><a href="cap8.html#cb326-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Para maiores detalhes na interpretação deste tipo de modelo, sugerimos fortemente consultar p. 382-3 de Brooks et al. <span class="citation">(<a href="#ref-brooks2017a" role="doc-biblioref">2017</a>)</span>. Para fatores com mais de um nível, o <code>summary()</code> mostra os resultados usando contraste, para isto toma como referência um dos níveis do fator (o primeiro em ordem alfabética) e o compara com os outros. Note que na parte com excesso de zeros, o contraste é positivo para Espécie. Ou seja, o <em>P. pollicaris</em> tem maior chance de ter ausência de parasitas que <em>H. agrius</em>. O contraste para espécie continua sendo positivo na parte condicional do modelo, mas o valor do parâmetro não é tão alto. Isso quer dizer que <em>P. pollicaris</em> tem abundância de parasitas em média ligeiramente maior que <em>H. agrius</em>. Vemos que a interação é significativa entre sexo e espécie na parte do modelo com excesso de zeros, mas apenas marginalmente significativa na parte condicional. Portanto, a influência do sexo na incidência, mas não na abundância do parasita depende conjuntamente da espécie. No entanto, o CRC só passa a ser significativo na parte de excesso de zeros, ou seja, quando modelamos apenas a incidência (presença-ausência) do parasita. Portanto, o <em>CRC determina se o lagarto vai ou não ser infectado, mas não <bold>o quanto</bold> vai receber de parasitas</em>. Já tanto o sexo quanto a espécie foram significativas em ambas as partes do modelo, ou seja, esses fatores não influenciam diferentemente a infecção e a quantidade de parasitas.
Agora vejamos como podemos plotar as predições deste modelo (Figura <a href="cap8.html#fig:fig-mod-zero-model">8.20</a>).</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="cap8.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb327-2"><a href="cap8.html#cb327-2" aria-hidden="true" tabindex="-1"></a>parasitas<span class="sc">$</span>phat <span class="ot">&lt;-</span> <span class="fu">predict</span>(hur_NB, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb327-3"><a href="cap8.html#cb327-3" aria-hidden="true" tabindex="-1"></a>parasitas <span class="ot">&lt;-</span> parasitas[<span class="fu">with</span>(parasitas, <span class="fu">order</span>(Sexo, Especie)), ]</span>
<span id="cb327-4"><a href="cap8.html#cb327-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-5"><a href="cap8.html#cb327-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parasitas, <span class="fu">aes</span>(<span class="at">x =</span> CRC, <span class="at">y =</span> phat, <span class="at">colour =</span> Especie,</span>
<span id="cb327-6"><a href="cap8.html#cb327-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">shape =</span> Sexo, <span class="at">linetype =</span> Sexo)) <span class="sc">+</span></span>
<span id="cb327-7"><a href="cap8.html#cb327-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Raillietiella_mottae), <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb327-8"><a href="cap8.html#cb327-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> .<span class="dv">7</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">h =</span> .<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb327-9"><a href="cap8.html#cb327-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb327-10"><a href="cap8.html#cb327-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb327-11"><a href="cap8.html#cb327-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb327-12"><a href="cap8.html#cb327-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Comprimento Rostro-Cloacal&quot;</span>, </span>
<span id="cb327-13"><a href="cap8.html#cb327-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Abundância de &quot;</span>, <span class="fu">italic</span>(<span class="st">&quot;Raillietiella mottae&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb327-14"><a href="cap8.html#cb327-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-zero-model"></span>
<img src="livro_files/figure-html/fig-mod-zero-model-1.png" alt="Gráfico do GLM Hurdle." width="100%" height="100%" />
<p class="caption">
Figura 8.20: Gráfico do GLM Hurdle.
</p>
</div>
</div>
<div id="dados-ordinais-os-modelos-cumulative-link" class="section level2" number="8.9">
<h2><span class="header-section-number">8.9</span> Dados ordinais: os modelos cumulative link</h2>
<p>Uma outra maneira de codificarmos os dados é utilizando categorias ordenadas, tais como ranques. Exemplos incluem a escala de Likert, scores e intervalos (e.g., de idade).</p>
<p>Para este exemplo, iremos utilizar um outro conjunto de dados do artigo de <span class="citation">(<a href="#ref-Franco-Belussi2018a" role="doc-biblioref">Franco-Belussi et al., 2018</a>)</span> que manipulou <em>in vitro</em> a concentração do hormônio noradrenalina nos olhos de peixes esgana-gato (<em>Gasterosteus aculeatus</em>) e avaliaram a expressão de várias cores conferidas por tipos de células (cromatóforos). Aqui vamos usar os dados do efeito da noradrenalina na cor vermelha em machos.
Neste experimento, os autores realizaram medidas repetidas no mesmo animal ao longo do tempo (que é um dos fatores deste experimento). Portanto, para não incorrer no risco de pseudoréplicas deveríamos incluir esta informação no modelo. A maneira mais simples de fazê-lo é criar um modelo de efeito misto em que teríamos uma parte fixa (o que de fato estamos interessados em testar) e outra aleatória (variáveis que precisamos controlar). Portanto, <code>Animal</code> será incluído como um um fator aleatório, tendo um intercepto estimado separadamente para cada animal no modelo. Não iremos entrar em detalhes sobre modelos de efeito misto porque necessitaríamos de um outro capítulo para isso, dada a complexidade do assunto. No entanto, recomendamos aos leitores dois artigos intródutórios muito bons - Harisson <span class="citation">(<a href="#ref-Harrison" role="doc-biblioref">2018</a>)</span> e Bolker et al. <span class="citation">(<a href="#ref-BOLKER2009127" role="doc-biblioref">2009</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<p>A noradrenalina causa uma diminuição da coloração vermelha, via agregação dos pigmentos?</p>
<p><strong>Predições</strong></p>
<p>A presença de noradrenalina causa a agregação dos pigmentos, permitindo que os hormônios reprodutivos atuem.</p>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variável resposta: escala de intensidade de cor. Para mais detalhes veja o artigo original <span class="citation">(<a href="#ref-Franco-Belussi2018a" role="doc-biblioref">Franco-Belussi et al., 2018</a>)</span>.</li>
</ul>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="cap8.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Importar os dados</span></span>
<span id="cb328-2"><a href="cap8.html#cb328-2" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;https://ndownloader.figshare.com/files/10250700&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb328-3"><a href="cap8.html#cb328-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cores)</span>
<span id="cb328-4"><a href="cap8.html#cb328-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Animal Treatment Time Sex Black Red</span></span>
<span id="cb328-5"><a href="cap8.html#cb328-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      1        CT   0h   M     5   5</span></span>
<span id="cb328-6"><a href="cap8.html#cb328-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      1        CT   1h   M     5   5</span></span>
<span id="cb328-7"><a href="cap8.html#cb328-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      1        CT   2h   M     5   5</span></span>
<span id="cb328-8"><a href="cap8.html#cb328-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      1        CT   3h   M     5   5</span></span>
<span id="cb328-9"><a href="cap8.html#cb328-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5      2        CT   0h   M     5   4</span></span>
<span id="cb328-10"><a href="cap8.html#cb328-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6      2        CT   1h   M     5   4</span></span>
<span id="cb328-11"><a href="cap8.html#cb328-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-12"><a href="cap8.html#cb328-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Tradução dos nomes das colunas</span></span>
<span id="cb328-13"><a href="cap8.html#cb328-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cores) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;animal&quot;</span>, <span class="st">&quot;tratamento&quot;</span>, <span class="st">&quot;tempo&quot;</span>, <span class="st">&quot;sexo&quot;</span>, <span class="st">&quot;preto&quot;</span>, <span class="st">&quot;vermelho&quot;</span>)</span>
<span id="cb328-14"><a href="cap8.html#cb328-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-15"><a href="cap8.html#cb328-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Filtrando dados - macho vermelho</span></span>
<span id="cb328-16"><a href="cap8.html#cb328-16" aria-hidden="true" tabindex="-1"></a>macho_verm <span class="ot">&lt;-</span> <span class="fu">filter</span>(cores, sexo <span class="sc">==</span> <span class="st">&quot;M&quot;</span>)</span>
<span id="cb328-17"><a href="cap8.html#cb328-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(macho_verm)</span>
<span id="cb328-18"><a href="cap8.html#cb328-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   animal tratamento tempo sexo preto vermelho</span></span>
<span id="cb328-19"><a href="cap8.html#cb328-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      1         CT    0h    M     5        5</span></span>
<span id="cb328-20"><a href="cap8.html#cb328-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      1         CT    1h    M     5        5</span></span>
<span id="cb328-21"><a href="cap8.html#cb328-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      1         CT    2h    M     5        5</span></span>
<span id="cb328-22"><a href="cap8.html#cb328-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      1         CT    3h    M     5        5</span></span>
<span id="cb328-23"><a href="cap8.html#cb328-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5      2         CT    0h    M     5        4</span></span>
<span id="cb328-24"><a href="cap8.html#cb328-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6      2         CT    1h    M     5        4</span></span></code></pre></div>
<p>Esses dados, no entanto, têm de ser codificados como um fator ordenado antes de entrarmos com eles no modelo.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="cap8.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fator</span></span>
<span id="cb329-2"><a href="cap8.html#cb329-2" aria-hidden="true" tabindex="-1"></a>macho_verm<span class="sc">$</span>animal <span class="ot">&lt;-</span> <span class="fu">factor</span>(macho_verm<span class="sc">$</span>animal)</span>
<span id="cb329-3"><a href="cap8.html#cb329-3" aria-hidden="true" tabindex="-1"></a>macho_verm<span class="sc">$</span>vermelho_ord <span class="ot">&lt;-</span> <span class="fu">factor</span>(macho_verm<span class="sc">$</span>vermelho, </span>
<span id="cb329-4"><a href="cap8.html#cb329-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>), </span>
<span id="cb329-5"><a href="cap8.html#cb329-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb329-6"><a href="cap8.html#cb329-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(macho_verm)</span>
<span id="cb329-7"><a href="cap8.html#cb329-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    40 obs. of  7 variables:</span></span>
<span id="cb329-8"><a href="cap8.html#cb329-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ animal      : Factor w/ 5 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 2 2 2 2 3 3 ...</span></span>
<span id="cb329-9"><a href="cap8.html#cb329-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ tratamento  : chr  &quot;CT&quot; &quot;CT&quot; &quot;CT&quot; &quot;CT&quot; ...</span></span>
<span id="cb329-10"><a href="cap8.html#cb329-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ tempo       : chr  &quot;0h&quot; &quot;1h&quot; &quot;2h&quot; &quot;3h&quot; ...</span></span>
<span id="cb329-11"><a href="cap8.html#cb329-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ sexo        : chr  &quot;M&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; ...</span></span>
<span id="cb329-12"><a href="cap8.html#cb329-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ preto       : int  5 5 5 5 5 5 5 5 4 4 ...</span></span>
<span id="cb329-13"><a href="cap8.html#cb329-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ vermelho    : int  5 5 5 5 4 4 4 4 4 4 ...</span></span>
<span id="cb329-14"><a href="cap8.html#cb329-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ vermelho_ord: Ord.factor w/ 5 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 5 5 5 5 4 4 4 4 4 4 ...</span></span></code></pre></div>
<p>Repare que a classe do objeto muda e temos agora que Red é um <code>Ordered factor</code>.</p>
<p><strong>Modelagem</strong></p>
<p>Vamos ajustar um modelo cumulative link, utilizando a função <code>clmm()</code> do pacote <code>ordinal</code>.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="cap8.html#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Modelo</span></span>
<span id="cb330-2"><a href="cap8.html#cb330-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">clmm</span>(vermelho_ord <span class="sc">~</span> tratamento <span class="sc">+</span> tempo <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>animal), <span class="at">data =</span> macho_verm, <span class="at">threshold =</span> <span class="st">&quot;equidistant&quot;</span>)</span></code></pre></div>
<p><strong>Diagnose</strong></p>
<p>Infelizmente, o pacote <code>ordinal</code> não fornece métodos para lidar com modelos mistos, como o nosso. Então, montamos um modelo fixo apenas para entrar nas duas funções de diagnose. Essas duas funções <code>scale_test()</code> e <code>nominal_test()</code> testam a qualidade do ajuste (<em>goodness-of-fit</em>) do modelo, similar aos <em>likelihood-ratio test</em>, só que para dados ordinais.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="cap8.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnose</span></span>
<span id="cb331-2"><a href="cap8.html#cb331-2" aria-hidden="true" tabindex="-1"></a>assumption3 <span class="ot">&lt;-</span> <span class="fu">clm</span>(vermelho_ord <span class="sc">~</span> tratamento <span class="sc">+</span> tempo, <span class="at">data =</span> macho_verm, <span class="at">threshold =</span> <span class="st">&quot;equidistant&quot;</span>)</span>
<span id="cb331-3"><a href="cap8.html#cb331-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-4"><a href="cap8.html#cb331-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_test</span>(assumption3)</span>
<span id="cb331-5"><a href="cap8.html#cb331-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tests of scale effects</span></span>
<span id="cb331-6"><a href="cap8.html#cb331-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb331-7"><a href="cap8.html#cb331-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; formula: vermelho_ord ~ tratamento + tempo</span></span>
<span id="cb331-8"><a href="cap8.html#cb331-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Df  logLik    AIC      LRT Pr(&gt;Chi)</span></span>
<span id="cb331-9"><a href="cap8.html#cb331-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;        -24.301 60.602                  </span></span>
<span id="cb331-10"><a href="cap8.html#cb331-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tratamento  1 -24.293 62.586 0.015248   0.9017</span></span>
<span id="cb331-11"><a href="cap8.html#cb331-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo</span></span>
<span id="cb331-12"><a href="cap8.html#cb331-12" aria-hidden="true" tabindex="-1"></a><span class="fu">nominal_test</span>(assumption3)</span>
<span id="cb331-13"><a href="cap8.html#cb331-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tests of nominal effects</span></span>
<span id="cb331-14"><a href="cap8.html#cb331-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb331-15"><a href="cap8.html#cb331-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; formula: vermelho_ord ~ tratamento + tempo</span></span>
<span id="cb331-16"><a href="cap8.html#cb331-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Df  logLik    AIC    LRT Pr(&gt;Chi)   </span></span>
<span id="cb331-17"><a href="cap8.html#cb331-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;        -24.301 60.602                   </span></span>
<span id="cb331-18"><a href="cap8.html#cb331-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tratamento  1 -19.749 53.499 9.1031 0.002552 **</span></span>
<span id="cb331-19"><a href="cap8.html#cb331-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo       3 -22.803 63.606 2.9953 0.392356   </span></span>
<span id="cb331-20"><a href="cap8.html#cb331-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb331-21"><a href="cap8.html#cb331-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Parece que não há problemas com o efeito de escala do dado ordinal, mas a diagnose sugere que possa haver evidência de rompimento do pressuposto de probabilidades proporcionais em relação ao tratamento. Esse é um pressuposto importante de modelos ordinais, os quais assumem que os efeitos de qualquer uma das variáveis explicativas são consistentes (proporcionais) ao longo de diferentes <em>thresholds</em> (que são as quebras entre cada par de categorias da variável resposta ordinal).</p>
<p>Isto provavelmente se deve ao baixo tamanho amostral. Por questão de brevidade vamos apenas ignorar este aspecto e interpretar o resultado do modelo mesmo assim. Mas se o seu modelo apresentar este problema, a solução deve ser realizar regressões logísticas separadamente.</p>
<p><strong>Inferência</strong></p>
<p>Vamos analisar os parâmetros do modelo.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="cap8.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Coeficientes estimados pelo modelo</span></span>
<span id="cb332-2"><a href="cap8.html#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span>
<span id="cb332-3"><a href="cap8.html#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cumulative Link Mixed Model fitted with the Laplace approximation</span></span>
<span id="cb332-4"><a href="cap8.html#cb332-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb332-5"><a href="cap8.html#cb332-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; formula: vermelho_ord ~ tratamento + tempo + (1 | animal)</span></span>
<span id="cb332-6"><a href="cap8.html#cb332-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:    macho_verm</span></span>
<span id="cb332-7"><a href="cap8.html#cb332-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb332-8"><a href="cap8.html#cb332-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  link  threshold   nobs logLik AIC   niter    max.grad cond.H </span></span>
<span id="cb332-9"><a href="cap8.html#cb332-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  logit equidistant 40   -22.89 59.77 226(681) 1.04e-05 4.1e+01</span></span>
<span id="cb332-10"><a href="cap8.html#cb332-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb332-11"><a href="cap8.html#cb332-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb332-12"><a href="cap8.html#cb332-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Groups Name        Variance Std.Dev.</span></span>
<span id="cb332-13"><a href="cap8.html#cb332-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  animal (Intercept) 1.438    1.199   </span></span>
<span id="cb332-14"><a href="cap8.html#cb332-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of groups:  animal 5 </span></span>
<span id="cb332-15"><a href="cap8.html#cb332-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb332-16"><a href="cap8.html#cb332-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb332-17"><a href="cap8.html#cb332-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb332-18"><a href="cap8.html#cb332-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tratamentoNA10uM   -4.602      1.228  -3.748 0.000178 ***</span></span>
<span id="cb332-19"><a href="cap8.html#cb332-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo1h            -3.602      1.377  -2.616 0.008894 ** </span></span>
<span id="cb332-20"><a href="cap8.html#cb332-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo2h            -3.602      1.377  -2.616 0.008894 ** </span></span>
<span id="cb332-21"><a href="cap8.html#cb332-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo3h            -3.602      1.377  -2.616 0.008894 ** </span></span>
<span id="cb332-22"><a href="cap8.html#cb332-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb332-23"><a href="cap8.html#cb332-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb332-24"><a href="cap8.html#cb332-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb332-25"><a href="cap8.html#cb332-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Threshold coefficients:</span></span>
<span id="cb332-26"><a href="cap8.html#cb332-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value</span></span>
<span id="cb332-27"><a href="cap8.html#cb332-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; threshold.1   -6.198      1.722   -3.60</span></span>
<span id="cb332-28"><a href="cap8.html#cb332-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; spacing        4.978      1.254    3.97</span></span>
<span id="cb332-29"><a href="cap8.html#cb332-29" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(assumption3)</span>
<span id="cb332-30"><a href="cap8.html#cb332-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Type I Analysis of Deviance Table with Wald chi-square tests</span></span>
<span id="cb332-31"><a href="cap8.html#cb332-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb332-32"><a href="cap8.html#cb332-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Df   Chisq Pr(&gt;Chisq)    </span></span>
<span id="cb332-33"><a href="cap8.html#cb332-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tratamento  1 15.3616  8.877e-05 ***</span></span>
<span id="cb332-34"><a href="cap8.html#cb332-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo       3  9.1992    0.02676 *  </span></span>
<span id="cb332-35"><a href="cap8.html#cb332-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb332-36"><a href="cap8.html#cb332-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb332-37"><a href="cap8.html#cb332-37" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">emmeans</span>(mod3, <span class="sc">~</span> tratamento<span class="sc">|</span>tempo, <span class="at">adjust =</span> <span class="st">&quot;tukey&quot;</span>))</span>
<span id="cb332-38"><a href="cap8.html#cb332-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo = 0h:</span></span>
<span id="cb332-39"><a href="cap8.html#cb332-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast    estimate   SE  df z.ratio p.value</span></span>
<span id="cb332-40"><a href="cap8.html#cb332-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  CT - NA10uM      4.6 1.23 Inf   3.748  0.0002</span></span>
<span id="cb332-41"><a href="cap8.html#cb332-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb332-42"><a href="cap8.html#cb332-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo = 1h:</span></span>
<span id="cb332-43"><a href="cap8.html#cb332-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast    estimate   SE  df z.ratio p.value</span></span>
<span id="cb332-44"><a href="cap8.html#cb332-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  CT - NA10uM      4.6 1.23 Inf   3.748  0.0002</span></span>
<span id="cb332-45"><a href="cap8.html#cb332-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb332-46"><a href="cap8.html#cb332-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo = 2h:</span></span>
<span id="cb332-47"><a href="cap8.html#cb332-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast    estimate   SE  df z.ratio p.value</span></span>
<span id="cb332-48"><a href="cap8.html#cb332-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  CT - NA10uM      4.6 1.23 Inf   3.748  0.0002</span></span>
<span id="cb332-49"><a href="cap8.html#cb332-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb332-50"><a href="cap8.html#cb332-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo = 3h:</span></span>
<span id="cb332-51"><a href="cap8.html#cb332-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast    estimate   SE  df z.ratio p.value</span></span>
<span id="cb332-52"><a href="cap8.html#cb332-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  CT - NA10uM      4.6 1.23 Inf   3.748  0.0002</span></span></code></pre></div>
<p>Aqui vemos que tanto o tratamento, quanto o tempo de exposição foram significativos.</p>
<p><strong>Interpretação dos resultados</strong></p>
<p>Vamos analisar a predição do modelo (Figura <a href="cap8.html#fig:fig-mod-ord-model">8.21</a>).</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="cap8.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb333-2"><a href="cap8.html#cb333-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-3"><a href="cap8.html#cb333-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular média e erro padrão</span></span>
<span id="cb333-4"><a href="cap8.html#cb333-4" aria-hidden="true" tabindex="-1"></a>macho_verm_res <span class="ot">&lt;-</span> <span class="fu">summarySE</span>(macho_verm, </span>
<span id="cb333-5"><a href="cap8.html#cb333-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">measurevar =</span> <span class="st">&quot;vermelho&quot;</span>,</span>
<span id="cb333-6"><a href="cap8.html#cb333-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">groupvars =</span> <span class="fu">c</span>(<span class="st">&quot;tempo&quot;</span>, <span class="st">&quot;tratamento&quot;</span>))</span>
<span id="cb333-7"><a href="cap8.html#cb333-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-8"><a href="cap8.html#cb333-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir posição de linhas e pontos no gráfico</span></span>
<span id="cb333-9"><a href="cap8.html#cb333-9" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="fl">0.1</span>)</span>
<span id="cb333-10"><a href="cap8.html#cb333-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-11"><a href="cap8.html#cb333-11" aria-hidden="true" tabindex="-1"></a>macho_verm_res <span class="sc">%&gt;%</span> </span>
<span id="cb333-12"><a href="cap8.html#cb333-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tempo, <span class="at">y =</span> vermelho, <span class="at">colour =</span> tratamento,</span>
<span id="cb333-13"><a href="cap8.html#cb333-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> tratamento, <span class="at">fill =</span> tratamento)) <span class="sc">+</span></span>
<span id="cb333-14"><a href="cap8.html#cb333-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>vermelho<span class="sc">-</span>se, <span class="at">ymax=</span>vermelho <span class="sc">+</span>se), </span>
<span id="cb333-15"><a href="cap8.html#cb333-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">width=</span>.<span class="dv">1</span>, <span class="at">size =</span> <span class="fl">1.1</span>, <span class="at">position=</span>pd) <span class="sc">+</span></span>
<span id="cb333-16"><a href="cap8.html#cb333-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">position=</span>pd, <span class="at">size =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb333-17"><a href="cap8.html#cb333-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">21</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">position=</span>pd, <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb333-18"><a href="cap8.html#cb333-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb333-19"><a href="cap8.html#cb333-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb333-20"><a href="cap8.html#cb333-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Tempo de exposição (horas)&quot;</span>) <span class="sc">+</span></span>
<span id="cb333-21"><a href="cap8.html#cb333-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Índice de eritróforos&quot;</span>) <span class="sc">+</span></span>
<span id="cb333-22"><a href="cap8.html#cb333-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-ord-model"></span>
<img src="livro_files/figure-html/fig-mod-ord-model-1.png" alt="Gráfico do modelo cumulative link." width="100%" height="100%" />
<p class="caption">
Figura 8.21: Gráfico do modelo cumulative link.
</p>
</div>
<p>Neste gráfico vemos que o grupo tratado com o hormônio começa com um índice de eritróforo ligeiramente maior do que o controle, mas logo tem uma brusca redução com uma hora de exposição, passando a ter índice 2, demonstrando que houve uma mudança de cor induzida pela dispersão dos cromatóforos. Já no controle, o índice não muda em relação ao tempo de exposição. Logo, podemos ver que há uma interação entre os fatores devido a esta queda do índice no grupo tratado e a ausência de efeito no controle.</p>
</div>
<div id="dados-contínuos-distribuição-beta" class="section level2" number="8.10">
<h2><span class="header-section-number">8.10</span> Dados contínuos: distribuição beta</h2>
<p>Aqui vamos utilizar como exemplo os dados do artigo de <span class="citation">(<a href="#ref-Franco-Belussi2018a" role="doc-biblioref">2018</a>)</span>. Os pesquisadores fizeram um experimento <em>in vivo</em> com peixes esgana-gato (<em>Gasterosteus aculeatus</em>) para testar como a coloração dos animais respondem ao fármaco ioimbina (YOH), que bloqueia a coloração típica que os machos exibem na época de acasalamento, e o tempo de exposição ao mesmo (além de um controle), num desenho de ANOVA fatorial. Como as medidas foram feitas repetidamente no mesmo animal, iremos incluir o <code>Animal</code> como um fator aleatório no modelo.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="cap8.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fish)</span>
<span id="cb334-2"><a href="cap8.html#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Animal Treatment Time Sex Darkness Redness</span></span>
<span id="cb334-3"><a href="cap8.html#cb334-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      1        CT   0h   M    56.42  131.17</span></span>
<span id="cb334-4"><a href="cap8.html#cb334-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      1        CT   1h   M    49.53  133.30</span></span>
<span id="cb334-5"><a href="cap8.html#cb334-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      1        CT   2h   M    54.94  132.69</span></span>
<span id="cb334-6"><a href="cap8.html#cb334-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      1        CT   3h   M    42.19  135.37</span></span>
<span id="cb334-7"><a href="cap8.html#cb334-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5      2        CT   0h   M    58.93  133.35</span></span>
<span id="cb334-8"><a href="cap8.html#cb334-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6      2        CT   1h   M    52.45  133.65</span></span>
<span id="cb334-9"><a href="cap8.html#cb334-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-10"><a href="cap8.html#cb334-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Tradução dos nomes das colunas</span></span>
<span id="cb334-11"><a href="cap8.html#cb334-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(fish) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;animal&quot;</span>, <span class="st">&quot;tratamento&quot;</span>, <span class="st">&quot;tempo&quot;</span>, <span class="st">&quot;sexo&quot;</span>, <span class="st">&quot;preto&quot;</span>, <span class="st">&quot;vermelho&quot;</span>)</span></code></pre></div>
<p>Esses dados contêm as variáveis resposta medidas no experimento: a quantidade de vermelho e preto. Além dos fatores manipulados: Tratamento (controle e presença de YOH) e tempo de exposição.</p>
<p><strong>Pergunta</strong></p>
<p>A YOH aumenta a coloração escura no olho e mandíbula dos peixes via dispersão dos pigmentos?</p>
<p><strong>Predições</strong></p>
<p>A YOH promoverá um escurecimento do corpo do animal, já que ela inibe a ação NorAdrenalia (NA).</p>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variável resposta: a intensidade de coloração escura em peixes machos. Esses dados são expressos em termos de porcentagem e variam continuamente de 0 a 100%. Para facilitar a modelagem e nos adequarmos à maneira com que a função requer os dados, vamos simplesmente dividir por 100 para que os dados variem entre 0 e 1</li>
</ul>
<p>Para modelar os dados vamos utilizar a função <code>glmmTMB</code>. Antes disso, vamos analisar graficamente os dados (Figura <a href="cap8.html#fig:fig-mod-beta-pre">8.22</a>). Vamos usar apenas os dados dos machos para este exemplo.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="cap8.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Filtrando os dados</span></span>
<span id="cb335-2"><a href="cap8.html#cb335-2" aria-hidden="true" tabindex="-1"></a>fish<span class="sc">$</span>animal <span class="ot">&lt;-</span> <span class="fu">factor</span>(fish<span class="sc">$</span>animal)</span>
<span id="cb335-3"><a href="cap8.html#cb335-3" aria-hidden="true" tabindex="-1"></a>fish<span class="sc">$</span>sexo <span class="ot">&lt;-</span> <span class="fu">factor</span>(fish<span class="sc">$</span>sexo)</span>
<span id="cb335-4"><a href="cap8.html#cb335-4" aria-hidden="true" tabindex="-1"></a>macho_preto <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(fish, sexo <span class="sc">==</span> <span class="st">&quot;M&quot;</span>)</span>
<span id="cb335-5"><a href="cap8.html#cb335-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-6"><a href="cap8.html#cb335-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb335-7"><a href="cap8.html#cb335-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(macho_preto, <span class="fu">aes</span>(preto<span class="sc">/</span><span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb335-8"><a href="cap8.html#cb335-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">colour =</span> <span class="st">&quot;cyan4&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;cyan4&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb335-9"><a href="cap8.html#cb335-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb335-10"><a href="cap8.html#cb335-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Índice de escuridão do corpo&quot;</span>)<span class="sc">+</span></span>
<span id="cb335-11"><a href="cap8.html#cb335-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-beta-pre"></span>
<img src="livro_files/figure-html/fig-mod-beta-pre-1.png" alt="Gráfico para explorar a distribuição da variável resposta." width="100%" height="100%" />
<p class="caption">
Figura 8.22: Gráfico para explorar a distribuição da variável resposta.
</p>
</div>
<p>No histograma podemos ver que os dados de fato variam continuamente no intervalo entre 0 e 1, tendo uma distribuição notadamente bimodal.</p>
<p><strong>Modelagem</strong></p>
<p>Vamos ajustar um GLM Beta.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="cap8.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Modelo</span></span>
<span id="cb336-2"><a href="cap8.html#cb336-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(preto<span class="sc">/</span><span class="dv">100</span> <span class="sc">~</span> tratamento <span class="sc">*</span> tempo <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>animal), <span class="at">family =</span> beta_family, <span class="at">data =</span> macho_preto)</span></code></pre></div>
<p><strong>Diagnose</strong></p>
<p>Aqui utilizaremos o mesmo pacote <code>DHARMa</code> para realizar a diagnose do modelo
(Figura <a href="cap8.html#fig:fig-mod-beta-diag">8.23</a>).</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="cap8.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnóse</span></span>
<span id="cb337-2"><a href="cap8.html#cb337-2" aria-hidden="true" tabindex="-1"></a>simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> mod2, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-beta-diag"></span>
<img src="livro_files/figure-html/fig-mod-beta-diag-1.png" alt="Diagnose avançada dos resíduos do modelo GLM Beta." width="100%" height="100%" />
<p class="caption">
Figura 8.23: Diagnose avançada dos resíduos do modelo GLM Beta.
</p>
</div>
<p>Podemos ver que o modelo não sofre de heterogeneidade de dispersão, overdispersion, nem problemas com <em>outlier</em>.</p>
<p><strong>Interpretação dos resultados</strong></p>
<p>Agora que podemos interpretar a saída do modelo ajustado com confiança, vamos obter a tabela de anova em que teremos os testes de cada fator do modelo.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="cap8.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Coeficientes estimados pelo modelo</span></span>
<span id="cb338-2"><a href="cap8.html#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mod2)</span>
<span id="cb338-3"><a href="cap8.html#cb338-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table (Type II Wald chisquare tests)</span></span>
<span id="cb338-4"><a href="cap8.html#cb338-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb338-5"><a href="cap8.html#cb338-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: preto/100</span></span>
<span id="cb338-6"><a href="cap8.html#cb338-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    Chisq Df Pr(&gt;Chisq)    </span></span>
<span id="cb338-7"><a href="cap8.html#cb338-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tratamento       105.546  1  &lt; 2.2e-16 ***</span></span>
<span id="cb338-8"><a href="cap8.html#cb338-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo             40.719  3  7.499e-09 ***</span></span>
<span id="cb338-9"><a href="cap8.html#cb338-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tratamento:tempo  49.262  3  1.147e-10 ***</span></span>
<span id="cb338-10"><a href="cap8.html#cb338-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb338-11"><a href="cap8.html#cb338-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Aqui vemos que a interação é significativa. Portanto, temos de interpretar os níveis do fator da combinação, fazemos isso no pacote <code>emmeans</code> colocando a barra |.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="cap8.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="do">## níveis do fator da combinação</span></span>
<span id="cb339-2"><a href="cap8.html#cb339-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">emmeans</span>(mod2, <span class="sc">~</span> tratamento<span class="sc">|</span>tempo))</span>
<span id="cb339-3"><a href="cap8.html#cb339-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo = 0h:</span></span>
<span id="cb339-4"><a href="cap8.html#cb339-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast estimate    SE df t.ratio p.value</span></span>
<span id="cb339-5"><a href="cap8.html#cb339-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  CT - YOH   0.0283 0.160 30   0.177  0.8609</span></span>
<span id="cb339-6"><a href="cap8.html#cb339-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb339-7"><a href="cap8.html#cb339-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo = 1h:</span></span>
<span id="cb339-8"><a href="cap8.html#cb339-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast estimate    SE df t.ratio p.value</span></span>
<span id="cb339-9"><a href="cap8.html#cb339-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  CT - YOH  -1.3068 0.181 30  -7.210  &lt;.0001</span></span>
<span id="cb339-10"><a href="cap8.html#cb339-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb339-11"><a href="cap8.html#cb339-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo = 2h:</span></span>
<span id="cb339-12"><a href="cap8.html#cb339-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast estimate    SE df t.ratio p.value</span></span>
<span id="cb339-13"><a href="cap8.html#cb339-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  CT - YOH  -1.2286 0.182 30  -6.763  &lt;.0001</span></span>
<span id="cb339-14"><a href="cap8.html#cb339-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb339-15"><a href="cap8.html#cb339-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tempo = 3h:</span></span>
<span id="cb339-16"><a href="cap8.html#cb339-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast estimate    SE df t.ratio p.value</span></span>
<span id="cb339-17"><a href="cap8.html#cb339-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  CT - YOH  -1.4025 0.185 30  -7.582  &lt;.0001</span></span>
<span id="cb339-18"><a href="cap8.html#cb339-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb339-19"><a href="cap8.html#cb339-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Results are given on the log odds ratio (not the response) scale.</span></span></code></pre></div>
<p>Agora podemos perceber que a diferença entre o controle e o tratado só passa a ser significativa depois de 1 h de exposição.</p>
<p>Isso fica mais evidente quando plotamos os dados (Figura <a href="cap8.html#fig:fig-mod-beta-model">8.24</a>).</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="cap8.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb340-2"><a href="cap8.html#cb340-2" aria-hidden="true" tabindex="-1"></a>escuridao <span class="ot">&lt;-</span> <span class="fu">summarySE</span>(macho_preto, </span>
<span id="cb340-3"><a href="cap8.html#cb340-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">measurevar =</span> <span class="st">&quot;preto&quot;</span>,</span>
<span id="cb340-4"><a href="cap8.html#cb340-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">groupvars =</span> <span class="fu">c</span>(<span class="st">&quot;tempo&quot;</span>, <span class="st">&quot;tratamento&quot;</span>))</span>
<span id="cb340-5"><a href="cap8.html#cb340-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-6"><a href="cap8.html#cb340-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir posição de linhas e pontos no gráfico</span></span>
<span id="cb340-7"><a href="cap8.html#cb340-7" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="fl">0.1</span>)</span>
<span id="cb340-8"><a href="cap8.html#cb340-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-9"><a href="cap8.html#cb340-9" aria-hidden="true" tabindex="-1"></a>escuridao <span class="sc">%&gt;%</span> </span>
<span id="cb340-10"><a href="cap8.html#cb340-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tempo, <span class="at">y =</span> preto, <span class="at">colour =</span> tratamento,</span>
<span id="cb340-11"><a href="cap8.html#cb340-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> tratamento, <span class="at">fill =</span> tratamento)) <span class="sc">+</span></span>
<span id="cb340-12"><a href="cap8.html#cb340-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>preto<span class="sc">-</span>se, <span class="at">ymax=</span>preto <span class="sc">+</span>se), </span>
<span id="cb340-13"><a href="cap8.html#cb340-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">width=</span>.<span class="dv">1</span>, <span class="at">size =</span> <span class="fl">1.1</span>, <span class="at">position=</span>pd) <span class="sc">+</span></span>
<span id="cb340-14"><a href="cap8.html#cb340-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">position=</span>pd, <span class="at">size =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb340-15"><a href="cap8.html#cb340-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">21</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">position=</span>pd, <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb340-16"><a href="cap8.html#cb340-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb340-17"><a href="cap8.html#cb340-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb340-18"><a href="cap8.html#cb340-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Tempo de experimento (horas)&quot;</span>) <span class="sc">+</span></span>
<span id="cb340-19"><a href="cap8.html#cb340-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Índice de escuridão do corpo&quot;</span>) <span class="sc">+</span></span>
<span id="cb340-20"><a href="cap8.html#cb340-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mod-beta-model"></span>
<img src="livro_files/figure-html/fig-mod-beta-model-1.png" alt="Gráfico do modelo GLM beta." width="100%" height="100%" />
<p class="caption">
Figura 8.24: Gráfico do modelo GLM beta.
</p>
</div>
</div>
<div id="para-se-aprofundar-4" class="section level2" number="8.11">
<h2><span class="header-section-number">8.11</span> Para se aprofundar</h2>
<p>Neste capítulo apenas fizemos uma breve introdução aos modelos lineares generalizados. Para conhecer um pouco mais a fundo todos os detalhes, recomendamos a consulta dos livros “Mixed effects models and extensions in ecology with R” de Zurr et al. <span class="citation">(<a href="#ref-zuur_mixed_2009" role="doc-biblioref">2009</a>)</span> e “Mixed-Effects Models in S and S-PLUS” de Pinheiro et al. <span class="citation">(<a href="#ref-pinheiro_mixed-effects_2000" role="doc-biblioref">Pinheiro &amp; Bates, 2000</a>)</span> que são as referências clássicas sobre GLM com aplicações em Ecologia. Para dados ordinais, sugerimos os livros “Analysis of ordinal categorical data” de Agresti <span class="citation">(<a href="#ref-agresti2010" role="doc-biblioref">2010</a>)</span> e “Categorical Data Analysis,” do mesmo autor, Agresti <span class="citation">(<a href="#ref-agresti_categorical_2012" role="doc-biblioref">2012</a>)</span>.</p>

</div>
</div>
<h3>Referências</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-agresti2010" class="csl-entry">
Agresti, A. (2010). <em><span class="nocase">Analysis of ordinal categorical data</span></em>. John Wiley &amp; Sons, Inc. <a href="https://doi.org/10.1002/9780470594001">https://doi.org/10.1002/9780470594001</a>
</div>
<div id="ref-agresti_categorical_2012" class="csl-entry">
Agresti, A. (2012). <em>Categorical <span>Data</span> <span>Analysis</span></em> (3rd Revised ed. edição). Wiley.
</div>
<div id="ref-BOLKER2009127" class="csl-entry">
Benjamin, M. B., Mollie, E. B., Connie, J. C., Shane, W. G., John, R. P., Henry, M. H. S., &amp; Jada-Simone, S. W. (2009). Generalized linear mixed models: A practical guide for ecology and evolution. <em>Trends in Ecology &amp; Evolution</em>, <em>24</em>(3), 127–135. https://doi.org/<a href="https://doi.org/10.1016/j.tree.2008.10.008">https://doi.org/10.1016/j.tree.2008.10.008</a>
</div>
<div id="ref-blascomoreno2019" class="csl-entry">
Blasco‐Moreno, A., Pérez‐Casany, M., Puig, P., Morante, M., &amp; Castells, E. (2019). <span class="nocase">What does a zero mean? Understanding false, random and structural zeros in ecology</span>. <em>Methods in Ecology and Evolution</em>, <em>10</em>(7), 949–959. <a href="https://doi.org/10.1111/2041-210X.13185">https://doi.org/10.1111/2041-210X.13185</a>
</div>
<div id="ref-brooks2017a" class="csl-entry">
Brooks, M. E., Kristensen, K., Benthem, K. J. V., Magnusson, A., Berg, C. W., Nielsen, A., Skaug, H. J., Mächler, M., &amp; Bolker, B. M. (2017). <span class="nocase">glmmTMB Balances speed and flexibility among packages for zero-inflated generalized linear mixed modeling</span>. <em>The R Journal</em>, <em>9</em>(2), 378. <a href="https://doi.org/10.32614/RJ-2017-066">https://doi.org/10.32614/RJ-2017-066</a>
</div>
<div id="ref-fox_ecological_2015" class="csl-entry">
Fox, G. A., Negrete-Yankelevich, S., &amp; Sosa, V. J. (Eds.). (2015). <em>Ecological statistics: Contemporary theory and application</em>. Oxford University Press.
</div>
<div id="ref-Franco-Belussi2018a" class="csl-entry">
Franco-Belussi, L., De Oliveira, C., &amp; Sköld, H. N. (2018). <span class="nocase">Regulation of eye and jaw colouration in three-spined stickleback Gasterosteus aculeatus</span>. <em>Journal of Fish Biology</em>, <em>92</em>(6), 1788–1804. <a href="https://doi.org/10.1111/jfb.13620">https://doi.org/10.1111/jfb.13620</a>
</div>
<div id="ref-Harrison" class="csl-entry">
Harrison, X. A., Donaldson, L., Correa-Cano, M. E., Evans, J., Fisher, D. N., Goodwin, C. E. D., Robinson, B. S., Hodgson, D. J., &amp; Inger, R. (2018). A brief introduction to mixed effects modelling and multi-model inference in ecology. <em>PeerJ</em>, <em>6</em>, e4794. <a href="https://doi.org/10.7717/peerj.4794">https://doi.org/10.7717/peerj.4794</a>
</div>
<div id="ref-ives2015" class="csl-entry">
Ives, A. R. (2015). <span class="nocase">For testing the significance of regression coefficients, go ahead and log-transform count data</span>. <em>Methods in Ecology and Evolution</em>, <em>6</em>(7), 828–835. <a href="https://doi.org/10.1111/2041-210X.12386">https://doi.org/10.1111/2041-210X.12386</a>
</div>
<div id="ref-lima2018" class="csl-entry">
Lima, V. F., Brito, S. V., Araujo Filho, J. A., Teles, D. A., Ribeiro, S. C., Teixeira, A. A. M., Pereira, A. M. A., &amp; Almeida, W. O. (2018). <span class="nocase">Raillietiella mottae (Pentastomida: Raillietiellidae) parasitizing four species of Gekkota lizards (Gekkonidae and Phyllodactylidae) in the Brazilian Caatinga</span>. <em>Helminthologia</em>, <em>55</em>(2), 140–145. <a href="https://doi.org/10.2478/helm-2018-0006">https://doi.org/10.2478/helm-2018-0006</a>
</div>
<div id="ref-nakagawa2017" class="csl-entry">
Nakagawa, S., Johnson, P. C. D., &amp; Schielzeth, H. (2017). <span class="nocase">The coefficient of determination R 2 and intra-class correlation coefficient from generalized linear mixed-effects models revisited and expanded</span>. <em>Journal of The Royal Society Interface</em>, <em>14</em>(134), 20170213. <a href="https://doi.org/10.1098/rsif.2017.0213">https://doi.org/10.1098/rsif.2017.0213</a>
</div>
<div id="ref-ohara2010" class="csl-entry">
O’Hara, R. B., &amp; Kotze, D. J. (2010). <span class="nocase">Do not log-transform count data</span>. <em>Methods in Ecology and Evolution</em>, <em>1</em>(2), 118–122. <a href="https://doi.org/10.1111/j.2041-210X.2010.00021.x">https://doi.org/10.1111/j.2041-210X.2010.00021.x</a>
</div>
<div id="ref-oliveira2020" class="csl-entry">
Oliveira, C. N., Campos, I. H. M. P., Provete, D. B., Guarnieri, M. C., &amp; Ribeiro, S. C. (2020). <span class="nocase">Defensive behaviour and tail autotomy in Coleodactylus meridionalis (Squamata: Sphaerodactylidae)</span>. <em>Journal of Natural History</em>, <em>54</em>(33-34), 2209–2218. <a href="https://doi.org/10.1080/00222933.2020.1840641">https://doi.org/10.1080/00222933.2020.1840641</a>
</div>
<div id="ref-pinheiro_mixed-effects_2000" class="csl-entry">
Pinheiro, J. C., &amp; Bates, D. M. (2000). <em><span class="nocase">Mixed-Effects Models in S and S-PLUS</span></em>. Springer-Verlag. <a href="https://doi.org/10.1007/b98882">https://doi.org/10.1007/b98882</a>
</div>
<div id="ref-prado2014" class="csl-entry">
Prado, V. H. M., &amp; Rossa-Feres, D. C. (2014). <span class="nocase">Multiple determinants of anuran richness and occurrence in an agricultural region in south-eastern Brazil</span>. <em>Environmental Management</em>, <em>53</em>(4), 823–837. <a href="https://doi.org/10.1007/s00267-014-0241-y">https://doi.org/10.1007/s00267-014-0241-y</a>
</div>
<div id="ref-warton2018" class="csl-entry">
Warton, D. I. (2018). <span class="nocase">Why you cannot transform your way out of trouble for small counts</span>. <em>Biometrics</em>, <em>74</em>(1), 362–368. <a href="https://doi.org/10.1111/biom.12728">https://doi.org/10.1111/biom.12728</a>
</div>
<div id="ref-zuur_mixed_2009" class="csl-entry">
Zuur, A. F., Ieno, E. N., Walker, N., Saveliev, A. A., &amp; Smith, G. M. (2009). <em>Mixed effects models and extensions in ecology with <span>R</span></em>. Springer New York. <a href="https://doi.org/10.1007/978-0-387-87458-6">https://doi.org/10.1007/978-0-387-87458-6</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cap7.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cap9.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/paternogbc/livro_aer/edit/master/08_modelos_lineares_generalizados.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/paternogbc/livro_aer/blob/master/08_modelos_lineares_generalizados.Rmd",
"text": null
},
"download": ["livro.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
