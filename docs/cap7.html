<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cap√≠tulo 7 Modelos lineares | An√°lises Ecol√≥gicas no R</title>
<meta name="author" content="Fernando Rodrigues da Silva, Thiago Gon√ßalves-Souza, Gustavo Brant Paterno,   Diogo Borges Provete, Maur√≠cio Humberto Vancine">
<meta name="description" content="Pr√©-requisitos do cap√≠tulo Pacotes e dados que ser√£o utilizados neste cap√≠tulo. ## Pacotes library(ecodados) library(car) library(ggpubr) library(ggforce) library(lsmeans) library(lmtest)...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Cap√≠tulo 7 Modelos lineares | An√°lises Ecol√≥gicas no R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://analises-ecologicas.netlify.app/cap7.html">
<meta property="og:image" content="https://analises-ecologicas.netlify.app/img/capa.jpeg">
<meta property="og:description" content="Pr√©-requisitos do cap√≠tulo Pacotes e dados que ser√£o utilizados neste cap√≠tulo. ## Pacotes library(ecodados) library(car) library(ggpubr) library(ggforce) library(lsmeans) library(lmtest)...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cap√≠tulo 7 Modelos lineares | An√°lises Ecol√≥gicas no R">
<meta name="twitter:description" content="Pr√©-requisitos do cap√≠tulo Pacotes e dados que ser√£o utilizados neste cap√≠tulo. ## Pacotes library(ecodados) library(car) library(ggpubr) library(ggforce) library(lsmeans) library(lmtest)...">
<meta name="twitter:image" content="https://analises-ecologicas.netlify.app/img/capa.jpeg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-23BB46Y290"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-23BB46Y290');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">An√°lises Ecol√≥gicas no R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Procurar" aria-label="Procurar">
</form>

      <nav aria-label="Sum√°rio"><h2><b>Sum√°rio</b></h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bem-vindos</a></li>
<li><a class="" href="pref%C3%A1cio.html">Pref√°cio</a></li>
<li><a class="" href="dedicat%C3%B3ria.html">Dedicat√≥ria</a></li>
<li><a class="" href="sobre-os-autores.html">Sobre os autores</a></li>
<li><a class="" href="revisores-e-colaboradores.html">Revisores e colaboradores</a></li>
<li><a class="" href="cap1.html"><span class="header-section-number">1</span> Introdu√ß√£o</a></li>
<li><a class="" href="cap2.html"><span class="header-section-number">2</span> Voltando ao b√°sico: como dominar a arte de fazer perguntas cientificamente relevantes</a></li>
<li><a class="" href="cap3.html"><span class="header-section-number">3</span> Pr√©-requisitos</a></li>
<li><a class="" href="cap4.html"><span class="header-section-number">4</span> Introdu√ß√£o ao R</a></li>
<li><a class="" href="cap5.html"><span class="header-section-number">5</span> Tidyverse</a></li>
<li><a class="" href="cap6.html"><span class="header-section-number">6</span> Visualiza√ß√£o de dados</a></li>
<li><a class="active" href="cap7.html"><span class="header-section-number">7</span> Modelos lineares</a></li>
<li><a class="" href="cap8.html"><span class="header-section-number">8</span> Modelos Lineares Generalizados</a></li>
<li><a class="" href="cap9.html"><span class="header-section-number">9</span> An√°lises Multidimensionais</a></li>
<li><a class="" href="cap10.html"><span class="header-section-number">10</span> Rarefa√ß√£o</a></li>
<li><a class="" href="cap11.html"><span class="header-section-number">11</span> Estimadores de riqueza</a></li>
<li><a class="" href="cap12.html"><span class="header-section-number">12</span> Diversidade Taxon√¥mica</a></li>
<li><a class="" href="cap13.html"><span class="header-section-number">13</span> Diversidade Filogen√©tica</a></li>
<li><a class="" href="cap14.html"><span class="header-section-number">14</span> Diversidade Funcional</a></li>
<li><a class="" href="cap15.html"><span class="header-section-number">15</span> Dados geoespaciais</a></li>
<li><a class="" href="gloss%C3%A1rio.html">Gloss√°rio</a></li>
<li><a class="" href="refer%C3%AAncias.html">Refer√™ncias</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/paternogbc/livro_aer">Ver c√≥digo fonte <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cap7" class="section level1" number="7">
<h1>
<span class="header-section-number">Cap√≠tulo 7</span> Modelos lineares<a class="anchor" aria-label="anchor" href="#cap7"><i class="fas fa-link"></i></a>
</h1>
<div id="pr√©-requisitos-do-cap√≠tulo-3" class="section level2 unnumbered">
<h2>Pr√©-requisitos do cap√≠tulo<a class="anchor" aria-label="anchor" href="#pr%C3%A9-requisitos-do-cap%C3%ADtulo-3"><i class="fas fa-link"></i></a>
</h2>
<p>Pacotes e dados que ser√£o utilizados neste cap√≠tulo.</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Pacotes</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ecodados</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggforce.data-imaginist.com">ggforce</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lsmeans</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dnychka/fieldsRPackage">fields</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan">vegan</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/blasern/rdist">rdist</a></span><span class="op">)</span>

<span class="co">## Dados</span>
<span class="va">CRC_PN_macho</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/teste_t_var_igual.html">teste_t_var_igual</a></span>
<span class="va">CRC_LP_femea</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/teste_t_var_diferente.html">teste_t_var_diferente</a></span>
<span class="va">Pareado</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/teste_t_pareado.html">teste_t_pareado</a></span>
<span class="va">correlacao_arbustos</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/correlacao.html">correlacao</a></span>
<span class="va">dados_regressao</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/regressoes.html">regressoes</a></span>
<span class="va">dados_regressao_mul</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/regressoes.html">regressoes</a></span>
<span class="va">dados_anova_simples</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/anova_simples.html">anova_simples</a></span>
<span class="va">dados_dois_fatores</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/anova_dois_fatores.html">anova_dois_fatores</a></span>
<span class="va">dados_dois_fatores_interacao</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/anova_dois_fatores.html">anova_dois_fatores</a></span>
<span class="va">dados_dois_fatores_interacao2</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/anova_dois_fatores_interacao2.html">anova_dois_fatores_interacao2</a></span>
<span class="va">dados_bloco</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/anova_bloco.html">anova_bloco</a></span>
<span class="va">dados_ancova</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/ancova.html">ancova</a></span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"mite"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"mite.xy"</span><span class="op">)</span>
<span class="va">coords</span> <span class="op">&lt;-</span> <span class="va">mite.xy</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"long"</span>, <span class="st">"lat"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"mite.env"</span><span class="op">)</span></code></pre></div>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
Estat√≠sticas frequentistas como as que ser√£o abordadas neste cap√≠tulo s√£o baseadas em testes estat√≠sticos (e.g., F, t, ùõò<sup>2</sup>, etc.), que s√£o resultados n√∫mericos do teste e possuem um valor de probabilidade (valor de P) associado com este teste <span class="citation">(<a href="refer%C3%AAncias.html#ref-gotelli_primer_2012" role="doc-biblioref">Gotelli and Ellison 2012</a>)</span>. <strong>O valor de P</strong> mede a probabilidade que os valores observados ou mais extremos seriam encontrados caso a hip√≥tese nula seja verdadeira (veja Cap√≠tulo <a href="cap2.html#cap2">2</a>). Ao longo do livro usaremos o crit√©rio convencional de rejeitar a hip√≥tese nula quando P &lt; 0.05. Contudo, sugerimos a leitura destes artigos <span class="citation">(<a href="refer%C3%AAncias.html#ref-white2013" role="doc-biblioref">White et al. 2014</a>; <a href="refer%C3%AAncias.html#ref-barber2014" role="doc-biblioref">Barber and Ogle 2014</a>; <a href="refer%C3%AAncias.html#ref-burnham_pvalues_2014" role="doc-biblioref">K. P. Burnham and Anderson 2014</a>; <a href="refer%C3%AAncias.html#ref-murtaugh2014" role="doc-biblioref">Murtaugh 2014</a>; <a href="refer%C3%AAncias.html#ref-Halsey2019" role="doc-biblioref">Halsey 2019</a>; <a href="refer%C3%AAncias.html#ref-MUFF2021" role="doc-biblioref">Muff et al. 2021</a>)</span> que discutem as limita√ß√µes e problemas associados ao valor de P.</p>
</div>
</div>
<div id="teste-t-de-student-para-duas-amostras-independentes" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Teste T (de Student) para duas amostras independentes<a class="anchor" aria-label="anchor" href="#teste-t-de-student-para-duas-amostras-independentes"><i class="fas fa-link"></i></a>
</h2>
<p>Uma das perguntas mais comuns em estat√≠stica √© saber se h√° diferen√ßa entre as m√©dias de dois grupos ou tratamentos. Para responder a esta pergunta, William Sealy Gosset, qu√≠mico da cervejaria Guinness, desenvolveu em 1908 o Teste T que √© uma estat√≠stica que segue uma distribui√ß√£o t de <em>Student</em> para rejeitar ou n√£o uma hip√≥tese nula de m√©dias iguais entre dois grupos.</p>
<p><span class="math display">\[t = \frac{(\bar{X}_1 - \bar{X}_2)}{\sqrt{\frac{2S^2_p}{n}}}\]</span></p>
<p>Onde:</p>
<ul>
<li>
<span class="math inline">\(\bar{X}\)</span><sub>1</sub> - <span class="math inline">\(\bar{X}\)</span><sub>2</sub> = diferen√ßa entre as m√©dias de duas amostras</li>
<li>S<sup>2</sup><sub>p</sub> = desvio padr√£o das amostras</li>
<li>
<em>n</em> = tamanho das amostras</li>
</ul>
<p><strong>Premissas do Teste t</strong></p>
<ul>
<li>As amostras devem ser independentes</li>
<li>As unidades amostrais s√£o selecionadas aleatoriamente</li>
<li>Distribui√ß√£o normal (gaussiana) dos res√≠duos</li>
<li>Homogeneidade da vari√¢ncia</li>
</ul>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br></p>
<ul>
<li><p>Zar <span class="citation">(<a href="refer%C3%AAncias.html#ref-zar_biostatistical_2010" role="doc-biblioref">2010</a>)</span> indica que o Teste T √© robusto mesmo com moderada viola√ß√£o da normalidade, principalmente se o tamanho amostral for alto.</p></li>
<li><p>Caso as vari√¢ncias n√£o sejam homog√™neas, isso deve ser informado na linha de comando, pois o denominador da f√≥rmula acima ser√° corrigido.</p></li>
</ul>
</div>
<p><strong>Avalia√ß√£o das premissas</strong></p>
<p>Uma das maneiras de avaliarmos as premissas de normalidade e homogeneidade da vari√¢ncia relacionadas √†s an√°lises do teste T, ANOVA e regress√µes lineares simples e m√∫ltiplas √© o uso da inspe√ß√£o gr√°fica da distribui√ß√£o dos res√≠duos (Figura <a href="cap7.html#fig:fig-homo-norm">7.1</a>) <span class="citation">(<a href="refer%C3%AAncias.html#ref-zuur_protocol_2009" role="doc-biblioref">A. F. Zuur, Ieno, and Elphick 2010</a>)</span>.</p>
<ul>
<li><p>A premissa de homogeneidade da vari√¢ncia pode ser avaliada atrav√©s do gr√°fico de dispers√£o dos res√≠duos (eixo X) pelos valores preditos da vari√°vel resposta (eixo Y) (Figura <a href="cap7.html#fig:fig-homo-norm">7.1</a>A). A distribui√ß√£o dos res√≠duos ser√° homog√™nea se n√£o observarmos nenhum padr√£o na distribui√ß√£o dos pontos (i.e.¬†forma em V, U ou funil).</p></li>
<li><p>A premissa de normalidade dos res√≠duos pode ser avaliada atrav√©s do gr√°fico de quantis-quantis (QQ-plots). A distribui√ß√£o dos res√≠duos ser√° normal se os pontos estiverem pr√≥ximos √† reta (Figura <a href="cap7.html#fig:fig-homo-norm">7.1</a>B).</p></li>
</ul>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-homo-norm"></span>
<img src="img/cap07_fig01.jpg" alt="Inspe√ß√£o gr√°fica da homogeneidade da vari√¢ncia (A) e normalidade dos res√≠duos (B). Os s√≠mbolos verdes indicam que os gr√°ficos em que os res√≠duos apresentam distribui√ß√£o homog√™nea e normal, enquanto os s√≠mbolos vermelhos indicam os gr√°ficos em que os res√≠duos violam as premissas do teste." width="100%" height="100%"><p class="caption">
Figura 7.1: Inspe√ß√£o gr√°fica da homogeneidade da vari√¢ncia (A) e normalidade dos res√≠duos (B). Os s√≠mbolos verdes indicam que os gr√°ficos em que os res√≠duos apresentam distribui√ß√£o homog√™nea e normal, enquanto os s√≠mbolos vermelhos indicam os gr√°ficos em que os res√≠duos violam as premissas do teste.
</p>
</div>
<p><strong>Exemplo pr√°tico 1 - Teste T para duas amostras com vari√¢ncias iguais</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Neste exemplo, avaliaremos o comprimento rostro-cloacal (CRC em mil√≠metros) de machos de <em>Physalaemus nattereri</em> (Anura:Leptodactylidae) amostrados em diferentes esta√ß√µes do ano com armadilhas de intercepta√ß√£o e queda na Regi√£o Noroeste do Estado de S√£o Paulo <span class="citation">(<a href="refer%C3%AAncias.html#ref-daSilva2010" role="doc-biblioref">da Silva and Rossa-Feres 2010</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>O CRC dos machos de <em>P. nattereri</em> √© maior na esta√ß√£o chuvosa do que na esta√ß√£o seca?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>O CRC dos machos ser√° maior na esta√ß√£o chuvosa porque h√° uma vantagem seletiva para os indiv√≠duos maiores durante a atividade reprodutiva</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Data frame com os indiv√≠duos (unidade amostral) nas linhas e CRC (mm - vari√°vel resposta cont√≠nua) e esta√ß√£o (vari√°vel preditora categ√≥rica) como colunas</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Verificar se o seu data frame est√° com as unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunas</li>
</ul>
<p><strong>An√°lise</strong></p>
<p>Vamos olhar os dados usando a fun√ß√£o <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cabe√ßalho dos dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">CRC_PN_macho</span><span class="op">)</span> 
<span class="co">#&gt;    CRC Estacao</span>
<span class="co">#&gt; 1 3.82 Chuvosa</span>
<span class="co">#&gt; 2 3.57 Chuvosa</span>
<span class="co">#&gt; 3 3.67 Chuvosa</span>
<span class="co">#&gt; 4 3.72 Chuvosa</span>
<span class="co">#&gt; 5 3.75 Chuvosa</span>
<span class="co">#&gt; 6 3.83 Chuvosa</span></code></pre></div>
<p>Vamos verificar a normalidade dos res√≠duos usando o QQ-plot (Figura <a href="cap7.html#fig:fig-qqplot-var-igual">7.2</a>).</p>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Teste de normalidade</span>
<span class="va">residuos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">CRC</span> <span class="op">~</span> <span class="va">Estacao</span>, data <span class="op">=</span> <span class="va">CRC_PN_macho</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/car/man/qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="va">residuos</span><span class="op">)</span>
<span class="co">#&gt; [1] 22 26</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-qqplot-var-igual"></span>
<img src="livro_files/figure-html/fig-qqplot-var-igual-1.png" alt="Normalidade dos res√≠duos usando o QQ-plot." width="100%" height="100%"><p class="caption">
Figura 7.2: Normalidade dos res√≠duos usando o QQ-plot.
</p>
</div>
<p>Os pontos est√£o pr√≥ximos √† reta, indicando que a distribui√ß√£o dos res√≠duos √© normal (veja Figura <a href="cap7.html#fig:fig-homo-norm">7.1</a>).</p>
<p>Outra possibilidade √© usar os testes de Shapiro-Wilk e Levene para verificar a normalidade e a homogeneidade da vari√¢ncia, respectivamente.</p>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
A Hip√≥tese Nula (H<sub>0</sub>) destes testes √© que a distribui√ß√£o √© normal ou homog√™nea:</p>
<ul>
<li>Valor de p &lt; 0.05 significa que os dados <strong>n√£o apresentam</strong> distribui√ß√£o normal ou homog√™nea</li>
<li>Valor de p &gt; 0.05 significa que os dados <strong>apresentam</strong> distribui√ß√£o normal ou homog√™nea</li>
</ul>
</div>
<p>Teste de Shapiro-Wilk para normalidade dos res√≠duos.</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Teste de Shapiro-Wilk</span>
<span class="va">residuos_modelo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">residuos</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">residuos_modelo</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Shapiro-Wilk normality test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  residuos_modelo</span>
<span class="co">#&gt; W = 0.98307, p-value = 0.6746</span></code></pre></div>
<p>Teste de Levene para homogeneidade de vari√¢ncia dos res√≠duos.</p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Teste de homogeneidade de vari√¢ncia</span>
<span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html">leveneTest</a></span><span class="op">(</span><span class="va">CRC</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Estacao</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">CRC_PN_macho</span><span class="op">)</span>
<span class="co">#&gt; Levene's Test for Homogeneity of Variance (center = median)</span>
<span class="co">#&gt;       Df F value Pr(&gt;F)</span>
<span class="co">#&gt; group  1  1.1677 0.2852</span>
<span class="co">#&gt;       49</span></code></pre></div>
<p>Percebam que a distribui√ß√£o dos res√≠duos foi normal e homog√™nea na inspe√ß√£o gr√°fica, assim como nos testes de Shapiro e Levene, respectivamente. Agora podemos realizar a an√°lise sabendo que os dados seguem as premissas requeridas pelo Teste T.</p>
<p>Vamos para os c√≥digos da an√°lise do Teste T para amostragens independentes e vari√¢ncias iguais.</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## An√°lise Teste T </span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">CRC</span> <span class="op">~</span> <span class="va">Estacao</span>, data <span class="op">=</span> <span class="va">CRC_PN_macho</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  CRC by Estacao</span>
<span class="co">#&gt; t = 4.1524, df = 49, p-value = 0.000131</span>
<span class="co">#&gt; alternative hypothesis: true difference in means between group Chuvosa and group Seca is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.2242132 0.6447619</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean in group Chuvosa    mean in group Seca </span>
<span class="co">#&gt;              3.695357              3.260870</span></code></pre></div>
<p>Quatro valores devem ser apresentados aos leitores: i) estat√≠stica do teste - representada por <strong>t = 4,15</strong>, ii) valor de signific√¢ncia - representado por <strong>p-value = 0,0001</strong>, iii) graus de liberdade - representado por <strong>df = 49</strong>, e iv) diferen√ßa entre as m√©dias. Veja abaixo como descrever os resultados no seu trabalho.</p>
<p>Visualizar os resultados em gr√°fico (Figura <a href="cap7.html#fig:fig-test-t-ind-var-igual">7.3</a>).</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">CRC_PN_macho</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Estacao</span>, y <span class="op">=</span> <span class="va">CRC</span>, color <span class="op">=</span> <span class="va">Estacao</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Esta√ß√µes"</span>, 
         y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"CRC (mm) - "</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span><span class="op">(</span><span class="st">"P. nattereri"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"cyan4"</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, 
                 outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">16</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>, 
                cex <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-test-t-ind-var-igual"></span>
<img src="livro_files/figure-html/fig-test-t-ind-var-igual-1.png" alt="Boxplot da an√°lise do Teste T para duas amostras com vari√¢ncias iguais." width="100%" height="100%"><p class="caption">
Figura 7.3: Boxplot da an√°lise do Teste T para duas amostras com vari√¢ncias iguais.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Neste exemplo, rejeitamos a hip√≥tese nula de que as m√©dias do CRC dos machos entre as esta√ß√µes seca e chuvosa s√£o iguais. Os resultados mostram que os machos de <em>P. nattereri</em> coletados na esta√ß√£o chuvosa foram em m√©dia 0,43 mm maiores do que os machos coletados na esta√ß√£o seca (t<sub>49</sub> = 4,15, P &lt; 0,001).</p>
<p><strong>Exemplo pr√°tico 2 - Teste T para duas amostras independentes com vari√¢ncias diferentes</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Neste exemplo, avaliaremos o comprimento rostro-cloacal (CRC - mil√≠metros) de f√™meas de <em>Leptodactylus podicipinus</em> amostradas em diferentes esta√ß√µes do ano com armadilhas de intercepta√ß√£o e queda na Regi√£o Noroeste do Estado de S√£o Paulo <span class="citation">(<a href="refer%C3%AAncias.html#ref-daSilva2010" role="doc-biblioref">da Silva and Rossa-Feres 2010</a>)</span>.</p>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
Os dados foram alterados em rela√ß√£o a publica√ß√£o original para se enquadrarem no exemplo de amostras com vari√¢ncias diferentes.</p>
</div>
<p><strong>Pergunta</strong></p>
<ul>
<li>O CRC das f√™meas de <em>L. podicipinus</em> √© maior na esta√ß√£o chuvosa do que na esta√ß√£o seca?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>O CRC das f√™meas ser√° maior na esta√ß√£o chuvosa porque h√° uma vantagem seletiva para os indiv√≠duos maiores durante a atividade reprodutiva</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Data frame com os indiv√≠duos (unidade amostral) nas linhas e CRC (mm - vari√°vel resposta cont√≠nua) e esta√ß√£o (vari√°vel preditora categ√≥rica) como colunas</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Verificar se o seu data frame est√° com as unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunas</li>
</ul>
<p><strong>An√°lise</strong></p>
<p>Olhar os dados usando a fun√ß√£o <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cabe√ßalho dos dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">CRC_LP_femea</span><span class="op">)</span> 
<span class="co">#&gt;    CRC Estacao</span>
<span class="co">#&gt; 1 2.72 Chuvosa</span>
<span class="co">#&gt; 2 2.10 Chuvosa</span>
<span class="co">#&gt; 3 3.42 Chuvosa</span>
<span class="co">#&gt; 4 1.50 Chuvosa</span>
<span class="co">#&gt; 5 3.90 Chuvosa</span>
<span class="co">#&gt; 6 4.00 Chuvosa</span></code></pre></div>
<p>Vamos avaliar as premissas do teste. Come√ßando com o teste de normalidade (Figura <a href="cap7.html#fig:fig-qqplot-var-dif">7.4</a>).</p>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Teste de normalidade usando QQ-plot</span>
<span class="va">residuos_LP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">CRC</span> <span class="op">~</span> <span class="va">Estacao</span>, data <span class="op">=</span> <span class="va">CRC_LP_femea</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/car/man/qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="va">residuos_LP</span><span class="op">)</span>
<span class="co">#&gt; [1] 4 6</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-qqplot-var-dif"></span>
<img src="livro_files/figure-html/fig-qqplot-var-dif-1.png" alt="Normalidade dos res√≠duos usando o QQ-plot." width="100%" height="100%"><p class="caption">
Figura 7.4: Normalidade dos res√≠duos usando o QQ-plot.
</p>
</div>
<p>Os res√≠duos apresentam distribui√ß√£o normal. Vamos testar tamb√©m com o Shapiro-Wilk para normalidade dos res√≠duos.</p>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Teste de Shapiro-Wilk</span>
<span class="va">residuos_modelo_LP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">residuos_LP</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">residuos_modelo_LP</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Shapiro-Wilk normality test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  residuos_modelo_LP</span>
<span class="co">#&gt; W = 0.96272, p-value = 0.8219</span></code></pre></div>
<p>Agora vamos avaliar a homogeneidade da vari√¢ncia.</p>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Teste de homogeneidade da vari√¢ncia</span>
<span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html">leveneTest</a></span><span class="op">(</span><span class="va">CRC</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Estacao</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">CRC_LP_femea</span><span class="op">)</span>
<span class="co">#&gt; Levene's Test for Homogeneity of Variance (center = median)</span>
<span class="co">#&gt;       Df F value  Pr(&gt;F)  </span>
<span class="co">#&gt; group  1  9.8527 0.01053 *</span>
<span class="co">#&gt;       10                  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Os res√≠duos n√£o apresentam homogeneidade da vari√¢ncia. Portanto, vamos realizar o Teste T com vari√¢ncias diferentes. Para isso, use o argumento <code>var.equal = FALSE</code>.</p>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Teste T</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">CRC</span> <span class="op">~</span> <span class="va">Estacao</span>, data <span class="op">=</span> <span class="va">CRC_LP_femea</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  CRC by Estacao</span>
<span class="co">#&gt; t = -1.7633, df = 6.4998, p-value = 0.1245</span>
<span class="co">#&gt; alternative hypothesis: true difference in means between group Chuvosa and group Seca is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -1.5489301  0.2375016</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean in group Chuvosa    mean in group Seca </span>
<span class="co">#&gt;              2.834286              3.490000</span></code></pre></div>
<p>Neste exemplo, n√£o rejeitamos a hip√≥tese nula e consideramos que as m√©dias do CRC das f√™meas entre as esta√ß√µes seca e chuvosa s√£o iguais (t<sub>6,49</sub> = 1,76, P = 0,12).</p>
<p>Vamos visualizar os resultados em um gr√°fico (Figura <a href="cap7.html#fig:fig-test-t-ind-var-dif">7.5</a>).</p>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">CRC_LP_femea</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Estacao</span>, y <span class="op">=</span> <span class="va">CRC</span>, color <span class="op">=</span> <span class="va">Estacao</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"cyan4"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.5</span>, 
                 color <span class="op">=</span> <span class="st">"black"</span>, outlier.shape <span class="op">=</span> <span class="cn">NA</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">20</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, cex <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Esta√ß√µes"</span>, 
         y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"CRC (mm) - "</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span><span class="op">(</span><span class="st">"L. podicipinus"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-test-t-ind-var-dif"></span>
<img src="livro_files/figure-html/fig-test-t-ind-var-dif-1.png" alt="Boxplot da an√°lise do Teste T para duas amostras independentes com vari√¢ncias diferentes." width="100%" height="100%"><p class="caption">
Figura 7.5: Boxplot da an√°lise do Teste T para duas amostras independentes com vari√¢ncias diferentes.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Os resultados mostram que as f√™meas de <em>L. podicipinus</em> coletadas na esta√ß√£o chuvosa n√£o s√£o maiores do que as f√™meas coletadas na esta√ß√£o seca, apesar de possu√≠rem maior vari√¢ncia, o que pode ser biologicamente interessante.</p>
</div>
<div id="teste-t-para-amostras-pareadas" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Teste T para amostras pareadas<a class="anchor" aria-label="anchor" href="#teste-t-para-amostras-pareadas"><i class="fas fa-link"></i></a>
</h2>
<p>O Teste T Pareado √© uma estat√≠stica que usa dados medidos duas vezes na mesma unidade amostral, resultando em pares de observa√ß√µes para cada amostra (amostras pareadas). Ele determina se a diferen√ßa da m√©dia entre duas observa√ß√µes √© zero.</p>
<p><span class="math display">\[t = \frac{\bar{d}}{S_{\bar{d}}}\]</span></p>
<p>Onde:
- <span class="math inline">\(\bar{d}\)</span> = m√©dia da diferen√ßa das medidas pareadas. Observe que o teste n√£o usa as medidas originais, e sim, a diferen√ßa para cada par
- S<sub><span class="math inline">\(\bar{d}\)</span></sub> = erro padr√£o da diferen√ßa das medidas pareadas</p>
<p><strong>Premissas do Teste t para amostras pareadas</strong></p>
<ul>
<li>As unidades amostrais s√£o selecionadas aleatoriamente</li>
<li>As observa√ß√µes <strong>n√£o</strong> s√£o independentes</li>
<li>Distribui√ß√£o normal (gaussiana) dos valores da diferen√ßa para cada par</li>
</ul>
<p><strong>Exemplo pr√°tico 1 - Teste T para amostras pareadas</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Neste exemplo, avaliaremos a diferen√ßa na riqueza de esp√©cies de artr√≥podes registradas em 27 localidades. Todas as localidades foram amostradas duas vezes. A primeira amostragem foi realizada na localidade antes da perturba√ß√£o e a segunda amostragem foi realizada ap√≥s a localidade ter sofrido uma queimada. Portanto, existe uma depend√™ncia temporal, uma vez que amostramos a mesma localidade antes e depois da queimada.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>A riqueza de esp√©cies de artr√≥podes √© prejudicada pelas queimadas?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>A riqueza de esp√©cies de artr√≥podes ser√° maior antes da queimada devido a extin√ß√£o local das esp√©cies</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>data frame com as localidades nas linhas e riqueza de esp√©cies (vari√°vel resposta cont√≠nua) e estado (Pr√©-queimada ou P√≥s-queimada - vari√°vel preditora categ√≥rica) da localidade nas colunas</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Verificar se o seu data frame est√° com as unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunas</li>
</ul>
<p><strong>An√°lise</strong></p>
<p>Olhando os dados com a fun√ß√£o <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cabe√ßalho dos dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">Pareado</span><span class="op">)</span> 
<span class="co">#&gt;   Areas Riqueza       Estado</span>
<span class="co">#&gt; 1     1      92 Pre-Queimada</span>
<span class="co">#&gt; 2     2      74 Pre-Queimada</span>
<span class="co">#&gt; 3     3      96 Pre-Queimada</span>
<span class="co">#&gt; 4     4      89 Pre-Queimada</span>
<span class="co">#&gt; 5     5      76 Pre-Queimada</span>
<span class="co">#&gt; 6     6      80 Pre-Queimada</span></code></pre></div>
<p>C√°lculo do Teste T com amostras pareadas.</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## An√°lise Teste T Pareado</span>

<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Riqueza</span> <span class="op">~</span> <span class="va">Estado</span>, paired <span class="op">=</span> <span class="cn">TRUE</span>, data <span class="op">=</span> <span class="va">Pareado</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Paired t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  Riqueza by Estado</span>
<span class="co">#&gt; t = -7.5788, df = 26, p-value = 4.803e-08</span>
<span class="co">#&gt; alternative hypothesis: true mean difference is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -56.63994 -32.47117</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean difference </span>
<span class="co">#&gt;       -44.55556</span></code></pre></div>
<p>Neste exemplo, rejeitamos a hip√≥tese nula de que a riqueza de esp√©cies de artr√≥podes √© igual antes e depois da queimada (t<sub>26</sub> = 7,57, P &lt; 0,001).</p>
<p>Podemos visualizar os resultados em gr√°fico (Figura <a href="cap7.html#fig:fig-test-t-par">7.6</a>).</p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggpaired.html">ggpaired</a></span><span class="op">(</span><span class="va">Pareado</span>, x <span class="op">=</span> <span class="st">"Estado"</span>, y <span class="op">=</span> <span class="st">"Riqueza"</span>,
         color <span class="op">=</span> <span class="st">"Estado"</span>, line.color <span class="op">=</span> <span class="st">"gray"</span>, line.size <span class="op">=</span> <span class="fl">0.8</span>, 
         palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"cyan4"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.5</span>, 
         point.size <span class="op">=</span> <span class="fl">4</span>, xlab <span class="op">=</span> <span class="st">"Estado das localidades"</span>, 
         ylab <span class="op">=</span> <span class="st">"Riqueza de Esp√©cies"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">150</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-test-t-par"></span>
<img src="livro_files/figure-html/fig-test-t-par-1.png" alt="Boxplot da an√°lise do Teste T para duas amostras pareadas." width="100%" height="100%"><p class="caption">
Figura 7.6: Boxplot da an√°lise do Teste T para duas amostras pareadas.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Os resultados mostram que as localidades ap√≥s as queimadas apresentam em m√©dia 44,5 esp√©cies de artr√≥podes a menos do que antes das queimadas.</p>
</div>
<div id="correla√ß√£o-de-pearson" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Correla√ß√£o de Pearson<a class="anchor" aria-label="anchor" href="#correla%C3%A7%C3%A3o-de-pearson"><i class="fas fa-link"></i></a>
</h2>
<p>√â um teste que mede a for√ßa relativa da rela√ß√£o linear entre duas vari√°veis cont√≠nuas (X e Y). Importante ressaltar que a an√°lise de correla√ß√£o n√£o assume que a vari√°vel X influencie a vari√°vel Y, ou que exista uma rela√ß√£o de causa e efeito entre elas <span class="citation">(<a href="refer%C3%AAncias.html#ref-zar_biostatistical_2010" role="doc-biblioref">Zar 2010</a>)</span>. A an√°lise √© definida em termos da vari√¢ncia de X, a vari√¢ncia de Y, e a covari√¢ncia de X e Y (i.e.¬†como elas variam juntas).</p>
<p><span class="math display">\[r = \frac{\sum{XY} - \frac{\sum{X} \sum{Y}}{n}}{\sqrt{\left(\sum{X^2} - \frac{\sum{X}^2}{n}\right)\left(\sum{Y^2} - \frac{\sum{Y}^2}{n}\right)}}\]</span></p>
<p>Onde:</p>
<ul>
<li>r = coeficiente de correla√ß√£o que indica a for√ßa da rela√ß√£o linear entre as duas vari√°veis. Seu limite de valores est√° entre -1 <span class="math inline">\(\leq\)</span> r <span class="math inline">\(\le\)</span> 1. A correla√ß√£o positiva indica que o aumento no valor de uma das vari√°veis √© acompanhado pelo aumento no valor da outra vari√°vel. A correla√ß√£o negativa indica que o aumento no valor de uma das vari√°veis √© acompanhado pela diminui√ß√£o no valor da outra vari√°vel. Se <em>r</em> √© igual a zero, n√£o existe correla√ß√£o entre as vari√°veis (Figura <a href="cap7.html#fig:fig-cor">7.7</a>).</li>
</ul>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-cor"></span>
<img src="img/cap07_fig02.jpg" alt="Exemplo de correla√ß√µes negativa (A), positiva (B) e nula (C) e vari√°veis que n√£o apresentam rela√ß√µes lineares entre si (D-E)." width="100%" height="100%"><p class="caption">
Figura 7.7: Exemplo de correla√ß√µes negativa (A), positiva (B) e nula (C) e vari√°veis que n√£o apresentam rela√ß√µes lineares entre si (D-E).
</p>
</div>
<p><strong>Premissas da Correla√ß√£o de Person</strong></p>
<ul>
<li>As amostras devem ser independentes e pareadas (i.e., as duas vari√°veis devem ser medidas na mesma unidade amostral)</li>
<li>As unidades amostrais s√£o selecionadas aleatoriamente</li>
<li>A rela√ß√£o entre as vari√°veis tem que ser linear</li>
</ul>
<p><strong>Exemplo pr√°tico 1 - Correla√ß√£o de Pearson</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Neste exemplo, avaliaremos a correla√ß√£o entre a altura do tronco e o tamanho da raiz medidos em 35 indiv√≠duos de uma esp√©cie vegetal arbustiva.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existe correla√ß√£o entre a altura do tronco e o tamanho da raiz dos arbustos?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>A altura do tronco √© positivamente correlacionada com o tamanho da raiz</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>data frame com os indiv√≠duos (unidade amostral) nas linhas e altura do tronco e tamanho da raiz (duas vari√°veis t√™m que ser cont√≠nuas) como colunas</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Verificar se o seu data frame est√° com as unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunas</li>
</ul>
<p><strong>An√°lise</strong></p>
<p>Vamos olhar os dados com a fun√ß√£o <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cabe√ßalho dos dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">correlacao_arbustos</span><span class="op">)</span> 
<span class="co">#&gt;   Tamanho_raiz Tamanho_tronco</span>
<span class="co">#&gt; 1    10.177049       19.54383</span>
<span class="co">#&gt; 2     6.622634       17.13558</span>
<span class="co">#&gt; 3     7.773629       19.50681</span>
<span class="co">#&gt; 4    11.055257       21.57085</span>
<span class="co">#&gt; 5     4.487274       13.22763</span>
<span class="co">#&gt; 6    11.190216       21.62902</span></code></pre></div>
<p>C√°lculo do Teste da Correla√ß√£o de Pearson. Para outros testes de correla√ß√£o como Kendall ou Spearman √© s√≥ alterar o argumento <code>method</code> e inserir o teste desejado.</p>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Correla√ß√£o de Pearson</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">correlacao_arbustos</span><span class="op">$</span><span class="va">Tamanho_raiz</span>, <span class="va">correlacao_arbustos</span><span class="op">$</span><span class="va">Tamanho_tronco</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pearson's product-moment correlation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  correlacao_arbustos$Tamanho_raiz and correlacao_arbustos$Tamanho_tronco</span>
<span class="co">#&gt; t = 11.49, df = 33, p-value = 4.474e-13</span>
<span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.7995083 0.9457816</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;       cor </span>
<span class="co">#&gt; 0.8944449</span>

<span class="co">## Alternativamente</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Tamanho_tronco</span> <span class="op">+</span> <span class="va">Tamanho_raiz</span>, data <span class="op">=</span> <span class="va">correlacao_arbustos</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pearson's product-moment correlation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  Tamanho_tronco and Tamanho_raiz</span>
<span class="co">#&gt; t = 11.49, df = 33, p-value = 4.474e-13</span>
<span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.7995083 0.9457816</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;       cor </span>
<span class="co">#&gt; 0.8944449</span></code></pre></div>
<p>Neste exemplo, rejeitamos a hip√≥tese nula de que as vari√°veis n√£o s√£o correlacionadas (r = 0.89, P &lt; 0,001).</p>
<p>Podemos visualizar os resultados em gr√°fico (Figura <a href="cap7.html#fig:fig-cor-dados">7.8</a>).</p>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">correlacao_arbustos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tamanho_raiz</span>, y <span class="op">=</span> <span class="va">Tamanho_tronco</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Tamanho da raiz (m)"</span>, y <span class="op">=</span> <span class="st">"Altura do tronco (m)"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">14</span>, y <span class="op">=</span> <span class="fl">14</span>, label <span class="op">=</span> <span class="st">"r = 0.89, P &lt; 0.001"</span>, 
              color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-cor-dados"></span>
<img src="livro_files/figure-html/fig-cor-dados-1.png" alt="Gr√°fico mostrando a rela√ß√£o entre as vari√°veis e uma linha de tend√™ncia dos dados." width="100%" height="100%"><p class="caption">
Figura 7.8: Gr√°fico mostrando a rela√ß√£o entre as vari√°veis e uma linha de tend√™ncia dos dados.
</p>
</div>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
A linha de tend√™ncia tracejada no gr√°fico √© apenas para ilustrar a rela√ß√£o positiva entre as vari√°veis. Ela n√£o √© gerada pela an√°lise de correla√ß√£o.</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Os resultados mostram que o aumento na altura dos arbustos √© acompanhado pelo aumento no tamanho da raiz.</p>
</div>
<div id="regress√£o-linear-simples" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Regress√£o Linear Simples<a class="anchor" aria-label="anchor" href="#regress%C3%A3o-linear-simples"><i class="fas fa-link"></i></a>
</h2>
<p>A regress√£o linear simples √© usada para analisar a rela√ß√£o entre uma vari√°vel preditora (plotada no eixo-X) e uma vari√°vel resposta (plotada no eixo-Y). As duas vari√°veis devem ser cont√≠nuas. Diferente das correla√ß√µes, a regress√£o assume uma rela√ß√£o de causa e efeito entre as vari√°veis. O valor da vari√°vel preditora (X) causa, direta ou indiretamente, o valor da vari√°vel resposta (Y). Assim, Y √© uma fun√ß√£o linear de X:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_{1}X_i + \epsilon_i\]</span></p>
<p>Onde:</p>
<ul>
<li>
<span class="math inline">\(\beta_0\)</span> = intercepto (<em>intercept</em>) que representa o valor da fun√ß√£o quando X = 0</li>
<li>
<span class="math inline">\(\beta_{1}\)</span> = inclina√ß√£o (<em>slope</em>) que mede a mudan√ßa na vari√°vel Y para cada mudan√ßa de unidade da vari√°vel X</li>
<li>
<span class="math inline">\(\epsilon_{1}\)</span> = erro aleat√≥rio referente √† vari√°vel Y que n√£o pode ser explicado pela vari√°vel X</li>
</ul>
<p><strong>Premissas da Regress√£o Linear Simples</strong></p>
<ul>
<li>As amostras devem ser independentes</li>
<li>As unidades amostrais s√£o selecionadas aleatoriamente</li>
<li>Distribui√ß√£o normal (gaussiana) dos res√≠duos</li>
<li>Homogeneidade da vari√¢ncia dos res√≠duos</li>
</ul>
<p><strong>Exemplo pr√°tico 1 - Regress√£o Linear Simples</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Neste exemplo, avaliaremos a rela√ß√£o entre o gradiente de temperatura m√©dia anual (¬∞C) e o tamanho m√©dio do comprimento rostro-cloacal (CRC em mm) de popula√ß√µes de <em>Dendropsophus minutus</em> (Anura:Hylidae) amostradas em 109 localidades no Brasil <span class="citation">(<a href="refer%C3%AAncias.html#ref-boaratti2015" role="doc-biblioref">Boaratti and Da Silva 2015</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>A temperatura afeta o tamanho do CRC de popula√ß√µes de <em>Dendropsophus minutus</em>?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Os CRC das popula√ß√µes ser√£o menores em localidades mais quentes do que em localidades mais frias de acordo com a Hip√≥tese do Balan√ßo de Calor <span class="citation">(<a href="refer%C3%AAncias.html#ref-olalla-t%C3%A1rraga2007" role="doc-biblioref">Olalla-T√°rraga and Rodr√≠guez 2007</a>)</span>
</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Data frame com as popula√ß√µes (unidade amostral) nas linhas e CRC (vari√°vel resposta) m√©dio (mm) e temperatura m√©dia anual (vari√°vel preditora) como colunas</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Verificar se o seu data frame est√° com as unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunas</li>
</ul>
<p><strong>An√°lise</strong></p>
<p>Olhando os dados com a fun√ß√£o <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cabe√ßalho dos dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dados_regressao</span><span class="op">)</span> 
<span class="co">#&gt;      Municipio      CRC Temperatura Precipitacao</span>
<span class="co">#&gt; 1     Acorizal 22.98816    24.13000       1228.2</span>
<span class="co">#&gt; 2  Alpinopolis 22.91788    20.09417       1487.6</span>
<span class="co">#&gt; 3 Alto_Paraiso 21.97629    21.86167       1812.4</span>
<span class="co">#&gt; 4    Americana 23.32453    20.28333       1266.2</span>
<span class="co">#&gt; 5      Apiacas 22.83651    25.47333       2154.0</span>
<span class="co">#&gt; 6  Arianopolis 20.86989    20.12167       1269.2</span></code></pre></div>
<p>Vamos calcular a regress√£o linear simples.</p>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## regress√£o simples</span>
<span class="va">modelo_regressao</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">CRC</span> <span class="op">~</span> <span class="va">Temperatura</span>, data <span class="op">=</span> <span class="va">dados_regressao</span><span class="op">)</span></code></pre></div>
<p>Antes de vermos os resultados, vamos verificar a normalidade e homogeneidade das vari√¢ncias (Figura <a href="cap7.html#fig:fig-lm-pre">7.9</a>).</p>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Verificar as premissas do teste</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">modelo_regressao</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># volta a configura√ß√£o dos gr√°ficos para o formato padr√£o </span>
<span class="co">#&gt; null device </span>
<span class="co">#&gt;           1</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-lm-pre"></span>
<img src="livro_files/figure-html/fig-lm-pre-1.png" alt="Gr√°ficos mostrando as premissas da regress√£o linear simples." width="100%" height="100%"><p class="caption">
Figura 7.9: Gr√°ficos mostrando as premissas da regress√£o linear simples.
</p>
</div>
<p>Os gr√°ficos <em>Residuals vs Fitted</em>, <em>Scale-Location</em>, e <em>Residual vs Leverage</em> est√£o relacionados com a homogeneidade da vari√¢ncia. Nestes gr√°ficos, esperamos ver os pontos dispersos no espa√ßo sem padr√µes com formatos em <em>U</em> ou funil. Neste caso, vemos que as linhas vermelhas (que indicam a tend√™ncia dos dados) est√£o praticamente retas, seguindo a linha pontilhada, sugerindo que n√£o exista heterogeneidade de vari√¢ncia dos res√≠duos. O gr√°fico <em>Residual vs Leverage</em>, identifica os valores extremos que estejam a mais de uma unidade da dist√¢ncia de Cook (linha pontilhada vermelha). Quando muito discrepantes, esses valores podem influenciar os resultados dos testes estat√≠sticos. Tamb√©m n√£o temos problemas com esse pressuposto do modelo aqui. O gr√°fico <em>Normal Q-Q (quantile-quantile plot)</em> mede desvios da normalidade. Neste caso, esperamos que os pontos sigam uma linha reta (i.e.¬†fiquem muito pr√≥ximos da linha pontilhada) e n√£o apresentem padr√µes com formatos de <em>S</em> ou arco. Podemos observar que tanto a normalidade como a homogeneidade do res√≠duos est√£o dentro dos padr√µes esperados.</p>
<p>Vamos ver os resultados da regress√£o simples usando as fun√ß√µes <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> e <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>. A fun√ß√£o <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> retorna uma tabela contendo o grau de liberdade (df), soma dos quadrados, valor de F e o valor de P.</p>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Resultados usando a fun√ß√£o anova</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modelo_regressao</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: CRC</span>
<span class="co">#&gt;              Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span>
<span class="co">#&gt; Temperatura   1  80.931  80.931   38.92 9.011e-09 ***</span>
<span class="co">#&gt; Residuals   107 222.500   2.079                      </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>A fun√ß√£o <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> retorna uma tabela contendo o valor do intercepto, inclina√ß√£o da reta (<em>slope</em>) e o coeficiente de determina√ß√£o (R<sup>2</sup>) que indica a propor√ß√£o da varia√ß√£o na vari√°vel Y que pode ser atribu√≠da √† varia√ß√£o na vari√°vel X. Percebam que a parte final dos resultados apresentados no <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> s√£o os mesmo apresentados pela fun√ß√£o <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>.</p>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Resultados usando a fun√ß√£o summary</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelo_regressao</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = CRC ~ Temperatura, data = dados_regressao)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -3.4535 -0.7784  0.0888  0.9168  3.1868 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept) 16.23467    0.91368  17.768  &lt; 2e-16 ***</span>
<span class="co">#&gt; Temperatura  0.26905    0.04313   6.239 9.01e-09 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 1.442 on 107 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.2667, Adjusted R-squared:  0.2599 </span>
<span class="co">#&gt; F-statistic: 38.92 on 1 and 107 DF,  p-value: 9.011e-09</span></code></pre></div>
<p>Vamos visualizar os resultados em gr√°fico (Figura <a href="cap7.html#fig:fig-lm">7.10</a>).</p>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dados_regressao</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Temperatura</span>, y <span class="op">=</span> <span class="va">CRC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Temperatura m√©dia anual (¬∞C)"</span>, 
         y <span class="op">=</span> <span class="st">"Comprimento rostro-cloacal (mm)"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-lm"></span>
<img src="livro_files/figure-html/fig-lm-1.png" alt="Gr√°fico mostrando a rela√ß√£o entre as vari√°veis e modelo linear simples, representado pela linha cont√≠nua." width="100%" height="100%"><p class="caption">
Figura 7.10: Gr√°fico mostrando a rela√ß√£o entre as vari√°veis e modelo linear simples, representado pela linha cont√≠nua.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Neste exemplo, rejeitamos a hip√≥tese nula de que n√£o existe rela√ß√£o entre o tamanho do CRC das popula√ß√µes de <em>D. minutus</em> e a temperatura da localidade onde elas ocorrem (F<sub>1,107</sub> = 38,92, P &lt; 0,001). Os resultados mostram que o tamanho do CRC das popula√ß√µes tem uma rela√ß√£o positiva com a temperatura das localidades. Assim, popula√ß√µes de <em>D. minutus</em> em localidades mais quentes apresentam maior CRC do que as popula√ß√µes em localidades mais frias. Podemos tamb√©m usar os coeficientes da regress√£o para entender como a mudan√ßa na vari√°vel preditora (temperatura) afeta o tamanho corporal m√©dio dos anuros. Neste caso, ao usar o comando <code>coef(modelo_regressao)</code>, obtemos os valores 16,23 e 0,27, respectivamente os valores do intercepto (Œ≤<sub>0</sub>) e da temperatura (Œ≤<sub>1</sub>). O valor de 0,27 indica que a mudan√ßa de uma unidade na vari√°vel preditora (neste caso, graus), aumenta em 0,27 unidades (neste caso, cent√≠metros) da vari√°vel dependente. Por exemplo, o modelo indica que o tamanho m√©dio dos indiv√≠duos em locais com temperatura de 16¬∫ C √© de 20,55 cm, ao passo que em locais com 26¬∫ C o tamanho aumenta para 23,25 cm, o que representa um ganho de 13%.</p>
</div>
<div id="regress√£o-linear-m√∫ltipla" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Regress√£o Linear M√∫ltipla<a class="anchor" aria-label="anchor" href="#regress%C3%A3o-linear-m%C3%BAltipla"><i class="fas fa-link"></i></a>
</h2>
<p>A regress√£o linear m√∫ltipla √© uma extens√£o da regress√£o linear simples. Ela √© usada quando queremos determinar o valor da vari√°vel resposta (Y) com base nos valores de duas ou mais vari√°veis preditoras (X<sub>1</sub>, X<sub>2</sub>, X<sub><em>n</em></sub>).</p>
<p><span class="math display">\[Y = \beta_0 + \beta_{1}X_1 + \beta_{n}X_n + \epsilon_i\]</span></p>
<p>Onde:</p>
<ul>
<li>
<span class="math inline">\(\beta_0\)</span> = intercepto (<em>intercept</em>) que representa o valor da fun√ß√£o quando X = 0</li>
<li>
<span class="math inline">\(\beta_{n}\)</span> = inclina√ß√£o (<em>slope</em>) que mede a mudan√ßa na vari√°vel Y para cada mudan√ßa de unidade das vari√°veis X<sub>n</sub>
</li>
<li>
<span class="math inline">\(\epsilon_{1}\)</span> = erro aleat√≥rio referente a vari√°vel Y que n√£o pode ser explicado pelas vari√°veis preditoras</li>
</ul>
<p><strong>Premissas da Regress√£o Linear M√∫ltipla</strong></p>
<ul>
<li>As amostras devem ser independentes</li>
<li>As unidades amostrais s√£o selecionadas aleatoriamente</li>
<li>Distribui√ß√£o normal (gaussiana) dos res√≠duos</li>
<li>Homogeneidade da vari√¢ncia dos res√≠duos</li>
</ul>
<p><strong>Exemplo pr√°tico 1 - Regress√£o Linear M√∫ltipla</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Utilizaremos o mesmo exemplo da regress√£o linear simples. Contudo, al√©m do gradiente de temperatura m√©dia anual (¬∞C), incluiremos o gradiente de precipita√ß√£o anual (mm) como outra vari√°vel preditora do tamanho m√©dio do comprimento rostro-cloacal (CRC em mm) de popula√ß√µes de <em>Dendropsophus minutus</em> (Anura:Hylidae) amostradas em 109 localidades no Brasil <span class="citation">(<a href="refer%C3%AAncias.html#ref-boaratti2015" role="doc-biblioref">Boaratti and Da Silva 2015</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>O tamanho do CRC das popula√ß√µes de <em>D. minutus</em> √© influenciado pela temperatura e precipita√ß√£o das localidades onde os indiv√≠duos ocorrem?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Os CRC das popula√ß√µes ser√£o menores em localidades com clima quente e chuvoso do que em localidades com clima frio e seco</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>data frame com as popula√ß√µes (unidade amostral) nas linhas e CRC (vari√°vel resposta) m√©dio (mm) e temperatura e precipita√ß√£o (vari√°veis preditoras) como colunas</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Verificar se o seu data frame est√° com as unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunas</li>
</ul>
<p><strong>An√°lise</strong></p>
<p>Olhando os dados usando a fun√ß√£o <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cabe√ßalho dos dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dados_regressao_mul</span><span class="op">)</span> 
<span class="co">#&gt;      Municipio      CRC Temperatura Precipitacao</span>
<span class="co">#&gt; 1     Acorizal 22.98816    24.13000       1228.2</span>
<span class="co">#&gt; 2  Alpinopolis 22.91788    20.09417       1487.6</span>
<span class="co">#&gt; 3 Alto_Paraiso 21.97629    21.86167       1812.4</span>
<span class="co">#&gt; 4    Americana 23.32453    20.28333       1266.2</span>
<span class="co">#&gt; 5      Apiacas 22.83651    25.47333       2154.0</span>
<span class="co">#&gt; 6  Arianopolis 20.86989    20.12167       1269.2</span></code></pre></div>
<p>C√≥digos para ajustar o modelo de regress√£o m√∫ltipla.</p>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Regress√£o m√∫ltipla</span>
<span class="va">modelo_regressao_mul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">CRC</span> <span class="op">~</span> <span class="va">Temperatura</span> <span class="op">+</span> <span class="va">Precipitacao</span>,
                           data <span class="op">=</span> <span class="va">dados_regressao_mul</span><span class="op">)</span></code></pre></div>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
Multicolinearidade ocorre quando as vari√°veis preditoras s√£o correlacionadas. Essa correla√ß√£o √© um problema porque as vari√°veis preditoras deveriam ser independentes. Al√©m disso, a multicolinearidade aumentam o erro padr√£o associado aos coeficientes produzindo resultados menos confi√°veis. O Fator de Infla√ß√£o da Vari√¢ncia (VIF) √© um teste que quantifica quanto do erro padr√£o dos coeficientes estimados est√£o inflados devido √† multicolinearidade. Na regress√£o m√∫ltipla, cada vari√°vel preditora tem um valor de VIF. Alguns autores consideram valores de VIF acima de 10 como fortemente correlacionadas, outros mais conservadores consideram o valor de 5, 3 ou at√© mesmo 2. Mais detalhes em <span class="citation">A. F. Zuur, Ieno, and Elphick (<a href="refer%C3%AAncias.html#ref-zuur_protocol_2009" role="doc-biblioref">2010</a>)</span> e <span class="citation">Dormann et al. (<a href="refer%C3%AAncias.html#ref-dormann_collinearity_2013" role="doc-biblioref">2013</a>)</span>.</p>
</div>
<p>Vamos analisar se as vari√°veis apresentam multicolinearidade.</p>
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Multicolinearidade</span>
<span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">modelo_regressao_mul</span><span class="op">)</span>
<span class="co">#&gt;  Temperatura Precipitacao </span>
<span class="co">#&gt;     1.041265     1.041265</span></code></pre></div>
<p>Os valores s√£o menores que 3, indicando que n√£o h√° multicolinearidade.</p>
<p>Agora vamos verificar as premissas de normalidade e homogeneidade das vari√¢ncias (Figura <a href="cap7.html#fig:fig-lm-multi-pre">7.11</a>).</p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Normalidade e homogeneidade das vari√¢ncias</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">modelo_regressao_mul</span> , type <span class="op">=</span> <span class="st">"diag"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-lm-multi-pre"></span>
<img src="livro_files/figure-html/fig-lm-multi-pre-1.png" alt="Gr√°ficos mostrando as premissas da regress√£o linear m√∫ltipla." width="100%" height="100%"><p class="caption">
Figura 7.11: Gr√°ficos mostrando as premissas da regress√£o linear m√∫ltipla.
</p>
</div>
<p>Os res√≠duos apresentam distribui√ß√£o normal e vari√¢ncias homog√™neas.</p>
<p>Podemos ver os resultados da an√°lise.</p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## regress√£o m√∫ltipla</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelo_regressao_mul</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = CRC ~ Temperatura + Precipitacao, data = dados_regressao_mul)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -3.4351 -0.8026  0.0140  0.9420  3.4300 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)  16.7162571  1.0108674  16.537  &lt; 2e-16 ***</span>
<span class="co">#&gt; Temperatura   0.2787445  0.0439601   6.341 5.71e-09 ***</span>
<span class="co">#&gt; Precipitacao -0.0004270  0.0003852  -1.108     0.27    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 1.44 on 106 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.2751, Adjusted R-squared:  0.2614 </span>
<span class="co">#&gt; F-statistic: 20.12 on 2 and 106 DF,  p-value: 3.927e-08</span></code></pre></div>
<p>Percebam que a temperatura tem uma rela√ß√£o significativa e positiva com o tamanho do CRC das popula√ß√µes (P &lt; 0.001), enquanto a precipita√ß√£o n√£o apresenta rela√ß√£o com o CRC (P = 0.27). Neste caso, √© interessante saber se um modelo mais simples (e.g.¬†contendo apenas temperatura) explicaria a distribui√ß√£o t√£o bem ou melhor do que este modelo mais complexo considerando duas vari√°veis (temperatura e precipita√ß√£o).</p>
<p>Para isso, podemos utilizar a <em>Likelihood-ratio test (LRT)</em> para comparar os modelos. A LRT compara dois modelos aninhados, testando se os par√¢metros do modelo mais complexo diferem significativamente do modelo mais simples. Em outras palavras, ele testa se h√° necessidade de se incluir uma vari√°vel extra no modelo para explicar os dados.</p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Criando os modelos aninhados</span>
<span class="va">modelo_regressao_mul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">CRC</span> <span class="op">~</span> <span class="va">Temperatura</span> <span class="op">+</span> <span class="va">Precipitacao</span>, 
                           data <span class="op">=</span> <span class="va">dados_regressao_mul</span><span class="op">)</span>
<span class="va">modelo_regressao</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">CRC</span> <span class="op">~</span> <span class="va">Temperatura</span>, data <span class="op">=</span> <span class="va">dados_regressao_mul</span><span class="op">)</span>

<span class="co">## Likelihood-ratio test (LRT)</span>
<span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">modelo_regressao_mul</span>, <span class="va">modelo_regressao</span><span class="op">)</span>
<span class="co">#&gt; Likelihood ratio test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: CRC ~ Temperatura + Precipitacao</span>
<span class="co">#&gt; Model 2: CRC ~ Temperatura</span>
<span class="co">#&gt;   #Df  LogLik Df  Chisq Pr(&gt;Chisq)</span>
<span class="co">#&gt; 1   4 -192.93                     </span>
<span class="co">#&gt; 2   3 -193.55 -1 1.2558     0.2624</span></code></pre></div>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
A Hip√≥tese Nula (H<sub>0</sub>) do teste <em>Likelihood-ratio test (LRT)</em> √© de que o modelo mais simples √© o melhor.</p>
<ul>
<li>Valor de p &lt; 0.05 rejeita a hip√≥tese nula e o modelo mais complexo √© o melhor</li>
<li>Valor de p &gt; 0.05 n√£o rejeita a hip√≥tese nula e o modelo mais simples √© o melhor</li>
</ul>
</div>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Comparando com o modelo somente com o intercepto</span>
<span class="co"># Criando um modelo sem vari√°veis, s√≥ o intercepto.</span>
<span class="va">modelo_intercepto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">CRC</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">dados_regressao_mul</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">modelo_regressao</span>, <span class="va">modelo_intercepto</span><span class="op">)</span>
<span class="co">#&gt; Likelihood ratio test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: CRC ~ Temperatura</span>
<span class="co">#&gt; Model 2: CRC ~ 1</span>
<span class="co">#&gt;   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    </span>
<span class="co">#&gt; 1   3 -193.55                         </span>
<span class="co">#&gt; 2   2 -210.46 -1 33.815  6.061e-09 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Neste exemplo, a precipita√ß√£o n√£o est√° associada com a varia√ß√£o no tamanho do CRC das popula√ß√µes de <em>D. minutus</em>. Por outro lado, a temperatura explicou 26% da varia√ß√£o do tamanho do CRC das popula√ß√µes.</p>
</div>
<div id="an√°lises-de-vari√¢ncia-anova" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> An√°lises de Vari√¢ncia (ANOVA)<a class="anchor" aria-label="anchor" href="#an%C3%A1lises-de-vari%C3%A2ncia-anova"><i class="fas fa-link"></i></a>
</h2>
<p>ANOVA refere-se a uma variedade de delineamentos experimentais nos quais a vari√°vel preditora √© categ√≥rica e a vari√°vel resposta √© cont√≠nua <span class="citation">(<a href="refer%C3%AAncias.html#ref-gotelli_primer_2012" role="doc-biblioref">Gotelli and Ellison 2012</a>)</span>. Exemplos desses delineamentos experimentais s√£o: ANOVA de um fator, ANOVA de dois fatores, ANOVA em blocos aleatorizados, ANOVA de medidas repetidas e ANOVA <em>split-splot</em>. De forma geral, a ANOVA √© um teste estat√≠stico usado para comparar a m√©dia entre grupos amostrados independentemente. Para isso, o teste leva em conta, al√©m das m√©dias dos grupos, a varia√ß√£o dos dados dentro e entre os grupos. Neste cap√≠tulo, iremos demonstrar os c√≥digos para alguns dos principais delineamentos experimentais.</p>
<p><strong>Premissas da ANOVA</strong></p>
<ul>
<li>As amostras devem ser independentes</li>
<li>As unidades amostrais s√£o selecionadas aleatoriamente</li>
<li>Distribui√ß√£o normal (gaussiana) dos res√≠duos</li>
<li>Homogeneidade da vari√¢ncia</li>
</ul>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
ANOVA de medidas repetidas e ANOVA <em>split-plot</em> s√£o an√°lises com desenhos experimentais que apresentam depend√™ncia entre as amostras, mas controlam essa depend√™ncia nas suas formula√ß√µes matem√°ticas.</p>
</div>
<div id="anova-de-um-fator" class="section level3" number="7.6.1">
<h3>
<span class="header-section-number">7.6.1</span> ANOVA de um fator<a class="anchor" aria-label="anchor" href="#anova-de-um-fator"><i class="fas fa-link"></i></a>
</h3>
<p>Este teste considera delineamentos experimentais com apenas um fator (ou tratamento) que pode ser composto por tr√™s ou mais grupos (ou n√≠veis).</p>
<p><strong>Exemplo pr√°tico 1 - Anova de um fator</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Neste exemplo hipot√©tico, avaliaremos se o adubo X-2020 disponibilizado recentemente no mercado melhora o crescimento dos indiv√≠duos de <em>Coffea arabica</em> como divulgado pela empresa respons√°vel pela venda do produto. Para isso, foi realizado um experimento com indiv√≠duos de <em>C. arabica</em> cultivados em tr√™s grupos: i) grupo controle onde os indiv√≠duos n√£o receberam aduba√ß√£o, ii) grupo onde os indiv√≠duos receberam a adi√ß√£o do adubo tradicional mais utilizado pelos produtores de <em>C. arabica</em>, e iii) grupo onde os indiv√≠duos receberam a adi√ß√£o do adubo X-2020.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>O crescimento dos indiv√≠duos de <em>C. arabica</em> √© melhorado pela adi√ß√£o do adubo X-2020?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>O crescimento dos indiv√≠duos de <em>C. arabica</em> ser√° maior no grupo que recebeu o adubo X-2020</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Data frame com as plantas (unidade amostral) nas linhas e o crescimento dos indiv√≠duos de <em>C. arabica</em> (vari√°vel resposta) e os tratamentos (vari√°vel preditora) nas colunas</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Verificar se o seu data frame est√° com as unidades amostrais nas linhas e vari√°vel preditora e resposta nas colunas</li>
</ul>
<p><strong>An√°lise</strong></p>
<p>Olhando os dados e criando o modelo para Anova de um fator.</p>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cabe√ßalho dos dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dados_anova_simples</span><span class="op">)</span> 
<span class="co">#&gt;   Crescimento Tratamento</span>
<span class="co">#&gt; 1       7.190   Controle</span>
<span class="co">#&gt; 2       6.758   Controle</span>
<span class="co">#&gt; 3       6.101   Controle</span>
<span class="co">#&gt; 4       4.758   Controle</span>
<span class="co">#&gt; 5       6.542   Controle</span>
<span class="co">#&gt; 6       7.667   Controle</span>

<span class="co">## An√°lise ANOVA de um fator</span>
<span class="va">Modelo_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Crescimento</span> <span class="op">~</span> <span class="va">Tratamento</span>, data <span class="op">=</span> <span class="va">dados_anova_simples</span><span class="op">)</span> </code></pre></div>
<p>Vamos verificar a normalidade dos res√≠duos e homogeneidade da vari√¢ncia usando os testes de Shapiro-Wilk e Bartlett, respectivamente.</p>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Normalidade </span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">Modelo_anova</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Shapiro-Wilk normality test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  residuals(Modelo_anova)</span>
<span class="co">#&gt; W = 0.94676, p-value = 0.08266</span>

<span class="co">## Homogeneidade da vari√¢ncia</span>
<span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">Crescimento</span> <span class="op">~</span> <span class="va">Tratamento</span>, data <span class="op">=</span> <span class="va">dados_anova_simples</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Bartlett test of homogeneity of variances</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  Crescimento by Tratamento</span>
<span class="co">#&gt; Bartlett's K-squared = 0.61835, df = 2, p-value = 0.7341</span></code></pre></div>
<p>Os res√≠duos apresentam distribui√ß√£o normal e homogeneidade de vari√¢ncia.</p>
<p>Vamos ver os resultados da an√°lise.</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Resultados da anova</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">Modelo_anova</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: Crescimento</span>
<span class="co">#&gt;            Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span>
<span class="co">#&gt; Tratamento  2 340.32 170.160  77.989 3.124e-13 ***</span>
<span class="co">#&gt; Residuals  33  72.00   2.182                      </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Percebam que o resultado da ANOVA (Pr(&gt;F) &lt; 0.001) indica que devemos rejeitar a hip√≥tese nula que n√£o h√° diferen√ßa entre as m√©dias dos grupos. Contudo, os resultados n√£o mostram quais s√£o os grupos que apresentam diferen√ßas. Para isso, temos que realizar testes de compara√ß√µes m√∫ltiplas <em>post-hoc</em> para detectar os grupos que apresentam diferen√ßas significativas entre as m√©dias.</p>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
Os testes <em>post-hoc</em> s√≥ devem ser utilizados quando rejeitamos a hip√≥tese nula (P &lt; 0.05) no teste da ANOVA.</p>
</div>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Diferen√ßas entre os tratamentos</span>
<span class="co"># Teste de Tuckey's honest significant difference</span>
<span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">Modelo_anova</span><span class="op">)</span>
<span class="co">#&gt;   Tukey multiple comparisons of means</span>
<span class="co">#&gt;     95% family-wise confidence level</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fit: aov(formula = Crescimento ~ Tratamento, data = dados_anova_simples)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Tratamento</span>
<span class="co">#&gt;                                       diff       lwr       upr     p adj</span>
<span class="co">#&gt; Adubo_X-2020-Adubo_Tradicional  0.04991667 -1.429784  1.529617 0.9962299</span>
<span class="co">#&gt; Controle-Adubo_Tradicional     -6.49716667 -7.976867 -5.017466 0.0000000</span>
<span class="co">#&gt; Controle-Adubo_X-2020          -6.54708333 -8.026784 -5.067383 0.0000000</span></code></pre></div>
<p>Visualizar os resultados em gr√°fico (Figura <a href="cap7.html#fig:fig-anova-um-fator">7.12</a>).</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Reorganizando a ordem que os grupos ir√£o aparecer no gr√°fico</span>
<span class="va">dados_anova_simples</span><span class="op">$</span><span class="va">Tratamento</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dados_anova_simples</span><span class="op">$</span><span class="va">Tratamento</span>,
                                         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Controle"</span>, <span class="st">"Adubo_Tradicional"</span>, <span class="st">"Adubo_X-2020"</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dados_anova_simples</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tratamento</span>, y <span class="op">=</span> <span class="va">Crescimento</span>, color <span class="op">=</span> <span class="va">Tratamento</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"darkorchid"</span>, <span class="st">"cyan4"</span><span class="op">)</span>, 
                 color <span class="op">=</span> <span class="st">"black"</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">16</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>, 
                cex <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"darkorchid"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">12</span>, label <span class="op">=</span> <span class="st">"ab"</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">17</span>, label <span class="op">=</span> <span class="st">"a"</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">17</span>, label <span class="op">=</span> <span class="st">"b"</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sem adubo"</span>, <span class="st">"Tradicional"</span>, <span class="st">"X-2020"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Aduba√ß√£o"</span>, y <span class="op">=</span> <span class="st">"Crescimento Coffea arabica (cm)"</span>, size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> </code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-anova-um-fator"></span>
<img src="livro_files/figure-html/fig-anova-um-fator-1.png" alt="Gr√°fico de caixa mostrando o resultado da ANOVA de um fator." width="100%" height="100%"><p class="caption">
Figura 7.12: Gr√°fico de caixa mostrando o resultado da ANOVA de um fator.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Neste exemplo, os indiv√≠duos de <em>C. arabica</em> que receberam aduba√ß√£o (tradicional e X-2020) apresentaram maior crescimento do que os indiv√≠duos que n√£o receberam aduba√ß√£o. Contudo, diferente do que foi divulgado pela empresa, o adubo X-2020 n√£o apresentou melhor desempenho que o adubo tradicional j√° utilizado pelos produtores.</p>
</div>
<div id="anova-com-dois-fatores-ou-anova-fatorial" class="section level3" number="7.6.2">
<h3>
<span class="header-section-number">7.6.2</span> ANOVA com dois fatores ou ANOVA fatorial<a class="anchor" aria-label="anchor" href="#anova-com-dois-fatores-ou-anova-fatorial"><i class="fas fa-link"></i></a>
</h3>
<p>Este teste considera delineamentos amostrais com dois fatores (ou tratamentos) que podem ser compostos por dois ou mais grupos (ou n√≠veis). Esta an√°lise tem uma vantagem, pois permite avaliar o efeito da intera√ß√£o entre os fatores na vari√°vel resposta. Quando a intera√ß√£o est√° presente, o impacto de um fator depende do n√≠vel (ou grupo) do outro fator.</p>
<p><strong>Exemplo pr√°tico 1 - ANOVA com dois fatores</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Neste exemplo hipot√©tico, avaliaremos se o tempo que o corpo leva para eliminar uma droga utilizada em exames de resson√¢ncia magn√©tica est√° relacionado com o sistema XY de determina√ß√£o do sexo e/ou com a idade dos pacientes. Para isso, foi realizado um experimento com 40 pacientes distribu√≠dos da seguinte maneira: i) 10 indiv√≠duos XX - jovens, ii) 10 indiv√≠duos XX - idosas, iii) 10 indiv√≠duos XY - jovens, e iv) 10 indiv√≠duos XY - idosos.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>O tempo de elimina√ß√£o da droga √© dependente do sistema XY de determina√ß√£o do sexo e idade dos pacientes?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>O tempo de elimina√ß√£o da droga vai ser mais r√°pido nos pacientes XX e jovens</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>data frame com os pacientes (unidade amostral) nas linhas e o tempo de elimina√ß√£o da droga (vari√°vel resposta) e os tratamentos sexo e idade dos pacientes (vari√°veis preditoras) nas colunas</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Verificar se o seu data frame est√° com as unidades amostrais nas linhas e as vari√°veis preditoras e respostas nas colunas</li>
</ul>
<p><strong>An√°lise</strong></p>
<p>Verificando os dados usando a fun√ß√£o <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cabe√ßalho dos dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dados_dois_fatores</span><span class="op">)</span> 
<span class="co">#&gt;    Tempo Pessoas Idade</span>
<span class="co">#&gt; 1 18.952      XX Jovem</span>
<span class="co">#&gt; 2 16.513      XX Jovem</span>
<span class="co">#&gt; 3 17.981      XX Jovem</span>
<span class="co">#&gt; 4 21.371      XX Jovem</span>
<span class="co">#&gt; 5 14.470      XX Jovem</span>
<span class="co">#&gt; 6 19.130      XX Jovem</span></code></pre></div>
<p>C√≥digos para realizar a ANOVA com dois fatores.</p>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## An√°lise Anova de dois fatores </span>
<span class="co"># A intera√ß√£o entre os fatores √© representada por *</span>
<span class="va">Modelo1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Tempo</span> <span class="op">~</span> <span class="va">Pessoas</span> <span class="op">*</span> <span class="va">Idade</span>, data <span class="op">=</span> <span class="va">dados_dois_fatores</span><span class="op">)</span> 

<span class="co"># Olhando os resultados</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">Modelo1</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: Tempo</span>
<span class="co">#&gt;               Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    </span>
<span class="co">#&gt; Pessoas        1  716.72  716.72 178.8538  1.56e-15 ***</span>
<span class="co">#&gt; Idade          1 1663.73 1663.73 415.1724 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; Pessoas:Idade  1    4.77    4.77   1.1903    0.2825    </span>
<span class="co">#&gt; Residuals     36  144.26    4.01                       </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Percebam que a intera√ß√£o n√£o apresenta um efeito significativo (P &gt; 0.05). Assim, iremos retirar a intera√ß√£o e verificar, usando <em>Likelihood-ratio test</em>, se o modelo mais simples √© melhor.</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Criando modelo sem intera√ß√£o.</span>
<span class="va">Modelo2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Tempo</span> <span class="op">~</span> <span class="va">Pessoas</span> <span class="op">+</span> <span class="va">Idade</span>, data <span class="op">=</span> <span class="va">dados_dois_fatores</span><span class="op">)</span> 

<span class="co">## LRT</span>
<span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">Modelo1</span>, <span class="va">Modelo2</span><span class="op">)</span>
<span class="co">#&gt; Likelihood ratio test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: Tempo ~ Pessoas * Idade</span>
<span class="co">#&gt; Model 2: Tempo ~ Pessoas + Idade</span>
<span class="co">#&gt;   #Df  LogLik Df  Chisq Pr(&gt;Chisq)</span>
<span class="co">#&gt; 1   5 -82.413                     </span>
<span class="co">#&gt; 2   4 -83.063 -1 1.3012      0.254</span></code></pre></div>
<p>Analisando o resultado do teste (P &gt; 0.05), a intera√ß√£o n√£o √© importante. Ent√£o podemos seguir com o modelo mais simples. Vamos verificar a normalidade e homogeneidade da vari√¢ncia (Figura <a href="cap7.html#fig:fig-lm-anova-fat-pre">7.13</a>).</p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Verificando as premissas do teste.</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">Modelo2</span>, type <span class="op">=</span> <span class="st">"diag"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-lm-anova-fat-pre"></span>
<img src="livro_files/figure-html/fig-lm-anova-fat-pre-1.png" alt="Gr√°ficos mostrando as premissas da ANOVA fatorial." width="100%" height="100%"><p class="caption">
Figura 7.13: Gr√°ficos mostrando as premissas da ANOVA fatorial.
</p>
</div>
<p>Dois pontos est√£o fugindo da reta e chamam aten√ß√£o sobre a normalidade da distribui√ß√£o dos res√≠duos. A homogeneidade da vari√¢ncia est√° adequada. Por enquanto, vamos seguir a an√°lise, mas veja o Cap√≠tulo <a href="cap8.html#cap8">8</a> para entender como lidar com modelos que os res√≠duos n√£o apresentam distribui√ß√£o normal.</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Resultados do modelo</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">Modelo2</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: Tempo</span>
<span class="co">#&gt;           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span>
<span class="co">#&gt; Pessoas    1  716.72  716.72  177.94 1.041e-15 ***</span>
<span class="co">#&gt; Idade      1 1663.73 1663.73  413.05 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; Residuals 37  149.03    4.03                      </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Percebam que o resultado da ANOVA (Pr(&gt;F) &lt; 0.001) indica que devemos rejeitar a hip√≥tese nula de que n√£o h√° diferen√ßa entre as m√©dias do sistema XY e idade dos pacientes. Neste caso, n√£o precisamos realizar testes de compara√ß√µes m√∫ltiplas <em>post-hoc</em> porque os fatores apresentam apenas dois n√≠veis. Contudo, se no seu delineamento experimental um dos fatores apresentar tr√™s ou mais n√≠veis, voc√™ dever√° utilizar os testes de compara√ß√µes <em>post-hoc</em> para determinar as diferen√ßas entre os grupos.</p>
<p>Vamos visualizar os resultados em gr√°fico (Figura <a href="cap7.html#fig:fig-anova-fatorial">7.14</a>).</p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dados_dois_fatores_interacao</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Tempo</span>, x <span class="op">=</span> <span class="va">Pessoas</span>, color <span class="op">=</span> <span class="va">Idade</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span><span class="st">"point"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">Idade</span>, x <span class="op">=</span> <span class="va">Pessoas</span><span class="op">)</span>,
                 color <span class="op">=</span> <span class="st">"black"</span>,
                 position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span>, size  <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_link.html">geom_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.8</span>, y <span class="op">=</span> <span class="fl">31</span>, xend <span class="op">=</span> <span class="fl">1.8</span>, yend <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"darkorange"</span>, 
              lwd  <span class="op">=</span> <span class="fl">1.3</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_link.html">geom_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1.2</span>, y <span class="op">=</span> <span class="fl">19</span>, xend <span class="op">=</span> <span class="fl">2.2</span>, yend <span class="op">=</span> <span class="fl">26.5</span><span class="op">)</span>, 
              color <span class="op">=</span> <span class="st">"cyan4"</span>, lwd  <span class="op">=</span> <span class="fl">1.3</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sistema XY de determina√ß√£o do sexo"</span>, 
         y <span class="op">=</span> <span class="st">"Tempo (horas) para eliminar a droga"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"cyan4"</span>, <span class="st">"darkorange"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>  </code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-anova-fatorial"></span>
<img src="livro_files/figure-html/fig-anova-fatorial-1.png" alt="Gr√°fico de caixa mostrando o resultado da ANOVA fatorial." width="100%" height="100%"><p class="caption">
Figura 7.14: Gr√°fico de caixa mostrando o resultado da ANOVA fatorial.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Neste exemplo, o sistema XY de determina√ß√£o do sexo e a idade dos pacientes t√™m um efeito no tempo de elimina√ß√£o da droga do organismo. Os pacientes XX e jovens apresentaram elimina√ß√£o mais r√°pida da droga do que pacientes XY e idosos.</p>
<p><strong>Exemplo pr√°tico 2 - ANOVA com dois fatores com efeito da intera√ß√£o</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Neste exemplo, novamente hipot√©tico, usaremos os mesmos dados do exemplo anterior. Entretanto, alteramos os dados para que agora a intera√ß√£o seja significativa.</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Olhando os dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dados_dois_fatores_interacao2</span><span class="op">)</span>
<span class="co">#&gt;    Tempo Pessoas Idade</span>
<span class="co">#&gt; 1 18.952      XX Jovem</span>
<span class="co">#&gt; 2 16.513      XX Jovem</span>
<span class="co">#&gt; 3 17.981      XX Jovem</span>
<span class="co">#&gt; 4 21.371      XX Jovem</span>
<span class="co">#&gt; 5 14.470      XX Jovem</span>
<span class="co">#&gt; 6 19.130      XX Jovem</span>

<span class="co">## An√°lise anova de dois fatores </span>
<span class="va">Modelo_interacao2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Tempo</span> <span class="op">~</span> <span class="va">Pessoas</span> <span class="op">*</span> <span class="va">Idade</span>, 
                         data <span class="op">=</span> <span class="va">dados_dois_fatores_interacao2</span><span class="op">)</span>

<span class="co">## Olhando os resultados</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">Modelo_interacao2</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: Tempo</span>
<span class="co">#&gt;               Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    </span>
<span class="co">#&gt; Pessoas        1  716.72  716.72 178.8538  1.56e-15 ***</span>
<span class="co">#&gt; Idade          1    4.77    4.77   1.1903    0.2825    </span>
<span class="co">#&gt; Pessoas:Idade  1 1663.73 1663.73 415.1724 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; Residuals     36  144.26    4.01                       </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Percebam que a intera√ß√£o √© significativa (P &lt; 0.05), mas a idade n√£o √© significativa. Nossa interpreta√ß√£o precisa ser baseada na intera√ß√£o entre os fatores. Vamos visualizar os resultados em gr√°fico (Figura <a href="cap7.html#fig:fig-anova-fatorial-int">7.15</a>).</p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dados_dois_fatores_interacao2</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Tempo</span>, x <span class="op">=</span> <span class="va">Pessoas</span>, color <span class="op">=</span> <span class="va">Idade</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span><span class="st">"point"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">Idade</span>, x <span class="op">=</span> <span class="va">Pessoas</span><span class="op">)</span>, 
                 color <span class="op">=</span> <span class="st">"black"</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span>, size  <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_link.html">geom_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.8</span>, y <span class="op">=</span> <span class="fl">31</span>, xend <span class="op">=</span> <span class="fl">1.8</span>, yend <span class="op">=</span> <span class="fl">27</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"darkorange"</span>, 
              lwd  <span class="op">=</span> <span class="fl">1.3</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_link.html">geom_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1.2</span>, y <span class="op">=</span> <span class="fl">19</span>, xend <span class="op">=</span> <span class="fl">2.2</span>, yend <span class="op">=</span> <span class="fl">41</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"cyan4"</span>, 
              lwd  <span class="op">=</span> <span class="fl">1.3</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sistema XY de determina√ß√£o do sexo"</span>, 
         y <span class="op">=</span> <span class="st">"Tempo (horas) para eliminar a droga"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"cyan4"</span>, <span class="st">"darkorange"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-anova-fatorial-int"></span>
<img src="livro_files/figure-html/fig-anova-fatorial-int-1.png" alt="Gr√°fico de caixa mostrando o resultado da ANOVA fatorial com intera√ß√£o." width="100%" height="100%"><p class="caption">
Figura 7.15: Gr√°fico de caixa mostrando o resultado da ANOVA fatorial com intera√ß√£o.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Percebam que as linhas se cruzam. Esse √© um exemplo cl√°ssico de intera√ß√£o. Novamente, para saber a resposta do fator idade (jovem ou idoso), voc√™ precisa saber com qual pessoa (XX ou XY) ele est√° associado. Jovens s√£o mais r√°pidos para eliminarem a droga em pessoas XX, enquanto os idosos s√£o mais r√°pidos para eliminarem a droga nas pessoas XY.</p>
</div>
<div id="anova-em-blocos-aleatorizados" class="section level3" number="7.6.3">
<h3>
<span class="header-section-number">7.6.3</span> ANOVA em blocos aleatorizados<a class="anchor" aria-label="anchor" href="#anova-em-blocos-aleatorizados"><i class="fas fa-link"></i></a>
</h3>
<p>No delineamento experimental com blocos aleatorizados, cada fator √© agrupado em blocos, com r√©plicas de cada n√≠vel do fator representado em cada bloco <span class="citation">(<a href="refer%C3%AAncias.html#ref-gotelli_primer_2012" role="doc-biblioref">Gotelli and Ellison 2012</a>)</span>. O bloco √© uma √°rea ou per√≠odo de tempo dentro do qual as condi√ß√µes ambientais s√£o relativamente homog√™neas. O objetivo do uso dos blocos √© controlar fontes de varia√ß√µes indesejadas na vari√°vel dependente que n√£o s√£o de interesse do pesquisador. Desta maneira, podemos retirar dos res√≠duos os efeitos das varia√ß√µes indesejadas que n√£o s√£o do nosso interesse, e testar com maior poder estat√≠stico os efeitos dos tratamentos de interesse.</p>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
Os blocos devem ser arranjados de forma que as condi√ß√µes ambientais sejam mais similares dentro dos blocos do que entre os blocos.</p>
</div>
<p><strong>Exemplo pr√°tico 1 - ANOVA em blocos aleatorizados</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Neste exemplo, avaliaremos a riqueza de esp√©cies de anuros amostradas em po√ßas artificiais instaladas a diferentes dist√¢ncias de seis fragmentos florestais no sudeste do Brasil <span class="citation">(<a href="refer%C3%AAncias.html#ref-daSilva2011" role="doc-biblioref">da Silva et al. 2012</a>)</span>. Os fragmentos florestais apresentam diferen√ßas entre si que n√£o s√£o do interesse do pesquisador. Por isso, eles foram inclu√≠dos como blocos nas an√°lises. As po√ßas artificiais foram instaladas em todos os fragmentos florestais com base no seguinte delineamento experimental <span class="citation">(<a href="refer%C3%AAncias.html#ref-daSilva2011" role="doc-biblioref">da Silva et al. 2012</a>)</span>: i) quatro po√ßas no interior do fragmento a 100 m de dist√¢ncia da borda do fragmento; ii) quatro po√ßas no interior no fragmento a 50 m de dist√¢ncia da borda do fragmento; iii) quatro po√ßas na borda do fragmento; iv) quatro po√ßas na matriz de pastagem a 50 m de dist√¢ncia da borda do fragmento; e v) quatro po√ßas na matriz de pastagem a 100 m de dist√¢ncia da borda do fragmento. Percebam que todos os tratamentos foram instalados em todos os blocos.</p>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
Os valores da riqueza de esp√©cies foram alterados em rela√ß√£o a publica√ß√£o original <span class="citation">(<a href="refer%C3%AAncias.html#ref-daSilva2011" role="doc-biblioref">da Silva et al. 2012</a>)</span> para deixar o exemplo mais did√°tico.</p>
</div>
<p><strong>Pergunta</strong></p>
<ul>
<li>A dist√¢ncia da po√ßa artificial ao fragmento florestal influencia a riqueza de esp√©cies anuros?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Po√ßas na borda do fragmento florestal apresentar√£o maior riqueza de esp√©cies do que po√ßas distantes da borda</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Data frame com as po√ßas (unidade amostral) nas linhas e a riqueza de esp√©cies (vari√°vel reposta), dist√¢ncia dos fragmentos florestais (vari√°vel preditora categ√≥rica) e fragmentos florestais (blocos) nas colunas</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Verificar se o seu data frame est√° com as unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunas</li>
</ul>
<p><strong>An√°lise</strong></p>
<p>Olhando os dados usando a fun√ß√£o <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cabe√ßalho dos dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dados_bloco</span><span class="op">)</span> 
<span class="co">#&gt;   Riqueza Blocos    Pocas</span>
<span class="co">#&gt; 1      90      A  Int-50m</span>
<span class="co">#&gt; 2      95      A Int-100m</span>
<span class="co">#&gt; 3     107      A    Borda</span>
<span class="co">#&gt; 4      92      A  Mat-50m</span>
<span class="co">#&gt; 5      89      A Mat-100m</span>
<span class="co">#&gt; 6      92      B  Int-50m</span></code></pre></div>
<p>An√°lise da ANOVA em blocos.</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## An√°lise Anova em blocos aleatorizados</span>
<span class="va">model_bloco</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Riqueza</span> <span class="op">~</span> <span class="va">Pocas</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">Error</a></span><span class="op">(</span><span class="va">Blocos</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dados_bloco</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_bloco</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Blocos</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; Residuals  5   1089   217.8               </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Within</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class="co">#&gt; Pocas      4   1504   376.1   2.907 0.0478 *</span>
<span class="co">#&gt; Residuals 20   2588   129.4                 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Lembre-se que nos delineamentos experimentais em bloco, o pesquisador n√£o est√° interessado no efeito do bloco, mas sim em controlar a varia√ß√£o associada a ele.</p>
<p>O que n√£o pode acontecer √© ignorar o efeito do bloco que √© incorporado pelos res√≠duos quando n√£o informado no modelo. Veja abaixo a <strong>forma errada</strong> de analisar delineamento experimental com blocos.</p>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Forma errada de an√°lisar Anova em blocos</span>
<span class="va">modelo_errado</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Riqueza</span> <span class="op">~</span> <span class="va">Pocas</span>, data <span class="op">=</span> <span class="va">dados_bloco</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modelo_errado</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: Riqueza</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value  Pr(&gt;F)  </span>
<span class="co">#&gt; Pocas      4 1504.5  376.12  2.5576 0.06359 .</span>
<span class="co">#&gt; Residuals 25 3676.5  147.06                  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>O resultado da ANOVA (Pr(&gt;F) &lt; 0.001) indica que devemos rejeitar a hip√≥tese nula que n√£o h√° diferen√ßa entre as m√©dias dos grupos. Contudo, os resultados n√£o mostram quais s√£o os grupos que apresentam diferen√ßas. Para isso, temos que realizar testes de compara√ß√µes m√∫ltiplas <em>post-hoc</em> para detectar os grupos que apresentam diferen√ßas significativas entre as m√©dias.</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Teste de Tuckey's honest significant difference</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lsmeans/man/ref.grid.html">lsmeans</a></span><span class="op">(</span><span class="va">model_bloco</span>, <span class="st">"Pocas"</span><span class="op">)</span>, adjust <span class="op">=</span> <span class="st">"tukey"</span><span class="op">)</span>
<span class="co">#&gt;  contrast                estimate   SE df t.ratio p.value</span>
<span class="co">#&gt;  Borda - (Int-100m)        16.000 6.57 20   2.436  0.1463</span>
<span class="co">#&gt;  Borda - (Int-50m)         19.833 6.57 20   3.020  0.0472</span>
<span class="co">#&gt;  Borda - (Mat-100m)        15.833 6.57 20   2.411  0.1531</span>
<span class="co">#&gt;  Borda - (Mat-50m)          8.167 6.57 20   1.244  0.7269</span>
<span class="co">#&gt;  (Int-100m) - (Int-50m)     3.833 6.57 20   0.584  0.9760</span>
<span class="co">#&gt;  (Int-100m) - (Mat-100m)   -0.167 6.57 20  -0.025  1.0000</span>
<span class="co">#&gt;  (Int-100m) - (Mat-50m)    -7.833 6.57 20  -1.193  0.7553</span>
<span class="co">#&gt;  (Int-50m) - (Mat-100m)    -4.000 6.57 20  -0.609  0.9720</span>
<span class="co">#&gt;  (Int-50m) - (Mat-50m)    -11.667 6.57 20  -1.777  0.4135</span>
<span class="co">#&gt;  (Mat-100m) - (Mat-50m)    -7.667 6.57 20  -1.167  0.7692</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; P value adjustment: tukey method for comparing a family of 5 estimates</span></code></pre></div>
<p>Visualizar os resultados em gr√°fico (Figura <a href="cap7.html#fig:fig-anova-blocos">7.16</a>).</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Reordenando a ordem que os grupos ir√£o aparecer no gr√°fico.</span>
<span class="va">dados_bloco</span><span class="op">$</span><span class="va">Pocas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dados_bloco</span><span class="op">$</span><span class="va">Pocas</span>, 
                            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Int-100m"</span>, <span class="st">"Int-50m"</span>, <span class="st">"Borda"</span>, <span class="st">"Mat-50m"</span>, <span class="st">"Mat-100m"</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dados_bloco</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pocas</span>, y <span class="op">=</span> <span class="va">Riqueza</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Po√ßas artificiais"</span>, y <span class="op">=</span> <span class="st">"Riqueza de esp√©cies de anuros"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">16</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"-100m"</span>,<span class="st">"-50m"</span>,<span class="st">"Borda"</span>, <span class="st">"50m"</span>, <span class="st">"100m"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> </code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-anova-blocos"></span>
<img src="livro_files/figure-html/fig-anova-blocos-1.png" alt="Gr√°fico de caixa mostrando o resultado da ANOVA de blocos aleatorizados." width="100%" height="100%"><p class="caption">
Figura 7.16: Gr√°fico de caixa mostrando o resultado da ANOVA de blocos aleatorizados.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Neste exemplo, rejeitamos a hip√≥tese nula de que a dist√¢ncia das po√ßas artificiais at√© as bordas dos fragmentos florestais n√£o influ√™ncia a riqueza de esp√©cies de anuros. As po√ßas artificiais instaladas nas bordas dos fragmentos florestais apresentaram maior riqueza de esp√©cies do que as po√ßas distantes.</p>
</div>
<div id="an√°lise-de-covari√¢ncia-ancova" class="section level3" number="7.6.4">
<h3>
<span class="header-section-number">7.6.4</span> An√°lise de covari√¢ncia (ANCOVA)<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-covari%C3%A2ncia-ancova"><i class="fas fa-link"></i></a>
</h3>
<p>A ANCOVA pode ser compreendida como uma extens√£o da ANOVA com a adi√ß√£o de uma vari√°vel cont√≠nua (covari√°vel) medida em todas as unidades amostrais <span class="citation">(<a href="refer%C3%AAncias.html#ref-gotelli_primer_2012" role="doc-biblioref">Gotelli and Ellison 2012</a>)</span>. A ideia √© que a covari√°vel tamb√©m afete os valores da vari√°vel resposta. N√£o incluir a covari√°vel ir√° fazer com que a varia√ß√£o n√£o explicada pelo modelo se concentre nos res√≠duos. Incluindo a covari√°vel, o tamanho do res√≠duo √© menor e o teste para avaliar as diferen√ßas nos tratamentos, que √© o interesse do pesquisador, ter√° mais poder estat√≠stico.</p>
<p><strong>Exemplo pr√°tico 1 - ANCOVA</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Neste exemplo hipot√©tico, avaliaremos o efeito da herbivoria na biomassa dos frutos de uma esp√©cie de √°rvore na Mata Atl√¢ntica. O delineamento experimental permitiu que alguns indiv√≠duos sofressem herbivoria e outros n√£o. Os pesquisadores tamb√©m mediram o tamanho da raiz dos indiv√≠duos para inseri-la como uma covari√°vel no modelo.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>A herbivoria diminui a biomassa dos frutos?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Os indiv√≠duos que sofreram herbivoria ir√£o produzir frutos com menor biomassa do que os indiv√≠duos sem herbivoria</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>data frame com os indiv√≠duos da esp√©cie de planta (unidade amostral) nas linhas e a biomassa dos frutos (vari√°vel resposta), herbivoria (vari√°vel preditora categ√≥rica) e tamanho da raiz (covari√°vel cont√≠nua) nas colunas</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Verificar se o seu data frame est√° com as unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunas</li>
</ul>
<p><strong>An√°lise</strong></p>
<p>Olhando os dados usando a fun√ß√£o <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Cabe√ßalho dos dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dados_ancova</span><span class="op">)</span> 
<span class="co">#&gt;    Raiz Biomassa Herbivoria</span>
<span class="co">#&gt; 1 6.225    59.77   Sem_herb</span>
<span class="co">#&gt; 2 6.487    60.98   Sem_herb</span>
<span class="co">#&gt; 3 4.919    14.73   Sem_herb</span>
<span class="co">#&gt; 4 5.130    19.28   Sem_herb</span>
<span class="co">#&gt; 5 5.417    34.25   Sem_herb</span>
<span class="co">#&gt; 6 5.359    35.53   Sem_herb</span></code></pre></div>
<p>C√≥digos para o c√°lculo da ANCOVA (Figura <a href="cap7.html#fig:fig-ancova-diag">7.17</a>).</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Ancova</span>
<span class="va">modelo_ancova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Biomassa</span> <span class="op">~</span> <span class="va">Herbivoria</span> <span class="op">*</span> <span class="va">Raiz</span>, data <span class="op">=</span> <span class="va">dados_ancova</span><span class="op">)</span>

<span class="co"># Verificando as premissas da Ancova</span>
<span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">modelo_ancova</span>, type <span class="op">=</span> <span class="st">"diag"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-ancova-diag"></span>
<img src="livro_files/figure-html/fig-ancova-diag-1.png" alt="Gr√°ficos de diagn√≥stico dos res√≠duos da ANCOVA." width="100%" height="100%"><p class="caption">
Figura 7.17: Gr√°ficos de diagn√≥stico dos res√≠duos da ANCOVA.
</p>
</div>
<p>As premissas da ANCOVA est√£o adequadas. Vamos olhar os resultados do modelo.</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Resultados do modelo</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modelo_ancova</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: Biomassa</span>
<span class="co">#&gt;                 Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span>
<span class="co">#&gt; Herbivoria       1  1941.9  1941.9  35.101 8.764e-07 ***</span>
<span class="co">#&gt; Raiz             1 17434.1 17434.1 315.124 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; Herbivoria:Raiz  1   136.7   136.7   2.471    0.1247    </span>
<span class="co">#&gt; Residuals       36  1991.7    55.3                      </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Percebam que o resultado da ANCOVA (Pr(&gt;F) &lt; 0.001) indica que tanto a herbivoria como o tamanho da raiz (covari√°vel) t√™m efeitos significativos na biomassa dos frutos. Contudo, a intera√ß√£o entre as vari√°veis n√£o foi significativa. Vamos usar o <em>Likelihood-ratio test</em> para ver se podemos seguir com um modelo mais simples (sem intera√ß√£o).</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Criando modelo sem intera√ß√£o</span>
<span class="va">modelo_ancova2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Biomassa</span> <span class="op">~</span> <span class="va">Herbivoria</span> <span class="op">+</span> <span class="va">Raiz</span>, data <span class="op">=</span> <span class="va">dados_ancova</span><span class="op">)</span>

<span class="co">## Likelihood-ratio test</span>
<span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">modelo_ancova</span>, <span class="va">modelo_ancova2</span><span class="op">)</span>
<span class="co">#&gt; Likelihood ratio test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: Biomassa ~ Herbivoria * Raiz</span>
<span class="co">#&gt; Model 2: Biomassa ~ Herbivoria + Raiz</span>
<span class="co">#&gt;   #Df  LogLik Df  Chisq Pr(&gt;Chisq)</span>
<span class="co">#&gt; 1   5 -134.91                     </span>
<span class="co">#&gt; 2   4 -136.24 -1 2.6554     0.1032</span></code></pre></div>
<p>A intera√ß√£o n√£o √© importante, pois P &gt; 0.05. Seguiremos com o modelo mais simples.</p>
<p>Vamos fazer a visualizar os resultados em gr√°fico (Figura <a href="cap7.html#fig:fig-ancova">7.18</a>).</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dados_ancova</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Raiz</span>, y <span class="op">=</span> <span class="va">Biomassa</span>, fill <span class="op">=</span> <span class="va">Herbivoria</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Tamanho da raiz (cm)"</span>, y <span class="op">=</span> <span class="st">"Biomassa dos frutos (g)"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"cyan4"</span><span class="op">)</span>,
                      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Com herbivoria"</span>, <span class="st">"Sem herbivoria"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Herbivoria</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"lm"</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-ancova"></span>
<img src="livro_files/figure-html/fig-ancova-1.png" alt="Gr√°fico de caixa mostrando o resultado da ANCOVA." width="100%" height="100%"><p class="caption">
Figura 7.18: Gr√°fico de caixa mostrando o resultado da ANCOVA.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Neste exemplo, o tamanho da raiz (covari√°vel) tem uma rela√ß√£o positiva com a biomassa dos frutos. Quanto maior o tamanho da raiz, maior a biomassa dos frutos. Usando a ANCOVA e controlando o efeito da covari√°vel, percebemos que a herbivoria tamb√©m afeta a biomassa dos frutos. Os indiv√≠duos com o mesmo tamanho de raiz que n√£o sofreram herbivoria produziram frutos com maior biomassa do que os indiv√≠duos com herbivoria.</p>
</div>
</div>
<div id="generalized-least-squares-gls" class="section level2" number="7.7">
<h2>
<span class="header-section-number">7.7</span> Generalized Least Squares (GLS)<a class="anchor" aria-label="anchor" href="#generalized-least-squares-gls"><i class="fas fa-link"></i></a>
</h2>
<p>Em seu artigo cl√°ssico publicado em 1993, Pierre Legendre se pergunta se a autocorrela√ß√£o espacial √© um problema ou um novo paradigma <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_spatial_1993" role="doc-biblioref">Legendre 1993</a>)</span>. Segundo o autor, estudar estruturas espaciais √© tanto uma necessidade, quanto um desafio para pesquisadores da ecologia e conserva√ß√£o que lidam com dados espacialmente distribu√≠dos. Uma vez que todas as vari√°veis tipicamente utilizadas em estudos de biodiversidade (popula√ß√µes, condi√ß√µes clim√°ticas, diversidade) possuem algum tipo de estrutura espacial, √© fundamental compreender os motivos de como incluir esta informa√ß√£o nos modelos anal√≠ticos. De fato, a Primeira Lei da Geografia postula que ‚Äútodas as coisas est√£o relacionadas com todas as outras, por√©m coisas pr√≥ximas est√£o mais relacionadas do que coisas distantes‚Äù. Como resultado, os valores observados em uma localidade (e.g., composi√ß√£o de esp√©cies) ser√£o mais afetados pelo conjunto de esp√©cies que ocorre nas localidades vizinhas e, desse modo, alguns pontos de coleta podem n√£o ser estatisticamente independentes. Como vimos anteriormente, um dos pressupostos dos modelos lineares √© a independ√™ncia das unidades amostrais. Assim, a presen√ßa de autocorrela√ß√£o espacial nos res√≠duos viola este pressuposto e, consequentemente, aumenta a taxa de Erro do Tipo I (rejeitar a hip√≥tese nula quando ela √© verdadeira) nos modelos. Uma das solu√ß√µes para incorporar a depend√™ncia espacial dos res√≠duos √© usar o m√©todo de M√≠nimos Quadrados Generalizados (<em>Generalized Least Squares</em> - GLS). Diferente dos modelos apresentados anteriormente, este m√©todo ajusta explicitamente modelos heterosced√°sticos e com res√≠duos correlacionados <span class="citation">(<a href="refer%C3%AAncias.html#ref-pinheiro_mixed-effects_2000" role="doc-biblioref">Pinheiro and Bates 2000</a>)</span>. Para representar a estrutura espacial (e, assim, a depend√™ncia entre as observa√ß√µes) √© necess√°rio incluir vari√°veis espaciais (geralmente coordenadas geogr√°ficas, i.e., vetores bidimensionais: <em>sensu</em> <span class="citation">Pinheiro and Bates (<a href="refer%C3%AAncias.html#ref-pinheiro_mixed-effects_2000" role="doc-biblioref">2000</a>)</span>) no argumento <code>corStruct</code> na fun√ß√£o <code><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls()</a></code> do pacote <code>nlme</code>. Este modelo basicamente assume que a estrutura de covari√¢ncia √© uma fun√ß√£o da dist√¢ncia entre as localidades <span class="citation">(<a href="refer%C3%AAncias.html#ref-littell2006sas" role="doc-biblioref">Littell et al. 2006</a>)</span>. √â importante ressaltar, todavia, que existem diferentes fun√ß√µes de covari√¢ncia que s√£o discutidas detalhadamente em <span class="citation">Littell et al. (<a href="refer%C3%AAncias.html#ref-littell2006sas" role="doc-biblioref">2006</a>)</span>. Aqui, iremos nos
concentrar nas seguintes fun√ß√µes.</p>
<ul>
<li>
<strong>Esf√©rica</strong>: <code>corSpher(form=\~lat+long)</code>
</li>
<li>
<strong>Exponencial</strong>: <code>corExp(form=\~lat+long)</code>
</li>
<li>
<strong>Gaussiana</strong>: <code>corGaus(form=\~lat+long)</code>
</li>
<li>
<strong>Linear</strong>: <code>corLin(form=\~lat+long)</code>
</li>
<li>
<strong>Raz√£o quadr√°tica</strong>: <code>corRatio(form=\~lat+long)</code>
</li>
</ul>
<p><strong>Exemplo pr√°tico 1 - GLS</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Neste exemplo, utilizamos os dados de riqueza de esp√©cies de √°caros (Oribatidae) em 70 amostras de musgo (g√™nero <em>Sphagnum</em>) <span class="citation">(<a href="refer%C3%AAncias.html#ref-borcard_partialling_1992" role="doc-biblioref">Borcard, Legendre, and Drapeau 1992</a>)</span>. Para cada amostra, al√©m da riqueza de √°caros, os autores registraram a quantidade de √°gua no substrato e as coordenadas geogr√°ficas. Os dados completos est√£o dispon√≠veis no pacote <code>vegan</code>.</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Calcular a riqueza de esp√©cies em cada comunidade</span>
<span class="va">riqueza</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span> 

<span class="co">## Selecionar a vari√°vel ambiental - quantidade de √°gua no substrato</span>
<span class="va">agua</span> <span class="op">&lt;-</span> <span class="va">mite.env</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>

<span class="co">## Criar um data.frame com riqueza, quantidade de √°gua no substrato e coordenadas geogr√°ficas</span>
<span class="va">mite_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">riqueza</span>, <span class="va">agua</span>, <span class="va">coords</span><span class="op">)</span></code></pre></div>
<p><strong>Modelo linear sem incorporar a estrutura espacial</strong></p>
<p>Vamos inicialmente ajustar um modelo sem incorporar a estrutura espacial (Figura <a href="cap7.html#fig:fig-lm-esp-diag">7.19</a>).</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Modelo</span>
<span class="va">linear_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">riqueza</span> <span class="op">~</span> <span class="va">agua</span>, <span class="va">mite_dat</span><span class="op">)</span> 

<span class="co">## Res√≠duos</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">linear_model</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>

<span class="co">## Resultados do modelo</span>
<span class="va">res_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linear_model</span><span class="op">)</span>

<span class="co">## Coeficiente de determina√ß√£o e coeficientes</span>
<span class="va">res_lm</span><span class="op">$</span><span class="va">adj.r.squared</span>
<span class="co">#&gt; [1] 0.4632024</span>
<span class="va">res_lm</span><span class="op">$</span><span class="va">coefficients</span>
<span class="co">#&gt;               Estimate  Std. Error  t value     Pr(&gt;|t|)</span>
<span class="co">#&gt; (Intercept) 24.3040255 1.249094710 19.45731 1.687907e-29</span>
<span class="co">#&gt; agua        -0.0223793 0.002876239 -7.78075 5.481035e-11</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-lm-esp-diag"></span>
<img src="livro_files/figure-html/fig-lm-esp-diag-1.png" alt="Gr√°ficos mostrando as premissas da regress√£o linear simples." width="100%" height="100%"><p class="caption">
Figura 7.19: Gr√°ficos mostrando as premissas da regress√£o linear simples.
</p>
</div>
<p><strong>Acessando a informa√ß√£o espacial com o GLS</strong></p>
<p>Como dito, dependendo da estrutura espacial de suas vari√°veis (dependentes, independentes, covari√°veis), o pressuposto de independ√™ncia dos res√≠duos pode ser afetado e, desse modo, o modelo linear convencional ter√° maior chance de Erro do Tipo I. Abaixo, iremos comparar um modelo GLS sem incorporar estrutura espacial (o que √© exatamente igual ao modelo criado acima <em>Modelo Linear</em>) com diferentes modelos que utilizam explicitamente res√≠duos correlacionados.</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Modelo gls sem estrutura espacial</span>
<span class="va">no_spat_gls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">riqueza</span> <span class="op">~</span> <span class="va">agua</span>, <span class="va">mite_dat</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></code></pre></div>
<p>Uma maneira de identificar se os res√≠duos do modelo linear apresentam estrutura espacial √© fazendo uma figura chamada <strong>variograma</strong>. O variograma possui tr√™s par√¢metros: i) <em>nugget</em>, ii) <em>range</em> e iii) <em>sill</em> <span class="citation">(<a href="refer%C3%AAncias.html#ref-fortin_dale_2005" role="doc-biblioref">Fortin and Dale 2005</a>)</span>. O <em>nugget</em> √© utilizado para quantificar a variabilidade observada nos valores menores (ou seja, em pequenas dist√¢ncias). O <em>range</em>, por sua vez, √© usado para identificar a dist√¢ncia m√°xima em que a autocorrela√ß√£o espacial est√° presente (Figura <a href="cap7.html#fig:fig-variograma">7.20</a>, pontos laranjas). Deste modo, os valores posicionados a partir do <em>range</em> (Figura <a href="cap7.html#fig:fig-variograma">7.20</a>, pontos verdes) representam pontos n√£o correlacionados <span class="citation">(<a href="refer%C3%AAncias.html#ref-fortin_dale_2005" role="doc-biblioref">Fortin and Dale 2005</a>)</span>. A posi√ß√£o limiar que representa claramente a ‚Äúpausa‚Äù no crescimento da curva (<em>range</em>) indica os pontos n√£o correlacionados e representa o <em>sill</em> (Figura <a href="cap7.html#fig:fig-variograma">7.20</a>). No exemplo da Figura <a href="cap7.html#fig:fig-variograma">7.20</a>, o <em>sill</em> √© constante. Por√©m, √© poss√≠vel que os valores de <em>sill</em> n√£o sejam constantes <span class="citation">(<a href="refer%C3%AAncias.html#ref-chiles_1999" role="doc-biblioref">Chiles and Delfiner 1999</a>)</span>. Um exemplo √© o ‚Äúefeito buraco‚Äù que √© caracterizado por um ou mais picos (ou vales) no variograma que correspondem ao n√∫mero de valores negativos na covari√¢ncia. Esses valores sugerem que valores altos podem estar rodeados de valores baixos <span class="citation">(<a href="refer%C3%AAncias.html#ref-chiles_1999" role="doc-biblioref">Chiles and Delfiner 1999</a>)</span>. Por√©m, os detalhamentos desses comportamentos v√£o al√©m do escopo deste livro.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-variograma"></span>
<img src="img/cap07_fig03.png" alt="Variograma representando a semi-vari√¢ncia *y(h)* em fun√ß√£o do intervalor espacial *h*. Cada ponto representa a dist√¢ncia entre localidades e a linha a varia√ß√£o te√≥rica a fun√ß√£o de covari√¢ncia esf√©rica (veja abaixo). Adaptado de: Fortin &amp; Dale [-@fortin_dale_2005]." width="100%" height="100%"><p class="caption">
Figura 7.20: Variograma representando a semi-vari√¢ncia <em>y(h)</em> em fun√ß√£o do intervalor espacial <em>h</em>. Cada ponto representa a dist√¢ncia entre localidades e a linha a varia√ß√£o te√≥rica a fun√ß√£o de covari√¢ncia esf√©rica (veja abaixo). Adaptado de: Fortin &amp; Dale <span class="citation">(<a href="refer%C3%AAncias.html#ref-fortin_dale_2005" role="doc-biblioref">2005</a>)</span>.
</p>
</div>
<p>Abaixo, podemos analisar o variograma para os res√≠duos do modelo GLS ajustado (Figura <a href="cap7.html#fig:fig-variog-dados">7.21</a>).</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Variograma</span>
<span class="va">variog_mod1</span> <span class="op">&lt;-</span> <span class="fu">nlme</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/Variogram.html">Variogram</a></span><span class="op">(</span><span class="va">no_spat_gls</span>, form <span class="op">=</span> <span class="op">~</span><span class="va">lat</span><span class="op">+</span><span class="va">long</span>, 
                               resType <span class="op">=</span> <span class="st">"normalized"</span><span class="op">)</span> 

<span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">variog_mod1</span><span class="op">)</span>

<span class="co">## √çndice I de Moran</span>

<span class="co">## Primeiro precisamos calcular uma matriz de dist√¢ncias geogr√°ficas entre as comunidades</span>
<span class="va">dat_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rdist/man/rdist.html">pdist</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span> <span class="co"># matriz de dist√¢ncia</span>

<span class="fu"><a href="https://rdrr.io/pkg/ape/man/MoranI.html">Moran.I</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mite_dat</span><span class="op">$</span><span class="va">riqueza</span>, w <span class="op">=</span> <span class="va">dat_dist</span><span class="op">)</span>
<span class="co">#&gt; $observed</span>
<span class="co">#&gt; [1] -0.2398147</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $expected</span>
<span class="co">#&gt; [1] -0.01449275</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd</span>
<span class="co">#&gt; [1] 0.009971923</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $p.value</span>
<span class="co">#&gt; [1] 4.783614e-113</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-variog-dados"></span>
<img src="livro_files/figure-html/fig-variog-dados-1.png" alt="Variograma para os res√≠duos do modelo GLS ajustado." width="100%" height="100%"><p class="caption">
Figura 7.21: Variograma para os res√≠duos do modelo GLS ajustado.
</p>
</div>
<p>O primeiro passo √© utilizar diferentes variogramas te√≥ricos para identificar o melhor modelo que representa a estrutura espacial dos seus dados.</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Covari√¢ncia esf√©rica</span>
<span class="va">espher_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">riqueza</span> <span class="op">~</span> <span class="va">agua</span>, <span class="va">mite_dat</span>, 
                    <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corSpher.html">corSpher</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="va">lat</span><span class="op">+</span><span class="va">long</span>, nugget <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Covari√¢ncia exponencial</span>
<span class="va">expon_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">riqueza</span> <span class="op">~</span> <span class="va">agua</span>, <span class="va">mite_dat</span>, 
                   <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corExp.html">corExp</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="va">lat</span><span class="op">+</span><span class="va">long</span>, nugget <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Covari√¢ncia Gaussiana</span>
<span class="va">gauss_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">riqueza</span> <span class="op">~</span> <span class="va">agua</span>, <span class="va">mite_dat</span>, 
                   <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corGaus.html">corGaus</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="va">lat</span><span class="op">+</span><span class="va">long</span>, nugget <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Covari√¢ncia linear</span>
<span class="va">cor_linear_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">riqueza</span> <span class="op">~</span> <span class="va">agua</span>, <span class="va">mite_dat</span>, 
                        <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corLin.html">corLin</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="va">lat</span><span class="op">+</span><span class="va">long</span>, nugget <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Covari√¢ncia raz√£o quadr√°tica</span>
<span class="va">ratio_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">riqueza</span> <span class="op">~</span> <span class="va">agua</span>, <span class="va">mite_dat</span>, 
                   <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corRatio.html">corRatio</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="va">lat</span><span class="op">+</span><span class="va">long</span>, nugget <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Agora, depois de ajustar o modelo GLS com os diferentes variogramas √© necess√°rio comparar os modelos para escolher o mais ‚Äúprov√°vel‚Äù, utilizando a sele√ß√£o de modelos pelo <strong>Crit√©rio de Sele√ß√£o de Akaike (AIC)</strong> <span class="citation">(<a href="refer%C3%AAncias.html#ref-chiles_1999" role="doc-biblioref">Chiles and Delfiner 1999</a>; <a href="refer%C3%AAncias.html#ref-burnham2002" role="doc-biblioref">K. A. Burnham and Anderson 2002</a>; <a href="refer%C3%AAncias.html#ref-fortin_dale_2005" role="doc-biblioref">Fortin and Dale 2005</a>)</span> (Figura <a href="cap7.html#fig:fig-diag-ratio">7.22</a>). AIC √© um m√©todo estat√≠stico que compara os modelos criados na sua pesquisa e seleciona o melhor entre eles. Diferente do LRT que compara apenas modelos aninhados, o AIC compara modelos com diferentes combina√ß√µes de vari√°veis preditoras. Uma vez que a f√≥rmula do AIC penaliza par√¢metros extras no modelo, se dois modelos explicam igualmente a varia√ß√£o dos dados, o modelo com menos par√¢metros ter√° o menor valor de AIC e ser√° selecionado como o melhor modelo.</p>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
O valor de AIC por si s√≥ n√£o tem significado. Ele precisa ser comparado com outro modelo. Contudo, um modelo s√≥ ser√° considerado superior a outro quando a diferen√ßa entre os seus valores de AIC (i.e, <em>delta</em>) forem maiores do que 2. <span class="citation">(<a href="refer%C3%AAncias.html#ref-burnham2002" role="doc-biblioref">K. A. Burnham and Anderson 2002</a>)</span></p>
</div>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Sele√ß√£o de modelos</span>
<span class="va">aic_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">no_spat_gls</span>, <span class="va">espher_model</span>, <span class="va">expon_model</span>, <span class="va">gauss_model</span>, <span class="va">cor_linear_model</span>, <span class="va">ratio_model</span><span class="op">)</span>
<span class="va">aic_fit</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">AIC</span><span class="op">)</span>
<span class="co">#&gt;                  df      AIC</span>
<span class="co">#&gt; ratio_model       5 373.1186</span>
<span class="co">#&gt; expon_model       5 373.2439</span>
<span class="co">#&gt; no_spat_gls       3 383.8616</span>
<span class="co">#&gt; espher_model      5 387.8616</span>
<span class="co">#&gt; gauss_model       5 387.8616</span>
<span class="co">#&gt; cor_linear_model  5 387.8616</span>

<span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">ratio_model</span>, type <span class="op">=</span> <span class="st">"normalized"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">ratio_model</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-diag-ratio"></span>
<img src="livro_files/figure-html/fig-diag-ratio-1.png" alt="Gr√°fico dos res√≠duos em rela√ß√£o aos dados ajustados do modelo GLS Ratio." width="100%" height="100%"><p class="caption">
Figura 7.22: Gr√°fico dos res√≠duos em rela√ß√£o aos dados ajustados do modelo GLS Ratio.
</p>
</div>
<p>O variograma ajustado pelo modelo raz√£o quadr√°tica (<em>ratio_model</em>) demonstra que o <em>range</em> n√£o √© crescente (indicando correla√ß√£o espacial entre localidades pr√≥ximas) e, desse modo, sugere que √© mais apropriado usar o modelo GLS do que um modelo linear desconsiderando a estrutura espacial (Figura <a href="cap7.html#fig:fig-variog-ratio">7.23</a>).</p>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Varigrama</span>
<span class="va">ratio_variog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/Variogram.html">Variogram</a></span><span class="op">(</span><span class="va">ratio_model</span>, form <span class="op">=</span> <span class="op">~</span><span class="va">lat</span><span class="op">+</span><span class="va">long</span>, resType <span class="op">=</span> <span class="st">"normalized"</span><span class="op">)</span>

<span class="co">## Resumo dos modelos</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ratio_model</span><span class="op">)</span><span class="op">$</span><span class="va">tTable</span> 
<span class="co">#&gt;                  Value   Std.Error   t-value      p-value</span>
<span class="co">#&gt; (Intercept) 22.1612850 2.444329887  9.066405 2.561826e-13</span>
<span class="co">#&gt; agua        -0.0151894 0.003505891 -4.332536 4.976757e-05</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">no_spat_gls</span><span class="op">)</span><span class="op">$</span><span class="va">tTable</span>
<span class="co">#&gt;                  Value   Std.Error  t-value      p-value</span>
<span class="co">#&gt; (Intercept) 24.3040255 1.249094710 19.45731 1.687907e-29</span>
<span class="co">#&gt; agua        -0.0223793 0.002876239 -7.78075 5.481035e-11</span>

<span class="co">## Gr√°ficos</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ratio_variog</span>, main <span class="op">=</span> <span class="st">"Variograma como Modelo Ratio"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">variog_mod1</span>, main <span class="op">=</span> <span class="st">"Variograma Modelo Normal"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-variog-ratio"></span>
<img src="livro_files/figure-html/fig-variog-ratio-1.png" alt="Variogramas para os res√≠duos do modelo GLS Normal e Ratio." width="100%" height="100%"><img src="livro_files/figure-html/fig-variog-ratio-2.png" alt="Variogramas para os res√≠duos do modelo GLS Normal e Ratio." width="100%" height="100%"><p class="caption">
Figura 7.23: Variogramas para os res√≠duos do modelo GLS Normal e Ratio.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Dessa forma, o valor mais apropriado da estat√≠stica t √© de -4.33 (<em>ratio_model</em>) ao inv√©s de -7.78 (<em>no_spat_gls</em>). Neste caso, a decis√£o (quantidade de √°gua afetando a riqueza de √°caros) n√£o foi afetada (<em>P</em> &lt; 0.05 nos dois modelos), somente a estat√≠stica do teste.</p>
</div>
<div id="para-se-aprofundar-3" class="section level2" number="7.8">
<h2>
<span class="header-section-number">7.8</span> Para se aprofundar<a class="anchor" aria-label="anchor" href="#para-se-aprofundar-3"><i class="fas fa-link"></i></a>
</h2>
<p>Listamos a seguir livros e links que recomendamos para seguir com sua aprendizagem em modelos lineares</p>
<div id="livros-3" class="section level3" number="7.8.1">
<h3>
<span class="header-section-number">7.8.1</span> Livros<a class="anchor" aria-label="anchor" href="#livros-3"><i class="fas fa-link"></i></a>
</h3>
<p>Recomendamos aos interessados(as) os livros: i) Zar <span class="citation">(<a href="refer%C3%AAncias.html#ref-zar_biostatistical_2010" role="doc-biblioref">2010</a>)</span> Biostatiscal analysis, ii) Gotelli &amp; Ellison <span class="citation">(<a href="refer%C3%AAncias.html#ref-gotelli_primer_2012" role="doc-biblioref">2012</a>)</span> A primer of ecological statistics, iii) Quinn &amp; Keough <span class="citation">(<a href="refer%C3%AAncias.html#ref-quinn_experimental_2002" role="doc-biblioref">2002</a>)</span> Experimental design and data analysis for biologists, iv) Zuur e colabodores <span class="citation">(<a href="refer%C3%AAncias.html#ref-zuur_analysing_2007" role="doc-biblioref">2007</a>)</span> Analysing Ecological Data e v) Touchon <span class="citation">(<a href="refer%C3%AAncias.html#ref-touchon_applied_2021" role="doc-biblioref">2021</a>)</span> Applied statistics with R: a practical guide for the life sciences.</p>
</div>
<div id="links-3" class="section level3" number="7.8.2">
<h3>
<span class="header-section-number">7.8.2</span> Links<a class="anchor" aria-label="anchor" href="#links-3"><i class="fas fa-link"></i></a>
</h3>
<p>Recomendamos a p√°gina <strong>Curso de Estat√≠stica para Pesquisa Cient√≠fica</strong>[<a href="http://estat.bio.br/" class="uri">http://estat.bio.br/</a>] do pesquisador Thiago Rangel, Universidade Federal de Goi√°s. Nesta p√°gina, voc√™s ir√£o encontrar exemplos e explica√ß√µes detalhadas sobre as an√°lises e a filosofia estat√≠stica.</p>
</div>
</div>
<div id="exerc√≠cios-3" class="section level2" number="7.9">
<h2>
<span class="header-section-number">7.9</span> Exerc√≠cios<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcios-3"><i class="fas fa-link"></i></a>
</h2>
<p><strong>7.1</strong>
Avalie se os indiv√≠duos machos de uma esp√©cie de aranha s√£o maiores do que as f√™meas. Qual a sua interpreta√ß√£o sobre o dimorfismo sexual nesta esp√©cie? Fa√ßa um gr√°fico boxplot usando tamb√©m a fun√ß√£o <code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code>. Use os dados <code>Cap7_exercicio1</code> dispon√≠vel no pacote <code>ecodados</code>.</p>
<p><strong>7.2</strong>
Avalie se o n√∫mero de polinizadores visitando uma determinada esp√©cie de planta √© dependente da presen√ßa ou aus√™ncia de predadores. A mesma planta, em tempos diferentes, foi utilizada como unidade amostral para os tratamentos com e sem predadores. Qual a sua interpreta√ß√£o sobre os resultados? Fa√ßa um gr√°fico boxplot ligando os resultados da mesma planta com e sem a presen√ßa do predador. Use os dados <code>Cap7_exercicio2</code> dispon√≠vel no pacote <code>ecodados</code>.</p>
<p><strong>7.3</strong>
Avalie se existe correla√ß√£o entre o n√∫mero de filhotes nos ninhos de uma esp√©cie de ave com o tamanho do fragmento florestal. Qual a sua interpreta√ß√£o dos resultados? Fa√ßa um gr√°fico mostrando a rela√ß√£o entre as vari√°veis. Use os dados <code>Cap7_exercicio3</code> dispon√≠vel no pacote <code>ecodados</code>.</p>
<p><strong>7.4</strong>
Avalie se a rela√ß√£o entre o tamanho da √°rea de diferentes ilhas e a riqueza de esp√©cies de lagartos. Qual a sua interpreta√ß√£o dos resultados? Fa√ßa um gr√°fico mostrando a rela√ß√£o predita pelo modelo. Use os dados <code>Cap7_exercicio4</code> dispon√≠vel no pacote <code>ecodados</code>.</p>
<p><strong>7.5</strong>
Avalie se existe rela√ß√£o entre a abund√¢ncia de uma esp√©cie de roedor com o tamanho da √°rea dos fragmentos florestais e/ou a altitude. Fa√ßa uma regress√£o m√∫ltipla. Em seguida, crie diferentes modelos e selecione o mais parcimonioso com base nos valores do teste de <em>Likelihood-ratio test</em> (LRT) e <em>Akaike information criterion</em> (AIC). Qual a sua interpreta√ß√£o? Use os dados <code>Cap7_exercicio5</code> dispon√≠vel no pacote <code>ecodados</code>.</p>
<p><strong>7.6</strong>
Avalie se o local que machos territoriais ocupam (pasto, cana, floresta) influ√™ncia no peso dos indiv√≠duos. Qual a sua interpreta√ß√£o dos resultados? Fa√ßa um gr√°fico com os resultados. Use os dados <code>Cap7_exercicio6</code> dispon√≠vel no pacote <code>ecodados</code>.</p>
<p><strong>7.7</strong>
Avalie se a abund√¢ncia de formigas est√° relacionada com o fato das dom√°cias estarem abertas ou fechadas e com a idade das dom√°cias. Verifique a intera√ß√£o entre os fatores. Qual a sua interpreta√ß√£o dos resultados? Fa√ßa um gr√°fico com os resultados. Use os dados <code>Cap7_exercicio7</code> dispon√≠vel no pacote <code>ecodados</code>.</p>
<p><strong>7.8</strong>
Avalie se o n√∫mero de parasitas est√° relacionado com o tamanho corporal de f√™meas de uma esp√©cie de ave. Al√©m disso, use a idade das aves como uma covari√°vel explicando o n√∫mero de parasitas. Qual a sua interpreta√ß√£o dos resultados? Fa√ßa um gr√°fico com os resultados. Use os dados <code>Cap7_exercicio8</code> dispon√≠vel no pacote <code>ecodados</code>.</p>
<p><strong>7.9</strong>
Avalie se a presen√ßa ou aus√™ncia de predadores afeta a riqueza de macroinvertebrados em 10 lagos. Os tratamentos dos predadores foram realizados nos mesmos lagos. Qual a sua interpreta√ß√£o dos resultados? Fa√ßa um gr√°fico com os resultados. Use os dados <code>Cap7_exercicio9</code> dispon√≠vel no pacote <code>ecodados</code>.</p>
<p><strong>7.10</strong>
Avalie se a precipita√ß√£o anual afeta a riqueza de esp√©cies de anuros em 44 localidades na Mata Atl√¢ntica. Use as coordenadas geogr√°ficas para controlar o efeito da autocorrela√ß√£o espacial. Qual a sua interpreta√ß√£o dos resultados das an√°lises com e sem levar em considera√ß√£o a autocorrela√ß√£o espacial? Use os dados <code>anuros_ambientais</code> dispon√≠vel no pacote <code>ecodados</code>.</p>
<p><a href="https://exercicios-livro-aer.netlify.app/cap.-7---modelos-lineares.html">Solu√ß√µes dos exerc√≠cios</a>.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="cap6.html"><span class="header-section-number">6</span> Visualiza√ß√£o de dados</a></div>
<div class="next"><a href="cap8.html"><span class="header-section-number">8</span> Modelos Lineares Generalizados</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Nesta p√°gina"><h2><b>Nesta p√°gina</b></h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cap7"><span class="header-section-number">7</span> Modelos lineares</a></li>
<li><a class="nav-link" href="#pr%C3%A9-requisitos-do-cap%C3%ADtulo-3">Pr√©-requisitos do cap√≠tulo</a></li>
<li><a class="nav-link" href="#teste-t-de-student-para-duas-amostras-independentes"><span class="header-section-number">7.1</span> Teste T (de Student) para duas amostras independentes</a></li>
<li><a class="nav-link" href="#teste-t-para-amostras-pareadas"><span class="header-section-number">7.2</span> Teste T para amostras pareadas</a></li>
<li><a class="nav-link" href="#correla%C3%A7%C3%A3o-de-pearson"><span class="header-section-number">7.3</span> Correla√ß√£o de Pearson</a></li>
<li><a class="nav-link" href="#regress%C3%A3o-linear-simples"><span class="header-section-number">7.4</span> Regress√£o Linear Simples</a></li>
<li><a class="nav-link" href="#regress%C3%A3o-linear-m%C3%BAltipla"><span class="header-section-number">7.5</span> Regress√£o Linear M√∫ltipla</a></li>
<li>
<a class="nav-link" href="#an%C3%A1lises-de-vari%C3%A2ncia-anova"><span class="header-section-number">7.6</span> An√°lises de Vari√¢ncia (ANOVA)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#anova-de-um-fator"><span class="header-section-number">7.6.1</span> ANOVA de um fator</a></li>
<li><a class="nav-link" href="#anova-com-dois-fatores-ou-anova-fatorial"><span class="header-section-number">7.6.2</span> ANOVA com dois fatores ou ANOVA fatorial</a></li>
<li><a class="nav-link" href="#anova-em-blocos-aleatorizados"><span class="header-section-number">7.6.3</span> ANOVA em blocos aleatorizados</a></li>
<li><a class="nav-link" href="#an%C3%A1lise-de-covari%C3%A2ncia-ancova"><span class="header-section-number">7.6.4</span> An√°lise de covari√¢ncia (ANCOVA)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#generalized-least-squares-gls"><span class="header-section-number">7.7</span> Generalized Least Squares (GLS)</a></li>
<li>
<a class="nav-link" href="#para-se-aprofundar-3"><span class="header-section-number">7.8</span> Para se aprofundar</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#livros-3"><span class="header-section-number">7.8.1</span> Livros</a></li>
<li><a class="nav-link" href="#links-3"><span class="header-section-number">7.8.2</span> Links</a></li>
</ul>
</li>
<li><a class="nav-link" href="#exerc%C3%ADcios-3"><span class="header-section-number">7.9</span> Exerc√≠cios</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/paternogbc/livro_aer/blob/master/07_modelos_lineares.Rmd">Ver fonte <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/paternogbc/livro_aer/edit/master/07_modelos_lineares.Rmd">Editar esta p√°gina <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>An√°lises Ecol√≥gicas no R</strong>" foi escrito por Fernando Rodrigues da Silva, Thiago Gon√ßalves-Souza, Gustavo Brant Paterno, <br> Diogo Borges Provete, Maur√≠cio Humberto Vancine. √öltima atualiza√ß√£o 2022-06-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este livro foi compilado com o pacote R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
