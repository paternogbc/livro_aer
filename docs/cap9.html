<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cap√≠tulo 9 An√°lises Multidimensionais | An√°lises Ecol√≥gicas no R</title>
<meta name="author" content="Fernando Rodrigues da Silva, Thiago Gon√ßalves-Souza, Gustavo Brant Paterno,   Diogo Borges Provete, Maur√≠cio Humberto Vancine">
<meta name="description" content="Pr√©-requisitos do cap√≠tulo Pacotes e dados que ser√£o utilizados neste cap√≠tulo. ## Pacotes library(ade4) library(ecodados) library(tidyverse) library(vegan) library(pvclust) library(BiodiversityR)...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Cap√≠tulo 9 An√°lises Multidimensionais | An√°lises Ecol√≥gicas no R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://analises-ecologicas.netlify.app/cap9.html">
<meta property="og:image" content="https://analises-ecologicas.netlify.app/img/capa.jpeg">
<meta property="og:description" content="Pr√©-requisitos do cap√≠tulo Pacotes e dados que ser√£o utilizados neste cap√≠tulo. ## Pacotes library(ade4) library(ecodados) library(tidyverse) library(vegan) library(pvclust) library(BiodiversityR)...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cap√≠tulo 9 An√°lises Multidimensionais | An√°lises Ecol√≥gicas no R">
<meta name="twitter:description" content="Pr√©-requisitos do cap√≠tulo Pacotes e dados que ser√£o utilizados neste cap√≠tulo. ## Pacotes library(ade4) library(ecodados) library(tidyverse) library(vegan) library(pvclust) library(BiodiversityR)...">
<meta name="twitter:image" content="https://analises-ecologicas.netlify.app/img/capa.jpeg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">An√°lises Ecol√≥gicas no R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Sum√°rio"><h2>Sum√°rio</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bem-vindos</a></li>
<li><a class="" href="pref%C3%A1cio.html">Pref√°cio</a></li>
<li><a class="" href="dedicat%C3%B3ria.html">Dedicat√≥ria</a></li>
<li><a class="" href="sobre-os-autores.html">Sobre os autores</a></li>
<li><a class="" href="revisores-e-colaboradores.html">Revisores e colaboradores</a></li>
<li><a class="" href="cap1.html"><span class="header-section-number">1</span> Introdu√ß√£o</a></li>
<li><a class="" href="cap2.html"><span class="header-section-number">2</span> Voltando ao b√°sico: como dominar a arte de fazer perguntas cientificamente relevantes</a></li>
<li><a class="" href="cap3.html"><span class="header-section-number">3</span> Pr√©-requisitos</a></li>
<li><a class="" href="cap4.html"><span class="header-section-number">4</span> Introdu√ß√£o ao R</a></li>
<li><a class="" href="cap5.html"><span class="header-section-number">5</span> Tidyverse</a></li>
<li><a class="" href="cap6.html"><span class="header-section-number">6</span> Visualiza√ß√£o de dados</a></li>
<li><a class="" href="cap7.html"><span class="header-section-number">7</span> Modelos lineares</a></li>
<li><a class="" href="cap8.html"><span class="header-section-number">8</span> Modelos Lineares Generalizados</a></li>
<li><a class="active" href="cap9.html"><span class="header-section-number">9</span> An√°lises Multidimensionais</a></li>
<li><a class="" href="cap10.html"><span class="header-section-number">10</span> Rarefa√ß√£o</a></li>
<li><a class="" href="cap11.html"><span class="header-section-number">11</span> Estimadores de riqueza</a></li>
<li><a class="" href="cap12.html"><span class="header-section-number">12</span> Diversidade Taxon√¥mica</a></li>
<li><a class="" href="cap13.html"><span class="header-section-number">13</span> Diversidade Filogen√©tica</a></li>
<li><a class="" href="cap14.html"><span class="header-section-number">14</span> Diversidade Funcional</a></li>
<li><a class="" href="cap15.html"><span class="header-section-number">15</span> Dados geoespaciais</a></li>
<li><a class="" href="gloss%C3%A1rio.html">Gloss√°rio</a></li>
<li><a class="" href="refer%C3%AAncias.html">Refer√™ncias</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/paternogbc/livro_aer">Ver c√≥digo fonte <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cap9" class="section level1" number="9">
<h1>
<span class="header-section-number">Cap√≠tulo 9</span> An√°lises Multidimensionais<a class="anchor" aria-label="anchor" href="#cap9"><i class="fas fa-link"></i></a>
</h1>
<div id="pr√©-requisitos-do-cap√≠tulo-5" class="section level2 unnumbered">
<h2>Pr√©-requisitos do cap√≠tulo<a class="anchor" aria-label="anchor" href="#pr%C3%A9-requisitos-do-cap%C3%ADtulo-5"><i class="fas fa-link"></i></a>
</h2>
<p>Pacotes e dados que ser√£o utilizados neste cap√≠tulo.</p>
<div class="sourceCode" id="cb344"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Pacotes </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ecodados</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org">vegan</a></span><span class="op">)</span> 
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stat.sys.i.kyoto-u.ac.jp/prog/pvclust/">pvclust</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.worldagroforestry.org/output/tree-diversity-analysis">BiodiversityR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ecology.msu.montana.edu/labdsv/R">labdsv</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">FD</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dnychka/fieldsRPackage">fields</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ggord</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pacificclimate/Rudunits2">udunits2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sdray/adespatial">adespatial</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/">spdep</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mvabund</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/reshape">reshape</a></span><span class="op">)</span>

<span class="co">## Dados</span>
<span class="va">sp_compos</span>        <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">bocaina</span>
<span class="va">species</span>          <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">com_birds</span>
<span class="va">env</span>              <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">env_birds</span>
<span class="va">xy</span>               <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">birds.xy</span>
<span class="va">bocaina.env</span>      <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">bocaina.env</span>
<span class="va">bocaina.xy</span>       <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">bocaina.xy</span>
<span class="va">anuros_permanova</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">anuros_permanova</span>
<span class="va">macroinv</span>         <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">macroinv</span>
<span class="va">fish_comm</span>        <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">fish_comm</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mite.env</span><span class="op">)</span>

<span class="co">## Traduzir nomes para portugu√™s </span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"especies"</span>, <span class="st">"ilha"</span>, <span class="st">"comprimento_bico"</span>, <span class="st">"profundidade_bico"</span>, <span class="st">"comprimento_nadadeira"</span>, <span class="st">"massa_corporal"</span>, <span class="st">"sexo"</span>, <span class="st">"ano"</span><span class="op">)</span></code></pre></div>
</div>
<div id="aspectos-te√≥ricos" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Aspectos te√≥ricos<a class="anchor" aria-label="anchor" href="#aspectos-te%C3%B3ricos"><i class="fas fa-link"></i></a>
</h2>
<p>An√°lises multivariadas avaliam hip√≥teses cuja vari√°vel resposta √© definida por m√∫ltiplas vari√°veis ao mesmo tempo, comumente expressa na forma de uma matriz quadrada ou de dist√¢ncia (dissimilaridade).</p>
<p>Em geral, an√°lises multivariadas t√™m tr√™s principais utilidades: i) reduzir a dimensionalidade dos dados e encontrar a principal dire√ß√£o de varia√ß√£o dos mesmos, ii) testar rela√ß√µes entre matrizes, ou ainda, iii) encontrar diferen√ßas entre grupos. An√°lises multivariadas podem ser utilizadas como an√°lises explorat√≥rias e/ou para descrever padr√µes em estudos ecol√≥gicos. No entanto, mesmo quando se deseja apenas explorar o conjunto de dados para encontrar poss√≠veis padr√µes, a necessidade de se ter hip√≥teses, ou ao menos expectativas <em>a priori</em>, n√£o pode ser ignorada. Antes de entrar de cabe√ßa nas an√°lises multivariadas, tamb√©m sugerimos fortemente o estudo de m√©todos de amostragem e como fazer boas perguntas (Cap√≠tulo <a href="cap2.html#cap2">2</a>).</p>
<p>An√°lises multivariadas podem ser divididas, grosseiramente, em dois tipos: agrupamento e ordena√ß√£o. An√°lises de agrupamento, em geral, tentam agrupar objetos (observa√ß√µes) ou descritores em grupos de maneira que objetos do mesmo grupo sejam mais semelhantes entre si do que objetos de outros grupos <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. Por exemplo, os objetos podem ser localidades como ‚Äúparcelas,‚Äù ‚Äúriachos‚Äù ou ‚Äúflorestas,‚Äù enquanto os descritores s√£o as difentes vari√°veis coletadas para esses objetos (e.g., esp√©cies, vari√°veis ambientais). A an√°lise de ordena√ß√£o, por sua vez, √© uma opera√ß√£o pela qual os objetos (ou descritores) s√£o posicionados num espa√ßo que cont√©m menos dimens√µes que o conjunto de dados original; a posi√ß√£o dos objetos ou descritores em rela√ß√£o aos outros tamb√©m pode ser usada para agrup√°-los.</p>
<div id="coeficientes-de-associa√ß√£o" class="section level3" number="9.1.1">
<h3>
<span class="header-section-number">9.1.1</span> Coeficientes de associa√ß√£o<a class="anchor" aria-label="anchor" href="#coeficientes-de-associa%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h3>
<p>Assim chamados genericamente, os coeficientes de associa√ß√£o medem o qu√£o parecidos objetos ou descritores s√£o entre si. Objetos est√£o nas linhas da matriz, enquanto descritores est√£o nas colunas. Geralmente objetos s√£o as nossas unidades amostrais, enquanto os descritores s√£o as vari√°veis. Quando analisamos a rela√ß√£o entre objetos fazemos uma an√°lise no modo Q, ao passo que o modo R √© quando analisamos a rela√ß√£o entre descritores. Coeficientes de associa√ß√£o do modo Q s√£o medidas de (dis)similaridade ou dist√¢ncia, enquanto para o modo R utilizamos covari√¢ncia ou correla√ß√£o. Como j√° tratamos neste livro sobre covari√¢ncia e correla√ß√£o (ver Cap√≠tulo <a href="cap7.html#cap7">7</a>), neste t√≥pico vamos falar sobre √≠ndices de dist√¢ncia e similaridade. Mas qual a defini√ß√£o destas duas quantitades?</p>
<ul>
<li>Similaridade s√£o m√°ximas (<em>S=1</em>) quando dois objetos s√£o id√™nticos</li>
<li>Dist√¢ncias s√£o o contr√°rio da similaridade (<em>D=1-S</em>) e n√£o t√™m limites superiores (dependem da unidade de medida)</li>
</ul>
<p>Existem ao menos 26 √≠ndices de similaridade que podem ser agrupados de acordo com o tipo de dado (qualitativos ou quantitativos) ou a maneira com que lidam com duplos zeros (sim√©tricos ou assim√©tricos) <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. Do seu lado, as dist√¢ncias s√≥ se aplicam a dados quantitativos e t√™m como caracter√≠sticas serem m√©tricas, semi-m√©tricas ou n√£o-m√©tricas. Vejamos agora os principais √≠ndices de similaridade e dist√¢ncia de cada tipo.</p>
</div>
<div id="m√©tricas-de-dist√¢ncia" class="section level3" number="9.1.2">
<h3>
<span class="header-section-number">9.1.2</span> M√©tricas de dist√¢ncia<a class="anchor" aria-label="anchor" href="#m%C3%A9tricas-de-dist%C3%A2ncia"><i class="fas fa-link"></i></a>
</h3>
<p>O principal coeficiente de dist√¢ncia usado em ecologia √© a dist√¢ncia euclidiana. Al√©m disso, temos ainda Canberra (varia√ß√£o da Dist√¢ncia Euclidiana), Mahalanobis (calcula a dist√¢ncia entre dois pontos num espa√ßo n√£o ortogonal, levando em considera√ß√£o a covari√¢ncia entre descritores), Manhattan (varia√ß√£o da Dist√¢ncia Euclidiana), Chord (elimina diferen√ßas entre abund√¢ncia total de esp√©cies), ùúí2 (d√° peso maior para esp√©cies raras), Hellinger (n√£o d√° peso para esp√©cies raras). Essas dist√¢ncias s√£o recomendadas nos casos em que as vari√°veis de estudo forem cont√≠nuas, como por exemplo, <strong>vari√°veis morfom√©tricas ou descritores ambientais</strong>.</p>
<p>Uma caracter√≠stica comum de conjuntos de dados ecol√≥gicos s√£o os v√°rios zeros encontrados em matrizes de composi√ß√£o. Eles surgem porque n√£o encontramos nenhum indiv√≠duo de uma determinada esp√©cie num local, seja porque aquele local n√£o tem as condi√ß√µes ambientais adequadas a ela, falha na detectabilidade, ou din√¢micas demogr√°ficas estoc√°sticas de coloniza√ß√£o-extin√ß√£o <span class="citation">(<a href="refer%C3%AAncias.html#ref-blascomoreno2019" role="doc-biblioref">Blasco‚ÄêMoreno et al. 2019</a>)</span>. Logo, quando dois locais compartilham aus√™ncia de esp√©cies, n√£o √© poss√≠vel atribuir uma √∫nica raz√£o da dupla aus√™ncia. Como essas medidas de dist√¢ncia apresentadas acima assumem que os dados s√£o quantitativos e n√£o de contagem, elas n√£o s√£o adequadas para lidar com dados de abund√¢ncia ou incid√™ncia de esp√©cies, porque atribuem um grau de parec√™n√ßa a pares de locais que compartilham zeros <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. Por esse motivo, precisamos de coeficientes que desconsiderem os duplos zeros. Eles s√£o chamados de <em>assim√©tricos</em>.</p>
<p><strong>Coeficientes assim√©tricos bin√°rios para objetos</strong></p>
<p>Esses coeficientes (ou √≠ndices) s√£o apropriados para dados de incid√™ncia de esp√©cies (presen√ßa-aus√™ncia) e desconsideram as duplas aus√™ncias. Os √≠ndices deste tipo mais comuns utilizados em ecologia s√£o Jaccard, S√∏rensen e Ochiai.</p>
<p>O coeficiente de Jaccard √© dado por:</p>
<p><span class="math display">\[\beta_j = a/(a+b+c)\]</span>
onde</p>
<ul>
<li>
<em>a</em> = n√∫mero de esp√©cies compartilhadas</li>
<li>
<em>b</em> = n√∫mero de esp√©cies exclusivas da comunidade 1</li>
<li>
<em>c</em> = n√∫mero de esp√©cies exclusivas da comunidade 2</li>
</ul>
<p>A diferen√ßa entre os √≠ndices de Jaccard e S√∏rensen √© que o √≠ndice de S√∏rensen d√° peso dobrado para duplas presen√ßas. Por conta dessas caracter√≠sticas, estes √≠ndices s√£o adequados para quantificar diversidade beta <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson2010" role="doc-biblioref">M. J. Anderson et al. 2011</a>; <a href="refer%C3%AAncias.html#ref-legendre2013" role="doc-biblioref">Legendre and De C√°ceres 2013</a>)</span>. Esses √≠ndices variam entre 0 (nenhuma esp√©cie √© compartilhada entre o par de locais) a 1 (todas as esp√©cies s√£o compartilhadas entre o par de locais).</p>
<p>O coeficiente de S√∏rensen √© dado por:</p>
<p><span class="math display">\[\beta_s = 2a/(2a+b+c)\]</span>
onde</p>
<ul>
<li>
<em>a</em> = n√∫mero de esp√©cies compartilhadas</li>
<li>
<em>b</em> = n√∫mero de esp√©cies exclusivas da comunidade 1</li>
<li>
<em>c</em> = n√∫mero de esp√©cies exclusivas da comunidade 2</li>
</ul>
<p><strong>Coeficientes bin√°rios para descritores (R mode)</strong></p>
<p>Se o objetivo for calcular a similaridade entre descritores bin√°rios (e.g., presen√ßa ou aus√™ncia de caracter√≠sticas ambientais) de pares de locais, geralmente o coeficiente recomendado √© o de Sokal &amp; Michener. Este √≠ndice est√° implementado na fun√ß√£o <code><a href="https://rdrr.io/pkg/ade4/man/dist.binary.html">dist.binary()</a></code> do pacote <code>ade4</code>.</p>
<p><strong>Coeficientes quantitativos para objetos</strong></p>
<p>Estes s√£o os coeficientes utilizados para dados de contagem (e.g., abund√¢ncia) e quantitativos (e.g., frequ√™ncia, biomassa, porcentagem de cobertura). Diferentemente das dist√¢ncias, estes coeficientes s√£o assim√©tricos, ou seja, n√£o consideram duplas aus√™ncias, e portanto, s√£o adequados para analisar dados de composi√ß√£o de esp√©cies. Al√©m disso, uma outra caracter√≠stica deles √© serem semi-m√©tricos. Os √≠ndices mais comuns deste tipo s√£o Bray-Curtis (conhecido como <em>percentage difference</em>, em ingl√™s), Chord, log-Chord, Hellinger, chi-quadrado e Morisita-Horn.</p>
<p>Todos os √≠ndices discutidos at√© aqui est√£o implementados nas fun√ß√µes <code><a href="https://rdrr.io/pkg/ade4/man/dist.ktab.html">ade4::dist.ktab()</a></code>, <code><a href="https://rdrr.io/pkg/adespatial/man/dist.ldc.html">adespatial::dist.ldc()</a></code> e <code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegan::vegdist()</a></code>.</p>
<p><strong>Coeficientes para descritores (R mode) que incluem mistura de tipos de dados</strong></p>
<p>√â comum em an√°lises de diversidade funcional que tenhamos um conjunto de atributos (<em>traits</em>) de esp√©cies que s√£o formados por v√°rios tipos de dados: quantitativos (e.g., tamanho de corpo), bin√°rios (presen√ßa/aus√™ncia de uma dada caracter√≠stica), <em>fuzzy</em> (um atributo multiestado codificado em v√°rias colunas), ordinais e circulares (e.g., distribui√ß√£o de uma fenofase ao longo de um ano). O √≠ndice que lida com todos esses dados √© o Gower. A vers√£o extendida do √≠ndice de Gower pode ser encontrada na fun√ß√£o <code>ade4::dist.ktab().</code></p>
<p>O cap√≠tulo 7 de Legendre &amp; Legendre <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">2012</a>)</span> fornece uma chave dicot√¥mica para escolha do √≠ndice mais adequado.</p>
<p><strong>Padroniza√ß√µes e transforma√ß√µes</strong></p>
<p>√â comum coletarmos m√∫ltiplas vari√°veis ambientais cujas unidades sejam diferentes. Por exemplo, temperatura (¬∫C), dist√¢ncia da margem (m), √°rea (m<sup>2</sup>), etc. Para diminuir a taxa de Erro do Tipo I das an√°lises (rejeitar a hip√≥tese nula quando ela √© verdadeira), √© recomendado que <strong><em>padronizemos</em></strong> os dados utilizando distribui√ß√£o <em>Z</em>, assim todas as vari√°veis passam a ter m√©dia 0 e desvio padr√£o 1. Essa opera√ß√£o garante que todas as vari√°veis tenham o mesmo peso nas an√°lises que avaliam o padr√£o dos objetos considerando os m√∫ltiplos descritores. Essa padroniza√ß√£o pode ser implementada na fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/decostand.html">vegan::decostand()</a></code>.</p>
<p>Outro problema comum de matrizes de dados de composi√ß√£o de esp√©cies √© o alto n√∫mero de zeros, enquanto outras esp√©cies podem ter altas abund√¢ncias. Isso gera problemas em ordena√ß√µes. Para diminuir essa discrep√¢ncia, podemos <strong>transformar</strong> os dados, por exemplo, utilizando a dist√¢ncia de Hellinger ou Chord. Para dados cont√≠nuos pode ser que transforma√ß√£o log ou raiz quadrada ajude quando h√° valores muito discrepantes (<em>leverages</em>) que podem influenciar em demasiado a rela√ß√£o entre objetos ou descritores. Isso pode ser feito na fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/decostand.html">vegan::decostand()</a></code>.</p>
</div>
</div>
<div id="an√°lises-de-agrupamento" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> An√°lises de agrupamento<a class="anchor" aria-label="anchor" href="#an%C3%A1lises-de-agrupamento"><i class="fas fa-link"></i></a>
</h2>
<p>O objetivo da an√°lise de agrupamento √© agrupar objetos admitindo que haja um grau de similaridade entre eles. Esta an√°lise pode ser utilizada ainda para classificar uma popula√ß√£o em grupos homog√™neos de acordo com uma caracter√≠stica de interesse. A grosso modo, uma an√°lise de agrupamento tenta resumir uma grande quantidade de dados e apresent√°-la de maneira f√°cil de visualizar e entender (em geral, na forma de um dendrograma). No entanto, os resultados da an√°lise podem n√£o refletir necessariamente toda a informa√ß√£o originalmente contida na matriz de dados. Para avaliar o qu√£o bem uma an√°lise de agrupamento representa os dados originais existe uma m√©trica ‚Äî o coeficiente de correla√ß√£o cofen√©tico ‚Äî o qual discutiremos em detalhes mais adiante.</p>
<p>Antes de considerar algum m√©todo de agrupamento, pense porque voc√™ esperaria que houvesse uma descontinuidade nos dados; ou ainda, considere se existe algum ganho pr√°tico em dividir uma nuvem de objetos cont√≠nuos em grupos. O padr√£o apresentado pelo dendograma depende do protocolo utilizado (m√©todo de agrupamento e √≠ndice de dissimilaridade); os grupos formados dependem do n√≠vel de corte escolhido.</p>
<p>A matriz deve conter os objetos a serem agrupados (e.g., esp√©cies) nas linhas e as vari√°veis (e.g., locais de coleta ou medidas morfol√≥gicas) nas colunas. A escolha do m√©todo de agrupamento √© cr√≠tico para a escolha de um coeficiente de associa√ß√£o. √â importante compreender as propriedades dos m√©todos de agrupamento para interpretar corretamente a estrutura ecol√≥gica que eles evidenciam <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. De acordo com a classifica√ß√£o de Sneath &amp; Sokal <span class="citation">(<a href="refer%C3%AAncias.html#ref-sneath_numerical_1973" role="doc-biblioref">1973</a>)</span>, existem cinco tipos de m√©todos: i) sequenciais ou simult√¢neos, ii) aglomerativo ou divisivo, iii) monot√©ticos ou polit√©ticos, iv) hier√°rquico ou n√£o hier√°rquicos e v) probabil√≠stico. Sugerimos a leitura do artigo citado anteriormente para aprofundar seus conhecimentos sobre os diferentes m√©todos.</p>
<div id="agrupamento-hier√°rquico" class="section level3" number="9.2.1">
<h3>
<span class="header-section-number">9.2.1</span> Agrupamento hier√°rquico<a class="anchor" aria-label="anchor" href="#agrupamento-hier%C3%A1rquico"><i class="fas fa-link"></i></a>
</h3>
<p>M√©todos hier√°rquicos podem ser divididos naqueles que consideram o centr√≥ide ou a m√©dia aritm√©tica entre os grupos. O principal m√©todo hier√°rquico que utiliza a m√©dia aritm√©tica √© o UPGMA (Agrupamento pelas m√©dias aritm√©ticas n√£o ponderadas), e o principal m√©todo que utiliza centr√≥ides √© a Dist√¢ncia m√≠nima de Ward.</p>
<p>O UPGMA funciona da seguinte forma: a maior similaridade (ou menor dist√¢ncia) identifica os pr√≥ximos agrupamentos a serem formados. Ap√≥s esse evento, o m√©todo calcula a m√©dia aritm√©tica das similaridades ou dist√¢ncias entre um objeto e cada um dos membros do grupo ou, no caso de um grupo previamente formado, entre todos os membros dos dois grupos. Todos os objetos recebem pesos iguais no c√°lculo.</p>
<p>O m√©todo de Ward √© baseado no crit√©rio de quadrados m√≠nimos (OLS), o mesmo utilizado para ajustar um modelo linear (Cap√≠tulo <a href="cap7.html#cap7">7</a>). O objetivo √© definir os grupos de maneira que a soma de quadrados (i.e.¬†similar ao erro quadrado da ANOVA) dentro dos grupos seja minimizada <span class="citation">(<a href="refer%C3%AAncias.html#ref-borcard2018" role="doc-biblioref">Borcard, Gillet, and Legendre 2018</a>)</span>.</p>
<p>No entanto, para interpretar os resultados precisamos antes definir um n√≠vel de corte, que vai nos dizer quantos grupos existem. H√° v√°rios m√©todos para definir grupos, desde os heur√≠sticos aos que utilizam reamostragem (<em>bootstrap</em>). Se quisermos interpretar este dendrograma, podemos, por exemplo, estabelecer um n√≠vel de corte de 50% de dist√¢ncia (ou seja, grupos cujos objetos tenham ao menos 50% de similaridade entre si).</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Verifique se n√£o h√° espa√ßo nos nomes das colunas e linhas</p></li>
<li><p>Se os dados forem de abund√¢ncia, recomenda-se realizar a transforma√ß√£o de Hellinger <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2001" role="doc-biblioref">Legendre and Gallagher 2001</a>)</span>. Esta transforma√ß√£o √© necess√°ria porque a matriz de comunidades (em especial, com a presen√ßa de muitas esp√©cies raras) pode causar distor√ß√µes nos m√©todos de ordena√ß√£o baseados em dist√¢ncia Euclidiana <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2001" role="doc-biblioref">Legendre and Gallagher 2001</a>)</span></p></li>
<li><p>Se a matriz original contiver muitos valores discrepantes (e.g., uma esp√©cie muito mais ou muito menos abundante que outras) √© necess√°rio transformar os dados usando <code><a href="https://rdrr.io/r/base/Log.html">log1p()</a></code>. No entanto, deve-se fazer ou a transforma√ß√£o de Hellinger ou log e nunca as duas ao mesmo tempo</p></li>
<li><p>Se as vari√°veis forem medidas tomadas em diferentes escalas (metros, graus celsius etc.), √© necess√°rio padronizar cada vari√°vel para ter a m√©dia 0 e desvio padr√£o 1. Isso pode ser feito utulizando a fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand()</a></code> do pacote <code>vegan</code></p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar um conjunto de dados que cont√©m girinos de esp√©cies de anuros coletados em 14 po√ßas com diferentes coberturas de dossel <span class="citation">(<a href="refer%C3%AAncias.html#ref-provete_broad-scale_2014" role="doc-biblioref">Provete et al. 2014</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existem grupos de esp√©cies de anf√≠bios anuros com padr√µes de ocorr√™ncia similar ao longo das po√ßas?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Iremos encontrar ao menos dois grupos de esp√©cies: aquelas que ocorrem em po√ßas dentro de floresta (i.e., maior cobertura de dossel) <em>vesus</em> aquelas que ocorrem em po√ßas de √°reas abertas (menor cobertura de dossel)</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Vari√°veis preditoras: a matriz de dados cont√©m a abund√¢ncia das esp√©cies nas linhas e locais (po√ßas) nas colunas</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Para come√ßar, vamos primeiro importar os dados e depois calcular a matriz de dist√¢ncia que seja adequada para o tipo de dado que temos (abund√¢ncia de esp√©cies - dados de contagem) (Figura <a href="cap9.html#fig:fig-dend">9.1</a>).</p>
<div class="sourceCode" id="cb345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Composi√ß√£o de esp√©cies (seis primeiras localidades)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sp_compos</span><span class="op">)</span>
<span class="co">#&gt;         BP4  PP4 PP3  AP1 AP2 PP1 PP2 BP9  PT1 PT2 PT3 BP2 PT5</span>
<span class="co">#&gt; Aper      0    3   0    0   2   0   0   0    0   0   0 181   0</span>
<span class="co">#&gt; Bahe    859   14  14    0  87 312 624 641    0   0   0  14   0</span>
<span class="co">#&gt; Rict   1772 1517 207  573 796   0   0   0    0   0   0   0   0</span>
<span class="co">#&gt; Cleuco    0    0   0    0   0   0   0   0    0  29 369   0  84</span>
<span class="co">#&gt; Dmic      0    0   6   60   4   0   0   0 2758 319  25   0 329</span>
<span class="co">#&gt; Dmin      0   84 344 1045  90   0   0   0    8   0   0   0   0</span>

<span class="co">## Matriz de similaridade com o coeficiente de Morisita-Horn</span>
<span class="va">distBocaina</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sp_compos</span>, method <span class="op">=</span> <span class="st">"horn"</span><span class="op">)</span>

<span class="co">## Agrupamento com a fun√ß√£o hclust e o m√©todo UPGMA</span>
<span class="va">dendro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">distBocaina</span>, method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span>

<span class="co">## Visualizar os resultados</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">dendro</span>, main <span class="op">=</span> <span class="st">"Dendrograma"</span>, 
     ylab <span class="op">=</span> <span class="st">"Similaridade (√≠ndice de Horn)"</span>,
     xlab<span class="op">=</span><span class="st">""</span>, sub<span class="op">=</span><span class="st">""</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-dend"></span>
<img src="livro_files/figure-html/fig-dend-1.png" alt="Dendrograma mostrando uma an√°lise de agrupamento de anuros." width="100%" height="100%"><p class="caption">
Figura 9.1: Dendrograma mostrando uma an√°lise de agrupamento de anuros.
</p>
</div>
<p><strong>Assessando a qualidade do dendrograma</strong></p>
<p>Precisamos verificar se o agrupamento reduziu a dimensionalidade da matiz de forma eficiente, de maneira a n√£o distorcer a informa√ß√£o. Fazemos isso calculando o <strong>Coeficiente de Correla√ß√£o Cofen√©tica</strong>.</p>
<div class="sourceCode" id="cb346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Coeficiente de correla√ß√£o cofen√©tica</span>
<span class="va">cofresult</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">dendro</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">cofresult</span>, <span class="va">distBocaina</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.9455221</span></code></pre></div>
<p>Um coeficiente de correla√ß√£o cofen√©tica &gt; .7 indica uma boa representa√ß√£o. Portanto, o nosso resultado de 0.9455221 √© alto, garantindo que o dendrograma √© adequado (Figura <a href="cap9.html#fig:fig-dend-group">9.2</a>). Note que testar a ‚Äúsignific√¢ncia‚Äù deste coeficiente n√£o √© adequado, j√° que seria algo tautol√≥gico (circular). Claro que definir o que seria um valor ‚Äúalto‚Äù ou ‚Äúbaixo‚Äù da correla√ß√£o √© um pouco arbritr√°rio, mas pode-se usar como ‚Äúregra do polegar.‚Äù</p>
<div class="sourceCode" id="cb347"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">dendro</span>, main <span class="op">=</span> <span class="st">"Dendrograma"</span>, 
     ylab <span class="op">=</span> <span class="st">"Similaridade (√≠ndice de Horn)"</span>,
     xlab<span class="op">=</span><span class="st">""</span>, sub<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">4</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">ncol</a></span><span class="op">(</span><span class="va">sp_compos</span><span class="op">)</span>
<span class="va">MidPoint</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">dendro</span><span class="op">$</span><span class="va">height</span><span class="op">[</span><span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">]</span> <span class="op">+</span> <span class="va">dendro</span><span class="op">$</span><span class="va">height</span><span class="op">[</span><span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">MidPoint</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-dend-group"></span>
<img src="livro_files/figure-html/fig-dend-group-1.png" alt="Dendrograma mostrando uma an√°lise de agrupamento de anuros com uma linha de corte formando cinco grupos." width="100%" height="100%"><p class="caption">
Figura 9.2: Dendrograma mostrando uma an√°lise de agrupamento de anuros com uma linha de corte formando cinco grupos.
</p>
</div>
<p>Nesse caso teremos a forma√ß√£o de cinco grupos, representados pelos n√≥s que est√£o abaixo da linha de corte. Portanto, o resultado n√£o suporta a nossa hip√≥tese <em>a priori</em> que predizia a forma√ß√£o de apenas dois grupos de esp√©cies.</p>
<p><strong>Exemplo 2</strong></p>
<p>No exemplo anterior, vimos que √© dif√≠cil interpretar os grupos baseado num n√≠vel de corte. A seguir, vamos utilizar o pacote <code>pvclust</code> que . Uma desvantagem deste m√©todo √© que ele somente aceita √≠ndices de similaridade da fun√ß√£o <code><a href="https://rdrr.io/pkg/factoextra/man/dist.html">dist()</a></code>, que possui apenas a dist√¢ncia Euclidiana, Manhattan e Canberra. Uma maneira de contornarmos essa limita√ß√£o √© utilizar transforma√ß√µes dos dados dispon√≠veis na fun√ß√£o <code><a href="https://rdrr.io/pkg/BiodiversityR/man/disttransform.html">disttransform()</a></code> no pacote <code>BiodiversityR</code> ou a fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand()</a></code> do pacote <code>vegan</code>. Tamb√©m √© poss√≠vel utilizar a transforma√ß√£o de Box-Cox para dados multivariados, dispon√≠vel no <a href="http://www.ecography.org/appendix/ecog-03498">material suplementar</a> de Legendre &amp; Borcard <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2018" role="doc-biblioref">2018</a>)</span>. Esta transforma√ß√£o √© geralmente utilizada para tornar a distribui√ß√£o dos dados mais sim√©trica (menos enviesada para valores extremos: reduzir o <em>skewness</em> dos dados).</p>
<p><strong>An√°lises</strong></p>
<p>Vamos utilizar o mesmo conjunto de dados do Exemplo 1 para responder √† mesma pergunta. Aqui vamos utilizar a dist√¢ncia de Chord (que √© indicada para dados de composi√ß√£o de esp√©cies) para calcular a matriz de dist√¢ncia. Se transformarmos uma matriz usando a transforma√ß√£o Chord e depois calcularmos a dist√¢ncia Euclidiana, isso equivale √† calcular diretamente a dist√¢ncia de Chord (Figura <a href="cap9.html#fig:fig-dend-boot-chor">9.3</a>).</p>
<div class="sourceCode" id="cb348"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">sp_compos</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;     Aper Bahe Rict Cleuco Dmic Dmin Hpoly Lfur Pbar Polf Pmelano Sduar Shay Sobt Ssqual Bokerm</span>
<span class="co">#&gt; BP4    0  859 1772      0    0    0    61    3  387    0       0     0    0    0      0      0</span>
<span class="co">#&gt; PP4    3   14 1517      0    0   84   275    0  187    0       0  1150    6    0      0      1</span>
<span class="co">#&gt; PP3    0   14  207      0    6  344   388    0    0    0       0   428    0    0      0      0</span>
<span class="co">#&gt; AP1    0    0  573      0   60 1045  1054    0    0    0       0   476   92   13      0      0</span>
<span class="co">#&gt; AP2    2   87  796      0    4   90  3002    0    0    2       0     7    0    5      0      0</span>
<span class="co">#&gt; PP1    0  312    0      0    0    0   329    0    0    0       0     0    0    0      0      0</span>

<span class="co">## Passo 1: transformar para dist√¢ncia de Chord</span>
<span class="va">bocaina_transf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiodiversityR/man/disttransform.html">disttransform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">sp_compos</span><span class="op">)</span>, <span class="st">"chord"</span><span class="op">)</span>

<span class="co">## Passo 2: realizar pvclust com m√©todo average e dist√¢ncia euclidiana</span>
<span class="va">analise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html">pvclust</a></span><span class="op">(</span><span class="va">bocaina_transf</span>, method.hclust <span class="op">=</span> <span class="st">"average"</span>, method.dist <span class="op">=</span> <span class="st">"euclidean"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 
<span class="co">## Passo 3: dendrograma</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">analise</span>, hang<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Dendrograma com valores de P"</span>, 
     ylab <span class="op">=</span> <span class="st">"Dist√¢ncia Euclideana"</span>,
     xlab<span class="op">=</span><span class="st">""</span>, sub<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pvclust/man/pvpick.html">pvrect</a></span><span class="op">(</span><span class="va">analise</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-dend-boot-chor"></span>
<img src="livro_files/figure-html/fig-dend-boot-chor-1.png" alt="Dendrograma mostrando uma an√°lise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando dist√¢ncia de Chord." width="100%" height="100%"><p class="caption">
Figura 9.3: Dendrograma mostrando uma an√°lise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando dist√¢ncia de Chord.
</p>
</div>
<p>√â poss√≠vel notar que existe um √∫nico grupo com BS &gt; 95%. Agora vamos tentar usar a dist√¢ncia de Hellinger, que √© recomendada (junto com a dist√¢ncia de Chord) para transformar dados de composi√ß√£o de esp√©cies <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2001" role="doc-biblioref">Legendre and Gallagher 2001</a>)</span> (Figura <a href="cap9.html#fig:fig-dend-boot-hell">9.4</a>).</p>
<div class="sourceCode" id="cb349"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Passo 1: transformar dados com Hellinger</span>
<span class="va">bocaina_transf2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiodiversityR/man/disttransform.html">disttransform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">bocaina</span><span class="op">)</span>, <span class="st">"hellinger"</span><span class="op">)</span>

<span class="co">## Passo 2: realizar pvclust com m√©todo average e dist√¢ncia euclidiana</span>
<span class="va">analise2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html">pvclust</a></span><span class="op">(</span><span class="va">bocaina_transf2</span>, method.hclust<span class="op">=</span><span class="st">"average"</span>, method.dist<span class="op">=</span><span class="st">"euclidean"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 

<span class="co">## Passo 3: dendrograma</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">analise2</span>, hang<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Dendrograma com valores de P"</span>, 
     ylab <span class="op">=</span> <span class="st">"Dist√¢ncia Euclideana"</span>,
     xlab<span class="op">=</span><span class="st">""</span>, sub<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">4</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">ncol</a></span><span class="op">(</span><span class="va">sp_compos</span><span class="op">)</span>
<span class="va">MidPoint</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">dendro</span><span class="op">$</span><span class="va">height</span><span class="op">[</span><span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">]</span> <span class="op">+</span> <span class="va">dendro</span><span class="op">$</span><span class="va">height</span><span class="op">[</span><span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">MidPoint</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pvclust/man/pvpick.html">pvrect</a></span><span class="op">(</span><span class="va">analise2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-dend-boot-hell"></span>
<img src="livro_files/figure-html/fig-dend-boot-hell-1.png" alt="Dendrograma mostrando uma an√°lise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando dist√¢ncia de Hellinger." width="100%" height="100%"><p class="caption">
Figura 9.4: Dendrograma mostrando uma an√°lise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando dist√¢ncia de Hellinger.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Notem que se mudarmos o coeficiente de associa√ß√£o, o resultado tamb√©m muda. Agora temos um grupo a mais, composto por <em>Dendropsophus minutus</em> e <em>Scinax duartei</em> que n√£o apareciam antes. Isso se deve ao fato de que a dist√¢ncia de Hellinger d√° menos peso para esp√©cies raras do que a Chord.</p>
<p>Neste sentido, os dados n√£o suportam a nossa hip√≥tese inicial da forma√ß√£o de dois grupos, independentemente do coeficiente de associa√ß√£o utilizado e do c√°lculo automatico do n√≠vel de corte baseado na reamostragem.</p>
</div>
<div id="agrupamento-n√£o-hier√°rquico-k-means" class="section level3" number="9.2.2">
<h3>
<span class="header-section-number">9.2.2</span> Agrupamento n√£o-hier√°rquico (<em>K-means</em>)<a class="anchor" aria-label="anchor" href="#agrupamento-n%C3%A3o-hier%C3%A1rquico-k-means"><i class="fas fa-link"></i></a>
</h3>
<p>Ao contr√°rio do dendrograma, o K-means √© um agrupamento n√£o-hier√°rquico e, desse modo, n√£o √© otimizado para busca grupos menores aninhados em grupos maiores. Resumidamente, podemos calcular o K-means a partir de uma matriz quadrada ou de dist√¢ncia. Essa t√©cnica procura particionar os objetos em <em>k</em> grupos de maneira a minimizar a soma de quadrados entre grupos e maximiz√°-la dentro dos grupos. Um crit√©rio similar ao de uma ANOVA (Cap√≠tulo <a href="cap7.html#cap7">7</a>). Um diferencial do K-means em rela√ß√£o aos agrupamentos hier√°rquicos √© que o usu√°rio pode escolher antecipadamente o n√∫mero de grupos que deseja formar.</p>
<p><strong>Exemplo 1</strong></p>
<p>Para este exemplo, iremos utilizar um conjunto de dados dispon√≠vel no pacote <code>ade4</code> que cont√©m dados de 27 esp√©cies de peixes coletados em 30 pontos ao longo do Rio Doubs, na fronteira entre a Fran√ßa e Su√≠√ßa.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Qual √© o n√∫mero de grupos que melhor sumariza o padr√£o de ocorr√™ncia de esp√©cies de peixes ao longo de um riacho?</li>
</ul>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
Neste caso, estamos realizando uma an√°lise explorat√≥ria e n√£o temos uma predi√ß√£o.</p>
</div>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Vari√°veis resposta: composi√ß√£o de esp√©cies de peixes</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Vamos normalizar os dados de abund√¢ncia antes de entrar na an√°lise propriamente, j√° que existem muitos zeros na matriz</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Vamos iniciar selecionando e padronizando os dados.</p>
<div class="sourceCode" id="cb350"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mostrar somente seis primeiras esp√©cies de seis localidades</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt;   Cogo Satr Phph Neba Thth Teso</span>
<span class="co">#&gt; 1    0    3    0    0    0    0</span>
<span class="co">#&gt; 2    0    5    4    3    0    0</span>
<span class="co">#&gt; 3    0    5    5    5    0    0</span>
<span class="co">#&gt; 4    0    4    5    5    0    0</span>
<span class="co">#&gt; 5    0    2    3    2    0    0</span>
<span class="co">#&gt; 6    0    3    4    5    0    0</span>

<span class="co">## Verificar se existem localidades sem nenhuma ocorr√™ncia</span>
<span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">)</span>
<span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 </span>
<span class="co">#&gt;  3 12 16 21 34 21 16  0 14 14 11 18 19 28 33 40 44 42 46 56 62 72  4 15 11 43 63 70 87 89</span>

<span class="co">## Retirar a linha 8 (rio sem nenhuma ocorr√™ncia de peixe)</span>
<span class="va">spe</span> <span class="op">&lt;-</span> <span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">[</span><span class="op">-</span><span class="fl">8</span>,<span class="op">]</span>

<span class="co">## Fun√ß√£o do pacote vegan para normalizar os dados</span>
<span class="va">spe.norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">spe</span>, method <span class="op">=</span> <span class="st">"normalize"</span><span class="op">)</span> </code></pre></div>
<p>O argumento <code>centers</code> na fun√ß√£o <code><a href="https://rdrr.io/r/stats/kmeans.html">kmeans()</a></code> indica o n√∫mero de grupos que se quer formar. Neste exemplo, estamos utilizando <code>centers = 4</code>.</p>
<div class="sourceCode" id="cb351"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## K-Means</span>
<span class="va">spe.kmeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">spe.norm</span>, centers <span class="op">=</span> <span class="fl">4</span>, nstart <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">spe.kmeans</span>
<span class="co">#&gt; K-means clustering with 4 clusters of sizes 8, 12, 6, 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cluster means:</span>
<span class="co">#&gt;         Cogo        Satr       Phph       Neba        Thth        Teso       Chna       Chto       Lele      Lece</span>
<span class="co">#&gt; 1 0.00000000 0.006691097 0.02506109 0.06987391 0.006691097 0.006691097 0.10687104 0.09377516 0.14194394 0.2011411</span>
<span class="co">#&gt; 2 0.10380209 0.542300691 0.50086515 0.43325916 0.114024105 0.075651573 0.00000000 0.00000000 0.06983991 0.1237394</span>
<span class="co">#&gt; 3 0.06167791 0.122088022 0.26993915 0.35942538 0.032664966 0.135403325 0.06212775 0.21568957 0.25887226 0.2722562</span>
<span class="co">#&gt; 4 0.00000000 0.000000000 0.00000000 0.00000000 0.000000000 0.000000000 0.05205792 0.00000000 0.07647191 0.3166705</span>
<span class="co">#&gt;         Baba      Spbi       Gogo       Eslu       Pefl      Rham       Legi       Scer       Cyca       Titi       Abbr</span>
<span class="co">#&gt; 1 0.24327992 0.1326062 0.28386032 0.20630360 0.16920496 0.2214275 0.19066542 0.13171275 0.16019126 0.26230024 0.19561641</span>
<span class="co">#&gt; 2 0.02385019 0.0000000 0.05670453 0.04722294 0.02949244 0.0000000 0.00000000 0.00000000 0.00000000 0.03833408 0.00000000</span>
<span class="co">#&gt; 3 0.15647062 0.1574388 0.16822286 0.12276089 0.17261621 0.0793181 0.06190283 0.04516042 0.06190283 0.14539027 0.01473139</span>
<span class="co">#&gt; 4 0.00000000 0.0000000 0.20500174 0.07647191 0.00000000 0.0000000 0.05205792 0.07647191 0.00000000 0.00000000 0.00000000</span>
<span class="co">#&gt;        Icme       Acce       Ruru       Blbj      Alal       Anan</span>
<span class="co">#&gt; 1 0.1331835 0.26713081 0.32103755 0.22883055 0.3326939 0.18873077</span>
<span class="co">#&gt; 2 0.0000000 0.00000000 0.01049901 0.00000000 0.0000000 0.00000000</span>
<span class="co">#&gt; 3 0.0000000 0.03192175 0.32201597 0.01473139 0.1095241 0.04739636</span>
<span class="co">#&gt; 4 0.0000000 0.18058775 0.31667052 0.05205792 0.7618709 0.00000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Clustering vector:</span>
<span class="co">#&gt;  1  2  3  4  5  6  7  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 </span>
<span class="co">#&gt;  2  2  2  2  3  2  2  3  2  2  2  2  2  2  3  3  3  3  1  1  1  4  4  4  1  1  1  1  1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Within cluster sum of squares by cluster:</span>
<span class="co">#&gt; [1] 0.4696535 2.5101386 1.7361453 0.3560423</span>
<span class="co">#&gt;  (between_SS / total_SS =  66.7 %)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Available components:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss" "betweenss"    "size"         "iter"        </span>
<span class="co">#&gt; [9] "ifault"</span></code></pre></div>
<p>O objeto que fornece o resultado cont√©m: i) o tamanho (n√∫mero de objetos) em cada um dos 4 grupos, ii) o centroide de cada grupo e o pertencimento de cada esp√©cie a cada grupo, e iii) o quanto da Soma de Quadrados dos dados √© explicada por esta conforma√ß√£o de grupos.</p>
<p>No entanto, n√£o √© poss√≠vel saber <em>a priori</em> qual o n√∫mero ‚Äúideal‚Äù de grupos. Para descobrir isso, repetimos o k-means com uma s√©rie de valores de <strong>K</strong>. Isso pode ser feito na fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/cascadeKM.html">cascadeKM()</a></code>.</p>
<div class="sourceCode" id="cb352"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Repetindo o K-Means</span>
<span class="va">spe.KM.cascade</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cascadeKM.html">cascadeKM</a></span><span class="op">(</span><span class="va">spe.norm</span>, inf.gr <span class="op">=</span> <span class="fl">2</span>, sup.gr <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">100</span>, criterion <span class="op">=</span> <span class="st">"ssi"</span><span class="op">)</span> </code></pre></div>
<p>Tanto <strong>calinski</strong> quando <strong>ssi</strong> s√£o bons crit√©rios para encontrar o n√∫mero ideal de grupos. Quanto maior o valor de <strong>ssi</strong>, melhor (veja <code>?cascadeKM()</code> mais detalhes). Os valores de ssi √© o crit√©rio utilizado pelo algor√≠timo para achar o agrupamento √≥timo dos objetos (Figura <a href="cap9.html#fig:fig-kmeans">9.5</a>).</p>
<div class="sourceCode" id="cb353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Resumo dos resultados</span>
<span class="va">spe.KM.cascade</span><span class="op">$</span><span class="va">results</span>
<span class="co">#&gt;      2 groups  3 groups  4 groups  5 groups   6 groups  7 groups  8 groups  9 groups 10 groups</span>
<span class="co">#&gt; SSE 8.2149405 6.4768108 5.0719796 4.3015573 3.58561200 2.9523667 2.4840549 2.0521888 1.7599292</span>
<span class="co">#&gt; ssi 0.1312111 0.1685126 0.1409061 0.1299662 0.08693436 0.1481826 0.1267918 0.1134307 0.1226392</span>

<span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">spe.KM.cascade</span>, sortg <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-kmeans"></span>
<img src="livro_files/figure-html/fig-kmeans-1.png" alt="Gr√°ficos mostrando os resultados da an√°lise de K-Means." width="100%" height="100%"><p class="caption">
Figura 9.5: Gr√°ficos mostrando os resultados da an√°lise de K-Means.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Diferentemente da nossa predi√ß√£o inicial, o resultado da an√°lise mostra que o n√∫mero ideal de grupos para explicar a vari√¢ncia no padr√£o de ocorr√™ncia de esp√©cies √© 3. Notem que o SSI m√°ximo √© alcan√ßado neste n√∫mero de grupos 0.1685126 (tamb√©m indicado pela bola vermelha no plot).</p>
</div>
<div id="esp√©cies-indicadoras" class="section level3" number="9.2.3">
<h3>
<span class="header-section-number">9.2.3</span> Esp√©cies indicadoras<a class="anchor" aria-label="anchor" href="#esp%C3%A9cies-indicadoras"><i class="fas fa-link"></i></a>
</h3>
<p>Uma pergunta normalmente feita por ec√≥logos √©: qual esp√©cie pode ser indicadora de uma determinada condi√ß√£o ambiental (e.g., polui√ß√£o)?</p>
<p>O √≠ndice IndVal mede dois aspectos das esp√©cies: fidelidade e especificidade. Uma alta fidelidade significa que esp√©cies ocorrem em todos os locais do grupo, e uma alta especificidade significa que as esp√©cies ocorrem somente naquele grupo. Uma boa esp√©cie indicadora √© aquela na qual todos os indiv√≠duos ocorrem em todas a amostras referentes a um grupo espec√≠fico. A especificidade √© dada pela divis√£o da abund√¢ncia m√©dia da esp√©cie no grupo pela somat√≥rio das abund√¢ncias m√©dias dos grupos. Fidelidade √© igual ao n√∫mero de lugares no grupo onde a esp√©cie est√° presente dividido pelo n√∫mero total de lugares do grupo <span class="citation">(<a href="refer%C3%AAncias.html#ref-dufrene_species_1997" role="doc-biblioref">DufreÃÇne and Legendre 1997</a>)</span>.</p>
<p>Esp√©cies raras podem receber o mesmo valor de IndVal das esp√©cies indicadoras, por√©m s√£o chamadas de indicadoras assim√©tricas, uma vez que contribuem com a especificidade do habitat, mas n√£o servem para predizer grupos. Ao contr√°rio, as esp√©cies indicadoras s√£o verdadeiros indicadores sim√©tricos e podem ser usadas para predizer grupos.</p>
<p>A an√°lise procede da seguinte forma:</p>
<ol style="list-style-type: decimal">
<li><p>Uma matriz de dist√¢ncia √© constru√≠da e as unidades amostrais s√£o classificadas com alguma an√°lise de agrupamento, hier√°rquico ou n√£o</p></li>
<li><p>A vari√°vel ambiental para a qual se deseja classificar os grupos √© inserida</p></li>
<li><p>As esp√©cies indicadoreas de cada grupo s√£o formadas atrav√©s do c√°lculo da especificidade e fidelidade, obtendo-se o valor de IndVal para cada esp√©cie</p></li>
<li><p>Por fim, o conjunto de dados originais √© comparado para ver se a an√°lise faz sentido</p></li>
</ol>
<p>O c√°lculo da signific√¢ncia do √≠ndice de IndVal √© feito por aleatoriza√ß√£o de Monte Carlo. Os m√©todos de Monte Carlo utilizam n√∫meros aleat√≥rios de dados reais para simular certos padr√µes esperados na aus√™ncia de um processo ecol√≥gico espec√≠fico <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. Assim, o valor do √≠ndice √© aleatorizado 999 vezes (ou o n√∫mero de vezes que voc√™ optar) dentro dos tratamentos e o valor de <em>P</em> √© dado pelo n√∫mero de vezes em que o √≠ndice observado foi igual ou maior que os valores aleatorizados. Portanto, o IndVal fornece um conjunto de esp√©cies que s√£o indicadoras de um grupo de locais (e.g., muito polu√≠dos), que por sua vez precisam ser definidos utilizando alguma t√©cnica de agrupamento, como as que vimos anteriormente.</p>
<p><strong>Exemplo 1</strong></p>
<p>Para este exemplo, vamos usar o mesmo conjunto de dados utilizado acima com abund√¢ncia de 16 esp√©cies de girinos coletados em 14 po√ßas com diferentes graus de cobertura de dossel na Serra da Bocaina <span class="citation">(<a href="refer%C3%AAncias.html#ref-provete_broad-scale_2014" role="doc-biblioref">Provete et al. 2014</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Podemos utilizar as esp√©cies de girinos como indicadoras da fitofisionomia?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Esp√©cies terrestres ser√£o indicadoras de √°rea aberta, enquanto esp√©cies arbor√≠colas ser√£o indicadoras de √°reas florestais</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Vari√°veis resposta: mesma matriz j√° utilizada contendo a abund√¢ncia de girinos ao longo de po√ßas na Serra da Bocaina</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>O IndVal est√° dispon√≠vel tanto no pacote <code>indicspecies</code>, quando no <code>labdsv</code>. Para este exemplo, iremos usar o <code>labdsv</code>. Primeiro, vamos agrupar as unidades amostrais (po√ßas) que informa os grupos de fitofisionomias onde as po√ßas se localizam e para os quais deseja-se encontrar esp√©cies indicadoras.</p>
<div class="sourceCode" id="cb354"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bocaina</span><span class="op">)</span>
<span class="co">#&gt;         BP4  PP4 PP3  AP1 AP2 PP1 PP2 BP9  PT1 PT2 PT3 BP2 PT5</span>
<span class="co">#&gt; Aper      0    3   0    0   2   0   0   0    0   0   0 181   0</span>
<span class="co">#&gt; Bahe    859   14  14    0  87 312 624 641    0   0   0  14   0</span>
<span class="co">#&gt; Rict   1772 1517 207  573 796   0   0   0    0   0   0   0   0</span>
<span class="co">#&gt; Cleuco    0    0   0    0   0   0   0   0    0  29 369   0  84</span>
<span class="co">#&gt; Dmic      0    0   6   60   4   0   0   0 2758 319  25   0 329</span>
<span class="co">#&gt; Dmin      0   84 344 1045  90   0   0   0    8   0   0   0   0</span>
<span class="va">fitofis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>

<span class="co">## An√°lise de esp√©cies indicadoras</span>
<span class="va">res_indval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/labdsv/man/indval.html">indval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">sp_compos</span><span class="op">)</span>, <span class="va">fitofis</span><span class="op">)</span>

<span class="co"># A fun√ß√£o summary s√≥ exibe o resultado para as esp√©cies indicadoras</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res_indval</span><span class="op">)</span>
<span class="co">#&gt;       cluster indicator_value probability</span>
<span class="co">#&gt; Rict        1          0.8364       0.011</span>
<span class="co">#&gt; Sduar       1          0.7475       0.034</span>
<span class="co">#&gt; Bahe        2          0.6487       0.048</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sum of probabilities                 =  7.984 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sum of Indicator Values              =  7.3 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sum of Significant Indicator Values  =  2.23 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of Significant Indicators     =  3 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Significant Indicator Distribution</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 1 2 </span>
<span class="co">#&gt; 2 1</span></code></pre></div>
<p>Para apresentar uma tabela dos resultados para todas as esp√©cies temos de processar os dados.</p>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Resultados</span>
<span class="va">res_indval</span><span class="op">$</span><span class="va">maxcls</span> <span class="co"># classe de maior valor indicador/esp√©cie </span>
<span class="co">#&gt;    Aper    Bahe    Rict  Cleuco    Dmic    Dmin   Hpoly    Lfur    Pbar    Polf Pmelano   Sduar    Shay    Sobt  Ssqual </span>
<span class="co">#&gt;       3       2       1       3       3       1       2       3       1       3       2       1       3       2       3 </span>
<span class="co">#&gt;  Bokerm </span>
<span class="co">#&gt;       2</span>
<span class="va">res_indval</span><span class="op">$</span><span class="va">indcls</span> <span class="co"># valor indicador (indval)</span>
<span class="co">#&gt;      Aper      Bahe      Rict    Cleuco      Dmic      Dmin     Hpoly      Lfur      Pbar      Polf   Pmelano     Sduar </span>
<span class="co">#&gt; 0.2432796 0.6487329 0.8363823 0.4128631 0.6645244 0.7032145 0.6208711 0.2279412 0.2813725 0.2437500 0.2500000 0.7474527 </span>
<span class="co">#&gt;      Shay      Sobt    Ssqual    Bokerm </span>
<span class="co">#&gt; 0.4930269 0.2222222 0.2500000 0.4583333</span>
<span class="va">res_indval</span><span class="op">$</span><span class="va">pval</span> <span class="co"># signific√¢ncia do indval</span>
<span class="co">#&gt;    Aper    Bahe    Rict  Cleuco    Dmic    Dmin   Hpoly    Lfur    Pbar    Polf Pmelano   Sduar    Shay    Sobt  Ssqual </span>
<span class="co">#&gt;   1.000   0.048   0.011   0.385   0.195   0.101   0.259   1.000   0.624   1.000   1.000   0.034   0.416   0.683   1.000 </span>
<span class="co">#&gt;  Bokerm </span>
<span class="co">#&gt;   0.228</span>
<span class="va">tab_indval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span>maxcls <span class="op">=</span> <span class="va">res_indval</span><span class="op">$</span><span class="va">maxcls</span>,
                               ind.value <span class="op">=</span> <span class="va">res_indval</span><span class="op">$</span><span class="va">indcls</span>,
                               P <span class="op">=</span> <span class="va">res_indval</span><span class="op">$</span><span class="va">pval</span><span class="op">)</span>
<span class="va">tab_indval</span>
<span class="co">#&gt;         maxcls ind.value     P</span>
<span class="co">#&gt; Aper         3 0.2432796 1.000</span>
<span class="co">#&gt; Bahe         2 0.6487329 0.048</span>
<span class="co">#&gt; Rict         1 0.8363823 0.011</span>
<span class="co">#&gt; Cleuco       3 0.4128631 0.385</span>
<span class="co">#&gt; Dmic         3 0.6645244 0.195</span>
<span class="co">#&gt; Dmin         1 0.7032145 0.101</span>
<span class="co">#&gt; Hpoly        2 0.6208711 0.259</span>
<span class="co">#&gt; Lfur         3 0.2279412 1.000</span>
<span class="co">#&gt; Pbar         1 0.2813725 0.624</span>
<span class="co">#&gt; Polf         3 0.2437500 1.000</span>
<span class="co">#&gt; Pmelano      2 0.2500000 1.000</span>
<span class="co">#&gt; Sduar        1 0.7474527 0.034</span>
<span class="co">#&gt; Shay         3 0.4930269 0.416</span>
<span class="co">#&gt; Sobt         2 0.2222222 0.683</span>
<span class="co">#&gt; Ssqual       3 0.2500000 1.000</span>
<span class="co">#&gt; Bokerm       2 0.4583333 0.228</span>

<span class="co">## Esp√©cies</span>
<span class="va">tab_indval</span><span class="op">[</span><span class="va">tab_indval</span><span class="op">$</span><span class="va">P</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="op">]</span>
<span class="co">#&gt;       maxcls ind.value     P</span>
<span class="co">#&gt; Bahe       2 0.6487329 0.048</span>
<span class="co">#&gt; Rict       1 0.8363823 0.011</span>
<span class="co">#&gt; Sduar      1 0.7474527 0.034</span></code></pre></div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>No resultado apresentado, podemos ver que temos duas esp√©cies indicadoras da fitofisionimia 1: <em>Rhinella icterica</em> (Rict) e <em>Scinax duartei</em> (Sduar). Nenhuma esp√©cie foi indicadora dos outros grupos neste exemplo.</p>
</div>
</div>
<div id="an√°lises-de-ordena√ß√£o" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> An√°lises de Ordena√ß√£o<a class="anchor" aria-label="anchor" href="#an%C3%A1lises-de-ordena%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h2>
<p>As an√°lises de ordena√ß√£o representam um conjunto de m√©todos e t√©cnicas multivariadas que organizam objetos (e.g., localidades, indiv√≠duos) em alguma ordem considerando o conjunto de descritores que podem estar mais ou menos relacionados entre si. Se os descritores estiverem bem relacionados, eles s√£o redundantes e organizam os objetos de forma similar. Esse fen√¥meno √© observado, por exemplo, quando queremos organizar um conjunto de unidades amostrais baseado em vari√°veis que indicam um mesmo processo: ver o padr√£o de similaridade geral de lagos usando v√°rias vari√°veis relacionada com a produtividade do sistema: clorofila-a, concentra√ß√£o de f√≥sforo, nitrog√™nio, entre outros. Por exemplo, tais m√©todos permitem identificar se existem grupo de esp√©cies que ocorrem exclusivamente em um determinado h√°bitat. Ao buscar esta <em>ordem</em>, as t√©cnicas de ordena√ß√£o possuem tr√™s principais utilidades: i) reduzir a dimensionalidade e revelar padr√µes, ii) separar as vari√°veis mais e menos importantes em combina√ß√µes complexas e iii) separar rela√ß√µes mais e menos fortes ao comparar vari√°veis preditoras e dependentes.</p>
<p>Em geral, os m√©todos s√£o divid√≠dos em ordena√ß√µes irrestritas (ou an√°lise de gradiente indireto) e restritas (ou an√°lise de gradiente direto). As ordena√ß√µes irrestritas organizam os objetos (e.g., esp√©cies) de acordo com sua estrutura de covari√¢ncia (ou correla√ß√£o), o que demonstra que a proximidade (ou dist√¢ncia) dentro do espa√ßo multidimensional representa semelhan√ßa (ou diferen√ßa) dos objetos. Por outro lado, as ordena√ß√µes restritras posicionam os objetos (e.g., esp√©cies) de acordo com sua rela√ß√£o linear com outras vari√°veis coletadas nas mesmas unidades amostraits (e.g., temperatura e precipita√ß√£o). Ao passo que as ordena√ß√µes irrestritas dependem somente de uma matriz (e.g., esp√©cies por localidades), as ordena√ß√µes restritas utilizam no m√≠nimo duas matrizes (e.g., esp√©cies por localidades e vari√°veis clim√°ticas por localidade). Desse modo, fica claro esta diferen√ßa entre os dados utilizados que as an√°lises irrestritas s√£o mais explorat√≥rias, enquanto an√°lises restritas s√£o ideais para testar hip√≥teses com dados multidimensionais. A tabela a seguir apresenta as principais an√°lises utilizadas em ecologia.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="16%">
<col width="71%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th>M√©todo</th>
<th>Tipo de vari√°vel</th>
<th>Fun√ß√£o R</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Ordena√ß√£o irrestrita</strong></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>PCA</td>
<td>Vari√°veis cont√≠nuas (dist√¢ncia euclidiana)</td>
<td>
<code><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA()</a></code>, <code><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda()</a></code>, <code><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca()</a></code>
</td>
</tr>
<tr class="odd">
<td>PCoA</td>
<td>Aceita qualquer tipo de vari√°vel, mas depende da escolha apropriada de uma medida de dist√¢ncia</td>
<td>
<code><a href="https://rdrr.io/pkg/ape/man/pcoa.html">pcoa()</a></code>, <code><a href="https://rdrr.io/pkg/ade4/man/dudi.pco.html">dudi.pco()</a></code>
</td>
</tr>
<tr class="even">
<td>nMDS</td>
<td>Aceita qualquer tipo de vari√°vel, mas depende da escolha apropriada de uma medida de dist√¢ncia</td>
<td>
<code><a href="https://rdrr.io/pkg/vegan/man/metaMDS.html">metaMDS()</a></code>, <code><a href="https://rdrr.io/pkg/labdsv/man/nmds.html">nmds()</a></code>
</td>
</tr>
<tr class="odd">
<td>CA</td>
<td></td>
<td><code><a href="https://rdrr.io/pkg/ade4/man/dudi.coa.html">dudi.coa()</a></code></td>
</tr>
<tr class="even">
<td>Hill-Smith</td>
<td>Aceita qualquer tipo de vari√°vel</td>
<td><code><a href="https://rdrr.io/pkg/ade4/man/dudi.hillsmith.html">dudi.hillsmith()</a></code></td>
</tr>
<tr class="odd">
<td><strong>Ordena√ß√£o restrita</strong></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>RDA</td>
<td>Vari√°veis preditoras de qualquer tipo e vari√°veis dependentes cont√≠nuas (ou presen√ßa e aus√™ncia)</td>
<td><code><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda()</a></code></td>
</tr>
<tr class="odd">
<td>RDA parcial</td>
<td>Vari√°veis preditoras de qualquer tipo e vari√°veis dependentes cont√≠nuas (ou presen√ßa e aus√™ncia)</td>
<td><code><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda()</a></code></td>
</tr>
<tr class="even">
<td>dbRDA</td>
<td>Vari√°veis preditoras de qualquer tipo e matriz de dist√¢ncia obtida a partir das vari√°veis dependentes</td>
<td>
<code><a href="https://rdrr.io/pkg/vegan/man/capscale.html">capscale()</a></code>, <code><a href="https://rdrr.io/pkg/vegan/man/capscale.html">dbrda()</a></code>
</td>
</tr>
<tr class="odd">
<td>CCA</td>
<td>Vari√°veis preditoras de qualquer tipo e vari√°veis dependentes cont√≠nuas (ou presen√ßa e aus√™ncia)</td>
<td><code><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda()</a></code></td>
</tr>
<tr class="even">
<td>PERMANOVA</td>
<td>Vari√°veis preditoras de qualquer tipo e matriz de dist√¢ncia obtida a partir das vari√°veis dependentes</td>
<td>
<code><a href="https://rdrr.io/pkg/vegan/man/adonis.html">adonis()</a></code>, <code><a href="https://rdrr.io/pkg/vegan/man/adonis.html">adonis2()</a></code>
</td>
</tr>
<tr class="odd">
<td>PCR</td>
<td>Vari√°vel dependente necessariamente representada por escores da PCA ou PCoA e vari√°veis preditoras de qualquer tipo</td>
<td>
<code><a href="https://rdrr.io/pkg/labdsv/man/pca.html">pca()</a></code>, <code><a href="https://rdrr.io/pkg/ape/man/pcoa.html">pcoa()</a></code>, <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="ordena√ß√£o-irrestrira" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Ordena√ß√£o irrestrira<a class="anchor" aria-label="anchor" href="#ordena%C3%A7%C3%A3o-irrestrira"><i class="fas fa-link"></i></a>
</h2>
<p>Ordena√ß√µes irrestritas, ou an√°lise de gradiente indireto ou ainda an√°lises de fator, s√£o um conjunto de m√©todos multivariados que lidam com uma √∫nica matriz quadrada. Esta matriz pode ou n√£o ter pesos nas linhas ou colunas. Geralmente, o objetivo deste tipo de an√°lise √© resumir a informa√ß√£o contida na matriz de maneira gr√°fica, por meio de um diagrama de ordena√ß√£o. Quanto maior e mais complexa for a matriz, mais eficiente √© este tipo de an√°lise. Os tipos de an√°lise ir√£o diferir de acordo com o tipo de dado contido nesta matriz, se cont√≠nuo ou contagem, etc. De maneira geral, essas ordena√ß√µes irrestritas calculam combina√ß√µes lineares, cuja formula√ß√£o ir√° diferir ligeiramente entre os m√©todos. Da mesma forma, essas combina√ß√µes lineares ir√£o preservar um tipo de dist√¢ncia. Por exemplo, a An√°lise de Componentes Principais preserva a dist√¢ncia Euclidiana, enquanto a An√°lise de Correspond√™ncia preserva a dist√¢ncia de chi-quadrado.</p>
<div id="an√°lise-de-componentes-principais-pca" class="section level3" number="9.4.1">
<h3>
<span class="header-section-number">9.4.1</span> An√°lise de Componentes Principais (PCA)<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-componentes-principais-pca"><i class="fas fa-link"></i></a>
</h3>
<p>A An√°lise de Componentes Principais (<em>Principal Component Analysis</em> - PCA) √© uma das ordena√ß√µes mais utilizadas em diversas √°reas do conhecimento. Em Ecologia, ela se popularizou por facilitar a visualiza√ß√£o de dados complexos como de distribui√ß√£o de esp√©cies em diferentes localidades e de potenciais vari√°veis explicativas. Ao mesmo tempo que ganhou tamanha popularidade, a PCA tem sido empregada de maneira incorreta, uma vez que muitos estudos utilizam a visualiza√ß√£o gr√°fica da ordena√ß√£o (o biplot) para intepretar ‚Äúrela√ß√µes‚Äù entre vari√°veis preditoras (ambientais) e dependentes (esp√©cies). Por√©m, como informado anteriormente, as ordena√ß√µes irrestritas utilizam a estrutura de covari√¢ncia dos objetos para organizar suas rela√ß√µes de similaridade.</p>
<p>Antes de explicar a an√°lise, imagine que vamos usar uma matriz com cinco esp√©cies de aranhas que foram encontradas em oito cidades diferentes. A quantidade de indiv√≠duos de cada esp√©cie coletada em cada cidade ser√° o valor de preenchimento desta matriz. Sendo assim, a matriz possui oito objetos (cidades, representando unidades amostrais) e cinco descritores (esp√©cies), como na Tabela <a href="cap9.html#tab:tab-pca-dados">9.1</a>.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:tab-pca-dados">Tabela 9.1: </span>Matriz com cinco esp√©cies de aranhas que foram encontradas em oito cidades diferentes.
</caption>
<thead><tr>
<th style="text-align:center;">
Cidade
</th>
<th style="text-align:center;">
Esp√©cie.1
</th>
<th style="text-align:center;">
Esp√©cie.2
</th>
<th style="text-align:center;">
Esp√©cie.3
</th>
<th style="text-align:center;">
Esp√©cie.4
</th>
<th style="text-align:center;">
Esp√©cie.5
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Cidade 1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 2
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 3
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 4
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 5
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 6
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
6
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 7
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
9
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 8
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
12
</td>
</tr>
</tbody>
</table></div>
<p>O primeiro passo da PCA √© obter uma matriz centralizada, onde cada valor √© subtra√≠do da m√©dia da coluna que aquele valor pertence. Esta centraliza√ß√£o pode ser calculada com a fun√ß√£o <code><a href="https://rdrr.io/pkg/raster/man/scale.html">scale()</a></code>.</p>
<div class="sourceCode" id="cb356"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="va">aranhas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    sp1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
    sp2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
    sp3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">9</span>, <span class="fl">12</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
    sp4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">10</span>, <span class="fl">8</span>, <span class="fl">0</span><span class="op">)</span>,
    sp5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">12</span><span class="op">)</span>,
    row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"cidade"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Centraliza√ß√£o</span>
<span class="va">aranha.cent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">aranhas</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>O segundo passo √© calcular uma matriz de covari√¢ncia (ou matriz de dispers√£o) e, a partir desta matriz, obter os autovalores e autovetores. Os autovalores representam a porcentagem de explica√ß√£o de cada eixo e podem ser calculados dividindo a soma do autovalor de cada eixo pela soma de todos os autovalores. No exemplo que apresentamos, os dois primeiros eixos representam 47,20% e 35,01% de toda varia√ß√£o, respectivamente. Os autovetores, por sua vez, representam os valores que multiplicam as vari√°veis originais e, desse modo, indicam a dire√ß√£o desses valores. Por fim, os componentes principais (Matriz F) s√£o obtidos multiplicando os autovetores com os valores da matriz centralizada.</p>
<div class="sourceCode" id="cb357"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Matriz de covai√¢ncia</span>
<span class="va">matriz_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">aranha.cent</span><span class="op">)</span>

<span class="co">## Autovalores e autovetores</span>
<span class="va">eigen_aranhas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">matriz_cov</span><span class="op">)</span>
<span class="va">autovalores</span> <span class="op">&lt;-</span> <span class="va">eigen_aranhas</span><span class="op">$</span><span class="va">values</span>
<span class="va">autovetores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">eigen_aranhas</span><span class="op">$</span><span class="va">vectors</span><span class="op">)</span>
<span class="va">autovalores</span> <span class="co"># eigenvalue</span>
<span class="co">#&gt; [1] 36.733031 27.243824  9.443805  2.962749  1.438020</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">autovetores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"PC"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">autovetores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">aranhas</span><span class="op">)</span>
<span class="va">autovetores</span>
<span class="co">#&gt;            PC1         PC2         PC3         PC4        PC5</span>
<span class="co">#&gt; sp1 -0.2144766  0.38855265  0.29239380 -0.02330706  0.8467522</span>
<span class="co">#&gt; sp2 -0.2442026  0.17463316  0.01756743  0.94587037 -0.1220204</span>
<span class="co">#&gt; sp3 -0.3558368 -0.80222917 -0.27591770  0.10991178  0.3762942</span>
<span class="co">#&gt; sp4  0.4159852 -0.41786654  0.78820962  0.17374202  0.0297183</span>
<span class="co">#&gt; sp5  0.7711688  0.01860152 -0.46560957  0.25003826  0.3544591</span>

<span class="co">## Componentes principais</span>
<span class="va">matriz_F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">aranha.cent</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">autovetores</span><span class="op">)</span><span class="op">)</span>
<span class="va">matriz_F</span>
<span class="co">#&gt;               PC1        PC2        PC3        PC4        PC5</span>
<span class="co">#&gt; cidade1 -2.979363  4.4720575  1.1533417 -3.2641923  0.5433206</span>
<span class="co">#&gt; cidade2 -4.873532  6.2969618  1.8435339  2.3644158  1.5047024</span>
<span class="co">#&gt; cidade3 -3.068541  3.8302991  0.3288626 -0.3566600 -2.3629973</span>
<span class="co">#&gt; cidade4 -6.086322 -3.9922356 -2.7216169  1.6250305 -0.7918743</span>
<span class="co">#&gt; cidade5 -4.513082 -8.7689219 -0.4668012 -1.1337476  0.9439633</span>
<span class="co">#&gt; cidade6  5.812374 -3.9444494  3.9520584  0.4197281 -0.1376205</span>
<span class="co">#&gt; cidade7  8.361421 -0.6462243  1.8065636  0.4926235 -0.2625625</span>
<span class="co">#&gt; cidade8  7.347046  2.7525126 -5.8959421 -0.1471979  0.5630683</span>

<span class="co">## Porcentagem de explica√ß√£o de cada eixo</span>
<span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">autovalores</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">autovalores</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 47.201691 35.008126 12.135225  3.807112  1.847846</span></code></pre></div>
<p>Agora, √© poss√≠vel visualizar a rela√ß√£o entre as cidades e similaridade na esp√©cies de aranhas que vivem em cada uma delas (Figura <a href="cap9.html#fig:fig-pca">9.6</a>).</p>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">matriz_F</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="va">PC2</span>, label <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">matriz_F</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pca"></span>
<img src="livro_files/figure-html/fig-pca-1.png" alt="Biplot da PCA ordenando as cidades pela composi√ß√£o das esp√©cies de aranhas." width="100%" height="100%"><p class="caption">
Figura 9.6: Biplot da PCA ordenando as cidades pela composi√ß√£o das esp√©cies de aranhas.
</p>
</div>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Verifique se todas as vari√°veis utilizadas s√£o cont√≠nuas. Caso contr√°rio, considere utilizar PCoA (veja mais no pr√≥ximo t√≥pico)</p></li>
<li><p>Apesar do exemplo acima ter apresentado a ocorr√™ncia de esp√©cies de aranhas em diferentes cidades, √© fundamental saber que utilizar a PCA com esses dados pode ser problem√°tico. Assim, tenha cuidado em usar dados de composi√ß√£o de esp√©cies, especialmente abund√¢ncia, com PCA, uma vez que ‚Äòduplos zeros‚Äô podem gerar distor√ß√µes na ordena√ß√£o <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. Como alternativa, √© poss√≠vel utilizar PCA com dados padronizados com o m√©todo de Hellinger <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2001" role="doc-biblioref">Legendre and Gallagher 2001</a>)</span>.</p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo vamos utilizar um conjunto de dados morfol√≥gicos de pinguins do arquip√©lago Palmer (Pen√≠nsula Ant√°rtica) dispon√≠veis no pacote ‚Äòpalmerpenguins.‚Äô Os dados representam medidas do comprimento e largura do bico (mm), comprimento da nadadeira (mm) e massa corporal (gramas) de tr√™s esp√©cies: Ad√©lie, Chinstrap e Gentoo. Como descrito acima, a PCA deve ser utilizada para explora√ß√£o de dados ou para testes <em>a posteriori</em> (e.g., Regress√£o de Componentes Principais - PCR, t√≥pico explorado mais a frente nesse cap√≠tulo). Neste exemplo, iremos usar a estrutura de perguntas e predi√ß√µes para manter a proposta do livro.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existe diferen√ßas nas caracter√≠sticas morfol√≥gicas das esp√©cies de pinguins do arquip√©lago Palmer?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Pinguins com dieta diferente possuem diferentes caracter√≠sticas morfol√≥gicas</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Preditora: esp√©cie (categ√≥rica com tr√™s n√≠veis)</li>
<li>Dependentes: vari√°veis morfol√≥gicas (cont√≠nua)</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Antes de come√ßar, √© necess√°rio remover dados ausentes (se houver) e editar nomes das vari√°veis (ponto importante para determinar como devem aparecer no gr√°fico).</p>
<div class="sourceCode" id="cb359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Verificar se existem NAs nos dados</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 19</span>

<span class="co">## Remover dados ausentes (NA), quando houver</span>
<span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span>

<span class="co">## Manter somentes dados cont√≠nuos que pretende aplicar a PCA</span>
<span class="va">penguins_trait</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></code></pre></div>
<p>Agora sim, os dados est√£o prontos para fazer a PCA. Um argumento √© essencial na an√°lise, o <code>scale.unit</code>. Se voc√™ utilizar dentro deste argumento o sele√ß√£o <code>TRUE</code>, a fun√ß√£o padroniza automaticamente as vari√°veis para terem a m√©dia 0 e vari√¢ncia 1. Esta padroniza√ß√£o √© essencial quando as vari√°veis est√£o em escalas muito diferentes. No exemplo selecionado, temos vari√°veis como comprimento do bico (em mil√≠metros) e massa corporal (em gramas).</p>
<div class="sourceCode" id="cb360"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Compare com este c√≥digo a vari√¢ncia das vari√°veis</span>
<span class="va">penguins_trait</span> <span class="op"><a href="https://ggobi.github.io/ggally/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, 
                            <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 √ó 4</span>
<span class="co">#&gt;   comprimento_bico profundidade_bico comprimento_nadadeira massa_corporal</span>
<span class="co">#&gt;              &lt;dbl&gt;             &lt;dbl&gt;                 &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1             29.9              3.88                  196.        648372.</span>

<span class="co">## Agora, veja o mesmo c√°lculo se fizer a padroniza√ß√£o (scale.unit da fun√ß√£o PCA)</span>
<span class="va">penguins_pad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">penguins_trait</span>, method <span class="op">=</span> <span class="st">"standardize"</span><span class="op">)</span>
<span class="va">penguins_pad</span> <span class="op"><a href="https://ggobi.github.io/ggally/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, 
                            <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   comprimento_bico profundidade_bico comprimento_nadadeira massa_corporal</span>
<span class="co">#&gt; 1                1                 1                     1              1</span>

<span class="co">## PCA</span>
<span class="va">pca.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">penguins_trait</span>, scale.unit <span class="op">=</span> <span class="cn">TRUE</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Apesar da simplicidade do c√≥digo para executar a PCA, o objeto resultante da an√°lise possui diversas informa√ß√µes que s√£o essenciais para sua plena interpreta√ß√£o. Dentre elas, se destacam os autovalores, escores e cargas (<em>loadings</em>). Os autovalores representam a porcentagem de explica√ß√£o de cada eixo. Os escores representam as coordenadas (posi√ß√µes no espa√ßo multidimensional) representando os objetos (geralmente localidades ou indiv√≠duos) e descritores (geralmente esp√©cies ou vari√°veis ambientais e espaciais). Os <em>loadings</em>, por sua vez, representam a combina√ß√£o linear entre os escores (nova posi√ß√£o do valor do descritor no espa√ßo ordenado) e os valores originais dos descritores (Figura <a href="cap9.html#fig:fig-pca-scree">9.7</a>).</p>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Autovalores: porcentagem de explica√ß√£o para usar no gr√°fico</span>
<span class="va">pca.p</span><span class="op">$</span><span class="va">eig</span> 
<span class="co">#&gt;        eigenvalue percentage of variance cumulative percentage of variance</span>
<span class="co">#&gt; comp 1  2.7453557              68.633893                          68.63389</span>
<span class="co">#&gt; comp 2  0.7781172              19.452929                          88.08682</span>
<span class="co">#&gt; comp 3  0.3686425               9.216063                          97.30289</span>
<span class="co">#&gt; comp 4  0.1078846               2.697115                         100.00000</span>

<span class="co">## Visualiza√ß√£o da porcentagem de explica√ß√£o de cada eixo</span>
<span class="co"># nota: √© necess√°rio ficar atento ao valor m√°ximo do eixo 1 da an√°lise para determinar o valor do ylim (neste caso, colocamos que o eixo varia de 0 a 70).</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">fviz_screeplot</a></span><span class="op">(</span><span class="va">pca.p</span>, addlabels <span class="op">=</span> <span class="cn">TRUE</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">70</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, 
               xlab <span class="op">=</span> <span class="st">"Dimens√µes"</span>,
               ylab <span class="op">=</span> <span class="st">"Porcentagem de vari√¢ncia explicada"</span><span class="op">)</span> 
<span class="co">## Outros valores importantes</span>
<span class="va">var_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_var</a></span><span class="op">(</span><span class="va">pca.p</span><span class="op">)</span>

<span class="co">## Escores (posi√ß√£o) das vari√°veis em cada eixo</span>
<span class="va">var_env</span><span class="op">$</span><span class="va">coord</span> 
<span class="co">#&gt;                            Dim.1      Dim.2      Dim.3       Dim.4</span>
<span class="co">#&gt; comprimento_bico       0.7518288 0.52943763 -0.3900969 -0.04768208</span>
<span class="co">#&gt; profundidade_bico     -0.6611860 0.70230869  0.2585287  0.05252186</span>
<span class="co">#&gt; comprimento_nadadeira  0.9557480 0.00510580  0.1433474  0.25684871</span>
<span class="co">#&gt; massa_corporal         0.9107624 0.06744932  0.3592789 -0.19204478</span>

<span class="co">## Contribui√ß√£o (%) das vari√°veis para cada eixo</span>
<span class="va">var_env</span><span class="op">$</span><span class="va">contrib</span> 
<span class="co">#&gt;                          Dim.1        Dim.2     Dim.3     Dim.4</span>
<span class="co">#&gt; comprimento_bico      20.58919 36.023392267 41.279994  2.107420</span>
<span class="co">#&gt; profundidade_bico     15.92387 63.388588337 18.130600  2.556942</span>
<span class="co">#&gt; comprimento_nadadeira 33.27271  0.003350291  5.574092 61.149849</span>
<span class="co">#&gt; massa_corporal        30.21423  0.584669105 35.015313 34.185789</span>

<span class="co">## Loadings - correla√ß√£o das vari√°veis com os eixos</span>
<span class="va">var_env</span><span class="op">$</span><span class="va">cor</span> 
<span class="co">#&gt;                            Dim.1      Dim.2      Dim.3       Dim.4</span>
<span class="co">#&gt; comprimento_bico       0.7518288 0.52943763 -0.3900969 -0.04768208</span>
<span class="co">#&gt; profundidade_bico     -0.6611860 0.70230869  0.2585287  0.05252186</span>
<span class="co">#&gt; comprimento_nadadeira  0.9557480 0.00510580  0.1433474  0.25684871</span>
<span class="co">#&gt; massa_corporal         0.9107624 0.06744932  0.3592789 -0.19204478</span>

<span class="co">## Qualidade da representa√ß√£o da vari√°vel. Esse valor √© obtido multiplicado var_env$coord por var_env$coord</span>
<span class="va">var_env</span><span class="op">$</span><span class="va">cos2</span>
<span class="co">#&gt;                           Dim.1        Dim.2      Dim.3       Dim.4</span>
<span class="co">#&gt; comprimento_bico      0.5652466 2.803042e-01 0.15217561 0.002273581</span>
<span class="co">#&gt; profundidade_bico     0.4371669 4.932375e-01 0.06683710 0.002758546</span>
<span class="co">#&gt; comprimento_nadadeira 0.9134542 2.606919e-05 0.02054847 0.065971260</span>
<span class="co">#&gt; massa_corporal        0.8294881 4.549411e-03 0.12908133 0.036881196</span>

<span class="co">## Escores (posi√ß√£o) das localidades ("site scores") em cada eixo </span>
<span class="va">ind_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_ind</a></span><span class="op">(</span><span class="va">pca.p</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pca-scree"></span>
<img src="livro_files/figure-html/fig-pca-scree-1.png" alt="Scree plot mostrando a porcentagem de contribui√ß√£o de cada eixo para a ordena√ß√£o dos dados de penguins." width="100%" height="100%"><p class="caption">
Figura 9.7: Scree plot mostrando a porcentagem de contribui√ß√£o de cada eixo para a ordena√ß√£o dos dados de penguins.
</p>
</div>
<p>O pacote <code>FactoMineR</code> criou uma fun√ß√£o (<code><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc()</a></code>) que seleciona as melhores vari√°veis (aquelas mais explicativas) para cada eixo atrav√©s de uma an√°lise fatorial. No exemplo com pinguins, o primeiro eixo (objeto <code>pca.p$eig</code>) explica ~69% da varia√ß√£o morfol√≥gica. A fun√ß√£o <code><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc()</a></code> mostra que as quatro vari√°veis morfol√≥gicas est√£o fortemente associadas com o eixo 1. Por√©m, enquanto comprimento da nadadeira, massa corporal e comprimento do bico est√£o positivamente associados com o eixo 1 (correla√ß√£o positiva), a largura do bico tem rela√ß√£o negativa. O eixo 2, por sua vez, explica ~20% da varia√ß√£o, sendo relacionado somente com largura e comprimento do bico.</p>
<div class="sourceCode" id="cb362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Vari√°veis mais importantes para o Eixo 1</span>
<span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc</a></span><span class="op">(</span><span class="va">pca.p</span><span class="op">)</span><span class="op">$</span><span class="va">Dim.1</span> 
<span class="co">#&gt; $quanti</span>
<span class="co">#&gt;                       correlation       p.value</span>
<span class="co">#&gt; comprimento_nadadeira   0.9557480 5.962756e-178</span>
<span class="co">#&gt; massa_corporal          0.9107624 3.447018e-129</span>
<span class="co">#&gt; comprimento_bico        0.7518288  7.830597e-62</span>
<span class="co">#&gt; profundidade_bico      -0.6611860  3.217695e-43</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "condes" "list"</span>

<span class="co">## Vari√°veis mais importantes para o Eixo 2</span>
<span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc</a></span><span class="op">(</span><span class="va">pca.p</span><span class="op">)</span><span class="op">$</span><span class="va">Dim.2</span> 
<span class="co">#&gt; $quanti</span>
<span class="co">#&gt;                   correlation      p.value</span>
<span class="co">#&gt; profundidade_bico   0.7023087 8.689230e-51</span>
<span class="co">#&gt; comprimento_bico    0.5294376 1.873918e-25</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "condes" "list"</span></code></pre></div>
<p>Agora podemos utilizar o famoso <strong>biplot</strong> para representar a compara√ß√£o morfol√≥gica dos pinguins dentro e entre esp√©cies (Figura <a href="cap9.html#fig:fig-pca-biplot">9.8</a>).</p>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_biplot</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">pca.p</span>, 
                geom.ind <span class="op">=</span> <span class="st">"point"</span>, 
                fill.ind <span class="op">=</span> <span class="va">penguins</span><span class="op">$</span><span class="va">especies</span>, 
                col.ind <span class="op">=</span> <span class="st">"black"</span>,
                alpha.ind <span class="op">=</span> <span class="fl">0.7</span>,
                pointshape <span class="op">=</span> <span class="fl">21</span>, 
                pointsize <span class="op">=</span> <span class="fl">4</span>,
                palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"darkorchid"</span>, <span class="st">"cyan4"</span><span class="op">)</span>,
                col.var <span class="op">=</span> <span class="st">"black"</span>,
                invisible <span class="op">=</span> <span class="st">"quali"</span>,
                title <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"PC1 (68.63%)"</span>, y <span class="op">=</span> <span class="st">"PC2 (19.45%)"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pca-biplot"></span>
<img src="livro_files/figure-html/fig-pca-biplot-1.png" alt="Biplot da PCA ordenando os dados morfol√≥gicos de penguins." width="100%" height="100%"><p class="caption">
Figura 9.8: Biplot da PCA ordenando os dados morfol√≥gicos de penguins.
</p>
</div>
</div>
<div id="an√°lises-de-coordenadas-principais-pcoa" class="section level3" number="9.4.2">
<h3>
<span class="header-section-number">9.4.2</span> An√°lises de Coordenadas Principais (PCoA)<a class="anchor" aria-label="anchor" href="#an%C3%A1lises-de-coordenadas-principais-pcoa"><i class="fas fa-link"></i></a>
</h3>
<p>Diferentemente da PCA, a An√°lises de Coordenadas Principais (<em>Principal Coordinate Analysis</em> - PCoA) √© uma an√°lise de ordena√ß√£o irrestrita que aceita dados de diferentes tipos, como cont√≠nuos, categ√≥ricos, ordinais, bin√°rios, entre outros. Assim, a PCoA √© aplicada para casos em que a dist√¢ncia euclidiana n√£o √© aplicada (como na PCA). Desse modo, o primeiro passo da an√°lise √© calcular uma matriz de similaridade ou de dist√¢ncia (discutido acima). Depois, os passos para obter autovalores e autovetores s√£o bastante parecidos com a PCA. Da mesma forma, os eixos da PCoA e os valores ou posi√ß√µes dos objetos nesses eixos representam a rela√ß√£o de semelhan√ßa (ou diferen√ßa) baseada nos descritores desses objetos. A diferen√ßa, neste caso, √© que a PCoA representa um espa√ßo n√£o-euclidiano, que ir√° ser afetado pela escolha do m√©todo de similaridade.</p>
<p>As utiliza√ß√µes mais comuns da PCoA s√£o a ordena√ß√£o: i) da matriz de composi√ß√£o de esp√©cies usando a dist√¢ncia apropriada (Jaccard, Sorensen, Bray-Curtis), ii) da matriz de vari√°veis ambientais com mistos (cont√≠nuos, categ√≥ricos, circulares, etc.), e iii) da matriz filogen√©tica <span class="citation">(m√©todo PVR <a href="refer%C3%AAncias.html#ref-diniz-filho_eigenvector_1998" role="doc-biblioref">Diniz-Filho, de Sant‚ÄôAna, and Bini 1998</a>)</span>. Abaixo, exemplificamos a ordena√ß√£o da matriz de composi√ß√£o de esp√©cies.</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Compare as dimens√µes das matrizes utilizadas para a PCoA. Com bastante frequ√™ncia, a tentativa de combinar dados categ√≥ricos (algum descritor dos objetos) com os valores obtidos com a PCoA gera erros para plotar a figura ou para executar a an√°lise. Verifique, ent√£o, se as linhas s√£o as mesmas (nome das localidades ou indiv√≠duos e quantidade)</p></li>
<li><p>√â fundamental conhecer o tipo de dados que est√° usando para selecionar a medida de dist√¢ncia apropriada. Essa escolha vai afetar a qualidade da ordena√ß√£o e sua habilidade para interpretar a rela√ß√£o de semelhan√ßa entre os objetos comparados</p></li>
<li><p>Diferente da PCA, a PCoA aceita dados ausentes se a medida de dist√¢ncia escolhida tamb√©m n√£o tiver esta limita√ß√£o. Por exemplo, a dist√¢ncia de Gower produz matrizes de similaridade mesmo com dados ausentes em determinados objetos</p></li>
<li><p>Em alguns casos, autovalores negativos s√£o produzidos na ordena√ß√£o com PCoA. Veja as principais causas desses valores em Legendre &amp; Legendre <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">2012</a>)</span>. Apesar deste problema, os autovalores mais importantes (eixos iniciais) n√£o s√£o afetados e, deste modo, a qualidade da representa√ß√£o dos objetos no espa√ßo multidimensional n√£o √© afetada. Alguns autores sugerem utilizar corre√ß√µes m√©todos de corre√ß√£o, como Lingoes ou Cailliez <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>.</p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar a composi√ß√£o de √°caros Oribatidae em 70 manchas de musgo coletados por Borcard et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-borcard_partialling_1992" role="doc-biblioref">1992</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>A composi√ß√£o de esp√©cies de √°caros muda entre diferentes topografias?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Iremos encontrar ao menos dois grupos de esp√©cies: aquelas que ocorrem em po√ßas dentro de floresta <em>versus</em> aquelas que ocorrem em po√ßas de √°reas abertas</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Preditora: topografia (categ√≥rica com dois n√≠veis)</li>
<li>Dependentes: composi√ß√£o de esp√©cies de √°caro</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Vamos primeramente padronizar dos dados, calcular uma matriz de dist√¢ncia com m√©todo Bray-Curtis e depois calcular a PCoA.</p>
<div class="sourceCode" id="cb364"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Padroniza√ß√£o dos dados com Hellinger</span>
<span class="va">mite.hel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mite</span>, method <span class="op">=</span> <span class="st">"hellinger"</span><span class="op">)</span> 

<span class="co">## C√°lculo da matriz de dist√¢ncia com m√©todo Bray-Curtis</span>
<span class="va">sps.dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mite.hel</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span> 

<span class="co">## PCoA</span>
<span class="va">pcoa.sps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/pcoa.html">pcoa</a></span><span class="op">(</span>D <span class="op">=</span> <span class="va">sps.dis</span>, correction <span class="op">=</span> <span class="st">"cailliez"</span><span class="op">)</span></code></pre></div>
<p>Assim como na PCA, a porcentagem de explica√ß√£o dos eixos √© uma das informa√ß√µes mais importantes pois descrevem a efetividade da redu√ß√£o da dimensionalidade dos dados.</p>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Porcentagem de explica√ß√£o do Eixo 1</span>
<span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">pcoa.sps</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">pcoa.sps</span><span class="op">$</span><span class="va">trace</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] 49.10564</span>

<span class="co">## Porcentagem de explica√ß√£o dos Eixo 2</span>
<span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">pcoa.sps</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">pcoa.sps</span><span class="op">$</span><span class="va">trace</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; [1] 14.30308</span>

<span class="co">## Porcentagem de explica√ß√£o acumulada dos dois primeiros eixos </span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">pcoa.sps</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">pcoa.sps</span><span class="op">$</span><span class="va">trace</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 63.40872</span>

<span class="co">## Selecionar os dois primeiros eixos</span>
<span class="va">eixos</span> <span class="op">&lt;-</span> <span class="va">pcoa.sps</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>

<span class="co">## Juntar com algum dado categ√≥rico de interesse para fazer a figura</span>
<span class="va">pcoa.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>topografia <span class="op">=</span> <span class="va">mite.env</span><span class="op">$</span><span class="va">Topo</span>, <span class="va">eixos</span><span class="op">)</span></code></pre></div>
<p>Para visualizar os resultados da PCoA, vamos exportar os escores dos eixos para usar no pacote <code>ggplot2</code> (Figura <a href="cap9.html#fig:fig-pcoa-biplot">9.9</a>).</p>
<div class="sourceCode" id="cb366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Escores dos dois primeiros eixos</span>
<span class="va">eixos</span> <span class="op">&lt;-</span> <span class="va">pcoa.sps</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> 

<span class="co">## Combinar dados dos escores com um dado categ√≥rico de interesse para nossa pergunta</span>
<span class="va">pcoa.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>topografia <span class="op">=</span> <span class="va">mite.env</span><span class="op">$</span><span class="va">Topo</span>, <span class="va">eixos</span><span class="op">)</span>

<span class="co">### Gr√°fico biplot da PCoA</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pcoa.dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Axis.1</span>, y <span class="op">=</span> <span class="va">Axis.2</span>, fill <span class="op">=</span> <span class="va">topografia</span>, 
                     color <span class="op">=</span> <span class="va">topografia</span>, shape <span class="op">=</span> <span class="va">topografia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">22</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"PCO 1 (49.11%)"</span>, y <span class="op">=</span> <span class="st">"PCO 2 (14.30%)"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pcoa-biplot"></span>
<img src="livro_files/figure-html/fig-pcoa-biplot-1.png" alt="Biplot da PCoA ordenando as esp√©cies de √°caros entre diferentes topografias." width="100%" height="100%"><p class="caption">
Figura 9.9: Biplot da PCoA ordenando as esp√©cies de √°caros entre diferentes topografias.
</p>
</div>
<p><strong>Limita√ß√µes importantes das ordena√ß√µes irrestritas</strong></p>
<p>Com frequ√™ncia, pesquisadores utilizam an√°lises como PCA e PCoA para ‚Äútestar‚Äù diferen√ßas na composi√ß√£o de esp√©cies entre determinados fatores relevantes (altitude, clima, etc.). Por√©m, como falado acima, as an√°lises de ordena√ß√£o irrestritas n√£o s√£o utilizadas para testar qualquer hip√≥tese. Ao inv√©s disso, essas an√°lises representam uma poderosa ferramente para explorar padr√µes em vari√°veis dependentes ou independentes para ajudar na interpreta√ß√£o ou mesmo para testar hip√≥teses em an√°lises combinadas com as ordena√ß√µes restritas.</p>
</div>
<div id="regress√£o-de-componentes-principais-pcr" class="section level3" number="9.4.3">
<h3>
<span class="header-section-number">9.4.3</span> Regress√£o de Componentes Principais (PCR)<a class="anchor" aria-label="anchor" href="#regress%C3%A3o-de-componentes-principais-pcr"><i class="fas fa-link"></i></a>
</h3>
<p>Uma maneira de testar hip√≥teses utilizando ordena√ß√µes irrestritas √© utilizando os resultados da ordena√ß√£o (escores) como vari√°veis preditoras ou dependentes como, por exemplo, em modelos lineares (e.g., regress√£o m√∫ltipla Cap√≠tulo <a href="cap7.html#cap7">7</a>). O primeiro passo √© utilizar uma ordena√ß√£o, como a PCA, para gerar os ‚Äúnovos‚Äù dados que ser√£o usados na an√°lise. A utiliza√ß√£o desses novos dados (que representam as coordenadas principais ou escores da PCA) vai depender da pergunta em quest√£o. Por exemplo, pode ser que esses valores representem gradientes clim√°ticos e, por este motivo, ser√£o utilizados como vari√°veis preditoras em um modelo linear (e.g., regress√£o m√∫ltipla). Por outro lado, esses valores podem representar o espa√ßo morfol√≥gicos de esp√©cies de peixes e, como consequ√™ncia, ser√£o utilizados como vari√°veis dependentes para entender o efeito da presen√ßa de predador sobre a morfologia. √â importante ressaltar que existem algumas limita√ß√µes importantes na PCR como, por exemplo, as coordenadas principais (escores da PCA) utilizadas como vari√°veis preditoras podem n√£o representam, biologicamente, as mais importantes para explicar a varia√ß√£o na vari√°vel resposta <span class="citation">(<a href="refer%C3%AAncias.html#ref-hadi_cautionary_1998" role="doc-biblioref">Hadi and Ling 1998</a>)</span>.</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Compare as dimens√µes das matrizes utilizadas para a PCR. Com bastante frequ√™ncia, a tentativa de combinar dados categ√≥ricos (algum descritor dos objetos) com os valores obtidos com a PCoA gera erros para plotar a figura ou para executar a an√°lise. Verifique, ent√£o, se as linhas s√£o as mesmas (nome das localidades ou indiv√≠duos e quantidade)</p></li>
<li><p>Estudos recentes t√™m criticado a utiliza√ß√£o de PCR para testar hip√≥teses ecol√≥gicas pelo fato dos escores n√£o representarem, necessariamente, a varia√ß√£o total das vari√°veis originais, bem como a rela√ß√£o entre a vari√°vel preditora e a dependente</p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar a composi√ß√£o de esp√©cies de aves em 23 regi√µes dos alpes franceses. Os dados ambientais (env) representam vari√°veis clim√°ticas (temperatura e chuva) e altitude.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Gradientes clim√°ticos afetam a riqueza de aves?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>O aumento da umidade e redu√ß√£o da temperatura aumentam o n√∫mero de esp√©cies de aves</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Preditora: temperatura e chuva (cont√≠nuas) e altitude (categ√≥rica com tr√™s n√≠veis)</li>
<li>Dependentes: riqueza de esp√©cies de aves</li>
</ul>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="va">env_cont</span> <span class="op">&lt;-</span> <span class="va">env</span><span class="op">[</span>,<span class="op">-</span><span class="fl">8</span><span class="op">]</span>
<span class="va">env.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">env_cont</span>, scale.unit <span class="op">=</span> <span class="cn">TRUE</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">var_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_var</a></span><span class="op">(</span><span class="va">env.pca</span><span class="op">)</span> 

<span class="co">## Contribui√ß√£o (%) das vari√°veis para cada eixo</span>
<span class="va">var_env</span><span class="op">$</span><span class="va">contrib</span> 
<span class="co">#&gt;             Dim.1      Dim.2      Dim.3      Dim.4       Dim.5</span>
<span class="co">#&gt; mini.jan 10.93489 22.2975487 16.1607726  7.6025527  0.01782438</span>
<span class="co">#&gt; maxi.jan 20.18065  3.2890767  2.1814486  4.2756350 41.05646526</span>
<span class="co">#&gt; mini.jul 11.87396 21.1379132  0.3428843  0.7750666 44.70209396</span>
<span class="co">#&gt; maxi.jul 18.47244  0.9159957 56.5369988  9.4368661  2.59283074</span>
<span class="co">#&gt; rain.jan  9.95206 21.5387403  6.5737927 53.7375738  4.44283706</span>
<span class="co">#&gt; rain.jul 16.14997 11.2368132  7.2608047 19.6972097  0.71454880</span>
<span class="co">#&gt; rain.tot 12.43603 19.5839121 10.9432983  4.4750959  6.47339980</span>

<span class="co">## Loadings - correla√ß√£o das vari√°veis com os eixos</span>
<span class="va">var_env</span><span class="op">$</span><span class="va">cor</span> 
<span class="co">#&gt;               Dim.1     Dim.2       Dim.3       Dim.4        Dim.5</span>
<span class="co">#&gt; mini.jan  0.6830371 0.6766524 -0.21924927  0.12298817 -0.004517369</span>
<span class="co">#&gt; maxi.jan  0.9279073 0.2598807 -0.08055260  0.09223249  0.216804944</span>
<span class="co">#&gt; mini.jul  0.7117620 0.6588220  0.03193603 -0.03926930 -0.226225907</span>
<span class="co">#&gt; maxi.jul  0.8877675 0.1371462  0.41008461 -0.13702428  0.054483561</span>
<span class="co">#&gt; rain.jan -0.6516187 0.6650391 -0.13983474 -0.32698110  0.071319550</span>
<span class="co">#&gt; rain.jul -0.8300858 0.4803509  0.14696011  0.19796389 -0.028601865</span>
<span class="co">#&gt; rain.tot -0.7284135 0.6341424  0.18041856  0.09435932  0.086088397</span>
<span class="va">ind_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_ind</a></span><span class="op">(</span><span class="va">env.pca</span><span class="op">)</span>
<span class="va">env.pca</span><span class="op">$</span><span class="va">eig</span> 
<span class="co">#&gt;        eigenvalue percentage of variance cumulative percentage of variance</span>
<span class="co">#&gt; comp 1 4.26652359             60.9503370                          60.95034</span>
<span class="co">#&gt; comp 2 2.05340251             29.3343216                          90.28466</span>
<span class="co">#&gt; comp 3 0.29745014              4.2492878                          94.53395</span>
<span class="co">#&gt; comp 4 0.19896067              2.8422953                          97.37624</span>
<span class="co">#&gt; comp 5 0.11448717              1.6355310                          99.01177</span>
<span class="co">#&gt; comp 6 0.04312874              0.6161248                          99.62790</span>
<span class="co">#&gt; comp 7 0.02604718              0.3721025                         100.00000</span></code></pre></div>
<p>O objeto <code>env.pca$eig</code> demonstra que os tr√™s primeiros eixos explicam 94.54% da varia√ß√£o total dos dados clim√°ticos. O intuito da PCR √© reduzir a dimensionalidade, ou seja, o n√∫mero de vari√°veis preditoras ou depedentes para facilitar a interpreta√ß√£o e garantir que as vari√°veis n√£o sejam correlacionadas. O pr√≥ximo passo ent√£o √© obter os valores dos escores que representam os valores convertidos para serem usados em uma determinada an√°lise, como a regress√£o m√∫ltipla.</p>
<div class="sourceCode" id="cb368"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Passo 1: obter os primeiros eixos </span>
<span class="va">pred.env</span> <span class="op">&lt;-</span> <span class="va">ind_env</span><span class="op">$</span><span class="va">coord</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> 

<span class="co">## Passo 2: calcular a riqueza de esp√©cies</span>
<span class="va">riqueza</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>

<span class="co">## Passo 3: combinar os dois valores em um √∫nico data.frame</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">pred.env</span>, <span class="va">riqueza</span><span class="op">)</span> </code></pre></div>
<p>Agora que os dados foram combinados em uma √∫nico data frame, podemos utilizar os c√≥digos apresentados no Cap√≠tulo <a href="cap7.html#cap7">7</a> para testar nossa hip√≥tese (Figura <a href="cap9.html#fig:fig-pcr-aves-diag">9.10</a>).</p>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Regress√£o m√∫ltipla</span>
<span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">riqueza</span> <span class="op">~</span> <span class="va">Dim.1</span> <span class="op">+</span> <span class="va">Dim.2</span> <span class="op">+</span> <span class="va">Dim.3</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co"># verificar pressupostos dos modelos lineares</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co"># resultados do  teste</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = riqueza ~ Dim.1 + Dim.2 + Dim.3, data = dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -3.4008 -1.1729  0.4356  1.2072  2.4571 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept) 13.30435    0.37639  35.347  &lt; 2e-16 ***</span>
<span class="co">#&gt; Dim.1        0.68591    0.18222   3.764  0.00131 ** </span>
<span class="co">#&gt; Dim.2       -0.09961    0.26267  -0.379  0.70874    </span>
<span class="co">#&gt; Dim.3       -0.21708    0.69014  -0.315  0.75654    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 1.805 on 19 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.4313, Adjusted R-squared:  0.3415 </span>
<span class="co">#&gt; F-statistic: 4.804 on 3 and 19 DF,  p-value: 0.01179</span>
<span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc</a></span><span class="op">(</span><span class="va">env.pca</span><span class="op">)</span><span class="op">$</span><span class="va">Dim.1</span> 
<span class="co">#&gt; $quanti</span>
<span class="co">#&gt;          correlation      p.value</span>
<span class="co">#&gt; maxi.jan   0.9279073 1.846790e-10</span>
<span class="co">#&gt; maxi.jul   0.8877675 1.607390e-08</span>
<span class="co">#&gt; mini.jul   0.7117620 1.396338e-04</span>
<span class="co">#&gt; mini.jan   0.6830371 3.282701e-04</span>
<span class="co">#&gt; rain.jan  -0.6516187 7.559358e-04</span>
<span class="co">#&gt; rain.tot  -0.7284135 8.112903e-05</span>
<span class="co">#&gt; rain.jul  -0.8300858 9.588034e-07</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "condes" "list"</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pcr-aves-diag"></span>
<img src="livro_files/figure-html/fig-pcr-aves-diag-1.png" alt="Diagn√≥sticos dos modelo PCR para aves." width="100%" height="100%"><p class="caption">
Figura 9.10: Diagn√≥sticos dos modelo PCR para aves.
</p>
</div>
<p>Como percebemos, a Dim.1 foi o √∫nico gradiente ambiental que afetou a riqueza de esp√©cies. Para interpretar esta dimens√£o (e outras importantes), podemos usar a fun√ß√£o <code><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc()</a></code> para verificar as vari√°veis mais importantes. Neste caso, os valores mais extremos de correla√ß√£o (maior que 0.8) indicam que a temperatura do m√™s de janeiro e julho bem como a chuva do m√™s de julho foram as vari√°veis mais importantes para determinar o gradiente ambiental expresso na dimens√£o 1. Assim, podemos fazer um gr√°fico para representar a rela√ß√£o entre Eixo 1 (gradiente chuva-temperatura) e a riqueza de esp√©cies de aves. Valores negativos do eixo 1 (Gradiente ambiental - PC1) representam localidades com mais chuva, ao passo que valores positivos indicam localidades com temperaturas maiores (Figura <a href="cap9.html#fig:fig-pcr-aves-model">9.11</a>).</p>
<div class="sourceCode" id="cb370"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Dim.1</span>, y <span class="op">=</span> <span class="va">riqueza</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, fill <span class="op">=</span> <span class="st">"#525252"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"#1a1a1a"</span>, fill <span class="op">=</span> <span class="st">"cyan4"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Gradiente ambiental (PC1)"</span>, y <span class="op">=</span> <span class="st">"Riqueza de aves"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pcr-aves-model"></span>
<img src="livro_files/figure-html/fig-pcr-aves-model-1.png" alt="Modelo linear representando a rela√ß√£o entre Eixo 1 (gradiente chuva-temperatura) e a riqueza de esp√©cies de aves." width="100%" height="100%"><p class="caption">
Figura 9.11: Modelo linear representando a rela√ß√£o entre Eixo 1 (gradiente chuva-temperatura) e a riqueza de esp√©cies de aves.
</p>
</div>
<p><strong>Exemplo 2</strong></p>
<p>√â poss√≠vel que os dados utilizados em seu estudo sejam mistos, ou seja, incluem tanto vari√°veis categ√≥ricas quanto cont√≠nuas. Como falado acima, nesses casos a an√°lise indicada √© a PCoA. Assim como na PCA, podemos extrair os escores da PCoA para utilizar em an√°lises univariadas e multivariadas.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Vari√°veis clim√°ticas, vegetacionais e topogr√°ficas afetam a riqueza de √°caros?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>A densidade da vegeta√ß√£o e disponibilidade de √°gua aumentam a riqueza de esp√©cies de √°caros</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Preditoras: densidade de substrado e disponibilidade de √°gua (cont√≠nuas), tipo de substrado (categ√≥rica com 7 n√≠veis), densidade arbusto (ordinal com 3 n√≠veis), e topografia (categ√≥rica com 2 n√≠veis)</li>
<li>Dependentes: riqueza de esp√©cies de √°caros</li>
</ul>
<p>O primeiro passo ent√£o √© utilizar um m√©todo de dist√¢ncia apropriado para o seu conjunto de dados. Em nosso exemplo, utilizaremos a dist√¢ncia de Gower, que √© usada para dados mistos (veja Cap√≠tulo <a href="cap14.html#cap14">14</a>).</p>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Matriz de dist√¢ncia</span>
<span class="va">env.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FD/man/gowdis.html">gowdis</a></span><span class="op">(</span><span class="va">mite.env</span><span class="op">)</span>

<span class="co">## PCoA</span>
<span class="va">env.mite.pco</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/pcoa.html">pcoa</a></span><span class="op">(</span><span class="va">env.dist</span>, correction <span class="op">=</span> <span class="st">"cailliez"</span><span class="op">)</span>

<span class="co">## Porcentagem de explica√ß√£o do Eixo 1</span>
<span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">env.mite.pco</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">env.mite.pco</span><span class="op">$</span><span class="va">trace</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] 61.49635</span>

<span class="co">## Porcentagem de explica√ß√£o dos Eixo 2</span>
<span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">env.mite.pco</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">env.mite.pco</span><span class="op">$</span><span class="va">trace</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; [1] 32.15486</span></code></pre></div>
<p>O pr√≥ximo passo √© exportar os escores para as an√°lises <em>a posteriori</em> (Figura <a href="cap9.html#fig:fig-pcr-acaros-diag">9.12</a>).</p>
<div class="sourceCode" id="cb372"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Selecionar os dois primeiros eixos</span>
<span class="va">pred.scores.mite</span> <span class="op">&lt;-</span> <span class="va">env.mite.pco</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> 

<span class="co">## Juntar com os dados da √°rea para fazer a figura </span>
<span class="va">mite.riqueza</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>
<span class="va">pred.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>riqueza <span class="op">=</span> <span class="va">mite.riqueza</span>, <span class="va">pred.scores.mite</span><span class="op">)</span>

<span class="co">### Regress√£o m√∫ltipla </span>
<span class="va">mod.mite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">riqueza</span> <span class="op">~</span> <span class="va">Axis.1</span> <span class="op">+</span> <span class="va">Axis.2</span>, data <span class="op">=</span> <span class="va">pred.vars</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">mod.mite</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod.mite</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = riqueza ~ Axis.1 + Axis.2, data = pred.vars)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; -10.6874  -2.3960  -0.1378   2.5032   8.6873 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)  15.1143     0.4523  33.415  &lt; 2e-16 ***</span>
<span class="co">#&gt; Axis.1      -11.4303     2.0013  -5.711  2.8e-07 ***</span>
<span class="co">#&gt; Axis.2        5.6832     2.7677   2.053   0.0439 *  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 3.784 on 67 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.3548, Adjusted R-squared:  0.3355 </span>
<span class="co">#&gt; F-statistic: 18.42 on 2 and 67 DF,  p-value: 4.225e-07</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pcr-acaros-diag"></span>
<img src="livro_files/figure-html/fig-pcr-acaros-diag-1.png" alt="Diagn√≥sticos dos modelo PCR para √°caros." width="100%" height="100%"><p class="caption">
Figura 9.12: Diagn√≥sticos dos modelo PCR para √°caros.
</p>
</div>
<p>Finalmente, ap√≥s interpretar os resultados do modelo, podemos fazer a figura com as vari√°veis (eixos) importantes (Figura <a href="cap9.html#fig:fig-pcr-acaros-model">9.13</a>).</p>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g_acari_axi1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pred.vars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Axis.1</span>, y <span class="op">=</span> <span class="va">riqueza</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, fill <span class="op">=</span> <span class="st">"#525252"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"#1a1a1a"</span>, fill<span class="op">=</span><span class="st">"cyan4"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Gradiente ambiental (PC1)"</span>, y <span class="op">=</span> <span class="st">"Riqueza de √°caros"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="va">g_acari_axi2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pred.vars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Axis.2</span>, y <span class="op">=</span> <span class="va">riqueza</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, fill <span class="op">=</span> <span class="st">"#525252"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"#1a1a1a"</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Gradiente ambiental (PC2)"</span>, y <span class="op">=</span> <span class="st">"Riqueza de √°caros"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="co">## Fun√ß√£o para combinar os dois plots em uma √∫nica janela</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">g_acari_axi1</span>, <span class="va">g_acari_axi2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pcr-acaros-model"></span>
<img src="livro_files/figure-html/fig-pcr-acaros-model-1.png" alt="Modelo linear representando a rela√ß√£o entre Eixo 1 e Eixo 2 e a riqueza de esp√©cies de √°caros." width="100%" height="100%"><p class="caption">
Figura 9.13: Modelo linear representando a rela√ß√£o entre Eixo 1 e Eixo 2 e a riqueza de esp√©cies de √°caros.
</p>
</div>
</div>
</div>
<div id="ordena√ß√£o-restrita" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Ordena√ß√£o restrita<a class="anchor" aria-label="anchor" href="#ordena%C3%A7%C3%A3o-restrita"><i class="fas fa-link"></i></a>
</h2>
<p>A ordena√ß√£o restrita ou an√°lise de gradiente direto, organiza os objetos de acordo com suas rela√ß√µes com outras vari√°veis (preditoras) coletadas nas mesmas unidades amostrais. O exemplo mais comum na ecologia √© de investigar a rela√ß√£o entre diversas vari√°veis ambientais (matriz <strong>X</strong>) coletadas em <em>n</em> localidades e a abund√¢ncia (ou presen√ßa aus√™ncia) de <em>y</em> esp√©cies coletadas nas mesmas localidades (matrix <strong>Y</strong>). Com frequ√™ncia, outras dados s√£o utilizados como as coordenadas geogr√°ficas das unidades amostrais (matriz <strong>W</strong>), os atributos funcionais das esp√©cies coletadas (matriz <strong>T</strong>) e a rela√ß√£o filogen√©tica dessas esp√©cies (matriz <strong>P</strong>). Diversos m√©todos s√£o utilizados para combinar duas ou mais matrizes, mas neste cap√≠tulo iremos apresentar a An√°lise de Redund√¢ncia (RDA), An√°lise de Redund√¢ncia parcial (RDAp) e m√©todos espaciais para incluir a matriz <strong>W</strong> nas an√°lises de gradiente direto.</p>
<div id="an√°lise-de-redund√¢ncia-rda" class="section level3" number="9.5.1">
<h3>
<span class="header-section-number">9.5.1</span> An√°lise de Redund√¢ncia (RDA)<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-redund%C3%A2ncia-rda"><i class="fas fa-link"></i></a>
</h3>
<p>A RDA √© uma an√°lise semelhante √† regress√£o m√∫ltipla (Cap√≠tulo <a href="cap7.html#cap7">7</a>), mas que usa dados multivariados como vari√°vel dependente. As duas matrizes comuns, matriz X (<em>n</em> unidades amostraits e <em>m</em> vari√°veis) e matriz Y (<em>n</em> unidades amostrais e <em>p</em> descritores - geralmente, esp√©cies). O primeiro passo da RDA √© centralizar (assim como na PCA, exemplo acima) as matrizes X e Y. Ap√≥s a centraliza√ß√£o, realiza-se regress√µes lineares entre X e Y para obter os valores preditos de Y (ou seja, os valores de Y que representa√ß√£o uma combina√ß√£o linear com X). O passo seguinte √© realizar uma PCA dos valores preditos de Y. Este √∫ltimo procedimento gera os autovalores, autovetores e os eixos can√¥nicos que correspondem √†s coordenadas dos objetos (unidades amostrais), vari√°veis preditoras e das vari√°veis resposta. A diferen√ßa da ordena√ß√£o do valor de Y predito e da ordena√ß√£o somente de Y (como na PCA implementada acima) √© que a segunda mostra a posi√ß√£o prevista pela rela√ß√£o linear entre X e Y. Logo, essa √© exatamente o motivo da ordena√ß√£o ser conhecida como restrita, pois a varia√ß√£o em Y √© restrita (linearmente) pela varia√ß√£o de X. Assim como na regress√£o m√∫ltipla, a estat√≠stica da RDA √© representada pelo valor de <em>R<sup>2</sup></em> e <em>F</em>. O valor de <em>R<sup>2</sup></em> indica a for√ßa da rela√ß√£o linear entre X e Y e o valor do <em>F</em> representa o teste global de signific√¢ncia. Al√©m disso, √© poss√≠vel testar a signific√¢ncia de cada um dos eixos da ordena√ß√£o (e a presen√ßa de pelo menos um eixo significativo √© pr√©-requisito para que exista a rela√ß√£o linear entre X e Y) e de cada uma das vari√°veis preditoras da matriz X.</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Vari√°veis preditoras: importante verificar se: i) a estrutura de correla√ß√£o das vari√°veis ambientais, e a ii) presen√ßa de autocorrela√ß√£o espacial</p></li>
<li><p>Composi√ß√£o de esp√©cies como matriz Y: fundamental observar se os valores utilizados representam abund√¢ncia ou presen√ßa-aus√™ncia e qual a necessidade de padroniza√ß√£o (e.g., Hellinger)</p></li>
<li><p>Assim como em modelos de regress√£o linear simples e m√∫ltipla, os valores de <em>R<sup>2</sup></em> ajustado devem ser selecionados ao inv√©s do valor de <em>R<sup>2</sup></em></p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Esp√©cies de aves que ocorrem em localidades com diferentes altitudes.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>O clima e a altitude modificam a composi√ß√£o de esp√©cies de aves?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Diferen√ßas clim√°ticas (temperatura e chuva) e altitudinais alteram a composi√ß√£o de esp√©cies de aves</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Preditoras: Temperatura e precipita√ß√£o (cont√≠nuas) e altitude (categ√≥rica com tr√™s n√≠veis)</li>
<li>Dependente: composi√ß√£o de esp√©cies de aves</li>
</ul>
<p><strong>An√°lises</strong></p>
<div class="sourceCode" id="cb374"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Passo 1: transforma√ß√£o de hellinger da matriz de esp√©cies</span>
<span class="co"># caso tenha dados de abund√¢ncia.</span>
<span class="va">species.hel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, method <span class="op">=</span> <span class="st">"hellinger"</span><span class="op">)</span>

<span class="co">## Passo 2: selecionar vari√°veis importantes</span>
<span class="co"># Para isso, √© necess√°rio remover a vari√°vel categ√≥rica.</span>
<span class="va">env.contin</span> <span class="op">&lt;-</span> <span class="va">env</span><span class="op">[</span>, <span class="op">-</span><span class="fl">8</span><span class="op">]</span>

<span class="co">## Evite usar vari√°veis muito correlacionadas</span>
<span class="va">sel.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adespatial/man/forward.sel.html">forward.sel</a></span><span class="op">(</span><span class="va">species.hel</span>, <span class="va">env.contin</span><span class="op">)</span>
<span class="co">#&gt; Testing variable 1</span>
<span class="co">#&gt; Testing variable 2</span>
<span class="co">#&gt; Testing variable 3</span>
<span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 3 is 0.212000 (&gt; 0.050000)</span>
<span class="va">sel.vars</span><span class="op">$</span><span class="va">variables</span>
<span class="co">#&gt; [1] "rain.jul" "maxi.jul"</span>
<span class="va">env.sel</span> <span class="op">&lt;-</span> <span class="va">env</span><span class="op">[</span>,<span class="va">sel.vars</span><span class="op">$</span><span class="va">variables</span><span class="op">]</span>

<span class="co">## Passo 3: padronizar matriz ambiental (somente vari√°veis cont√≠nuas)</span>
<span class="va">env.pad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">env.sel</span>, method <span class="op">=</span> <span class="st">"standardize"</span><span class="op">)</span>

<span class="co">## Matriz final com vari√°veis preditoras</span>
<span class="va">env.pad.cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">env.pad</span>, altitude <span class="op">=</span> <span class="va">env</span><span class="op">$</span><span class="va">altitude</span><span class="op">)</span></code></pre></div>
<p>Depois de selecionar um subconjunto dos dados com o m√©todo Forward Selection e padroniz√°-los (m√©dia 0 e desvio padr√£o 1), o modelo da RDA √© constru√≠do como modelos lineares (Figura <a href="cap9.html#fig:fig-rda">9.14</a>). A Ordena√ß√£o Multi-Escala (MSO) tamb√©m √© ajustada para analisar a autocorrela√ß√£o espacial.</p>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## RDA com dados selecionados e padronizados</span>
<span class="va">rda.bird</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda</a></span><span class="op">(</span><span class="va">species.hel</span> <span class="op">~</span> <span class="va">rain.jul</span> <span class="op">+</span> <span class="va">maxi.jul</span> <span class="op">+</span> <span class="va">altitude</span>, data <span class="op">=</span> <span class="va">env.pad.cat</span><span class="op">)</span>

<span class="co">## Para interpretar, √© necess√°rio saber a signific√¢ncia dos eixos para representar a rela√ß√£o entre as vari√°veis preditoras e a composi√ß√£o de esp√©cies</span>
<span class="va">res.axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca</a></span><span class="op">(</span><span class="va">rda.bird</span>, by <span class="op">=</span> <span class="st">"axis"</span><span class="op">)</span> 
<span class="va">res.axis</span>
<span class="co">#&gt; Permutation test for rda under reduced model</span>
<span class="co">#&gt; Forward tests for axes</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span>
<span class="co">#&gt;          Df Variance       F Pr(&gt;F)    </span>
<span class="co">#&gt; RDA1      1 0.045759 12.0225  0.001 ***</span>
<span class="co">#&gt; RDA2      1 0.009992  2.6252  0.061 .  </span>
<span class="co">#&gt; RDA3      1 0.007518  1.9752  0.136    </span>
<span class="co">#&gt; RDA4      1 0.003582  0.9410  0.470    </span>
<span class="co">#&gt; Residual 18 0.068510                   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co">## Em seguida, √© poss√≠vel identificar quais s√£o as vari√°veis que contribuem ou que mais contribuem para a varia√ß√£o na composi√ß√£o de esp√©cies </span>
<span class="va">res.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca</a></span><span class="op">(</span><span class="va">rda.bird</span>, by <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span> <span class="co">## Qual vari√°vel?</span>
<span class="va">res.var</span>
<span class="co">#&gt; Permutation test for rda under reduced model</span>
<span class="co">#&gt; Terms added sequentially (first to last)</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span>
<span class="co">#&gt;          Df Variance      F Pr(&gt;F)    </span>
<span class="co">#&gt; rain.jul  1 0.036514 9.5936  0.001 ***</span>
<span class="co">#&gt; maxi.jul  1 0.011264 2.9596  0.016 *  </span>
<span class="co">#&gt; altitude  2 0.019071 2.5053  0.011 *  </span>
<span class="co">#&gt; Residual 18 0.068510                  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co">## Al√©m disso, √© poss√≠vel obter o valor do R2 do modelo</span>
<span class="va">r_quadr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/RsquareAdj.html">RsquareAdj</a></span><span class="op">(</span><span class="va">rda.bird</span><span class="op">)</span>
<span class="va">r_quadr</span>
<span class="co">#&gt; $r.squared</span>
<span class="co">#&gt; [1] 0.4938685</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $adj.r.squared</span>
<span class="co">#&gt; [1] 0.3813949</span>

<span class="co">## Ordena√ß√£o multi-escala (MSO) para entender os resultados da ordena√ß√£o em rela√ß√£o √† dist√¢ncia geogr√°fica</span>
<span class="va">bird.rda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mso.html">mso</a></span><span class="op">(</span><span class="va">rda.bird</span>, <span class="va">xy</span>, grain <span class="op">=</span> <span class="fl">1</span>, permutations <span class="op">=</span> <span class="fl">99</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mso.html">msoplot</a></span><span class="op">(</span><span class="va">bird.rda</span><span class="op">)</span>
<span class="co">#&gt; Error variance of regression model underestimated by -2.7 percent</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-rda"></span>
<img src="livro_files/figure-html/fig-rda-1.png" alt="Ordena√ß√£o multi-escala (MSO) para entender os resultados da ordena√ß√£o em rela√ß√£o √† dist√¢ncia geogr√°fica." width="100%" height="100%"><p class="caption">
Figura 9.14: Ordena√ß√£o multi-escala (MSO) para entender os resultados da ordena√ß√£o em rela√ß√£o √† dist√¢ncia geogr√°fica.
</p>
</div>
<p>Da mesma forma que nas ordena√ß√µes irrestritas, podemos fazer um gr√°fico para visualizar as ordena√ß√µes, mas agora esse gr√°fico √© denominado ‚Äútriplot,‚Äù pois possui os dados das duas ordena√ß√µes (Figura <a href="cap9.html#fig:fig-rda-triplot">9.15</a>).</p>
<div class="sourceCode" id="cb376"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Triplot da RDA</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggord/man/ggord.html">ggord</a></span><span class="op">(</span><span class="va">rda.bird</span>, ptslab <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="fl">1</span>, addsize <span class="op">=</span> <span class="fl">3</span>, repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-rda-triplot"></span>
<img src="livro_files/figure-html/fig-rda-triplot-1.png" alt="Triplot da RDA." width="100%" height="100%"><p class="caption">
Figura 9.15: Triplot da RDA.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Os objetos <code>res.axis</code>, <code>res.var</code> e <code>r_quadr</code> mostram, respectivamente, i) as dimens√µes (RDA1, RDA2, etc.) que possuem varia√ß√£o na composi√ß√£o de esp√©cies, ii) as vari√°veis preditoras que explicam esta varia√ß√£o, e iii) o valor do <em>R<sup>2</sup></em> ajustado. Neste exemplo, podemos observar que somente a dimens√£o 1 (RDA1) representa uma varia√ß√£o significativa da composi√ß√£o de esp√©cies (<strong>P</strong> = 0,001). As vari√°veis <em>rain.jul</em>, <em>maxi.jul</em> e <em>altitude</em> foram todas preditoras importantes da composi√ß√£o de esp√©cies, mas <em>rain.jul</em> se destacada com maior valor de <strong>F</strong>. Al√©m disso, o valor do <em>R<sup>2</sup></em> ajustado de 0.381 indica forte contribui√ß√£o dessas vari√°veis preditoras. Por√©m, uma das limita√ß√µes desta an√°lise √© n√£o considerar que tanto esp√©cies quanto vari√°veis preditoras podem estar estruturadas espacialmente. Como resultado, os res√≠duos da an√°lises podem apresentar autocorrela√ß√£o espacial que, por sua vez, aumenta o Erro do Tipo I <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. A figura obtida com o c√≥digo <code>msoplot(bird.rda)</code> demonstra que existe autocorrela√ß√£o espacial em algumas dist√¢ncias da an√°lise. Veja abaixo algumas alternativas para res√≠duos com autocorrela√ß√£o espacial.</p>
</div>
<div id="an√°lise-de-redund√¢ncia-parcial-rdap" class="section level3" number="9.5.2">
<h3>
<span class="header-section-number">9.5.2</span> An√°lise de Redund√¢ncia parcial (RDAp)<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-redund%C3%A2ncia-parcial-rdap"><i class="fas fa-link"></i></a>
</h3>
<p>Um dos problemas da abordagem anterior √© que tanto a composi√ß√£o de esp√©cies como as vari√°veis ambientais est√£o estruturadas espacialmente. Talvez mais importantes, para que os valores de probabilidade da RDA sejam interpretados corretamente (e para evitar Erro do Tipo I), os res√≠duos do modelo n√£o devem estar correlacionados espacialmente, como demonstrado com a an√°lise MSO. Uma alternativa √© incluir a matriz de dados espaciais (matrix W) como valor condicional dentro da RDA. Esta an√°lise √© conhecida como RDA parcial.</p>
<p>Por√©m, a obten√ß√£o dos dados espaciais da matriz W √© mais complexo do que simplesmente incluir dados de localiza√ß√£o geogr√°fica (latitude e longitude), como feito em alguns modelos lineares (e.g., <em>Generalized Least Squares</em> - GLS Cap√≠tulos <a href="cap7.html#cap7">7</a> e <a href="cap10.html#cap10">10</a>). Existem diversas ferramentas que descrevem e incorporam o componente espacial em m√©todos mulitidimensionais, mas os Mapas de Autovetores de Moran (MEM) s√£o certamente os mais utilizados <span class="citation">(<a href="refer%C3%AAncias.html#ref-dray_community_2012" role="doc-biblioref">Dray et al. 2012</a>)</span>. A an√°lise MEM consiste na ordena√ß√£o (PCoA) de uma matriz truncada obtida atrav√©s da localiza√ß√£o geogr√°fica das localidades utilizando dist√¢ncia euclidiana, matriz de conectividade e matriz espacial ponderada. Os autovalores obtidos no MEM s√£o id√™nticos aos coeficientes de correla√ß√£o espacial de Moran <em>I</em>. Um procedimento chave desta an√°lise √© a defini√ß√£o de um limiar de trucamento (do ingl√™s <em>truncate threshold</em>). Este limiar √© calculado a partir de uma ‚Äú√°rvore de espa√ßo m√≠nimo‚Äù (<em>Minimum Spanning Tree</em> - MST) que conecta todos os pontos de coleta. Na pr√°tica, os valores menores do que o limiar definido pela MST indicam que os pontos com aqueles valores est√£o conectados e, assim possuem correla√ß√£o positiva. Outro ponto importante desta an√°lise √© a obten√ß√£o da matriz espacial ponderada (<em>Spatial Weighting Matrix</em> - SWM). A sele√ß√£o da matriz SWM √© parte essencial do c√°lculo dos MEM e n√£o deve ser feita arbitratiamente <span class="citation">(<a href="refer%C3%AAncias.html#ref-bauman_optimizing_2018" role="doc-biblioref">Bauman, Drouet, Fortin, et al. 2018</a>)</span>. Por este motivo, a an√°lise recebe este nome <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. Finalmente, o m√©todo produz autovetores que representam preditores espaciais que podem ser utilizados na RDA parcial (e em outras an√°lises). √â importante ressaltar que o crit√©rio de sele√ß√£o do n√∫mero de autovetores √© bastante debatido na literatura e, para isso, sugerimos a leitura dos seguintes artigos: <span class="citation"><a href="refer%C3%AAncias.html#ref-bauman_disentangling_2018" role="doc-biblioref">Bauman, Drouet, Dray, et al.</a> (<a href="refer%C3%AAncias.html#ref-bauman_disentangling_2018" role="doc-biblioref">2018</a>)</span>.</p>
<p>Ent√£o, o primeiro passo para realizar uma RDA parcial √© de gerar os autovetores espaciais (MEMs).</p>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="co"># Matriz padronizada de composi√ß√£o de esp√©cies. </span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">species.hel</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> 
<span class="co">#&gt;     Fauvette_orphee Fauvette_des_jardins Fauvette_a_tete_noire Fauvette_babillarde Fauvette_grisette Fauvette_pitchou</span>
<span class="co">#&gt; S01               0            0.3651484             0.3651484           0.2581989         0.2581989                0</span>
<span class="co">#&gt; S02               0            0.3333333             0.3333333           0.2357023         0.2357023                0</span>
<span class="co">#&gt; S03               0            0.3162278             0.3162278           0.3162278         0.2236068                0</span>
<span class="co">#&gt; S04               0            0.4200840             0.3429972           0.2425356         0.0000000                0</span>
<span class="co">#&gt; S05               0            0.3872983             0.3162278           0.2236068         0.3162278                0</span>
<span class="co">#&gt; S06               0            0.3779645             0.3779645           0.2672612         0.0000000                0</span>

<span class="co">## Latitude e longitude</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>
<span class="co">#&gt;       x   y</span>
<span class="co">#&gt; S01 156 252</span>
<span class="co">#&gt; S02 141 217</span>
<span class="co">#&gt; S03 171 233</span>
<span class="co">#&gt; S04 178 215</span>
<span class="co">#&gt; S05 123 189</span>
<span class="co">#&gt; S06 154 195</span>

<span class="co">## dados ambientais padronizados e altitude</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">env.pad.cat</span><span class="op">)</span>
<span class="co">#&gt;     rain.jul   maxi.jul      altitude</span>
<span class="co">#&gt; S01 1.333646  0.1462557    Montanhoso</span>
<span class="co">#&gt; S02 1.468827 -0.6848206 Intermedi√°rio</span>
<span class="co">#&gt; S03 1.505694 -0.2099199    Montanhoso</span>
<span class="co">#&gt; S04 1.296778 -2.0699476    Montanhoso</span>
<span class="co">#&gt; S05 1.075572 -0.3682201         Plano</span>
<span class="co">#&gt; S06 1.100151 -0.6056705 Intermedi√°rio</span>

<span class="co">## Passo 1: Gerar um arquivo LIST W: list bin√°ria de vizinhan√ßa</span>
<span class="va">mat_knn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html">knearneigh</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">2</span>, longlat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">mat_nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knn2nb.html">knn2nb</a></span><span class="op">(</span><span class="va">mat_knn</span>, sym <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">mat_listw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">mat_nb</span>, style <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span>
<span class="va">mat_listw</span>
<span class="co">#&gt; Characteristics of weights list object:</span>
<span class="co">#&gt; Neighbour list object:</span>
<span class="co">#&gt; Number of regions: 23 </span>
<span class="co">#&gt; Number of nonzero links: 58 </span>
<span class="co">#&gt; Percentage nonzero weights: 10.96408 </span>
<span class="co">#&gt; Average number of links: 2.521739 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Weights style: W </span>
<span class="co">#&gt; Weights constants summary:</span>
<span class="co">#&gt;    n  nn S0       S1       S2</span>
<span class="co">#&gt; W 23 529 23 18.84444 96.01111</span>

<span class="co">## Passo 2: Listar os m√©todos "candidatos" para obter a matriz SWM</span>
<span class="va">MEM_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adespatial/man/mem.html">scores.listw</a></span><span class="op">(</span><span class="va">mat_listw</span>, MEM.autocor <span class="op">=</span> <span class="st">"positive"</span><span class="op">)</span>
<span class="va">candidates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adespatial/man/listw.candidates.html">listw.candidates</a></span><span class="op">(</span><span class="va">xy</span>, nb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gab"</span>, <span class="st">"mst"</span>, <span class="st">"dnear"</span><span class="op">)</span>, 
                               weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"binary"</span>, <span class="st">"flin"</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Passo 3: Selecionar a melhor matriz SWM e executar o MEM</span>
<span class="va">W_sel_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adespatial/man/listw.select.html">listw.select</a></span><span class="op">(</span><span class="va">species.hel</span>, <span class="va">candidates</span>, MEM.autocor <span class="op">=</span> <span class="st">"positive"</span>,
                          p.adjust <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"FWD"</span><span class="op">)</span>
<span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 5 is 0.112000 (&gt; 0.050000)</span>
<span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 3 is 0.059000 (&gt; 0.050000)</span>
<span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 3 is 0.060000 (&gt; 0.050000)</span>
<span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 4 is 0.157000 (&gt; 0.050000)</span>

<span class="co">## Passo 4: Matriz dos preditores espaciais escolhidos (MEMs)</span>
<span class="va">spatial.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">W_sel_mat</span><span class="op">$</span><span class="va">best</span><span class="op">$</span><span class="va">MEM.select</span><span class="op">)</span>

<span class="co">## √â necess√°rio atribuir os nomes das linhas</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">spatial.pred</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span> </code></pre></div>
<p>Depois de gerar os valores dos autovetores espaciais (MEM), √© poss√≠vel executar a RDA parcial utilizando esses valores no argumento <code>Conditional</code>.</p>
<div class="sourceCode" id="cb378"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Combinar vari√°veis ambientais e espaciais em um √∫nico data.frame</span>
<span class="va">pred.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">env.pad.cat</span>, <span class="va">spatial.pred</span><span class="op">)</span>

<span class="co">## RDA parcial</span>
<span class="va">rda.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda</a></span><span class="op">(</span><span class="va">species.hel</span> <span class="op">~</span>
                 <span class="va">rain.jul</span> <span class="op">+</span> <span class="va">maxi.jul</span> <span class="op">+</span> <span class="va">altitude</span> <span class="op">+</span> <span class="co"># Preditores ambientais</span>
                 <span class="fu">Condition</span><span class="op">(</span><span class="va">MEM1</span> <span class="op">+</span> <span class="va">MEM2</span> <span class="op">+</span> <span class="va">MEM4</span> <span class="op">+</span> <span class="va">MEM5</span><span class="op">)</span>, <span class="co"># Preditores espaciais</span>
             data <span class="op">=</span> <span class="va">pred.vars</span><span class="op">)</span>

<span class="co">## Interpreta√ß√£o</span>
<span class="co"># Para interpretar, √© necess√°rio saber a signific√¢ncia dos eixos para representar a rela√ß√£o entre as vari√°veis preditoras e a composi√ß√£o de esp√©cies.</span>
<span class="va">res.p.axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca</a></span><span class="op">(</span><span class="va">rda.p</span>, by <span class="op">=</span> <span class="st">"axis"</span><span class="op">)</span> 
<span class="va">res.p.axis</span>
<span class="co">#&gt; Permutation test for rda under reduced model</span>
<span class="co">#&gt; Forward tests for axes</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude + Condition(MEM1 + MEM2 + MEM4 + MEM5), data = pred.vars)</span>
<span class="co">#&gt;          Df Variance      F Pr(&gt;F)</span>
<span class="co">#&gt; RDA1      1 0.008471 2.1376  0.316</span>
<span class="co">#&gt; RDA2      1 0.004830 1.2189  0.779</span>
<span class="co">#&gt; RDA3      1 0.003240 0.8176  0.890</span>
<span class="co">#&gt; RDA4      1 0.001891 0.4773  0.895</span>
<span class="co">#&gt; Residual 14 0.055477</span>

<span class="co">## Contribui√ß√£o</span>
<span class="co"># Em seguida, √© poss√≠vel identificar quais s√£o as vari√°veis que contribuem ou que mais contribuem para a varia√ß√£o na composi√ß√£o de esp√©cies.</span>
<span class="va">res.p.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca</a></span><span class="op">(</span><span class="va">rda.p</span>, by <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span> <span class="co">## Qual vari√°vel?</span>
<span class="va">res.p.var</span>
<span class="co">#&gt; Permutation test for rda under reduced model</span>
<span class="co">#&gt; Terms added sequentially (first to last)</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude + Condition(MEM1 + MEM2 + MEM4 + MEM5), data = pred.vars)</span>
<span class="co">#&gt;          Df Variance      F Pr(&gt;F)</span>
<span class="co">#&gt; rain.jul  1 0.004406 1.1119  0.349</span>
<span class="co">#&gt; maxi.jul  1 0.004446 1.1220  0.338</span>
<span class="co">#&gt; altitude  2 0.009579 1.2087  0.241</span>
<span class="co">#&gt; Residual 14 0.055477</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/RsquareAdj.html">RsquareAdj</a></span><span class="op">(</span><span class="va">rda.p</span><span class="op">)</span>
<span class="co">#&gt; $r.squared</span>
<span class="co">#&gt; [1] 0.1361661</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $adj.r.squared</span>
<span class="co">#&gt; [1] 0.02330319</span></code></pre></div>
<p>Se voc√™ comparar os resultados do objeto res.p.var (RDA parcial) com res.var (RDA simples) √© poss√≠vel perceber como a estrutura espacial nos res√≠duos aumenta a probabilidade de cometer Erro do Tipo I. O modelo da RDA parcial mostra que n√£o existem qualquer efeito direto das vari√°veis ambientais sobre a composi√ß√£o de esp√©cies (conclus√£o com a RDA simples). Na verdade, tanto a composi√ß√£o de esp√©cies quanto as vari√°veis clim√°ticas est√£o fortemente estruturadas no espa√ßo, como demonstramos a seguir.</p>
<div class="sourceCode" id="cb379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Padr√£o espacial na composi√ß√£o de esp√©cies</span>
<span class="va">pca.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">species.hel</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">moran.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html">moran.mc</a></span><span class="op">(</span><span class="va">pca.comp</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">mat_listw</span>, <span class="fl">999</span><span class="op">)</span>

<span class="co">## Padr√£o espacial das vari√°veis ambientais</span>
<span class="va">env</span><span class="op">$</span><span class="va">altitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/factor.html">as.factor</a></span><span class="op">(</span><span class="va">env</span><span class="op">$</span><span class="va">altitude</span><span class="op">)</span>
<span class="va">ca.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.hillsmith.html">dudi.hillsmith</a></span><span class="op">(</span><span class="va">env</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">moran.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html">moran.mc</a></span><span class="op">(</span><span class="va">ca.env</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">mat_listw</span>, <span class="fl">999</span><span class="op">)</span>

<span class="co">## Estrutura espacial na composi√ß√£o de esp√©cies?</span>
<span class="va">moran.comp</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Monte-Carlo simulation of Moran I</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  pca.comp$li[, 1] </span>
<span class="co">#&gt; weights: mat_listw  </span>
<span class="co">#&gt; number of simulations + 1: 1000 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; statistic = 0.62815, observed rank = 1000, p-value = 0.001</span>
<span class="co">#&gt; alternative hypothesis: greater</span>

<span class="co">## Estrutura espacial na varia√ß√£o ambiental?</span>
<span class="va">moran.env</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Monte-Carlo simulation of Moran I</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ca.env$li[, 1] </span>
<span class="co">#&gt; weights: mat_listw  </span>
<span class="co">#&gt; number of simulations + 1: 1000 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; statistic = 0.72714, observed rank = 1000, p-value = 0.001</span>
<span class="co">#&gt; alternative hypothesis: greater</span></code></pre></div>
<p>Como resultado, √© poss√≠vel que a varia√ß√£o ambiental espacialmente estruturada √© o principal efeito sobre a composi√ß√£o de esp√©cies. Uma maneira de visualizar a contribui√ß√£o relativa de diferentes matrizes (ambiental e espacial, por exemplo) √© utilizar o m√©todo de parti√ß√£o de vari√¢ncia. O resultado deste modelo indica que, de fato, n√£o existe efeito direto das vari√°veis ambientais e sim do componente representado pela autocorrela√ß√£o espacial dessas vari√°veis (Figura <a href="cap9.html#fig:fig-rda-parcial">9.16</a>).</p>
<div class="sourceCode" id="cb380"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Triplot da RDA</span>
<span class="co"># Parti√ß√£o de vari√¢ncia.</span>
<span class="va">pv.birds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/varpart.html">varpart</a></span><span class="op">(</span><span class="va">species.hel</span>, <span class="va">env.pad.cat</span>, <span class="va">spatial.pred</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">pv.birds</span>, cutoff <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Diagrama de Venn: parti√ß√£o de vari√¢ncia"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-rda-parcial"></span>
<img src="livro_files/figure-html/fig-rda-parcial-1.png" alt="Diagrama de Venn mostrando a parti√ß√£o de vari√¢ncia da RDA." width="100%" height="100%"><p class="caption">
Figura 9.16: Diagrama de Venn mostrando a parti√ß√£o de vari√¢ncia da RDA.
</p>
</div>
</div>
<div id="an√°lise-de-redund√¢ncia-baseada-em-dist√¢ncia-db-rda" class="section level3" number="9.5.3">
<h3>
<span class="header-section-number">9.5.3</span> An√°lise de Redund√¢ncia baseada em dist√¢ncia (db-RDA)<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-redund%C3%A2ncia-baseada-em-dist%C3%A2ncia-db-rda"><i class="fas fa-link"></i></a>
</h3>
<p>Acima, apresentamos a an√°lise RDA que permite comparar, por exemplo, se vari√°veis ambientais determinam a varia√ß√£o na composi√ß√£o de esp√©cies. A RDA utiliza os dados brutos de composi√ß√£o de esp√©cies e √© baseada em uma PCA (i.e., requer dist√¢ncia euclidiana). Por√©m, em algumas situa√ß√µes √© necess√°rio utilizar outras medidas de dist√¢ncia tais como Bray-Curtis ou Gower. Esta analise √© bastante √∫til tamb√©m quando a matriz resposta j√° √© uma matriz de dist√¢ncia, tais como as que s√£o geradas por decomposi√ß√£o da diversidade beta. Neste caso, Legendre &amp; Anderson <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_distance-based_1999" role="doc-biblioref">1999</a>)</span> propuseram a an√°lise db-RDA (RDA baseada em dist√¢ncia). O primeiro passo da an√°lise √© gerar uma matriz de dist√¢ncia a partir da matriz bruta (e.g., composi√ß√£o de esp√©cies). Depois, a t√©cnica executa uma PCoA (corrigindo potenciais autovetores com autovalores negativos; ver discuss√£o acima) para comparar com os termos do modelo (matriz <strong>X</strong>, como na RDA).
Para exemplificar como esta an√°lise pode ser implementada no R, vamos usar o mesmo exemplo demontrado na an√°lise RDA (ver acima). Por√©m, vamos fazer um ajuste sutil na pergunta ‚Äúo clima e a altitude modificam a dissimilaridade (diversidade beta) de esp√©cies de aves?‚Äù Veja que neste caso, estamos perguntando diretamente sobre uma medida de diversidade beta, que ser√° calculada com o m√©todo Bray-Curtis. As vari√°veis preditoras ser√£o as mesmas obtidas no exemplo da RDA: <code>env.pad.cat</code>.</p>
<p><strong>An√°lise</strong></p>
<div class="sourceCode" id="cb381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Passo 1: transforma√ß√£o de hellinger da matriz de esp√©cies</span>
<span class="co"># caso tenha dados de abund√¢ncia.</span>
<span class="va">species.hel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span><span class="va">species</span>, <span class="st">"hellinger"</span><span class="op">)</span>

<span class="co">## Passo 2: gerar matriz de dist√¢ncia (Diversidade beta: Bray-Curtis)</span>
<span class="va">dbeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">species.hel</span>, <span class="st">"bray"</span><span class="op">)</span>

<span class="co">## Passo 2: dbRDA </span>
<span class="va">dbrda.bird</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/capscale.html">capscale</a></span> <span class="op">(</span><span class="va">dbeta</span><span class="op">~</span><span class="va">rain.jul</span><span class="op">+</span><span class="va">maxi.jul</span><span class="op">+</span><span class="va">altitude</span>, data<span class="op">=</span><span class="va">env.pad.cat</span><span class="op">)</span>

<span class="co"># Para interpretar, √© necess√°rio saber a signific√¢ncia dos eixos para representar a rela√ß√£o entre as vari√°veis preditoras e a composi√ß√£o de esp√©cies</span>
<span class="va">db.res.axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca</a></span><span class="op">(</span><span class="va">dbrda.bird</span>, by <span class="op">=</span> <span class="st">"axis"</span><span class="op">)</span> 
<span class="va">db.res.axis</span>
<span class="co">#&gt; Permutation test for capscale under reduced model</span>
<span class="co">#&gt; Forward tests for axes</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: capscale(formula = dbeta ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span>
<span class="co">#&gt;          Df SumOfSqs       F Pr(&gt;F)    </span>
<span class="co">#&gt; CAP1      1 0.274186 16.9355  0.001 ***</span>
<span class="co">#&gt; CAP2      1 0.044965  2.7773  0.110    </span>
<span class="co">#&gt; CAP3      1 0.018141  1.1205  0.656    </span>
<span class="co">#&gt; CAP4      1 0.009500  0.5868  0.788    </span>
<span class="co">#&gt; Residual 18 0.291420                   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Em seguida, √© poss√≠vel identificar quais s√£o as vari√°veis que contribuem ou que mais contribuem para a varia√ß√£o na composi√ß√£o de esp√©cies </span>
<span class="va">db.res.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca</a></span><span class="op">(</span><span class="va">rda.bird</span>, by <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span> <span class="co">## Qual vari√°vel?</span>
<span class="va">db.res.var</span>
<span class="co">#&gt; Permutation test for rda under reduced model</span>
<span class="co">#&gt; Terms added sequentially (first to last)</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span>
<span class="co">#&gt;          Df Variance      F Pr(&gt;F)    </span>
<span class="co">#&gt; rain.jul  1 0.036514 9.5936  0.001 ***</span>
<span class="co">#&gt; maxi.jul  1 0.011264 2.9596  0.015 *  </span>
<span class="co">#&gt; altitude  2 0.019071 2.5053  0.011 *  </span>
<span class="co">#&gt; Residual 18 0.068510                  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Al√©m disso, √© poss√≠vel obter o valor do R2 do modelo</span>
<span class="va">db_r_quadr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/RsquareAdj.html">RsquareAdj</a></span><span class="op">(</span><span class="va">dbrda.bird</span><span class="op">)</span>
<span class="va">db_r_quadr</span>
<span class="co">#&gt; $r.squared</span>
<span class="co">#&gt; [1] 0.6116758</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $adj.r.squared</span>
<span class="co">#&gt; [1] 0.5253816</span></code></pre></div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Assim como apresentado na RDA, os resultados obtidos em <code>db.res.var</code> sugerem que as vari√°veis <code>rain.jul</code>, <code>maxi.jul</code> e <code>altitude</code> afetam a diversidade beta de aves. O valor do <em>R<sup>2</sup></em> ajustado (0.495) sugere forte rela√ß√£o entre o gradiente ambiental e a diversidade beta. A compara√ß√£o entre o valor do <code>db_r_quadr</code> e <code>r_quadr</code> indica que a db-RDA teve melhor ajuste para comparar o mesmo conjunto de dados.</p>
</div>
</div>
<div id="permanova" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> PERMANOVA<a class="anchor" aria-label="anchor" href="#permanova"><i class="fas fa-link"></i></a>
</h2>
<p>A PERMANOVA √© uma sigla, em ingl√™s, de <em>Permutational Multivariate Analysis of Variance</em>, an√°lise proposta por Marti Anderson <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson_new_2001" role="doc-biblioref">M. J. Anderson 2001</a>)</span>. A PERMANOVA √© usada para testar hip√≥teses multivariadas que comparam a abund√¢ncia de diferentes esp√©cies em resposta a diferentes tratamentos ou gradientes ambientais. Essa an√°lise foi desenvolvida como forma de solucionar algumas limita√ß√µes da tradicional ANOVA multivariada (MANOVA). Em especial, o pressuposto da MANOVA de distribui√ß√£o normal multivariada √© raramente encontrado em dados ecol√≥gicos.</p>
<p>O primeiro passo da PERMANOVA √© selecionar uma medida de dist√¢ncia apropriada aos dados e, al√©m disso, verificar a necessidade de padroniza√ß√£o ou transforma√ß√£o dos dados. Em seguida, as dist√¢ncias s√£o comparadas entre os grupos de interesse (por exemplo, tratamento versus controle) usando a estat√≠stica <em>F</em> de maneira muito parecida com uma ANOVA (Cap√≠tulo <a href="cap7.html#cap7">7</a>), chamada de <em>pseudo-F</em>:</p>
<p><span class="math display">\[F_pseudo = (SSa / SSr)*[(N-g) / (g-1)]\]</span></p>
<p>Nessa equa√ß√£o</p>
<ul>
<li>
<em>SSa</em> representa a soma dos quadrados entre grupos</li>
<li>
<em>SSr</em> a soma de quadrados dentro do grupo (residual)</li>
<li>
<em>N</em> o n√∫mero de unidades amostrais</li>
<li>
<em>g</em> os grupos (ou n√≠veis da vari√°vel categ√≥rica)</li>
</ul>
<p>Esta f√≥rmula do <em>pseudo-F</em> √© espec√≠fica para desenho experimental com um fator. Outros desenhos mais complexos s√£o apresetandos em Anderson <span class="citation"><a href="refer%C3%AAncias.html#ref-anderson_permutational_2017" role="doc-biblioref">M. J. Anderson</a> (<a href="refer%C3%AAncias.html#ref-anderson_permutational_2017" role="doc-biblioref">2017</a>)</span>. O c√°lculo do valor de probilidade √© realizado por m√©todos de permuta√ß√£o que s√£o discutidos em Anderson &amp; Ter Braak <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson_permutation_2003" role="doc-biblioref">2003</a>)</span>.</p>
<p><strong>Exemplo 1</strong></p>
<p>Esp√©cies de aves que ocorrem em localidades com diferentes altitudes.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>O clima e a altitude modificam a composi√ß√£o de esp√©cies de aves?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Diferen√ßas clim√°ticas (temperatura e chuva) e altitudinais alteram a composi√ß√£o de esp√©cies de aves</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Preditoras: Temperatura e chuva (cont√≠nuas) e altitude (categ√≥rica com tr√™s n√≠veis)</li>
<li>Dependente: composi√ß√£o de esp√©cies de aves</li>
</ul>
<div class="sourceCode" id="cb382"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Composi√ß√£o de esp√©cies padronizar com m√©todo de Hellinger</span>
<span class="va">species.hel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, method <span class="op">=</span> <span class="st">"hellinger"</span><span class="op">)</span>

<span class="co">## Matriz de dist√¢ncia com m√©todo Bray-Curtis</span>
<span class="va">sps.dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species.hel</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></code></pre></div>
<p>Para reduzir o n√∫mero de vari√°veis no modelo, voc√™ pode considerar duas abordangens. A primeira, e mais importante delas, √© manter somente vari√°veis preditoras que voc√™ tenha raz√£o biol√≥gica para mant√™-la e, al√©m disso, que esteja relacionada com suas hip√≥teses. Assim, uma vez que voc√™ j√° removeu vari√°veis que n√£o possuem relev√¢ncia biol√≥gica, voc√™ deve usar diferentes m√©todos para remover as vari√°veis muito correlacionadas (<em>forward selection</em>, <em>Variance Inflation Factor (VIF)</em>, entre outros). Neste exemplo, vamos simplesmente fazer uma correla√ß√£o m√∫ltipla e remover as vari√°veis com correla√ß√£o maior do que 0.9 ou -0.9. A fun√ß√£o <code><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs()</a></code> mostra um gr√°fico bem did√°tico para representar a rela√ß√£o entre todas as vari√°veis e o valor (r) desta correla√ß√£o (mais em Cap√≠tulo <a href="cap7.html#cap7">7</a>) (Figura <a href="cap9.html#fig:fig-permanova-prev">9.17</a>).</p>
<div class="sourceCode" id="cb383"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Verifica correla√ß√£o entre as vari√°veis</span>
<span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="co">## Ap√≥s verificar a estrutura de correla√ß√£o, vamos manter somente tr√™s vari√°veis</span>
<span class="va">env2</span> <span class="op">&lt;-</span> <span class="va">env</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mini.jan"</span>, <span class="st">"rain.tot"</span>, <span class="st">"altitude"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-permanova-prev"></span>
<img src="livro_files/figure-html/fig-permanova-prev-1.png" alt="Correlograma mostrando a correla√ß√£o entre as vari√°veis." width="100%" height="100%"><p class="caption">
Figura 9.17: Correlograma mostrando a correla√ß√£o entre as vari√°veis.
</p>
</div>
<p>Ap√≥s selecionar as vari√°veis do modelo, vamos executar a PERMANOVA e entender as principais etapas para interpretar corretamente o teste. A fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/adonis.html">adonis()</a></code> do pacote <code>vegan</code> √© uma boa op√ß√£o. Por√©m, √© importante referir o programa PRIMER e PERMANOVA+ como √≥tima op√ß√£o para implementar a PERMANOVA e ter maior controle em desenhos complexos <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson_permanova+_2008" role="doc-biblioref">M. J. Anderson, Gorley, and Clarke 2008</a>)</span>. Assim como nos modelos lineares apresentados no Cap√≠tulo <a href="cap7.html#cap7">7</a>, os argumento seguem o mesmo formato, com vari√°vel dependente separada por um ‚Äú~‚Äù das vari√°veis preditoras. Por√©m, alguns autores demonstraram que a PERMANOVA (assim como Mantel e ANOSIM) n√£o pode identificar se diferen√ßas significativas do teste (usando a estat√≠stica <em>pseudo-F</em>) se devem a diferen√ßas no posi√ß√£o, na dispers√£o ou ambos. Ou seja, ao comparar grupos n√£o √© poss√≠vel identificar se existe mudan√ßas de composi√ß√£o (posi√ß√£o) ou a varia√ß√£o da composi√ß√£o de esp√©cies dentro de um grupo (dispers√£o) √© maior do que a varia√ß√£o dentro do outro grupo <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson_permanova_2013" role="doc-biblioref">M. J. Anderson and Walsh 2013</a>)</span>. Para solucionar este problema, √© poss√≠vel combinar a PERMANOVA com a an√°lise PERMDISP (ou BETADISPER, como chamado no pacote <code>vegan</code> implementado atrav√©s da fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper()</a></code>). Esta an√°lise permite comparar se existe heterogeneidade nas vari√¢ncias entre grupos. Deste modo, com a presen√ßa de heterogeneidade de vari√¢ncias (valor do BETADISPER significativo), √© poss√≠vel saber que as diferen√ßas entre os grupos ocorre principalmente por diferen√ßas na dispers√£o e n√£o, necessariamente, de posi√ß√£o. Mais detalhes sobre a relev√¢ncia de combinar essas duas an√°lises est√£o dispon√≠veis em Anderson &amp; Walsh <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson_permanova_2013" role="doc-biblioref">2013</a>)</span>.</p>
<div class="sourceCode" id="cb384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## PERMANOVA</span>
<span class="va">perm.aves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/adonis.html">adonis2</a></span><span class="op">(</span><span class="va">sps.dis</span> <span class="op">~</span> <span class="va">mini.jan</span> <span class="op">+</span> <span class="va">rain.tot</span> <span class="op">+</span> <span class="va">altitude</span>, data <span class="op">=</span> <span class="va">env2</span><span class="op">)</span>
<span class="va">perm.aves</span> <span class="co">### Diferen√ßas entre os tratamentos?</span>
<span class="co">#&gt; Permutation test for adonis under reduced model</span>
<span class="co">#&gt; Terms added sequentially (first to last)</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; adonis2(formula = sps.dis ~ mini.jan + rain.tot + altitude, data = env2)</span>
<span class="co">#&gt;          Df SumOfSqs      R2      F Pr(&gt;F)    </span>
<span class="co">#&gt; mini.jan  1  0.09069 0.15997 6.3307  0.001 ***</span>
<span class="co">#&gt; rain.tot  1  0.12910 0.22771 9.0118  0.001 ***</span>
<span class="co">#&gt; altitude  2  0.08929 0.15749 3.1163  0.011 *  </span>
<span class="co">#&gt; Residual 18  0.25787 0.45483                  </span>
<span class="co">#&gt; Total    22  0.56695 1.00000                  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co">## BETADISPER</span>
<span class="va">betad.aves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper</a></span><span class="op">(</span><span class="va">sps.dis</span>, <span class="va">env2</span><span class="op">$</span><span class="va">altitude</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">permutest</a></span><span class="op">(</span><span class="va">betad.aves</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Permutation test for homogeneity of multivariate dispersions</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: Distances</span>
<span class="co">#&gt;           Df    Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)</span>
<span class="co">#&gt; Groups     2 0.0042643 0.0021322 1.4672    999  0.265</span>
<span class="co">#&gt; Residuals 20 0.0290636 0.0014532</span></code></pre></div>
<p>Em nosso exemplo, a temperatura, precipita√ß√£o e altitude afetaram a varia√ß√£o na composi√ß√£o de esp√©cies. Por√©m, para identificar se as diferen√ßas de composi√ß√£o entre os n√≠veis da vari√°vel altitude, √© necess√°rio interpretar os resultados da an√°lise BETADISPER. O c√≥digo <code>permutest(betad.aves)</code> mostra que o valor de probabilidade da an√°lise foi de 0.253, ou seja, a hip√≥tese nula de que a vari√¢ncia entre grupos √© homog√™nea √© aceita. Assim, n√£o existe diferen√ßas na dispers√£o entre grupos, sugerindo que a diferen√ßa encontrada na PERMANOVA (objeto <code>perm.aves</code>) se deve, em parte, √† mudan√ßa na composi√ß√£o de esp√©cies de aves entre diferentes altitudes (R<sup>2</sup> = 0.135). Al√©m disso, a precipita√ß√£o (R<sup>2</sup> = 0.183) e temperatura (R<sup>2</sup> = 0.127) foram fatores importantes na varia√ß√£o da composi√ß√£o de esp√©cies.</p>
<p>Como falado anteriormente, as an√°lises de ordena√ß√£o irrestritas (PCA, PCoA, nMDS) s√£o utilizadas para explorar dados. Uma maneira poderosa de us√°-las √© combinando com an√°lises que testam hip√≥teses, como PERMANOVA e RDA. A literatura ecol√≥gica tem usado a An√°lise de Escalonamento n√£o-M√©trico (<em>non-Metric Multidimensional Scaling</em> - nMDS) combinado com an√°lises multidimensionais de vari√¢ncia (como a PERMANOVA) para visualiza√ß√£o da similaridade na composi√ß√£o de esp√©cies dentro e entre grupos. A seguir, implementamos o nMDS na matriz de composi√ß√£o de esp√©cies de √°caros (Figura <a href="cap9.html#fig:fig-nmds">9.18</a>).</p>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Matriz de dist√¢ncia representando a varia√ß√£o na composi√ß√£o de esp√©cies (m√©todo Bray-Curtis)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">sps.dis</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt;           S01        S02        S03       S04       S05       S06</span>
<span class="co">#&gt; S01 0.0000000 0.15133734 0.16720405 0.2559122 0.2559882 0.2588892</span>
<span class="co">#&gt; S02 0.1513373 0.00000000 0.04114702 0.1190172 0.1289682 0.1391056</span>
<span class="co">#&gt; S03 0.1672040 0.04114702 0.00000000 0.1420233 0.1358127 0.1410867</span>
<span class="co">#&gt; S04 0.2559122 0.11901720 0.14202325 0.0000000 0.1140283 0.1199803</span>
<span class="co">#&gt; S05 0.2559882 0.12896823 0.13581271 0.1140283 0.0000000 0.2129054</span>
<span class="co">#&gt; S06 0.2588892 0.13910558 0.14108668 0.1199803 0.2129054 0.0000000</span>

<span class="co">## √â preciso calcular uma primeira "melhor" solu√ß√£o do nMDS</span>
<span class="va">sol1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="va">sps.dis</span><span class="op">)</span>
<span class="co">#&gt; Run 0 stress 0.1344042 </span>
<span class="co">#&gt; Run 1 stress 0.3825954 </span>
<span class="co">#&gt; Run 2 stress 0.1272417 </span>
<span class="co">#&gt; ... New best solution</span>
<span class="co">#&gt; ... Procrustes: rmse 0.07890815  max resid 0.3526073 </span>
<span class="co">#&gt; Run 3 stress 0.1344042 </span>
<span class="co">#&gt; Run 4 stress 0.1338432 </span>
<span class="co">#&gt; Run 5 stress 0.1626783 </span>
<span class="co">#&gt; Run 6 stress 0.1336481 </span>
<span class="co">#&gt; Run 7 stress 0.1272417 </span>
<span class="co">#&gt; ... Procrustes: rmse 6.723274e-06  max resid 1.889203e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 8 stress 0.1338432 </span>
<span class="co">#&gt; Run 9 stress 0.1378506 </span>
<span class="co">#&gt; Run 10 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 0.0001085155  max resid 0.0004162969 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 11 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 4.197901e-05  max resid 0.000160606 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 12 stress 0.1378506 </span>
<span class="co">#&gt; Run 13 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 5.310796e-05  max resid 0.0001988503 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 14 stress 0.1580523 </span>
<span class="co">#&gt; Run 15 stress 0.1344042 </span>
<span class="co">#&gt; Run 16 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 2.586759e-05  max resid 9.827497e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 17 stress 0.1584787 </span>
<span class="co">#&gt; Run 18 stress 0.1344042 </span>
<span class="co">#&gt; Run 19 stress 0.1344042 </span>
<span class="co">#&gt; Run 20 stress 0.1344042 </span>
<span class="co">#&gt; *** Solution reached</span>

<span class="co">## Melhor solu√ß√£o</span>
<span class="co"># Depois, executar a mesma fun√ß√£o, mas utilizando uma "melhor solu√ß√£o inicial" para evitar resultdos sub√≥timos no nMDS .</span>
<span class="va">nmds.beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="va">sps.dis</span>, previous.best <span class="op">=</span> <span class="va">sol1</span><span class="op">)</span>
<span class="co">#&gt; Starting from 2-dimensional configuration</span>
<span class="co">#&gt; Run 0 stress 0.1272417 </span>
<span class="co">#&gt; Run 1 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 2.188819e-05  max resid 7.340362e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 2 stress 0.1338432 </span>
<span class="co">#&gt; Run 3 stress 0.1584788 </span>
<span class="co">#&gt; Run 4 stress 0.1344043 </span>
<span class="co">#&gt; Run 5 stress 0.1338433 </span>
<span class="co">#&gt; Run 6 stress 0.1336481 </span>
<span class="co">#&gt; Run 7 stress 0.1344042 </span>
<span class="co">#&gt; Run 8 stress 0.1338432 </span>
<span class="co">#&gt; Run 9 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 2.708248e-05  max resid 0.0001008894 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 10 stress 0.1336481 </span>
<span class="co">#&gt; Run 11 stress 0.1344042 </span>
<span class="co">#&gt; Run 12 stress 0.3798204 </span>
<span class="co">#&gt; Run 13 stress 0.1336481 </span>
<span class="co">#&gt; Run 14 stress 0.1336481 </span>
<span class="co">#&gt; Run 15 stress 0.1344042 </span>
<span class="co">#&gt; Run 16 stress 0.1336481 </span>
<span class="co">#&gt; Run 17 stress 0.1338432 </span>
<span class="co">#&gt; Run 18 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 2.303898e-05  max resid 8.758403e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 19 stress 0.1344042 </span>
<span class="co">#&gt; Run 20 stress 0.1378506 </span>
<span class="co">#&gt; *** Solution reached</span>

<span class="co">## Stress</span>
<span class="co"># O stress √© o valor mais importante para interpretar a qualidade da ordena√ß√£o.</span>
<span class="va">nmds.beta</span><span class="op">$</span><span class="va">stress</span> <span class="co"># valor ideal entre 0 e 0.2</span>
<span class="co">#&gt; [1] 0.1272417</span>

<span class="co">## Exportar os valores para fazer gr√°fico </span>
<span class="va">dat.graf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html">scores</a></span><span class="op">(</span><span class="va">nmds.beta</span><span class="op">)</span>, altitude <span class="op">=</span> <span class="va">env2</span><span class="op">$</span><span class="va">altitude</span><span class="op">)</span>

<span class="co">## Definir os grupos ("HULL") para serem categorizados no gr√°fico </span>
<span class="va">grp.mon</span> <span class="op">&lt;-</span> <span class="va">dat.graf</span><span class="op">[</span><span class="va">dat.graf</span><span class="op">$</span><span class="va">altitude</span> <span class="op">==</span> <span class="st">"Montanhoso"</span>, <span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/grDevices/chull.html">chull</a></span><span class="op">(</span><span class="va">dat.graf</span><span class="op">[</span><span class="va">dat.graf</span><span class="op">$</span><span class="va">altitude</span> <span class="op">==</span> <span class="st">"Montanhoso"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NMDS1"</span>, <span class="st">"NMDS2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span>

<span class="va">grp.int</span> <span class="op">&lt;-</span> <span class="va">dat.graf</span><span class="op">[</span><span class="va">dat.graf</span><span class="op">$</span><span class="va">altitude</span> <span class="op">==</span> <span class="st">"Intermedi√°rio"</span>, <span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/grDevices/chull.html">chull</a></span><span class="op">(</span><span class="va">dat.graf</span><span class="op">[</span><span class="va">dat.graf</span><span class="op">$</span><span class="va">altitude</span> <span class="op">==</span> <span class="st">"Intermedi√°rio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NMDS1"</span>, <span class="st">"NMDS2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span>

<span class="va">grp.pla</span> <span class="op">&lt;-</span> <span class="va">dat.graf</span><span class="op">[</span><span class="va">dat.graf</span><span class="op">$</span><span class="va">altitude</span> <span class="op">==</span> <span class="st">"Plano"</span>, <span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/grDevices/chull.html">chull</a></span><span class="op">(</span><span class="va">dat.graf</span><span class="op">[</span><span class="va">dat.graf</span><span class="op">$</span><span class="va">altitude</span> <span class="op">==</span> <span class="st">"Plano"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NMDS1"</span>, <span class="st">"NMDS2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span>

<span class="co">## Combinar dados dos grupos para cada Convex Hull</span>
<span class="va">hull.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html">rbind</a></span><span class="op">(</span><span class="va">grp.mon</span>, <span class="va">grp.int</span>, <span class="va">grp.pla</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">hull.data</span><span class="op">)</span>
<span class="co">#&gt;           NMDS1       NMDS2      altitude</span>
<span class="co">#&gt; S04 -0.10578586 -0.10682766    Montanhoso</span>
<span class="co">#&gt; S01 -0.25332406  0.04199004    Montanhoso</span>
<span class="co">#&gt; S11 -0.12504415  0.14477005    Montanhoso</span>
<span class="co">#&gt; S15  0.09166059  0.09857114    Montanhoso</span>
<span class="co">#&gt; S18  0.01968127 -0.12417579 Intermedi√°rio</span>
<span class="co">#&gt; S06 -0.16053825 -0.08924030 Intermedi√°rio</span>

<span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat.graf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NMDS1</span>, y <span class="op">=</span> <span class="va">NMDS2</span>, color <span class="op">=</span> <span class="va">altitude</span>, shape <span class="op">=</span> <span class="va">altitude</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hull.data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">altitude</span>, group <span class="op">=</span> <span class="va">altitude</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"darkorchid"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"darkorchid"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"NMDS1"</span>, y <span class="op">=</span> <span class="st">"NMDS2"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-nmds"></span>
<img src="livro_files/figure-html/fig-nmds-1.png" alt="Biplot mostrando o resultado do nMDS." width="100%" height="100%"><p class="caption">
Figura 9.18: Biplot mostrando o resultado do nMDS.
</p>
</div>
</div>
<div id="mantel-e-mantel-parcial" class="section level2" number="9.7">
<h2>
<span class="header-section-number">9.7</span> Mantel e Mantel parcial<a class="anchor" aria-label="anchor" href="#mantel-e-mantel-parcial"><i class="fas fa-link"></i></a>
</h2>
<p>O teste de Mantel se aplica quando temos duas ou mais matrizes de dist√¢ncia (triangulares). Em estudos ecol√≥gicos, essas matrizes normalmente descrevem dados de dist√¢ncia ou (dis)similaridade na composi√ß√£o de esp√©cies, dist√¢ncia geogr√°fica, e similaridade ambiental. Mas este teste tamb√©m √© amplamente aplicado na √°rea de gen√©tica de paisagem para testar hip√≥teses sobre como a composi√ß√£o gen√©tica de uma popula√ß√£o varia em fun√ß√£o do ambiente e/ou espa√ßo geogr√°fico <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2010" role="doc-biblioref">Legendre and Fortin 2010</a>)</span>. O teste nada mais √© do que uma generaliza√ß√£o do coeficiente de correla√ß√£o de Pearson (Cap√≠tulo <a href="cap7.html#cap7">7</a>) para lidar com matrizes de dist√¢ncia. Como essas matrizes descrevem a rela√ß√£o entre v√°rios pares de locais, temos a repeti√ß√£o do mesmo local em outros pares. Neste caso √© preciso um procedimento semelhante ao de corre√ß√£o para m√∫ltiplos testes.</p>
<p>J√° o Mantel parcial pretende testar a correla√ß√£o entre duas matrizes controlando para o efeito de uma terceira. Por exemplo, testar a associa√ß√£o entre a dissimilaridade na composi√ß√£o de esp√©cies e dissimilaridade ambiental, controlando para a dist√¢ncia geogr√°fica entre os locais. Isso nos permite levar em conta a poss√≠vel autocorrela√ß√£o espacial nas vari√°veis ambientais, ou seja, estar√≠amos testando de fato o efeito da dissimilaridade ambiental ‚Äúpura‚Äù na dissimilaridae na composi√ß√£o de esp√©cies, evitando o efeito do espa√ßo em si. Portanto, note que sempre estamos raciocinando em termos de (dis)similaridade e n√£o dos dados brutos em si, seja composi√ß√£o de esp√©cies ou vari√°veis ambientais. √â importante ter isto em mente na hora de interpretar os resultados.</p>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar um conjunto de dados que cont√©m girinos de esp√©cies de anf√≠bios anuros coletados em 14 po√ßas d‚Äô√°gua e os respectivos dados de vari√°veis ambientais destas mesmas po√ßas <span class="citation">(<a href="refer%C3%AAncias.html#ref-provete_broad-scale_2014" role="doc-biblioref">Provete et al. 2014</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existe correla√ß√£o entre a dissimilaridade na composi√ß√£o de esp√©cies de girinos e a dissimilaridade ambiental?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Assumindo que processos baseados no nicho sejam predominantes, quanto mais diferentes as po√ßas forem maior ser√° a diferen√ßa na composi√ß√£o de esp√©cies</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Vari√°veis: a matriz de dist√¢ncia (Bray-Curtis) da composi√ß√£o das esp√©cies e outra matriz de dist√¢ncia (Euclideana) das vari√°veis ambientais</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Aqui vamos utilizar al√©m do conjunto de dados <code>bocaina</code> j√° conhecido, outras duas matrizes dispon√≠veis no pacote <code>ecodados</code>: <code>bocaina.xy</code> e <code>bocaina.env</code>, que cont√™m as coordenadas geogr√°ficas e vari√°veis ambientais das po√ßas, respectivamente.</p>
<div class="sourceCode" id="cb386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bocaina.env</span><span class="op">)</span>
<span class="co">#&gt;       pH  tur   DO  temp veg  dep canopy conduc hydro area</span>
<span class="co">#&gt; PP3 7.07 0.66 2.26 18.93  30 0.35   30.3 0.0100   per  139</span>
<span class="co">#&gt; PP4 6.85 0.33 2.78 20.53   0 0.33   32.1 0.0100   per  223</span>
<span class="co">#&gt; AP1 6.64 0.40 4.09 15.26   5 3.50   42.0 0.0105   per  681</span>
<span class="co">#&gt; AP2 6.13 0.80 3.47 15.40  70 2.50   82.0 0.0300   per  187</span>
<span class="co">#&gt; PP1 5.80 0.75 3.22 16.75  70 0.70   91.4 0.0100   per   83</span>
<span class="co">#&gt; PP2 5.32 4.00 2.10 15.90  95 0.27   75.3 0.0100   per  108</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bocaina.xy</span><span class="op">)</span>
<span class="co">#&gt;         Long      Lat</span>
<span class="co">#&gt; PT5 -44.6239 -22.7243</span>
<span class="co">#&gt; PP3 -44.6340 -22.7228</span>
<span class="co">#&gt; PP4 -44.6334 -22.7228</span>
<span class="co">#&gt; BP4 -44.6212 -22.7262</span>
<span class="co">#&gt; BP2 -44.6155 -22.7289</span>
<span class="co">#&gt; PT1 -44.6170 -22.7350</span>

<span class="co">## Matriz de dist√¢ncia geogr√°fica</span>
<span class="va">Dist.km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/fields/man/rdist.earth.html">rdist.earth</a></span><span class="op">(</span><span class="va">bocaina.xy</span>, miles<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span> <span class="co"># matriz de dist√¢ncia geogr√°fica (geod√©sica) considerando a curvatura da Terra</span>

<span class="co">## Padroniza√ß√µes</span>
<span class="va">comp.bo.pad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">bocaina</span><span class="op">)</span>, <span class="st">"hellinger"</span><span class="op">)</span>
<span class="va">env.bocaina</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span><span class="va">bocaina.env</span><span class="op">[</span>,<span class="op">-</span><span class="fl">9</span><span class="op">]</span>, <span class="st">"standardize"</span><span class="op">)</span>

<span class="co">## Similaridades</span>
<span class="va">simil.bocaina</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">comp.bo.pad</span>, <span class="st">"bray"</span><span class="op">)</span>
<span class="va">simil.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">env.bocaina</span>, <span class="st">"euclidian"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mantel</span>
<span class="co"># Espa√ßo vs. ambiente</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mantel.html">mantel</a></span><span class="op">(</span><span class="va">Dist.km</span>, <span class="va">simil.env</span><span class="op">)</span> 
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic based on Pearson's product-moment correlation </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mantel(xdis = Dist.km, ydis = simil.env) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic r: 0.4848 </span>
<span class="co">#&gt;       Significance: 0.005 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Upper quantiles of permutations (null model):</span>
<span class="co">#&gt;   90%   95% 97.5%   99% </span>
<span class="co">#&gt; 0.250 0.330 0.393 0.447 </span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>

<span class="co"># Espa√ßo vs. composi√ß√£o</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mantel.html">mantel</a></span><span class="op">(</span><span class="va">Dist.km</span>, <span class="va">simil.bocaina</span><span class="op">)</span> 
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic based on Pearson's product-moment correlation </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mantel(xdis = Dist.km, ydis = simil.bocaina) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic r: 0.3745 </span>
<span class="co">#&gt;       Significance: 0.007 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Upper quantiles of permutations (null model):</span>
<span class="co">#&gt;   90%   95% 97.5%   99% </span>
<span class="co">#&gt; 0.149 0.215 0.279 0.335 </span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>

<span class="co"># Ambiente vs. composi√ß√£o</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mantel.html">mantel</a></span><span class="op">(</span><span class="va">simil.env</span>, <span class="va">simil.bocaina</span><span class="op">)</span> 
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic based on Pearson's product-moment correlation </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mantel(xdis = simil.env, ydis = simil.bocaina) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic r: 0.2898 </span>
<span class="co">#&gt;       Significance: 0.02 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Upper quantiles of permutations (null model):</span>
<span class="co">#&gt;   90%   95% 97.5%   99% </span>
<span class="co">#&gt; 0.171 0.227 0.266 0.322 </span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span></code></pre></div>
<p>Vamos agora fazer os gr√°ficos relacionando as matrizes de similaridade dos dados (Figura <a href="cap9.html#fig:fig-mantel">9.19</a>).</p>
<div class="sourceCode" id="cb388"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="va">matrix.bocaina.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">simil.bocaina</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span>, 
                                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">simil.env</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>

<span class="va">matrix.dist.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Dist.km</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span>, 
                              y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">simil.env</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>

<span class="va">matrix.dist.bocaina</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Dist.km</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span>, 
                              y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">simil.bocaina</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>

<span class="co">## Gr√°ficos</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">matrix.bocaina.env</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Similaridade Bocaina"</span>, 
         y <span class="op">=</span> <span class="st">"Similaridade Ambiental"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">matrix.dist.env</span> , <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Dist√¢ncia geogr√°fica (km)"</span>, 
         y <span class="op">=</span> <span class="st">"Similaridade Ambiental"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">matrix.dist.bocaina</span> , <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Dist√¢ncia geogr√°fica (km)"</span>, 
         y <span class="op">=</span> <span class="st">"Similaridade (Bray-Curtis)"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-mantel"></span>
<img src="livro_files/figure-html/fig-mantel-1.png" alt="Rela√ß√£o das matrizes de (dis)similaridade dos dados." width="100%" height="100%"><img src="livro_files/figure-html/fig-mantel-2.png" alt="Rela√ß√£o das matrizes de (dis)similaridade dos dados." width="100%" height="100%"><img src="livro_files/figure-html/fig-mantel-3.png" alt="Rela√ß√£o das matrizes de (dis)similaridade dos dados." width="100%" height="100%"><p class="caption">
Figura 9.19: Rela√ß√£o das matrizes de (dis)similaridade dos dados.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Os resultados mostraram que existe uma rela√ß√£o positiva, embora fraca, entre a dissimilaridade ambiental e a dissimilaridade na composi√ß√£o de esp√©cies. Este resultado est√° de acordo com a nossa hip√≥tese inicial. No entanto, vimos tamb√©m que existe uma rela√ß√£o positiva e significativa entre a dist√¢ncia em linha reta entre as po√ßas e a dissimilaridade ambiental. Logo, para de fato testar a rela√ß√£o entre o ambiente e a composi√ß√£o de esp√©cies temos de levar em conta o espa√ßo.</p>
<p>Para isto temos de realizar um teste de Mantel Parcial.</p>
<div class="sourceCode" id="cb389"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mantel Parcial</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mantel.html">mantel.partial</a></span><span class="op">(</span><span class="va">simil.bocaina</span>, <span class="va">simil.env</span>, <span class="va">Dist.km</span><span class="op">)</span> <span class="co">#comp. vs. ambiente controlando o espa√ßo</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Partial Mantel statistic based on Pearson's product-moment correlation </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mantel.partial(xdis = simil.bocaina, ydis = simil.env, zdis = Dist.km) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic r: 0.1334 </span>
<span class="co">#&gt;       Significance: 0.123 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Upper quantiles of permutations (null model):</span>
<span class="co">#&gt;   90%   95% 97.5%   99% </span>
<span class="co">#&gt; 0.148 0.200 0.229 0.278 </span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span></code></pre></div>
<p>Agora sim, vimos que a rela√ß√£o entre ambiente e esp√©cies se mant√©m, mas que a for√ßa dessa rela√ß√£o diminuiu bastante (veja o valor de r) quando controlamos o espa√ßo.</p>
</div>
<div id="mantel-espacial-com-modelo-nulo-restrito-considerando-autocorrela√ß√£o-espacial" class="section level2" number="9.8">
<h2>
<span class="header-section-number">9.8</span> Mantel espacial com modelo nulo restrito considerando autocorrela√ß√£o espacial<a class="anchor" aria-label="anchor" href="#mantel-espacial-com-modelo-nulo-restrito-considerando-autocorrela%C3%A7%C3%A3o-espacial"><i class="fas fa-link"></i></a>
</h2>
<p>Embora seja um tipo de an√°lise bastante popular, o Mantel e a sua vers√£o parcial parecem n√£o ser muito adequadas para lidar com autocorrela√ß√£o espacial. Os autores dos artigos abaixo sugerem inclusive que esse tipo de an√°lise n√£o √© adequado para testar a maioria das hip√≥teses em Ecologia, incluindo diversidade beta. Esse √© um tema bastante discutido na literatura e n√£o vamos nos alongar muito sobre isso, mas referimos o(a) leitor(a) para os seguintes artigos chave: Legendre et al.¬†2015 <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2015" role="doc-biblioref">2015</a>)</span>, Legendre &amp; Fortin 2010 <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2010" role="doc-biblioref">2010</a>)</span>, e Legendre <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2000" role="doc-biblioref">2000</a>)</span>.</p>
<p>No entanto, Crabot et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-crabot2019" role="doc-biblioref">2019</a>)</span> propuseram uma modifica√ß√£o no teste que leva em conta autocorrela√ß√£o espacial ao gerar o modelo nulo usado para o teste de hip√≥tese. √â utilizado um procedimento chamado <em>Moran Spectral Randomization</em> porque preserva a autocorrela√ß√£o global medida por meio do I de Moran global. A grande vantagem √© que este teste utiliza toda a flexibilidade dos <em>Moran Eigenvector Maps</em> (MEMs), que √© apresentado na parte de RDA, permitindo analisar rela√ß√µes entre as matrizes em m√∫ltiplas escalas espaciais. Vejamos como o teste funciona.</p>
<p>Primeiro precisamos construir um objeto com as duas matrizes que desejamos testar, no nosso caso composi√ß√£o de esp√©cies e espa√ßo. Depois precisamos construir explicitamente a nossa hip√≥tese de rela√ß√£o espacial entre os locais por meio de uma rede de vizinhan√ßa. Esta rede √© uma estrutura que nos dir√° como (e eventualmente com qual intensidade) se h√° rela√ß√£o entre os locais. Aqui, entende-se que nos referimos √† probabilidade de fluxo de indiv√≠duos entre os locais.</p>
<div class="sourceCode" id="cb390"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mantel</span>
<span class="va">compos_espac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/mantel.randtest.html">mantel.randtest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">simil.bocaina</span><span class="op">)</span>, <span class="va">Dist.km</span><span class="op">)</span>
<span class="va">compos_espac</span>
<span class="co">#&gt; Monte-Carlo test</span>
<span class="co">#&gt; Call: mantel.randtest(m1 = sqrt(simil.bocaina), m2 = Dist.km)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Observation: 0.3738076 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Based on 999 replicates</span>
<span class="co">#&gt; Simulated p-value: 0.005 </span>
<span class="co">#&gt; Alternative hypothesis: greater </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Std.Obs Expectation    Variance </span>
<span class="co">#&gt; 3.265589171 0.002421976 0.012933827</span></code></pre></div>
<p>Note que at√© aqui n√£o h√° nada de novo, apenas utilizamos uma fun√ß√£o diferente para realizar o teste de Mantel, agora no pacote <code>ade4</code> ao inv√©s do <code>vegan</code>. Agora temos de construir a nossa rede de vizinhan√ßa. Optamos neste exemplo por uma rede bastante simples, que √© a <em>Minimum Spanning Tree</em>. Essa √© a rede espacial m√≠nima que mant√©m todos os pontos ligados entre si (Figura <a href="cap9.html#fig:fig-mantel-espacial">9.20</a>).</p>
<div class="sourceCode" id="cb391"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Minimum Spanning Tree</span>
<span class="va">nb.boc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adespatial/man/mst.nb.html">mst.nb</a></span><span class="op">(</span><span class="va">Dist.km</span><span class="op">)</span> <span class="co"># calcula uma Minimum Spanning Tree</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">nb.boc</span>, <span class="va">bocaina.xy</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-mantel-espacial"></span>
<img src="livro_files/figure-html/fig-mantel-espacial-1.png" alt="Rede de vizinhan√ßa com a *Minimum Spanning Tree*" width="100%" height="100%"><p class="caption">
Figura 9.20: Rede de vizinhan√ßa com a <em>Minimum Spanning Tree</em>
</p>
</div>
<p>No gr√°fico, podemos ver a ‚Äúcara‚Äù da rede. Cada ponto representa um local (po√ßa) e as linhas representam a liga√ß√£o hip√≥tetica entre eles, plotamos no espa√ßo geogr√°fico, ou seja, o Norte aponta pra cima. Agora temos apenas que converter o formato <code>nb</code> para <code>listw</code> e finalmente entrar com esses objetos na fun√ß√£o que realizar√° a an√°lise.</p>
<div class="sourceCode" id="cb392"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Convers√£o</span>
<span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">nb.boc</span><span class="op">)</span>

<span class="co">## Mantel espacial</span>
<span class="fu"><a href="https://rdrr.io/pkg/adespatial/man/msr.html">msr</a></span><span class="op">(</span><span class="va">compos_espac</span>, <span class="va">lw</span>, method <span class="op">=</span> <span class="st">"pair"</span><span class="op">)</span>
<span class="co">#&gt; Monte-Carlo test</span>
<span class="co">#&gt; Call: msr.mantelrtest(x = compos_espac, listwORorthobasis = lw, method = "pair")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Observation: 0.3738076 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Based on 999 replicates</span>
<span class="co">#&gt; Simulated p-value: 0.127 </span>
<span class="co">#&gt; Alternative hypothesis: greater </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Std.Obs Expectation    Variance </span>
<span class="co">#&gt;  1.21335033  0.17433665  0.02702631</span></code></pre></div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>Vamos comparar com o Mantel comum.</p>
<div class="sourceCode" id="cb393"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mantel comum</span>
<span class="va">compos_espac</span>
<span class="co">#&gt; Monte-Carlo test</span>
<span class="co">#&gt; Call: mantel.randtest(m1 = sqrt(simil.bocaina), m2 = Dist.km)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Observation: 0.3738076 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Based on 999 replicates</span>
<span class="co">#&gt; Simulated p-value: 0.005 </span>
<span class="co">#&gt; Alternative hypothesis: greater </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Std.Obs Expectation    Variance </span>
<span class="co">#&gt; 3.265589171 0.002421976 0.012933827</span></code></pre></div>
<p>Note que o valor da estat√≠stica do teste, ou seja, o r de Mantel √© exatamente o mesmo. No entanto, o valor de <em>P</em> que indicava que o teste havia sido significativo anteriormente mudou e passou a ser n√£o significativo. Isso ocorreu porque, embora a maneira de calcular a estat√≠stica do teste seja a mesma, a forma de construir a distribui√ß√£o nula, a partir da qual ser√° calculado o valor de <em>P</em> mudou drasticamente, resultando num teste n√£o significativo.</p>
</div>
<div id="procrustes-e-protest" class="section level2" number="9.9">
<h2>
<span class="header-section-number">9.9</span> PROCRUSTES e PROTEST<a class="anchor" aria-label="anchor" href="#procrustes-e-protest"><i class="fas fa-link"></i></a>
</h2>
<p>Uma alternativa ao Mantel para comparar o grau de associa√ß√£o entre conjuntos multidimensionais de dados (e.g., matriz de esp√©cies e matriz ambiental) √© a an√°lise conhecida como Procrustes <span class="citation">(<a href="refer%C3%AAncias.html#ref-gower_statistical_1971" role="doc-biblioref">Gower 1971</a>; <a href="refer%C3%AAncias.html#ref-jackson_protest_1995" role="doc-biblioref">Jackson 1995</a>)</span>. Esta an√°lise compara duas matrizes (objetos nas linhas e vari√°veis nas colunas) minimizando a soma dos desvios quadrados entre os valores atrav√©s das seguintes t√©cnicas: transla√ß√£o, escalonamento e rota√ß√£o. √â importante notar que os objetos devem ser os mesmos e, desse modo, o n√∫mero de linhas √© obrigatoriamente igual, ao passo que o n√∫mero de colunas pode variar. A posi√ß√£o do objeto X<sub>i</sub> (i = 1, ‚Ä¶n) √© comparada com o objeto Y<sub>i</sub> da matriz correspondente, movimentando os pontos via transla√ß√£o, reflex√£o, rota√ß√£o e dilata√ß√£o. Assim, os objetos da matriz X resultam na matrix X‚Äô que √© representada pelo melhor ajuste (menor valor residual da soma dos quadrados: estat√≠stica m<sub>12</sub>) entre a matriz X e Y. A estat√≠stica m<sub>12</sub> mede, ent√£o, o grau de concord√¢ncia entre as duas matrizes. Os valores de m<sub>12</sub> variam de 1 (sem concord√¢ncia) a 0 (m√°xima concord√¢ncia) <span class="citation">(<a href="refer%C3%AAncias.html#ref-peres-neto_how_2001" role="doc-biblioref">Peres-Neto and Jackson 2001</a>; <a href="refer%C3%AAncias.html#ref-lisboa_much_2014" role="doc-biblioref">Lisboa et al. 2014</a>)</span>. Para testar a signific√¢ncia do valor observado de m<sub>12</sub>, Jackson <span class="citation">(<a href="refer%C3%AAncias.html#ref-jackson_protest_1995" role="doc-biblioref">1995</a>)</span> sugeriu um teste de aleatoriza√ß√£o chamado PROTEST.</p>
<p>As possibilidades de aplica√ß√£o do Procrustes para ecologia s√£o diversas. Dentre elas, se destacam a: i) morfometria geom√©trica e ii) ecologia de comunidades (concord√¢ncia de comunidades). Uma caracter√≠stica interessante do Procrustes √© a possibilidade de usar matriz bruta (e.g., vari√°veis ambientais) ou matriz de dist√¢ncia, o que amplia as possibilidades anal√≠ticas. Para compara√ß√µes com matrizes brutas, an√°lises de ordena√ß√£o irrestrita (PCA, CA) devem ser realizadas antes do Procrustes. Por outro lado, para compara√ß√µes com matrizes de dist√¢ncia (e.g., Euclidiana, Jaccard, Bray-Curtis), an√°lises como PCoA e nMDS devem preceder √† an√°lise de Procrustes <span class="citation">(veja Figura 4 em <a href="refer%C3%AAncias.html#ref-peres-neto_how_2001" role="doc-biblioref">Peres-Neto and Jackson 2001</a>)</span>. Nos dois casos, a ordena√ß√£o √© importante para gerar matrizes com a mesma dimensionalidade o que, por sua vez, permite comparar matrizes com n√∫mero de colunas diferentes.</p>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar dois conjuntos de dados simulados de peixes e macroinvertebrados aqu√°ticos coletados em riachos. Neste exemplo hipot√©tico, existe uma rede de 12 riachos com diferentes graus de polui√ß√£o. Em cada riacho, foi produzida uma lista de esp√©cies de peixes e de macroinvertebrados (com dados de abund√¢ncia).</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existe concord√¢ncia na distribui√ß√£o na composi√ß√£o de esp√©cies de peixes e macroinvertebrados?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Assumindo que alguns poluentes, tais como metais pesados, podem atuar como filtro ambiental e limitar a ocorr√™ncia de determinados organismos aqu√°ticos, espera-se encontrar alta concord√¢ncia entre as duas matrizes (peixes e macroinvertebrados). Ou seja, a comunidade tanto de peixes quanto de macroinvertebrados responder√£o de forma similar ao gradiente ambiental</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Vari√°veis: composi√ß√£o das esp√©cies de peixes e macroinverebrados aqu√°ticos</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>No exemplo escolhido, as duas matrizes representam a composi√ß√£o de esp√©cies em diferentes riachos. Desse modo, o ideal √© transformar esta matriz bruta em matriz de dist√¢ncia com o m√©todo Bray-Curtis (<code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist()</a></code>). O pr√≥ximo passo, ent√£o, √© realizar uma <code>An√°lise de Coordenadas Principais (PCoA)</code> (veja abaixo) para gerar duas matrizes de ordena√ß√£o que ser√£o comparadas com a fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/procrustes.html">procrustes()</a></code>. Por fim, utilizamos a fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/procrustes.html">protest()</a></code> para testar a signific√¢ncia da concord√¢ncia entre as matrizes (Figura <a href="cap9.html#fig:fig-procrustes">9.21</a>).</p>
<div class="sourceCode" id="cb394"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fish_comm</span><span class="op">)</span>
<span class="co">#&gt;       sp1 sp2 sp3 sp4 sp5 sp6 sp7 sp8 sp9 sp10 sp11 sp12 sp13 sp14 sp15 sp16 sp17 sp18 sp19 sp20 sp21 sp22 sp23 sp24</span>
<span class="co">#&gt; site1   0   0   0   1   1   0   4   0   0    0    1    0    1    1    0    5    0    0    0    0    0    1    0    3</span>
<span class="co">#&gt; site2   0   0   0   1   0   1   5   0   2    1    1    2    1    0    0    1    0    0    0    0    0    0    1    0</span>
<span class="co">#&gt; site3   0   1   0   4   0   0   0   1   5    0    5    0    0    5    0    1    0    1    0    0    2    0    0    0</span>
<span class="co">#&gt; site4   0   5   0   1   0   1   0   0   2    0    0    0    0    2    1    0    0    0    0    1    1    0    0    2</span>
<span class="co">#&gt; site5   0   2   0   0   0   0   0   0   0    0    4    0    0    1    0    4    0    0    0    1    5    0    5    0</span>
<span class="co">#&gt; site6   0   2   1   0   0   0   0   1   1    0    0    2    0    2    0    0    0    0    0    0    0    0    4    0</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">macroinv</span><span class="op">)</span>
<span class="co">#&gt;       sp1 sp2 sp3 sp4 sp5 sp6 sp7 sp8 sp9 sp10 sp11 sp12 sp13 sp14 sp15 sp16 sp17 sp18 sp19 sp20 sp21 sp22 sp23 sp24 sp25</span>
<span class="co">#&gt; site1   0   1   1   0   0   0   0   0   0    1    2    0    0    0    0    1    1    0    4    0    0    0    1    0    0</span>
<span class="co">#&gt; site2   0   2   1   0   0   0   0   1   1    0    0    2    0    1    1    0    0    0    0    0    0    1    2    0    1</span>
<span class="co">#&gt; site3   0   0   0   1   0   1   5   0   2    1    1    2    0    4    0    1    0    0    1    0    0    0    0    1    0</span>
<span class="co">#&gt; site4   0   1   0   4   0   0   0   1   5    0    5    0    0    5    0    1    0    1    0    0    2    0    0    0    0</span>
<span class="co">#&gt; site5   0   2   0   0   0   0   0   0   0    0    4    0    0    2    1    0    0    0    0    1    1    0    0    2    0</span>
<span class="co">#&gt; site6   1   0   0   1   0   0   0   0   0    0    1    0    0    2    0    0    0    0    0    0    0    0    4    0    0</span>
<span class="co">#&gt;       sp26 sp27 sp28 sp29 sp30 sp31 sp32 sp33 sp34 sp35 sp36</span>
<span class="co">#&gt; site1    1    0    4    0    0    0    1    5    0    5    0</span>
<span class="co">#&gt; site2    0    1    1    0    0    1    0    0    1    0    0</span>
<span class="co">#&gt; site3    2    1    0    0    0    0    1    1    0    0    2</span>
<span class="co">#&gt; site4    2    1    0    0    0    0    0    0    5    1    0</span>
<span class="co">#&gt; site5    5    0    1    0    1    0    0    2    0    0    0</span>
<span class="co">#&gt; site6    2    0    0    0    0    0    0    0    0    4    0</span>

<span class="co">## Fixar a amostragem</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1001</span><span class="op">)</span> 

<span class="co">## Matrizes de dist√¢ncia de PCoA </span>
<span class="va">d_macro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">macroinv</span>, <span class="st">"bray"</span><span class="op">)</span>
<span class="va">pcoa_macro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span><span class="va">d_macro</span><span class="op">)</span>

<span class="va">d_fish</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">fish_comm</span>, <span class="st">"bray"</span><span class="op">)</span>
<span class="va">pcoa_fish</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span><span class="va">d_fish</span><span class="op">)</span>

<span class="co">## PROCRUSTES</span>
<span class="va">concord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/procrustes.html">procrustes</a></span><span class="op">(</span><span class="va">pcoa_macro</span>, <span class="va">pcoa_fish</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/procrustes.html">protest</a></span><span class="op">(</span><span class="va">pcoa_macro</span>, <span class="va">pcoa_fish</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; protest(X = pcoa_macro, Y = pcoa_fish) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Procrustes Sum of Squares (m12 squared):        0.6185 </span>
<span class="co">#&gt; Correlation in a symmetric Procrustes rotation: 0.6176 </span>
<span class="co">#&gt; Significance:  0.019 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>

<span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">concord</span>, main <span class="op">=</span> <span class="st">""</span>, 
     xlab <span class="op">=</span> <span class="st">"Dimens√£o 1"</span>,
     ylab <span class="op">=</span> <span class="st">"Dimens√£o 2"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-procrustes"></span>
<img src="livro_files/figure-html/fig-procrustes-1.png" alt="Biplot mostrando o resultado da an√°lise de PROCRUSTES." width="100%" height="100%"><p class="caption">
Figura 9.21: Biplot mostrando o resultado da an√°lise de PROCRUSTES.
</p>
</div>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<p>A fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/procrustes.html">protest()</a></code> apresenta dois resultados importantes: i) a estat√≠stica m<sub>12</sub> e ii) o valor de signific√¢ncia (p). No exemplo, o valor de m<sub>12</sub> √© igual a <code>0.6185</code> e o valor de p √© <code>0,019</code>. Desse modo, podemos concluir que existe concord√¢ncia entre a composi√ß√£o de esp√©cies de peixes e macroinvertebrados aqu√°ticos, sugerindo que o n√≠vel de polui√ß√£o pode gerar padr√µes previs√≠veis de distribui√ß√£o de diferentes organismos aqu√°ticos. A figura produzida pelo c√≥digo <code>plot(concord)</code> mostra um gr√°fico t√≠pico do Procrustes, onde a base da seta representa a matriz <strong>X</strong> e a ponta da seta a matriz alvo (<strong>Y</strong>) ap√≥s a rota√ß√£o para comparar o grau de concord√¢ncia entre <strong>X</strong> e <strong>Y</strong>. Cada ponto representa um objeto (linha) das matrizes <strong>X</strong> e <strong>Y</strong>. Quanto menor for o tamanho das setas, mais concordantes s√£o as observa√ß√µes em cada objeto.</p>
</div>
<div id="m√©todos-multivariados-baseados-em-modelos" class="section level2" number="9.10">
<h2>
<span class="header-section-number">9.10</span> M√©todos multivariados baseados em modelos<a class="anchor" aria-label="anchor" href="#m%C3%A9todos-multivariados-baseados-em-modelos"><i class="fas fa-link"></i></a>
</h2>
<p>Mais recentemente, alguns autores t√™m proposto m√©todos multivariados baseados em modelos. Estes m√©todos t√™m se diversificado hoje em dia e existem pacotes que realizam praticamente todas as an√°lises que vimos acima, com a diferen√ßa que utilizam distribui√ß√µes de probabilidade dado um modelo (e.g., Poisson) ao inv√©s de coeficientes de dissimilaridades. Vamos exemplificar o uso de um desses m√©todos, mas n√£o vamos fazer uma revis√£o extensiva. Caso o(a) leitor(a) deseje conhecer mais, recomendamos consultar principalmente os pacotes <code>gllvm</code>, <code>ecoCopula</code> e <code>Hmsc</code>.</p>
<p>Um dos primeiros m√©todos foi proposto em 2012 pelo grupo de David Warton <span class="citation">(<a href="refer%C3%AAncias.html#ref-warton2012" role="doc-biblioref">Warton, Wright, and Wang 2012</a>)</span>, implementado no pacote <code>mvabund</code>. Anteriormente neste mesmo ano foi publicado um artigo pelo mesmo grupo <span class="citation">(<a href="refer%C3%AAncias.html#ref-wang2012" role="doc-biblioref">Wang et al. 2012</a>)</span> em que os autores demonstraram que m√©todos baseados em dissimilaridade, especialmente PERMANOVA, n√£o conseguem modelar adequadamente dados multivariados de contagem (e.g., abund√¢ncia) por n√£o levarem em conta a rela√ß√£o monot√¥nica entre m√©dia e vari√¢ncia. Vejamos o que isso quer dizer utilizando os dados do artigo de da Silva et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-dasilva2017" role="doc-biblioref">2017</a>)</span> (Figura <a href="cap9.html#fig:fig-media-var">9.22</a>).</p>
<div class="sourceCode" id="cb395"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados com seis primeiras localidades e esp√©cies</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">anuros_permanova</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt;                   Chiasmocleis_albopunctata Dendropsophus_elianae Dendropsophus_jimi Dendropsophus_nanus</span>
<span class="co">#&gt; Araras                                    6                     0                  0                   0</span>
<span class="co">#&gt; Artur Nogueira                            0                     0                  0                   0</span>
<span class="co">#&gt; Conchal                                   0                     0                  0                   0</span>
<span class="co">#&gt; Engenheiro Coelho                         1                     0                  0                   0</span>
<span class="co">#&gt; Jaguari\xfana                             8                     0                  0                   0</span>
<span class="co">#&gt; Limeira                                   0                    11                 15                   0</span>
<span class="co">#&gt;                   Dendropsophus_minutus Dendropsophus_sanborni</span>
<span class="co">#&gt; Araras                                1                      0</span>
<span class="co">#&gt; Artur Nogueira                        6                      0</span>
<span class="co">#&gt; Conchal                               0                      0</span>
<span class="co">#&gt; Engenheiro Coelho                     2                      0</span>
<span class="co">#&gt; Jaguari\xfana                         0                      0</span>
<span class="co">#&gt; Limeira                              15                      0</span>
<span class="va">anuros_abund</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">anuros_permanova</span><span class="op">[</span>,<span class="op">-</span><span class="fl">28</span><span class="op">]</span><span class="op">)</span><span class="co">#retirando a coluna que cont√©m o fator e deixando apenas dados de abund√¢ncia</span>
<span class="va">grupos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">anuros_permanova</span><span class="op">[</span>,<span class="fl">28</span><span class="op">]</span><span class="op">)</span><span class="co">#incluindo apenas o fator a ser testado no modelo</span>

<span class="co">## M√©dia-vari√¢ncia</span>
<span class="va">abund_tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund.html">mvabund</a></span><span class="op">(</span><span class="va">anuros_abund</span><span class="op">)</span> <span class="co"># criando um objeto da classe mvabund com os dados de abund√¢ncia</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/meanvar.plot.html">meanvar.plot</a></span><span class="op">(</span><span class="va">abund_tr</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-media-var"></span>
<img src="livro_files/figure-html/fig-media-var-1.png" alt="Gr√°fico mostrando a m√©dia-vari√¢ncia para dados de abund√¢ncia multivariada." width="100%" height="100%"><p class="caption">
Figura 9.22: Gr√°fico mostrando a m√©dia-vari√¢ncia para dados de abund√¢ncia multivariada.
</p>
</div>
<p>Este conjunto de dados cont√©m abund√¢ncias de anf√≠bios coletados num conjunto de cidades do interior de S√£o Paulo e tamb√©m sua presen√ßa em museus. Aqui, vemos que h√° uma clara rela√ß√£o monot√¥nica entre a m√©dia e a vari√¢ncia da abund√¢ncia das esp√©cies na matriz. Ou seja, √† medida que esp√©cies aumentam sua m√©dia de abund√¢ncia, elas tamb√©m aumentam quase que proporcionalmente a sua vari√¢ncia. Esta √© uma propriedade bastante comum de dados multivariados de contagem, mas que n√£o √© muito bem modelada por m√©todos baseados em dissimilaridade, j√° que nesse caso apenas as esp√©cies mais abundantes t√™m de fato um peso na an√°lise.</p>
<p>A proposta implementada no pacote <code>mvabund</code> √© baseada em Modelos Lineares Generalizados (GLMs) que voc√™ j√° conhece do Cap√≠tulo <a href="cap8.html#cap8">8</a>. Ou seja, este m√©todo permite que sejam modeladas as abund√¢ncias das esp√©cies num contexto multivariado utilizando explicitamente distribui√ß√µes de probabilidade, tais como aquelas que utilizamos (e.g., Poisson, Binomial negativa, etc.). Isso faz com que demos peso semelhante √†s esp√©cies. Vejamos um exemplo de como o modelo √© ajustado e como √© feito teste de hip√≥tese.</p>
<p><strong>Exemplo 1</strong></p>
<p>A principal pergunta do artigo citado acima foi testar se a composi√ß√£o de esp√©cies que obtemos em campo e de cole√ß√£o cient√≠ficas √© diferente. Isso tem implica√ß√µes para levantamentos de fauna, j√° que podemos complementar um tipo de dado com outro ou saber se eles s√£o redundantes. Aqui, <code>grupos</code> √© apenas um fator que indica se aquela linha da matriz apresenta dados obtidos em campo ou cole√ß√£o. Vamos testar a hip√≥tese nula de que n√£o h√° diferen√ßa na composi√ß√£o entre as duas fontes de dados ajustando um modelo com Binomial negativa (Figura <a href="cap9.html#fig:fig-mvabund">9.23</a>).</p>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">abund_tr</span> <span class="op">~</span> <span class="va">grupos</span>, cex.axis <span class="op">=</span> <span class="fl">0.8</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  PIPING TO 2nd MVFACTOR</span>

<span class="co">## Modelo</span>
<span class="va">modelo1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/manyglm.html">manyglm</a></span><span class="op">(</span><span class="va">abund_tr</span> <span class="op">~</span> <span class="va">grupos</span>, family <span class="op">=</span> <span class="st">"negative.binomial"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-mvabund"></span>
<img src="livro_files/figure-html/fig-mvabund-1.png" alt="Gr√°fico mostrando as abund√¢ncias para os dois grupos." width="100%" height="100%"><p class="caption">
Figura 9.23: Gr√°fico mostrando as abund√¢ncias para os dois grupos.
</p>
</div>
<p>O gr√°fico mostrando os dados possui log da abund√¢ncia das esp√©cies e o fator (campo vs.¬†cole√ß√£o). Com essa an√°lise explorat√≥ria de dados j√° podemos identificar se h√° diferen√ßa ou n√£o na abund√¢ncia das esp√©cies em cada local. Vemos que algumas esp√©cies s√£o bem mais abundantes no campo do que em cole√ß√µes, tais como <em>Leptodactylus mystacinus</em> e <em>Rhinella ornata</em>.</p>
<p>Uma grande vantagem desse tipo de m√©todo baseado em modelos √© que, assim como um GLM t√≠pico, tamb√©m podemos realizar diagnose dos res√≠duos utilizando plots de res√≠duos versus predito. Vejamos como isso funciona (Figura <a href="cap9.html#fig:fig-mvabund-diag">9.24</a>).</p>
<div class="sourceCode" id="cb397"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Diagnose</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">modelo1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-mvabund-diag"></span>
<img src="livro_files/figure-html/fig-mvabund-diag-1.png" alt="Diagnose dos res√≠duos do modelo ajustado." width="100%" height="100%"><p class="caption">
Figura 9.24: Diagnose dos res√≠duos do modelo ajustado.
</p>
</div>
<p>Aqui vemos que os dados se distribuem de maneira mais ou menos homog√™nea e sem um padr√£o claro ao redor do zero. Isso indica que a distribui√ß√£o Binomial negativa foi adequada para modelar estes dados. E agora sim podemos interpretar os resultados com mais seguran√ßa.</p>
<p><strong>Interpreta√ß√£o dos resultados</strong></p>
<div class="sourceCode" id="cb398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Resultados</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelo1</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test statistics:</span>
<span class="co">#&gt;               wald value Pr(&gt;wald)    </span>
<span class="co">#&gt; (Intercept)       18.947     0.001 ***</span>
<span class="co">#&gt; gruposCOLECAO      4.727     0.004 ** </span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test statistic:  4.727, p-value: 0.004 </span>
<span class="co">#&gt; Arguments:</span>
<span class="co">#&gt;  Test statistics calculated assuming response assumed to be uncorrelated </span>
<span class="co">#&gt;  P-value calculated using 999 resampling iterations via pit.trap resampling (to account for correlation in testing).</span></code></pre></div>
<p>Aqui vemos que h√° sim uma diferen√ßa significativa na abund√¢ncia relativa das esp√©cies entre o campo e cole√ß√£o. Mas at√© ent√£o estamos levando em conta toda a matriz numa abordagem multivariada. No entanto, n√£o sabemos qual(is) esp√©cie(s) s√£o respons√°veis por este padr√£o. Para investigar isso, podemos realizar uma An√°lise de Deviance separada para cada esp√©cie, isso √© o que a linha abaixo faz.</p>
<div class="sourceCode" id="cb399"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## ANOVA</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modelo1</span>, p.uni <span class="op">=</span> <span class="st">"adjusted"</span><span class="op">)</span>
<span class="co">#&gt; Time elapsed: 0 hr 0 min 6 sec</span>
<span class="co">#&gt; Analysis of Deviance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: abund_tr ~ grupos</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Multivariate test:</span>
<span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)   </span>
<span class="co">#&gt; (Intercept)      8                          </span>
<span class="co">#&gt; grupos           7       1 94.08     0.01 **</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Univariate Tests:</span>
<span class="co">#&gt;             Chiasmocleis_albopunctata          Dendropsophus_elianae          Dendropsophus_jimi         </span>
<span class="co">#&gt;                                   Dev Pr(&gt;Dev)                   Dev Pr(&gt;Dev)                Dev Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)                                                                                              </span>
<span class="co">#&gt; grupos                          3.308    0.467                 0.394    0.836               0.23    0.836</span>
<span class="co">#&gt;             Dendropsophus_nanus          Dendropsophus_minutus          Dendropsophus_sanborni         </span>
<span class="co">#&gt;                             Dev Pr(&gt;Dev)                   Dev Pr(&gt;Dev)                    Dev Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)                                                                                            </span>
<span class="co">#&gt; grupos                    2.197    0.707                 4.752    0.309                  2.197    0.707</span>
<span class="co">#&gt;             Elachistocleis_cesari          Hypsiboas_albopunctatus          Hypsiboas_faber          Hypsiboas_lundii</span>
<span class="co">#&gt;                               Dev Pr(&gt;Dev)                     Dev Pr(&gt;Dev)             Dev Pr(&gt;Dev)              Dev</span>
<span class="co">#&gt; (Intercept)                                                                                                          </span>
<span class="co">#&gt; grupos                      2.012    0.762                   2.069    0.762           0.913    0.822            0.915</span>
<span class="co">#&gt;                      Hypsiboas_prasinus          Itapotihyla_langsdorffii          Leptodactylus_fuscus         </span>
<span class="co">#&gt;             Pr(&gt;Dev)                Dev Pr(&gt;Dev)                      Dev Pr(&gt;Dev)                  Dev Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)                                                                                                     </span>
<span class="co">#&gt; grupos         0.822              0.913    0.822                    0.911    0.836                4.652    0.309</span>
<span class="co">#&gt;             Leptodactylus_latrans          Leptodactylus_mystaceus          Leptodactylus_mystacinus         </span>
<span class="co">#&gt;                               Dev Pr(&gt;Dev)                     Dev Pr(&gt;Dev)                      Dev Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)                                                                                                  </span>
<span class="co">#&gt; grupos                      0.811    0.836                   1.869    0.783                    9.772    0.045</span>
<span class="co">#&gt;             Physalaemus_centralis          Physalaemus_cuvieri          Physalaemus_marmoratus         </span>
<span class="co">#&gt;                               Dev Pr(&gt;Dev)                 Dev Pr(&gt;Dev)                    Dev Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)                                                                                            </span>
<span class="co">#&gt; grupos                      2.639    0.670               8.221    0.062                  1.622    0.783</span>
<span class="co">#&gt;             Physalaemus_nattereri          Pseudis_paradoxa          Rhinella_ornata          Rhinella_schneideri         </span>
<span class="co">#&gt;                               Dev Pr(&gt;Dev)              Dev Pr(&gt;Dev)             Dev Pr(&gt;Dev)                 Dev Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)                                                                                                               </span>
<span class="co">#&gt; grupos                     17.131    0.014             2.67    0.540          11.961    0.027               3.363    0.467</span>
<span class="co">#&gt;             Scinax_fuscomarginatus          Scinax_fuscovarius          Scinax_similis          Trachycephalus_typhonius</span>
<span class="co">#&gt;                                Dev Pr(&gt;Dev)                Dev Pr(&gt;Dev)            Dev Pr(&gt;Dev)                      Dev</span>
<span class="co">#&gt; (Intercept)                                                                                                             </span>
<span class="co">#&gt; grupos                        2.64    0.622              1.655    0.783          2.646    0.622                    1.622</span>
<span class="co">#&gt;                     </span>
<span class="co">#&gt;             Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)         </span>
<span class="co">#&gt; grupos         0.783</span>
<span class="co">#&gt; Arguments:</span>
<span class="co">#&gt;  Test statistics calculated assuming uncorrelated response (for faster computation) </span>
<span class="co">#&gt; P-value calculated using 999 iterations via PIT-trap resampling.</span></code></pre></div>
<p>Aqui vemos que algumas esp√©cies j√° identificadas no plot explorat√≥rio de fato s√£o importantes para determinar o padr√£o, tais como: <em>Leptodactylus mystacinus</em>, <em>Physalaemus nattereri</em> e <em>Rhinella ornata</em>. Essas foram esp√©cies cuja Deviance foi significativa.</p>
</div>
<div id="para-se-aprofundar-5" class="section level2" number="9.11">
<h2>
<span class="header-section-number">9.11</span> Para se aprofundar<a class="anchor" aria-label="anchor" href="#para-se-aprofundar-5"><i class="fas fa-link"></i></a>
</h2>
<div id="livros-3" class="section level3" number="9.11.1">
<h3>
<span class="header-section-number">9.11.1</span> Livros<a class="anchor" aria-label="anchor" href="#livros-3"><i class="fas fa-link"></i></a>
</h3>
<p>Listamos a seguir livros e artigos com material que recomendamos para seguir com sua aprendizagem em an√°lises multivariadas em R: i) Legendre &amp; Legendre <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">2012</a>)</span> Numerical Ecology, ii) Borcard e colaboradores <span class="citation">(<a href="refer%C3%AAncias.html#ref-borcard2018" role="doc-biblioref">2018</a>)</span> Numerical Ecology with R, iii) Thioulouse e colaboradores <span class="citation">(<a href="refer%C3%AAncias.html#ref-thioulouse_multivariate_2018" role="doc-biblioref">2018</a>)</span> Multivariate Analysis of Ecological Data with ade4, iv) Ovaskainen &amp; Abrego <span class="citation">(<a href="refer%C3%AAncias.html#ref-ovaskainen_joint_2020" role="doc-biblioref">2020</a>)</span> Joint Species Distribution Modelling, v) James &amp; McCulloch <span class="citation">(<a href="refer%C3%AAncias.html#ref-james_multivariate_1990" role="doc-biblioref">1990</a>)</span> Multivariate Analysis in Ecology and Systematics: Panacea or Pandora‚Äôs Box? e vi) Dunstan e colaboradores <span class="citation">(<a href="refer%C3%AAncias.html#ref-dunstan_model_2011" role="doc-biblioref">2011</a>)</span> Model based grouping of species across environmental gradients.</p>
</div>
<div id="links-4" class="section level3" number="9.11.2">
<h3>
<span class="header-section-number">9.11.2</span> Links<a class="anchor" aria-label="anchor" href="#links-4"><i class="fas fa-link"></i></a>
</h3>
<p>Existem alguns tutoriais online bem interessantes, mas todos em ingl√™s. Veja lista abaixo:</p>
<ul>
<li><a href="https://www.davidzeleny.net/anadat-r/doku.php/en:ordination">An√°lises de ordena√ß√£o - 1</a></li>
<li><a href="http://ordination.okstate.edu/overview.htm">An√°lises de ordena√ß√£o - 2</a></li>
<li><a href="https://www.davidzeleny.net/anadat-r/doku.php/en:classification">Classifica√ß√£o num√©rica - agrupamento e kmeans</a></li>
</ul>
</div>
</div>
<div id="exerc√≠cios-5" class="section level2" number="9.12">
<h2>
<span class="header-section-number">9.12</span> Exerc√≠cios<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcios-5"><i class="fas fa-link"></i></a>
</h2>
<p><strong>9.1</strong>
Utilize os dados ‚Äúmite‚Äù do pacote vegan para testar o efeito de vari√°veis ambientais sobre a composi√ß√£o de esp√©cies de √°caros utilizando as seguintes an√°lises: RDA, RDAp (combinada com MEM), dbRDA e PERMANOVA. Ap√≥s realizar as cinco an√°lises, responda √†s seguintes perguntas?</p>
<p>A. Quais s√£o as vari√°veis ambientais (mite.env) mais importantes para a composi√ß√£o de √°caros em cada uma das an√°lises?
B. Os vetores espaciais obtidos com a an√°lise MEM explicam a varia√ß√£o na composi√ß√£o de esp√©cies? Eles s√£o mais ou menos importantes do que as vari√°veis ambientais?
C. Discuta as diferen√ßas de interpreta√ß√£o entre a RDA, RDAp, dbRDA e PERMANOVA.</p>
<p>Dados necess√°rios:</p>
<div class="sourceCode" id="cb400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mite.env</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mite.xy</span><span class="op">)</span></code></pre></div>
<p><strong>9.2</strong>
Efetue uma an√°lise de agrupamento pela fun√ß√£o <code><a href="https://rdrr.io/r/stats/hclust.html">hclust()</a></code>. Lembre-se de dar nome ao objeto para poder plotar o dendrograma depois. Utilize a ajuda para encontrar como entrar com os argumentos da fun√ß√£o.</p>
<ol style="list-style-type: upper-alpha">
<li>utilizando o m√©todo UPGMA e o √≠ndice de Bray-Curtis.</li>
<li>Fa√ßa agora o dendrograma com outro √≠ndice de dissimilaridade e compare os resultados. S√£o diferentes? No que eles influenciar√≠am a interpreta√ß√£o do resultado?</li>
</ol>
<p><strong>9.3</strong>
Na perspectiva de metacomunidades (Leibold et al., 2004), a dispers√£o dos organismos tem um papel proeminente para entender como as esp√©cies est√£o distribu√≠das na natureza. Com o objetivo de testar se a dispers√£o influencia a composi√ß√£o de esp√©cies de clad√≥ceros e cop√©podos, e portanto a estrutura da metacomunidade, um pesquisador selecionou dois conjuntos de lagos: em um deles todos os lagos s√£o isolados e no outro os lagos s√£o conectados.</p>
<ol style="list-style-type: upper-alpha">
<li><p>Importe o conjunto de dados lagos do pacote <code>ecodados</code> e responda a pergunta se o fato de os lagos estarem conectados ou n√£o influencia a composi√ß√£o de esp√©cies desses microcrust√°ceos. Utilize m√©todos baseados em modelos que voc√™ aprendeu ao longo do cap√≠tulo para modelar a abund√¢ncia multivariada.</p></li>
<li><p>Fa√ßa um plot mostrando a abund√¢ncia relativa das esp√©cies com maior abund√¢ncia e veja se elas s√£o diferentes entre os tipos lagos. Combine este resultado com o do item anterior para interpretar o resultado final.</p></li>
</ol>
<p><strong>9.4</strong>
Carregue o pacote <code>MASS</code> para utilizar os dados <code>crabs</code>. Este conjunto traz medidas morfol√≥gicas de dois morfo-tipos da esp√©cie de carangueijo <em>Leptograpsus variegatus</em> coletada em Fremantle, Austr√°lia. Calcule uma PCA e veja se existe uma semelhan√ßa morfol√≥gica entre os dois morfo-tipos. Lembre-se de dar nome
ao objeto e use a fun√ß√£o <code><a href="https://rdrr.io/r/stats/biplot.html">biplot()</a></code> para plotar o resultado do teste. Dica: a proje√ß√£o de um objeto perpendicular √† seta do descritor fornece a posi√ß√£o aproximada do objeto ao longo desse descritor. A dist√¢ncia dos objetos no espa√ßo cartesiano reflete a dist√¢ncia euclidiana entre eles.</p>
<p><a href="https://exercicios-livro-aer.netlify.app/cap.-9---an%C3%A1lises-multivariadas.html">Solu√ß√µes dos exerc√≠cios</a>.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="cap8.html"><span class="header-section-number">8</span> Modelos Lineares Generalizados</a></div>
<div class="next"><a href="cap10.html"><span class="header-section-number">10</span> Rarefa√ß√£o</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Neste cap√≠tulo"><h2>Nesta p√°gina</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cap9"><span class="header-section-number">9</span> An√°lises Multidimensionais</a></li>
<li><a class="nav-link" href="#pr%C3%A9-requisitos-do-cap%C3%ADtulo-5">Pr√©-requisitos do cap√≠tulo</a></li>
<li>
<a class="nav-link" href="#aspectos-te%C3%B3ricos"><span class="header-section-number">9.1</span> Aspectos te√≥ricos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#coeficientes-de-associa%C3%A7%C3%A3o"><span class="header-section-number">9.1.1</span> Coeficientes de associa√ß√£o</a></li>
<li><a class="nav-link" href="#m%C3%A9tricas-de-dist%C3%A2ncia"><span class="header-section-number">9.1.2</span> M√©tricas de dist√¢ncia</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#an%C3%A1lises-de-agrupamento"><span class="header-section-number">9.2</span> An√°lises de agrupamento</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#agrupamento-hier%C3%A1rquico"><span class="header-section-number">9.2.1</span> Agrupamento hier√°rquico</a></li>
<li><a class="nav-link" href="#agrupamento-n%C3%A3o-hier%C3%A1rquico-k-means"><span class="header-section-number">9.2.2</span> Agrupamento n√£o-hier√°rquico (K-means)</a></li>
<li><a class="nav-link" href="#esp%C3%A9cies-indicadoras"><span class="header-section-number">9.2.3</span> Esp√©cies indicadoras</a></li>
</ul>
</li>
<li><a class="nav-link" href="#an%C3%A1lises-de-ordena%C3%A7%C3%A3o"><span class="header-section-number">9.3</span> An√°lises de Ordena√ß√£o</a></li>
<li>
<a class="nav-link" href="#ordena%C3%A7%C3%A3o-irrestrira"><span class="header-section-number">9.4</span> Ordena√ß√£o irrestrira</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#an%C3%A1lise-de-componentes-principais-pca"><span class="header-section-number">9.4.1</span> An√°lise de Componentes Principais (PCA)</a></li>
<li><a class="nav-link" href="#an%C3%A1lises-de-coordenadas-principais-pcoa"><span class="header-section-number">9.4.2</span> An√°lises de Coordenadas Principais (PCoA)</a></li>
<li><a class="nav-link" href="#regress%C3%A3o-de-componentes-principais-pcr"><span class="header-section-number">9.4.3</span> Regress√£o de Componentes Principais (PCR)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#ordena%C3%A7%C3%A3o-restrita"><span class="header-section-number">9.5</span> Ordena√ß√£o restrita</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#an%C3%A1lise-de-redund%C3%A2ncia-rda"><span class="header-section-number">9.5.1</span> An√°lise de Redund√¢ncia (RDA)</a></li>
<li><a class="nav-link" href="#an%C3%A1lise-de-redund%C3%A2ncia-parcial-rdap"><span class="header-section-number">9.5.2</span> An√°lise de Redund√¢ncia parcial (RDAp)</a></li>
<li><a class="nav-link" href="#an%C3%A1lise-de-redund%C3%A2ncia-baseada-em-dist%C3%A2ncia-db-rda"><span class="header-section-number">9.5.3</span> An√°lise de Redund√¢ncia baseada em dist√¢ncia (db-RDA)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#permanova"><span class="header-section-number">9.6</span> PERMANOVA</a></li>
<li><a class="nav-link" href="#mantel-e-mantel-parcial"><span class="header-section-number">9.7</span> Mantel e Mantel parcial</a></li>
<li><a class="nav-link" href="#mantel-espacial-com-modelo-nulo-restrito-considerando-autocorrela%C3%A7%C3%A3o-espacial"><span class="header-section-number">9.8</span> Mantel espacial com modelo nulo restrito considerando autocorrela√ß√£o espacial</a></li>
<li><a class="nav-link" href="#procrustes-e-protest"><span class="header-section-number">9.9</span> PROCRUSTES e PROTEST</a></li>
<li><a class="nav-link" href="#m%C3%A9todos-multivariados-baseados-em-modelos"><span class="header-section-number">9.10</span> M√©todos multivariados baseados em modelos</a></li>
<li>
<a class="nav-link" href="#para-se-aprofundar-5"><span class="header-section-number">9.11</span> Para se aprofundar</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#livros-3"><span class="header-section-number">9.11.1</span> Livros</a></li>
<li><a class="nav-link" href="#links-4"><span class="header-section-number">9.11.2</span> Links</a></li>
</ul>
</li>
<li><a class="nav-link" href="#exerc%C3%ADcios-5"><span class="header-section-number">9.12</span> Exerc√≠cios</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/paternogbc/livro_aer/blob/master/09_analises_multidimensionais.Rmd">Ver fonte <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/paternogbc/livro_aer/edit/master/09_analises_multidimensionais.Rmd">Edite esta p√°gina <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>An√°lises Ecol√≥gicas no R</strong>" foi escrito por Fernando Rodrigues da Silva, Thiago Gon√ßalves-Souza, Gustavo Brant Paterno, <br> Diogo Borges Provete, Maur√≠cio Humberto Vancine. √öltima atualiza√ß√£o: 2022-02-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
        <p>Este livro foi compilado com o pacote <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
