<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 10 Análises Multidimensionais | Análises Ecológicas no R</title>
  <meta name="description" content="Capítulo 10 Análises Multidimensionais | Análises Ecológicas no R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 10 Análises Multidimensionais | Análises Ecológicas no R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 10 Análises Multidimensionais | Análises Ecológicas no R" />
  
  
  



<meta name="date" content="2022-01-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cap8.html"/>
<link rel="next" href="cap10.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análises Ecológicas no R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Capa</a></li>
<li class="chapter" data-level="" data-path="prefácio.html"><a href="prefácio.html"><i class="fa fa-check"></i>Prefácio</a></li>
<li class="chapter" data-level="1" data-path="revisores-e-colaboradores.html"><a href="revisores-e-colaboradores.html"><i class="fa fa-check"></i><b>1</b> Revisores e colaboradores</a></li>
<li class="chapter" data-level="2" data-path="cap2.html"><a href="cap2.html"><i class="fa fa-check"></i><b>2</b> Introdução</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cap2.html"><a href="cap2.html#histórico-deste-livro"><i class="fa fa-check"></i><b>2.1</b> Histórico deste livro</a></li>
<li class="chapter" data-level="2.2" data-path="cap2.html"><a href="cap2.html#objetivo-deste-livro"><i class="fa fa-check"></i><b>2.2</b> Objetivo deste livro</a></li>
<li class="chapter" data-level="2.3" data-path="cap2.html"><a href="cap2.html#o-que-você-não-encontrará-neste-livro"><i class="fa fa-check"></i><b>2.3</b> O que você não encontrará neste livro</a></li>
<li class="chapter" data-level="2.4" data-path="cap2.html"><a href="cap2.html#por-que-usar-o-r"><i class="fa fa-check"></i><b>2.4</b> Por que usar o R?</a></li>
<li class="chapter" data-level="2.5" data-path="cap2.html"><a href="cap2.html#indo-além-da-linguagem-de-progração-para-a-ecologia"><i class="fa fa-check"></i><b>2.5</b> Indo além da linguagem de progração para a Ecologia</a></li>
<li class="chapter" data-level="2.6" data-path="cap2.html"><a href="cap2.html#como-usar-este-livro"><i class="fa fa-check"></i><b>2.6</b> Como usar este livro</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cap3.html"><a href="cap3.html"><i class="fa fa-check"></i><b>3</b> Voltando ao básico: como dominar a arte de fazer perguntas cientificamente relevantes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cap3.html"><a href="cap3.html#introdução"><i class="fa fa-check"></i><b>3.1</b> Introdução</a></li>
<li class="chapter" data-level="3.2" data-path="cap3.html"><a href="cap3.html#perguntas-devem-preceder-as-análises-estatísticas"><i class="fa fa-check"></i><b>3.2</b> Perguntas devem preceder as análises estatísticas</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="cap3.html"><a href="cap3.html#um-bestiárioperguntas_ecologia-1-para-o-teste-de-hipóteses-você-está-fazendo-a-pergunta-certa"><i class="fa fa-check"></i><b>3.2.1</b> Um bestiário para o teste de hipóteses (Você está fazendo a pergunta certa?)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="cap3.html"><a href="cap3.html#fluxograma-conectando-variáveis-para-melhorar-o-desenho-experimental-e-as-análises-estatísticas"><i class="fa fa-check"></i><b>3.3</b> Fluxograma: Conectando variáveis para melhorar o desenho experimental e as análises estatísticas</a></li>
<li class="chapter" data-level="3.4" data-path="cap3.html"><a href="cap3.html#questões-fundamentais-em-etnobiologia-ecologia-e-conservação"><i class="fa fa-check"></i><b>3.4</b> Questões fundamentais em etnobiologia, ecologia e conservação</a></li>
<li class="chapter" data-level="3.5" data-path="cap3.html"><a href="cap3.html#considerações-finais"><i class="fa fa-check"></i><b>3.5</b> Considerações Finais</a></li>
<li class="chapter" data-level="3.6" data-path="cap3.html"><a href="cap3.html#referências"><i class="fa fa-check"></i><b>3.6</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cap1.html"><a href="cap1.html"><i class="fa fa-check"></i><b>4</b> Pré-requisitos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="cap1.html"><a href="cap1.html#introdução-1"><i class="fa fa-check"></i><b>4.1</b> Introdução</a></li>
<li class="chapter" data-level="4.2" data-path="cap1.html"><a href="cap1.html#instalação-do-r"><i class="fa fa-check"></i><b>4.2</b> Instalação do R</a></li>
<li class="chapter" data-level="4.3" data-path="cap1.html"><a href="cap1.html#instalação-do-rstudio"><i class="fa fa-check"></i><b>4.3</b> Instalação do RStudio</a></li>
<li class="chapter" data-level="4.4" data-path="cap1.html"><a href="cap1.html#versão-do-r"><i class="fa fa-check"></i><b>4.4</b> Versão do R</a></li>
<li class="chapter" data-level="4.5" data-path="cap1.html"><a href="cap1.html#pacotes"><i class="fa fa-check"></i><b>4.5</b> Pacotes</a></li>
<li class="chapter" data-level="4.6" data-path="cap1.html"><a href="cap1.html#dados"><i class="fa fa-check"></i><b>4.6</b> Dados</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cap4.html"><a href="cap4.html"><i class="fa fa-check"></i><b>5</b> Introdução ao R</a>
<ul>
<li class="chapter" data-level="" data-path="cap4.html"><a href="cap4.html#pré-requisitos-do-capítulo"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="5.1" data-path="cap4.html"><a href="cap4.html#contextualização"><i class="fa fa-check"></i><b>5.1</b> Contextualização</a></li>
<li class="chapter" data-level="5.2" data-path="cap4.html"><a href="cap4.html#r-e-rstudio"><i class="fa fa-check"></i><b>5.2</b> R e RStudio</a></li>
<li class="chapter" data-level="5.3" data-path="cap4.html"><a href="cap4.html#funcionamento-da-linguagem-r"><i class="fa fa-check"></i><b>5.3</b> Funcionamento da linguagem R</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="cap4.html"><a href="cap4.html#console"><i class="fa fa-check"></i><b>5.3.1</b> Console</a></li>
<li class="chapter" data-level="5.3.2" data-path="cap4.html"><a href="cap4.html#scripts"><i class="fa fa-check"></i><b>5.3.2</b> Scripts</a></li>
<li class="chapter" data-level="5.3.3" data-path="cap4.html"><a href="cap4.html#operadores"><i class="fa fa-check"></i><b>5.3.3</b> Operadores</a></li>
<li class="chapter" data-level="5.3.4" data-path="cap4.html"><a href="cap4.html#objetos"><i class="fa fa-check"></i><b>5.3.4</b> Objetos</a></li>
<li class="chapter" data-level="5.3.5" data-path="cap4.html"><a href="cap4.html#funções"><i class="fa fa-check"></i><b>5.3.5</b> Funções</a></li>
<li class="chapter" data-level="5.3.6" data-path="cap4.html"><a href="cap4.html#pacotes-1"><i class="fa fa-check"></i><b>5.3.6</b> Pacotes</a></li>
<li class="chapter" data-level="5.3.7" data-path="cap4.html"><a href="cap4.html#ajuda-help"><i class="fa fa-check"></i><b>5.3.7</b> Ajuda (<em>Help</em>)</a></li>
<li class="chapter" data-level="5.3.8" data-path="cap4.html"><a href="cap4.html#ambiente-environment"><i class="fa fa-check"></i><b>5.3.8</b> Ambiente (<em>Environment</em>)</a></li>
<li class="chapter" data-level="5.3.9" data-path="cap4.html"><a href="cap4.html#citações"><i class="fa fa-check"></i><b>5.3.9</b> Citações</a></li>
<li class="chapter" data-level="5.3.10" data-path="cap4.html"><a href="cap4.html#principais-erros-de-iniciantes"><i class="fa fa-check"></i><b>5.3.10</b> Principais erros de iniciantes</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="cap4.html"><a href="cap4.html#estrutura-e-manipulação-de-objetos"><i class="fa fa-check"></i><b>5.4</b> Estrutura e manipulação de objetos</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="cap4.html"><a href="cap4.html#atributo-dos-objetos"><i class="fa fa-check"></i><b>5.4.1</b> Atributo dos objetos</a></li>
<li class="chapter" data-level="5.4.2" data-path="cap4.html"><a href="cap4.html#manipulação-de-objetos-unidimensionais"><i class="fa fa-check"></i><b>5.4.2</b> Manipulação de objetos unidimensionais</a></li>
<li class="chapter" data-level="5.4.3" data-path="cap4.html"><a href="cap4.html#manipulação-de-objetos-multidimensionais"><i class="fa fa-check"></i><b>5.4.3</b> Manipulação de objetos multidimensionais</a></li>
<li class="chapter" data-level="5.4.4" data-path="cap4.html"><a href="cap4.html#valores-faltantes-e-especiais"><i class="fa fa-check"></i><b>5.4.4</b> Valores faltantes e especiais</a></li>
<li class="chapter" data-level="5.4.5" data-path="cap4.html"><a href="cap4.html#diretório-de-trabalho"><i class="fa fa-check"></i><b>5.4.5</b> Diretório de trabalho</a></li>
<li class="chapter" data-level="5.4.6" data-path="cap4.html"><a href="cap4.html#importar-dados"><i class="fa fa-check"></i><b>5.4.6</b> Importar dados</a></li>
<li class="chapter" data-level="5.4.7" data-path="cap4.html"><a href="cap4.html#conferência-dos-dados-importados"><i class="fa fa-check"></i><b>5.4.7</b> Conferência dos dados importados</a></li>
<li class="chapter" data-level="5.4.8" data-path="cap4.html"><a href="cap4.html#exportar-dados"><i class="fa fa-check"></i><b>5.4.8</b> Exportar dados</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="cap4.html"><a href="cap4.html#exercícios"><i class="fa fa-check"></i><b>5.5</b> Exercícios</a></li>
<li class="chapter" data-level="5.6" data-path="cap4.html"><a href="cap4.html#para-se-aprofundar"><i class="fa fa-check"></i><b>5.6</b> Para se aprofundar</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="cap4.html"><a href="cap4.html#livros"><i class="fa fa-check"></i><b>5.6.1</b> Livros</a></li>
<li class="chapter" data-level="5.6.2" data-path="cap4.html"><a href="cap4.html#links"><i class="fa fa-check"></i><b>5.6.2</b> Links</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cap5.html"><a href="cap5.html"><i class="fa fa-check"></i><b>6</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="" data-path="cap5.html"><a href="cap5.html#pré-requisitos-do-capítulo-1"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="6.1" data-path="cap5.html"><a href="cap5.html#contextualização-1"><i class="fa fa-check"></i><b>6.1</b> Contextualização</a></li>
<li class="chapter" data-level="6.2" data-path="cap5.html"><a href="cap5.html#tidyverse"><i class="fa fa-check"></i><b>6.2</b> <em>tidyverse</em></a></li>
<li class="chapter" data-level="6.3" data-path="cap5.html"><a href="cap5.html#here"><i class="fa fa-check"></i><b>6.3</b> here</a></li>
<li class="chapter" data-level="6.4" data-path="cap5.html"><a href="cap5.html#readr-readxl-e-writexl"><i class="fa fa-check"></i><b>6.4</b> readr, readxl e writexl</a></li>
<li class="chapter" data-level="6.5" data-path="cap5.html"><a href="cap5.html#tibble"><i class="fa fa-check"></i><b>6.5</b> tibble</a></li>
<li class="chapter" data-level="6.6" data-path="cap5.html"><a href="cap5.html#magrittr-pipe--"><i class="fa fa-check"></i><b>6.6</b> magrittr (pipe - %&gt;%)</a></li>
<li class="chapter" data-level="6.7" data-path="cap5.html"><a href="cap5.html#tidyr"><i class="fa fa-check"></i><b>6.7</b> tidyr</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="cap5.html"><a href="cap5.html#palmerpenguins"><i class="fa fa-check"></i><b>6.7.1</b> palmerpenguins</a></li>
<li class="chapter" data-level="6.7.2" data-path="cap5.html"><a href="cap5.html#glimpse"><i class="fa fa-check"></i><b>6.7.2</b> glimpse()</a></li>
<li class="chapter" data-level="6.7.3" data-path="cap5.html"><a href="cap5.html#unite"><i class="fa fa-check"></i><b>6.7.3</b> unite()</a></li>
<li class="chapter" data-level="6.7.4" data-path="cap5.html"><a href="cap5.html#separate"><i class="fa fa-check"></i><b>6.7.4</b> separate()</a></li>
<li class="chapter" data-level="6.7.5" data-path="cap5.html"><a href="cap5.html#drop_na-e-replace_na"><i class="fa fa-check"></i><b>6.7.5</b> drop_na() e replace_na()</a></li>
<li class="chapter" data-level="6.7.6" data-path="cap5.html"><a href="cap5.html#pivot_longer-e-pivot_wider"><i class="fa fa-check"></i><b>6.7.6</b> pivot_longer() e pivot_wider()</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="cap5.html"><a href="cap5.html#dplyr"><i class="fa fa-check"></i><b>6.8</b> dplyr</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="cap5.html"><a href="cap5.html#gramática"><i class="fa fa-check"></i><b>6.8.1</b> Gramática</a></li>
<li class="chapter" data-level="6.8.2" data-path="cap5.html"><a href="cap5.html#sintaxe"><i class="fa fa-check"></i><b>6.8.2</b> Sintaxe</a></li>
<li class="chapter" data-level="6.8.3" data-path="cap5.html"><a href="cap5.html#palmerpenguins-1"><i class="fa fa-check"></i><b>6.8.3</b> palmerpenguins</a></li>
<li class="chapter" data-level="6.8.4" data-path="cap5.html"><a href="cap5.html#relocate"><i class="fa fa-check"></i><b>6.8.4</b> relocate()</a></li>
<li class="chapter" data-level="6.8.5" data-path="cap5.html"><a href="cap5.html#rename"><i class="fa fa-check"></i><b>6.8.5</b> rename()</a></li>
<li class="chapter" data-level="6.8.6" data-path="cap5.html"><a href="cap5.html#select"><i class="fa fa-check"></i><b>6.8.6</b> select()</a></li>
<li class="chapter" data-level="6.8.7" data-path="cap5.html"><a href="cap5.html#pull"><i class="fa fa-check"></i><b>6.8.7</b> pull()</a></li>
<li class="chapter" data-level="6.8.8" data-path="cap5.html"><a href="cap5.html#mutate"><i class="fa fa-check"></i><b>6.8.8</b> mutate()</a></li>
<li class="chapter" data-level="6.8.9" data-path="cap5.html"><a href="cap5.html#arrange"><i class="fa fa-check"></i><b>6.8.9</b> arrange()</a></li>
<li class="chapter" data-level="6.8.10" data-path="cap5.html"><a href="cap5.html#filter"><i class="fa fa-check"></i><b>6.8.10</b> filter()</a></li>
<li class="chapter" data-level="6.8.11" data-path="cap5.html"><a href="cap5.html#slice"><i class="fa fa-check"></i><b>6.8.11</b> slice()</a></li>
<li class="chapter" data-level="6.8.12" data-path="cap5.html"><a href="cap5.html#distinct"><i class="fa fa-check"></i><b>6.8.12</b> distinct()</a></li>
<li class="chapter" data-level="6.8.13" data-path="cap5.html"><a href="cap5.html#count"><i class="fa fa-check"></i><b>6.8.13</b> count()</a></li>
<li class="chapter" data-level="6.8.14" data-path="cap5.html"><a href="cap5.html#group_by"><i class="fa fa-check"></i><b>6.8.14</b> group_by()</a></li>
<li class="chapter" data-level="6.8.15" data-path="cap5.html"><a href="cap5.html#summarise"><i class="fa fa-check"></i><b>6.8.15</b> summarise()</a></li>
<li class="chapter" data-level="6.8.16" data-path="cap5.html"><a href="cap5.html#bind_rows-e-bind_cols"><i class="fa fa-check"></i><b>6.8.16</b> bind_rows() e bind_cols()</a></li>
<li class="chapter" data-level="6.8.17" data-path="cap5.html"><a href="cap5.html#join"><i class="fa fa-check"></i><b>6.8.17</b> *_join()</a></li>
<li class="chapter" data-level="6.8.18" data-path="cap5.html"><a href="cap5.html#operações-de-conjuntos-e-comparação-de-dados"><i class="fa fa-check"></i><b>6.8.18</b> Operações de conjuntos e comparação de dados</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="cap5.html"><a href="cap5.html#stringr"><i class="fa fa-check"></i><b>6.9</b> stringr</a></li>
<li class="chapter" data-level="6.10" data-path="cap5.html"><a href="cap5.html#forcats"><i class="fa fa-check"></i><b>6.10</b> forcats</a></li>
<li class="chapter" data-level="6.11" data-path="cap5.html"><a href="cap5.html#lubridate"><i class="fa fa-check"></i><b>6.11</b> lubridate</a></li>
<li class="chapter" data-level="6.12" data-path="cap5.html"><a href="cap5.html#purrr"><i class="fa fa-check"></i><b>6.12</b> purrr</a></li>
<li class="chapter" data-level="6.13" data-path="cap5.html"><a href="cap5.html#exercícios-1"><i class="fa fa-check"></i><b>6.13</b> Exercícios</a></li>
<li class="chapter" data-level="6.14" data-path="cap5.html"><a href="cap5.html#para-se-aprofundar-1"><i class="fa fa-check"></i><b>6.14</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="cap6.html"><a href="cap6.html"><i class="fa fa-check"></i><b>7</b> Visualização de dados</a>
<ul>
<li class="chapter" data-level="" data-path="cap6.html"><a href="cap6.html#pré-requisitos-do-capítulo-2"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="7.1" data-path="cap6.html"><a href="cap6.html#contextualização-2"><i class="fa fa-check"></i><b>7.1</b> Contextualização</a></li>
<li class="chapter" data-level="7.2" data-path="cap6.html"><a href="cap6.html#principais-pacotes"><i class="fa fa-check"></i><b>7.2</b> Principais pacotes</a></li>
<li class="chapter" data-level="7.3" data-path="cap6.html"><a href="cap6.html#grámatica-dos-gráficos"><i class="fa fa-check"></i><b>7.3</b> Grámatica dos gráficos</a></li>
<li class="chapter" data-level="7.4" data-path="cap6.html"><a href="cap6.html#tipos-de-gráficos"><i class="fa fa-check"></i><b>7.4</b> Tipos de gráficos</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="cap6.html"><a href="cap6.html#histograma-histogram"><i class="fa fa-check"></i><b>7.4.1</b> Histograma (<em>histogram</em>)</a></li>
<li class="chapter" data-level="7.4.2" data-path="cap6.html"><a href="cap6.html#gráfico-de-densidade-density-plot"><i class="fa fa-check"></i><b>7.4.2</b> Gráfico de densidade (<em>density plot</em>)</a></li>
<li class="chapter" data-level="7.4.3" data-path="cap6.html"><a href="cap6.html#diagrama-de-pontos-dot-plot"><i class="fa fa-check"></i><b>7.4.3</b> Diagrama de pontos (<em>dot plot</em>)</a></li>
<li class="chapter" data-level="7.4.4" data-path="cap6.html"><a href="cap6.html#gráfico-de-barras-bar-plot"><i class="fa fa-check"></i><b>7.4.4</b> Gráfico de barras (<em>bar plot</em>)</a></li>
<li class="chapter" data-level="7.4.5" data-path="cap6.html"><a href="cap6.html#gráfico-de-setores-pie-chart-e-donut-chart"><i class="fa fa-check"></i><b>7.4.5</b> Gráfico de setores (<em>pie chart</em> e <em>donut chart</em>)</a></li>
<li class="chapter" data-level="7.4.6" data-path="cap6.html"><a href="cap6.html#gráfico-de-caixa-boxplot"><i class="fa fa-check"></i><b>7.4.6</b> Gráfico de caixa (<em>boxplot</em>)</a></li>
<li class="chapter" data-level="7.4.7" data-path="cap6.html"><a href="cap6.html#gráfico-de-dispersão-scatter-plot"><i class="fa fa-check"></i><b>7.4.7</b> Gráfico de dispersão (<em>scatter plot</em>)</a></li>
<li class="chapter" data-level="7.4.8" data-path="cap6.html"><a href="cap6.html#visualização-de-múltiplos-gráficos-pareados"><i class="fa fa-check"></i><b>7.4.8</b> Visualização de múltiplos gráficos pareados</a></li>
<li class="chapter" data-level="7.4.9" data-path="cap6.html"><a href="cap6.html#erros-comuns-dos-usuários-do-ggplot2-e-como-evitá-los"><i class="fa fa-check"></i><b>7.4.9</b> Erros comuns dos usuários do <code>ggplot2</code> e como evitá-los</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="cap6.html"><a href="cap6.html#finalização-de-gráficos-para-publicação"><i class="fa fa-check"></i><b>7.5</b> Finalização de gráficos para publicação</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="cap6.html"><a href="cap6.html#posição-cores-e-fonte-da-legenda"><i class="fa fa-check"></i><b>7.5.1</b> Posição, cores e fonte da legenda</a></li>
<li class="chapter" data-level="7.5.2" data-path="cap6.html"><a href="cap6.html#elementos-gráficos-eixo-fonte-gride"><i class="fa fa-check"></i><b>7.5.2</b> Elementos gráficos: eixo, fonte, gride</a></li>
<li class="chapter" data-level="7.5.3" data-path="cap6.html"><a href="cap6.html#temas-personalizados-ggtheme-existem-vários-temas-criados-dentro-do-universo-ggtheme-que-podem-facilitar"><i class="fa fa-check"></i><b>7.5.3</b> Temas personalizados <code>ggtheme()</code> Existem vários temas criados dentro do universo ggtheme() que podem facilitar</a></li>
<li class="chapter" data-level="7.5.4" data-path="cap6.html"><a href="cap6.html#criando-seu-próprio-theme_custom"><i class="fa fa-check"></i><b>7.5.4</b> Criando seu próprio <code>theme_custom()</code></a></li>
<li class="chapter" data-level="7.5.5" data-path="cap6.html"><a href="cap6.html#exportando-dados-com-alta-qualidade-com-a-função-ggsave"><i class="fa fa-check"></i><b>7.5.5</b> Exportando dados com alta qualidade com a função <code>ggsave()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="cap6.html"><a href="cap6.html#para-se-aprofundar-2"><i class="fa fa-check"></i><b>7.6</b> Para se aprofundar</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="cap6.html"><a href="cap6.html#livros-1"><i class="fa fa-check"></i><b>7.6.1</b> Livros</a></li>
<li class="chapter" data-level="7.6.2" data-path="cap6.html"><a href="cap6.html#links-1"><i class="fa fa-check"></i><b>7.6.2</b> Links</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cap7.html"><a href="cap7.html"><i class="fa fa-check"></i><b>8</b> Modelos lineares</a>
<ul>
<li class="chapter" data-level="" data-path="cap7.html"><a href="cap7.html#pré-requisitos-do-capítulo-3"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="8.1" data-path="cap7.html"><a href="cap7.html#teste-t-de-student-para-duas-amostras-independentes"><i class="fa fa-check"></i><b>8.1</b> Teste T (de Student) para duas amostras independentes</a></li>
<li class="chapter" data-level="8.2" data-path="cap7.html"><a href="cap7.html#teste-t-para-amostras-pareadas"><i class="fa fa-check"></i><b>8.2</b> Teste T para amostras pareadas</a></li>
<li class="chapter" data-level="8.3" data-path="cap7.html"><a href="cap7.html#correlação-de-pearson"><i class="fa fa-check"></i><b>8.3</b> Correlação de Pearson</a></li>
<li class="chapter" data-level="8.4" data-path="cap7.html"><a href="cap7.html#regressão-linear-simples"><i class="fa fa-check"></i><b>8.4</b> Regressão Linear Simples</a></li>
<li class="chapter" data-level="8.5" data-path="cap7.html"><a href="cap7.html#regressão-linear-múltipla"><i class="fa fa-check"></i><b>8.5</b> Regressão Linear Múltipla</a></li>
<li class="chapter" data-level="8.6" data-path="cap7.html"><a href="cap7.html#análises-de-variância-anova"><i class="fa fa-check"></i><b>8.6</b> Análises de Variância (ANOVA)</a></li>
<li class="chapter" data-level="8.7" data-path="cap7.html"><a href="cap7.html#anova-de-um-fator"><i class="fa fa-check"></i><b>8.7</b> ANOVA de um fator</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="cap7.html"><a href="cap7.html#análise"><i class="fa fa-check"></i><b>8.7.1</b> Análise</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="cap7.html"><a href="cap7.html#anova-com-dois-fatores-ou-anova-fatorial"><i class="fa fa-check"></i><b>8.8</b> ANOVA com dois fatores ou ANOVA fatorial</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="cap7.html"><a href="cap7.html#análise-1"><i class="fa fa-check"></i><b>8.8.1</b> Análise</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="cap7.html"><a href="cap7.html#anova-em-blocos-aleatorizados"><i class="fa fa-check"></i><b>8.9</b> ANOVA em blocos aleatorizados</a></li>
<li class="chapter" data-level="8.10" data-path="cap7.html"><a href="cap7.html#análise-de-covariância-ancova"><i class="fa fa-check"></i><b>8.10</b> Análise de covariância (ANCOVA)</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="cap7.html"><a href="cap7.html#análise-2"><i class="fa fa-check"></i><b>8.10.1</b> Análise</a></li>
<li class="chapter" data-level="8.10.2" data-path="cap7.html"><a href="cap7.html#para-se-aprofundar-3"><i class="fa fa-check"></i><b>8.10.2</b> Para se aprofundar</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cap8.html"><a href="cap8.html"><i class="fa fa-check"></i><b>9</b> Cap. 8 - Análises univariadas (modelos lineares mistos generalizados)</a>
<ul>
<li class="chapter" data-level="" data-path="cap8.html"><a href="cap8.html#pré-requisitos-do-capítulo-4"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="9.1" data-path="cap8.html"><a href="cap8.html#introdução-2"><i class="fa fa-check"></i><b>9.1</b> Introdução</a></li>
<li class="chapter" data-level="9.2" data-path="cap8.html"><a href="cap8.html#como-um-glm-funciona"><i class="fa fa-check"></i><b>9.2</b> Como um GLM funciona?</a></li>
<li class="chapter" data-level="9.3" data-path="cap8.html"><a href="cap8.html#como-escolher-a-distribuição-correta-para-seus-dados"><i class="fa fa-check"></i><b>9.3</b> Como escolher a distribuição correta para seus dados?</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="cap8.html"><a href="cap8.html#para-dados-contínuos"><i class="fa fa-check"></i><b>9.3.1</b> Para dados contínuos</a></li>
<li class="chapter" data-level="9.3.2" data-path="cap8.html"><a href="cap8.html#para-dados-de-contagem"><i class="fa fa-check"></i><b>9.3.2</b> Para dados de contagem</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="cap8.html"><a href="cap8.html#dados-de-contagem-a-distribuição-de-poisson"><i class="fa fa-check"></i><b>9.4</b> Dados de contagem: a distribuição de Poisson</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="cap8.html"><a href="cap8.html#o-que-causa-a-overdispersion"><i class="fa fa-check"></i><b>9.4.1</b> O que causa a <em>overdispersion</em>?</a></li>
<li class="chapter" data-level="9.4.2" data-path="cap8.html"><a href="cap8.html#o-que-fazer-se-seu-modelo-tiver-overdispersion"><i class="fa fa-check"></i><b>9.4.2</b> O que fazer se seu modelo tiver <em>overdispersion</em>?</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="cap8.html"><a href="cap8.html#dados-de-contagem-modelos-quasi-likelihood"><i class="fa fa-check"></i><b>9.5</b> Dados de contagem: modelos quasi-likelihood</a></li>
<li class="chapter" data-level="9.6" data-path="cap8.html"><a href="cap8.html#dados-de-contagem-a-distribuição-binomial"><i class="fa fa-check"></i><b>9.6</b> Dados de contagem: a distribuição Binomial</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="cap8.html"><a href="cap8.html#análise-com-dados-de-proporção"><i class="fa fa-check"></i><b>9.6.1</b> Análise com dados de proporção</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="cap8.html"><a href="cap8.html#análise-com-dados-de-incidência"><i class="fa fa-check"></i><b>9.7</b> Análise com dados de incidência</a></li>
<li class="chapter" data-level="9.8" data-path="cap8.html"><a href="cap8.html#dados-de-contagem-com-excesso-de-zeros"><i class="fa fa-check"></i><b>9.8</b> Dados de contagem com excesso de zeros</a></li>
<li class="chapter" data-level="9.9" data-path="cap8.html"><a href="cap8.html#dados-ordinais-os-modelos-cumulative-link"><i class="fa fa-check"></i><b>9.9</b> Dados ordinais: os modelos cumulative link</a></li>
<li class="chapter" data-level="9.10" data-path="cap8.html"><a href="cap8.html#dados-contínuos-distribuição-beta"><i class="fa fa-check"></i><b>9.10</b> Dados contínuos: distribuição beta</a></li>
<li class="chapter" data-level="9.11" data-path="cap8.html"><a href="cap8.html#leituras-recomendadas"><i class="fa fa-check"></i><b>9.11</b> Leituras recomendadas</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cap9.html"><a href="cap9.html"><i class="fa fa-check"></i><b>10</b> Análises Multidimensionais</a>
<ul>
<li class="chapter" data-level="" data-path="cap9.html"><a href="cap9.html#pré-requisitos-do-capítulo-5"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="10.1" data-path="cap9.html"><a href="cap9.html#aspectos-teóricos"><i class="fa fa-check"></i><b>10.1</b> Aspectos teóricos</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="cap9.html"><a href="cap9.html#coeficientes-de-associação"><i class="fa fa-check"></i><b>10.1.1</b> Coeficientes de associação</a></li>
<li class="chapter" data-level="10.1.2" data-path="cap9.html"><a href="cap9.html#métricas-de-distância"><i class="fa fa-check"></i><b>10.1.2</b> Métricas de distância</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="cap9.html"><a href="cap9.html#análise-de-agrupamento-hierárquico"><i class="fa fa-check"></i><b>10.2</b> Análise de agrupamento hierárquico</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="cap9.html"><a href="cap9.html#análise-no-r"><i class="fa fa-check"></i><b>10.2.1</b> Análise no R</a></li>
<li class="chapter" data-level="10.2.2" data-path="cap9.html"><a href="cap9.html#assessando-a-qualidade-do-dendrograma"><i class="fa fa-check"></i><b>10.2.2</b> Assessando a qualidade do dendrograma</a></li>
<li class="chapter" data-level="10.2.3" data-path="cap9.html"><a href="cap9.html#análise-no-r-1"><i class="fa fa-check"></i><b>10.2.3</b> Análise no R</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="cap9.html"><a href="cap9.html#k-means-e-agrupamentos-não-hierárquicos"><i class="fa fa-check"></i><b>10.3</b> K-means e agrupamentos não-hierárquicos</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="cap9.html"><a href="cap9.html#análise-4"><i class="fa fa-check"></i><b>10.3.1</b> Análise</a></li>
<li class="chapter" data-level="10.3.2" data-path="cap9.html"><a href="cap9.html#interpretação-dos-resultados-6"><i class="fa fa-check"></i><b>10.3.2</b> Interpretação dos resultados</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="cap9.html"><a href="cap9.html#espécies-indicadoras"><i class="fa fa-check"></i><b>10.4</b> Espécies indicadoras</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="cap9.html"><a href="cap9.html#análise-no-r-2"><i class="fa fa-check"></i><b>10.4.1</b> Análise no R</a></li>
<li class="chapter" data-level="10.4.2" data-path="cap9.html"><a href="cap9.html#interpretação-dos-resultados-7"><i class="fa fa-check"></i><b>10.4.2</b> Interpretação dos resultados</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="cap9.html"><a href="cap9.html#análises-de-ordenação"><i class="fa fa-check"></i><b>10.5</b> Análises de Ordenação</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="cap9.html"><a href="cap9.html#ordenações-irrestritas"><i class="fa fa-check"></i><b>10.5.1</b> Ordenações irrestritas</a></li>
<li class="chapter" data-level="10.5.2" data-path="cap9.html"><a href="cap9.html#análise-de-coordenadas-principais---pcoa"><i class="fa fa-check"></i><b>10.5.2</b> Análise de Coordenadas Principais - PCoA</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="cap9.html"><a href="cap9.html#pcr---regressão-de-componentes-principais"><i class="fa fa-check"></i><b>10.6</b> PCR - Regressão de Componentes Principais</a></li>
<li class="chapter" data-level="10.7" data-path="cap9.html"><a href="cap9.html#ordenação-restrita"><i class="fa fa-check"></i><b>10.7</b> Ordenação restrita</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="cap9.html"><a href="cap9.html#rda-análise-de-redundância"><i class="fa fa-check"></i><b>10.7.1</b> RDA: Análise de Redundância</a></li>
<li class="chapter" data-level="10.7.2" data-path="cap9.html"><a href="cap9.html#rdap-análise-de-redundância-parcial"><i class="fa fa-check"></i><b>10.7.2</b> RDAp: Análise de Redundância parcial</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="cap9.html"><a href="cap9.html#permanova"><i class="fa fa-check"></i><b>10.8</b> PERMANOVA</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="cap9.html"><a href="cap9.html#para-se-aprofundar-4"><i class="fa fa-check"></i><b>10.8.1</b> Para se aprofundar</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="cap10.html"><a href="cap10.html"><i class="fa fa-check"></i><b>11</b> Rarefação</a>
<ul>
<li class="chapter" data-level="" data-path="cap10.html"><a href="cap10.html#pré-requisitos-do-capítulo-6"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="11.1" data-path="cap10.html"><a href="cap10.html#aspectos-teóricos-1"><i class="fa fa-check"></i><b>11.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="11.2" data-path="cap10.html"><a href="cap10.html#curva-de-rarefação-baseada-no-indivíduo-individual-based"><i class="fa fa-check"></i><b>11.2</b> Curva de rarefação baseada no indivíduo (<em>individual-based</em>)</a></li>
<li class="chapter" data-level="11.3" data-path="cap10.html"><a href="cap10.html#curva-de-rarefação-baseada-em-amostras-sample-based"><i class="fa fa-check"></i><b>11.3</b> Curva de rarefação baseada em amostras (<em>sample-based</em>)</a></li>
<li class="chapter" data-level="11.4" data-path="cap10.html"><a href="cap10.html#curva-de-rarefação-coverage-based"><i class="fa fa-check"></i><b>11.4</b> Curva de rarefação <em>coverage-based</em></a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="cap10.html"><a href="cap10.html#para-se-aprofundar-5"><i class="fa fa-check"></i><b>11.4.1</b> Para se aprofundar</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="cap11.html"><a href="cap11.html"><i class="fa fa-check"></i><b>12</b> Estimadores de riqueza</a>
<ul>
<li class="chapter" data-level="" data-path="cap11.html"><a href="cap11.html#pré-requisitos-do-capítulo-7"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="12.1" data-path="cap11.html"><a href="cap11.html#aspectos-teóricos-2"><i class="fa fa-check"></i><b>12.1</b> Aspectos teóricos</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="cap11.html"><a href="cap11.html#quatro-características-para-um-bom-estimador-de-riqueza-chazdon1998-hortal2006"><i class="fa fa-check"></i><b>12.1.1</b> Quatro características para um bom estimador de riqueza <span class="citation">(<span>Chazdon et al., 1998</span>; <span>Hortal et al., 2006</span>)</span>:</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="cap11.html"><a href="cap11.html#estimadores-baseados-na-abundância-das-espécies"><i class="fa fa-check"></i><b>12.2</b> Estimadores baseados na abundância das espécies</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="cap11.html"><a href="cap11.html#chao-1---chao1984-chao1987"><i class="fa fa-check"></i><b>12.2.1</b> CHAO 1 - <span class="citation">(<span>Chao, 1984</span>, <span>1987</span>)</span>:</a></li>
<li class="chapter" data-level="12.2.2" data-path="cap11.html"><a href="cap11.html#ace---abundance-based-coverage-estimador-chao1992-chao2000"><i class="fa fa-check"></i><b>12.2.2</b> ACE - <em>Abundance-based Coverage Estimador</em> <span class="citation">(<span>Chao et al., 2000</span>; <span>Chao &amp; Lee, 1992</span>)</span>:</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="cap11.html"><a href="cap11.html#estimadores-baseados-na-incidência-das-espécies"><i class="fa fa-check"></i><b>12.3</b> Estimadores baseados na incidência das espécies</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="cap11.html"><a href="cap11.html#chao-2---chao1987"><i class="fa fa-check"></i><b>12.3.1</b> CHAO 2 - <span class="citation">(<span>Chao, 1987</span>)</span>:</a></li>
<li class="chapter" data-level="12.3.2" data-path="cap11.html"><a href="cap11.html#jackknife-1-burnham1978-burnham1979"><i class="fa fa-check"></i><b>12.3.2</b> JACKKNIFE 1 <span class="citation">(<span>Burnham &amp; Overton, 1979</span>, <span>1978</span>)</span>:</a></li>
<li class="chapter" data-level="12.3.3" data-path="cap11.html"><a href="cap11.html#jackknife-2-burnham1978-burnham1979-palmer1991"><i class="fa fa-check"></i><b>12.3.3</b> JACKKNIFE 2 <span class="citation">(<span>Burnham &amp; Overton, 1979</span>, <span>1978</span>; <span>Palmer, 1991</span>)</span>:</a></li>
<li class="chapter" data-level="12.3.4" data-path="cap11.html"><a href="cap11.html#bootstrap-smith1984"><i class="fa fa-check"></i><b>12.3.4</b> BOOTSTRAP <span class="citation">(<span>Smith &amp; van Belle, 1984</span>)</span>:</a></li>
<li class="chapter" data-level="12.3.5" data-path="cap11.html"><a href="cap11.html#interpolação-e-extrapolação-baseadas-em-rarefação-usando-amostragens-de-incidência-ou-abundância-chao2012-colwell2012"><i class="fa fa-check"></i><b>12.3.5</b> Interpolação e Extrapolação baseadas em rarefação usando amostragens de incidência ou abundância <span class="citation">(<span>Chao &amp; Jost, 2012</span>; <span>Colwell et al., 2012</span>)</span>:</a></li>
<li class="chapter" data-level="12.3.6" data-path="cap11.html"><a href="cap11.html#para-se-aprofundar-6"><i class="fa fa-check"></i><b>12.3.6</b> Para se aprofundar</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="cap12.html"><a href="cap12.html"><i class="fa fa-check"></i><b>13</b> Diversidade Taxonômica</a>
<ul>
<li class="chapter" data-level="" data-path="cap12.html"><a href="cap12.html#pré-requisitos-do-capítulo-8"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="13.1" data-path="cap12.html"><a href="cap12.html#aspectos-teóricos-3"><i class="fa fa-check"></i><b>13.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="13.2" data-path="cap12.html"><a href="cap12.html#diversidade-alfa"><i class="fa fa-check"></i><b>13.2</b> Diversidade alfa</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="cap12.html"><a href="cap12.html#riqueza-de-espécies-ou-número-de-espécies"><i class="fa fa-check"></i><b>13.2.1</b> Riqueza de espécies ou número de espécies</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="cap12.html"><a href="cap12.html#diversidade-de-espécies"><i class="fa fa-check"></i><b>13.3</b> Diversidade de espécies</a></li>
<li class="chapter" data-level="13.4" data-path="cap12.html"><a href="cap12.html#diagramas-de-whittaker-ou-curva-de-dominância"><i class="fa fa-check"></i><b>13.4</b> Diagramas de Whittaker ou Curva de Dominância</a></li>
<li class="chapter" data-level="13.5" data-path="cap12.html"><a href="cap12.html#curvas-de-distribuição-de-abundâncias"><i class="fa fa-check"></i><b>13.5</b> Curvas de distribuição de abundâncias</a></li>
<li class="chapter" data-level="13.6" data-path="cap12.html"><a href="cap12.html#números-de-hill-ou-série-de-hill"><i class="fa fa-check"></i><b>13.6</b> Números de Hill ou Série de Hill</a></li>
<li class="chapter" data-level="13.7" data-path="cap12.html"><a href="cap12.html#diversidade-beta"><i class="fa fa-check"></i><b>13.7</b> Diversidade beta</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="cap12.html"><a href="cap12.html#para-se-aprofundar-7"><i class="fa fa-check"></i><b>13.7.1</b> Para se aprofundar</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="cap13.html"><a href="cap13.html"><i class="fa fa-check"></i><b>14</b> Diversidade Filogenética</a>
<ul>
<li class="chapter" data-level="" data-path="cap13.html"><a href="cap13.html#pré-requisitos-do-capítulo-9"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="14.1" data-path="cap13.html"><a href="cap13.html#aspectos-teóricos-4"><i class="fa fa-check"></i><b>14.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="14.2" data-path="cap13.html"><a href="cap13.html#manipulação-de-filogenias"><i class="fa fa-check"></i><b>14.2</b> Manipulação de filogenias</a></li>
<li class="chapter" data-level="14.3" data-path="cap13.html"><a href="cap13.html#métricas-de-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>14.3</b> Métricas de diversidade alfa filogenética</a></li>
<li class="chapter" data-level="14.4" data-path="cap13.html"><a href="cap13.html#análise-da-dimensão-riqueza-da-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>14.4</b> Análise da dimensão riqueza da diversidade alfa filogenética</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="cap13.html"><a href="cap13.html#phylogenetic-diversity-pd-faith-1992"><i class="fa fa-check"></i><b>14.4.1</b> Phylogenetic diversity (PD, Faith 1992)</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="cap13.html"><a href="cap13.html#phylogenetic-species-richness-psr-helmus-et-al.-2007"><i class="fa fa-check"></i><b>14.5</b> Phylogenetic Species Richness (PSR, Helmus et al. 2007)</a></li>
<li class="chapter" data-level="14.6" data-path="cap13.html"><a href="cap13.html#phylogenetic-endemism-pe-rosauer-et-al.-2009"><i class="fa fa-check"></i><b>14.6</b> Phylogenetic Endemism (PE, Rosauer et al. 2009)</a></li>
<li class="chapter" data-level="14.7" data-path="cap13.html"><a href="cap13.html#species-evolutionary-distinctiveness-ed-redding-mooers-2006"><i class="fa fa-check"></i><b>14.7</b> Species Evolutionary Distinctiveness (ED, Redding &amp; Mooers 2006)</a></li>
<li class="chapter" data-level="14.8" data-path="cap13.html"><a href="cap13.html#análise-da-dimensão-divergência-da-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>14.8</b> Análise da dimensão divergência da diversidade alfa filogenética</a></li>
<li class="chapter" data-level="14.9" data-path="cap13.html"><a href="cap13.html#mean-pairwise-distance-mpd-webb-et-al.-2002"><i class="fa fa-check"></i><b>14.9</b> Mean Pairwise Distance (MPD, Webb et al. 2002)</a></li>
<li class="chapter" data-level="14.10" data-path="cap13.html"><a href="cap13.html#mean-nearest-taxon-distance-mntd-webb-et-al.-2002"><i class="fa fa-check"></i><b>14.10</b> Mean Nearest Taxon Distance (MNTD, Webb et al. 2002)</a></li>
<li class="chapter" data-level="14.11" data-path="cap13.html"><a href="cap13.html#phylogenetic-species-variability-psv-helmus-et-al.-2007"><i class="fa fa-check"></i><b>14.11</b> Phylogenetic Species Variability (PSV, Helmus et al. 2007)</a></li>
<li class="chapter" data-level="14.12" data-path="cap13.html"><a href="cap13.html#análise-da-dimensão-regularidade-da-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>14.12</b> Análise da dimensão regularidade da diversidade alfa filogenética</a></li>
<li class="chapter" data-level="14.13" data-path="cap13.html"><a href="cap13.html#variance-of-pairwise-distance-vpd-clarke-warwick-2001"><i class="fa fa-check"></i><b>14.13</b> Variance of Pairwise Distance (VPD, Clarke &amp; Warwick 2001)</a></li>
<li class="chapter" data-level="14.14" data-path="cap13.html"><a href="cap13.html#correlação-entre-as-métricas-de-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>14.14</b> Correlação entre as métricas de diversidade alfa filogenética</a></li>
<li class="chapter" data-level="14.15" data-path="cap13.html"><a href="cap13.html#associação-entre-as-métricas-de-diversidade-alfa-filogenética-e-o-gradiente-de-precipitação"><i class="fa fa-check"></i><b>14.15</b> Associação entre as métricas de diversidade alfa filogenética e o gradiente de precipitação</a></li>
<li class="chapter" data-level="14.16" data-path="cap13.html"><a href="cap13.html#métricas-de-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>14.16</b> Métricas de diversidade beta filogenética</a></li>
<li class="chapter" data-level="14.17" data-path="cap13.html"><a href="cap13.html#análise-da-dimensão-divergência-da-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>14.17</b> Análise da dimensão divergência da diversidade beta filogenética</a></li>
<li class="chapter" data-level="14.18" data-path="cap13.html"><a href="cap13.html#community-mean-pairwise-distance-comdist-webb-et-al.-2008"><i class="fa fa-check"></i><b>14.18</b> Community Mean Pairwise Distance (COMDIST, Webb et al. 2008)</a></li>
<li class="chapter" data-level="14.19" data-path="cap13.html"><a href="cap13.html#community-mean-nearest-taxon-distance-comdistnt-webb-et-al.-2008"><i class="fa fa-check"></i><b>14.19</b> Community Mean Nearest Taxon Distance (COMDISTNT, Webb et al. 2008)</a></li>
<li class="chapter" data-level="14.20" data-path="cap13.html"><a href="cap13.html#correlação-entre-as-métricas-de-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>14.20</b> Correlação entre as métricas de diversidade beta filogenética</a></li>
<li class="chapter" data-level="14.21" data-path="cap13.html"><a href="cap13.html#associação-entre-as-métricas-de-diversidade-beta-filogenética-e-o-gradiente-de-precipitação"><i class="fa fa-check"></i><b>14.21</b> Associação entre as métricas de diversidade beta filogenética e o gradiente de precipitação</a></li>
<li class="chapter" data-level="14.22" data-path="cap13.html"><a href="cap13.html#análise-da-dimensão-riqueza-da-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>14.22</b> Análise da dimensão riqueza da diversidade beta filogenética</a></li>
<li class="chapter" data-level="14.23" data-path="cap13.html"><a href="cap13.html#phylogenetic-index-of-beta-diversity-phylosor-bryant-et-al.-2008"><i class="fa fa-check"></i><b>14.23</b> Phylogenetic index of beta diversity (Phylosor, Bryant et al. 2008)</a></li>
<li class="chapter" data-level="14.24" data-path="cap13.html"><a href="cap13.html#unique-fraction-metric-unifrac-lozupone-knight-2005"><i class="fa fa-check"></i><b>14.24</b> Unique Fraction metric (UniFrac, Lozupone &amp; Knight 2005)</a></li>
<li class="chapter" data-level="14.25" data-path="cap13.html"><a href="cap13.html#vamos-avaliar-a-correlação-entre-phylosor-e-unifrac"><i class="fa fa-check"></i><b>14.25</b> Vamos avaliar a correlação entre Phylosor e Unifrac</a></li>
<li class="chapter" data-level="14.26" data-path="cap13.html"><a href="cap13.html#partição-da-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>14.26</b> Partição da diversidade beta filogenética</a></li>
<li class="chapter" data-level="14.27" data-path="cap13.html"><a href="cap13.html#modelos-nulos"><i class="fa fa-check"></i><b>14.27</b> Modelos Nulos</a></li>
<li class="chapter" data-level="14.28" data-path="cap13.html"><a href="cap13.html#nearest-relative-index-nri-ou-standardized-effect-size-of-mpd-webb-et-al.-2008"><i class="fa fa-check"></i><b>14.28</b> Nearest Relative Index (NRI) ou Standardized Effect Size of MPD (Webb et al. 2008)</a></li>
<li class="chapter" data-level="14.29" data-path="cap13.html"><a href="cap13.html#nearest-taxon-index-nti-ou-standardized-effect-size-of-mntd-webb-et-al.-2008"><i class="fa fa-check"></i><b>14.29</b> Nearest Taxon Index (NTI) ou Standardized Effect Size of MNTD (Webb et al. 2008)</a></li>
<li class="chapter" data-level="14.30" data-path="cap13.html"><a href="cap13.html#standardized-effect-size-of-pd-webb-et-al.-2008"><i class="fa fa-check"></i><b>14.30</b> Standardized Effect Size of PD (Webb et al. 2008)</a></li>
<li class="chapter" data-level="14.31" data-path="cap13.html"><a href="cap13.html#standardized-effect-size"><i class="fa fa-check"></i><b>14.31</b> Standardized Effect Size</a>
<ul>
<li class="chapter" data-level="14.31.1" data-path="cap13.html"><a href="cap13.html#para-se-aprofundar-8"><i class="fa fa-check"></i><b>14.31.1</b> Para se aprofundar</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="cap14.html"><a href="cap14.html"><i class="fa fa-check"></i><b>15</b> Diversidade Funcional</a>
<ul>
<li class="chapter" data-level="" data-path="cap14.html"><a href="cap14.html#pré-requisitos-do-capítulo-10"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="15.1" data-path="cap14.html"><a href="cap14.html#aspectos-teóricos-5"><i class="fa fa-check"></i><b>15.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="15.2" data-path="cap14.html"><a href="cap14.html#definindo-a-dissimilaridade-entre-espécies"><i class="fa fa-check"></i><b>15.2</b> Definindo a dis(similaridade) entre espécies</a></li>
<li class="chapter" data-level="15.3" data-path="cap14.html"><a href="cap14.html#métricas-de-diversidade-funcional-alpha"><i class="fa fa-check"></i><b>15.3</b> Métricas de diversidade funcional (alpha)</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="cap14.html"><a href="cap14.html#riqueza-funcional"><i class="fa fa-check"></i><b>15.3.1</b> Riqueza funcional</a></li>
<li class="chapter" data-level="15.3.2" data-path="cap14.html"><a href="cap14.html#divergência-funcional"><i class="fa fa-check"></i><b>15.3.2</b> Divergência funcional</a></li>
<li class="chapter" data-level="15.3.3" data-path="cap14.html"><a href="cap14.html#regularidade-funcional"><i class="fa fa-check"></i><b>15.3.3</b> Regularidade funcional</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="cap14.html"><a href="cap14.html#métricas-de-diversidade-funcional-beta"><i class="fa fa-check"></i><b>15.4</b> Métricas de diversidade funcional (beta)</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="cap14.html"><a href="cap14.html#composição-funcional"><i class="fa fa-check"></i><b>15.4.1</b> Composição Funcional</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="cap14.html"><a href="cap14.html#variação-intraspecífica"><i class="fa fa-check"></i><b>15.5</b> Variação Intraspecífica</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="cap15.html"><a href="cap15.html"><i class="fa fa-check"></i><b>16</b> Dados geoespaciais no R</a>
<ul>
<li class="chapter" data-level="" data-path="cap15.html"><a href="cap15.html#pré-requisitos-do-capítulo-11"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="16.1" data-path="cap15.html"><a href="cap15.html#introdução-3"><i class="fa fa-check"></i><b>16.1</b> Introdução</a></li>
<li class="chapter" data-level="16.2" data-path="cap15.html"><a href="cap15.html#vetor-1"><i class="fa fa-check"></i><b>16.2</b> Vetor</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="cap15.html"><a href="cap15.html#sf-principal-pacote-no-r-para-dados-vetoriais"><i class="fa fa-check"></i><b>16.2.1</b> sf: principal pacote no R para dados vetoriais</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="cap15.html"><a href="cap15.html#raster"><i class="fa fa-check"></i><b>16.3</b> Raster</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="cap15.html"><a href="cap15.html#raster-principal-pacote-no-r-para-dados-raster"><i class="fa fa-check"></i><b>16.3.1</b> raster: principal pacote no R para dados raster</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="cap15.html"><a href="cap15.html#sistema-de-referência-de-coordenadas-e-unidades"><i class="fa fa-check"></i><b>16.4</b> Sistema de Referência de Coordenadas e Unidades</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="cap15.html"><a href="cap15.html#sistema-de-coordenadas-geográficas"><i class="fa fa-check"></i><b>16.4.1</b> Sistema de Coordenadas Geográficas</a></li>
<li class="chapter" data-level="16.4.2" data-path="cap15.html"><a href="cap15.html#sistema-de-coordenadas-projetadas"><i class="fa fa-check"></i><b>16.4.2</b> Sistema de Coordenadas Projetadas</a></li>
<li class="chapter" data-level="16.4.3" data-path="cap15.html"><a href="cap15.html#datum"><i class="fa fa-check"></i><b>16.4.3</b> Datum</a></li>
<li class="chapter" data-level="16.4.4" data-path="cap15.html"><a href="cap15.html#sistema-de-referência-de-coordenadas-crs-no-r"><i class="fa fa-check"></i><b>16.4.4</b> Sistema de Referência de Coordenadas (CRS) no R</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="cap15.html"><a href="cap15.html#principais-fontes-de-dados-geoespaciais"><i class="fa fa-check"></i><b>16.5</b> Principais fontes de dados geoespaciais</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="cap15.html"><a href="cap15.html#vetor-2"><i class="fa fa-check"></i><b>16.5.1</b> Vetor</a></li>
<li class="chapter" data-level="16.5.2" data-path="cap15.html"><a href="cap15.html#raster-1"><i class="fa fa-check"></i><b>16.5.2</b> Raster</a></li>
<li class="chapter" data-level="16.5.3" data-path="cap15.html"><a href="cap15.html#pacotes-do-r"><i class="fa fa-check"></i><b>16.5.3</b> Pacotes do R</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="cap15.html"><a href="cap15.html#importar-e-exportar-dados-geoespaciais"><i class="fa fa-check"></i><b>16.6</b> Importar e exportar dados geoespaciais</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="cap15.html"><a href="cap15.html#principais-formatos-de-arquivos-geográficos"><i class="fa fa-check"></i><b>16.6.1</b> Principais formatos de arquivos geográficos</a></li>
<li class="chapter" data-level="16.6.2" data-path="cap15.html"><a href="cap15.html#importar-dados-1"><i class="fa fa-check"></i><b>16.6.2</b> Importar dados</a></li>
<li class="chapter" data-level="16.6.3" data-path="cap15.html"><a href="cap15.html#exportar-dados-1"><i class="fa fa-check"></i><b>16.6.3</b> Exportar dados</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="cap15.html"><a href="cap15.html#descrição-de-objetos-espaciais"><i class="fa fa-check"></i><b>16.7</b> Descrição de objetos espaciais</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="cap15.html"><a href="cap15.html#vetor-5"><i class="fa fa-check"></i><b>16.7.1</b> Vetor</a></li>
<li class="chapter" data-level="16.7.2" data-path="cap15.html"><a href="cap15.html#raster-4"><i class="fa fa-check"></i><b>16.7.2</b> Raster</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="cap15.html"><a href="cap15.html#reprojeção-de-dados-geoespaciais"><i class="fa fa-check"></i><b>16.8</b> Reprojeção de dados geoespaciais</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="cap15.html"><a href="cap15.html#vetor-6"><i class="fa fa-check"></i><b>16.8.1</b> Vetor</a></li>
<li class="chapter" data-level="16.8.2" data-path="cap15.html"><a href="cap15.html#raster-5"><i class="fa fa-check"></i><b>16.8.2</b> Raster</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="cap15.html"><a href="cap15.html#principais-operações-com-dados-geoespaciais"><i class="fa fa-check"></i><b>16.9</b> Principais operações com dados geoespaciais</a>
<ul>
<li class="chapter" data-level="16.9.1" data-path="cap15.html"><a href="cap15.html#operações-de-atributos"><i class="fa fa-check"></i><b>16.9.1</b> Operações de atributos</a></li>
<li class="chapter" data-level="16.9.2" data-path="cap15.html"><a href="cap15.html#operações-espaciais"><i class="fa fa-check"></i><b>16.9.2</b> Operações espaciais</a></li>
<li class="chapter" data-level="16.9.3" data-path="cap15.html"><a href="cap15.html#operações-geométricas"><i class="fa fa-check"></i><b>16.9.3</b> Operações geométricas</a></li>
</ul></li>
<li class="chapter" data-level="16.10" data-path="cap15.html"><a href="cap15.html#visualização-de-dados-geoespaciais"><i class="fa fa-check"></i><b>16.10</b> Visualização de dados geoespaciais</a>
<ul>
<li class="chapter" data-level="16.10.1" data-path="cap15.html"><a href="cap15.html#principais-elementos-de-um-mapa"><i class="fa fa-check"></i><b>16.10.1</b> Principais elementos de um mapa</a></li>
<li class="chapter" data-level="16.10.2" data-path="cap15.html"><a href="cap15.html#principais-pacotes-para-a-composição-de-mapas"><i class="fa fa-check"></i><b>16.10.2</b> Principais pacotes para a composição de mapas</a></li>
<li class="chapter" data-level="16.10.3" data-path="cap15.html"><a href="cap15.html#mapas-estáticos"><i class="fa fa-check"></i><b>16.10.3</b> Mapas estáticos</a></li>
<li class="chapter" data-level="16.10.4" data-path="cap15.html"><a href="cap15.html#mapas-animados"><i class="fa fa-check"></i><b>16.10.4</b> Mapas animados</a></li>
<li class="chapter" data-level="16.10.5" data-path="cap15.html"><a href="cap15.html#mapas-interativos"><i class="fa fa-check"></i><b>16.10.5</b> Mapas interativos</a></li>
</ul></li>
<li class="chapter" data-level="16.11" data-path="cap15.html"><a href="cap15.html#exemplos-de-aplicações-de-análises-geoespaciais-para-dados-ecológicos"><i class="fa fa-check"></i><b>16.11</b> Exemplos de aplicações de análises geoespaciais para dados ecológicos</a>
<ul>
<li class="chapter" data-level="16.11.1" data-path="cap15.html"><a href="cap15.html#resumir-informações-de-biodiversidade-para-unidades-espaciais"><i class="fa fa-check"></i><b>16.11.1</b> Resumir informações de biodiversidade para unidades espaciais</a></li>
<li class="chapter" data-level="16.11.2" data-path="cap15.html"><a href="cap15.html#extrair-dados-raster-para-pontos"><i class="fa fa-check"></i><b>16.11.2</b> Extrair dados raster para pontos</a></li>
<li class="chapter" data-level="16.11.3" data-path="cap15.html"><a href="cap15.html#resumir-dados-de-rasters-para-buffers"><i class="fa fa-check"></i><b>16.11.3</b> Resumir dados de rasters para buffers</a></li>
<li class="chapter" data-level="16.11.4" data-path="cap15.html"><a href="cap15.html#predições-espaciais-de-objetos-raster"><i class="fa fa-check"></i><b>16.11.4</b> Predições espaciais de objetos raster</a></li>
</ul></li>
<li class="chapter" data-level="16.12" data-path="cap15.html"><a href="cap15.html#para-se-aprofundar-9"><i class="fa fa-check"></i><b>16.12</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referências-1.html"><a href="referências-1.html"><i class="fa fa-check"></i>Referências</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análises Ecológicas no R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cap9" class="section level1" number="10">
<h1><span class="header-section-number">Capítulo 10</span> Análises Multidimensionais</h1>
<div id="pré-requisitos-do-capítulo-5" class="section level2 unnumbered">
<h2>Pré-requisitos do capítulo</h2>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="cap9.html#cb337-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-2"><a href="cap9.html#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Pacotes</span></span>
<span id="cb337-3"><a href="cap9.html#cb337-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ade4)</span>
<span id="cb337-4"><a href="cap9.html#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecodados)</span>
<span id="cb337-5"><a href="cap9.html#cb337-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb337-6"><a href="cap9.html#cb337-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb337-7"><a href="cap9.html#cb337-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pvclust)</span>
<span id="cb337-8"><a href="cap9.html#cb337-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BiodiversityR)</span>
<span id="cb337-9"><a href="cap9.html#cb337-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(labdsv)</span>
<span id="cb337-10"><a href="cap9.html#cb337-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb337-11"><a href="cap9.html#cb337-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb337-12"><a href="cap9.html#cb337-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb337-13"><a href="cap9.html#cb337-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb337-14"><a href="cap9.html#cb337-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb337-15"><a href="cap9.html#cb337-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FD)</span>
<span id="cb337-16"><a href="cap9.html#cb337-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb337-17"><a href="cap9.html#cb337-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb337-18"><a href="cap9.html#cb337-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ade4)</span>
<span id="cb337-19"><a href="cap9.html#cb337-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggord)</span>
<span id="cb337-20"><a href="cap9.html#cb337-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(adespatial)</span>
<span id="cb337-21"><a href="cap9.html#cb337-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb337-22"><a href="cap9.html#cb337-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-23"><a href="cap9.html#cb337-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados necessários</span></span>
<span id="cb337-24"><a href="cap9.html#cb337-24" aria-hidden="true" tabindex="-1"></a>sp_compos <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>bocaina</span>
<span id="cb337-25"><a href="cap9.html#cb337-25" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>com_birds</span>
<span id="cb337-26"><a href="cap9.html#cb337-26" aria-hidden="true" tabindex="-1"></a>env <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>env_birds</span>
<span id="cb337-27"><a href="cap9.html#cb337-27" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>birds.xy</span>
<span id="cb337-28"><a href="cap9.html#cb337-28" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mite)</span>
<span id="cb337-29"><a href="cap9.html#cb337-29" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(doubs)</span>
<span id="cb337-30"><a href="cap9.html#cb337-30" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mite.env)</span>
<span id="cb337-31"><a href="cap9.html#cb337-31" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="at">package =</span> <span class="st">&quot;palmerpenguins&quot;</span>)</span></code></pre></div>
</div>
<div id="aspectos-teóricos" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Aspectos teóricos</h2>
<p>Em geral, análises multivariadas têm três principais utilidades: reduzir a dimensionalidade dos dados e encontrar a principal direção de variação dos dados, testar relações entre matrizes, ou ainda encontrar diferenças entre grupos. Apesar dessas análises também serem utilizadas como análises exploratórias e para descrever padrões em estudos ecológicos, a necessidade de se ter hipóteses, ou ao menos expectativas a priori, não pode ser ignorada. Antes de entrar de cabeça nas análises multivariadas, também sugerimos fortemente o estudo de métodos de amostragem e como fazer boas perguntas.</p>
<p>Análises multivariadas podem ser divididas, grosseiramente, em dois tipos: agrupamento e ordenação. Análises de agrupamento em geral tentam agrupar objetos (observações) ou descritores em grupos de maneira que objetos do mesmo grupo sejam mais semelhantes entre si do que objetos de outros grupos <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. Por exemplo, os objetos podem ser localidades como “parcelas,” “riachos” ou “florestas,” enquanto os descritores são as difentes variáveis coletadas nesses objetos (e.g., espécies, variáveis ambientais). A análise de ordenação, por sua vez, é uma operação pela qual os objetos (ou descritores) são posicionados num espaço que contém menos dimensões que o conjunto de dados original; a posição dos objetos ou descritores em relação aos outros também podem ser usadas para agrupá-los.</p>
<p>Vamos começar com análises de agrupamento. Aqui vamos exemplificar dois métodos: uma técnica de agrupamento hierarquica (dendrograma) e outra não-hierarquica (k-means).</p>
<div id="coeficientes-de-associação" class="section level3" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Coeficientes de associação</h3>
<p>Assim chamados genericamente, os coeficientes de associação medem o quão parecidos objetos ou descritores são entre si. Quando analisamos a relação entre objetos fazemos uma análise no modo Q, ao passo que o modo R é quando analisamos a relação entre descritores. Coeficientes de associação do modo Q são medidas de (dis)similaridade ou distância, enquanto para o modo R utilizamos covariância ou correlação. Como já tratamos neste livro sobre covariância e correlação, neste tópico vamos falar sobre índices de distância e similaridade. Mas qual a definição destas duas quantitades?</p>
<blockquote>
<p>Similaridade são máximas (<em>S=1</em>) quando dois objetos são idênticos</p>
<p>Distâncias são o contrário da similaridade (<em>D=1-S</em>) e não têm limites superiores (dependem da unidade de medida)</p>
</blockquote>
<p>Existem ao menos 26 índices de similaridade que podem ser agrupados de acordo com o tipo de dado (qualitativos ou quantitativos), a maneira com que lidam com duplos zeros (simétricos ou assimétricos). Do seu lado, as distâncias só se aplicam a dados quantitativos e têm como características serem métricas, semi-métricas ou não-métricas. Vejamos agora os principais índices de similaridade e distância de cada tipo.</p>
</div>
<div id="métricas-de-distância" class="section level3" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Métricas de distância</h3>
<p>O principal coeficiente de distância usado em ecologia é a distância euclidiana. Além disso temos ainda Canberra, Mahalanobis (calcula a distância entre dois pontos num espaço não ortogonal, levando em consideração a covariância entre descritores), Manhattan, Chord (elimina diferenças entre abundância total de espécies), 𝜒2 (dá peso maior para espécies raras), Hellinger (não dá peso para espécies raras). Essas distâncias são recomendada nos casos em que as variáveis de estudo forem contínuas, como por exemplo <strong>variáveis morfométricas ou descritores ambientais</strong>.</p>
<p>Uma característica comum de conjuntos de dados ecológicos são os vários zeros encontrados em matrizes de composição. Eles surgem porque não encontramos nenhum indivíduo de uma determinada espécie num local, seja porque aquele local não tem as condições ambientais adequadas a ela, falha na detectabilidade, ou dinâmicas demográficas estocásticas de colonização-extinção. Logo, quando dois locais compartilham ausência de espécies, não é possível atribuir uma única razão da dupla ausência. Como essas medidas de distância apresentadas acima assumem que os dados são quantitativos e não de contagem, elas não são adequadas para lidar com dados de abundância ou incidência de espécies, porque atribuem um grau de parecênça a pares de locais que compartilham zeros <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. Por esse motivo precisamos de coeficientes que desconsiderem os duplos zeros. Eles são chamados de <em>assimétricos.</em></p>
<div id="coeficientes-assimétricos-binários-para-objetos" class="section level4" number="10.1.2.1">
<h4><span class="header-section-number">10.1.2.1</span> Coeficientes assimétricos binários para objetos</h4>
<p>Esses coeficientes (ou índices) são apropriados para dados de incidência de espécies (presença-ausência) e desconsideram as duplas ausências. Os índices deste tipo mais comuns utilizados em ecologia são Sørensen, Jaccard, e Ochiai.</p>
<p><span class="math display">\[
\beta j= a/a+b+c
\]</span></p>
<p>, onde <em>a</em> = número de espécies compartilhadas, <em>b</em> = número de espécies exclusivas da comunidade 1, <em>c</em> = número de espécies exclusivas da comunidade 2. A diferença entre Jaccard e Sørensen é o Sørensen dá peso dobrado para duplas presenças. Por conta dessas características estes índices são adequados para quantificar diversidade beta <span class="citation">(<a href="#ref-anderson2010" role="doc-biblioref">M. J. Anderson et al., 2011</a>; <a href="#ref-legendre2013" role="doc-biblioref">Legendre &amp; De Cáceres, 2013</a>)</span>. Esses índices variam entre 0 (nenhuma espécie é compartilhada entre o par de locais) a 1 (todas as espécies são compartilhadas entre o par de locais).</p>
</div>
<div id="coeficientes-binários-para-descritores-r-mode" class="section level4" number="10.1.2.2">
<h4><span class="header-section-number">10.1.2.2</span> Coeficientes binários para descritores (R mode)</h4>
<p>Se o objetivo for calcular a similaridade entre descritores binários (e.g., presença ou ausência de características ambientais) de pares de locais, geralmente o coeficiente recomendado é o de Sokal &amp; Michener. Este índice está implementado em <code>ade4::dist.binary</code>.</p>
</div>
<div id="coeficientes-quantitativos-para-objetos" class="section level4" number="10.1.2.3">
<h4><span class="header-section-number">10.1.2.3</span> Coeficientes quantitativos para objetos</h4>
<p>Estes são os coeficientes utilizados para dados de contagem (e.g., abundância), quantitativos (e.g., frequência, biomassa, porcentagem cobertura). Diferentemente das distâncias, estes coeficientes são assimétricos, ou seja, não consideram duplas ausências, e portanto são adequados para analisar dados de composição de espécies. Além disso, uma outra característica deles é serem semi-métricos. Os índices mais comuns deste tipo são Bray-Curtis (conhecido como <em>percentage difference</em> em inglês), Chord, log-Chord, Hellinger, chi-quadrado, e Morisita-Horn.</p>
<p>Todos os índices discutidos até aqui estão implementados nas funções <code>ade4::dist.ktab</code>, <code>adespatial::dist.ldc</code>, e <code>vegan::vegdist</code>.</p>
</div>
<div id="coeficientes-para-descritores-r-mode-que-incluem-mistura-de-tipos-de-dados" class="section level4" number="10.1.2.4">
<h4><span class="header-section-number">10.1.2.4</span> Coeficientes para descritores (R mode) que incluem mistura de tipos de dados</h4>
<p>É comum em análises de diversidade funcional que tenhamos um conjunto de atributos (traits) de espécies que são formados por vários tipos de dados: quantitativos (e.g., tamanho de corpo), binários (presença ausência de uma dada característica), fuzzy (um atributo multiestado descrito codificado em várias colunas com porcentagem), ordinais, e circulares (e.g., distribuição de uma fenofase ao longo de um ano). O índice que lida com todos esses dados é o Gower. A versão extendida do índice de Gower pode ser encontrada na função <code>ade4::dist.ktab.</code></p>
<p>O capítulo 7 de <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span> fornece uma chave dicotômica para escolha do índice mais adequado.</p>
</div>
<div id="padronizações-e-transformações" class="section level4" number="10.1.2.5">
<h4><span class="header-section-number">10.1.2.5</span> Padronizações e transformações</h4>
<p>É comum coletarmos múltiplas variáveis ambientais cujas unidades sejam diferentes. Por exemplo, temperatura (ºC), distância da margem (m), área (m<sup>2</sup>). Para diminuir a taxa de Erro Tipo I das análises é recomendado que <strong><em>padronizemos</em></strong> os dados utilizando distribuição <em>Z</em>, assim todas as variáveis passam a ter média 0 e desvio padrão 1. Essa padronização pode ser implementada na função <code>vegan::decostand</code>.</p>
<p>Um outro problema comum de matrizes de dados de composição de espécies é o alto número de zeros, enquanto outras espécies podem ter altas abundâncias. Isso gera problemas em ordenações. Para diminuir esta discrepância podemos <strong><em>transformar</em></strong> os dados, por exemplo, utilizando a distância de Hellinger ou Chord. Isso pode ser feito na função <code>vegan::decostand</code>.</p>
</div>
</div>
</div>
<div id="análise-de-agrupamento-hierárquico" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Análise de agrupamento hierárquico</h2>
<p>O objetivo da análise de agrupamento é agrupar objetos admitindo que haja um grau de similaridade entre eles. Esta análise pode ser utilizada ainda para classificar uma população em grupos homogêneos de acordo com uma característica de interesse. A grosso modo, uma análise de agrupamento tenta resumir uma grande quantidade de dados e apresentá-la de maneira fácil de visualizar e entender (em geral, na forma de um dendrograma). No entanto, os resultados da análise podem não refletir necessariamente toda a informação originalmente contida na matriz de dados. Para avaliar o quão bem uma análise de agrupamento representa os dados originais existe uma métrica — o coeficiente de correlação cofenético — o qual discutiremos em detalhes mais adiante.</p>
<p>Antes de considerar algum método de agrupamento, pense porque você esperaria que houvesse uma descontinuidade nos dados; ou ainda, considere se existe algum ganho prático em dividir uma nuvem de objetos contínuos em grupos. O padrão apresentado pelo dendograma depende do protocolo utilizado (método de agrupamento e índice de dissimilaridade); os grupos formados dependem do nível de corte escolhido.</p>
<p>A matriz deve conter os objetos a serem agrupados (e.g., espécies) nas linhas e as variáveis (e.g., locais de coleta ou medidas morfológicas) nas colunas. A escolha do método de agrupamento é crítico para a escolha de um coeficiente de associação. É importante compreender as propriedades dos métodos de agrupamento para interpretar corretamente a estrutura ecológica que eles evidenciam <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. De acordo com a classificação de Sneath &amp; Sokal <span class="citation">(<a href="#ref-sneath_numerical_1973" role="doc-biblioref">1973</a>)</span> existem cinco tipos de métodos: 1) seqüenciais ou simultâneos; 2) aglomerativo ou divisivo; 3) monotéticos ou politéticos; 4) hierárquico ou não hierárquicos e 5) probabilístico. Sugerimos a leitura do artigo citado para aprofundar seus conhecimentos sobre os diferentes métodos.</p>
<p>Métodos hierárquicos podem ser divididos naqueles que consideram o centróide ou a média aritmética entre os grupos. O principal método hierárquico que utiliza a média aritmética é o UPGMA (Agrupamento pelas médias aritméticas não ponderadas), e o principal método que utiliza centróides é a Distância mínima de Ward.</p>
<p>O UPGMA funciona da seguinte forma: a maior similaridade (ou menor distância) identifica os próximos agrupamentos a serem formados. Após esse evento, o método calcula a média aritmética das similaridades ou distâncias entre um objeto e cada um dos membros do grupo ou, no caso de um grupo previamente formado, entre todos os membros dos dois grupos. Todos os objetos recebem pesos iguais no cálculo.</p>
<p>O método de Ward é baseado no critério de quadrados mínimos (OLS), o mesmo utilizado para ajustar um modelo linear. O objetivo é definir os grupos de maneira que a soma de quadrados (i.e. similar ao erro quadrado da ANOVA) dentro dos grupos seja minimizada <span class="citation">(<a href="#ref-borcard2018" role="doc-biblioref">Borcard et al., 2018</a>)</span>.</p>
<p>No entanto, para interpretar os resultados precisamos antes definir um nível de corte, que vai nos dizer quantos grupos existem. Há vários métodos para definir grupos, desde os heurísticos aos que utilizam bootstrap. Se quisermos interpretar este dendrograma, podemos por exemplo estabelecer um nível de corte de 50% de distância (ou seja, grupos cujos objetos tenham ao menos 50% de similaridade entre si).</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Verifique se não há espaço nos nomes das colunas e linhas</p></li>
<li><pre><code>Se os dados forem de abundância, recomenda-se realizar a transformação de Hellinger [@legendre2001]. Esta transformação é necessária porque a matriz de comunidades (em especial, com a presença de muitas espécies raras) pode causar distorções nos métodos de ordenação baseados em distância Euclidiana [@legendre2001].    </code></pre></li>
<li><p>Se a matriz original contiver muitos valores discrepantes (e.g., uma espécie muito mais ou muito menos abundante que outras) é necessário transformar os dados usando <code>log1p</code>.</p></li>
<li><p>Se as variáveis forem medidas tomadas em diferentes escalas (metros, graus celcius etc), é necessário padronizar cada variável para ter a média 0 e desvio padrão 1. Isso pode ser feito utulizando a função <code>decostand</code> do pacote <code>vegan</code>.</p></li>
</ul>
<div id="exemplo-1-1" class="section level4" number="10.2.0.1">
<h4><span class="header-section-number">10.2.0.1</span> Exemplo 1</h4>
<p>Neste exemplo vamos utilizar um conjunto de dados que contém larvas de espécies de anfíbios anuros coletados em 14 poças com diferentes coberturas de dossel.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existem grupos de espécies de anfíbios anuros com padrões de ocorrência similar ao longo das poças?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Iremos encontrar ao menos dois grupos de espécies: aquelas que ocorrem em poças dentro de floresta (i.e., maior cobertura de dossel) vs. aquelas que ocorrem em poças de áreas abertas (menor cobertura de dossel).</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis preditoras: a matriz de dados contém a abundância das espécies nas linhas e locais (poças) nas colunas.</li>
</ul>
</div>
<div id="análise-no-r" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Análise no R</h3>
<p>Para começar, vamos primeiro importar os dados e depois calcular a matriz de distância que seja adequada para o tipo de dado que temos (abundância de espécies - dados de contagem)</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="cap9.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Composição de espécies (seis primeiras localidades)</span></span>
<span id="cb339-2"><a href="cap9.html#cb339-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sp_compos)</span>
<span id="cb339-3"><a href="cap9.html#cb339-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         BP4  PP4 PP3  AP1 AP2 PP1 PP2 BP9  PT1 PT2 PT3 BP2 PT5</span></span>
<span id="cb339-4"><a href="cap9.html#cb339-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Aper      0    3   0    0   2   0   0   0    0   0   0 181   0</span></span>
<span id="cb339-5"><a href="cap9.html#cb339-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bahe    859   14  14    0  87 312 624 641    0   0   0  14   0</span></span>
<span id="cb339-6"><a href="cap9.html#cb339-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rict   1772 1517 207  573 796   0   0   0    0   0   0   0   0</span></span>
<span id="cb339-7"><a href="cap9.html#cb339-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cleuco    0    0   0    0   0   0   0   0    0  29 369   0  84</span></span>
<span id="cb339-8"><a href="cap9.html#cb339-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dmic      0    0   6   60   4   0   0   0 2758 319  25   0 329</span></span>
<span id="cb339-9"><a href="cap9.html#cb339-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dmin      0   84 344 1045  90   0   0   0    8   0   0   0   0</span></span>
<span id="cb339-10"><a href="cap9.html#cb339-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-11"><a href="cap9.html#cb339-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Matriz de similaridade com o coeficiente de Morisita-Horn</span></span>
<span id="cb339-12"><a href="cap9.html#cb339-12" aria-hidden="true" tabindex="-1"></a>distBocaina <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(sp_compos, <span class="at">method =</span> <span class="st">&quot;horn&quot;</span>)</span>
<span id="cb339-13"><a href="cap9.html#cb339-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-14"><a href="cap9.html#cb339-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrupamento com a função hclust e o método UPGMA</span></span>
<span id="cb339-15"><a href="cap9.html#cb339-15" aria-hidden="true" tabindex="-1"></a>dendro <span class="ot">&lt;-</span> <span class="fu">hclust</span>(distBocaina, <span class="at">method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb339-16"><a href="cap9.html#cb339-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-17"><a href="cap9.html#cb339-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar os resultados</span></span>
<span id="cb339-18"><a href="cap9.html#cb339-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dendro)</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-351-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="assessando-a-qualidade-do-dendrograma" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Assessando a qualidade do dendrograma</h3>
<p>Precisamos verificar que o agrupamento reduziu a dimensionalidade da matiz de forma eficiente, de maneira a não distorcer a informação. Fazemos isso calculando o <strong>Coeficiente de correlação cofenética (CCC)</strong></p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="cap9.html#cb340-1" aria-hidden="true" tabindex="-1"></a>cofresult <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(dendro)</span>
<span id="cb340-2"><a href="cap9.html#cb340-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(cofresult, distBocaina)</span>
<span id="cb340-3"><a href="cap9.html#cb340-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9455221</span></span></code></pre></div>
<p>Um CCC &gt; .7 indica uma boa representação. Portanto, o nosso resultado de 0.9455221 é alto, garantindo que o dendrograma é adequado.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="cap9.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dendro)</span>
<span id="cb341-2"><a href="cap9.html#cb341-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb341-3"><a href="cap9.html#cb341-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(sp_compos)</span>
<span id="cb341-4"><a href="cap9.html#cb341-4" aria-hidden="true" tabindex="-1"></a>MidPoint <span class="ot">&lt;-</span> (dendro<span class="sc">$</span>height[n <span class="sc">-</span> k] <span class="sc">+</span> dendro<span class="sc">$</span>height[n <span class="sc">-</span> k <span class="sc">+</span> <span class="dv">1</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb341-5"><a href="cap9.html#cb341-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> MidPoint, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-353-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>Nesse caso teremos a formação de cinco grupos, representados pelos nós que estão abaixo da linha de corte. Portanto, o resultado não suporta a nossa hipótese <em>a priori</em> que predizia a formação de apenas dois grupos de espécies.</p>
<div id="exemplo-2" class="section level4" number="10.2.2.1">
<h4><span class="header-section-number">10.2.2.1</span> Exemplo 2</h4>
<p>No exemplo anterior vimos que é difícil interpretar os grupos baseado num nível de corte. A seguir, vamos utilizar o pacote <code>pvclust</code> que calcula automaticamente o nível de corte de similaridade baseado no Bootstrap de cada nó. Uma desvantagem deste método é que ele somente aceita índices de similaridade da função <code>dist</code> que possui apenas a distância Euclidiana, Manhattan e Canberra. Uma maneira de contornarmos essa limitação é utilizar transformações dos dados disponíveis na função <code>disttransform</code> no pacote <code>BiodiversityR</code> ou o <code>decostand</code> do pacote <code>vegan</code>. Também é possível utilizar a transformação de Box-Cox para dados multivariados, disponível no [material suplementar] (<a href="http://www.ecography.org/appendix/ecog-03498" class="uri">http://www.ecography.org/appendix/ecog-03498</a>) de <span class="citation">(<a href="#ref-legendre2018" role="doc-biblioref">Legendre &amp; Borcard, 2018</a>)</span>. Esta transformação é geralmente utilizada para tornar a distribuição dos dados mais simétrica (menos enviesada para valores extremos: reduzir o <em>skewness</em> dos dados).</p>
</div>
</div>
<div id="análise-no-r-1" class="section level3" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Análise no R</h3>
<p>Vamos utilizar o mesmo conjunto de dados acima pra responder à mesma pergunta. Aqui vamos utilizar a distância de Chord (que é indicada para dados de composição de espécies) para calcular a matriz de distância. Se transformarmos uma matriz usando a transformação Chord e depois calcularmos a distância Euclidiana, isso equivale à calcular diretamente a distância de Chord:</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="cap9.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dados</span></span>
<span id="cb342-2"><a href="cap9.html#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sp_compos)</span>
<span id="cb342-3"><a href="cap9.html#cb342-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         BP4  PP4 PP3  AP1 AP2 PP1 PP2 BP9  PT1 PT2 PT3 BP2 PT5</span></span>
<span id="cb342-4"><a href="cap9.html#cb342-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Aper      0    3   0    0   2   0   0   0    0   0   0 181   0</span></span>
<span id="cb342-5"><a href="cap9.html#cb342-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bahe    859   14  14    0  87 312 624 641    0   0   0  14   0</span></span>
<span id="cb342-6"><a href="cap9.html#cb342-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rict   1772 1517 207  573 796   0   0   0    0   0   0   0   0</span></span>
<span id="cb342-7"><a href="cap9.html#cb342-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cleuco    0    0   0    0   0   0   0   0    0  29 369   0  84</span></span>
<span id="cb342-8"><a href="cap9.html#cb342-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dmic      0    0   6   60   4   0   0   0 2758 319  25   0 329</span></span>
<span id="cb342-9"><a href="cap9.html#cb342-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dmin      0   84 344 1045  90   0   0   0    8   0   0   0   0</span></span>
<span id="cb342-10"><a href="cap9.html#cb342-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-11"><a href="cap9.html#cb342-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 1: transformar para distância de Chord</span></span>
<span id="cb342-12"><a href="cap9.html#cb342-12" aria-hidden="true" tabindex="-1"></a>bocaina_transf <span class="ot">&lt;-</span> <span class="fu">disttransform</span>(sp_compos, <span class="st">&quot;chord&quot;</span>)</span>
<span id="cb342-13"><a href="cap9.html#cb342-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-14"><a href="cap9.html#cb342-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 2: realizar pvclust com método average e distância euclidiana</span></span>
<span id="cb342-15"><a href="cap9.html#cb342-15" aria-hidden="true" tabindex="-1"></a>analise <span class="ot">&lt;-</span> <span class="fu">pvclust</span>(bocaina_transf, <span class="at">method.hclust =</span> <span class="st">&quot;average&quot;</span>, <span class="at">method.dist =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb342-16"><a href="cap9.html#cb342-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.5)... Done.</span></span>
<span id="cb342-17"><a href="cap9.html#cb342-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.56)... Done.</span></span>
<span id="cb342-18"><a href="cap9.html#cb342-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.69)... Done.</span></span>
<span id="cb342-19"><a href="cap9.html#cb342-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.75)... Done.</span></span>
<span id="cb342-20"><a href="cap9.html#cb342-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.88)... Done.</span></span>
<span id="cb342-21"><a href="cap9.html#cb342-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.0)... Done.</span></span>
<span id="cb342-22"><a href="cap9.html#cb342-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.06)... Done.</span></span>
<span id="cb342-23"><a href="cap9.html#cb342-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.19)... Done.</span></span>
<span id="cb342-24"><a href="cap9.html#cb342-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.25)... Done.</span></span>
<span id="cb342-25"><a href="cap9.html#cb342-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.38)... Done.</span></span>
<span id="cb342-26"><a href="cap9.html#cb342-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-27"><a href="cap9.html#cb342-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 3: dendrograma</span></span>
<span id="cb342-28"><a href="cap9.html#cb342-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(analise, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb342-29"><a href="cap9.html#cb342-29" aria-hidden="true" tabindex="-1"></a><span class="fu">pvrect</span>(analise)</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-354-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>É possível notar que existe um único grupo com BS &gt; 95%. Agora vamos tentar usar a distância de Hellinger, que é recomendada (junto com a distância de Chord) para transformar dados de composição de espécies e, desse modo, reduzem distorções nas ordenações como PCA e CA <span class="citation">(<a href="#ref-legendre2001" role="doc-biblioref">Legendre &amp; Gallagher, 2001</a>)</span>.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="cap9.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 1: transformar dados com Hellinger</span></span>
<span id="cb343-2"><a href="cap9.html#cb343-2" aria-hidden="true" tabindex="-1"></a>bocaina_transf2 <span class="ot">&lt;-</span> <span class="fu">disttransform</span>(bocaina, <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb343-3"><a href="cap9.html#cb343-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-4"><a href="cap9.html#cb343-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 2: realizar pvclust com método average e distância euclidiana</span></span>
<span id="cb343-5"><a href="cap9.html#cb343-5" aria-hidden="true" tabindex="-1"></a>analise2 <span class="ot">&lt;-</span> <span class="fu">pvclust</span>(bocaina_transf2, <span class="at">method.hclust =</span> <span class="st">&quot;average&quot;</span>, <span class="at">method.dist =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb343-6"><a href="cap9.html#cb343-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.5)... Done.</span></span>
<span id="cb343-7"><a href="cap9.html#cb343-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.56)... Done.</span></span>
<span id="cb343-8"><a href="cap9.html#cb343-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.69)... Done.</span></span>
<span id="cb343-9"><a href="cap9.html#cb343-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.75)... Done.</span></span>
<span id="cb343-10"><a href="cap9.html#cb343-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.88)... Done.</span></span>
<span id="cb343-11"><a href="cap9.html#cb343-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.0)... Done.</span></span>
<span id="cb343-12"><a href="cap9.html#cb343-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.06)... Done.</span></span>
<span id="cb343-13"><a href="cap9.html#cb343-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.19)... Done.</span></span>
<span id="cb343-14"><a href="cap9.html#cb343-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.25)... Done.</span></span>
<span id="cb343-15"><a href="cap9.html#cb343-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.38)... Done.</span></span>
<span id="cb343-16"><a href="cap9.html#cb343-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-17"><a href="cap9.html#cb343-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 3: dendrograma</span></span>
<span id="cb343-18"><a href="cap9.html#cb343-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(analise2, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb343-19"><a href="cap9.html#cb343-19" aria-hidden="true" tabindex="-1"></a><span class="fu">pvrect</span>(analise2)</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-355-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<div id="interpretação-dos-resultados-5" class="section level4" number="10.2.3.1">
<h4><span class="header-section-number">10.2.3.1</span> Interpretação dos resultados</h4>
<p>Notem que se mudarmos o coeficiente de associação, o resultado também muda. Agora temos 1 grupo a mais, composto por <em>Dendropsophus minutus</em> e <em>Scinax duartei</em> que não apareciam antes. Isso se deve ao fato de que a distância de Hellinger dá menos peso para espécies raras do que a Chord.</p>
<p>Neste sentido, os dados não suportam a nossa hipótese inicial da formação de dois grupos, independentemente do coeficiente de associação utilizado.</p>
</div>
</div>
</div>
<div id="k-means-e-agrupamentos-não-hierárquicos" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> K-means e agrupamentos não-hierárquicos</h2>
<p>Ao contrário do dendrograma, o K-means é um agrupamento não-hierárquico e, desse modo, não é otimizado para busca grupos menores aninhados em grupos grupos maiores. Resumidamente, podemos calcular o K-means apartir de uma matriz quadrada ou de distância. Essa técnica procura particionar os objetos em <em>k</em> grupos de maneira a minimizar a soma de quadrados entre grupos e maximizá-la dentro dos grupos. Um critério similar ao de uma ANOVA <a href="cap7.html#cap7">8</a>. Um diferencial do K-means em relação aos agrupamentos hierárquicos é que o usuário pode escolher antecipadamente o número de grupos que deseja formar.</p>
<div id="exemplo-1-2" class="section level4" number="10.3.0.1">
<h4><span class="header-section-number">10.3.0.1</span> Exemplo 1</h4>
<p>Para este exemplo iremos utilizar um conjunto de dados disponível no pacote <code>ade4</code> que contém dados de 27 espécies de peixes coletados em 30 pontos ao longo do Rio Doubs, na fronteira entre a França e Suiça.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Qual é o número de grupos que melhor sumariza o padrão de ocorrência de espécies de peixes ao longo de um riacho?</li>
</ul>
<div class="alert alert-info">
<p><strong> 📝 Importante: </strong> Neste caso, estamos realizando uma análise exploratória e não temos uma predição.</p>
</div>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis resposta: composição de espécies de peixes</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Vamos normalizar os dados de abundância antes de entrar na análise propriamente, já que existem muitos zeros na matriz.</li>
</ul>
</div>
<div id="análise-4" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Análise</h3>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="cap9.html#cb344-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-2"><a href="cap9.html#cb344-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mostrar somente seis primeiras espécies de seis localidades</span></span>
<span id="cb344-3"><a href="cap9.html#cb344-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(doubs<span class="sc">$</span>fish)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb344-4"><a href="cap9.html#cb344-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Cogo Satr Phph Neba Thth Teso</span></span>
<span id="cb344-5"><a href="cap9.html#cb344-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    0    3    0    0    0    0</span></span>
<span id="cb344-6"><a href="cap9.html#cb344-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    0    5    4    3    0    0</span></span>
<span id="cb344-7"><a href="cap9.html#cb344-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    0    5    5    5    0    0</span></span>
<span id="cb344-8"><a href="cap9.html#cb344-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    0    4    5    5    0    0</span></span>
<span id="cb344-9"><a href="cap9.html#cb344-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    0    2    3    2    0    0</span></span>
<span id="cb344-10"><a href="cap9.html#cb344-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    0    3    4    5    0    0</span></span>
<span id="cb344-11"><a href="cap9.html#cb344-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-12"><a href="cap9.html#cb344-12" aria-hidden="true" tabindex="-1"></a><span class="co"># retirar a linha 8 (rio sem nenhuma ocorrência de peixe)</span></span>
<span id="cb344-13"><a href="cap9.html#cb344-13" aria-hidden="true" tabindex="-1"></a>spe <span class="ot">&lt;-</span> doubs<span class="sc">$</span>fish[<span class="sc">-</span><span class="dv">8</span>, ]</span>
<span id="cb344-14"><a href="cap9.html#cb344-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-15"><a href="cap9.html#cb344-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Função do pacote vegan para normalizar os dados</span></span>
<span id="cb344-16"><a href="cap9.html#cb344-16" aria-hidden="true" tabindex="-1"></a>spe.norm <span class="ot">&lt;-</span> <span class="fu">decostand</span>(spe, <span class="st">&quot;normalize&quot;</span>)</span></code></pre></div>
<p>O argumento <code>centers</code> na função abaixo indica o número de grupos que se quer formar. Neste exemplo estamos utilizando <code>centers = 4</code>.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="cap9.html#cb345-1" aria-hidden="true" tabindex="-1"></a>spe.kmeans <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(spe.norm, <span class="at">centers =</span> <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">100</span>)</span>
<span id="cb345-2"><a href="cap9.html#cb345-2" aria-hidden="true" tabindex="-1"></a>spe.kmeans</span>
<span id="cb345-3"><a href="cap9.html#cb345-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; K-means clustering with 4 clusters of sizes 3, 12, 6, 8</span></span>
<span id="cb345-4"><a href="cap9.html#cb345-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb345-5"><a href="cap9.html#cb345-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cluster means:</span></span>
<span id="cb345-6"><a href="cap9.html#cb345-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Cogo        Satr       Phph       Neba        Thth        Teso       Chna       Chto       Lele      Lece</span></span>
<span id="cb345-7"><a href="cap9.html#cb345-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.00000000 0.000000000 0.00000000 0.00000000 0.000000000 0.000000000 0.05205792 0.00000000 0.07647191 0.3166705</span></span>
<span id="cb345-8"><a href="cap9.html#cb345-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.10380209 0.542300691 0.50086515 0.43325916 0.114024105 0.075651573 0.00000000 0.00000000 0.06983991 0.1237394</span></span>
<span id="cb345-9"><a href="cap9.html#cb345-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.06167791 0.122088022 0.26993915 0.35942538 0.032664966 0.135403325 0.06212775 0.21568957 0.25887226 0.2722562</span></span>
<span id="cb345-10"><a href="cap9.html#cb345-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.00000000 0.006691097 0.02506109 0.06987391 0.006691097 0.006691097 0.10687104 0.09377516 0.14194394 0.2011411</span></span>
<span id="cb345-11"><a href="cap9.html#cb345-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Baba      Spbi       Gogo       Eslu       Pefl      Rham       Legi       Scer       Cyca       Titi</span></span>
<span id="cb345-12"><a href="cap9.html#cb345-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.00000000 0.0000000 0.20500174 0.07647191 0.00000000 0.0000000 0.05205792 0.07647191 0.00000000 0.00000000</span></span>
<span id="cb345-13"><a href="cap9.html#cb345-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.02385019 0.0000000 0.05670453 0.04722294 0.02949244 0.0000000 0.00000000 0.00000000 0.00000000 0.03833408</span></span>
<span id="cb345-14"><a href="cap9.html#cb345-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.15647062 0.1574388 0.16822286 0.12276089 0.17261621 0.0793181 0.06190283 0.04516042 0.06190283 0.14539027</span></span>
<span id="cb345-15"><a href="cap9.html#cb345-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.24327992 0.1326062 0.28386032 0.20630360 0.16920496 0.2214275 0.19066542 0.13171275 0.16019126 0.26230024</span></span>
<span id="cb345-16"><a href="cap9.html#cb345-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Abbr      Icme       Acce       Ruru       Blbj      Alal       Anan</span></span>
<span id="cb345-17"><a href="cap9.html#cb345-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.00000000 0.0000000 0.18058775 0.31667052 0.05205792 0.7618709 0.00000000</span></span>
<span id="cb345-18"><a href="cap9.html#cb345-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.00000000 0.0000000 0.00000000 0.01049901 0.00000000 0.0000000 0.00000000</span></span>
<span id="cb345-19"><a href="cap9.html#cb345-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.01473139 0.0000000 0.03192175 0.32201597 0.01473139 0.1095241 0.04739636</span></span>
<span id="cb345-20"><a href="cap9.html#cb345-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.19561641 0.1331835 0.26713081 0.32103755 0.22883055 0.3326939 0.18873077</span></span>
<span id="cb345-21"><a href="cap9.html#cb345-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb345-22"><a href="cap9.html#cb345-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Clustering vector:</span></span>
<span id="cb345-23"><a href="cap9.html#cb345-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  2  3  4  5  6  7  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 </span></span>
<span id="cb345-24"><a href="cap9.html#cb345-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  2  2  2  3  2  2  3  2  2  2  2  2  2  3  3  3  3  4  4  4  1  1  1  4  4  4  4  4 </span></span>
<span id="cb345-25"><a href="cap9.html#cb345-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb345-26"><a href="cap9.html#cb345-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Within cluster sum of squares by cluster:</span></span>
<span id="cb345-27"><a href="cap9.html#cb345-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3560423 2.5101386 1.7361453 0.4696535</span></span>
<span id="cb345-28"><a href="cap9.html#cb345-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  (between_SS / total_SS =  66.7 %)</span></span>
<span id="cb345-29"><a href="cap9.html#cb345-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb345-30"><a href="cap9.html#cb345-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Available components:</span></span>
<span id="cb345-31"><a href="cap9.html#cb345-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb345-32"><a href="cap9.html#cb345-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot; &quot;betweenss&quot;    &quot;size&quot;        </span></span>
<span id="cb345-33"><a href="cap9.html#cb345-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [8] &quot;iter&quot;         &quot;ifault&quot;</span></span></code></pre></div>
<p>O objeto que fornece o resultado contém: 1) o tamanho (número de objetos) em cada um dos 4 grupos; 2) o centroide de cada grupo e o pertencimento de cada espécie a cada grupo; e 3) o quanto da Soma de Quadrados dos dados é explicada por esta conformação de grupos.</p>
<p>No entanto, não é possível saber a priori qual o número “ideal” de grupos. Para descobrir isso repetimos o k-means com uma série de valores de <strong>K</strong>. Isso pode ser feito na função <code>cascadeKM</code>.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="cap9.html#cb346-1" aria-hidden="true" tabindex="-1"></a>spe.KM.cascade <span class="ot">&lt;-</span> <span class="fu">cascadeKM</span>(spe.norm, <span class="at">inf.gr =</span> <span class="dv">2</span>, <span class="at">sup.gr =</span> <span class="dv">10</span>, <span class="at">iter =</span> <span class="dv">100</span>, <span class="at">criterion =</span> <span class="st">&quot;ssi&quot;</span>)</span></code></pre></div>
<p>Tanto <strong>calinski</strong> quando <strong>ssi</strong> são bons critérios para encontrar o número ideal de grupos. Quanto maior o valor de <strong>ssi</strong>, melhor (veja <code>?cascadeKM</code> mais detalhes).</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="cap9.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumo dos resultados</span></span>
<span id="cb347-2"><a href="cap9.html#cb347-2" aria-hidden="true" tabindex="-1"></a>spe.KM.cascade<span class="sc">$</span>results</span>
<span id="cb347-3"><a href="cap9.html#cb347-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      2 groups  3 groups  4 groups  5 groups   6 groups  7 groups  8 groups   9 groups  10 groups</span></span>
<span id="cb347-4"><a href="cap9.html#cb347-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SSE 8.2149405 6.4768108 5.0719796 4.3015573 3.58561200 2.9523667 2.4840549 2.05218880 1.75992916</span></span>
<span id="cb347-5"><a href="cap9.html#cb347-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ssi 0.1312111 0.1675852 0.1398159 0.1138008 0.08295513 0.1410657 0.1461625 0.07877382 0.06817212</span></span></code></pre></div>
<p>SSE: critério utilizado pelo algorítimo para achar o agrupamento ótimo dos objetos.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="cap9.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.KM.cascade, <span class="at">sortg =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-360-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="interpretação-dos-resultados-6" class="section level3" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> Interpretação dos resultados</h3>
<p>Diferentemente da nossa predição inicial, o resultado da análise mostra que o número ideal de grupos para explicar a variância no padrão de ocorrência de espécies é 3. Notem que o SSI máximo é alcançado neste número de grupos 0.1675852 (também indicado pela bola vermelha no plot).</p>
</div>
</div>
<div id="espécies-indicadoras" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Espécies indicadoras</h2>
<p>Uma pergunta normalmente feita por ecólogos é: qual espécie pode ser indicadora de uma determinada condição ambiental (e.g., poluição)?</p>
<p>O índice IndVal mede dois aspectos das espécies: Especificidade e fidelidade. Uma alta fidelidade significa que espécies ocorrem em todos os locais do grupo e uma alta especificidade significa que as espécies ocorrem somente naquele grupo. Uma boa espécie indicadora é aquela na qual todos os indivíduos ocorrem em todas a amostras referentes a um grupo específico. A Especificidade é dada pela divisão da abundancia média da espécie no grupo pela somatória das abundancias médias dos grupos. Fidelidade é igual ao número de lugares no grupo onde a espécie está presente dividido pelo número total de lugares do grupo <span class="citation">(<a href="#ref-dufrene_species_1997" role="doc-biblioref">Dufrêne &amp; Legendre, 1997</a>)</span>.</p>
<p>Espécies raras podem receber o mesmo valor de IndVal das espécies indicadoras, porém são chamadas de indicadoras assimétricas, uma vez que contribuem com a especificidade do habitat mas não servem para predizer grupos. Ao contrário, as espécies indicadoras são verdadeiros indicadores simétricos e podem ser usadas para predizer grupos.</p>
<p>A análise procede da seguinte forma:</p>
<ol style="list-style-type: decimal">
<li><p>Uma matriz de distância é construída e as unidades amostrais são classificadas com alguma análise de agrupamento, hierárquico ou não;</p></li>
<li><p>A variável ambiental para a qual se deseja classificar os grupos é inserida;</p></li>
<li><p>As espécies indicadoreas de cada grupo são formadas através do cálculo da especificidade e fidelidade, obtendo-se o valor de IndVal para cada espécie;</p></li>
<li><p>Por fim, o conjunto de dados originais é comparado para ver se análise faz sentido.</p></li>
</ol>
<p>O cálculo da significância do índice de IndVal é feito por aleatorização de Monte Carlo. Os métodos de Monte Carlo utilizam números aleatórios de dados reais para simular certos padrões esperados na ausência de um processo ecológico específico <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. Assim, o valor do índice é aleatorizado 999 vezes (ou o número de vezes que você optar) dentro dos tratamentos e o valor de <em>P</em> é dado pelo número de vezes em que o índice observado foi igual ou maior que os valores aleatorizados.</p>
<div id="exemplo-1-3" class="section level4" number="10.4.0.1">
<h4><span class="header-section-number">10.4.0.1</span> Exemplo 1</h4>
<p>Para este exemplo vamos utilizado o mesmo conjunto de dados utilizado acima com abundância de 16 espécies de girinos coletados em 14 poças com diferentes graus de cobertura de dossel na Serra da Bocaina.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Podemos utilizar as espécies de girinos como indicadoras da fitofisionomia?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Espécies terrestres serão indicadoras de área aberta, enquanto espécies arborícolas serão indicadoras de áreas florestais.</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis resposta: mesma matriz já utilizada contendo a abundância de girinos ao longo de poças na Serra da Bocaina.</li>
</ul>
</div>
<div id="análise-no-r-2" class="section level3" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Análise no R</h3>
<p>O IndVal está disponível tanto no pacote <code>indicspecies</code> quando no <code>labdsv</code>. Para este exemplo iremos usar o <code>labdsv</code>. Primeiro vamos agrupar as unidades amostrais (poças) que informa os grupos de fitofisionomias onde as poças se localizam e para os quais deseja-se encontrar espécies indicadoras:</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="cap9.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados</span></span>
<span id="cb349-2"><a href="cap9.html#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bocaina)</span>
<span id="cb349-3"><a href="cap9.html#cb349-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         BP4  PP4 PP3  AP1 AP2 PP1 PP2 BP9  PT1 PT2 PT3 BP2 PT5</span></span>
<span id="cb349-4"><a href="cap9.html#cb349-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Aper      0    3   0    0   2   0   0   0    0   0   0 181   0</span></span>
<span id="cb349-5"><a href="cap9.html#cb349-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bahe    859   14  14    0  87 312 624 641    0   0   0  14   0</span></span>
<span id="cb349-6"><a href="cap9.html#cb349-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rict   1772 1517 207  573 796   0   0   0    0   0   0   0   0</span></span>
<span id="cb349-7"><a href="cap9.html#cb349-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cleuco    0    0   0    0   0   0   0   0    0  29 369   0  84</span></span>
<span id="cb349-8"><a href="cap9.html#cb349-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dmic      0    0   6   60   4   0   0   0 2758 319  25   0 329</span></span>
<span id="cb349-9"><a href="cap9.html#cb349-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dmin      0   84 344 1045  90   0   0   0    8   0   0   0   0</span></span>
<span id="cb349-10"><a href="cap9.html#cb349-10" aria-hidden="true" tabindex="-1"></a>fitofis <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">3</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">5</span>, <span class="dv">4</span>))</span>
<span id="cb349-11"><a href="cap9.html#cb349-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-12"><a href="cap9.html#cb349-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Análise de espécies indicadoras</span></span>
<span id="cb349-13"><a href="cap9.html#cb349-13" aria-hidden="true" tabindex="-1"></a>res_indval <span class="ot">&lt;-</span> <span class="fu">indval</span>(bocaina, fitofis)</span>
<span id="cb349-14"><a href="cap9.html#cb349-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-15"><a href="cap9.html#cb349-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A função summary só exibe o resultado para as espécies indicadoras</span></span>
<span id="cb349-16"><a href="cap9.html#cb349-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res_indval)</span>
<span id="cb349-17"><a href="cap9.html#cb349-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] cluster         indicator_value probability    </span></span>
<span id="cb349-18"><a href="cap9.html#cb349-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span id="cb349-19"><a href="cap9.html#cb349-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb349-20"><a href="cap9.html#cb349-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sum of probabilities                 =  9.324 </span></span>
<span id="cb349-21"><a href="cap9.html#cb349-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb349-22"><a href="cap9.html#cb349-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sum of Indicator Values              =  3.97 </span></span>
<span id="cb349-23"><a href="cap9.html#cb349-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb349-24"><a href="cap9.html#cb349-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sum of Significant Indicator Values  =  0 </span></span>
<span id="cb349-25"><a href="cap9.html#cb349-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb349-26"><a href="cap9.html#cb349-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Significant Indicators     =  0 </span></span>
<span id="cb349-27"><a href="cap9.html#cb349-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb349-28"><a href="cap9.html#cb349-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Significant Indicator Distribution</span></span>
<span id="cb349-29"><a href="cap9.html#cb349-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt; table of extent 0 &gt;</span></span></code></pre></div>
<p>Para apresentar uma tabela dos resultados para todas as espécies temos de processar os dados:</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="cap9.html#cb350-1" aria-hidden="true" tabindex="-1"></a>res_indval<span class="sc">$</span>maxcls  <span class="co"># classe de maior valor indicador / espécie </span></span>
<span id="cb350-2"><a href="cap9.html#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BP4 PP4 PP3 AP1 AP2 PP1 PP2 BP9 PT1 PT2 PT3 BP2 PT5 </span></span>
<span id="cb350-3"><a href="cap9.html#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1   1   2   2   2   2   1   1   4   2   1   2   2</span></span>
<span id="cb350-4"><a href="cap9.html#cb350-4" aria-hidden="true" tabindex="-1"></a>res_indval<span class="sc">$</span>indcls  <span class="co"># valor indicador (indval)</span></span>
<span id="cb350-5"><a href="cap9.html#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       BP4       PP4       PP3       AP1       AP2       PP1       PP2       BP9       PT1       PT2       PT3 </span></span>
<span id="cb350-6"><a href="cap9.html#cb350-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.4268332 0.3554217 0.3990627 0.4887564 0.5812265 0.1283151 0.2194093 0.2260226 0.3535255 0.1945122 0.2341371 </span></span>
<span id="cb350-7"><a href="cap9.html#cb350-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       BP2       PT5 </span></span>
<span id="cb350-8"><a href="cap9.html#cb350-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.1648885 0.1991525</span></span>
<span id="cb350-9"><a href="cap9.html#cb350-9" aria-hidden="true" tabindex="-1"></a>res_indval<span class="sc">$</span>pval  <span class="co"># significância do indval</span></span>
<span id="cb350-10"><a href="cap9.html#cb350-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   BP4   PP4   PP3   AP1   AP2   PP1   PP2   BP9   PT1   PT2   PT3   BP2   PT5 </span></span>
<span id="cb350-11"><a href="cap9.html#cb350-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.281 0.613 0.282 0.146 0.316 1.000 1.000 1.000 0.742 1.000 1.000 0.944 1.000</span></span>
<span id="cb350-12"><a href="cap9.html#cb350-12" aria-hidden="true" tabindex="-1"></a>tab_indval <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="at">maxcls =</span> res_indval<span class="sc">$</span>maxcls, <span class="at">ind.value =</span> res_indval<span class="sc">$</span>indcls,</span>
<span id="cb350-13"><a href="cap9.html#cb350-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">P =</span> res_indval<span class="sc">$</span>pval)</span>
<span id="cb350-14"><a href="cap9.html#cb350-14" aria-hidden="true" tabindex="-1"></a>tab_indval</span>
<span id="cb350-15"><a href="cap9.html#cb350-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     maxcls ind.value     P</span></span>
<span id="cb350-16"><a href="cap9.html#cb350-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BP4      1 0.4268332 0.281</span></span>
<span id="cb350-17"><a href="cap9.html#cb350-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP4      1 0.3554217 0.613</span></span>
<span id="cb350-18"><a href="cap9.html#cb350-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP3      2 0.3990627 0.282</span></span>
<span id="cb350-19"><a href="cap9.html#cb350-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AP1      2 0.4887564 0.146</span></span>
<span id="cb350-20"><a href="cap9.html#cb350-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AP2      2 0.5812265 0.316</span></span>
<span id="cb350-21"><a href="cap9.html#cb350-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP1      2 0.1283151 1.000</span></span>
<span id="cb350-22"><a href="cap9.html#cb350-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP2      1 0.2194093 1.000</span></span>
<span id="cb350-23"><a href="cap9.html#cb350-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BP9      1 0.2260226 1.000</span></span>
<span id="cb350-24"><a href="cap9.html#cb350-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PT1      4 0.3535255 0.742</span></span>
<span id="cb350-25"><a href="cap9.html#cb350-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PT2      2 0.1945122 1.000</span></span>
<span id="cb350-26"><a href="cap9.html#cb350-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PT3      1 0.2341371 1.000</span></span>
<span id="cb350-27"><a href="cap9.html#cb350-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BP2      2 0.1648885 0.944</span></span>
<span id="cb350-28"><a href="cap9.html#cb350-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PT5      2 0.1991525 1.000</span></span></code></pre></div>
</div>
<div id="interpretação-dos-resultados-7" class="section level3" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Interpretação dos resultados</h3>
<p>No resultado podemos ver que temos duas espécies indicadoras da fitofisionimia 1: <em>Rhinella icterica</em> (Rict) e <em>Scinax duartei</em> (Sduar). Nenhuma espécie foi indicadora dos outros grupos neste exemplo.</p>
</div>
</div>
<div id="análises-de-ordenação" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> Análises de Ordenação</h2>
<p>Os análises de ordenação representam um conjunto de métodos e técnicas multivariadas que buscam organizar objetos (e.g., localidades, indivíduos, espécies) em alguma ordem. Por exemplo, tais métodos permitem identificar se existem grupo de espécies que ocorrem exclusivamente em um determinado hábitat. Ao buscar esta <em>ordem</em> as técnicas de ordenação possuem três principais utilidades: <strong>(1)</strong> reduzir a dimensionalidade e revelar padrões, <strong>(2)</strong> separar variáveis mais e menos importantes em combinações complexas, e <strong>(3)</strong> separar relações mais e menos fortes ao comparar variáveis preditoras e dependentes. Em geral, os métodos são dividídos em ordenações irrestritas (ou análise de gradiente indireto) e restritas (ou análise de gradiente direto). As ordenações irrestritas organizam os objetos (e.g., espécies) de acordo com sua estrutura de covariância (ou correlação), o que demonstra que a proximidade (ou distância) dentro do espaço multidimensional representa semelhança (ou diferença) dos objetos. Por outro lado, as ordenações restritras posiciona os objetos (e.g., espécies) de acordo com sua relação linear com outras variáveis coletadas nas mesmas unidades amostraits (e.g., temperatura e precipitação). Ao passo que as ordenações irrestritas dependem somente de uma matriz (e.g., espécies por localidades), as ordenações restritas utilizam no mínimo duas matrizes (e.g., espécies por localidades e variáveis climáticas por localidade). Desse modo, fica claro por esta diferença entre os dados utilizados que as análises irrestritas são mais exploratórias, enquanto análises restritas são ideias para testar hipóteses com dados multidimensionais. A tabela a seguir apresenta as principais análises utilizadas em ecologia.</p>
<table>
<colgroup>
<col width="16%" />
<col width="71%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th>Método</th>
<th>Tipo de variável</th>
<th>Função R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Ordenação irrestrita</strong></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>PCA</td>
<td>Variáveis contínuas (distância euclidiana)</td>
<td>PCA, rda, dudi.pca</td>
</tr>
<tr class="odd">
<td>PCoA</td>
<td>Aceita qualquer tipo de variável, mas depende da escolha apropriada de uma medida de distância</td>
<td>pcoa, dudi.pco</td>
</tr>
<tr class="even">
<td>nMDS</td>
<td>Aceita qualquer tipo de variável, mas depende da escolha apropriada de uma medida de distância</td>
<td>metaMDS, nmds</td>
</tr>
<tr class="odd">
<td>CA</td>
<td></td>
<td>dudi.coa</td>
</tr>
<tr class="even">
<td>Hill-Smith</td>
<td>Aceita qualquer tipo de variável</td>
<td>dudi.hillsmith</td>
</tr>
<tr class="odd">
<td><strong>Ordenação restrita</strong></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>RDA</td>
<td>Variáveis preditoras de qualquer tipo e variáveis dependentes contínuas (ou presença e ausência)</td>
<td>rda</td>
</tr>
<tr class="odd">
<td>RDA parcial</td>
<td>Variáveis preditoras de qualquer tipo e variáveis dependentes contínuas (ou presença e ausência)</td>
<td>rda</td>
</tr>
<tr class="even">
<td>dbRDA</td>
<td>Variáveis preditoras de qualquer tipo e matriz de distância obtida a partir das variáveis dependentes</td>
<td>capscale, dbrda</td>
</tr>
<tr class="odd">
<td>CCA</td>
<td>Variáveis preditoras de qualquer tipo e variáveis dependentes contínuas (ou presença e ausência)</td>
<td>rda</td>
</tr>
<tr class="even">
<td>PERMANOVA</td>
<td>Variáveis preditoras de qualquer tipo e matriz de distância obtida a partir das variáveis dependentes</td>
<td>adonis, adonis2</td>
</tr>
<tr class="odd">
<td>PCR</td>
<td>Variável dependente necessariamente representada por escores da PCA ou PCoA e variáveis preditoras de qualquer tipo</td>
<td>pca, pcoa, lm, glm</td>
</tr>
</tbody>
</table>
<div id="ordenações-irrestritas" class="section level3" number="10.5.1">
<h3><span class="header-section-number">10.5.1</span> Ordenações irrestritas</h3>
<div id="análise-de-componentes-principais---pca" class="section level4" number="10.5.1.1">
<h4><span class="header-section-number">10.5.1.1</span> Análise de Componentes Principais - PCA</h4>
<p>A PCA é uma das ordenações mais utilizadas em diversas áreas do conhecimento. Em ecologia, ela se popularizou por facilitar a visualização de dados complexos como de distribuição de espécies em diferentes localidades e de potenciais variáveis explicativas. Ao mesmo tempo que ganhou tamanha popularidade, a PCA tem sido empregada de maneira incorreta, uma vez que muitos estudos utilizam a visualização gráfica da ordenação (o biplot) para intepretar “relações” entre variáveis preditoras (ambientais) e dependentes (espécies). Porém, como informado anteriormente, as ordenações irrestritas utilizam a estrutura de covariância dos objetos para organizar suas relações de similaridade.</p>
<p>Antes de explicar a análise, imagine que vamos usar uma matriz com cinco espécies de aranhas que foram encontradas em oito cidades diferentes. A quantidade de indivíduos de cada espécie coletada em cada cidade será o valor de preenchimento desta matriz. Sendo assim, a matriz possui oito objetos (cidades, representando unidades amostrais) e cinco descritores (espécies), como na tabela abaixo:</p>
<table>
<thead>
<tr class="header">
<th>Cidade</th>
<th>sp1</th>
<th>sp2</th>
<th>sp3</th>
<th>sp4</th>
<th>sp5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cidade 1</td>
<td>5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>Cidade 2</td>
<td>7</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Cidade 3</td>
<td>2</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>Cidade 4</td>
<td>0</td>
<td>4</td>
<td>9</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Cidade 5</td>
<td>0</td>
<td>0</td>
<td>12</td>
<td>4</td>
<td>0</td>
</tr>
<tr class="even">
<td>Cidade 6</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>10</td>
<td>6</td>
</tr>
<tr class="odd">
<td>Cidade 7</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>8</td>
<td>9</td>
</tr>
<tr class="even">
<td>Cidade 8</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>12</td>
</tr>
</tbody>
</table>
<p>O primeiro passo da PCA é obter uma matriz centralizada onde cada valor é subtraído da média da coluna que aquele valor pertence. Esta centralização pode ser calculada com a função scale.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="cap9.html#cb351-1" aria-hidden="true" tabindex="-1"></a>aranhas <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sp1 =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sp2 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb351-2"><a href="cap9.html#cb351-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sp3 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sp4 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">0</span>), <span class="at">sp5 =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb351-3"><a href="cap9.html#cb351-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>), <span class="at">row.names =</span> <span class="fu">paste</span>(<span class="st">&quot;cidade&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb351-4"><a href="cap9.html#cb351-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-5"><a href="cap9.html#cb351-5" aria-hidden="true" tabindex="-1"></a>aranha.cent <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(base<span class="sc">::</span><span class="fu">scale</span>(aranhas, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<p>O segundo passo é calcular uma matriz de covariância (ou matriz de dispersão) e, a partir desta matriz, obter os autovalores e autovetores. Os autovalores representam a porcentagem de explicação de cada eixo e podem ser calculados dividindo a soma do autovalor de cada eixo pela soma de todos os autovalores. No exemplo que apresentamos, os dois primeiros eixos representam 47,20% e 35,01%, respectivamente, de toda variação. Os autovetores, por sua vez, representam os valores que multiplicam as variáveis originais e, desse modo, indicam a direção desses valores. Por fim, os componentes principais (Matriz F) são obtidos multiplicando os autovetores com os valores da matriz centralizada.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="cap9.html#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Matriz de covaiância</span></span>
<span id="cb352-2"><a href="cap9.html#cb352-2" aria-hidden="true" tabindex="-1"></a>matriz_cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(aranha.cent)</span>
<span id="cb352-3"><a href="cap9.html#cb352-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-4"><a href="cap9.html#cb352-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Autovalores e autovetores</span></span>
<span id="cb352-5"><a href="cap9.html#cb352-5" aria-hidden="true" tabindex="-1"></a>eigen_aranhas <span class="ot">&lt;-</span> <span class="fu">eigen</span>(matriz_cov)</span>
<span id="cb352-6"><a href="cap9.html#cb352-6" aria-hidden="true" tabindex="-1"></a>autovalores <span class="ot">&lt;-</span> eigen_aranhas<span class="sc">$</span>values</span>
<span id="cb352-7"><a href="cap9.html#cb352-7" aria-hidden="true" tabindex="-1"></a>autovetores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(eigen_aranhas<span class="sc">$</span>vectors)</span>
<span id="cb352-8"><a href="cap9.html#cb352-8" aria-hidden="true" tabindex="-1"></a>autovalores  <span class="co"># eigenvalue</span></span>
<span id="cb352-9"><a href="cap9.html#cb352-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 36.733031 27.243824  9.443805  2.962749  1.438020</span></span>
<span id="cb352-10"><a href="cap9.html#cb352-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(autovetores) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;PC&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb352-11"><a href="cap9.html#cb352-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(autovetores) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(aranhas)</span>
<span id="cb352-12"><a href="cap9.html#cb352-12" aria-hidden="true" tabindex="-1"></a>autovetores</span>
<span id="cb352-13"><a href="cap9.html#cb352-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            PC1         PC2         PC3         PC4        PC5</span></span>
<span id="cb352-14"><a href="cap9.html#cb352-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sp1 -0.2144766  0.38855265  0.29239380 -0.02330706  0.8467522</span></span>
<span id="cb352-15"><a href="cap9.html#cb352-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sp2 -0.2442026  0.17463316  0.01756743  0.94587037 -0.1220204</span></span>
<span id="cb352-16"><a href="cap9.html#cb352-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sp3 -0.3558368 -0.80222917 -0.27591770  0.10991178  0.3762942</span></span>
<span id="cb352-17"><a href="cap9.html#cb352-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sp4  0.4159852 -0.41786654  0.78820962  0.17374202  0.0297183</span></span>
<span id="cb352-18"><a href="cap9.html#cb352-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sp5  0.7711688  0.01860152 -0.46560957  0.25003826  0.3544591</span></span>
<span id="cb352-19"><a href="cap9.html#cb352-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-20"><a href="cap9.html#cb352-20" aria-hidden="true" tabindex="-1"></a>matriz_F <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(aranha.cent) <span class="sc">%*%</span> <span class="fu">as.matrix</span>(autovetores))</span>
<span id="cb352-21"><a href="cap9.html#cb352-21" aria-hidden="true" tabindex="-1"></a>matriz_F</span>
<span id="cb352-22"><a href="cap9.html#cb352-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               PC1        PC2        PC3        PC4        PC5</span></span>
<span id="cb352-23"><a href="cap9.html#cb352-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade1 -2.979363  4.4720575  1.1533417 -3.2641923  0.5433206</span></span>
<span id="cb352-24"><a href="cap9.html#cb352-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade2 -4.873532  6.2969618  1.8435339  2.3644158  1.5047024</span></span>
<span id="cb352-25"><a href="cap9.html#cb352-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade3 -3.068541  3.8302991  0.3288626 -0.3566600 -2.3629973</span></span>
<span id="cb352-26"><a href="cap9.html#cb352-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade4 -6.086322 -3.9922356 -2.7216169  1.6250305 -0.7918743</span></span>
<span id="cb352-27"><a href="cap9.html#cb352-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade5 -4.513082 -8.7689219 -0.4668012 -1.1337476  0.9439633</span></span>
<span id="cb352-28"><a href="cap9.html#cb352-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade6  5.812374 -3.9444494  3.9520584  0.4197281 -0.1376205</span></span>
<span id="cb352-29"><a href="cap9.html#cb352-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade7  8.361421 -0.6462243  1.8065636  0.4926235 -0.2625625</span></span>
<span id="cb352-30"><a href="cap9.html#cb352-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade8  7.347046  2.7525126 -5.8959421 -0.1471979  0.5630683</span></span>
<span id="cb352-31"><a href="cap9.html#cb352-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Porcentagem de explicação de cada eixo</span></span>
<span id="cb352-32"><a href="cap9.html#cb352-32" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> (autovalores<span class="sc">/</span><span class="fu">sum</span>(autovalores))</span>
<span id="cb352-33"><a href="cap9.html#cb352-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 47.201691 35.008126 12.135225  3.807112  1.847846</span></span></code></pre></div>
<p>Agora, é possível visualizar a relação entre as cidades e similaridade na espécies de aranhas que vivem em cada uma delas.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="cap9.html#cb353-1" aria-hidden="true" tabindex="-1"></a>matriz_F <span class="sc">%&gt;%</span></span>
<span id="cb353-2"><a href="cap9.html#cb353-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">label =</span> <span class="fu">rownames</span>(matriz_F))) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb353-3"><a href="cap9.html#cb353-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb353-4"><a href="cap9.html#cb353-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb353-5"><a href="cap9.html#cb353-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">12</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb353-6"><a href="cap9.html#cb353-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-365-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Verifique se todas as variáveis utilizadas são contínuas. Caso contrário, considere utilizar PCoA.</p></li>
<li><p>Apesar do exemplo acima ter apresentado a ocorrência de espécies de aranhas em diferentes cidades, é fundamental saber que utilizar PCA com esses dados pode ser problemático. Assim, tenha cuidado em usar de composição de espécies (especialmente abundância) com PCA, uma vez que ‘duplos zeros’ podem gerar distorções na ordenação <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. Como alternativa, é possível utilizar PCA com dados padronizados com o método de Hellinger <span class="citation">(<a href="#ref-legendre2001" role="doc-biblioref">Legendre &amp; Gallagher, 2001</a>)</span>.</p></li>
</ul>
</div>
<div id="exemplo-1-4" class="section level4" number="10.5.1.2">
<h4><span class="header-section-number">10.5.1.2</span> Exemplo 1</h4>
<p>Neste exemplo vamos utilizar um conjunto de dados morfológicos de pinguins do arquipélago Palmer (Península Antártica) disponíveis no pacote ‘palmerpenguins.’ Os dados representam medidas do comprimento e largura do bico (mm), comprimento da nadadeira (mm) e massa corporal (gramas) de três espécies: Adélie, Chinstrap e Gentoo. Como descrito acima, a PCA deve ser utilizada para exploração de dados ou para testes a posteriori (p. ex., PCR). Neste exemplo, iremos usar a estrutura de perguntas e predições para manter a proposta do livro.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existe diferenças nas características morfológicas das espécies de pinguins do arquipélago Palmer?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Pinguins com dieta diferente possuem differentes características morfológicas.</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li><p>Preditora: espécie (categórica com três níveis)</p></li>
<li><p>Dependentes: variáveis morfológicas (contínua)</p></li>
</ul>
</div>
<div id="análise-no-r-3" class="section level4" number="10.5.1.3">
<h4><span class="header-section-number">10.5.1.3</span> Análise no R</h4>
<p>Antes de começar, é necessário remover dados ausentes (se houver) e editar nomes das variáveis (ponto importante para determinar como devem aparecer no gráfico).</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="cap9.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Verificar se existem NAs nos dados.</span></span>
<span id="cb354-2"><a href="cap9.html#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(penguins))</span>
<span id="cb354-3"><a href="cap9.html#cb354-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 19</span></span>
<span id="cb354-4"><a href="cap9.html#cb354-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-5"><a href="cap9.html#cb354-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Remover dados ausentes (NA), quando houver.</span></span>
<span id="cb354-6"><a href="cap9.html#cb354-6" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(penguins)</span>
<span id="cb354-7"><a href="cap9.html#cb354-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-8"><a href="cap9.html#cb354-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Editar nomes para aparecer nos gráficos.</span></span>
<span id="cb354-9"><a href="cap9.html#cb354-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(penguins) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;species&quot;</span>, <span class="st">&quot;island&quot;</span>, <span class="st">&quot;Bill length&quot;</span>, <span class="st">&quot;Bill depth&quot;</span>, <span class="st">&quot;Flipper length&quot;</span>,</span>
<span id="cb354-10"><a href="cap9.html#cb354-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Body mass&quot;</span>, <span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Year&quot;</span>)</span>
<span id="cb354-11"><a href="cap9.html#cb354-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-12"><a href="cap9.html#cb354-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Manter somentes dados contínuos que pretende aplicar a PCA.</span></span>
<span id="cb354-13"><a href="cap9.html#cb354-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-14"><a href="cap9.html#cb354-14" aria-hidden="true" tabindex="-1"></a>penguins_trait <span class="ot">&lt;-</span> penguins[, <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]</span></code></pre></div>
<p>Agora sim os dados estão prontos para fazer a PCA. Um argumento é essencial na análise, o “scale.unit.” Se você utiliar dentro deste argumento o seleção ‘TRUE,’ a função padroniza automaticamente as variáveis para terem a média 0 e variância 1. Esta padronização é essencial quando as variáveis estão em escalas muito diferentes. No exemplo selecionado, temos variáveis como comprimento do bico (em milímetros) e massa corporal (em gramas).</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="cap9.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare com este código a variância das variáveis</span></span>
<span id="cb355-2"><a href="cap9.html#cb355-2" aria-hidden="true" tabindex="-1"></a>penguins_trait <span class="sc">%&gt;%</span></span>
<span id="cb355-3"><a href="cap9.html#cb355-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">var</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb355-4"><a href="cap9.html#cb355-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 4</span></span>
<span id="cb355-5"><a href="cap9.html#cb355-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   `Bill length` `Bill depth` `Flipper length` `Body mass`</span></span>
<span id="cb355-6"><a href="cap9.html#cb355-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb355-7"><a href="cap9.html#cb355-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          29.9         3.88             196.     648372.</span></span>
<span id="cb355-8"><a href="cap9.html#cb355-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-9"><a href="cap9.html#cb355-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Agora, veja o mesmo cálculo se fizer a padronização (scale.unit da função</span></span>
<span id="cb355-10"><a href="cap9.html#cb355-10" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA)</span></span>
<span id="cb355-11"><a href="cap9.html#cb355-11" aria-hidden="true" tabindex="-1"></a>penguins_pad <span class="ot">&lt;-</span> <span class="fu">decostand</span>(penguins_trait, <span class="st">&quot;standardize&quot;</span>)</span>
<span id="cb355-12"><a href="cap9.html#cb355-12" aria-hidden="true" tabindex="-1"></a>penguins_pad <span class="sc">%&gt;%</span></span>
<span id="cb355-13"><a href="cap9.html#cb355-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">var</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb355-14"><a href="cap9.html#cb355-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Bill length Bill depth Flipper length Body mass</span></span>
<span id="cb355-15"><a href="cap9.html#cb355-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1           1          1              1         1</span></span>
<span id="cb355-16"><a href="cap9.html#cb355-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-17"><a href="cap9.html#cb355-17" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA</span></span>
<span id="cb355-18"><a href="cap9.html#cb355-18" aria-hidden="true" tabindex="-1"></a>pca.p <span class="ot">&lt;-</span> <span class="fu">PCA</span>(penguins_trait, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Apesar da simplicidade do comando para executar a PCA, o objeto resultante da análise possui diversas informações que são essenciais para sua plena interpretação. Dentre elas, se destacam os autovalores, escores e <em>loadings</em>. Os autovalores representam a porcentagem de explicação de cada eixo. O escores representam as coordenadas (posições no espaço multidimensional) representando os objetos (geralmente localidades ou indivíduos) e descritores (geralmente espécies ou variáveis ambientais e espaciais). Os <em>loadings</em>, por sua vez, representam a combinação linear entre os escores (nova posição do valor do descritor no espaço ordenado) e os valores originais dos descritores.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="cap9.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Autovalores: porcentagem de explicação para usar no gráfico</span></span>
<span id="cb356-2"><a href="cap9.html#cb356-2" aria-hidden="true" tabindex="-1"></a>pca.p<span class="sc">$</span>eig</span>
<span id="cb356-3"><a href="cap9.html#cb356-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        eigenvalue percentage of variance cumulative percentage of variance</span></span>
<span id="cb356-4"><a href="cap9.html#cb356-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 1  2.7453557              68.633893                          68.63389</span></span>
<span id="cb356-5"><a href="cap9.html#cb356-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 2  0.7781172              19.452929                          88.08682</span></span>
<span id="cb356-6"><a href="cap9.html#cb356-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 3  0.3686425               9.216063                          97.30289</span></span>
<span id="cb356-7"><a href="cap9.html#cb356-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 4  0.1078846               2.697115                         100.00000</span></span>
<span id="cb356-8"><a href="cap9.html#cb356-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-9"><a href="cap9.html#cb356-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Visualização da porcentagem de explicação de cada eixo nota: é necessário</span></span>
<span id="cb356-10"><a href="cap9.html#cb356-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ficar atento ao valor máximo do eixo 1 da análise para determinar o valor do</span></span>
<span id="cb356-11"><a href="cap9.html#cb356-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ylim (neste caso, colocamos que o eixo varia de 0 a 70)</span></span>
<span id="cb356-12"><a href="cap9.html#cb356-12" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_screeplot</span>(pca.p, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">70</span>))</span>
<span id="cb356-13"><a href="cap9.html#cb356-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-14"><a href="cap9.html#cb356-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Outros valores importantes</span></span>
<span id="cb356-15"><a href="cap9.html#cb356-15" aria-hidden="true" tabindex="-1"></a>var_env <span class="ot">&lt;-</span> <span class="fu">get_pca_var</span>(pca.p)</span>
<span id="cb356-16"><a href="cap9.html#cb356-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-17"><a href="cap9.html#cb356-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Escores (posição) das variáveis em cada eixo</span></span>
<span id="cb356-18"><a href="cap9.html#cb356-18" aria-hidden="true" tabindex="-1"></a>var_env<span class="sc">$</span>coord</span>
<span id="cb356-19"><a href="cap9.html#cb356-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Dim.1      Dim.2      Dim.3       Dim.4</span></span>
<span id="cb356-20"><a href="cap9.html#cb356-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill length     0.7518288 0.52943763 -0.3900969 -0.04768208</span></span>
<span id="cb356-21"><a href="cap9.html#cb356-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill depth     -0.6611860 0.70230869  0.2585287  0.05252186</span></span>
<span id="cb356-22"><a href="cap9.html#cb356-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Flipper length  0.9557480 0.00510580  0.1433474  0.25684871</span></span>
<span id="cb356-23"><a href="cap9.html#cb356-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Body mass       0.9107624 0.06744932  0.3592789 -0.19204478</span></span>
<span id="cb356-24"><a href="cap9.html#cb356-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-25"><a href="cap9.html#cb356-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Contribuição (%) das variáveis para cada eixo</span></span>
<span id="cb356-26"><a href="cap9.html#cb356-26" aria-hidden="true" tabindex="-1"></a>var_env<span class="sc">$</span>contrib</span>
<span id="cb356-27"><a href="cap9.html#cb356-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   Dim.1        Dim.2     Dim.3     Dim.4</span></span>
<span id="cb356-28"><a href="cap9.html#cb356-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill length    20.58919 36.023392267 41.279994  2.107420</span></span>
<span id="cb356-29"><a href="cap9.html#cb356-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill depth     15.92387 63.388588337 18.130600  2.556942</span></span>
<span id="cb356-30"><a href="cap9.html#cb356-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Flipper length 33.27271  0.003350291  5.574092 61.149849</span></span>
<span id="cb356-31"><a href="cap9.html#cb356-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Body mass      30.21423  0.584669105 35.015313 34.185789</span></span>
<span id="cb356-32"><a href="cap9.html#cb356-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-33"><a href="cap9.html#cb356-33" aria-hidden="true" tabindex="-1"></a><span class="co"># loadings - correlação das variáveis com os eixos</span></span>
<span id="cb356-34"><a href="cap9.html#cb356-34" aria-hidden="true" tabindex="-1"></a>var_env<span class="sc">$</span>cor</span>
<span id="cb356-35"><a href="cap9.html#cb356-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Dim.1      Dim.2      Dim.3       Dim.4</span></span>
<span id="cb356-36"><a href="cap9.html#cb356-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill length     0.7518288 0.52943763 -0.3900969 -0.04768208</span></span>
<span id="cb356-37"><a href="cap9.html#cb356-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill depth     -0.6611860 0.70230869  0.2585287  0.05252186</span></span>
<span id="cb356-38"><a href="cap9.html#cb356-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Flipper length  0.9557480 0.00510580  0.1433474  0.25684871</span></span>
<span id="cb356-39"><a href="cap9.html#cb356-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Body mass       0.9107624 0.06744932  0.3592789 -0.19204478</span></span>
<span id="cb356-40"><a href="cap9.html#cb356-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-41"><a href="cap9.html#cb356-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Qualidade da representação da variável. Esse valor é obtido multiplicado</span></span>
<span id="cb356-42"><a href="cap9.html#cb356-42" aria-hidden="true" tabindex="-1"></a><span class="co"># var_env$coord por var_env$coord</span></span>
<span id="cb356-43"><a href="cap9.html#cb356-43" aria-hidden="true" tabindex="-1"></a>var_env<span class="sc">$</span>cos2</span>
<span id="cb356-44"><a href="cap9.html#cb356-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    Dim.1        Dim.2      Dim.3       Dim.4</span></span>
<span id="cb356-45"><a href="cap9.html#cb356-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill length    0.5652466 2.803042e-01 0.15217561 0.002273581</span></span>
<span id="cb356-46"><a href="cap9.html#cb356-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill depth     0.4371669 4.932375e-01 0.06683710 0.002758546</span></span>
<span id="cb356-47"><a href="cap9.html#cb356-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Flipper length 0.9134542 2.606919e-05 0.02054847 0.065971260</span></span>
<span id="cb356-48"><a href="cap9.html#cb356-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Body mass      0.8294881 4.549411e-03 0.12908133 0.036881196</span></span>
<span id="cb356-49"><a href="cap9.html#cb356-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-50"><a href="cap9.html#cb356-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Escores (posição) das localidades (&#39;site scores&#39;) em cada eixo</span></span>
<span id="cb356-51"><a href="cap9.html#cb356-51" aria-hidden="true" tabindex="-1"></a>ind_env <span class="ot">&lt;-</span> <span class="fu">get_pca_ind</span>(pca.p)</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-368-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>O pacote <code>FactoMineR</code> criou uma função (<code>dimdesc</code>) que seleciona as melhores variáveis (aquelas mais explicativas) para cada eixo através de uma análise fatorial. No exemplo com pinguins, o primeiro eixo (objeto <code>pca.p$eig</code>) explica ~69% da variação morfológica. A função dimdesc mostra que as quatro variáveis morfológicas estão fortemente associadas com o eixo 1. Porém, enquanto comprimento da nadadeira, massa corporal e comprimento do bico estão positivamente associados com o eixo 1 (correlação positiva), a largura do bico tem relação negativa. O eixo 2, por sua vez, explica ~20% da variação, sendo relacionado somente com largura e comprimento do bico.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="cap9.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variáveis mais importantes para o Eixo 1</span></span>
<span id="cb357-2"><a href="cap9.html#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dimdesc</span>(pca.p)<span class="sc">$</span>Dim<span class="fl">.1</span></span>
<span id="cb357-3"><a href="cap9.html#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $quanti</span></span>
<span id="cb357-4"><a href="cap9.html#cb357-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                correlation       p.value</span></span>
<span id="cb357-5"><a href="cap9.html#cb357-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Flipper length   0.9557480 5.962756e-178</span></span>
<span id="cb357-6"><a href="cap9.html#cb357-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Body mass        0.9107624 3.447018e-129</span></span>
<span id="cb357-7"><a href="cap9.html#cb357-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill length      0.7518288  7.830597e-62</span></span>
<span id="cb357-8"><a href="cap9.html#cb357-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill depth      -0.6611860  3.217695e-43</span></span>
<span id="cb357-9"><a href="cap9.html#cb357-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb357-10"><a href="cap9.html#cb357-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb357-11"><a href="cap9.html#cb357-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;condes&quot; &quot;list&quot;</span></span>
<span id="cb357-12"><a href="cap9.html#cb357-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-13"><a href="cap9.html#cb357-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Variáveis mais importantes para o Eixo 2</span></span>
<span id="cb357-14"><a href="cap9.html#cb357-14" aria-hidden="true" tabindex="-1"></a><span class="fu">dimdesc</span>(pca.p)<span class="sc">$</span>Dim<span class="fl">.2</span></span>
<span id="cb357-15"><a href="cap9.html#cb357-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $quanti</span></span>
<span id="cb357-16"><a href="cap9.html#cb357-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             correlation      p.value</span></span>
<span id="cb357-17"><a href="cap9.html#cb357-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill depth    0.7023087 8.689230e-51</span></span>
<span id="cb357-18"><a href="cap9.html#cb357-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill length   0.5294376 1.873918e-25</span></span>
<span id="cb357-19"><a href="cap9.html#cb357-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb357-20"><a href="cap9.html#cb357-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb357-21"><a href="cap9.html#cb357-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;condes&quot; &quot;list&quot;</span></span></code></pre></div>
<p>Agora podemos utilizar o famoso “biplot” para representar a comparação morfológica dos pinguins dentro e entre espécies</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="cap9.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pca.p, <span class="at">geom.ind =</span> <span class="st">&quot;point&quot;</span>, <span class="at">fill.ind =</span> penguins<span class="sc">$</span>species, <span class="at">col.ind =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb358-2"><a href="cap9.html#cb358-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha.ind =</span> <span class="fl">0.7</span>, <span class="at">pointshape =</span> <span class="dv">21</span>, <span class="at">pointsize =</span> <span class="dv">4</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;darkorchid&quot;</span>,</span>
<span id="cb358-3"><a href="cap9.html#cb358-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cyan4&quot;</span>), <span class="at">addEllipses =</span> <span class="cn">FALSE</span>, <span class="at">alpha.var =</span> <span class="dv">1</span>, <span class="at">col.var =</span> <span class="st">&quot;black&quot;</span>, <span class="at">gradient.cols =</span> <span class="st">&quot;RdBu&quot;</span>,</span>
<span id="cb358-4"><a href="cap9.html#cb358-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">invisible =</span> <span class="st">&quot;quali&quot;</span>, <span class="at">title =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;PC 1 (68.63%)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;PC 2 (19.45%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb358-5"><a href="cap9.html#cb358-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb358-6"><a href="cap9.html#cb358-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">12</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb358-7"><a href="cap9.html#cb358-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">12</span>), <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-370-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="análise-de-coordenadas-principais---pcoa" class="section level3" number="10.5.2">
<h3><span class="header-section-number">10.5.2</span> Análise de Coordenadas Principais - PCoA</h3>
<p>Diferentemente da PCA, a PCoA é uma análise de ordenação irrestrita que aceita dados de diferentes tipos, como contínuos, categóricos, ordinais, binários, entre outros. Assim, a PCoA é aplicada para casos em que a distância euclidiana não é aplicada (como na PCA). Desse modo, o primeiro passo da análise é calcular uma matriz de similaridade ou de distância (discutido acima). Depois, os passos para obter autovalores e autovetores são bastante parecidos com a PCA. Da mesma forma, os eixos da PCoA e os valores ou posições dos objetos nesses eixos representam a relação de semelhança (ou diferença) baseada nos descritores desses objetos. A diferença, neste caso, é que a PCoA representa um espaço não-euclidiano, que irá ser afetado pela escolha do método de similaridade.</p>
<p>As utilizações mais comuns da PCoA são a ordenação (1) da matriz de composição de espécies usando a distância apropriada (Jaccard, Sorensen, Bray Curits), (2) da matriz de variáveis ambientais com mistos (contínuos, categóricos, circulares, etc…), e (3) da matriz filogenética <span class="citation">(método PVR <a href="#ref-diniz-filho_eigenvector_1998" role="doc-biblioref">Diniz-Filho et al., 1998</a>)</span>. Abaixo, exemplificamos a ordenação da matriz de composição de espécies.</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Compare as dimensões das matrizes utilizadas para a PCoA. Com bastante frequência, a tentativa de combinar dados categóricos (algum descritor dos objetos) com os valores obtidos com a PCoA gera erros para plotar a figura ou para executar a análise. Verifique, então, se as linhas são as mesmas (nome das localidades ou indivíduos e quantidade).</p></li>
<li><p>É fundamental conhecer o tipo de dados que está usando para selecionar a medida de distância apropriada. Essa escolha vai afetar a qualidade da ordenação e sua habilidade para interpretar a relação de semelhança entre os objetos comparados.</p></li>
<li><p>Diferente da PCA, a PCoA aceita dados ausentes se a medida de distância escolhida também não tiver esta limitação. Por exemplo, a distância de Gower produz matrizes de similaridade mesmo com dados ausentes em determinados objetos.</p></li>
<li><p>Em alguns casos, a autovalores negativos são produzidos na ordenação com PCoA. Veja as principais causas desses valores em Legendre &amp; Legendre <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">2012</a>)</span>. Apesar deste problema, os autovalores mais importantes (eixos iniciais) não são afetados e, deste modo, a qualidade da representação dos objetos no espaço multidimensional não é afetada. Alguns autores sugerem utilizar correções métodos de correção, como Lingoes ou Cailliez <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>.</p></li>
</ul>
<div id="exemplo-1-5" class="section level4" number="10.5.2.1">
<h4><span class="header-section-number">10.5.2.1</span> Exemplo 1</h4>
<p>Neste exemplo vamos utilizar a composição de ácaros Oribatidae em 70 manchas de musgo coletados por Borcard et al. <span class="citation">(<a href="#ref-borcard_partialling_1992" role="doc-biblioref">1992</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>A composição de espécies de ácaros muda entre diferentes topografias?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Iremos encontrar ao menos dois grupos de espécies: aquelas que ocorrem em poças dentro de floresta vs. aquelas que ocorrem em poças de áreas abertas.</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li><p>Preditora: topografia (categórica com dois níveis)</p></li>
<li><p>Dependentes: composição de espécies de ácaro</p></li>
</ul>
</div>
<div id="análise-no-r-4" class="section level4" number="10.5.2.2">
<h4><span class="header-section-number">10.5.2.2</span> Análise no R</h4>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="cap9.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Padronização dos dados com Hellinger</span></span>
<span id="cb359-2"><a href="cap9.html#cb359-2" aria-hidden="true" tabindex="-1"></a>mite.hel <span class="ot">&lt;-</span> <span class="fu">decostand</span>(mite, <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb359-3"><a href="cap9.html#cb359-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-4"><a href="cap9.html#cb359-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo da matriz de distância com método Bray Curtos</span></span>
<span id="cb359-5"><a href="cap9.html#cb359-5" aria-hidden="true" tabindex="-1"></a>sps.dis <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(mite.hel, <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb359-6"><a href="cap9.html#cb359-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-7"><a href="cap9.html#cb359-7" aria-hidden="true" tabindex="-1"></a><span class="co"># PCoA</span></span>
<span id="cb359-8"><a href="cap9.html#cb359-8" aria-hidden="true" tabindex="-1"></a>pcoa.sps <span class="ot">&lt;-</span> <span class="fu">pcoa</span>(sps.dis, <span class="at">correction =</span> <span class="st">&quot;cailliez&quot;</span>)</span></code></pre></div>
<p>Assim como na PCA, a porcentagem de explicação dos eixos é uma das informações mais importantes pois descrevem a efetividade da redução da dimensionalidade dos dados.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="cap9.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Porcentagem de explicação do Eixo 1</span></span>
<span id="cb360-2"><a href="cap9.html#cb360-2" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> (pcoa.sps<span class="sc">$</span>values[, <span class="dv">1</span>]<span class="sc">/</span>pcoa.sps<span class="sc">$</span>trace)[<span class="dv">1</span>]</span>
<span id="cb360-3"><a href="cap9.html#cb360-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 49.10564</span></span>
<span id="cb360-4"><a href="cap9.html#cb360-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-5"><a href="cap9.html#cb360-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Porcentagem de explicação dos Eixo 2</span></span>
<span id="cb360-6"><a href="cap9.html#cb360-6" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> (pcoa.sps<span class="sc">$</span>values[, <span class="dv">1</span>]<span class="sc">/</span>pcoa.sps<span class="sc">$</span>trace)[<span class="dv">2</span>]</span>
<span id="cb360-7"><a href="cap9.html#cb360-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 14.30308</span></span>
<span id="cb360-8"><a href="cap9.html#cb360-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-9"><a href="cap9.html#cb360-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Porcentagem de explicação acumulada dos dois primeiros eixos</span></span>
<span id="cb360-10"><a href="cap9.html#cb360-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="dv">100</span> <span class="sc">*</span> (pcoa.sps<span class="sc">$</span>values[, <span class="dv">1</span>]<span class="sc">/</span>pcoa.sps<span class="sc">$</span>trace)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb360-11"><a href="cap9.html#cb360-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 63.40872</span></span>
<span id="cb360-12"><a href="cap9.html#cb360-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-13"><a href="cap9.html#cb360-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecionar os dois primeiros eixos</span></span>
<span id="cb360-14"><a href="cap9.html#cb360-14" aria-hidden="true" tabindex="-1"></a>eixos <span class="ot">&lt;-</span> pcoa.sps<span class="sc">$</span>vectors[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb360-15"><a href="cap9.html#cb360-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-16"><a href="cap9.html#cb360-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Juntar com algum dado categórico de interesse para fazer a figura</span></span>
<span id="cb360-17"><a href="cap9.html#cb360-17" aria-hidden="true" tabindex="-1"></a>pcoa.dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">topografia =</span> mite.env<span class="sc">$</span>Topo, eixos)</span></code></pre></div>
<p>Para visualizar os resultados da PCoA, vamos exportar os escores dos eixos para usar no ggplot2.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="cap9.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Escores dos dois primeiros eixos</span></span>
<span id="cb361-2"><a href="cap9.html#cb361-2" aria-hidden="true" tabindex="-1"></a>eixos <span class="ot">&lt;-</span> pcoa.sps<span class="sc">$</span>vectors[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb361-3"><a href="cap9.html#cb361-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-4"><a href="cap9.html#cb361-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Combinar dados dos escores com um dado categórico de interesse para nossa</span></span>
<span id="cb361-5"><a href="cap9.html#cb361-5" aria-hidden="true" tabindex="-1"></a><span class="do">## pergunta</span></span>
<span id="cb361-6"><a href="cap9.html#cb361-6" aria-hidden="true" tabindex="-1"></a>pcoa.dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">topografia =</span> mite.env<span class="sc">$</span>Topo, eixos)</span>
<span id="cb361-7"><a href="cap9.html#cb361-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-8"><a href="cap9.html#cb361-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Gráfico biplot da PCoA</span></span>
<span id="cb361-9"><a href="cap9.html#cb361-9" aria-hidden="true" tabindex="-1"></a>pcoa.dat <span class="sc">%&gt;%</span></span>
<span id="cb361-10"><a href="cap9.html#cb361-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>, <span class="at">y =</span> Axis<span class="fl">.2</span>, <span class="at">fill =</span> topografia, <span class="at">color =</span> topografia, <span class="at">shape =</span> topografia)) <span class="sc">+</span></span>
<span id="cb361-11"><a href="cap9.html#cb361-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,</span>
<span id="cb361-12"><a href="cap9.html#cb361-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">22</span>)) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb361-13"><a href="cap9.html#cb361-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;PCO 1 (49.11%)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;PCO 2 (14.30%)&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb361-14"><a href="cap9.html#cb361-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb361-15"><a href="cap9.html#cb361-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-373-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="limitações-importantes-das-ordenações-irrestritas" class="section level4" number="10.5.2.3">
<h4><span class="header-section-number">10.5.2.3</span> Limitações importantes das ordenações irrestritas</h4>
<p>Com frequência, pesquisadores utilizam análises como PCA e PCoA para “testar” diferenças na composição de espécies entre determinados fatores relevantes (altitude, clima, etc…). Porém, como falado acima, as análises de ordenação irrestritas não são utilizadas para testar qualquer hipótese. Ao invés disso, essas análises representam uma poderosa ferramente para explorar padrões em variáveis dependentes ou independentes para ajudar na interpretação ou mesmo para testar hipóteses em análises combinadas com as ordenações irrestritas.</p>
</div>
</div>
</div>
<div id="pcr---regressão-de-componentes-principais" class="section level2" number="10.6">
<h2><span class="header-section-number">10.6</span> PCR - Regressão de Componentes Principais</h2>
<p>Uma maneira de testar hipóteses utilizando ordenações irrestritas é utilizando os resultados da ordenação (escores) como variáveis preditoras ou dependentes como, por exemplo, em modelos lineares (e.g., regressão múltipla). O primeiro passo é utilizar uma ordenação, como a PCA, para gerar os “novos” dados que serão usados na análise. A utilização desses novos dados (que representam as coordenadas principais ou escores da PCA) vai depender da pergunta em questão. Por exemplo, pode ser que esses valores representem gradientes climáticos e, por este motivo, serão utilizados como variáveis preditoras em um modelo linear (e.g., regressão múltipla). Por outro lado, esses valores podem representar o espaço morfológicos de espécies de peixe e, como consequência, serão utilizados como variáveis dependentes para entender o efeito da presença de predador sobre a morfologia.</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Compare as dimensões das matrizes utilizadas para a PCR. Com bastante frequência, a tentativa de combinar dados categóricos (algum descritor dos objetos) com os valores obtidos com a PCoA gera erros para plotar a figura ou para executar a análise. Verifique, então, se as linhas são as mesmas (nome das localidades ou indivíduos e quantidade).</p></li>
<li><p>Estudos recentes têm criticado a utilização de PCR para testar hipóteses ecológicas pelo fato dos escores não representarem, necessariamente, a variação total das variáveis originais, bem como a relação entre a variável preditora e a dependente.</p></li>
</ul>
<div id="exemplo-1-6" class="section level4" number="10.6.0.1">
<h4><span class="header-section-number">10.6.0.1</span> Exemplo 1</h4>
<p>Neste exemplo vamos utilizar a composição de espécies de aves em 23 regiões dos alpes franceses. Os dados ambientais (env) representam variáveis climáticas (temperatura e chuva) e altitude.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Gradientes climáticos afetam a riqueza de aves?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>O aumento da umidade e redução da temperatura aumentam o número de espécies de aves.</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li><p>Preditora: temperatura e chuva (contínuas) e altitude (categórica com três níveis)</p></li>
<li><p>Dependentes: riqueza de espécies de aves</p></li>
</ul>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="cap9.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dados</span></span>
<span id="cb362-2"><a href="cap9.html#cb362-2" aria-hidden="true" tabindex="-1"></a>env_cont <span class="ot">&lt;-</span> env[, <span class="sc">-</span><span class="dv">8</span>]</span>
<span id="cb362-3"><a href="cap9.html#cb362-3" aria-hidden="true" tabindex="-1"></a>env.pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(env_cont, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb362-4"><a href="cap9.html#cb362-4" aria-hidden="true" tabindex="-1"></a>var_env <span class="ot">&lt;-</span> <span class="fu">get_pca_var</span>(env.pca)</span>
<span id="cb362-5"><a href="cap9.html#cb362-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-6"><a href="cap9.html#cb362-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Contribuição (%) das variáveis para cada eixo</span></span>
<span id="cb362-7"><a href="cap9.html#cb362-7" aria-hidden="true" tabindex="-1"></a>var_env<span class="sc">$</span>contrib</span>
<span id="cb362-8"><a href="cap9.html#cb362-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Dim.1      Dim.2      Dim.3      Dim.4       Dim.5</span></span>
<span id="cb362-9"><a href="cap9.html#cb362-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jan 10.93489 22.2975487 16.1607726  7.6025527  0.01782438</span></span>
<span id="cb362-10"><a href="cap9.html#cb362-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jan 20.18065  3.2890767  2.1814486  4.2756350 41.05646526</span></span>
<span id="cb362-11"><a href="cap9.html#cb362-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jul 11.87396 21.1379132  0.3428843  0.7750666 44.70209396</span></span>
<span id="cb362-12"><a href="cap9.html#cb362-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jul 18.47244  0.9159957 56.5369988  9.4368661  2.59283074</span></span>
<span id="cb362-13"><a href="cap9.html#cb362-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jan  9.95206 21.5387403  6.5737927 53.7375738  4.44283706</span></span>
<span id="cb362-14"><a href="cap9.html#cb362-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jul 16.14997 11.2368132  7.2608047 19.6972097  0.71454880</span></span>
<span id="cb362-15"><a href="cap9.html#cb362-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.tot 12.43603 19.5839121 10.9432983  4.4750959  6.47339980</span></span>
<span id="cb362-16"><a href="cap9.html#cb362-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-17"><a href="cap9.html#cb362-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Loadings - correlação das variáveis com os eixos</span></span>
<span id="cb362-18"><a href="cap9.html#cb362-18" aria-hidden="true" tabindex="-1"></a>var_env<span class="sc">$</span>cor</span>
<span id="cb362-19"><a href="cap9.html#cb362-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Dim.1     Dim.2       Dim.3       Dim.4        Dim.5</span></span>
<span id="cb362-20"><a href="cap9.html#cb362-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jan  0.6830371 0.6766524 -0.21924927  0.12298817 -0.004517369</span></span>
<span id="cb362-21"><a href="cap9.html#cb362-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jan  0.9279073 0.2598807 -0.08055260  0.09223249  0.216804944</span></span>
<span id="cb362-22"><a href="cap9.html#cb362-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jul  0.7117620 0.6588220  0.03193603 -0.03926930 -0.226225907</span></span>
<span id="cb362-23"><a href="cap9.html#cb362-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jul  0.8877675 0.1371462  0.41008461 -0.13702428  0.054483561</span></span>
<span id="cb362-24"><a href="cap9.html#cb362-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jan -0.6516187 0.6650391 -0.13983474 -0.32698110  0.071319550</span></span>
<span id="cb362-25"><a href="cap9.html#cb362-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jul -0.8300858 0.4803509  0.14696011  0.19796389 -0.028601865</span></span>
<span id="cb362-26"><a href="cap9.html#cb362-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.tot -0.7284135 0.6341424  0.18041856  0.09435932  0.086088397</span></span>
<span id="cb362-27"><a href="cap9.html#cb362-27" aria-hidden="true" tabindex="-1"></a>ind_env <span class="ot">&lt;-</span> <span class="fu">get_pca_ind</span>(env.pca)</span>
<span id="cb362-28"><a href="cap9.html#cb362-28" aria-hidden="true" tabindex="-1"></a>env.pca<span class="sc">$</span>eig</span>
<span id="cb362-29"><a href="cap9.html#cb362-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        eigenvalue percentage of variance cumulative percentage of variance</span></span>
<span id="cb362-30"><a href="cap9.html#cb362-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 1 4.26652359             60.9503370                          60.95034</span></span>
<span id="cb362-31"><a href="cap9.html#cb362-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 2 2.05340251             29.3343216                          90.28466</span></span>
<span id="cb362-32"><a href="cap9.html#cb362-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 3 0.29745014              4.2492878                          94.53395</span></span>
<span id="cb362-33"><a href="cap9.html#cb362-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 4 0.19896067              2.8422953                          97.37624</span></span>
<span id="cb362-34"><a href="cap9.html#cb362-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 5 0.11448717              1.6355310                          99.01177</span></span>
<span id="cb362-35"><a href="cap9.html#cb362-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 6 0.04312874              0.6161248                          99.62790</span></span>
<span id="cb362-36"><a href="cap9.html#cb362-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 7 0.02604718              0.3721025                         100.00000</span></span></code></pre></div>
<p>O objeto <code>env.pca$eig</code> demonstra que os três primeiros eixos explicam 94.54% da variação total dos dados climáticos. Como o intuito da PCR é reduzir a dimensionalidade (ou seja, o número de variáveis preditoras ou depedentes) para facilitar a interpretação e garantir que as variáveis não sejam correlacionadas. O próximo passo então é obter os valores dos escores que representam os valores convertidos para serem usados em uma determinada análise, como a regressão múltipla.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="cap9.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 1: obter os primeiros eixos</span></span>
<span id="cb363-2"><a href="cap9.html#cb363-2" aria-hidden="true" tabindex="-1"></a>pred.env <span class="ot">&lt;-</span> ind_env<span class="sc">$</span>coord[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb363-3"><a href="cap9.html#cb363-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-4"><a href="cap9.html#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 2: calcular a riqueza de espécies</span></span>
<span id="cb363-5"><a href="cap9.html#cb363-5" aria-hidden="true" tabindex="-1"></a>riqueza <span class="ot">&lt;-</span> <span class="fu">specnumber</span>(species)</span>
<span id="cb363-6"><a href="cap9.html#cb363-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-7"><a href="cap9.html#cb363-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 3: combinar os dois valores em um único data.frame</span></span>
<span id="cb363-8"><a href="cap9.html#cb363-8" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pred.env, riqueza)</span></code></pre></div>
<p>Agora que os dados foram combinados em uma única matriz, podemos utilizar os comandos aprendidos no Capítulo <a href="cap7.html#cap7">8</a> para testar nossa hipótese.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="cap9.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regressão múltipla</span></span>
<span id="cb364-2"><a href="cap9.html#cb364-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(riqueza <span class="sc">~</span> Dim<span class="fl">.1</span> <span class="sc">+</span> Dim<span class="fl">.2</span> <span class="sc">+</span> Dim<span class="fl">.3</span>, <span class="at">data =</span> dat)</span>
<span id="cb364-3"><a href="cap9.html#cb364-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb364-4"><a href="cap9.html#cb364-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1)  <span class="co"># verificar pressupostos dos modelos lineares</span></span>
<span id="cb364-5"><a href="cap9.html#cb364-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)  <span class="co"># resultados do  teste</span></span>
<span id="cb364-6"><a href="cap9.html#cb364-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb364-7"><a href="cap9.html#cb364-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb364-8"><a href="cap9.html#cb364-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = riqueza ~ Dim.1 + Dim.2 + Dim.3, data = dat)</span></span>
<span id="cb364-9"><a href="cap9.html#cb364-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb364-10"><a href="cap9.html#cb364-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb364-11"><a href="cap9.html#cb364-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb364-12"><a href="cap9.html#cb364-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -3.4008 -1.1729  0.4356  1.2072  2.4571 </span></span>
<span id="cb364-13"><a href="cap9.html#cb364-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb364-14"><a href="cap9.html#cb364-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb364-15"><a href="cap9.html#cb364-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb364-16"><a href="cap9.html#cb364-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 13.30435    0.37639  35.347  &lt; 2e-16 ***</span></span>
<span id="cb364-17"><a href="cap9.html#cb364-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dim.1        0.68591    0.18222   3.764  0.00131 ** </span></span>
<span id="cb364-18"><a href="cap9.html#cb364-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dim.2       -0.09961    0.26267  -0.379  0.70874    </span></span>
<span id="cb364-19"><a href="cap9.html#cb364-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dim.3       -0.21708    0.69014  -0.315  0.75654    </span></span>
<span id="cb364-20"><a href="cap9.html#cb364-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb364-21"><a href="cap9.html#cb364-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb364-22"><a href="cap9.html#cb364-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb364-23"><a href="cap9.html#cb364-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 1.805 on 19 degrees of freedom</span></span>
<span id="cb364-24"><a href="cap9.html#cb364-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.4313, Adjusted R-squared:  0.3415 </span></span>
<span id="cb364-25"><a href="cap9.html#cb364-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 4.804 on 3 and 19 DF,  p-value: 0.01179</span></span>
<span id="cb364-26"><a href="cap9.html#cb364-26" aria-hidden="true" tabindex="-1"></a><span class="fu">dimdesc</span>(env.pca)<span class="sc">$</span>Dim<span class="fl">.1</span></span>
<span id="cb364-27"><a href="cap9.html#cb364-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $quanti</span></span>
<span id="cb364-28"><a href="cap9.html#cb364-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          correlation      p.value</span></span>
<span id="cb364-29"><a href="cap9.html#cb364-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jan   0.9279073 1.846790e-10</span></span>
<span id="cb364-30"><a href="cap9.html#cb364-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jul   0.8877675 1.607390e-08</span></span>
<span id="cb364-31"><a href="cap9.html#cb364-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jul   0.7117620 1.396338e-04</span></span>
<span id="cb364-32"><a href="cap9.html#cb364-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jan   0.6830371 3.282701e-04</span></span>
<span id="cb364-33"><a href="cap9.html#cb364-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jan  -0.6516187 7.559358e-04</span></span>
<span id="cb364-34"><a href="cap9.html#cb364-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.tot  -0.7284135 8.112903e-05</span></span>
<span id="cb364-35"><a href="cap9.html#cb364-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jul  -0.8300858 9.588034e-07</span></span>
<span id="cb364-36"><a href="cap9.html#cb364-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb364-37"><a href="cap9.html#cb364-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb364-38"><a href="cap9.html#cb364-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;condes&quot; &quot;list&quot;</span></span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-376-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>Como percebemos, a Dim.1 foi o único gradiente ambiental que afetou a riqueza de espécies. Para interpretar esta dimensão (e outras importantes), podemos usar a função dimdesc para verificar as variáveis mais importantes. Neste caso, os valores mais extremos de correlação (maior que 0.8) indicam que a temperatura do mês de janeiro e julho bem como a chuva do mês de julho foram as variáveis mais importantes para determinar o gradiente ambiental expresso na dimensão 1. Assim, podemos fazer um gráfico para representar a relação entre Eixo 1 (gradiente chuva-temperatura) e a riqueza de espécies de aves. Valores negativos do eixo 1 (Gradiente ambiental - PC1) representam localidades com mais chuva, ao passo que valores positivos indicam localidades com temperaturas maiores.</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="cap9.html#cb365-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb365-2"><a href="cap9.html#cb365-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Dim<span class="fl">.1</span>, <span class="at">y =</span> riqueza)) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">fill =</span> <span class="st">&quot;#525252&quot;</span>,</span>
<span id="cb365-3"><a href="cap9.html#cb365-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&quot;#1a1a1a&quot;</span>,</span>
<span id="cb365-4"><a href="cap9.html#cb365-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;cyan4&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Gradiente ambiental (PC1)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Riqueza de aves&quot;</span>) <span class="sc">+</span></span>
<span id="cb365-5"><a href="cap9.html#cb365-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb365-6"><a href="cap9.html#cb365-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">12</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb365-7"><a href="cap9.html#cb365-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-377-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="exemplo-2-1" class="section level4" number="10.6.0.2">
<h4><span class="header-section-number">10.6.0.2</span> Exemplo 2</h4>
<p>É possível que os dados utilizados em seu estudo sejam mistos, ou seja, incluem tanto variáveis categóricas quanto contínuas. Como falado acima, nesses casos a análise indicada é a PCoA. Assim como na PCA, podemos extrair os escores da PCoA para utilizar a posteriori em análises univariadas e multivariadas.</p>
<p><strong>Pergunta:</strong></p>
<ul>
<li>Variáveis climáticas, vegetacionais e topográficas afetam a riqueza de ácaros?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>A densidade da vegetação e disponibilidade de água aumentam a riqueza de espécies de ácaros.</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li><p>Preditoras: densidade de substrado e disponibilidade de água (contínuas), tipo de substrado (categórica com 7 níveis), densidade arbusto (ordinal com 3 níveis), e topografia (categórica com 2 níveis)</p></li>
<li><p>Dependentes: riqueza de espécies de ácaros</p></li>
</ul>
<p>O primeiro passo então é utilizar um método de distância apropriado para o seu conjunto de dados. Em nosso exemplo, utilizaremos a distância de Gower, que é usada para dados mistos (veja Capítulo <a href="cap14.html#cap14">15</a>).</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="cap9.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Matriz de distância</span></span>
<span id="cb366-2"><a href="cap9.html#cb366-2" aria-hidden="true" tabindex="-1"></a>env.dist <span class="ot">&lt;-</span> <span class="fu">gowdis</span>(mite.env)</span>
<span id="cb366-3"><a href="cap9.html#cb366-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-4"><a href="cap9.html#cb366-4" aria-hidden="true" tabindex="-1"></a><span class="do">## PCoA</span></span>
<span id="cb366-5"><a href="cap9.html#cb366-5" aria-hidden="true" tabindex="-1"></a>env.mite.pco <span class="ot">&lt;-</span> <span class="fu">pcoa</span>(env.dist, <span class="at">correction =</span> <span class="st">&quot;cailliez&quot;</span>)</span>
<span id="cb366-6"><a href="cap9.html#cb366-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-7"><a href="cap9.html#cb366-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Porcentagem de explicação do Eixo 1</span></span>
<span id="cb366-8"><a href="cap9.html#cb366-8" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> (env.mite.pco<span class="sc">$</span>values[, <span class="dv">1</span>]<span class="sc">/</span>env.mite.pco<span class="sc">$</span>trace)[<span class="dv">1</span>]</span>
<span id="cb366-9"><a href="cap9.html#cb366-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 61.49635</span></span>
<span id="cb366-10"><a href="cap9.html#cb366-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-11"><a href="cap9.html#cb366-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Porcentagem de explicação dos Eixo 2</span></span>
<span id="cb366-12"><a href="cap9.html#cb366-12" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> (env.mite.pco<span class="sc">$</span>values[, <span class="dv">1</span>]<span class="sc">/</span>env.mite.pco<span class="sc">$</span>trace)[<span class="dv">2</span>]</span>
<span id="cb366-13"><a href="cap9.html#cb366-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 32.15486</span></span></code></pre></div>
<p>O próximo passo é exportar os escores para as análises a posteriori.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="cap9.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Selecionar os dois primeiros eixos</span></span>
<span id="cb367-2"><a href="cap9.html#cb367-2" aria-hidden="true" tabindex="-1"></a>pred.scores.mite <span class="ot">&lt;-</span> env.mite.pco<span class="sc">$</span>vectors[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb367-3"><a href="cap9.html#cb367-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-4"><a href="cap9.html#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Juntar com os dados da área para fazer a figura</span></span>
<span id="cb367-5"><a href="cap9.html#cb367-5" aria-hidden="true" tabindex="-1"></a>mite.riqueza <span class="ot">&lt;-</span> <span class="fu">specnumber</span>(mite)</span>
<span id="cb367-6"><a href="cap9.html#cb367-6" aria-hidden="true" tabindex="-1"></a>pred.vars <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">riqueza =</span> mite.riqueza, pred.scores.mite)</span>
<span id="cb367-7"><a href="cap9.html#cb367-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-8"><a href="cap9.html#cb367-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Regressão múltipla</span></span>
<span id="cb367-9"><a href="cap9.html#cb367-9" aria-hidden="true" tabindex="-1"></a>mod.mite <span class="ot">&lt;-</span> <span class="fu">lm</span>(riqueza <span class="sc">~</span> Axis<span class="fl">.1</span> <span class="sc">+</span> Axis<span class="fl">.2</span>, <span class="at">data =</span> pred.vars)</span>
<span id="cb367-10"><a href="cap9.html#cb367-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb367-11"><a href="cap9.html#cb367-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.mite)</span>
<span id="cb367-12"><a href="cap9.html#cb367-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.mite)</span>
<span id="cb367-13"><a href="cap9.html#cb367-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb367-14"><a href="cap9.html#cb367-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb367-15"><a href="cap9.html#cb367-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = riqueza ~ Axis.1 + Axis.2, data = pred.vars)</span></span>
<span id="cb367-16"><a href="cap9.html#cb367-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb367-17"><a href="cap9.html#cb367-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb367-18"><a href="cap9.html#cb367-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb367-19"><a href="cap9.html#cb367-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -10.6874  -2.3960  -0.1378   2.5032   8.6873 </span></span>
<span id="cb367-20"><a href="cap9.html#cb367-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb367-21"><a href="cap9.html#cb367-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb367-22"><a href="cap9.html#cb367-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb367-23"><a href="cap9.html#cb367-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  15.1143     0.4523  33.415  &lt; 2e-16 ***</span></span>
<span id="cb367-24"><a href="cap9.html#cb367-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Axis.1      -11.4303     2.0013  -5.711  2.8e-07 ***</span></span>
<span id="cb367-25"><a href="cap9.html#cb367-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Axis.2        5.6832     2.7677   2.053   0.0439 *  </span></span>
<span id="cb367-26"><a href="cap9.html#cb367-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb367-27"><a href="cap9.html#cb367-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb367-28"><a href="cap9.html#cb367-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb367-29"><a href="cap9.html#cb367-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 3.784 on 67 degrees of freedom</span></span>
<span id="cb367-30"><a href="cap9.html#cb367-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.3548, Adjusted R-squared:  0.3355 </span></span>
<span id="cb367-31"><a href="cap9.html#cb367-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 18.42 on 2 and 67 DF,  p-value: 4.225e-07</span></span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-379-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>Finalmente, após interpretar os resultados do modelo, podemos fazer a figura com as variáveis (eixos) importantes</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="cap9.html#cb368-1" aria-hidden="true" tabindex="-1"></a>g_acari_axi1 <span class="ot">&lt;-</span> pred.vars <span class="sc">%&gt;%</span></span>
<span id="cb368-2"><a href="cap9.html#cb368-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>, <span class="at">y =</span> riqueza)) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb368-3"><a href="cap9.html#cb368-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;#525252&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb368-4"><a href="cap9.html#cb368-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;#1a1a1a&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;cyan4&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Gradiente ambiental (PC1)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Riqueza de ácaros&quot;</span>) <span class="sc">+</span></span>
<span id="cb368-5"><a href="cap9.html#cb368-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb368-6"><a href="cap9.html#cb368-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">12</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb368-7"><a href="cap9.html#cb368-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span>
<span id="cb368-8"><a href="cap9.html#cb368-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-9"><a href="cap9.html#cb368-9" aria-hidden="true" tabindex="-1"></a>g_acari_axi2 <span class="ot">&lt;-</span> pred.vars <span class="sc">%&gt;%</span></span>
<span id="cb368-10"><a href="cap9.html#cb368-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.2</span>, <span class="at">y =</span> riqueza)) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb368-11"><a href="cap9.html#cb368-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;#525252&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb368-12"><a href="cap9.html#cb368-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;#1a1a1a&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;darkorange&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Gradiente ambiental (PC2)&quot;</span>) <span class="sc">+</span></span>
<span id="cb368-13"><a href="cap9.html#cb368-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Riqueza de ácaros&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb368-14"><a href="cap9.html#cb368-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">12</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb368-15"><a href="cap9.html#cb368-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span>
<span id="cb368-16"><a href="cap9.html#cb368-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-17"><a href="cap9.html#cb368-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Função para combinar os dois plots em uma única janela</span></span>
<span id="cb368-18"><a href="cap9.html#cb368-18" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g_acari_axi1, g_acari_axi2, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-380-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="ordenação-restrita" class="section level2" number="10.7">
<h2><span class="header-section-number">10.7</span> Ordenação restrita</h2>
<p>A ordenação restrita, ou análise de gradiente direto organiza os objetos de acordo com suas relações com outras variáveis (preditoras) coletadas nas mesmas unidades amostrais. O exemplo mais comum na ecologia é de investigar a relação entre diversas variáveis ambientais (matriz <strong>X</strong>) coletadas em <em>n</em> localidades e a abundância (ou presença ausência) de <em>y</em> espécies coletadas nas mesmas localidades (matrix <strong>Y</strong>). Com frequência, outras dados são utilizados como as coordenadas geográficas das unidades amostrais (matriz <strong>W</strong>), os atributos funcionais das espécies coletadas (matriz <strong>T</strong>) e a relação filogenética dessas espécies (matriz <strong>P</strong>). Diversos métodos são utilizados para combinar duas ou mais matrizes, mas neste capítulo iremos apresentar a RDA, RDAp e métodos espaciais para incluir a matriz W nas análises de gradiente direto.</p>
<div id="rda-análise-de-redundância" class="section level3" number="10.7.1">
<h3><span class="header-section-number">10.7.1</span> RDA: Análise de Redundância</h3>
<p>A RDA é uma análise semelhante a regressão múltipla (Capítulo <a href="cap7.html#cap7">8</a>) mas que usa dados multivariados como variável dependente. As duas matrizes comuns, matriz X (<em>n</em> unidades amostraits e <em>m</em> variáveis) e matriz Y (<em>n</em> unidades amostrais e <em>p</em> descritores - geralmente, espécies). O primeiro passo da RDA é centralizar (assim como na PCA, exemplo acima) as matrizes X e Y. Após a centralização, realiza-se regressões lineares entre X e Y para obter os valores preditos de Y (ou seja, os valores de Y que representação uma combinação linear com X). O passo seguinte é realizar uma PCA dos valores preditos de Y. Este último procedimento gera os autovalores, autovetores e os eixos canônicos que correspondem às coordenadas dos objetos (unidades amostrais), variáveis preditoras e das variáveis resposta. A diferença da ordenação do valor de Y predito e da ordenação somente de Y (como na PCA implementada acima) é que a segunda mostra a posição prevista pela relação linear entre X e Y. Logo, essa é exatamente o motivo da ordenação ser conhecida como restrita, pois a variação em Y é restrita (linearmente) pela variação de X. Assim como na regressão múltipla, a estatística da RDA é representada pelo valor de <em>R<sup>2</sup></em> e <em>F</em>. O valor de <em>R<sup>2</sup></em> indica a força da relação linear entre X e Y e o valor do <em>F</em> representa o teste global de significância. Além disso, é possível testar a significância de cada um dos eixos da ordenação (e a presença de pelo menos um eixo significativo é pré-requisito para que exista a relação linear entre X e Y) e de cada uma das variáveis preditoras da matriz X.</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Variáveis preditoras: importante verificar (1) a estrutura de correlação das variáveis ambientais, e a (2) presença de autocorrelação espacial.</p></li>
<li><p>Composição de espécies como matriz Y: fundamental observar se os valores utilizados representam abundância ou presença-ausência e qual a necessidade de padronização (e.g., Hellinger).</p></li>
<li><p>Assim como em modelos de regressão linear e múltipla, os valores de <em>R<sup>2</sup></em> ajustado devem ser selecionados ao invés do valor de <em>R<sup>2</sup></em>.</p></li>
</ul>
<div id="exemplo-1-7" class="section level4" number="10.7.1.1">
<h4><span class="header-section-number">10.7.1.1</span> Exemplo 1</h4>
<p>Espécies de aves que ocorrem em localidades com diferentes altitudes.</p>
<p><strong>Pergunta:</strong></p>
<ul>
<li>O clima e a altitude modificam a composição de espécies de aves?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Diferenças climáticas (temperatura e chuva) e altitudinais alteram a composição de espécies de aves.</li>
</ul>
<p><strong>Variáveis</strong> (mesmo conjunto de dados usados na PERMANOVA)</p>
<ul>
<li><p>Preditoras: Temperatura e chuva (contínuas) e altitude (categórica com três níveis)</p></li>
<li><p>Dependente: composição de espécies de aves</p></li>
</ul>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="cap9.html#cb369-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-2"><a href="cap9.html#cb369-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 1: transformação de hellinger da matriz de espécies caso tenha dados</span></span>
<span id="cb369-3"><a href="cap9.html#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="do">## de abundância.</span></span>
<span id="cb369-4"><a href="cap9.html#cb369-4" aria-hidden="true" tabindex="-1"></a>species.hel <span class="ot">&lt;-</span> <span class="fu">decostand</span>(species, <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb369-5"><a href="cap9.html#cb369-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-6"><a href="cap9.html#cb369-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 2: selecionar variáveis importantes.  Para isso, é necessário remover</span></span>
<span id="cb369-7"><a href="cap9.html#cb369-7" aria-hidden="true" tabindex="-1"></a><span class="do">## a variável categórica.</span></span>
<span id="cb369-8"><a href="cap9.html#cb369-8" aria-hidden="true" tabindex="-1"></a>env.contin <span class="ot">&lt;-</span> env[, <span class="sc">-</span><span class="dv">8</span>]</span>
<span id="cb369-9"><a href="cap9.html#cb369-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-10"><a href="cap9.html#cb369-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Evite usar variáveis muito correlacionadas</span></span>
<span id="cb369-11"><a href="cap9.html#cb369-11" aria-hidden="true" tabindex="-1"></a>sel.vars <span class="ot">&lt;-</span> <span class="fu">forward.sel</span>(species.hel, env.contin)</span>
<span id="cb369-12"><a href="cap9.html#cb369-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Testing variable 1</span></span>
<span id="cb369-13"><a href="cap9.html#cb369-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Testing variable 2</span></span>
<span id="cb369-14"><a href="cap9.html#cb369-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Testing variable 3</span></span>
<span id="cb369-15"><a href="cap9.html#cb369-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 3 is 0.219000 (&gt; 0.050000)</span></span>
<span id="cb369-16"><a href="cap9.html#cb369-16" aria-hidden="true" tabindex="-1"></a>sel.vars<span class="sc">$</span>variables</span>
<span id="cb369-17"><a href="cap9.html#cb369-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;rain.jul&quot; &quot;maxi.jul&quot;</span></span>
<span id="cb369-18"><a href="cap9.html#cb369-18" aria-hidden="true" tabindex="-1"></a>env.sel <span class="ot">&lt;-</span> env[, sel.vars<span class="sc">$</span>variables]</span>
<span id="cb369-19"><a href="cap9.html#cb369-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-20"><a href="cap9.html#cb369-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 3: padronizar matriz ambiental (somente variáveis contínuas)</span></span>
<span id="cb369-21"><a href="cap9.html#cb369-21" aria-hidden="true" tabindex="-1"></a>env.pad <span class="ot">&lt;-</span> <span class="fu">decostand</span>(env.sel, <span class="st">&quot;standardize&quot;</span>)</span>
<span id="cb369-22"><a href="cap9.html#cb369-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-23"><a href="cap9.html#cb369-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Matriz final com variáveis preditoras</span></span>
<span id="cb369-24"><a href="cap9.html#cb369-24" aria-hidden="true" tabindex="-1"></a>env.pad.cat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(env.pad, <span class="at">altitude =</span> env<span class="sc">$</span>altitude)</span></code></pre></div>
<p>Depois de selecionar um subconjunto dos dados com o método Forward Selection e padronizá-los (média 0 e desvio padrão 1), o modelo da RDA é construído como modelos lineares e PERMANOVA.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="cap9.html#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="do">## RDA com dados selecionados e padronizados</span></span>
<span id="cb370-2"><a href="cap9.html#cb370-2" aria-hidden="true" tabindex="-1"></a>rda.bird <span class="ot">&lt;-</span> <span class="fu">rda</span>(species.hel <span class="sc">~</span> rain.jul <span class="sc">+</span> maxi.jul <span class="sc">+</span> altitude, <span class="at">data =</span> env.pad.cat)</span>
<span id="cb370-3"><a href="cap9.html#cb370-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-4"><a href="cap9.html#cb370-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Para interpretar, é necessário saber a significância dos eixos para</span></span>
<span id="cb370-5"><a href="cap9.html#cb370-5" aria-hidden="true" tabindex="-1"></a><span class="co"># representar a relação entre as variáveis preditoras e a composição de</span></span>
<span id="cb370-6"><a href="cap9.html#cb370-6" aria-hidden="true" tabindex="-1"></a><span class="co"># espécies</span></span>
<span id="cb370-7"><a href="cap9.html#cb370-7" aria-hidden="true" tabindex="-1"></a>res.axis <span class="ot">&lt;-</span> <span class="fu">anova.cca</span>(rda.bird, <span class="at">by =</span> <span class="st">&quot;axis&quot;</span>)</span>
<span id="cb370-8"><a href="cap9.html#cb370-8" aria-hidden="true" tabindex="-1"></a>res.axis</span>
<span id="cb370-9"><a href="cap9.html#cb370-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for rda under reduced model</span></span>
<span id="cb370-10"><a href="cap9.html#cb370-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Forward tests for axes</span></span>
<span id="cb370-11"><a href="cap9.html#cb370-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb370-12"><a href="cap9.html#cb370-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb370-13"><a href="cap9.html#cb370-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb370-14"><a href="cap9.html#cb370-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span></span>
<span id="cb370-15"><a href="cap9.html#cb370-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df Variance       F Pr(&gt;F)    </span></span>
<span id="cb370-16"><a href="cap9.html#cb370-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA1      1 0.045759 12.0225  0.001 ***</span></span>
<span id="cb370-17"><a href="cap9.html#cb370-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA2      1 0.009992  2.6252  0.062 .  </span></span>
<span id="cb370-18"><a href="cap9.html#cb370-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA3      1 0.007518  1.9752  0.133    </span></span>
<span id="cb370-19"><a href="cap9.html#cb370-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA4      1 0.003582  0.9410  0.471    </span></span>
<span id="cb370-20"><a href="cap9.html#cb370-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 18 0.068510                   </span></span>
<span id="cb370-21"><a href="cap9.html#cb370-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb370-22"><a href="cap9.html#cb370-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb370-23"><a href="cap9.html#cb370-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-24"><a href="cap9.html#cb370-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Em seguida, é possível identificar quais são as variáveis que contribuem ou</span></span>
<span id="cb370-25"><a href="cap9.html#cb370-25" aria-hidden="true" tabindex="-1"></a><span class="co"># que mais contribuem para a variação na composição de espécies</span></span>
<span id="cb370-26"><a href="cap9.html#cb370-26" aria-hidden="true" tabindex="-1"></a>res.var <span class="ot">&lt;-</span> <span class="fu">anova.cca</span>(rda.bird, <span class="at">by =</span> <span class="st">&quot;term&quot;</span>)  <span class="do">## Qual variável?</span></span>
<span id="cb370-27"><a href="cap9.html#cb370-27" aria-hidden="true" tabindex="-1"></a>res.var</span>
<span id="cb370-28"><a href="cap9.html#cb370-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for rda under reduced model</span></span>
<span id="cb370-29"><a href="cap9.html#cb370-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb370-30"><a href="cap9.html#cb370-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb370-31"><a href="cap9.html#cb370-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb370-32"><a href="cap9.html#cb370-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb370-33"><a href="cap9.html#cb370-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span></span>
<span id="cb370-34"><a href="cap9.html#cb370-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df Variance      F Pr(&gt;F)    </span></span>
<span id="cb370-35"><a href="cap9.html#cb370-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jul  1 0.036514 9.5936  0.001 ***</span></span>
<span id="cb370-36"><a href="cap9.html#cb370-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jul  1 0.011264 2.9596  0.016 *  </span></span>
<span id="cb370-37"><a href="cap9.html#cb370-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; altitude  2 0.019071 2.5053  0.010 ** </span></span>
<span id="cb370-38"><a href="cap9.html#cb370-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 18 0.068510                  </span></span>
<span id="cb370-39"><a href="cap9.html#cb370-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb370-40"><a href="cap9.html#cb370-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb370-41"><a href="cap9.html#cb370-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-42"><a href="cap9.html#cb370-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Além disso, é possível obter o valor do R2 do modelo</span></span>
<span id="cb370-43"><a href="cap9.html#cb370-43" aria-hidden="true" tabindex="-1"></a>r_quadr <span class="ot">&lt;-</span> <span class="fu">RsquareAdj</span>(rda.bird)</span>
<span id="cb370-44"><a href="cap9.html#cb370-44" aria-hidden="true" tabindex="-1"></a>r_quadr</span>
<span id="cb370-45"><a href="cap9.html#cb370-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $r.squared</span></span>
<span id="cb370-46"><a href="cap9.html#cb370-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4938685</span></span>
<span id="cb370-47"><a href="cap9.html#cb370-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb370-48"><a href="cap9.html#cb370-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $adj.r.squared</span></span>
<span id="cb370-49"><a href="cap9.html#cb370-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3813949</span></span>
<span id="cb370-50"><a href="cap9.html#cb370-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-51"><a href="cap9.html#cb370-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenação multi-escala (MSO) para entender os resultados da ordenação em</span></span>
<span id="cb370-52"><a href="cap9.html#cb370-52" aria-hidden="true" tabindex="-1"></a><span class="co"># relação à distância geográfica</span></span>
<span id="cb370-53"><a href="cap9.html#cb370-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-54"><a href="cap9.html#cb370-54" aria-hidden="true" tabindex="-1"></a>bird.rda <span class="ot">&lt;-</span> <span class="fu">mso</span>(rda.bird, xy, <span class="at">grain =</span> <span class="dv">1</span>, <span class="at">permutations =</span> <span class="dv">99</span>)</span>
<span id="cb370-55"><a href="cap9.html#cb370-55" aria-hidden="true" tabindex="-1"></a><span class="fu">msoplot</span>(bird.rda)</span>
<span id="cb370-56"><a href="cap9.html#cb370-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error variance of regression model underestimated by -2 percent</span></span>
<span id="cb370-57"><a href="cap9.html#cb370-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-58"><a href="cap9.html#cb370-58" aria-hidden="true" tabindex="-1"></a><span class="do">## Triplot da RDA</span></span>
<span id="cb370-59"><a href="cap9.html#cb370-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-60"><a href="cap9.html#cb370-60" aria-hidden="true" tabindex="-1"></a><span class="fu">ggord</span>(rda.bird, <span class="at">ptslab =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">addsize =</span> <span class="dv">3</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb370-61"><a href="cap9.html#cb370-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb370-62"><a href="cap9.html#cb370-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb370-63"><a href="cap9.html#cb370-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">12</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb370-64"><a href="cap9.html#cb370-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-382-1.png" width="100%" height="100%" style="display: block; margin: auto;" /><img src="livro_files/figure-html/unnamed-chunk-382-2.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="interpretação-dos-resultados-8" class="section level4" number="10.7.1.2">
<h4><span class="header-section-number">10.7.1.2</span> Interpretação dos resultados</h4>
<p>Os objetos <code>res.axis</code>, <code>res.var</code> e <code>r_quadr</code> mostram, respectivamente, (i) as dimensões (RDA1, RDA2, etc.) que possuem variação na composição de espécies, (ii) as variáveis preditoras que explicam esta variação, e (iii) o valor do <em>R<sup>2</sup></em> ajustado. Neste exemplo, podemos observar que somente a dimensão 1 (RDA1) representa uma variação significativa da composição de espécies (<strong>P</strong> = 0,001). As variáveis <em>rain.jul</em>, <em>maxi.jul</em> e <em>altitude</em> foram todas preditoras importantes da composição de espécies, mas <em>rain.jul</em> se destacada com maior valor de <strong>F</strong>. Além disso, o valor do <em>R<sup>2</sup></em> ajustado de 0.381 indica forte contribuição dessas variáveis preditoras. Porém, uma das limitações desta análise é não considerar que tanto espécies quanto variáveis preditoras podem estar estruturadas espacialmente. Como resultado, os resíduos da análises podem apresentar autocorrelação espacial que, por sua vez, aumenta o erro do tipo I <span class="citation">(<a href="#ref-numerica2012" role="doc-biblioref"><strong>numerica2012?</strong></a>)</span>. A figura obtida com o comando <code>msoplot(bird.rda)</code> demonstra que existe autocorrelação espacial em algumas distâncias da análise. Veja abaixo algumas alternativas para resíduos com autocorrelação espacial.</p>
</div>
</div>
<div id="rdap-análise-de-redundância-parcial" class="section level3" number="10.7.2">
<h3><span class="header-section-number">10.7.2</span> RDAp: Análise de Redundância parcial</h3>
<p>Um dos problemas da abordagem anterior é que tanto a composição de espécies como as variáveis ambientais estão estruturadas espacialmente. Talvez mais importantes, para que os valores de probabilidade da RDA sejam interpretados corretamente (e para evitar erro do tipo I), os resíduos do modelo não devem estar correlacionados espacialmente, como demonstrado com a análise MSO. Uma alternativa é de incluir a matriz de dados espaciais (matrix W) como valor condicional dentro da RDA. Esta análise é conhecida como RDA parcial.</p>
<p>Porém, a obtenção dos dados espaciais da matriz W é mais complexo do que simplesmente incluir dados de localização geográfica (latitude e longitude), como feito em alguns modelos lineares (e.g., gls, Capítulo <a href="cap7.html#cap7">8</a>). Existem diversas ferramentas que descrevem e incorporam o componente espacial em métodos mulitidimensionais, mas os Mapas de autovetores de Moran (MEM) são certamente os mais utilizados <span class="citation">(<a href="#ref-dray_community_2012" role="doc-biblioref">Dray et al., 2012</a>)</span>. A análise MEM consiste na ordenação (PCoA) de uma matriz truncada obtida através da localização geográfica das localidades utilizando distância euclidiana, matriz de conectividade e matriz espacial ponderada. Os autovalores obtidos no MEM são idênticos aos coeficientes de correlação espacial de Moran <em>I</em>. Um procedimento chave desta análise é a definição de um limiar de trucamento (do inglês <em>truncate threshold</em>). Este limiar é calculado a partir de uma “árvore de espaço mínimo” (MST, do inglês <em>minimum spanning tree</em>) que conecta todos os pontos de coleta. Na prática, os valores menores do que o limiar definido pela MST indicam que os pontos com aqueles valores estão conectados e, assim possuem correlação positiva. Outro ponto importante desta análise é a obtenção da matriz espacial ponderada (SWM, do inglês <em>spatial weighthing matrix</em>). A seleção da matriz SWM é parte essencial do cálculo dos MEM e não deve ser feita arbitratiamente <span class="citation">(<a href="#ref-bauman_optimizing_2018" role="doc-biblioref">Bauman, Drouet, Fortin, et al., 2018</a>)</span>. Por este motivo a análise recebe este nome <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. Finalmente, o método produz autovetores que representam preditores espaciais que podem ser utilizados na RDA parcial (e outras análises). É importante ressaltar que o critério de seleção do número de autovetores é bastante debatido na literatura e, para isso, sugerimos a leitura dos seguintes artigos <span class="citation"><a href="#ref-bauman_disentangling_2018" role="doc-biblioref">Bauman, Drouet, Dray, et al.</a> (<a href="#ref-bauman_disentangling_2018" role="doc-biblioref">2018</a>)</span>.</p>
<p>Então, o primeiro passo para realizar uma RDA parcial é de gerar os autovetores espaciais (MEMs).</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="cap9.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados matriz padronizada de composição de espécies.</span></span>
<span id="cb371-2"><a href="cap9.html#cb371-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(species.hel)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb371-3"><a href="cap9.html#cb371-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Fauvette_orphee Fauvette_des_jardins Fauvette_a_tete_noire Fauvette_babillarde Fauvette_grisette</span></span>
<span id="cb371-4"><a href="cap9.html#cb371-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S01               0            0.3651484             0.3651484           0.2581989         0.2581989</span></span>
<span id="cb371-5"><a href="cap9.html#cb371-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S02               0            0.3333333             0.3333333           0.2357023         0.2357023</span></span>
<span id="cb371-6"><a href="cap9.html#cb371-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S03               0            0.3162278             0.3162278           0.3162278         0.2236068</span></span>
<span id="cb371-7"><a href="cap9.html#cb371-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S04               0            0.4200840             0.3429972           0.2425356         0.0000000</span></span>
<span id="cb371-8"><a href="cap9.html#cb371-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S05               0            0.3872983             0.3162278           0.2236068         0.3162278</span></span>
<span id="cb371-9"><a href="cap9.html#cb371-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S06               0            0.3779645             0.3779645           0.2672612         0.0000000</span></span>
<span id="cb371-10"><a href="cap9.html#cb371-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Fauvette_pitchou</span></span>
<span id="cb371-11"><a href="cap9.html#cb371-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S01                0</span></span>
<span id="cb371-12"><a href="cap9.html#cb371-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S02                0</span></span>
<span id="cb371-13"><a href="cap9.html#cb371-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S03                0</span></span>
<span id="cb371-14"><a href="cap9.html#cb371-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S04                0</span></span>
<span id="cb371-15"><a href="cap9.html#cb371-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S05                0</span></span>
<span id="cb371-16"><a href="cap9.html#cb371-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S06                0</span></span>
<span id="cb371-17"><a href="cap9.html#cb371-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-18"><a href="cap9.html#cb371-18" aria-hidden="true" tabindex="-1"></a><span class="co"># latitude e longitude.</span></span>
<span id="cb371-19"><a href="cap9.html#cb371-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy)</span>
<span id="cb371-20"><a href="cap9.html#cb371-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       x   y</span></span>
<span id="cb371-21"><a href="cap9.html#cb371-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S01 156 252</span></span>
<span id="cb371-22"><a href="cap9.html#cb371-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S02 141 217</span></span>
<span id="cb371-23"><a href="cap9.html#cb371-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S03 171 233</span></span>
<span id="cb371-24"><a href="cap9.html#cb371-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S04 178 215</span></span>
<span id="cb371-25"><a href="cap9.html#cb371-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S05 123 189</span></span>
<span id="cb371-26"><a href="cap9.html#cb371-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S06 154 195</span></span>
<span id="cb371-27"><a href="cap9.html#cb371-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-28"><a href="cap9.html#cb371-28" aria-hidden="true" tabindex="-1"></a><span class="co"># dados ambientais padronizados e altitude</span></span>
<span id="cb371-29"><a href="cap9.html#cb371-29" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(env.pad.cat)</span>
<span id="cb371-30"><a href="cap9.html#cb371-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     rain.jul   maxi.jul      altitude</span></span>
<span id="cb371-31"><a href="cap9.html#cb371-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S01 1.333646  0.1462557    Montanhoso</span></span>
<span id="cb371-32"><a href="cap9.html#cb371-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S02 1.468827 -0.6848206 Intermediário</span></span>
<span id="cb371-33"><a href="cap9.html#cb371-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S03 1.505694 -0.2099199    Montanhoso</span></span>
<span id="cb371-34"><a href="cap9.html#cb371-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S04 1.296778 -2.0699476    Montanhoso</span></span>
<span id="cb371-35"><a href="cap9.html#cb371-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S05 1.075572 -0.3682201         Plano</span></span>
<span id="cb371-36"><a href="cap9.html#cb371-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S06 1.100151 -0.6056705 Intermediário</span></span>
<span id="cb371-37"><a href="cap9.html#cb371-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-38"><a href="cap9.html#cb371-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 1: Gerar um arquivo LIST W: list binária de vizinhança</span></span>
<span id="cb371-39"><a href="cap9.html#cb371-39" aria-hidden="true" tabindex="-1"></a>mat_knn <span class="ot">&lt;-</span> <span class="fu">knearneigh</span>(<span class="fu">as.matrix</span>(xy), <span class="at">k =</span> <span class="dv">2</span>, <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb371-40"><a href="cap9.html#cb371-40" aria-hidden="true" tabindex="-1"></a>mat_nb <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(mat_knn, <span class="at">sym =</span> <span class="cn">TRUE</span>)</span>
<span id="cb371-41"><a href="cap9.html#cb371-41" aria-hidden="true" tabindex="-1"></a>mat_listw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(mat_nb, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb371-42"><a href="cap9.html#cb371-42" aria-hidden="true" tabindex="-1"></a>mat_listw</span>
<span id="cb371-43"><a href="cap9.html#cb371-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Characteristics of weights list object:</span></span>
<span id="cb371-44"><a href="cap9.html#cb371-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Neighbour list object:</span></span>
<span id="cb371-45"><a href="cap9.html#cb371-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of regions: 23 </span></span>
<span id="cb371-46"><a href="cap9.html#cb371-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of nonzero links: 58 </span></span>
<span id="cb371-47"><a href="cap9.html#cb371-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Percentage nonzero weights: 10.96408 </span></span>
<span id="cb371-48"><a href="cap9.html#cb371-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Average number of links: 2.521739 </span></span>
<span id="cb371-49"><a href="cap9.html#cb371-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb371-50"><a href="cap9.html#cb371-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Weights style: W </span></span>
<span id="cb371-51"><a href="cap9.html#cb371-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Weights constants summary:</span></span>
<span id="cb371-52"><a href="cap9.html#cb371-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    n  nn S0       S1       S2</span></span>
<span id="cb371-53"><a href="cap9.html#cb371-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; W 23 529 23 18.84444 96.01111</span></span>
<span id="cb371-54"><a href="cap9.html#cb371-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-55"><a href="cap9.html#cb371-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 2: Listar os métodos &#39;candidatos&#39; para obter a matriz SWM</span></span>
<span id="cb371-56"><a href="cap9.html#cb371-56" aria-hidden="true" tabindex="-1"></a>MEM_mat <span class="ot">&lt;-</span> <span class="fu">scores.listw</span>(mat_listw, <span class="at">MEM.autocor =</span> <span class="st">&quot;positive&quot;</span>)</span>
<span id="cb371-57"><a href="cap9.html#cb371-57" aria-hidden="true" tabindex="-1"></a>candidates <span class="ot">&lt;-</span> <span class="fu">listw.candidates</span>(xy, <span class="at">nb =</span> <span class="fu">c</span>(<span class="st">&quot;gab&quot;</span>, <span class="st">&quot;mst&quot;</span>, <span class="st">&quot;dnear&quot;</span>), <span class="at">weights =</span> <span class="fu">c</span>(<span class="st">&quot;binary&quot;</span>,</span>
<span id="cb371-58"><a href="cap9.html#cb371-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;flin&quot;</span>))</span>
<span id="cb371-59"><a href="cap9.html#cb371-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-60"><a href="cap9.html#cb371-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 3: Selecionar a melhor matriz SWM e executar o MEM</span></span>
<span id="cb371-61"><a href="cap9.html#cb371-61" aria-hidden="true" tabindex="-1"></a>W_sel_mat <span class="ot">&lt;-</span> <span class="fu">listw.select</span>(species.hel, candidates, <span class="at">MEM.autocor =</span> <span class="st">&quot;positive&quot;</span>, <span class="at">p.adjust =</span> <span class="cn">TRUE</span>,</span>
<span id="cb371-62"><a href="cap9.html#cb371-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;FWD&quot;</span>)</span>
<span id="cb371-63"><a href="cap9.html#cb371-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 5 is 0.088000 (&gt; 0.050000)</span></span>
<span id="cb371-64"><a href="cap9.html#cb371-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 3 is 0.064000 (&gt; 0.050000)</span></span>
<span id="cb371-65"><a href="cap9.html#cb371-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 3 is 0.061000 (&gt; 0.050000)</span></span>
<span id="cb371-66"><a href="cap9.html#cb371-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 4 is 0.159000 (&gt; 0.050000)</span></span>
<span id="cb371-67"><a href="cap9.html#cb371-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-68"><a href="cap9.html#cb371-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Passo 4: Matriz dos preditores espaciais escolhidos (MEMs)</span></span>
<span id="cb371-69"><a href="cap9.html#cb371-69" aria-hidden="true" tabindex="-1"></a>spatial.pred <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(W_sel_mat<span class="sc">$</span>best<span class="sc">$</span>MEM.select)</span>
<span id="cb371-70"><a href="cap9.html#cb371-70" aria-hidden="true" tabindex="-1"></a><span class="co"># necessário atribuir os nomes das linhas</span></span>
<span id="cb371-71"><a href="cap9.html#cb371-71" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(spatial.pred) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(xy)</span></code></pre></div>
<p>Depois de gerar os valores dos autovetores espaciais (MEM), é possível executar a a RDA parcial utilizando esses valores no argumento ‘Conditional.’</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="cap9.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Combinar variáveis ambientais e espaciais em um único data.frame</span></span>
<span id="cb372-2"><a href="cap9.html#cb372-2" aria-hidden="true" tabindex="-1"></a>pred.vars <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(env.pad.cat, spatial.pred)</span>
<span id="cb372-3"><a href="cap9.html#cb372-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-4"><a href="cap9.html#cb372-4" aria-hidden="true" tabindex="-1"></a><span class="do">## RDA parcial</span></span>
<span id="cb372-5"><a href="cap9.html#cb372-5" aria-hidden="true" tabindex="-1"></a>rda.p <span class="ot">&lt;-</span> <span class="fu">rda</span>(species.hel <span class="sc">~</span></span>
<span id="cb372-6"><a href="cap9.html#cb372-6" aria-hidden="true" tabindex="-1"></a>             rain.jul <span class="sc">+</span> maxi.jul <span class="sc">+</span> altitude <span class="sc">+</span> <span class="co"># Preditores ambientais</span></span>
<span id="cb372-7"><a href="cap9.html#cb372-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Condition</span>(MEM1<span class="sc">+</span>MEM2<span class="sc">+</span>MEM4<span class="sc">+</span>MEM5), <span class="co"># Preditores espaciais</span></span>
<span id="cb372-8"><a href="cap9.html#cb372-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> pred.vars)</span>
<span id="cb372-9"><a href="cap9.html#cb372-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-10"><a href="cap9.html#cb372-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Para interpretar, é necessário saber a significância dos eixos para representar a relação entre as variáveis preditoras e a composição de espécies</span></span>
<span id="cb372-11"><a href="cap9.html#cb372-11" aria-hidden="true" tabindex="-1"></a>res.p.axis <span class="ot">&lt;-</span> <span class="fu">anova.cca</span>(rda.p, <span class="at">by=</span><span class="st">&quot;axis&quot;</span>) </span>
<span id="cb372-12"><a href="cap9.html#cb372-12" aria-hidden="true" tabindex="-1"></a>res.p.axis</span>
<span id="cb372-13"><a href="cap9.html#cb372-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for rda under reduced model</span></span>
<span id="cb372-14"><a href="cap9.html#cb372-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Forward tests for axes</span></span>
<span id="cb372-15"><a href="cap9.html#cb372-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb372-16"><a href="cap9.html#cb372-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb372-17"><a href="cap9.html#cb372-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb372-18"><a href="cap9.html#cb372-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude + Condition(MEM1 + MEM2 + MEM4 + MEM5), data = pred.vars)</span></span>
<span id="cb372-19"><a href="cap9.html#cb372-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df Variance      F Pr(&gt;F)</span></span>
<span id="cb372-20"><a href="cap9.html#cb372-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA1      1 0.008471 2.1376  0.312</span></span>
<span id="cb372-21"><a href="cap9.html#cb372-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA2      1 0.004830 1.2189  0.782</span></span>
<span id="cb372-22"><a href="cap9.html#cb372-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA3      1 0.003240 0.8176  0.892</span></span>
<span id="cb372-23"><a href="cap9.html#cb372-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA4      1 0.001891 0.4773  0.902</span></span>
<span id="cb372-24"><a href="cap9.html#cb372-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 14 0.055477</span></span>
<span id="cb372-25"><a href="cap9.html#cb372-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-26"><a href="cap9.html#cb372-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Em seguida, é possível identificar quais são as variáveis que contribuem ou que mais contribuem para a variação na composição de espécies </span></span>
<span id="cb372-27"><a href="cap9.html#cb372-27" aria-hidden="true" tabindex="-1"></a>res.p.var <span class="ot">&lt;-</span> <span class="fu">anova.cca</span>(rda.p, <span class="at">by=</span><span class="st">&quot;term&quot;</span>) <span class="do">## Qual variável?</span></span>
<span id="cb372-28"><a href="cap9.html#cb372-28" aria-hidden="true" tabindex="-1"></a>res.p.var</span>
<span id="cb372-29"><a href="cap9.html#cb372-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for rda under reduced model</span></span>
<span id="cb372-30"><a href="cap9.html#cb372-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb372-31"><a href="cap9.html#cb372-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb372-32"><a href="cap9.html#cb372-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb372-33"><a href="cap9.html#cb372-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb372-34"><a href="cap9.html#cb372-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude + Condition(MEM1 + MEM2 + MEM4 + MEM5), data = pred.vars)</span></span>
<span id="cb372-35"><a href="cap9.html#cb372-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df Variance      F Pr(&gt;F)</span></span>
<span id="cb372-36"><a href="cap9.html#cb372-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jul  1 0.004406 1.1119  0.340</span></span>
<span id="cb372-37"><a href="cap9.html#cb372-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jul  1 0.004446 1.1220  0.337</span></span>
<span id="cb372-38"><a href="cap9.html#cb372-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; altitude  2 0.009579 1.2087  0.238</span></span>
<span id="cb372-39"><a href="cap9.html#cb372-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 14 0.055477</span></span>
<span id="cb372-40"><a href="cap9.html#cb372-40" aria-hidden="true" tabindex="-1"></a><span class="fu">RsquareAdj</span>(rda.p)</span>
<span id="cb372-41"><a href="cap9.html#cb372-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $r.squared</span></span>
<span id="cb372-42"><a href="cap9.html#cb372-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.1361661</span></span>
<span id="cb372-43"><a href="cap9.html#cb372-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb372-44"><a href="cap9.html#cb372-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $adj.r.squared</span></span>
<span id="cb372-45"><a href="cap9.html#cb372-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.02330319</span></span></code></pre></div>
<p>Se você comparar os resultados do objeto res.p.var (RDA parcial) com res.var (RDA simples) é possível perceber como a estrutura espacial nos resíduos aumenta a probabilidade de cometer erro do tipo 1. O modelo da RDA parcial mostra que não existem qualquer efeito direto das variáveis ambientais sobre a composição de espécies (conclusão com a RDA simples). Na verdade, tanto a composição de espécies quanto as variáveis climáticas estão fortemente estruturadas no espaço, como demonstramos a seguir:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="cap9.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Padrão espacial na composição de espécies</span></span>
<span id="cb373-2"><a href="cap9.html#cb373-2" aria-hidden="true" tabindex="-1"></a>pca.comp <span class="ot">&lt;-</span> <span class="fu">dudi.pca</span>(species.hel, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">scannf =</span> <span class="cn">FALSE</span>)</span>
<span id="cb373-3"><a href="cap9.html#cb373-3" aria-hidden="true" tabindex="-1"></a>moran.comp <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(pca.comp<span class="sc">$</span>li[, <span class="dv">1</span>], mat_listw, <span class="dv">999</span>)</span>
<span id="cb373-4"><a href="cap9.html#cb373-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-5"><a href="cap9.html#cb373-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Padrão espacial das variáveis ambientais</span></span>
<span id="cb373-6"><a href="cap9.html#cb373-6" aria-hidden="true" tabindex="-1"></a>env<span class="sc">$</span>altitude <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(env<span class="sc">$</span>altitude)</span>
<span id="cb373-7"><a href="cap9.html#cb373-7" aria-hidden="true" tabindex="-1"></a>ca.env <span class="ot">&lt;-</span> <span class="fu">dudi.hillsmith</span>(env, <span class="at">scannf =</span> <span class="cn">FALSE</span>)</span>
<span id="cb373-8"><a href="cap9.html#cb373-8" aria-hidden="true" tabindex="-1"></a>moran.env <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(ca.env<span class="sc">$</span>li[, <span class="dv">1</span>], mat_listw, <span class="dv">999</span>)</span>
<span id="cb373-9"><a href="cap9.html#cb373-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-10"><a href="cap9.html#cb373-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Estrutura espacial na composição de espécies?</span></span>
<span id="cb373-11"><a href="cap9.html#cb373-11" aria-hidden="true" tabindex="-1"></a>moran.comp</span>
<span id="cb373-12"><a href="cap9.html#cb373-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb373-13"><a href="cap9.html#cb373-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Monte-Carlo simulation of Moran I</span></span>
<span id="cb373-14"><a href="cap9.html#cb373-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb373-15"><a href="cap9.html#cb373-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  pca.comp$li[, 1] </span></span>
<span id="cb373-16"><a href="cap9.html#cb373-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; weights: mat_listw  </span></span>
<span id="cb373-17"><a href="cap9.html#cb373-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; number of simulations + 1: 1000 </span></span>
<span id="cb373-18"><a href="cap9.html#cb373-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb373-19"><a href="cap9.html#cb373-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; statistic = 0.62815, observed rank = 1000, p-value = 0.001</span></span>
<span id="cb373-20"><a href="cap9.html#cb373-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: greater</span></span>
<span id="cb373-21"><a href="cap9.html#cb373-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Estrutura espacial na variação ambiental?</span></span>
<span id="cb373-22"><a href="cap9.html#cb373-22" aria-hidden="true" tabindex="-1"></a>moran.env</span>
<span id="cb373-23"><a href="cap9.html#cb373-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb373-24"><a href="cap9.html#cb373-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Monte-Carlo simulation of Moran I</span></span>
<span id="cb373-25"><a href="cap9.html#cb373-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb373-26"><a href="cap9.html#cb373-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ca.env$li[, 1] </span></span>
<span id="cb373-27"><a href="cap9.html#cb373-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; weights: mat_listw  </span></span>
<span id="cb373-28"><a href="cap9.html#cb373-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; number of simulations + 1: 1000 </span></span>
<span id="cb373-29"><a href="cap9.html#cb373-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb373-30"><a href="cap9.html#cb373-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; statistic = 0.72714, observed rank = 1000, p-value = 0.001</span></span>
<span id="cb373-31"><a href="cap9.html#cb373-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: greater</span></span></code></pre></div>
<p>Como resultado, é possível que a variação ambiental espacialmente estruturada é o principal efeito sobre a composição de espécies. Uma maneira de visualizar a contribuição relativa de diferentes matrizes (ambiental e espacial, por exemplo) é utilizar o método de partição de variância. O resultado deste modelo indica que, de fato, não existe efeito direto das variáveis ambientais e sim do componente representado pela autocorrelação espacial dessas variáveis.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="cap9.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Partição de variância</span></span>
<span id="cb374-2"><a href="cap9.html#cb374-2" aria-hidden="true" tabindex="-1"></a>pv.birds <span class="ot">&lt;-</span> <span class="fu">varpart</span>(species.hel, env.pad.cat, spatial.pred)</span>
<span id="cb374-3"><a href="cap9.html#cb374-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pv.birds)</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-386-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="permanova" class="section level2" number="10.8">
<h2><span class="header-section-number">10.8</span> PERMANOVA</h2>
<p>A PERMANOVA é um acrônimo, em inglês, de <em>permutational multivariate analysis of variance</em>, análise proposta por Anderson <span class="citation">(<a href="#ref-anderson_new_2001" role="doc-biblioref">M. J. Anderson, 2001</a>)</span>. A PERMANOVA é usada para testar hipóteses multivariadas que comparam a abundância de diferentes espécies em resposta a diferentes tratamentos ou gradientes ambientais. Esta análise foi desenvolvida como forma de solucionar algumas limitações da tradicional ANOVA multivariada (MANOVA). Em especial, o pressuposto da MANOVA de distribuição normal multivariada é raramente encontrado em dados ecológicos.</p>
<p>O primeiro passo da PERMANOVA é selecionar uma medida de distância apropriada aos dados e, além disso, verificar a necessidade de padronização ou transformação dos dados. Em seguida, as distâncias são comparadas entre os grupos de interesse (por exemplo, tratamento vs. controle) usando a estatística <em>F</em> de maneira muito parecida com uma ANOVA (Capítulo <a href="cap7.html#cap7">8</a>), chamada de <em>pseudo-F</em>:</p>
<p><span class="math display">\[
F = (SSa / SSr)*[(N-g) / (g-1)]
\]</span></p>
<p>onde <em>SSa</em> representa a soma dos quadrados entre grupos, <em>SSr</em> a soma de quadrados dentro do grupo (residual), <em>N</em> o número de unidades amostrais e <em>g</em> os grupos (ou níveis da variável categórica). Esta fórmula do <em>pseudo-F</em> é específica para desenho experimental com um fator. Outros desenhos mais complexos são apresetandos em Anderson [<span class="citation">(<a href="#ref-anderson_new_2001" role="doc-biblioref">2001</a>)</span>; <span class="citation">(<a href="#ref-anderson_permutational_2017" role="doc-biblioref">2017</a>)</span>. O cálculo do valor de probilidade é realizado por métodos de permutação que são discutidos em Anderson &amp; Ter Braak <span class="citation">(<a href="#ref-anderson_permutation_2003" role="doc-biblioref">2003</a>)</span>.</p>
<div id="exemplo-1-8" class="section level4" number="10.8.0.1">
<h4><span class="header-section-number">10.8.0.1</span> Exemplo 1</h4>
<p>Espécies de aves que ocorrem em localidades com diferentes altitudes.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>O clima e a altitude modificam a composição de espécies de aves?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Diferenças climáticas (temperatura e chuva) e altitudinais alteram a composição de espécies de aves.</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li><p>Preditoras: Temperatura e chuva (contínuas) e altitude (categórica com três níveis)</p></li>
<li><p>Dependente: composição de espécies de aves</p></li>
</ul>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="cap9.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Composição de espécies padronizar com método de Hellinger</span></span>
<span id="cb375-2"><a href="cap9.html#cb375-2" aria-hidden="true" tabindex="-1"></a>species.hel <span class="ot">&lt;-</span> <span class="fu">decostand</span>(species, <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb375-3"><a href="cap9.html#cb375-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4"><a href="cap9.html#cb375-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distância com método Bray Curtis</span></span>
<span id="cb375-5"><a href="cap9.html#cb375-5" aria-hidden="true" tabindex="-1"></a>sps.dis <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(species.hel, <span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
<p>Para reduzir o número de variáveis no modelo, você pode considerar duas abordangens. A primeira, e mais importante delas, é manter somente variáveis preditoras que você tenha razão biológica para mantê-la e, além disso, que esteja relacionada com suas hipóteses. Assim, uma vez que você já removeu variáveis que não tem relevância biológica, você deve usar diferentes métodos para remover as variáveis muito correlacionadas (<em>forward selection</em>, <em>Variance Inflation Factor (VIF)</em>, entre outros). Neste exemplo, vamos simplesmente fazer uma correlação múltipla e remover as variáveis com correlação maior do que 0.9 ou -0.9. A função ggpairs mostra um gráfico bem didático para representa a relação entre todas as variáveis e o valor (r) desta correlação.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="cap9.html#cb376-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-2"><a href="cap9.html#cb376-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Verifica correlação entre as variáveis</span></span>
<span id="cb376-3"><a href="cap9.html#cb376-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(env)</span>
<span id="cb376-4"><a href="cap9.html#cb376-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-5"><a href="cap9.html#cb376-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Após verificar a estrutura de correlação, vamos manter somente três</span></span>
<span id="cb376-6"><a href="cap9.html#cb376-6" aria-hidden="true" tabindex="-1"></a><span class="co"># #variáveis</span></span>
<span id="cb376-7"><a href="cap9.html#cb376-7" aria-hidden="true" tabindex="-1"></a>env2 <span class="ot">&lt;-</span> env[, <span class="fu">c</span>(<span class="st">&quot;mini.jan&quot;</span>, <span class="st">&quot;rain.tot&quot;</span>, <span class="st">&quot;altitude&quot;</span>)]</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-388-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>Após selecionar as variáveis do modelo, vamos executar a PERMANOVA e entender as principais etapas para interpretar corretamente o teste. A função adonis do pacote vegan é a melhor opção no vegan. Porém, é importante referir o programa PRIMER e PERMANOVA+ como ótima opção para implementar a PERMANOVA e ter maior controle em desenhos complexos <span class="citation">(<a href="#ref-anderson_permanova+_2008" role="doc-biblioref">M. J. Anderson et al., 2008</a>)</span>. Assim como nos modelos lineares apresentados no Capítulo <a href="cap7.html#cap7">8</a>, os argumento seguem o mesmo formato, com variável dependente separada por um “~” das variáveis preditoras. Porém, alguns autores demonstraram que a PERMANOVA (assim como Mantel e ANOSIM) não pode identificar se diferenças significativas do teste (usando a estatística <em>pseudo-F</em>) se devem a diferenças no posição, na dispersão ou ambos. Ou seja, ao comparar grupos não é possível identificar se existe mudanças de composição (posição) ou a variação da composição de espécies dentro de um grupo (dispersão) é maior do que a variação dentro do outro grupo <span class="citation">(<a href="#ref-anderson_permanova_2013" role="doc-biblioref">M. J. Anderson &amp; Walsh, 2013</a>)</span>. Para solucionar este problema, é possível combinar a PERMANOVA com a análise PERMDISP (ou BETADISPER, como chamado no pacote vegan). Esta análise permite comparar se existe heterogeneidade nas variâncias entre grupos. Deste modo, a presença de heterogeneidade de variâncias (valor do BETADISPER significativo), é possível saber que as diferenças entre os grupos ocorre principalmente por diferenças na dispersão e não, necessariamente, de posição. Mais detalhes sobre a relevância de combinar essas duas análises estão disponíveis em Anderson &amp; Walsh <span class="citation">(<a href="#ref-anderson_permanova_2013" role="doc-biblioref">2013</a>)</span>.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="cap9.html#cb377-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-2"><a href="cap9.html#cb377-2" aria-hidden="true" tabindex="-1"></a>perm.aves <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(sps.dis <span class="sc">~</span> mini.jan <span class="sc">+</span> rain.tot <span class="sc">+</span> altitude, <span class="at">data =</span> env2)</span>
<span id="cb377-3"><a href="cap9.html#cb377-3" aria-hidden="true" tabindex="-1"></a>perm.aves  <span class="do">### Diferenças entre os tratamentos?</span></span>
<span id="cb377-4"><a href="cap9.html#cb377-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for adonis under reduced model</span></span>
<span id="cb377-5"><a href="cap9.html#cb377-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb377-6"><a href="cap9.html#cb377-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb377-7"><a href="cap9.html#cb377-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb377-8"><a href="cap9.html#cb377-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb377-9"><a href="cap9.html#cb377-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; adonis2(formula = sps.dis ~ mini.jan + rain.tot + altitude, data = env2)</span></span>
<span id="cb377-10"><a href="cap9.html#cb377-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df SumOfSqs      R2      F Pr(&gt;F)    </span></span>
<span id="cb377-11"><a href="cap9.html#cb377-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jan  1  0.09069 0.15997 6.3307  0.001 ***</span></span>
<span id="cb377-12"><a href="cap9.html#cb377-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.tot  1  0.12910 0.22771 9.0118  0.001 ***</span></span>
<span id="cb377-13"><a href="cap9.html#cb377-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; altitude  2  0.08929 0.15749 3.1163  0.021 *  </span></span>
<span id="cb377-14"><a href="cap9.html#cb377-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 18  0.25787 0.45483                  </span></span>
<span id="cb377-15"><a href="cap9.html#cb377-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total    22  0.56695 1.00000                  </span></span>
<span id="cb377-16"><a href="cap9.html#cb377-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb377-17"><a href="cap9.html#cb377-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb377-18"><a href="cap9.html#cb377-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-19"><a href="cap9.html#cb377-19" aria-hidden="true" tabindex="-1"></a>betad.aves <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(sps.dis, env2<span class="sc">$</span>altitude)</span>
<span id="cb377-20"><a href="cap9.html#cb377-20" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betad.aves)</span>
<span id="cb377-21"><a href="cap9.html#cb377-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb377-22"><a href="cap9.html#cb377-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for homogeneity of multivariate dispersions</span></span>
<span id="cb377-23"><a href="cap9.html#cb377-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb377-24"><a href="cap9.html#cb377-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb377-25"><a href="cap9.html#cb377-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb377-26"><a href="cap9.html#cb377-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: Distances</span></span>
<span id="cb377-27"><a href="cap9.html#cb377-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Df    Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)</span></span>
<span id="cb377-28"><a href="cap9.html#cb377-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Groups     2 0.0042643 0.0021322 1.4672    999  0.247</span></span>
<span id="cb377-29"><a href="cap9.html#cb377-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals 20 0.0290636 0.0014532</span></span></code></pre></div>
<p>Em nosso exemplo, temperatura, chuva e altitude afetaram a variação na composição de espécies. Porém, para identificar se as diferenças de composição entre os níveis da variável altitude, é necessário interpretar os resultados da análise BETADISPER. O comando permutest(betad.aves) mostra que o valor de probabilidade da análise foi de 0.253, ou seja, a hipótese nula de que a variância entre grupos é homogênea é aceita. Assim, não existe diferenças na dispersão entre grupo, sugerindo que a diferença encontrada na PERMANOVA (objeto perm.aves) se deve, em parte, a mudança na composição de espécies de aves entre diferentes altitudes (R<sup>2</sup> = 0.135). Além disso, a chuva (R<sup>2</sup> = 0.183) e temperatura (R<sup>2</sup> = 0.127) foram fatores importantes na variação da composição de espécies.</p>
<p>Como falado anteriormente, as análises de ordenação irrestritas (PCA, PCoA, nMDS) são utilizadas para explorar dados. Uma maneira poderosa de usá-las é combinando com análises que testam hipóteses, como PERMANOVA e RDA (abaixo). A literatura ecológica tem usado a análise de escalonamento não métrico (nMDS) combinado com análises multidimensionais de variância (como a PERMANOVA) para visualização da similaridade na composição de espécies dentro e entre grupos. A seguir, implementamos o nMDS na matriz de composição de espécies de ácaros.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="cap9.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distância representando a variação na composição de espécies</span></span>
<span id="cb378-2"><a href="cap9.html#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (método Bray-Curtis)</span></span>
<span id="cb378-3"><a href="cap9.html#cb378-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(sps.dis)[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb378-4"><a href="cap9.html#cb378-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           S01        S02        S03       S04       S05       S06</span></span>
<span id="cb378-5"><a href="cap9.html#cb378-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S01 0.0000000 0.15133734 0.16720405 0.2559122 0.2559882 0.2588892</span></span>
<span id="cb378-6"><a href="cap9.html#cb378-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S02 0.1513373 0.00000000 0.04114702 0.1190172 0.1289682 0.1391056</span></span>
<span id="cb378-7"><a href="cap9.html#cb378-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S03 0.1672040 0.04114702 0.00000000 0.1420233 0.1358127 0.1410867</span></span>
<span id="cb378-8"><a href="cap9.html#cb378-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S04 0.2559122 0.11901720 0.14202325 0.0000000 0.1140283 0.1199803</span></span>
<span id="cb378-9"><a href="cap9.html#cb378-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S05 0.2559882 0.12896823 0.13581271 0.1140283 0.0000000 0.2129054</span></span>
<span id="cb378-10"><a href="cap9.html#cb378-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S06 0.2588892 0.13910558 0.14108668 0.1199803 0.2129054 0.0000000</span></span>
<span id="cb378-11"><a href="cap9.html#cb378-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-12"><a href="cap9.html#cb378-12" aria-hidden="true" tabindex="-1"></a><span class="co"># É preciso calcular uma primeira &#39;melhor&#39; solução do nMDS</span></span>
<span id="cb378-13"><a href="cap9.html#cb378-13" aria-hidden="true" tabindex="-1"></a>sol1 <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(sps.dis)</span>
<span id="cb378-14"><a href="cap9.html#cb378-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 0 stress 0.1344042 </span></span>
<span id="cb378-15"><a href="cap9.html#cb378-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 1 stress 0.1272417 </span></span>
<span id="cb378-16"><a href="cap9.html#cb378-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... New best solution</span></span>
<span id="cb378-17"><a href="cap9.html#cb378-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 0.0789082  max resid 0.3526074 </span></span>
<span id="cb378-18"><a href="cap9.html#cb378-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 2 stress 0.1344042 </span></span>
<span id="cb378-19"><a href="cap9.html#cb378-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 3 stress 0.1336481 </span></span>
<span id="cb378-20"><a href="cap9.html#cb378-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 4 stress 0.1344042 </span></span>
<span id="cb378-21"><a href="cap9.html#cb378-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 5 stress 0.1336481 </span></span>
<span id="cb378-22"><a href="cap9.html#cb378-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 6 stress 0.1336481 </span></span>
<span id="cb378-23"><a href="cap9.html#cb378-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 7 stress 0.1338432 </span></span>
<span id="cb378-24"><a href="cap9.html#cb378-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 8 stress 0.1338432 </span></span>
<span id="cb378-25"><a href="cap9.html#cb378-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 9 stress 0.1378506 </span></span>
<span id="cb378-26"><a href="cap9.html#cb378-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 10 stress 0.1336481 </span></span>
<span id="cb378-27"><a href="cap9.html#cb378-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 11 stress 0.1338433 </span></span>
<span id="cb378-28"><a href="cap9.html#cb378-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 12 stress 0.1338432 </span></span>
<span id="cb378-29"><a href="cap9.html#cb378-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 13 stress 0.1338432 </span></span>
<span id="cb378-30"><a href="cap9.html#cb378-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 14 stress 0.1336481 </span></span>
<span id="cb378-31"><a href="cap9.html#cb378-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 15 stress 0.1344042 </span></span>
<span id="cb378-32"><a href="cap9.html#cb378-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 16 stress 0.1600808 </span></span>
<span id="cb378-33"><a href="cap9.html#cb378-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 17 stress 0.1272418 </span></span>
<span id="cb378-34"><a href="cap9.html#cb378-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 8.48708e-05  max resid 0.0003246819 </span></span>
<span id="cb378-35"><a href="cap9.html#cb378-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb378-36"><a href="cap9.html#cb378-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 18 stress 0.1344042 </span></span>
<span id="cb378-37"><a href="cap9.html#cb378-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 19 stress 0.1611279 </span></span>
<span id="cb378-38"><a href="cap9.html#cb378-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 20 stress 0.1336481 </span></span>
<span id="cb378-39"><a href="cap9.html#cb378-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; *** Solution reached</span></span>
<span id="cb378-40"><a href="cap9.html#cb378-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-41"><a href="cap9.html#cb378-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Depois, executar a mesma função, mas utilizando uma &#39;melhor solução inicial&#39;</span></span>
<span id="cb378-42"><a href="cap9.html#cb378-42" aria-hidden="true" tabindex="-1"></a><span class="co"># para evitar resultdos subótimos no nMDS</span></span>
<span id="cb378-43"><a href="cap9.html#cb378-43" aria-hidden="true" tabindex="-1"></a>nmds.beta <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(sps.dis, <span class="at">previous.best =</span> sol1)</span>
<span id="cb378-44"><a href="cap9.html#cb378-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Starting from 2-dimensional configuration</span></span>
<span id="cb378-45"><a href="cap9.html#cb378-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 0 stress 0.1272417 </span></span>
<span id="cb378-46"><a href="cap9.html#cb378-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 1 stress 0.1272418 </span></span>
<span id="cb378-47"><a href="cap9.html#cb378-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 2.997893e-05  max resid 0.000115054 </span></span>
<span id="cb378-48"><a href="cap9.html#cb378-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb378-49"><a href="cap9.html#cb378-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 2 stress 0.1378506 </span></span>
<span id="cb378-50"><a href="cap9.html#cb378-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 3 stress 0.1336481 </span></span>
<span id="cb378-51"><a href="cap9.html#cb378-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 4 stress 0.1344042 </span></span>
<span id="cb378-52"><a href="cap9.html#cb378-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 5 stress 0.1344042 </span></span>
<span id="cb378-53"><a href="cap9.html#cb378-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 6 stress 0.1272417 </span></span>
<span id="cb378-54"><a href="cap9.html#cb378-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... New best solution</span></span>
<span id="cb378-55"><a href="cap9.html#cb378-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 3.864488e-06  max resid 1.312654e-05 </span></span>
<span id="cb378-56"><a href="cap9.html#cb378-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb378-57"><a href="cap9.html#cb378-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 7 stress 0.1600803 </span></span>
<span id="cb378-58"><a href="cap9.html#cb378-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 8 stress 0.1336481 </span></span>
<span id="cb378-59"><a href="cap9.html#cb378-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 9 stress 0.1272417 </span></span>
<span id="cb378-60"><a href="cap9.html#cb378-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 2.636369e-06  max resid 7.540622e-06 </span></span>
<span id="cb378-61"><a href="cap9.html#cb378-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb378-62"><a href="cap9.html#cb378-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 10 stress 0.1272417 </span></span>
<span id="cb378-63"><a href="cap9.html#cb378-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 2.44969e-05  max resid 9.417254e-05 </span></span>
<span id="cb378-64"><a href="cap9.html#cb378-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb378-65"><a href="cap9.html#cb378-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 11 stress 0.1336481 </span></span>
<span id="cb378-66"><a href="cap9.html#cb378-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 12 stress 0.1272417 </span></span>
<span id="cb378-67"><a href="cap9.html#cb378-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... New best solution</span></span>
<span id="cb378-68"><a href="cap9.html#cb378-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 4.828567e-06  max resid 1.820829e-05 </span></span>
<span id="cb378-69"><a href="cap9.html#cb378-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb378-70"><a href="cap9.html#cb378-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 13 stress 0.1344042 </span></span>
<span id="cb378-71"><a href="cap9.html#cb378-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 14 stress 0.1272417 </span></span>
<span id="cb378-72"><a href="cap9.html#cb378-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 7.317335e-06  max resid 2.766948e-05 </span></span>
<span id="cb378-73"><a href="cap9.html#cb378-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb378-74"><a href="cap9.html#cb378-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 15 stress 0.3652494 </span></span>
<span id="cb378-75"><a href="cap9.html#cb378-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 16 stress 0.1659926 </span></span>
<span id="cb378-76"><a href="cap9.html#cb378-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 17 stress 0.1338432 </span></span>
<span id="cb378-77"><a href="cap9.html#cb378-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 18 stress 0.1336481 </span></span>
<span id="cb378-78"><a href="cap9.html#cb378-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 19 stress 0.1344042 </span></span>
<span id="cb378-79"><a href="cap9.html#cb378-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 20 stress 0.1272418 </span></span>
<span id="cb378-80"><a href="cap9.html#cb378-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 2.223437e-05  max resid 8.504391e-05 </span></span>
<span id="cb378-81"><a href="cap9.html#cb378-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb378-82"><a href="cap9.html#cb378-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; *** Solution reached</span></span>
<span id="cb378-83"><a href="cap9.html#cb378-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-84"><a href="cap9.html#cb378-84" aria-hidden="true" tabindex="-1"></a><span class="co"># O stress é o valor mais importante para interpretar a qualidade da ordenação</span></span>
<span id="cb378-85"><a href="cap9.html#cb378-85" aria-hidden="true" tabindex="-1"></a><span class="co"># ()</span></span>
<span id="cb378-86"><a href="cap9.html#cb378-86" aria-hidden="true" tabindex="-1"></a>nmds.beta<span class="sc">$</span>stress  <span class="co"># valor ideal entre 0 e 0.2</span></span>
<span id="cb378-87"><a href="cap9.html#cb378-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.1272417</span></span>
<span id="cb378-88"><a href="cap9.html#cb378-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-89"><a href="cap9.html#cb378-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar os valores para fazer gráfico</span></span>
<span id="cb378-90"><a href="cap9.html#cb378-90" aria-hidden="true" tabindex="-1"></a>dat.graf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(vegan<span class="sc">::</span><span class="fu">scores</span>(nmds.beta), <span class="at">altitude =</span> env2<span class="sc">$</span>altitude)</span>
<span id="cb378-91"><a href="cap9.html#cb378-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-92"><a href="cap9.html#cb378-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir os grupos (&#39;HULL&#39;) para serem categorizados no gráfico</span></span>
<span id="cb378-93"><a href="cap9.html#cb378-93" aria-hidden="true" tabindex="-1"></a>grp.mon <span class="ot">&lt;-</span> dat.graf[dat.graf<span class="sc">$</span>altitude <span class="sc">==</span> <span class="st">&quot;Montanhoso&quot;</span>, ][<span class="fu">chull</span>(dat.graf[dat.graf<span class="sc">$</span>altitude <span class="sc">==</span></span>
<span id="cb378-94"><a href="cap9.html#cb378-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Montanhoso&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;NMDS1&quot;</span>, <span class="st">&quot;NMDS2&quot;</span>)]), ]</span>
<span id="cb378-95"><a href="cap9.html#cb378-95" aria-hidden="true" tabindex="-1"></a>grp.int <span class="ot">&lt;-</span> dat.graf[dat.graf<span class="sc">$</span>altitude <span class="sc">==</span> <span class="st">&quot;Intermediário&quot;</span>, ][<span class="fu">chull</span>(dat.graf[dat.graf<span class="sc">$</span>altitude <span class="sc">==</span></span>
<span id="cb378-96"><a href="cap9.html#cb378-96" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Intermediário&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;NMDS1&quot;</span>, <span class="st">&quot;NMDS2&quot;</span>)]), ]</span>
<span id="cb378-97"><a href="cap9.html#cb378-97" aria-hidden="true" tabindex="-1"></a>grp.pla <span class="ot">&lt;-</span> dat.graf[dat.graf<span class="sc">$</span>altitude <span class="sc">==</span> <span class="st">&quot;Plano&quot;</span>, ][<span class="fu">chull</span>(dat.graf[dat.graf<span class="sc">$</span>altitude <span class="sc">==</span></span>
<span id="cb378-98"><a href="cap9.html#cb378-98" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Plano&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;NMDS1&quot;</span>, <span class="st">&quot;NMDS2&quot;</span>)]), ]</span>
<span id="cb378-99"><a href="cap9.html#cb378-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-100"><a href="cap9.html#cb378-100" aria-hidden="true" tabindex="-1"></a><span class="do">## Combinar dados dos grupos para cada Convex Hull</span></span>
<span id="cb378-101"><a href="cap9.html#cb378-101" aria-hidden="true" tabindex="-1"></a>hull.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(grp.mon, grp.int, grp.pla)</span>
<span id="cb378-102"><a href="cap9.html#cb378-102" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hull.data)</span>
<span id="cb378-103"><a href="cap9.html#cb378-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           NMDS1       NMDS2      altitude</span></span>
<span id="cb378-104"><a href="cap9.html#cb378-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S04 -0.10578360 -0.10682795    Montanhoso</span></span>
<span id="cb378-105"><a href="cap9.html#cb378-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S01 -0.25332377  0.04198598    Montanhoso</span></span>
<span id="cb378-106"><a href="cap9.html#cb378-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S11 -0.12504868  0.14477145    Montanhoso</span></span>
<span id="cb378-107"><a href="cap9.html#cb378-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S15  0.09166003  0.09857211    Montanhoso</span></span>
<span id="cb378-108"><a href="cap9.html#cb378-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S18  0.01968282 -0.12417413 Intermediário</span></span>
<span id="cb378-109"><a href="cap9.html#cb378-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S06 -0.16053934 -0.08924307 Intermediário</span></span>
<span id="cb378-110"><a href="cap9.html#cb378-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-111"><a href="cap9.html#cb378-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico combinado os escores do nMDS com polígonos dos valores por cada cota</span></span>
<span id="cb378-112"><a href="cap9.html#cb378-112" aria-hidden="true" tabindex="-1"></a><span class="co"># altitudinal</span></span>
<span id="cb378-113"><a href="cap9.html#cb378-113" aria-hidden="true" tabindex="-1"></a>dat.graf <span class="sc">%&gt;%</span></span>
<span id="cb378-114"><a href="cap9.html#cb378-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2, <span class="at">color =</span> altitude, <span class="at">shape =</span> altitude)) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb378-115"><a href="cap9.html#cb378-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">geom_polygon</span>(<span class="at">data =</span> hull.data, <span class="fu">aes</span>(<span class="at">fill =</span> altitude,</span>
<span id="cb378-116"><a href="cap9.html#cb378-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> altitude), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb378-117"><a href="cap9.html#cb378-117" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;darkorchid&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;darkorchid&quot;</span>,</span>
<span id="cb378-118"><a href="cap9.html#cb378-118" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;NMDS1&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;NMDS2&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb378-119"><a href="cap9.html#cb378-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb378-120"><a href="cap9.html#cb378-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>), <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb378-121"><a href="cap9.html#cb378-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span></code></pre></div>
<p><img src="livro_files/figure-html/unnamed-chunk-390-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="para-se-aprofundar-4" class="section level3" number="10.8.1">
<h3><span class="header-section-number">10.8.1</span> Para se aprofundar</h3>
<ul>
<li><p><a href="https://www.sciencedirect.com/science/article/pii/S0304380010006393?casa_token=0YLFbVbGj1IAAAAA:RFcrLHBDdt-NY5gpxCEAqlc8LMG0ayzChpMvaOFQkE10ftg2Us6PafgMQCSmCZZ21eb430e_lWo">Agrupamento de espécies e locais baseado em modelos</a></p></li>
<li><p><a href="http://adn.biol.umontreal.ca/~numericalecology/numecolR/">Numerical Ecology with R</a></p></li>
<li><p><a href="https://www.annualreviews.org/doi/pdf/10.1146/annurev.es.21.110190.001021">James &amp; McCulloch (1990)</a></p></li>
<li><p><a href="https://www.sciencedirect.com/bookseries/developments-in-environmental-modelling/vol/24">Legendre &amp; Legendre (2012)</a></p></li>
</ul>

</div>
</div>
</div>
<h3>Referências</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-anderson_new_2001" class="csl-entry">
Anderson, M. J. (2001). <span class="nocase">A new method for non-parametric multivariate analysis of variance</span>. <em>Austral Ecology</em>, <em>26</em>(1), 32–46. <a href="https://doi.org/10.1046/j.1442-9993.2001.01070.x">https://doi.org/10.1046/j.1442-9993.2001.01070.x</a>
</div>
<div id="ref-anderson_permutational_2017" class="csl-entry">
Anderson, M. J. (2017). <span class="nocase">Permutational Multivariate Analysis of Variance (PERMANOVA)</span>. In <em>Wiley StatsRef: Statistics reference online</em> (pp. 1–15). Wiley. <a href="https://doi.org/10.1002/9781118445112.stat07841">https://doi.org/10.1002/9781118445112.stat07841</a>
</div>
<div id="ref-anderson2010" class="csl-entry">
Anderson, M. J., Crist, T. O., Chase, J. M., Vellend, M., Inouye, B. D., Freestone, A. L., Sanders, N. J., Cornell, H. V., Comita, L. S., Davies, K. F., Harrison, S. P., Kraft, N. J. B., Stegen, J. C., &amp; Swenson, N. G. (2011). <span class="nocase">Navigating the multiple meanings of <span class="math inline">\(\beta\)</span> diversity: A roadmap for the practicing ecologist</span>. <em>Ecology Letters</em>, <em>14</em>(1), 19–28. <a href="https://doi.org/10.1111/j.1461-0248.2010.01552.x">https://doi.org/10.1111/j.1461-0248.2010.01552.x</a>
</div>
<div id="ref-anderson_permanova+_2008" class="csl-entry">
Anderson, M. J., Gorley, R. N., &amp; Clarke, K. R. (2008). <em><span class="nocase">PERMANOVA+ for PRIMER: Guide to Software and Statistical Methods</span></em> (p. 214). Primer-E. <a href="http://updates.primer-e.com/primer7/manuals/PERMANOVA+_manual.pdf">http://updates.primer-e.com/primer7/manuals/PERMANOVA+_manual.pdf</a>
</div>
<div id="ref-anderson_permanova_2013" class="csl-entry">
Anderson, M. J., &amp; Walsh, D. C. I. (2013). <span class="nocase">PERMANOVA, ANOSIM, and the Mantel test in the face of heterogeneous dispersions: What null hypothesis are you testing?</span> <em>Ecological Monographs</em>, <em>83</em>(4), 557–574. <a href="https://doi.org/10.1890/12-2010.1">https://doi.org/10.1890/12-2010.1</a>
</div>
<div id="ref-anderson_permutation_2003" class="csl-entry">
Anderson, M., &amp; Ter Braak, C. (2003). <span class="nocase">Permutation tests for multi-factorial analysis of variance</span>. <em>Journal of Statistical Computation and Simulation</em>, <em>73</em>(2), 85–113. <a href="https://doi.org/10.1080/00949650215733">https://doi.org/10.1080/00949650215733</a>
</div>
<div id="ref-bauman_disentangling_2018" class="csl-entry">
Bauman, D., Drouet, T., Dray, S., &amp; Vleminckx, J. (2018). <span class="nocase">Disentangling good from bad practices in the selection of spatial or phylogenetic eigenvectors</span>. <em>Ecography</em>, <em>41</em>(10), 1638–1649. <a href="https://doi.org/10.1111/ecog.03380">https://doi.org/10.1111/ecog.03380</a>
</div>
<div id="ref-bauman_optimizing_2018" class="csl-entry">
Bauman, D., Drouet, T., Fortin, M.-J., &amp; Dray, S. (2018). <span class="nocase">Optimizing the choice of a spatial weighting matrix in eigenvector-based methods</span>. <em>Ecology</em>, <em>99</em>(10), 2159–2166. <a href="https://doi.org/10.1002/ecy.2469">https://doi.org/10.1002/ecy.2469</a>
</div>
<div id="ref-borcard2018" class="csl-entry">
Borcard, D., Gillet, F., &amp; Legendre, P. (2018). <em><span class="nocase">Numerical Ecology with R</span></em>. Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-71404-2">https://doi.org/10.1007/978-3-319-71404-2</a>
</div>
<div id="ref-borcard_partialling_1992" class="csl-entry">
Borcard, D., Legendre, P., &amp; Drapeau, P. (1992). <span class="nocase">Partialling out the spatial component of ecological variation</span>. <em>Ecology</em>, <em>73</em>(3), 1045–1055. <a href="https://doi.org/10.2307/1940179">https://doi.org/10.2307/1940179</a>
</div>
<div id="ref-diniz-filho_eigenvector_1998" class="csl-entry">
Diniz-Filho, J. A. F., de Sant’Ana, C. E. R., &amp; Bini, L. M. (1998). <span class="nocase">An eigenvector method for estimating phylogenetic inertia</span>. <em>Evolution</em>, <em>52</em>(5), 1247. <a href="https://doi.org/10.2307/2411294">https://doi.org/10.2307/2411294</a>
</div>
<div id="ref-dray_community_2012" class="csl-entry">
Dray, S., Pélissier, R., Couteron, P., Fortin, M. J., Legendre, P., Peres-Neto, P. R., Bellier, E., Bivand, R., Blanchet, F. G., De Cáceres, M., Dufour, A. B., Heegaard, E., Jombart, T., Munoz, F., Oksanen, J., Thioulouse, J., &amp; Wagner, H. H. (2012). <span class="nocase">Community ecology in the age of multivariate multiscale spatial analysis</span>. <em>Ecological Monographs</em>, <em>82</em>(3), 257–275. <a href="https://doi.org/10.1890/11-1183.1">https://doi.org/10.1890/11-1183.1</a>
</div>
<div id="ref-dufrene_species_1997" class="csl-entry">
Dufrêne, M., &amp; Legendre, P. (1997). <span class="nocase">Species assemblages and indicator species the need for a flexible asymmetrical approach</span>. <em>Ecological Monographs</em>, <em>67</em>(3), 345–366. <a href="https://doi.org/10.1890/0012-9615(1997)067[0345:SAAIST]2.0.CO;2">https://doi.org/10.1890/0012-9615(1997)067[0345:SAAIST]2.0.CO;2</a>
</div>
<div id="ref-legendre2018" class="csl-entry">
Legendre, P., &amp; Borcard, D. (2018). <span class="nocase">Box-Cox-chord transformations for community composition data prior to beta diversity analysis</span>. <em>Ecography</em>, <em>41</em>(11), 1820–1824. <a href="https://doi.org/10.1111/ecog.03498">https://doi.org/10.1111/ecog.03498</a>
</div>
<div id="ref-legendre2013" class="csl-entry">
Legendre, P., &amp; De Cáceres, M. (2013). <span class="nocase">Beta diversity as the variance of community data: dissimilarity coefficients and partitioning</span>. <em>Ecology Letters</em>, <em>16</em>(8), 951–963. <a href="https://doi.org/10.1111/ele.12141">https://doi.org/10.1111/ele.12141</a>
</div>
<div id="ref-legendre2001" class="csl-entry">
Legendre, P., &amp; Gallagher, E. D. (2001). <span class="nocase">Ecologically meaningful transformations for ordination of species data</span>. <em>Oecologia</em>, <em>129</em>(2), 271–280. <a href="https://doi.org/10.1007/s004420100716">https://doi.org/10.1007/s004420100716</a>
</div>
<div id="ref-legendre_numerical_2012" class="csl-entry">
Legendre, P., &amp; Legendre, L. (2012). <em><span>Numerical Ecology</span></em> (3rd ed., p. 1006). Elsevier.
</div>
<div id="ref-sneath_numerical_1973" class="csl-entry">
Sneath, P. H. A., &amp; Sokal, R. R. (1973). <em><span class="nocase">Numerical taxonomy: the principles and practice of numerical classification</span></em>. W. H. Freeman.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cap8.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cap10.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/paternogbc/livro_aer/edit/master/09_multivariadas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/paternogbc/livro_aer/blob/master/09_multivariadas.Rmd",
"text": null
},
"download": ["livro.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
