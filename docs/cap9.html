<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 9 Análises Multidimensionais | Análises Ecológicas no R</title>
  <meta name="description" content="Capítulo 9 Análises Multidimensionais | Análises Ecológicas no R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 9 Análises Multidimensionais | Análises Ecológicas no R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 9 Análises Multidimensionais | Análises Ecológicas no R" />
  
  
  



<meta name="date" content="2022-01-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cap8.html"/>
<link rel="next" href="cap10.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análises Ecológicas no R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Capa</a></li>
<li class="chapter" data-level="" data-path="prefácio.html"><a href="prefácio.html"><i class="fa fa-check"></i>Prefácio</a></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html"><i class="fa fa-check"></i>Sobre os autores</a></li>
<li class="chapter" data-level="" data-path="revisores-e-colaboradores.html"><a href="revisores-e-colaboradores.html"><i class="fa fa-check"></i>Revisores e colaboradores</a></li>
<li class="chapter" data-level="1" data-path="cap1.html"><a href="cap1.html"><i class="fa fa-check"></i><b>1</b> Introdução</a>
<ul>
<li class="chapter" data-level="1.1" data-path="cap1.html"><a href="cap1.html#histórico-deste-livro"><i class="fa fa-check"></i><b>1.1</b> Histórico deste livro</a></li>
<li class="chapter" data-level="1.2" data-path="cap1.html"><a href="cap1.html#objetivo-deste-livro"><i class="fa fa-check"></i><b>1.2</b> Objetivo deste livro</a></li>
<li class="chapter" data-level="1.3" data-path="cap1.html"><a href="cap1.html#o-que-você-não-encontrará-neste-livro"><i class="fa fa-check"></i><b>1.3</b> O que você não encontrará neste livro</a></li>
<li class="chapter" data-level="1.4" data-path="cap1.html"><a href="cap1.html#por-que-usar-o-r"><i class="fa fa-check"></i><b>1.4</b> Por que usar o R?</a></li>
<li class="chapter" data-level="1.5" data-path="cap1.html"><a href="cap1.html#indo-além-da-linguagem-de-progração-para-a-ecologia"><i class="fa fa-check"></i><b>1.5</b> Indo além da linguagem de progração para a Ecologia</a></li>
<li class="chapter" data-level="1.6" data-path="cap1.html"><a href="cap1.html#como-usar-este-livro"><i class="fa fa-check"></i><b>1.6</b> Como usar este livro</a></li>
<li class="chapter" data-level="1.7" data-path="cap1.html"><a href="cap1.html#como-ensinar-e-aprender-com-esse-livro"><i class="fa fa-check"></i><b>1.7</b> Como ensinar e aprender com esse livro</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="cap1.html"><a href="cap1.html#em-laboratórios-ou-grupos-de-pesquisa"><i class="fa fa-check"></i><b>1.7.1</b> Em laboratórios ou grupos de pesquisa</a></li>
<li class="chapter" data-level="1.7.2" data-path="cap1.html"><a href="cap1.html#em-disciplinas-da-graduação-ou-pós-graduação"><i class="fa fa-check"></i><b>1.7.2</b> Em disciplinas da graduação ou pós-graduação</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cap2.html"><a href="cap2.html"><i class="fa fa-check"></i><b>2</b> Voltando ao básico: como dominar a arte de fazer perguntas cientificamente relevantes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cap2.html"><a href="cap2.html#introdução"><i class="fa fa-check"></i><b>2.1</b> Introdução</a></li>
<li class="chapter" data-level="2.2" data-path="cap2.html"><a href="cap2.html#perguntas-devem-preceder-as-análises-estatísticas"><i class="fa fa-check"></i><b>2.2</b> Perguntas devem preceder as análises estatísticas</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="cap2.html"><a href="cap2.html#um-bestiárioperguntas_ecologia-1-para-o-teste-de-hipóteses-você-está-fazendo-a-pergunta-certa"><i class="fa fa-check"></i><b>2.2.1</b> Um bestiário para o teste de hipóteses (Você está fazendo a pergunta certa?)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cap2.html"><a href="cap2.html#fluxograma-conectando-variáveis-para-melhorar-o-desenho-experimental-e-as-análises-estatísticas"><i class="fa fa-check"></i><b>2.3</b> Fluxograma: Conectando variáveis para melhorar o desenho experimental e as análises estatísticas</a></li>
<li class="chapter" data-level="2.4" data-path="cap2.html"><a href="cap2.html#questões-fundamentais-em-etnobiologia-ecologia-e-conservação"><i class="fa fa-check"></i><b>2.4</b> Questões fundamentais em etnobiologia, ecologia e conservação</a></li>
<li class="chapter" data-level="2.5" data-path="cap2.html"><a href="cap2.html#considerações-finais"><i class="fa fa-check"></i><b>2.5</b> Considerações Finais</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cap3.html"><a href="cap3.html"><i class="fa fa-check"></i><b>3</b> Pré-requisitos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cap3.html"><a href="cap3.html#introdução-1"><i class="fa fa-check"></i><b>3.1</b> Introdução</a></li>
<li class="chapter" data-level="3.2" data-path="cap3.html"><a href="cap3.html#instalação-do-r"><i class="fa fa-check"></i><b>3.2</b> Instalação do R</a></li>
<li class="chapter" data-level="3.3" data-path="cap3.html"><a href="cap3.html#instalação-do-rstudio"><i class="fa fa-check"></i><b>3.3</b> Instalação do RStudio</a></li>
<li class="chapter" data-level="3.4" data-path="cap3.html"><a href="cap3.html#versão-do-r"><i class="fa fa-check"></i><b>3.4</b> Versão do R</a></li>
<li class="chapter" data-level="3.5" data-path="cap3.html"><a href="cap3.html#pacotes"><i class="fa fa-check"></i><b>3.5</b> Pacotes</a></li>
<li class="chapter" data-level="3.6" data-path="cap3.html"><a href="cap3.html#dados"><i class="fa fa-check"></i><b>3.6</b> Dados</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cap4.html"><a href="cap4.html"><i class="fa fa-check"></i><b>4</b> Introdução ao R</a>
<ul>
<li class="chapter" data-level="" data-path="cap4.html"><a href="cap4.html#pré-requisitos-do-capítulo"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="4.1" data-path="cap4.html"><a href="cap4.html#contextualização"><i class="fa fa-check"></i><b>4.1</b> Contextualização</a></li>
<li class="chapter" data-level="4.2" data-path="cap4.html"><a href="cap4.html#r-e-rstudio"><i class="fa fa-check"></i><b>4.2</b> R e RStudio</a></li>
<li class="chapter" data-level="4.3" data-path="cap4.html"><a href="cap4.html#funcionamento-da-linguagem-r"><i class="fa fa-check"></i><b>4.3</b> Funcionamento da linguagem R</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="cap4.html"><a href="cap4.html#console"><i class="fa fa-check"></i><b>4.3.1</b> Console</a></li>
<li class="chapter" data-level="4.3.2" data-path="cap4.html"><a href="cap4.html#scripts"><i class="fa fa-check"></i><b>4.3.2</b> Scripts</a></li>
<li class="chapter" data-level="4.3.3" data-path="cap4.html"><a href="cap4.html#operadores"><i class="fa fa-check"></i><b>4.3.3</b> Operadores</a></li>
<li class="chapter" data-level="4.3.4" data-path="cap4.html"><a href="cap4.html#objetos"><i class="fa fa-check"></i><b>4.3.4</b> Objetos</a></li>
<li class="chapter" data-level="4.3.5" data-path="cap4.html"><a href="cap4.html#funções"><i class="fa fa-check"></i><b>4.3.5</b> Funções</a></li>
<li class="chapter" data-level="4.3.6" data-path="cap4.html"><a href="cap4.html#pacotes-1"><i class="fa fa-check"></i><b>4.3.6</b> Pacotes</a></li>
<li class="chapter" data-level="4.3.7" data-path="cap4.html"><a href="cap4.html#ajuda-help"><i class="fa fa-check"></i><b>4.3.7</b> Ajuda (<em>Help</em>)</a></li>
<li class="chapter" data-level="4.3.8" data-path="cap4.html"><a href="cap4.html#ambiente-environment"><i class="fa fa-check"></i><b>4.3.8</b> Ambiente (<em>Environment</em>)</a></li>
<li class="chapter" data-level="4.3.9" data-path="cap4.html"><a href="cap4.html#citações"><i class="fa fa-check"></i><b>4.3.9</b> Citações</a></li>
<li class="chapter" data-level="4.3.10" data-path="cap4.html"><a href="cap4.html#principais-erros-de-iniciantes"><i class="fa fa-check"></i><b>4.3.10</b> Principais erros de iniciantes</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="cap4.html"><a href="cap4.html#estrutura-e-manipulação-de-objetos"><i class="fa fa-check"></i><b>4.4</b> Estrutura e manipulação de objetos</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="cap4.html"><a href="cap4.html#atributo-dos-objetos"><i class="fa fa-check"></i><b>4.4.1</b> Atributo dos objetos</a></li>
<li class="chapter" data-level="4.4.2" data-path="cap4.html"><a href="cap4.html#manipulação-de-objetos-unidimensionais"><i class="fa fa-check"></i><b>4.4.2</b> Manipulação de objetos unidimensionais</a></li>
<li class="chapter" data-level="4.4.3" data-path="cap4.html"><a href="cap4.html#manipulação-de-objetos-multidimensionais"><i class="fa fa-check"></i><b>4.4.3</b> Manipulação de objetos multidimensionais</a></li>
<li class="chapter" data-level="4.4.4" data-path="cap4.html"><a href="cap4.html#valores-faltantes-e-especiais"><i class="fa fa-check"></i><b>4.4.4</b> Valores faltantes e especiais</a></li>
<li class="chapter" data-level="4.4.5" data-path="cap4.html"><a href="cap4.html#diretório-de-trabalho"><i class="fa fa-check"></i><b>4.4.5</b> Diretório de trabalho</a></li>
<li class="chapter" data-level="4.4.6" data-path="cap4.html"><a href="cap4.html#importar-dados"><i class="fa fa-check"></i><b>4.4.6</b> Importar dados</a></li>
<li class="chapter" data-level="4.4.7" data-path="cap4.html"><a href="cap4.html#conferência-dos-dados-importados"><i class="fa fa-check"></i><b>4.4.7</b> Conferência dos dados importados</a></li>
<li class="chapter" data-level="4.4.8" data-path="cap4.html"><a href="cap4.html#exportar-dados"><i class="fa fa-check"></i><b>4.4.8</b> Exportar dados</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="cap4.html"><a href="cap4.html#exercícios"><i class="fa fa-check"></i><b>4.5</b> Exercícios</a></li>
<li class="chapter" data-level="4.6" data-path="cap4.html"><a href="cap4.html#para-se-aprofundar"><i class="fa fa-check"></i><b>4.6</b> Para se aprofundar</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="cap4.html"><a href="cap4.html#livros"><i class="fa fa-check"></i><b>4.6.1</b> Livros</a></li>
<li class="chapter" data-level="4.6.2" data-path="cap4.html"><a href="cap4.html#links"><i class="fa fa-check"></i><b>4.6.2</b> Links</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cap5.html"><a href="cap5.html"><i class="fa fa-check"></i><b>5</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="" data-path="cap5.html"><a href="cap5.html#pré-requisitos-do-capítulo-1"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="5.1" data-path="cap5.html"><a href="cap5.html#contextualização-1"><i class="fa fa-check"></i><b>5.1</b> Contextualização</a></li>
<li class="chapter" data-level="5.2" data-path="cap5.html"><a href="cap5.html#tidyverse"><i class="fa fa-check"></i><b>5.2</b> <em>tidyverse</em></a></li>
<li class="chapter" data-level="5.3" data-path="cap5.html"><a href="cap5.html#here"><i class="fa fa-check"></i><b>5.3</b> here</a></li>
<li class="chapter" data-level="5.4" data-path="cap5.html"><a href="cap5.html#readr-readxl-e-writexl"><i class="fa fa-check"></i><b>5.4</b> readr, readxl e writexl</a></li>
<li class="chapter" data-level="5.5" data-path="cap5.html"><a href="cap5.html#tibble"><i class="fa fa-check"></i><b>5.5</b> tibble</a></li>
<li class="chapter" data-level="5.6" data-path="cap5.html"><a href="cap5.html#magrittr-pipe--"><i class="fa fa-check"></i><b>5.6</b> magrittr (pipe - %&gt;%)</a></li>
<li class="chapter" data-level="5.7" data-path="cap5.html"><a href="cap5.html#tidyr"><i class="fa fa-check"></i><b>5.7</b> tidyr</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="cap5.html"><a href="cap5.html#palmerpenguins"><i class="fa fa-check"></i><b>5.7.1</b> palmerpenguins</a></li>
<li class="chapter" data-level="5.7.2" data-path="cap5.html"><a href="cap5.html#glimpse"><i class="fa fa-check"></i><b>5.7.2</b> glimpse()</a></li>
<li class="chapter" data-level="5.7.3" data-path="cap5.html"><a href="cap5.html#unite"><i class="fa fa-check"></i><b>5.7.3</b> unite()</a></li>
<li class="chapter" data-level="5.7.4" data-path="cap5.html"><a href="cap5.html#separate"><i class="fa fa-check"></i><b>5.7.4</b> separate()</a></li>
<li class="chapter" data-level="5.7.5" data-path="cap5.html"><a href="cap5.html#drop_na-e-replace_na"><i class="fa fa-check"></i><b>5.7.5</b> drop_na() e replace_na()</a></li>
<li class="chapter" data-level="5.7.6" data-path="cap5.html"><a href="cap5.html#pivot_longer-e-pivot_wider"><i class="fa fa-check"></i><b>5.7.6</b> pivot_longer() e pivot_wider()</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="cap5.html"><a href="cap5.html#dplyr"><i class="fa fa-check"></i><b>5.8</b> dplyr</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="cap5.html"><a href="cap5.html#gramática"><i class="fa fa-check"></i><b>5.8.1</b> Gramática</a></li>
<li class="chapter" data-level="5.8.2" data-path="cap5.html"><a href="cap5.html#sintaxe"><i class="fa fa-check"></i><b>5.8.2</b> Sintaxe</a></li>
<li class="chapter" data-level="5.8.3" data-path="cap5.html"><a href="cap5.html#palmerpenguins-1"><i class="fa fa-check"></i><b>5.8.3</b> palmerpenguins</a></li>
<li class="chapter" data-level="5.8.4" data-path="cap5.html"><a href="cap5.html#relocate"><i class="fa fa-check"></i><b>5.8.4</b> relocate()</a></li>
<li class="chapter" data-level="5.8.5" data-path="cap5.html"><a href="cap5.html#rename"><i class="fa fa-check"></i><b>5.8.5</b> rename()</a></li>
<li class="chapter" data-level="5.8.6" data-path="cap5.html"><a href="cap5.html#select"><i class="fa fa-check"></i><b>5.8.6</b> select()</a></li>
<li class="chapter" data-level="5.8.7" data-path="cap5.html"><a href="cap5.html#pull"><i class="fa fa-check"></i><b>5.8.7</b> pull()</a></li>
<li class="chapter" data-level="5.8.8" data-path="cap5.html"><a href="cap5.html#mutate"><i class="fa fa-check"></i><b>5.8.8</b> mutate()</a></li>
<li class="chapter" data-level="5.8.9" data-path="cap5.html"><a href="cap5.html#arrange"><i class="fa fa-check"></i><b>5.8.9</b> arrange()</a></li>
<li class="chapter" data-level="5.8.10" data-path="cap5.html"><a href="cap5.html#filter"><i class="fa fa-check"></i><b>5.8.10</b> filter()</a></li>
<li class="chapter" data-level="5.8.11" data-path="cap5.html"><a href="cap5.html#slice"><i class="fa fa-check"></i><b>5.8.11</b> slice()</a></li>
<li class="chapter" data-level="5.8.12" data-path="cap5.html"><a href="cap5.html#distinct"><i class="fa fa-check"></i><b>5.8.12</b> distinct()</a></li>
<li class="chapter" data-level="5.8.13" data-path="cap5.html"><a href="cap5.html#count"><i class="fa fa-check"></i><b>5.8.13</b> count()</a></li>
<li class="chapter" data-level="5.8.14" data-path="cap5.html"><a href="cap5.html#group_by"><i class="fa fa-check"></i><b>5.8.14</b> group_by()</a></li>
<li class="chapter" data-level="5.8.15" data-path="cap5.html"><a href="cap5.html#summarise"><i class="fa fa-check"></i><b>5.8.15</b> summarise()</a></li>
<li class="chapter" data-level="5.8.16" data-path="cap5.html"><a href="cap5.html#bind_rows-e-bind_cols"><i class="fa fa-check"></i><b>5.8.16</b> bind_rows() e bind_cols()</a></li>
<li class="chapter" data-level="5.8.17" data-path="cap5.html"><a href="cap5.html#join"><i class="fa fa-check"></i><b>5.8.17</b> *_join()</a></li>
<li class="chapter" data-level="5.8.18" data-path="cap5.html"><a href="cap5.html#operações-de-conjuntos-e-comparação-de-dados"><i class="fa fa-check"></i><b>5.8.18</b> Operações de conjuntos e comparação de dados</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="cap5.html"><a href="cap5.html#stringr"><i class="fa fa-check"></i><b>5.9</b> stringr</a></li>
<li class="chapter" data-level="5.10" data-path="cap5.html"><a href="cap5.html#forcats"><i class="fa fa-check"></i><b>5.10</b> forcats</a></li>
<li class="chapter" data-level="5.11" data-path="cap5.html"><a href="cap5.html#lubridate"><i class="fa fa-check"></i><b>5.11</b> lubridate</a></li>
<li class="chapter" data-level="5.12" data-path="cap5.html"><a href="cap5.html#purrr"><i class="fa fa-check"></i><b>5.12</b> purrr</a></li>
<li class="chapter" data-level="5.13" data-path="cap5.html"><a href="cap5.html#exercícios-1"><i class="fa fa-check"></i><b>5.13</b> Exercícios</a></li>
<li class="chapter" data-level="5.14" data-path="cap5.html"><a href="cap5.html#para-se-aprofundar-1"><i class="fa fa-check"></i><b>5.14</b> Para se aprofundar</a>
<ul>
<li class="chapter" data-level="5.14.1" data-path="cap5.html"><a href="cap5.html#livros-1"><i class="fa fa-check"></i><b>5.14.1</b> Livros</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cap6.html"><a href="cap6.html"><i class="fa fa-check"></i><b>6</b> Visualização de dados</a>
<ul>
<li class="chapter" data-level="" data-path="cap6.html"><a href="cap6.html#pré-requisitos-do-capítulo-2"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="6.1" data-path="cap6.html"><a href="cap6.html#contextualização-2"><i class="fa fa-check"></i><b>6.1</b> Contextualização</a></li>
<li class="chapter" data-level="6.2" data-path="cap6.html"><a href="cap6.html#principais-pacotes"><i class="fa fa-check"></i><b>6.2</b> Principais pacotes</a></li>
<li class="chapter" data-level="6.3" data-path="cap6.html"><a href="cap6.html#grámatica-dos-gráficos"><i class="fa fa-check"></i><b>6.3</b> Grámatica dos gráficos</a></li>
<li class="chapter" data-level="6.4" data-path="cap6.html"><a href="cap6.html#tipos-de-gráficos"><i class="fa fa-check"></i><b>6.4</b> Tipos de gráficos</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="cap6.html"><a href="cap6.html#histograma-histogram"><i class="fa fa-check"></i><b>6.4.1</b> Histograma (<em>histogram</em>)</a></li>
<li class="chapter" data-level="6.4.2" data-path="cap6.html"><a href="cap6.html#gráfico-de-densidade-density-plot"><i class="fa fa-check"></i><b>6.4.2</b> Gráfico de densidade (<em>density plot</em>)</a></li>
<li class="chapter" data-level="6.4.3" data-path="cap6.html"><a href="cap6.html#diagrama-de-pontos-dot-plot"><i class="fa fa-check"></i><b>6.4.3</b> Diagrama de pontos (<em>dot plot</em>)</a></li>
<li class="chapter" data-level="6.4.4" data-path="cap6.html"><a href="cap6.html#gráfico-de-barras-bar-plot"><i class="fa fa-check"></i><b>6.4.4</b> Gráfico de barras (<em>bar plot</em>)</a></li>
<li class="chapter" data-level="6.4.5" data-path="cap6.html"><a href="cap6.html#gráfico-de-setores-pie-chart-e-donut-chart"><i class="fa fa-check"></i><b>6.4.5</b> Gráfico de setores (<em>pie chart</em> e <em>donut chart</em>)</a></li>
<li class="chapter" data-level="6.4.6" data-path="cap6.html"><a href="cap6.html#gráfico-de-caixa-boxplot"><i class="fa fa-check"></i><b>6.4.6</b> Gráfico de caixa (<em>boxplot</em>)</a></li>
<li class="chapter" data-level="6.4.7" data-path="cap6.html"><a href="cap6.html#gráfico-de-dispersão-scatter-plot"><i class="fa fa-check"></i><b>6.4.7</b> Gráfico de dispersão (<em>scatter plot</em>)</a></li>
<li class="chapter" data-level="6.4.8" data-path="cap6.html"><a href="cap6.html#visualização-de-múltiplos-gráficos-pareados"><i class="fa fa-check"></i><b>6.4.8</b> Visualização de múltiplos gráficos pareados</a></li>
<li class="chapter" data-level="6.4.9" data-path="cap6.html"><a href="cap6.html#erros-comuns-dos-usuários-do-ggplot2-e-como-evitá-los"><i class="fa fa-check"></i><b>6.4.9</b> Erros comuns dos usuários do <code>ggplot2</code> e como evitá-los</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="cap6.html"><a href="cap6.html#finalização-de-gráficos-para-publicação"><i class="fa fa-check"></i><b>6.5</b> Finalização de gráficos para publicação</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="cap6.html"><a href="cap6.html#posição-cores-e-fonte-da-legenda"><i class="fa fa-check"></i><b>6.5.1</b> Posição, cores e fonte da legenda</a></li>
<li class="chapter" data-level="6.5.2" data-path="cap6.html"><a href="cap6.html#elementos-gráficos-eixo-fonte-gride"><i class="fa fa-check"></i><b>6.5.2</b> Elementos gráficos: eixo, fonte, gride</a></li>
<li class="chapter" data-level="6.5.3" data-path="cap6.html"><a href="cap6.html#temas-personalizados-ggtheme"><i class="fa fa-check"></i><b>6.5.3</b> Temas personalizados <code>ggtheme()</code></a></li>
<li class="chapter" data-level="6.5.4" data-path="cap6.html"><a href="cap6.html#criando-seu-próprio-theme_custom"><i class="fa fa-check"></i><b>6.5.4</b> Criando seu próprio <code>theme_custom()</code></a></li>
<li class="chapter" data-level="6.5.5" data-path="cap6.html"><a href="cap6.html#exportando-dados-com-alta-qualidade-com-a-função-ggsave"><i class="fa fa-check"></i><b>6.5.5</b> Exportando dados com alta qualidade com a função <code>ggsave()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="cap6.html"><a href="cap6.html#para-se-aprofundar-2"><i class="fa fa-check"></i><b>6.6</b> Para se aprofundar</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="cap6.html"><a href="cap6.html#livros-2"><i class="fa fa-check"></i><b>6.6.1</b> Livros</a></li>
<li class="chapter" data-level="6.6.2" data-path="cap6.html"><a href="cap6.html#links-1"><i class="fa fa-check"></i><b>6.6.2</b> Links</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="cap7.html"><a href="cap7.html"><i class="fa fa-check"></i><b>7</b> Modelos lineares</a>
<ul>
<li class="chapter" data-level="" data-path="cap7.html"><a href="cap7.html#pré-requisitos-do-capítulo-3"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="7.1" data-path="cap7.html"><a href="cap7.html#teste-t-de-student-para-duas-amostras-independentes"><i class="fa fa-check"></i><b>7.1</b> Teste T (de Student) para duas amostras independentes</a></li>
<li class="chapter" data-level="7.2" data-path="cap7.html"><a href="cap7.html#teste-t-para-amostras-pareadas"><i class="fa fa-check"></i><b>7.2</b> Teste T para amostras pareadas</a></li>
<li class="chapter" data-level="7.3" data-path="cap7.html"><a href="cap7.html#correlação-de-pearson"><i class="fa fa-check"></i><b>7.3</b> Correlação de Pearson</a></li>
<li class="chapter" data-level="7.4" data-path="cap7.html"><a href="cap7.html#regressão-linear-simples"><i class="fa fa-check"></i><b>7.4</b> Regressão Linear Simples</a></li>
<li class="chapter" data-level="7.5" data-path="cap7.html"><a href="cap7.html#regressão-linear-múltipla"><i class="fa fa-check"></i><b>7.5</b> Regressão Linear Múltipla</a></li>
<li class="chapter" data-level="7.6" data-path="cap7.html"><a href="cap7.html#análises-de-variância-anova"><i class="fa fa-check"></i><b>7.6</b> Análises de Variância (ANOVA)</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="cap7.html"><a href="cap7.html#anova-de-um-fator"><i class="fa fa-check"></i><b>7.6.1</b> ANOVA de um fator</a></li>
<li class="chapter" data-level="7.6.2" data-path="cap7.html"><a href="cap7.html#anova-com-dois-fatores-ou-anova-fatorial"><i class="fa fa-check"></i><b>7.6.2</b> ANOVA com dois fatores ou ANOVA fatorial</a></li>
<li class="chapter" data-level="7.6.3" data-path="cap7.html"><a href="cap7.html#anova-em-blocos-aleatorizados"><i class="fa fa-check"></i><b>7.6.3</b> ANOVA em blocos aleatorizados</a></li>
<li class="chapter" data-level="7.6.4" data-path="cap7.html"><a href="cap7.html#análise-de-covariância-ancova"><i class="fa fa-check"></i><b>7.6.4</b> Análise de covariância (ANCOVA)</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="cap7.html"><a href="cap7.html#generalized-least-squares-gls"><i class="fa fa-check"></i><b>7.7</b> Generalized Least Squares (GLS)</a></li>
<li class="chapter" data-level="7.8" data-path="cap7.html"><a href="cap7.html#para-se-aprofundar-3"><i class="fa fa-check"></i><b>7.8</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cap8.html"><a href="cap8.html"><i class="fa fa-check"></i><b>8</b> Modelos Lineares Generalizados</a>
<ul>
<li class="chapter" data-level="" data-path="cap8.html"><a href="cap8.html#pré-requisitos-do-capítulo-4"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="8.1" data-path="cap8.html"><a href="cap8.html#introdução-2"><i class="fa fa-check"></i><b>8.1</b> Introdução</a></li>
<li class="chapter" data-level="8.2" data-path="cap8.html"><a href="cap8.html#como-um-glm-funciona"><i class="fa fa-check"></i><b>8.2</b> Como um GLM funciona?</a></li>
<li class="chapter" data-level="8.3" data-path="cap8.html"><a href="cap8.html#como-escolher-a-distribuição-correta-para-seus-dados"><i class="fa fa-check"></i><b>8.3</b> Como escolher a distribuição correta para seus dados?</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="cap8.html"><a href="cap8.html#para-dados-contínuos"><i class="fa fa-check"></i><b>8.3.1</b> Para dados contínuos</a></li>
<li class="chapter" data-level="8.3.2" data-path="cap8.html"><a href="cap8.html#para-dados-de-contagem"><i class="fa fa-check"></i><b>8.3.2</b> Para dados de contagem</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="cap8.html"><a href="cap8.html#dados-de-contagem-a-distribuição-de-poisson"><i class="fa fa-check"></i><b>8.4</b> Dados de contagem: a distribuição de Poisson</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="cap8.html"><a href="cap8.html#o-que-causa-a-overdispersion"><i class="fa fa-check"></i><b>8.4.1</b> O que causa a <em>overdispersion</em>?</a></li>
<li class="chapter" data-level="8.4.2" data-path="cap8.html"><a href="cap8.html#o-que-fazer-se-seu-modelo-tiver-overdispersion"><i class="fa fa-check"></i><b>8.4.2</b> O que fazer se seu modelo tiver <em>overdispersion</em>?</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="cap8.html"><a href="cap8.html#dados-de-contagem-modelos-quasi-likelihood"><i class="fa fa-check"></i><b>8.5</b> Dados de contagem: modelos quasi-likelihood</a></li>
<li class="chapter" data-level="8.6" data-path="cap8.html"><a href="cap8.html#dados-de-contagem-a-distribuição-binomial"><i class="fa fa-check"></i><b>8.6</b> Dados de contagem: a distribuição binomial</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="cap8.html"><a href="cap8.html#análise-com-dados-de-proporção"><i class="fa fa-check"></i><b>8.6.1</b> Análise com dados de proporção</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="cap8.html"><a href="cap8.html#análise-com-dados-de-incidência"><i class="fa fa-check"></i><b>8.7</b> Análise com dados de incidência</a></li>
<li class="chapter" data-level="8.8" data-path="cap8.html"><a href="cap8.html#dados-de-contagem-com-excesso-de-zeros"><i class="fa fa-check"></i><b>8.8</b> Dados de contagem com excesso de zeros</a></li>
<li class="chapter" data-level="8.9" data-path="cap8.html"><a href="cap8.html#dados-ordinais-os-modelos-cumulative-link"><i class="fa fa-check"></i><b>8.9</b> Dados ordinais: os modelos cumulative link</a></li>
<li class="chapter" data-level="8.10" data-path="cap8.html"><a href="cap8.html#dados-contínuos-distribuição-beta"><i class="fa fa-check"></i><b>8.10</b> Dados contínuos: distribuição beta</a></li>
<li class="chapter" data-level="8.11" data-path="cap8.html"><a href="cap8.html#para-se-aprofundar-4"><i class="fa fa-check"></i><b>8.11</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cap9.html"><a href="cap9.html"><i class="fa fa-check"></i><b>9</b> Análises Multidimensionais</a>
<ul>
<li class="chapter" data-level="" data-path="cap9.html"><a href="cap9.html#pré-requisitos-do-capítulo-5"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="9.1" data-path="cap9.html"><a href="cap9.html#aspectos-teóricos"><i class="fa fa-check"></i><b>9.1</b> Aspectos teóricos</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="cap9.html"><a href="cap9.html#coeficientes-de-associação"><i class="fa fa-check"></i><b>9.1.1</b> Coeficientes de associação</a></li>
<li class="chapter" data-level="9.1.2" data-path="cap9.html"><a href="cap9.html#métricas-de-distância"><i class="fa fa-check"></i><b>9.1.2</b> Métricas de distância</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="cap9.html"><a href="cap9.html#análises-de-agrupamento"><i class="fa fa-check"></i><b>9.2</b> Análises de agrupamento</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="cap9.html"><a href="cap9.html#agrupamento-hierárquico"><i class="fa fa-check"></i><b>9.2.1</b> Agrupamento hierárquico</a></li>
<li class="chapter" data-level="9.2.2" data-path="cap9.html"><a href="cap9.html#agrupamento-não-hierárquico-k-means"><i class="fa fa-check"></i><b>9.2.2</b> Agrupamento não-hierárquico (<em>K-means</em>)</a></li>
<li class="chapter" data-level="9.2.3" data-path="cap9.html"><a href="cap9.html#espécies-indicadoras"><i class="fa fa-check"></i><b>9.2.3</b> Espécies indicadoras</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="cap9.html"><a href="cap9.html#análises-de-ordenação"><i class="fa fa-check"></i><b>9.3</b> Análises de Ordenação</a></li>
<li class="chapter" data-level="9.4" data-path="cap9.html"><a href="cap9.html#ordenação-irrestrira"><i class="fa fa-check"></i><b>9.4</b> Ordenação irrestrira</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="cap9.html"><a href="cap9.html#análise-de-componentes-principais-pca"><i class="fa fa-check"></i><b>9.4.1</b> Análise de Componentes Principais (PCA)</a></li>
<li class="chapter" data-level="9.4.2" data-path="cap9.html"><a href="cap9.html#análises-de-coordenadas-principais-pcoa"><i class="fa fa-check"></i><b>9.4.2</b> Análises de Coordenadas Principais (PCoA)</a></li>
<li class="chapter" data-level="9.4.3" data-path="cap9.html"><a href="cap9.html#regressão-de-componentes-principais-pcr"><i class="fa fa-check"></i><b>9.4.3</b> Regressão de Componentes Principais (PCR)</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="cap9.html"><a href="cap9.html#ordenação-restrita"><i class="fa fa-check"></i><b>9.5</b> Ordenação restrita</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="cap9.html"><a href="cap9.html#análise-de-redundância-rda"><i class="fa fa-check"></i><b>9.5.1</b> Análise de Redundância (RDA)</a></li>
<li class="chapter" data-level="9.5.2" data-path="cap9.html"><a href="cap9.html#análise-de-redundância-parcial-rdap"><i class="fa fa-check"></i><b>9.5.2</b> Análise de Redundância parcial (RDAp)</a></li>
<li class="chapter" data-level="9.5.3" data-path="cap9.html"><a href="cap9.html#análise-de-redundância-baseada-em-distância-db-rda"><i class="fa fa-check"></i><b>9.5.3</b> Análise de Redundância baseada em distância (db-RDA)</a></li>
<li class="chapter" data-level="9.5.4" data-path="cap9.html"><a href="cap9.html#permanova"><i class="fa fa-check"></i><b>9.5.4</b> PERMANOVA</a></li>
<li class="chapter" data-level="9.5.5" data-path="cap9.html"><a href="cap9.html#análise-de-escalonamento-não-métrico-nmds"><i class="fa fa-check"></i><b>9.5.5</b> Análise de Escalonamento não-Métrico (nMDS)</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="cap9.html"><a href="cap9.html#mantel-e-mantel-parcial"><i class="fa fa-check"></i><b>9.6</b> Mantel e Mantel parcial</a></li>
<li class="chapter" data-level="9.7" data-path="cap9.html"><a href="cap9.html#mantel-espacial-com-modelo-nulo-restrito-considerando-autocorrelação-espacial"><i class="fa fa-check"></i><b>9.7</b> Mantel espacial com modelo nulo restrito considerando autocorrelação espacial</a></li>
<li class="chapter" data-level="9.8" data-path="cap9.html"><a href="cap9.html#procrustes-e-protest"><i class="fa fa-check"></i><b>9.8</b> PROCRUSTES e PROTEST</a></li>
<li class="chapter" data-level="9.9" data-path="cap9.html"><a href="cap9.html#métodos-multivariados-baseados-em-modelos"><i class="fa fa-check"></i><b>9.9</b> Métodos multivariados baseados em modelos</a></li>
<li class="chapter" data-level="9.10" data-path="cap9.html"><a href="cap9.html#para-se-aprofundar-5"><i class="fa fa-check"></i><b>9.10</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cap10.html"><a href="cap10.html"><i class="fa fa-check"></i><b>10</b> Rarefação</a>
<ul>
<li class="chapter" data-level="" data-path="cap10.html"><a href="cap10.html#pré-requisitos-do-capítulo-6"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="10.1" data-path="cap10.html"><a href="cap10.html#aspectos-teóricos-1"><i class="fa fa-check"></i><b>10.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="10.2" data-path="cap10.html"><a href="cap10.html#curva-de-rarefação-baseada-no-indivíduo-individual-based"><i class="fa fa-check"></i><b>10.2</b> Curva de rarefação baseada no indivíduo (<em>individual-based</em>)</a></li>
<li class="chapter" data-level="10.3" data-path="cap10.html"><a href="cap10.html#curva-de-rarefação-baseada-em-amostras-sample-based"><i class="fa fa-check"></i><b>10.3</b> Curva de rarefação baseada em amostras (<em>sample-based</em>)</a></li>
<li class="chapter" data-level="10.4" data-path="cap10.html"><a href="cap10.html#curva-de-rarefação-coverage-based"><i class="fa fa-check"></i><b>10.4</b> Curva de rarefação <em>coverage-based</em></a></li>
<li class="chapter" data-level="10.5" data-path="cap10.html"><a href="cap10.html#para-se-aprofundar-6"><i class="fa fa-check"></i><b>10.5</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="cap11.html"><a href="cap11.html"><i class="fa fa-check"></i><b>11</b> Estimadores de riqueza</a>
<ul>
<li class="chapter" data-level="" data-path="cap11.html"><a href="cap11.html#pré-requisitos-do-capítulo-7"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="11.1" data-path="cap11.html"><a href="cap11.html#aspectos-teóricos-2"><i class="fa fa-check"></i><b>11.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="11.2" data-path="cap11.html"><a href="cap11.html#estimadores-baseados-na-abundância-das-espécies"><i class="fa fa-check"></i><b>11.2</b> Estimadores baseados na abundância das espécies</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="cap11.html"><a href="cap11.html#chao-1"><i class="fa fa-check"></i><b>11.2.1</b> CHAO 1</a></li>
<li class="chapter" data-level="11.2.2" data-path="cap11.html"><a href="cap11.html#ace---abundance-based-coverage-estimador"><i class="fa fa-check"></i><b>11.2.2</b> ACE - <em>Abundance-based Coverage Estimador</em></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="cap11.html"><a href="cap11.html#estimadores-baseados-na-incidência-das-espécies"><i class="fa fa-check"></i><b>11.3</b> Estimadores baseados na incidência das espécies</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="cap11.html"><a href="cap11.html#chao-2"><i class="fa fa-check"></i><b>11.3.1</b> CHAO 2</a></li>
<li class="chapter" data-level="11.3.2" data-path="cap11.html"><a href="cap11.html#jackknife-1"><i class="fa fa-check"></i><b>11.3.2</b> JACKKNIFE 1</a></li>
<li class="chapter" data-level="11.3.3" data-path="cap11.html"><a href="cap11.html#jackknife-2"><i class="fa fa-check"></i><b>11.3.3</b> JACKKNIFE 2</a></li>
<li class="chapter" data-level="11.3.4" data-path="cap11.html"><a href="cap11.html#bootstrap"><i class="fa fa-check"></i><b>11.3.4</b> BOOTSTRAP</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="cap11.html"><a href="cap11.html#interpolação-e-extrapolação-baseadas-em-rarefação-usando-amostragens-de-incidência-ou-abundância"><i class="fa fa-check"></i><b>11.4</b> Interpolação e extrapolação baseadas em rarefação usando amostragens de incidência ou abundância</a></li>
<li class="chapter" data-level="11.5" data-path="cap11.html"><a href="cap11.html#para-se-aprofundar-7"><i class="fa fa-check"></i><b>11.5</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="cap12.html"><a href="cap12.html"><i class="fa fa-check"></i><b>12</b> Diversidade Taxonômica</a>
<ul>
<li class="chapter" data-level="" data-path="cap12.html"><a href="cap12.html#pré-requisitos-do-capítulo-8"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="12.1" data-path="cap12.html"><a href="cap12.html#aspectos-teóricos-3"><i class="fa fa-check"></i><b>12.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="12.2" data-path="cap12.html"><a href="cap12.html#diversidade-alfa"><i class="fa fa-check"></i><b>12.2</b> Diversidade alfa</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="cap12.html"><a href="cap12.html#riqueza-de-espécies-ou-número-de-espécies"><i class="fa fa-check"></i><b>12.2.1</b> Riqueza de espécies ou número de espécies</a></li>
<li class="chapter" data-level="12.2.2" data-path="cap12.html"><a href="cap12.html#diversidade-de-espécies"><i class="fa fa-check"></i><b>12.2.2</b> Diversidade de espécies</a></li>
<li class="chapter" data-level="12.2.3" data-path="cap12.html"><a href="cap12.html#diagramas-de-whittaker-ou-curva-de-dominância"><i class="fa fa-check"></i><b>12.2.3</b> Diagramas de Whittaker ou Curva de Dominância</a></li>
<li class="chapter" data-level="12.2.4" data-path="cap12.html"><a href="cap12.html#curvas-de-distribuição-de-abundâncias"><i class="fa fa-check"></i><b>12.2.4</b> Curvas de distribuição de abundâncias</a></li>
<li class="chapter" data-level="12.2.5" data-path="cap12.html"><a href="cap12.html#números-de-hill-ou-série-de-hill"><i class="fa fa-check"></i><b>12.2.5</b> Números de Hill ou Série de Hill</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="cap12.html"><a href="cap12.html#diversidade-beta"><i class="fa fa-check"></i><b>12.3</b> Diversidade beta</a></li>
<li class="chapter" data-level="12.4" data-path="cap12.html"><a href="cap12.html#para-se-aprofundar-8"><i class="fa fa-check"></i><b>12.4</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="cap13.html"><a href="cap13.html"><i class="fa fa-check"></i><b>13</b> Diversidade Filogenética</a>
<ul>
<li class="chapter" data-level="" data-path="cap13.html"><a href="cap13.html#pré-requisitos-do-capítulo-9"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="13.1" data-path="cap13.html"><a href="cap13.html#aspectos-teóricos-4"><i class="fa fa-check"></i><b>13.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="13.2" data-path="cap13.html"><a href="cap13.html#manipulação-de-filogenias"><i class="fa fa-check"></i><b>13.2</b> Manipulação de filogenias</a></li>
<li class="chapter" data-level="13.3" data-path="cap13.html"><a href="cap13.html#métricas-de-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>13.3</b> Métricas de diversidade alfa filogenética</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="cap13.html"><a href="cap13.html#riqueza-da-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>13.3.1</b> Riqueza da diversidade alfa filogenética</a></li>
<li class="chapter" data-level="13.3.2" data-path="cap13.html"><a href="cap13.html#divergência-da-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>13.3.2</b> Divergência da diversidade alfa filogenética</a></li>
<li class="chapter" data-level="13.3.3" data-path="cap13.html"><a href="cap13.html#regularidade-da-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>13.3.3</b> Regularidade da diversidade alfa filogenética</a></li>
<li class="chapter" data-level="13.3.4" data-path="cap13.html"><a href="cap13.html#correlação-entre-as-métricas-de-diversidade-alfa-filogenética"><i class="fa fa-check"></i><b>13.3.4</b> Correlação entre as métricas de diversidade alfa filogenética</a></li>
<li class="chapter" data-level="13.3.5" data-path="cap13.html"><a href="cap13.html#associação-entre-a-diversidade-alfa-filogenética-e-o-ambiente"><i class="fa fa-check"></i><b>13.3.5</b> Associação entre a diversidade alfa filogenética e o ambiente</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="cap13.html"><a href="cap13.html#métricas-de-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>13.4</b> Métricas de diversidade beta filogenética</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="cap13.html"><a href="cap13.html#divergência-da-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>13.4.1</b> Divergência da diversidade beta filogenética</a></li>
<li class="chapter" data-level="13.4.2" data-path="cap13.html"><a href="cap13.html#correlação-entre-as-métricas-de-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>13.4.2</b> Correlação entre as métricas de diversidade beta filogenética</a></li>
<li class="chapter" data-level="13.4.3" data-path="cap13.html"><a href="cap13.html#associação-entre-a-divergência-da-diversidade-beta-filogenética-e-o-ambiente"><i class="fa fa-check"></i><b>13.4.3</b> Associação entre a divergência da diversidade beta filogenética e o ambiente</a></li>
<li class="chapter" data-level="13.4.4" data-path="cap13.html"><a href="cap13.html#riqueza-da-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>13.4.4</b> Riqueza da diversidade beta filogenética</a></li>
<li class="chapter" data-level="13.4.5" data-path="cap13.html"><a href="cap13.html#correlação-entre-phylosor-e-unifrac"><i class="fa fa-check"></i><b>13.4.5</b> Correlação entre Phylosor e Unifrac</a></li>
<li class="chapter" data-level="13.4.6" data-path="cap13.html"><a href="cap13.html#associação-entre-a-riqueza-da-diversidade-beta-filogenética-e-o-ambiente"><i class="fa fa-check"></i><b>13.4.6</b> Associação entre a riqueza da diversidade beta filogenética e o ambiente</a></li>
<li class="chapter" data-level="13.4.7" data-path="cap13.html"><a href="cap13.html#partição-da-diversidade-beta-filogenética"><i class="fa fa-check"></i><b>13.4.7</b> Partição da diversidade beta filogenética</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="cap13.html"><a href="cap13.html#modelos-nulos"><i class="fa fa-check"></i><b>13.5</b> Modelos Nulos</a></li>
<li class="chapter" data-level="13.6" data-path="cap13.html"><a href="cap13.html#para-se-aprofundar-9"><i class="fa fa-check"></i><b>13.6</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="cap14.html"><a href="cap14.html"><i class="fa fa-check"></i><b>14</b> Diversidade Funcional</a>
<ul>
<li class="chapter" data-level="" data-path="cap14.html"><a href="cap14.html#pré-requisitos-do-capítulo-10"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="14.1" data-path="cap14.html"><a href="cap14.html#aspectos-teóricos-5"><i class="fa fa-check"></i><b>14.1</b> Aspectos teóricos</a></li>
<li class="chapter" data-level="14.2" data-path="cap14.html"><a href="cap14.html#definindo-a-dissimilaridade-entre-espécies"><i class="fa fa-check"></i><b>14.2</b> Definindo a dis(similaridade) entre espécies</a></li>
<li class="chapter" data-level="14.3" data-path="cap14.html"><a href="cap14.html#métricas-de-diversidade-funcional-alfa"><i class="fa fa-check"></i><b>14.3</b> Métricas de diversidade funcional (alfa)</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="cap14.html"><a href="cap14.html#riqueza-funcional"><i class="fa fa-check"></i><b>14.3.1</b> Riqueza funcional</a></li>
<li class="chapter" data-level="14.3.2" data-path="cap14.html"><a href="cap14.html#divergência-funcional"><i class="fa fa-check"></i><b>14.3.2</b> Divergência funcional</a></li>
<li class="chapter" data-level="14.3.3" data-path="cap14.html"><a href="cap14.html#regularidade-funcional"><i class="fa fa-check"></i><b>14.3.3</b> Regularidade funcional</a></li>
<li class="chapter" data-level="14.3.4" data-path="cap14.html"><a href="cap14.html#correlação-entre-as-métricas-de-diversidade-funcional-alfa"><i class="fa fa-check"></i><b>14.3.4</b> Correlação entre as métricas de diversidade funcional (alfa)</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="cap14.html"><a href="cap14.html#métricas-de-diversidade-funcional-beta"><i class="fa fa-check"></i><b>14.4</b> Métricas de diversidade funcional (beta)</a></li>
<li class="chapter" data-level="14.5" data-path="cap14.html"><a href="cap14.html#composição-funcional-community-wegihed-means---cwm"><i class="fa fa-check"></i><b>14.5</b> Composição Funcional (<em>Community Wegihed Means</em> - CWM)</a></li>
<li class="chapter" data-level="14.6" data-path="cap14.html"><a href="cap14.html#variação-intraspecífica"><i class="fa fa-check"></i><b>14.6</b> Variação Intraspecífica</a></li>
<li class="chapter" data-level="14.7" data-path="cap14.html"><a href="cap14.html#para-se-aprofundar-10"><i class="fa fa-check"></i><b>14.7</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="cap15.html"><a href="cap15.html"><i class="fa fa-check"></i><b>15</b> Dados geoespaciais no R</a>
<ul>
<li class="chapter" data-level="" data-path="cap15.html"><a href="cap15.html#pré-requisitos-do-capítulo-11"><i class="fa fa-check"></i>Pré-requisitos do capítulo</a></li>
<li class="chapter" data-level="15.1" data-path="cap15.html"><a href="cap15.html#contextualização-3"><i class="fa fa-check"></i><b>15.1</b> Contextualização</a></li>
<li class="chapter" data-level="15.2" data-path="cap15.html"><a href="cap15.html#vetor"><i class="fa fa-check"></i><b>15.2</b> Vetor</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="cap15.html"><a href="cap15.html#sf-principal-pacote-no-r-para-dados-vetoriais"><i class="fa fa-check"></i><b>15.2.1</b> sf: principal pacote no R para dados vetoriais</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="cap15.html"><a href="cap15.html#raster"><i class="fa fa-check"></i><b>15.3</b> Raster</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="cap15.html"><a href="cap15.html#raster-principal-pacote-no-r-para-dados-raster"><i class="fa fa-check"></i><b>15.3.1</b> raster: principal pacote no R para dados raster</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="cap15.html"><a href="cap15.html#sistema-de-referência-de-coordenadas-e-unidades"><i class="fa fa-check"></i><b>15.4</b> Sistema de Referência de Coordenadas e Unidades</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="cap15.html"><a href="cap15.html#sistema-de-coordenadas-geográficas"><i class="fa fa-check"></i><b>15.4.1</b> Sistema de Coordenadas Geográficas</a></li>
<li class="chapter" data-level="15.4.2" data-path="cap15.html"><a href="cap15.html#sistema-de-coordenadas-projetadas"><i class="fa fa-check"></i><b>15.4.2</b> Sistema de Coordenadas Projetadas</a></li>
<li class="chapter" data-level="15.4.3" data-path="cap15.html"><a href="cap15.html#datum"><i class="fa fa-check"></i><b>15.4.3</b> Datum</a></li>
<li class="chapter" data-level="15.4.4" data-path="cap15.html"><a href="cap15.html#sistema-de-referência-de-coordenadas-crs-no-r"><i class="fa fa-check"></i><b>15.4.4</b> Sistema de Referência de Coordenadas (CRS) no R</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="cap15.html"><a href="cap15.html#principais-fontes-de-dados-geoespaciais"><i class="fa fa-check"></i><b>15.5</b> Principais fontes de dados geoespaciais</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="cap15.html"><a href="cap15.html#vetor-1"><i class="fa fa-check"></i><b>15.5.1</b> Vetor</a></li>
<li class="chapter" data-level="15.5.2" data-path="cap15.html"><a href="cap15.html#raster-1"><i class="fa fa-check"></i><b>15.5.2</b> Raster</a></li>
<li class="chapter" data-level="15.5.3" data-path="cap15.html"><a href="cap15.html#pacotes-do-r"><i class="fa fa-check"></i><b>15.5.3</b> Pacotes do R</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="cap15.html"><a href="cap15.html#importar-e-exportar-dados-geoespaciais"><i class="fa fa-check"></i><b>15.6</b> Importar e exportar dados geoespaciais</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="cap15.html"><a href="cap15.html#principais-formatos-de-arquivos-geoespaciais"><i class="fa fa-check"></i><b>15.6.1</b> Principais formatos de arquivos geoespaciais</a></li>
<li class="chapter" data-level="15.6.2" data-path="cap15.html"><a href="cap15.html#importar-dados-1"><i class="fa fa-check"></i><b>15.6.2</b> Importar dados</a></li>
<li class="chapter" data-level="15.6.3" data-path="cap15.html"><a href="cap15.html#exportar-dados-1"><i class="fa fa-check"></i><b>15.6.3</b> Exportar dados</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="cap15.html"><a href="cap15.html#descrição-de-objetos-geoespaciais"><i class="fa fa-check"></i><b>15.7</b> Descrição de objetos geoespaciais</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="cap15.html"><a href="cap15.html#vetor-2"><i class="fa fa-check"></i><b>15.7.1</b> Vetor</a></li>
<li class="chapter" data-level="15.7.2" data-path="cap15.html"><a href="cap15.html#raster-2"><i class="fa fa-check"></i><b>15.7.2</b> Raster</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="cap15.html"><a href="cap15.html#reprojeção-de-dados-geoespaciais"><i class="fa fa-check"></i><b>15.8</b> Reprojeção de dados geoespaciais</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="cap15.html"><a href="cap15.html#vetor-3"><i class="fa fa-check"></i><b>15.8.1</b> Vetor</a></li>
<li class="chapter" data-level="15.8.2" data-path="cap15.html"><a href="cap15.html#raster-3"><i class="fa fa-check"></i><b>15.8.2</b> Raster</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="cap15.html"><a href="cap15.html#principais-operações-com-dados-geoespaciais"><i class="fa fa-check"></i><b>15.9</b> Principais operações com dados geoespaciais</a>
<ul>
<li class="chapter" data-level="15.9.1" data-path="cap15.html"><a href="cap15.html#operações-de-atributos"><i class="fa fa-check"></i><b>15.9.1</b> Operações de atributos</a></li>
<li class="chapter" data-level="15.9.2" data-path="cap15.html"><a href="cap15.html#operações-espaciais"><i class="fa fa-check"></i><b>15.9.2</b> Operações espaciais</a></li>
<li class="chapter" data-level="15.9.3" data-path="cap15.html"><a href="cap15.html#operações-geométricas"><i class="fa fa-check"></i><b>15.9.3</b> Operações geométricas</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="cap15.html"><a href="cap15.html#visualização-de-dados-geoespaciais"><i class="fa fa-check"></i><b>15.10</b> Visualização de dados geoespaciais</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="cap15.html"><a href="cap15.html#principais-elementos-de-um-mapa"><i class="fa fa-check"></i><b>15.10.1</b> Principais elementos de um mapa</a></li>
<li class="chapter" data-level="15.10.2" data-path="cap15.html"><a href="cap15.html#principais-pacotes-para-a-composição-de-mapas"><i class="fa fa-check"></i><b>15.10.2</b> Principais pacotes para a composição de mapas</a></li>
<li class="chapter" data-level="15.10.3" data-path="cap15.html"><a href="cap15.html#mapas-estáticos"><i class="fa fa-check"></i><b>15.10.3</b> Mapas estáticos</a></li>
<li class="chapter" data-level="15.10.4" data-path="cap15.html"><a href="cap15.html#mapas-animados"><i class="fa fa-check"></i><b>15.10.4</b> Mapas animados</a></li>
<li class="chapter" data-level="15.10.5" data-path="cap15.html"><a href="cap15.html#mapas-interativos"><i class="fa fa-check"></i><b>15.10.5</b> Mapas interativos</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="cap15.html"><a href="cap15.html#exemplos-de-aplicações-de-análises-geoespaciais-para-dados-ecológicos"><i class="fa fa-check"></i><b>15.11</b> Exemplos de aplicações de análises geoespaciais para dados ecológicos</a>
<ul>
<li class="chapter" data-level="15.11.1" data-path="cap15.html"><a href="cap15.html#resumir-informações-de-biodiversidade-para-unidades-espaciais"><i class="fa fa-check"></i><b>15.11.1</b> Resumir informações de biodiversidade para unidades espaciais</a></li>
<li class="chapter" data-level="15.11.2" data-path="cap15.html"><a href="cap15.html#extrair-dados-raster-para-pontos"><i class="fa fa-check"></i><b>15.11.2</b> Extrair dados raster para pontos</a></li>
<li class="chapter" data-level="15.11.3" data-path="cap15.html"><a href="cap15.html#resumir-dados-de-rasters-para-buffers"><i class="fa fa-check"></i><b>15.11.3</b> Resumir dados de rasters para buffers</a></li>
<li class="chapter" data-level="15.11.4" data-path="cap15.html"><a href="cap15.html#predições-espaciais-de-objetos-raster"><i class="fa fa-check"></i><b>15.11.4</b> Predições espaciais de objetos raster</a></li>
</ul></li>
<li class="chapter" data-level="15.12" data-path="cap15.html"><a href="cap15.html#para-se-aprofundar-11"><i class="fa fa-check"></i><b>15.12</b> Para se aprofundar</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referências.html"><a href="referências.html"><i class="fa fa-check"></i>Referências</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análises Ecológicas no R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cap9" class="section level1" number="9">
<h1><span class="header-section-number">Capítulo 9</span> Análises Multidimensionais</h1>
<div id="pré-requisitos-do-capítulo-5" class="section level2 unnumbered">
<h2>Pré-requisitos do capítulo</h2>
<p>Pacotes e dados que serão utilizados neste capítulo.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="cap9.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Pacotes</span></span>
<span id="cb340-2"><a href="cap9.html#cb340-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ade4)</span>
<span id="cb340-3"><a href="cap9.html#cb340-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecodados)</span>
<span id="cb340-4"><a href="cap9.html#cb340-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb340-5"><a href="cap9.html#cb340-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb340-6"><a href="cap9.html#cb340-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pvclust)</span>
<span id="cb340-7"><a href="cap9.html#cb340-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BiodiversityR)</span>
<span id="cb340-8"><a href="cap9.html#cb340-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(labdsv)</span>
<span id="cb340-9"><a href="cap9.html#cb340-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb340-10"><a href="cap9.html#cb340-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb340-11"><a href="cap9.html#cb340-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb340-12"><a href="cap9.html#cb340-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb340-13"><a href="cap9.html#cb340-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb340-14"><a href="cap9.html#cb340-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FD)</span>
<span id="cb340-15"><a href="cap9.html#cb340-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb340-16"><a href="cap9.html#cb340-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb340-17"><a href="cap9.html#cb340-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fields)</span>
<span id="cb340-18"><a href="cap9.html#cb340-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ade4)</span>
<span id="cb340-19"><a href="cap9.html#cb340-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggord)</span>
<span id="cb340-20"><a href="cap9.html#cb340-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(udunits2)</span>
<span id="cb340-21"><a href="cap9.html#cb340-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(adespatial)</span>
<span id="cb340-22"><a href="cap9.html#cb340-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb340-23"><a href="cap9.html#cb340-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb340-24"><a href="cap9.html#cb340-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb340-25"><a href="cap9.html#cb340-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-26"><a href="cap9.html#cb340-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados</span></span>
<span id="cb340-27"><a href="cap9.html#cb340-27" aria-hidden="true" tabindex="-1"></a>sp_compos <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>bocaina</span>
<span id="cb340-28"><a href="cap9.html#cb340-28" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>com_birds</span>
<span id="cb340-29"><a href="cap9.html#cb340-29" aria-hidden="true" tabindex="-1"></a>env <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>env_birds</span>
<span id="cb340-30"><a href="cap9.html#cb340-30" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> ecodados<span class="sc">::</span>birds.xy</span>
<span id="cb340-31"><a href="cap9.html#cb340-31" aria-hidden="true" tabindex="-1"></a>bocaina.env <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;dados/bocaina_env.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="at">row.names =</span> <span class="st">&quot;X&quot;</span>)</span>
<span id="cb340-32"><a href="cap9.html#cb340-32" aria-hidden="true" tabindex="-1"></a>bocaina.xy <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;dados/bocaina_xy.txt&quot;</span>, <span class="at">h =</span> T)</span>
<span id="cb340-33"><a href="cap9.html#cb340-33" aria-hidden="true" tabindex="-1"></a>anuros_permanova <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;dados/anuros_permanova.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">row.names =</span> <span class="st">&quot;X&quot;</span>)</span>
<span id="cb340-34"><a href="cap9.html#cb340-34" aria-hidden="true" tabindex="-1"></a>macroinv <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;dados/macroinv.csv&quot;</span>, <span class="at">row.names =</span> <span class="st">&quot;X&quot;</span>)</span>
<span id="cb340-35"><a href="cap9.html#cb340-35" aria-hidden="true" tabindex="-1"></a>fish <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;dados/fish.csv&quot;</span>, <span class="at">row.names =</span> <span class="st">&quot;X&quot;</span>)</span>
<span id="cb340-36"><a href="cap9.html#cb340-36" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mite)</span>
<span id="cb340-37"><a href="cap9.html#cb340-37" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(doubs)</span>
<span id="cb340-38"><a href="cap9.html#cb340-38" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mite.env)</span></code></pre></div>
</div>
<div id="aspectos-teóricos" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Aspectos teóricos</h2>
<p>Análises multivariadas avaliam hipóteses cuja variável resposta é definida por múltiplas variáveis ao mesmo tempo, comumente expressa na forma de uma matriz quadrada ou de distância (dissimilaridade).</p>
<p>Em geral, análises multivariadas têm três principais utilidades: i) reduzir a dimensionalidade dos dados e encontrar a principal direção de variação dos dados, ii) testar relações entre matrizes, ou ainda, iii) encontrar diferenças entre grupos. Análises multivariadas podem ser utilizadas como análises exploratórias e/ou para descrever padrões em estudos ecológicos. No entanto, mesmo quando se deseja apenas explorar o conjunto de dados para encontrar possíveis padrões, a necessidade de se ter hipóteses, ou ao menos expectativas <em>a priori</em>, não pode ser ignorada. Antes de entrar de cabeça nas análises multivariadas, também sugerimos fortemente o estudo de métodos de amostragem e como fazer boas perguntas (Capítulo <a href="cap2.html#cap2">2</a>).</p>
<p>Análises multivariadas podem ser divididas, grosseiramente, em dois tipos: agrupamento e ordenação. Análises de agrupamento, em geral, tentam agrupar objetos (observações) ou descritores em grupos de maneira que objetos do mesmo grupo sejam mais semelhantes entre si do que objetos de outros grupos <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. Por exemplo, os objetos podem ser localidades como “parcelas,” “riachos” ou “florestas,” enquanto os descritores são as difentes variáveis coletadas para esses objetos (e.g., espécies, variáveis ambientais). A análise de ordenação, por sua vez, é uma operação pela qual os objetos (ou descritores) são posicionados num espaço que contém menos dimensões que o conjunto de dados original; a posição dos objetos ou descritores em relação aos outros também pode ser usada para agrupá-los.</p>
<p>Vamos começar com análises de agrupamento. Aqui vamos exemplificar dois métodos: uma técnica de agrupamento hierárquica (dendrograma) e outra não-hierárquica (k-means).</p>
<div id="coeficientes-de-associação" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Coeficientes de associação</h3>
<p>Assim chamados genericamente, os coeficientes de associação medem o quão parecidos objetos ou descritores são entre si. Objetos estão nas linhas da matriz, enquanto descritores estão nas colunas. Geralmente objetos são as nossas unidades amostrais, enquanto os descritores são as variáveis preditoras e resposta. Quando analisamos a relação entre objetos fazemos uma análise no modo Q, ao passo que o modo R é quando analisamos a relação entre descritores. Coeficientes de associação do modo Q são medidas de (dis)similaridade ou distância, enquanto para o modo R utilizamos covariância ou correlação. Como já tratamos neste livro sobre covariância e correlação (ver <a href="cap7.html#cap7">7</a>), neste tópico vamos falar sobre índices de distância e similaridade. Mas qual a definição destas duas quantitades?</p>
<ul>
<li>Similaridade são máximas (<em>S=1</em>) quando dois objetos são idênticos</li>
<li>Distâncias são o contrário da similaridade (<em>D=1-S</em>) e não têm limites superiores (dependem da unidade de medida)</li>
</ul>
<p>Existem ao menos 26 índices de similaridade que podem ser agrupados de acordo com o tipo de dado (qualitativos ou quantitativos) ou a maneira com que lidam com duplos zeros (simétricos ou assimétricos) <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. Do seu lado, as distâncias só se aplicam a dados quantitativos e têm como características serem métricas, semi-métricas ou não-métricas. Vejamos agora os principais índices de similaridade e distância de cada tipo.</p>
</div>
<div id="métricas-de-distância" class="section level3" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Métricas de distância</h3>
<p>O principal coeficiente de distância usado em ecologia é a distância euclidiana. Além disso, temos ainda Canberra, Mahalanobis (calcula a distância entre dois pontos num espaço não ortogonal, levando em consideração a covariância entre descritores), Manhattan, Chord (elimina diferenças entre abundância total de espécies), 𝜒2 (dá peso maior para espécies raras), Hellinger (não dá peso para espécies raras). Essas distâncias são recomendadas nos casos em que as variáveis de estudo forem contínuas, como por exemplo, <strong>variáveis morfométricas ou descritores ambientais</strong>.</p>
<p>Uma característica comum de conjuntos de dados ecológicos são os vários zeros encontrados em matrizes de composição. Eles surgem porque não encontramos nenhum indivíduo de uma determinada espécie num local, seja porque aquele local não tem as condições ambientais adequadas a ela, falha na detectabilidade, ou dinâmicas demográficas estocásticas de colonização-extinção <span class="citation">(<a href="#ref-blascomoreno2019" role="doc-biblioref">Blasco‐Moreno et al., 2019</a>)</span>. Logo, quando dois locais compartilham ausência de espécies, não é possível atribuir uma única razão da dupla ausência. Como essas medidas de distância apresentadas acima assumem que os dados são quantitativos e não de contagem, elas não são adequadas para lidar com dados de abundância ou incidência de espécies, porque atribuem um grau de parecênça a pares de locais que compartilham zeros <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. Por esse motivo, precisamos de coeficientes que desconsiderem os duplos zeros. Eles são chamados de <em>assimétricos</em>.</p>
<p><strong>Coeficientes assimétricos binários para objetos</strong></p>
<p>Esses coeficientes (ou índices) são apropriados para dados de incidência de espécies (presença-ausência) e desconsideram as duplas ausências. Os índices deste tipo mais comuns utilizados em ecologia são Sørensen, Jaccard e Ochiai.</p>
<p><span class="math display">\[\beta_j = a/(a+b+c)\]</span>
onde</p>
<ul>
<li><em>a</em> = número de espécies compartilhadas</li>
<li><em>b</em> = número de espécies exclusivas da comunidade 1</li>
<li><em>c</em> = número de espécies exclusivas da comunidade 2</li>
</ul>
<p>A diferença entre os índices de Jaccard e Sørensen é que o índice de Sørensen dá peso dobrado para duplas presenças. Por conta dessas características, estes índices são adequados para quantificar diversidade beta <span class="citation">(<a href="#ref-anderson2010" role="doc-biblioref">M. J. Anderson et al., 2011</a>; <a href="#ref-legendre2013" role="doc-biblioref">Legendre &amp; De Cáceres, 2013</a>)</span>. Esses índices variam entre 0 (nenhuma espécie é compartilhada entre o par de locais) a 1 (todas as espécies são compartilhadas entre o par de locais).</p>
<p><span class="math display">\[\beta_s = 2a/(2a+b+c)\]</span>
onde</p>
<ul>
<li><em>a</em> = número de espécies compartilhadas</li>
<li><em>b</em> = número de espécies exclusivas da comunidade 1</li>
<li><em>c</em> = número de espécies exclusivas da comunidade 2</li>
</ul>
<p><strong>Coeficientes binários para descritores (R mode)</strong></p>
<p>Se o objetivo for calcular a similaridade entre descritores binários (e.g., presença ou ausência de características ambientais) de pares de locais, geralmente o coeficiente recomendado é o de Sokal &amp; Michener. Este índice está implementado na <code>ade4::dist.binary()</code>.</p>
<p><strong>Coeficientes quantitativos para objetos</strong></p>
<p>Estes são os coeficientes utilizados para dados de contagem (e.g., abundância) e quantitativos (e.g., frequência, biomassa, porcentagem cobertura). Diferentemente das distâncias, estes coeficientes são assimétricos, ou seja, não consideram duplas ausências, e portanto, são adequados para analisar dados de composição de espécies. Além disso, uma outra característica deles é serem semi-métricos. Os índices mais comuns deste tipo são Bray-Curtis (conhecido como <em>percentage difference</em>, em inglês), Chord, log-Chord, Hellinger, chi-quadrado e Morisita-Horn.</p>
<p>Todos os índices discutidos até aqui estão implementados nas funções <code>ade4::dist.ktab()</code>, <code>adespatial::dist.ldc()</code> e <code>vegan::vegdist()</code>.</p>
<p><strong>Coeficientes para descritores (R mode) que incluem mistura de tipos de dados</strong></p>
<p>É comum em análises de diversidade funcional que tenhamos um conjunto de atributos (<em>traits</em>) de espécies que são formados por vários tipos de dados: quantitativos (e.g., tamanho de corpo), binários (presença/ausência de uma dada característica), fuzzy (um atributo multiestado descrito codificado em várias colunas com porcentagem), ordinais e circulares (e.g., distribuição de uma fenofase ao longo de um ano). O índice que lida com todos esses dados é o Gower. A versão extendida do índice de Gower pode ser encontrada na função <code>ade4::dist.ktab().</code></p>
<p>O capítulo 7 de <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span> fornece uma chave dicotômica para escolha do índice mais adequado.</p>
<p><strong>Padronizações e transformações</strong></p>
<p>É comum coletarmos múltiplas variáveis ambientais cujas unidades sejam diferentes. Por exemplo, temperatura (ºC), distância da margem (m), área (m<sup>2</sup>), etc. Para diminuir a taxa de Erro do Tipo I das análises (rejeitar a hipótese nula quando ela é verdadeira), é recomendado que <strong><em>padronizemos</em></strong> os dados utilizando distribuição <em>Z</em>, assim todas as variáveis passam a ter média 0 e desvio padrão 1. Essa operação garante que todas as variáveis tenham o mesmo peso nas análises que avaliam o padrão dos objetos considerando os múltiplos descritores. Essa padronização pode ser implementada na função <code>vegan::decostand()</code>.</p>
<p>Um outro problema comum de matrizes de dados de composição de espécies é o alto número de zeros, enquanto outras espécies podem ter altas abundâncias. Isso gera problemas em ordenações. Para diminuir essa discrepância, podemos <strong>transformar</strong> os dados, por exemplo, utilizando a distância de Hellinger ou Chord. Para dados contínuos pode ser que transformação log ou raiz quadrada ajude quando há valores muito discrepantes (<em>leverages</em>) que podem influenciar em demasiado a relação entre objetos ou descritores. Isso pode ser feito na função <code>vegan::decostand()</code>.</p>
</div>
</div>
<div id="análises-de-agrupamento" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Análises de agrupamento</h2>
<p>O objetivo da análise de agrupamento é agrupar objetos admitindo que haja um grau de similaridade entre eles. Esta análise pode ser utilizada ainda para classificar uma população em grupos homogêneos de acordo com uma característica de interesse. A grosso modo, uma análise de agrupamento tenta resumir uma grande quantidade de dados e apresentá-la de maneira fácil de visualizar e entender (em geral, na forma de um dendrograma). No entanto, os resultados da análise podem não refletir necessariamente toda a informação originalmente contida na matriz de dados. Para avaliar o quão bem uma análise de agrupamento representa os dados originais existe uma métrica — o coeficiente de correlação cofenético — o qual discutiremos em detalhes mais adiante.</p>
<p>Antes de considerar algum método de agrupamento, pense porque você esperaria que houvesse uma descontinuidade nos dados; ou ainda, considere se existe algum ganho prático em dividir uma nuvem de objetos contínuos em grupos. O padrão apresentado pelo dendograma depende do protocolo utilizado (método de agrupamento e índice de dissimilaridade); os grupos formados dependem do nível de corte escolhido.</p>
<p>A matriz deve conter os objetos a serem agrupados (e.g., espécies) nas linhas e as variáveis (e.g., locais de coleta ou medidas morfológicas) nas colunas. A escolha do método de agrupamento é crítico para a escolha de um coeficiente de associação. É importante compreender as propriedades dos métodos de agrupamento para interpretar corretamente a estrutura ecológica que eles evidenciam <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. De acordo com a classificação de Sneath &amp; Sokal <span class="citation">(<a href="#ref-sneath_numerical_1973" role="doc-biblioref">1973</a>)</span>, existem cinco tipos de métodos: i) sequenciais ou simultâneos, ii) aglomerativo ou divisivo, iii) monotéticos ou politéticos, iv) hierárquico ou não hierárquicos e v) probabilístico. Sugerimos a leitura do artigo citado anteriormente para aprofundar seus conhecimentos sobre os diferentes métodos.</p>
<div id="agrupamento-hierárquico" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Agrupamento hierárquico</h3>
<p>Métodos hierárquicos podem ser divididos naqueles que consideram o centróide ou a média aritmética entre os grupos. O principal método hierárquico que utiliza a média aritmética é o UPGMA (Agrupamento pelas médias aritméticas não ponderadas), e o principal método que utiliza centróides é a Distância mínima de Ward.</p>
<p>O UPGMA funciona da seguinte forma: a maior similaridade (ou menor distância) identifica os próximos agrupamentos a serem formados. Após esse evento, o método calcula a média aritmética das similaridades ou distâncias entre um objeto e cada um dos membros do grupo ou, no caso de um grupo previamente formado, entre todos os membros dos dois grupos. Todos os objetos recebem pesos iguais no cálculo.</p>
<p>O método de Ward é baseado no critério de quadrados mínimos (OLS), o mesmo utilizado para ajustar um modelo linear (Capítulo <a href="cap7.html#cap7">7</a>). O objetivo é definir os grupos de maneira que a soma de quadrados (i.e. similar ao erro quadrado da ANOVA) dentro dos grupos seja minimizada <span class="citation">(<a href="#ref-borcard2018" role="doc-biblioref">Borcard et al., 2018</a>)</span>.</p>
<p>No entanto, para interpretar os resultados precisamos antes definir um nível de corte, que vai nos dizer quantos grupos existem. Há vários métodos para definir grupos, desde os heurísticos aos que utilizam reamostragem (<em>bootstrap</em>). Se quisermos interpretar este dendrograma, podemos, por exemplo, estabelecer um nível de corte de 50% de distância (ou seja, grupos cujos objetos tenham ao menos 50% de similaridade entre si).</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Verifique se não há espaço nos nomes das colunas e linhas</p></li>
<li><p>Se os dados forem de abundância, recomenda-se realizar a transformação de Hellinger <span class="citation">(<a href="#ref-legendre2001" role="doc-biblioref">Legendre &amp; Gallagher, 2001</a>)</span>. Esta transformação é necessária porque a matriz de comunidades (em especial, com a presença de muitas espécies raras) pode causar distorções nos métodos de ordenação baseados em distância Euclidiana <span class="citation">(<a href="#ref-legendre2001" role="doc-biblioref">Legendre &amp; Gallagher, 2001</a>)</span></p></li>
<li><p>Se a matriz original contiver muitos valores discrepantes (e.g., uma espécie muito mais ou muito menos abundante que outras) é necessário transformar os dados usando <code>log1p()</code>. No entanto, deve-se fazer ou a transformação de Hellinger ou log e nunca as duas ao mesmo tempo</p></li>
<li><p>Se as variáveis forem medidas tomadas em diferentes escalas (metros, graus celsius etc.), é necessário padronizar cada variável para ter a média 0 e desvio padrão 1. Isso pode ser feito utulizando a função <code>decostand()</code> do pacote <code>vegan</code></p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar um conjunto de dados que contém girinos de espécies de anuros coletados em 14 poças com diferentes coberturas de dossel <span class="citation">(<a href="#ref-provete_broad-scale_2014" role="doc-biblioref">Provete et al., 2014</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existem grupos de espécies de anfíbios anuros com padrões de ocorrência similar ao longo das poças?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Iremos encontrar ao menos dois grupos de espécies: aquelas que ocorrem em poças dentro de floresta (i.e., maior cobertura de dossel) <em>vesus</em> aquelas que ocorrem em poças de áreas abertas (menor cobertura de dossel)</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis preditoras: a matriz de dados contém a abundância das espécies nas linhas e locais (poças) nas colunas</li>
</ul>
<p><strong>Análises</strong></p>
<p>Para começar, vamos primeiro importar os dados e depois calcular a matriz de distância que seja adequada para o tipo de dado que temos (abundância de espécies - dados de contagem) (Figura <a href="cap9.html#fig:fig-dend">9.1</a>).</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="cap9.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Composição de espécies (seis primeiras localidades)</span></span>
<span id="cb341-2"><a href="cap9.html#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sp_compos)</span>
<span id="cb341-3"><a href="cap9.html#cb341-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         BP4  PP4 PP3  AP1 AP2 PP1 PP2 BP9  PT1 PT2 PT3 BP2 PT5</span></span>
<span id="cb341-4"><a href="cap9.html#cb341-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Aper      0    3   0    0   2   0   0   0    0   0   0 181   0</span></span>
<span id="cb341-5"><a href="cap9.html#cb341-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bahe    859   14  14    0  87 312 624 641    0   0   0  14   0</span></span>
<span id="cb341-6"><a href="cap9.html#cb341-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rict   1772 1517 207  573 796   0   0   0    0   0   0   0   0</span></span>
<span id="cb341-7"><a href="cap9.html#cb341-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cleuco    0    0   0    0   0   0   0   0    0  29 369   0  84</span></span>
<span id="cb341-8"><a href="cap9.html#cb341-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dmic      0    0   6   60   4   0   0   0 2758 319  25   0 329</span></span>
<span id="cb341-9"><a href="cap9.html#cb341-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dmin      0   84 344 1045  90   0   0   0    8   0   0   0   0</span></span>
<span id="cb341-10"><a href="cap9.html#cb341-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-11"><a href="cap9.html#cb341-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Matriz de similaridade com o coeficiente de Morisita-Horn</span></span>
<span id="cb341-12"><a href="cap9.html#cb341-12" aria-hidden="true" tabindex="-1"></a>distBocaina <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="at">x =</span> sp_compos, <span class="at">method =</span> <span class="st">&quot;horn&quot;</span>)</span>
<span id="cb341-13"><a href="cap9.html#cb341-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-14"><a href="cap9.html#cb341-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Agrupamento com a função hclust e o método UPGMA</span></span>
<span id="cb341-15"><a href="cap9.html#cb341-15" aria-hidden="true" tabindex="-1"></a>dendro <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="at">d =</span> distBocaina, <span class="at">method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb341-16"><a href="cap9.html#cb341-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-17"><a href="cap9.html#cb341-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Visualizar os resultados</span></span>
<span id="cb341-18"><a href="cap9.html#cb341-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dendro)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-dend"></span>
<img src="livro_files/figure-html/fig-dend-1.png" alt="Dendrograma mostrando uma análise de agrupamento de anuros." width="100%" height="100%" />
<p class="caption">
Figura 9.1: Dendrograma mostrando uma análise de agrupamento de anuros.
</p>
</div>
<p><strong>Assessando a qualidade do dendrograma</strong></p>
<p>Precisamos verificar se o agrupamento reduziu a dimensionalidade da matiz de forma eficiente, de maneira a não distorcer a informação. Fazemos isso calculando o <strong>Coeficiente de Correlação Cofenética (CCC)</strong>.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="cap9.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Coeficiente de correlação cofenética (CCC)</span></span>
<span id="cb342-2"><a href="cap9.html#cb342-2" aria-hidden="true" tabindex="-1"></a>cofresult <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(dendro)</span>
<span id="cb342-3"><a href="cap9.html#cb342-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(cofresult, distBocaina)</span>
<span id="cb342-4"><a href="cap9.html#cb342-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9455221</span></span></code></pre></div>
<p>Um CCC &gt; .7 indica uma boa representação. Portanto, o nosso resultado de 0.9455221 é alto, garantindo que o dendrograma é adequado (Figura <a href="cap9.html#fig:fig-dend-group">9.2</a>). Note que testar a “significância” deste coeficiente não é adequado, já que seria algo tautológico (circular). Claro que definir o que seria um valor “alto” ou “baixo” da correlação é um pouco arbritrário, mas pode-se usar como “regra de dedão.”</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="cap9.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb343-2"><a href="cap9.html#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dendro)</span>
<span id="cb343-3"><a href="cap9.html#cb343-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb343-4"><a href="cap9.html#cb343-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(sp_compos)</span>
<span id="cb343-5"><a href="cap9.html#cb343-5" aria-hidden="true" tabindex="-1"></a>MidPoint <span class="ot">&lt;-</span> (dendro<span class="sc">$</span>height[n <span class="sc">-</span> k] <span class="sc">+</span> dendro<span class="sc">$</span>height[n <span class="sc">-</span> k <span class="sc">+</span> <span class="dv">1</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb343-6"><a href="cap9.html#cb343-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> MidPoint, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-dend-group"></span>
<img src="livro_files/figure-html/fig-dend-group-1.png" alt="Dendrograma mostrando uma análise de agrupamento de anuros com uma linha de corte formando cinco grupos." width="100%" height="100%" />
<p class="caption">
Figura 9.2: Dendrograma mostrando uma análise de agrupamento de anuros com uma linha de corte formando cinco grupos.
</p>
</div>
<p>Nesse caso teremos a formação de cinco grupos, representados pelos nós que estão abaixo da linha de corte. Portanto, o resultado não suporta a nossa hipótese <em>a priori</em> que predizia a formação de apenas dois grupos de espécies.</p>
<p><strong>Exemplo 2</strong></p>
<p>No exemplo anterior, vimos que é difícil interpretar os grupos baseado num nível de corte. A seguir, vamos utilizar o pacote <code>pvclust</code> que . Uma desvantagem deste método é que ele somente aceita índices de similaridade da função <code>dist()</code>, que possui apenas a distância Euclidiana, Manhattan e Canberra. Uma maneira de contornarmos essa limitação é utilizar transformações dos dados disponíveis na função <code>disttransform()</code> no pacote <code>BiodiversityR</code> ou a função <code>decostand()</code> do pacote <code>vegan</code>. Também é possível utilizar a transformação de Box-Cox para dados multivariados, disponível no <a href="http://www.ecography.org/appendix/ecog-03498">material suplementar</a> de <span class="citation">(<a href="#ref-legendre2018" role="doc-biblioref">Legendre &amp; Borcard, 2018</a>)</span>. Esta transformação é geralmente utilizada para tornar a distribuição dos dados mais simétrica (menos enviesada para valores extremos: reduzir o <em>skewness</em> dos dados).</p>
<p><strong>Análises</strong></p>
<p>Vamos utilizar o mesmo conjunto de dados do Exemplo 1 para responder à mesma pergunta. Aqui vamos utilizar a distância de Chord (que é indicada para dados de composição de espécies) para calcular a matriz de distância. Se transformarmos uma matriz usando a transformação Chord e depois calcularmos a distância Euclidiana, isso equivale à calcular diretamente a distância de Chord (Figura <a href="cap9.html#fig:fig-dend-boot-chor">9.3</a>).</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="cap9.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados</span></span>
<span id="cb344-2"><a href="cap9.html#cb344-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">t</span>(sp_compos))</span>
<span id="cb344-3"><a href="cap9.html#cb344-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Aper Bahe Rict Cleuco Dmic Dmin Hpoly Lfur Pbar Polf Pmelano Sduar Shay Sobt Ssqual Bokerm</span></span>
<span id="cb344-4"><a href="cap9.html#cb344-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BP4    0  859 1772      0    0    0    61    3  387    0       0     0    0    0      0      0</span></span>
<span id="cb344-5"><a href="cap9.html#cb344-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP4    3   14 1517      0    0   84   275    0  187    0       0  1150    6    0      0      1</span></span>
<span id="cb344-6"><a href="cap9.html#cb344-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP3    0   14  207      0    6  344   388    0    0    0       0   428    0    0      0      0</span></span>
<span id="cb344-7"><a href="cap9.html#cb344-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AP1    0    0  573      0   60 1045  1054    0    0    0       0   476   92   13      0      0</span></span>
<span id="cb344-8"><a href="cap9.html#cb344-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AP2    2   87  796      0    4   90  3002    0    0    2       0     7    0    5      0      0</span></span>
<span id="cb344-9"><a href="cap9.html#cb344-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP1    0  312    0      0    0    0   329    0    0    0       0     0    0    0      0      0</span></span>
<span id="cb344-10"><a href="cap9.html#cb344-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-11"><a href="cap9.html#cb344-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 1: transformar para distância de Chord</span></span>
<span id="cb344-12"><a href="cap9.html#cb344-12" aria-hidden="true" tabindex="-1"></a>bocaina_transf <span class="ot">&lt;-</span> <span class="fu">disttransform</span>(<span class="fu">t</span>(sp_compos), <span class="st">&quot;chord&quot;</span>)</span>
<span id="cb344-13"><a href="cap9.html#cb344-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-14"><a href="cap9.html#cb344-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 2: realizar pvclust com método average e distância euclidiana</span></span>
<span id="cb344-15"><a href="cap9.html#cb344-15" aria-hidden="true" tabindex="-1"></a>analise <span class="ot">&lt;-</span> <span class="fu">pvclust</span>(bocaina_transf, <span class="at">method.hclust =</span> <span class="st">&quot;average&quot;</span>, <span class="at">method.dist =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb344-16"><a href="cap9.html#cb344-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.46)... Done.</span></span>
<span id="cb344-17"><a href="cap9.html#cb344-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.54)... Done.</span></span>
<span id="cb344-18"><a href="cap9.html#cb344-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.69)... Done.</span></span>
<span id="cb344-19"><a href="cap9.html#cb344-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.77)... Done.</span></span>
<span id="cb344-20"><a href="cap9.html#cb344-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.85)... Done.</span></span>
<span id="cb344-21"><a href="cap9.html#cb344-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.0)... Done.</span></span>
<span id="cb344-22"><a href="cap9.html#cb344-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.08)... Done.</span></span>
<span id="cb344-23"><a href="cap9.html#cb344-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.15)... Done.</span></span>
<span id="cb344-24"><a href="cap9.html#cb344-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.23)... Done.</span></span>
<span id="cb344-25"><a href="cap9.html#cb344-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.38)... Done.</span></span>
<span id="cb344-26"><a href="cap9.html#cb344-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 3: dendrograma</span></span>
<span id="cb344-27"><a href="cap9.html#cb344-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(analise, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb344-28"><a href="cap9.html#cb344-28" aria-hidden="true" tabindex="-1"></a><span class="fu">pvrect</span>(analise)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-dend-boot-chor"></span>
<img src="livro_files/figure-html/fig-dend-boot-chor-1.png" alt="Dendrograma mostrando uma análise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando distância de Chord." width="100%" height="100%" />
<p class="caption">
Figura 9.3: Dendrograma mostrando uma análise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando distância de Chord.
</p>
</div>
<p>É possível notar que existe um único grupo com BS &gt; 95%. Agora vamos tentar usar a distância de Hellinger, que é recomendada (junto com a distância de Chord) para transformar dados de composição de espécies e, desse modo, reduzem distorções nas ordenações como Análise de Componentes Principais (<em>Principal Component Analysis</em> - PCA) e Análise de Correspondência (<em>Correspondence Analysis</em> - CA) <span class="citation">(<a href="#ref-legendre2001" role="doc-biblioref">Legendre &amp; Gallagher, 2001</a>)</span> (Figura <a href="cap9.html#fig:fig-dend-boot-hell">9.4</a>).</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="cap9.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 1: transformar dados com Hellinger</span></span>
<span id="cb345-2"><a href="cap9.html#cb345-2" aria-hidden="true" tabindex="-1"></a>bocaina_transf2 <span class="ot">&lt;-</span> <span class="fu">disttransform</span>(<span class="fu">t</span>(bocaina), <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb345-3"><a href="cap9.html#cb345-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-4"><a href="cap9.html#cb345-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 2: realizar pvclust com método average e distância euclidiana</span></span>
<span id="cb345-5"><a href="cap9.html#cb345-5" aria-hidden="true" tabindex="-1"></a>analise2 <span class="ot">&lt;-</span> <span class="fu">pvclust</span>(bocaina_transf2, <span class="at">method.hclust =</span> <span class="st">&quot;average&quot;</span>, <span class="at">method.dist =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb345-6"><a href="cap9.html#cb345-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.46)... Done.</span></span>
<span id="cb345-7"><a href="cap9.html#cb345-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.54)... Done.</span></span>
<span id="cb345-8"><a href="cap9.html#cb345-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.69)... Done.</span></span>
<span id="cb345-9"><a href="cap9.html#cb345-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.77)... Done.</span></span>
<span id="cb345-10"><a href="cap9.html#cb345-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 0.85)... Done.</span></span>
<span id="cb345-11"><a href="cap9.html#cb345-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.0)... Done.</span></span>
<span id="cb345-12"><a href="cap9.html#cb345-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.08)... Done.</span></span>
<span id="cb345-13"><a href="cap9.html#cb345-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.15)... Done.</span></span>
<span id="cb345-14"><a href="cap9.html#cb345-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.23)... Done.</span></span>
<span id="cb345-15"><a href="cap9.html#cb345-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bootstrap (r = 1.38)... Done.</span></span>
<span id="cb345-16"><a href="cap9.html#cb345-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-17"><a href="cap9.html#cb345-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 3: dendrograma</span></span>
<span id="cb345-18"><a href="cap9.html#cb345-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(analise2, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb345-19"><a href="cap9.html#cb345-19" aria-hidden="true" tabindex="-1"></a><span class="fu">pvrect</span>(analise2)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-dend-boot-hell"></span>
<img src="livro_files/figure-html/fig-dend-boot-hell-1.png" alt="Dendrograma mostrando uma análise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando distância de Hellinger." width="100%" height="100%" />
<p class="caption">
Figura 9.4: Dendrograma mostrando uma análise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando distância de Hellinger.
</p>
</div>
<p><strong>Interpretação dos resultados</strong></p>
<p>Notem que se mudarmos o coeficiente de associação, o resultado também muda. Agora temos um grupo a mais, composto por <em>Dendropsophus minutus</em> e <em>Scinax duartei</em> que não apareciam antes. Isso se deve ao fato de que a distância de Hellinger dá menos peso para espécies raras do que a Chord.</p>
<p>Neste sentido, os dados não suportam a nossa hipótese inicial da formação de dois grupos, independentemente do coeficiente de associação utilizado e do cálculo automatico do nível de corte baseado na reamostragem.</p>
</div>
<div id="agrupamento-não-hierárquico-k-means" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Agrupamento não-hierárquico (<em>K-means</em>)</h3>
<p>Ao contrário do dendrograma, o K-means é um agrupamento não-hierárquico e, desse modo, não é otimizado para busca grupos menores aninhados em grupos maiores. Resumidamente, podemos calcular o K-means a partir de uma matriz quadrada ou de distância. Essa técnica procura particionar os objetos em <em>k</em> grupos de maneira a minimizar a soma de quadrados entre grupos e maximizá-la dentro dos grupos. Um critério similar ao de uma ANOVA (Capítulo <a href="cap7.html#cap7">7</a>). Um diferencial do K-means em relação aos agrupamentos hierárquicos é que o usuário pode escolher antecipadamente o número de grupos que deseja formar.</p>
<p><strong>Exemplo 1</strong></p>
<p>Para este exemplo, iremos utilizar um conjunto de dados disponível no pacote <code>ade4</code> que contém dados de 27 espécies de peixes coletados em 30 pontos ao longo do Rio Doubs, na fronteira entre a França e Suíça.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Qual é o número de grupos que melhor sumariza o padrão de ocorrência de espécies de peixes ao longo de um riacho?</li>
</ul>
<div class="alert alert-info">
<p><strong> 📝 Importante </strong><br />
Neste caso, estamos realizando uma análise exploratória e não temos uma predição.</p>
</div>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis resposta: composição de espécies de peixes</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Vamos normalizar os dados de abundância antes de entrar na análise propriamente, já que existem muitos zeros na matriz</li>
</ul>
<p><strong>Análises</strong></p>
<p>Vamos iniciar selecionando e padronizando os dados.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="cap9.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mostrar somente seis primeiras espécies de seis localidades</span></span>
<span id="cb346-2"><a href="cap9.html#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(doubs<span class="sc">$</span>fish)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb346-3"><a href="cap9.html#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Cogo Satr Phph Neba Thth Teso</span></span>
<span id="cb346-4"><a href="cap9.html#cb346-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    0    3    0    0    0    0</span></span>
<span id="cb346-5"><a href="cap9.html#cb346-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    0    5    4    3    0    0</span></span>
<span id="cb346-6"><a href="cap9.html#cb346-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    0    5    5    5    0    0</span></span>
<span id="cb346-7"><a href="cap9.html#cb346-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    0    4    5    5    0    0</span></span>
<span id="cb346-8"><a href="cap9.html#cb346-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    0    2    3    2    0    0</span></span>
<span id="cb346-9"><a href="cap9.html#cb346-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    0    3    4    5    0    0</span></span>
<span id="cb346-10"><a href="cap9.html#cb346-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-11"><a href="cap9.html#cb346-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Retirar a linha 8 (rio sem nenhuma ocorrência de peixe)</span></span>
<span id="cb346-12"><a href="cap9.html#cb346-12" aria-hidden="true" tabindex="-1"></a>spe <span class="ot">&lt;-</span> doubs<span class="sc">$</span>fish[<span class="sc">-</span><span class="dv">8</span>, ]</span>
<span id="cb346-13"><a href="cap9.html#cb346-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-14"><a href="cap9.html#cb346-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Função do pacote vegan para normalizar os dados</span></span>
<span id="cb346-15"><a href="cap9.html#cb346-15" aria-hidden="true" tabindex="-1"></a>spe.norm <span class="ot">&lt;-</span> <span class="fu">decostand</span>(<span class="at">x =</span> spe, <span class="at">method =</span> <span class="st">&quot;normalize&quot;</span>)</span></code></pre></div>
<p>O argumento <code>centers</code> na função <code>kmeans()</code> indica o número de grupos que se quer formar. Neste exemplo, estamos utilizando <code>centers = 4</code>.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="cap9.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="do">## K-Means</span></span>
<span id="cb347-2"><a href="cap9.html#cb347-2" aria-hidden="true" tabindex="-1"></a>spe.kmeans <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(<span class="at">x =</span> spe.norm, <span class="at">centers =</span> <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">100</span>)</span>
<span id="cb347-3"><a href="cap9.html#cb347-3" aria-hidden="true" tabindex="-1"></a>spe.kmeans</span>
<span id="cb347-4"><a href="cap9.html#cb347-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; K-means clustering with 4 clusters of sizes 8, 12, 6, 3</span></span>
<span id="cb347-5"><a href="cap9.html#cb347-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb347-6"><a href="cap9.html#cb347-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cluster means:</span></span>
<span id="cb347-7"><a href="cap9.html#cb347-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Cogo        Satr       Phph       Neba        Thth        Teso       Chna       Chto       Lele      Lece</span></span>
<span id="cb347-8"><a href="cap9.html#cb347-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.00000000 0.006691097 0.02506109 0.06987391 0.006691097 0.006691097 0.10687104 0.09377516 0.14194394 0.2011411</span></span>
<span id="cb347-9"><a href="cap9.html#cb347-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.10380209 0.542300691 0.50086515 0.43325916 0.114024105 0.075651573 0.00000000 0.00000000 0.06983991 0.1237394</span></span>
<span id="cb347-10"><a href="cap9.html#cb347-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.06167791 0.122088022 0.26993915 0.35942538 0.032664966 0.135403325 0.06212775 0.21568957 0.25887226 0.2722562</span></span>
<span id="cb347-11"><a href="cap9.html#cb347-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.00000000 0.000000000 0.00000000 0.00000000 0.000000000 0.000000000 0.05205792 0.00000000 0.07647191 0.3166705</span></span>
<span id="cb347-12"><a href="cap9.html#cb347-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Baba      Spbi       Gogo       Eslu       Pefl      Rham       Legi       Scer       Cyca       Titi</span></span>
<span id="cb347-13"><a href="cap9.html#cb347-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.24327992 0.1326062 0.28386032 0.20630360 0.16920496 0.2214275 0.19066542 0.13171275 0.16019126 0.26230024</span></span>
<span id="cb347-14"><a href="cap9.html#cb347-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.02385019 0.0000000 0.05670453 0.04722294 0.02949244 0.0000000 0.00000000 0.00000000 0.00000000 0.03833408</span></span>
<span id="cb347-15"><a href="cap9.html#cb347-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.15647062 0.1574388 0.16822286 0.12276089 0.17261621 0.0793181 0.06190283 0.04516042 0.06190283 0.14539027</span></span>
<span id="cb347-16"><a href="cap9.html#cb347-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.00000000 0.0000000 0.20500174 0.07647191 0.00000000 0.0000000 0.05205792 0.07647191 0.00000000 0.00000000</span></span>
<span id="cb347-17"><a href="cap9.html#cb347-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Abbr      Icme       Acce       Ruru       Blbj      Alal       Anan</span></span>
<span id="cb347-18"><a href="cap9.html#cb347-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.19561641 0.1331835 0.26713081 0.32103755 0.22883055 0.3326939 0.18873077</span></span>
<span id="cb347-19"><a href="cap9.html#cb347-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.00000000 0.0000000 0.00000000 0.01049901 0.00000000 0.0000000 0.00000000</span></span>
<span id="cb347-20"><a href="cap9.html#cb347-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.01473139 0.0000000 0.03192175 0.32201597 0.01473139 0.1095241 0.04739636</span></span>
<span id="cb347-21"><a href="cap9.html#cb347-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.00000000 0.0000000 0.18058775 0.31667052 0.05205792 0.7618709 0.00000000</span></span>
<span id="cb347-22"><a href="cap9.html#cb347-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb347-23"><a href="cap9.html#cb347-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Clustering vector:</span></span>
<span id="cb347-24"><a href="cap9.html#cb347-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  2  3  4  5  6  7  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 </span></span>
<span id="cb347-25"><a href="cap9.html#cb347-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  2  2  2  3  2  2  3  2  2  2  2  2  2  3  3  3  3  1  1  1  4  4  4  1  1  1  1  1 </span></span>
<span id="cb347-26"><a href="cap9.html#cb347-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb347-27"><a href="cap9.html#cb347-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Within cluster sum of squares by cluster:</span></span>
<span id="cb347-28"><a href="cap9.html#cb347-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4696535 2.5101386 1.7361453 0.3560423</span></span>
<span id="cb347-29"><a href="cap9.html#cb347-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  (between_SS / total_SS =  66.7 %)</span></span>
<span id="cb347-30"><a href="cap9.html#cb347-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb347-31"><a href="cap9.html#cb347-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Available components:</span></span>
<span id="cb347-32"><a href="cap9.html#cb347-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb347-33"><a href="cap9.html#cb347-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot; &quot;betweenss&quot;    &quot;size&quot;        </span></span>
<span id="cb347-34"><a href="cap9.html#cb347-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [8] &quot;iter&quot;         &quot;ifault&quot;</span></span></code></pre></div>
<p>O objeto que fornece o resultado contém: i) o tamanho (número de objetos) em cada um dos 4 grupos, ii) o centroide de cada grupo e o pertencimento de cada espécie a cada grupo, e iii) o quanto da Soma de Quadrados dos dados é explicada por esta conformação de grupos.</p>
<p>No entanto, não é possível saber <em>a priori</em> qual o número “ideal” de grupos. Para descobrir isso, repetimos o k-means com uma série de valores de <strong>K</strong>. Isso pode ser feito na função <code>cascadeKM()</code>.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="cap9.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Repetindo o K-Means</span></span>
<span id="cb348-2"><a href="cap9.html#cb348-2" aria-hidden="true" tabindex="-1"></a>spe.KM.cascade <span class="ot">&lt;-</span> <span class="fu">cascadeKM</span>(spe.norm, <span class="at">inf.gr =</span> <span class="dv">2</span>, <span class="at">sup.gr =</span> <span class="dv">10</span>, <span class="at">iter =</span> <span class="dv">100</span>, <span class="at">criterion =</span> <span class="st">&quot;ssi&quot;</span>)</span></code></pre></div>
<p>Tanto <strong>calinski</strong> quando <strong>ssi</strong> são bons critérios para encontrar o número ideal de grupos. Quanto maior o valor de <strong>ssi</strong>, melhor (veja <code>?cascadeKM()</code> mais detalhes). Os valores de ssi é o critério utilizado pelo algorítimo para achar o agrupamento ótimo dos objetos (Figura <a href="cap9.html#fig:fig-kmeans">9.5</a>).</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="cap9.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Resumo dos resultados</span></span>
<span id="cb349-2"><a href="cap9.html#cb349-2" aria-hidden="true" tabindex="-1"></a>spe.KM.cascade<span class="sc">$</span>results</span>
<span id="cb349-3"><a href="cap9.html#cb349-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      2 groups  3 groups  4 groups  5 groups   6 groups  7 groups  8 groups  9 groups 10 groups</span></span>
<span id="cb349-4"><a href="cap9.html#cb349-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SSE 8.2149405 6.4768108 5.0719796 4.3015573 3.58561200 2.9523667 2.4840549 2.0521888 1.7599292</span></span>
<span id="cb349-5"><a href="cap9.html#cb349-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ssi 0.1312111 0.1685126 0.1409061 0.1299662 0.08693436 0.1481826 0.1267918 0.1134307 0.1226392</span></span>
<span id="cb349-6"><a href="cap9.html#cb349-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-7"><a href="cap9.html#cb349-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb349-8"><a href="cap9.html#cb349-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.KM.cascade, <span class="at">sortg =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-kmeans"></span>
<img src="livro_files/figure-html/fig-kmeans-1.png" alt="Gráficos mostrando os resultados da análise de K-Means." width="100%" height="100%" />
<p class="caption">
Figura 9.5: Gráficos mostrando os resultados da análise de K-Means.
</p>
</div>
<p><strong>Interpretação dos resultados</strong></p>
<p>Diferentemente da nossa predição inicial, o resultado da análise mostra que o número ideal de grupos para explicar a variância no padrão de ocorrência de espécies é 3. Notem que o SSI máximo é alcançado neste número de grupos 0.1685126 (também indicado pela bola vermelha no plot).</p>
</div>
<div id="espécies-indicadoras" class="section level3" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Espécies indicadoras</h3>
<p>Uma pergunta normalmente feita por ecólogos é: qual espécie pode ser indicadora de uma determinada condição ambiental (e.g., poluição)?</p>
<p>O índice IndVal mede dois aspectos das espécies: fidelidade e especificidade. Uma alta fidelidade significa que espécies ocorrem em todos os locais do grupo, e uma alta especificidade significa que as espécies ocorrem somente naquele grupo. Uma boa espécie indicadora é aquela na qual todos os indivíduos ocorrem em todas a amostras referentes a um grupo específico. A especificidade é dada pela divisão da abundância média da espécie no grupo pela somatório das abundâncias médias dos grupos. Fidelidade é igual ao número de lugares no grupo onde a espécie está presente dividido pelo número total de lugares do grupo <span class="citation">(<a href="#ref-dufrene_species_1997" role="doc-biblioref">Dufrêne &amp; Legendre, 1997</a>)</span>.</p>
<p>Espécies raras podem receber o mesmo valor de IndVal das espécies indicadoras, porém são chamadas de indicadoras assimétricas, uma vez que contribuem com a especificidade do habitat, mas não servem para predizer grupos. Ao contrário, as espécies indicadoras são verdadeiros indicadores simétricos e podem ser usadas para predizer grupos.</p>
<p>A análise procede da seguinte forma:</p>
<ol style="list-style-type: decimal">
<li><p>Uma matriz de distância é construída e as unidades amostrais são classificadas com alguma análise de agrupamento, hierárquico ou não</p></li>
<li><p>A variável ambiental para a qual se deseja classificar os grupos é inserida</p></li>
<li><p>As espécies indicadoreas de cada grupo são formadas através do cálculo da especificidade e fidelidade, obtendo-se o valor de IndVal para cada espécie</p></li>
<li><p>Por fim, o conjunto de dados originais é comparado para ver se a análise faz sentido</p></li>
</ol>
<p>O cálculo da significância do índice de IndVal é feito por aleatorização de Monte Carlo. Os métodos de Monte Carlo utilizam números aleatórios de dados reais para simular certos padrões esperados na ausência de um processo ecológico específico <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. Assim, o valor do índice é aleatorizado 999 vezes (ou o número de vezes que você optar) dentro dos tratamentos e o valor de <em>P</em> é dado pelo número de vezes em que o índice observado foi igual ou maior que os valores aleatorizados. Portanto, o IndVal fornece um conjunto de espécies que são indicadoras de um grupo de locais (e.g., muito poluídos), que por sua vez precisam ser definidos utilizando alguma técnica de agrupamento, como as que vimos anteriormente.</p>
<p><strong>Exemplo 1</strong></p>
<p>Para este exemplo, vamos usar o mesmo conjunto de dados utilizado acima com abundância de 16 espécies de girinos coletados em 14 poças com diferentes graus de cobertura de dossel na Serra da Bocaina <span class="citation">(<a href="#ref-provete_broad-scale_2014" role="doc-biblioref">Provete et al., 2014</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Podemos utilizar as espécies de girinos como indicadoras da fitofisionomia?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Espécies terrestres serão indicadoras de área aberta, enquanto espécies arborícolas serão indicadoras de áreas florestais</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis resposta: mesma matriz já utilizada contendo a abundância de girinos ao longo de poças na Serra da Bocaina</li>
</ul>
<p><strong>Análises</strong></p>
<p>O IndVal está disponível tanto no pacote <code>indicspecies</code>, quando no <code>labdsv</code>. Para este exemplo, iremos usar o <code>labdsv</code>. Primeiro, vamos agrupar as unidades amostrais (poças) que informa os grupos de fitofisionomias onde as poças se localizam e para os quais deseja-se encontrar espécies indicadoras.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="cap9.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados</span></span>
<span id="cb350-2"><a href="cap9.html#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bocaina)</span>
<span id="cb350-3"><a href="cap9.html#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         BP4  PP4 PP3  AP1 AP2 PP1 PP2 BP9  PT1 PT2 PT3 BP2 PT5</span></span>
<span id="cb350-4"><a href="cap9.html#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Aper      0    3   0    0   2   0   0   0    0   0   0 181   0</span></span>
<span id="cb350-5"><a href="cap9.html#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bahe    859   14  14    0  87 312 624 641    0   0   0  14   0</span></span>
<span id="cb350-6"><a href="cap9.html#cb350-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rict   1772 1517 207  573 796   0   0   0    0   0   0   0   0</span></span>
<span id="cb350-7"><a href="cap9.html#cb350-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cleuco    0    0   0    0   0   0   0   0    0  29 369   0  84</span></span>
<span id="cb350-8"><a href="cap9.html#cb350-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dmic      0    0   6   60   4   0   0   0 2758 319  25   0 329</span></span>
<span id="cb350-9"><a href="cap9.html#cb350-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dmin      0   84 344 1045  90   0   0   0    8   0   0   0   0</span></span>
<span id="cb350-10"><a href="cap9.html#cb350-10" aria-hidden="true" tabindex="-1"></a>fitofis <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">3</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">5</span>, <span class="dv">4</span>))</span>
<span id="cb350-11"><a href="cap9.html#cb350-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-12"><a href="cap9.html#cb350-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Análise de espécies indicadoras</span></span>
<span id="cb350-13"><a href="cap9.html#cb350-13" aria-hidden="true" tabindex="-1"></a>res_indval <span class="ot">&lt;-</span> <span class="fu">indval</span>(<span class="fu">t</span>(sp_compos), fitofis)</span>
<span id="cb350-14"><a href="cap9.html#cb350-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-15"><a href="cap9.html#cb350-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A função summary só exibe o resultado para as espécies indicadoras</span></span>
<span id="cb350-16"><a href="cap9.html#cb350-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res_indval)</span>
<span id="cb350-17"><a href="cap9.html#cb350-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       cluster indicator_value probability</span></span>
<span id="cb350-18"><a href="cap9.html#cb350-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rict        1          0.8364       0.011</span></span>
<span id="cb350-19"><a href="cap9.html#cb350-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sduar       1          0.7475       0.034</span></span>
<span id="cb350-20"><a href="cap9.html#cb350-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bahe        2          0.6487       0.048</span></span>
<span id="cb350-21"><a href="cap9.html#cb350-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb350-22"><a href="cap9.html#cb350-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sum of probabilities                 =  7.984 </span></span>
<span id="cb350-23"><a href="cap9.html#cb350-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb350-24"><a href="cap9.html#cb350-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sum of Indicator Values              =  7.3 </span></span>
<span id="cb350-25"><a href="cap9.html#cb350-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb350-26"><a href="cap9.html#cb350-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sum of Significant Indicator Values  =  2.23 </span></span>
<span id="cb350-27"><a href="cap9.html#cb350-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb350-28"><a href="cap9.html#cb350-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Significant Indicators     =  3 </span></span>
<span id="cb350-29"><a href="cap9.html#cb350-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb350-30"><a href="cap9.html#cb350-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Significant Indicator Distribution</span></span>
<span id="cb350-31"><a href="cap9.html#cb350-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb350-32"><a href="cap9.html#cb350-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 2 </span></span>
<span id="cb350-33"><a href="cap9.html#cb350-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 1</span></span></code></pre></div>
<p>Para apresentar uma tabela dos resultados para todas as espécies temos de processar os dados.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="cap9.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Resultados</span></span>
<span id="cb351-2"><a href="cap9.html#cb351-2" aria-hidden="true" tabindex="-1"></a>res_indval<span class="sc">$</span>maxcls  <span class="co"># classe de maior valor indicador/espécie </span></span>
<span id="cb351-3"><a href="cap9.html#cb351-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Aper    Bahe    Rict  Cleuco    Dmic    Dmin   Hpoly    Lfur    Pbar    Polf Pmelano   Sduar    Shay    Sobt </span></span>
<span id="cb351-4"><a href="cap9.html#cb351-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       3       2       1       3       3       1       2       3       1       3       2       1       3       2 </span></span>
<span id="cb351-5"><a href="cap9.html#cb351-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Ssqual  Bokerm </span></span>
<span id="cb351-6"><a href="cap9.html#cb351-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       3       2</span></span>
<span id="cb351-7"><a href="cap9.html#cb351-7" aria-hidden="true" tabindex="-1"></a>res_indval<span class="sc">$</span>indcls  <span class="co"># valor indicador (indval)</span></span>
<span id="cb351-8"><a href="cap9.html#cb351-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Aper      Bahe      Rict    Cleuco      Dmic      Dmin     Hpoly      Lfur      Pbar      Polf   Pmelano </span></span>
<span id="cb351-9"><a href="cap9.html#cb351-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.2432796 0.6487329 0.8363823 0.4128631 0.6645244 0.7032145 0.6208711 0.2279412 0.2813725 0.2437500 0.2500000 </span></span>
<span id="cb351-10"><a href="cap9.html#cb351-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Sduar      Shay      Sobt    Ssqual    Bokerm </span></span>
<span id="cb351-11"><a href="cap9.html#cb351-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.7474527 0.4930269 0.2222222 0.2500000 0.4583333</span></span>
<span id="cb351-12"><a href="cap9.html#cb351-12" aria-hidden="true" tabindex="-1"></a>res_indval<span class="sc">$</span>pval  <span class="co"># significância do indval</span></span>
<span id="cb351-13"><a href="cap9.html#cb351-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Aper    Bahe    Rict  Cleuco    Dmic    Dmin   Hpoly    Lfur    Pbar    Polf Pmelano   Sduar    Shay    Sobt </span></span>
<span id="cb351-14"><a href="cap9.html#cb351-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1.000   0.048   0.011   0.385   0.195   0.101   0.259   1.000   0.624   1.000   1.000   0.034   0.416   0.683 </span></span>
<span id="cb351-15"><a href="cap9.html#cb351-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Ssqual  Bokerm </span></span>
<span id="cb351-16"><a href="cap9.html#cb351-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1.000   0.228</span></span>
<span id="cb351-17"><a href="cap9.html#cb351-17" aria-hidden="true" tabindex="-1"></a>tab_indval <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="at">maxcls =</span> res_indval<span class="sc">$</span>maxcls, <span class="at">ind.value =</span> res_indval<span class="sc">$</span>indcls,</span>
<span id="cb351-18"><a href="cap9.html#cb351-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">P =</span> res_indval<span class="sc">$</span>pval)</span>
<span id="cb351-19"><a href="cap9.html#cb351-19" aria-hidden="true" tabindex="-1"></a>tab_indval</span>
<span id="cb351-20"><a href="cap9.html#cb351-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         maxcls ind.value     P</span></span>
<span id="cb351-21"><a href="cap9.html#cb351-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Aper         3 0.2432796 1.000</span></span>
<span id="cb351-22"><a href="cap9.html#cb351-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bahe         2 0.6487329 0.048</span></span>
<span id="cb351-23"><a href="cap9.html#cb351-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rict         1 0.8363823 0.011</span></span>
<span id="cb351-24"><a href="cap9.html#cb351-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cleuco       3 0.4128631 0.385</span></span>
<span id="cb351-25"><a href="cap9.html#cb351-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dmic         3 0.6645244 0.195</span></span>
<span id="cb351-26"><a href="cap9.html#cb351-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dmin         1 0.7032145 0.101</span></span>
<span id="cb351-27"><a href="cap9.html#cb351-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hpoly        2 0.6208711 0.259</span></span>
<span id="cb351-28"><a href="cap9.html#cb351-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lfur         3 0.2279412 1.000</span></span>
<span id="cb351-29"><a href="cap9.html#cb351-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Pbar         1 0.2813725 0.624</span></span>
<span id="cb351-30"><a href="cap9.html#cb351-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Polf         3 0.2437500 1.000</span></span>
<span id="cb351-31"><a href="cap9.html#cb351-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Pmelano      2 0.2500000 1.000</span></span>
<span id="cb351-32"><a href="cap9.html#cb351-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sduar        1 0.7474527 0.034</span></span>
<span id="cb351-33"><a href="cap9.html#cb351-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Shay         3 0.4930269 0.416</span></span>
<span id="cb351-34"><a href="cap9.html#cb351-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sobt         2 0.2222222 0.683</span></span>
<span id="cb351-35"><a href="cap9.html#cb351-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Ssqual       3 0.2500000 1.000</span></span>
<span id="cb351-36"><a href="cap9.html#cb351-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bokerm       2 0.4583333 0.228</span></span>
<span id="cb351-37"><a href="cap9.html#cb351-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-38"><a href="cap9.html#cb351-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Espécies</span></span>
<span id="cb351-39"><a href="cap9.html#cb351-39" aria-hidden="true" tabindex="-1"></a>tab_indval[tab_indval<span class="sc">$</span>P <span class="sc">&lt;</span> <span class="fl">0.05</span>, ]</span>
<span id="cb351-40"><a href="cap9.html#cb351-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       maxcls ind.value     P</span></span>
<span id="cb351-41"><a href="cap9.html#cb351-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bahe       2 0.6487329 0.048</span></span>
<span id="cb351-42"><a href="cap9.html#cb351-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rict       1 0.8363823 0.011</span></span>
<span id="cb351-43"><a href="cap9.html#cb351-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sduar      1 0.7474527 0.034</span></span></code></pre></div>
<p><strong>Interpretação dos resultados</strong></p>
<p>No resultado apresentado, podemos ver que temos duas espécies indicadoras da fitofisionimia 1: <em>Rhinella icterica</em> (Rict) e <em>Scinax duartei</em> (Sduar). Nenhuma espécie foi indicadora dos outros grupos neste exemplo.</p>
</div>
</div>
<div id="análises-de-ordenação" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Análises de Ordenação</h2>
<p>As análises de ordenação representam um conjunto de métodos e técnicas multivariadas que organizam objetos (e.g., localidades, indivíduos) em alguma ordem considerando o conjunto de descritores que podem estar mais ou menos relacionados entre si. Se os descritores estiverem bem relacionados, eles são redundantes e organizam os objetos de forma similar. Esse fenômeno é observado, por exemplo, quando queremos organizar um conjunto de unidades amostrais baseado em variáveis que indicam um mesmo processo: ver o padrão de similaridade geral de lagos usando várias variáveis relacionada com a produtividade do sistema: clorofila-a, concentração de fósforo, nitrogênio, entre outros. Por exemplo, tais métodos permitem identificar se existem grupo de espécies que ocorrem exclusivamente em um determinado hábitat. Ao buscar esta <em>ordem</em>, as técnicas de ordenação possuem três principais utilidades: i) reduzir a dimensionalidade e revelar padrões, ii) separar as variáveis mais e menos importantes em combinações complexas e iii) separar relações mais e menos fortes ao comparar variáveis preditoras e dependentes.</p>
<p>Em geral, os métodos são dividídos em ordenações irrestritas (ou análise de gradiente indireto) e restritas (ou análise de gradiente direto). As ordenações irrestritas organizam os objetos (e.g., espécies) de acordo com sua estrutura de covariância (ou correlação), o que demonstra que a proximidade (ou distância) dentro do espaço multidimensional representa semelhança (ou diferença) dos objetos. Por outro lado, as ordenações restritras posicionam os objetos (e.g., espécies) de acordo com sua relação linear com outras variáveis coletadas nas mesmas unidades amostraits (e.g., temperatura e precipitação). Ao passo que as ordenações irrestritas dependem somente de uma matriz (e.g., espécies por localidades), as ordenações restritas utilizam no mínimo duas matrizes (e.g., espécies por localidades e variáveis climáticas por localidade). Desse modo, fica claro esta diferença entre os dados utilizados que as análises irrestritas são mais exploratórias, enquanto análises restritas são ideais para testar hipóteses com dados multidimensionais. A tabela a seguir apresenta as principais análises utilizadas em ecologia.</p>
<table>
<colgroup>
<col width="16%" />
<col width="71%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th>Método</th>
<th>Tipo de variável</th>
<th>Função R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Ordenação irrestrita</strong></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>PCA</td>
<td>Variáveis contínuas (distância euclidiana)</td>
<td><code>PCA()</code>, <code>rda()</code>, <code>dudi.pca()</code></td>
</tr>
<tr class="odd">
<td>PCoA</td>
<td>Aceita qualquer tipo de variável, mas depende da escolha apropriada de uma medida de distância</td>
<td><code>pcoa()</code>, <code>dudi.pco()</code></td>
</tr>
<tr class="even">
<td>nMDS</td>
<td>Aceita qualquer tipo de variável, mas depende da escolha apropriada de uma medida de distância</td>
<td><code>metaMDS()</code>, <code>nmds()</code></td>
</tr>
<tr class="odd">
<td>CA</td>
<td></td>
<td><code>dudi.coa()</code></td>
</tr>
<tr class="even">
<td>Hill-Smith</td>
<td>Aceita qualquer tipo de variável</td>
<td><code>dudi.hillsmith()</code></td>
</tr>
<tr class="odd">
<td><strong>Ordenação restrita</strong></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>RDA</td>
<td>Variáveis preditoras de qualquer tipo e variáveis dependentes contínuas (ou presença e ausência)</td>
<td><code>rda()</code></td>
</tr>
<tr class="odd">
<td>RDA parcial</td>
<td>Variáveis preditoras de qualquer tipo e variáveis dependentes contínuas (ou presença e ausência)</td>
<td><code>rda()</code></td>
</tr>
<tr class="even">
<td>dbRDA</td>
<td>Variáveis preditoras de qualquer tipo e matriz de distância obtida a partir das variáveis dependentes</td>
<td><code>capscale()</code>, <code>dbrda()</code></td>
</tr>
<tr class="odd">
<td>CCA</td>
<td>Variáveis preditoras de qualquer tipo e variáveis dependentes contínuas (ou presença e ausência)</td>
<td><code>rda()</code></td>
</tr>
<tr class="even">
<td>PERMANOVA</td>
<td>Variáveis preditoras de qualquer tipo e matriz de distância obtida a partir das variáveis dependentes</td>
<td><code>adonis()</code>, <code>adonis2()</code></td>
</tr>
<tr class="odd">
<td>PCR</td>
<td>Variável dependente necessariamente representada por escores da PCA ou PCoA e variáveis preditoras de qualquer tipo</td>
<td><code>pca()</code>, <code>pcoa()</code>, <code>lm()</code>, <code>glm()</code></td>
</tr>
</tbody>
</table>
</div>
<div id="ordenação-irrestrira" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Ordenação irrestrira</h2>
<p>Ordenações irrestritas, ou análise de gradiente indireto ou ainda análises de fator, são um conjunto de métodos multivariados que lidam com uma única matriz quadrada. Esta matriz pode ou não ter pesos nas linhas ou colunas. Geralmente, o objetivo deste tipo de análise é resumir a informação contida na matriz de maneira gráfica, por meio de um diagrama de ordenação. Quanto maior e mais complexa for a matriz, mais eficiente é este tipo de análise. Os tipos de análise irão diferir de acordo com o tipo de dado contido nesta matriz, se contínuo ou contagem, etc. De maneira geral, essas ordenações irrestritas calculam combinações lineares, cuja formulação irá diferir ligeiramente entre os métodos. Da mesma forma, essas combinações lineares irão preservar um tipo de distância. Por exemplo, a Análise de Componentes Principais (PCA) preserva a distância Euclidiana, enquanto a Análise de Correspondência (CA) preserva a distância de chi-quadrado.</p>
<div id="análise-de-componentes-principais-pca" class="section level3" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Análise de Componentes Principais (PCA)</h3>
<p>A Análise de Componentes Principais (<em>Principal Component Analysis</em> - PCA) é uma das ordenações mais utilizadas em diversas áreas do conhecimento. Em Ecologia, ela se popularizou por facilitar a visualização de dados complexos como de distribuição de espécies em diferentes localidades e de potenciais variáveis explicativas. Ao mesmo tempo que ganhou tamanha popularidade, a PCA tem sido empregada de maneira incorreta, uma vez que muitos estudos utilizam a visualização gráfica da ordenação (o biplot) para intepretar “relações” entre variáveis preditoras (ambientais) e dependentes (espécies). Porém, como informado anteriormente, as ordenações irrestritas utilizam a estrutura de covariância dos objetos para organizar suas relações de similaridade.</p>
<p>Antes de explicar a análise, imagine que vamos usar uma matriz com cinco espécies de aranhas que foram encontradas em oito cidades diferentes. A quantidade de indivíduos de cada espécie coletada em cada cidade será o valor de preenchimento desta matriz. Sendo assim, a matriz possui oito objetos (cidades, representando unidades amostrais) e cinco descritores (espécies), como na Tabela <a href="cap9.html#tab:tab-pca-dados">9.1</a>.</p>
<table>
<caption>
<span id="tab:tab-pca-dados">Tabela 9.1: </span>Matriz com cinco espécies de aranhas que foram encontradas em oito cidades diferentes.
</caption>
<thead>
<tr>
<th style="text-align:center;">
Cidade
</th>
<th style="text-align:center;">
Espécie.1
</th>
<th style="text-align:center;">
Espécie.2
</th>
<th style="text-align:center;">
Espécie.3
</th>
<th style="text-align:center;">
Espécie.4
</th>
<th style="text-align:center;">
Espécie.5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Cidade 1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 2
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 3
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 4
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 5
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 6
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
6
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 7
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
9
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 8
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
12
</td>
</tr>
</tbody>
</table>
<p>O primeiro passo da PCA é obter uma matriz centralizada, onde cada valor é subtraído da média da coluna que aquele valor pertence. Esta centralização pode ser calculada com a função <code>scale()</code>.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="cap9.html#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados</span></span>
<span id="cb352-2"><a href="cap9.html#cb352-2" aria-hidden="true" tabindex="-1"></a>aranhas <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sp1 =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sp2 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb352-3"><a href="cap9.html#cb352-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sp3 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sp4 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">0</span>), <span class="at">sp5 =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb352-4"><a href="cap9.html#cb352-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>), <span class="at">row.names =</span> <span class="fu">paste0</span>(<span class="st">&quot;cidade&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>))</span>
<span id="cb352-5"><a href="cap9.html#cb352-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-6"><a href="cap9.html#cb352-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Centralização</span></span>
<span id="cb352-7"><a href="cap9.html#cb352-7" aria-hidden="true" tabindex="-1"></a>aranha.cent <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(base<span class="sc">::</span><span class="fu">scale</span>(aranhas, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<p>O segundo passo é calcular uma matriz de covariância (ou matriz de dispersão) e, a partir desta matriz, obter os autovalores e autovetores. Os autovalores representam a porcentagem de explicação de cada eixo e podem ser calculados dividindo a soma do autovalor de cada eixo pela soma de todos os autovalores. No exemplo que apresentamos, os dois primeiros eixos representam 47,20% e 35,01% de toda variação, respectivamente. Os autovetores, por sua vez, representam os valores que multiplicam as variáveis originais e, desse modo, indicam a direção desses valores. Por fim, os componentes principais (Matriz F) são obtidos multiplicando os autovetores com os valores da matriz centralizada.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="cap9.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Matriz de covaiância</span></span>
<span id="cb353-2"><a href="cap9.html#cb353-2" aria-hidden="true" tabindex="-1"></a>matriz_cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(aranha.cent)</span>
<span id="cb353-3"><a href="cap9.html#cb353-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-4"><a href="cap9.html#cb353-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Autovalores e autovetores</span></span>
<span id="cb353-5"><a href="cap9.html#cb353-5" aria-hidden="true" tabindex="-1"></a>eigen_aranhas <span class="ot">&lt;-</span> <span class="fu">eigen</span>(matriz_cov)</span>
<span id="cb353-6"><a href="cap9.html#cb353-6" aria-hidden="true" tabindex="-1"></a>autovalores <span class="ot">&lt;-</span> eigen_aranhas<span class="sc">$</span>values</span>
<span id="cb353-7"><a href="cap9.html#cb353-7" aria-hidden="true" tabindex="-1"></a>autovetores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(eigen_aranhas<span class="sc">$</span>vectors)</span>
<span id="cb353-8"><a href="cap9.html#cb353-8" aria-hidden="true" tabindex="-1"></a>autovalores  <span class="co"># eigenvalue</span></span>
<span id="cb353-9"><a href="cap9.html#cb353-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 36.733031 27.243824  9.443805  2.962749  1.438020</span></span>
<span id="cb353-10"><a href="cap9.html#cb353-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(autovetores) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;PC&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb353-11"><a href="cap9.html#cb353-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(autovetores) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(aranhas)</span>
<span id="cb353-12"><a href="cap9.html#cb353-12" aria-hidden="true" tabindex="-1"></a>autovetores</span>
<span id="cb353-13"><a href="cap9.html#cb353-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            PC1         PC2         PC3         PC4        PC5</span></span>
<span id="cb353-14"><a href="cap9.html#cb353-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sp1 -0.2144766  0.38855265  0.29239380 -0.02330706  0.8467522</span></span>
<span id="cb353-15"><a href="cap9.html#cb353-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sp2 -0.2442026  0.17463316  0.01756743  0.94587037 -0.1220204</span></span>
<span id="cb353-16"><a href="cap9.html#cb353-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sp3 -0.3558368 -0.80222917 -0.27591770  0.10991178  0.3762942</span></span>
<span id="cb353-17"><a href="cap9.html#cb353-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sp4  0.4159852 -0.41786654  0.78820962  0.17374202  0.0297183</span></span>
<span id="cb353-18"><a href="cap9.html#cb353-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sp5  0.7711688  0.01860152 -0.46560957  0.25003826  0.3544591</span></span>
<span id="cb353-19"><a href="cap9.html#cb353-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-20"><a href="cap9.html#cb353-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Componentes principais</span></span>
<span id="cb353-21"><a href="cap9.html#cb353-21" aria-hidden="true" tabindex="-1"></a>matriz_F <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(aranha.cent) <span class="sc">%*%</span> <span class="fu">as.matrix</span>(autovetores))</span>
<span id="cb353-22"><a href="cap9.html#cb353-22" aria-hidden="true" tabindex="-1"></a>matriz_F</span>
<span id="cb353-23"><a href="cap9.html#cb353-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               PC1        PC2        PC3        PC4        PC5</span></span>
<span id="cb353-24"><a href="cap9.html#cb353-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade1 -2.979363  4.4720575  1.1533417 -3.2641923  0.5433206</span></span>
<span id="cb353-25"><a href="cap9.html#cb353-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade2 -4.873532  6.2969618  1.8435339  2.3644158  1.5047024</span></span>
<span id="cb353-26"><a href="cap9.html#cb353-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade3 -3.068541  3.8302991  0.3288626 -0.3566600 -2.3629973</span></span>
<span id="cb353-27"><a href="cap9.html#cb353-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade4 -6.086322 -3.9922356 -2.7216169  1.6250305 -0.7918743</span></span>
<span id="cb353-28"><a href="cap9.html#cb353-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade5 -4.513082 -8.7689219 -0.4668012 -1.1337476  0.9439633</span></span>
<span id="cb353-29"><a href="cap9.html#cb353-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade6  5.812374 -3.9444494  3.9520584  0.4197281 -0.1376205</span></span>
<span id="cb353-30"><a href="cap9.html#cb353-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade7  8.361421 -0.6462243  1.8065636  0.4926235 -0.2625625</span></span>
<span id="cb353-31"><a href="cap9.html#cb353-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cidade8  7.347046  2.7525126 -5.8959421 -0.1471979  0.5630683</span></span>
<span id="cb353-32"><a href="cap9.html#cb353-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-33"><a href="cap9.html#cb353-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Porcentagem de explicação de cada eixo</span></span>
<span id="cb353-34"><a href="cap9.html#cb353-34" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> (autovalores<span class="sc">/</span><span class="fu">sum</span>(autovalores))</span>
<span id="cb353-35"><a href="cap9.html#cb353-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 47.201691 35.008126 12.135225  3.807112  1.847846</span></span></code></pre></div>
<p>Agora, é possível visualizar a relação entre as cidades e similaridade na espécies de aranhas que vivem em cada uma delas (Figura <a href="cap9.html#fig:fig-pca">9.6</a>).</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="cap9.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb354-2"><a href="cap9.html#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(matriz_F, <span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">label =</span> <span class="fu">rownames</span>(matriz_F))) <span class="sc">+</span> <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb354-3"><a href="cap9.html#cb354-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb354-4"><a href="cap9.html#cb354-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-pca"></span>
<img src="livro_files/figure-html/fig-pca-1.png" alt="Biplot da PCA ordenando as cidades pela composição das espécies de aranhas." width="100%" height="100%" />
<p class="caption">
Figura 9.6: Biplot da PCA ordenando as cidades pela composição das espécies de aranhas.
</p>
</div>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Verifique se todas as variáveis utilizadas são contínuas. Caso contrário, considere utilizar PCoA (veja mais no próximo tópico)</p></li>
<li><p>Apesar do exemplo acima ter apresentado a ocorrência de espécies de aranhas em diferentes cidades, é fundamental saber que utilizar a PCA com esses dados pode ser problemático. Assim, tenha cuidado em usar dados de composição de espécies, especialmente abundância, com PCA, uma vez que ‘duplos zeros’ podem gerar distorções na ordenação <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. Como alternativa, é possível utilizar PCA com dados padronizados com o método de Hellinger <span class="citation">(<a href="#ref-legendre2001" role="doc-biblioref">Legendre &amp; Gallagher, 2001</a>)</span>.</p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo vamos utilizar um conjunto de dados morfológicos de pinguins do arquipélago Palmer (Península Antártica) disponíveis no pacote ‘palmerpenguins.’ Os dados representam medidas do comprimento e largura do bico (mm), comprimento da nadadeira (mm) e massa corporal (gramas) de três espécies: Adélie, Chinstrap e Gentoo. Como descrito acima, a PCA deve ser utilizada para exploração de dados ou para testes <em>a posteriori</em> (e.g., Regressão de Componentes Principais - PCR, tópico explorado mais a frente nesse capítulo). Neste exemplo, iremos usar a estrutura de perguntas e predições para manter a proposta do livro.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existe diferenças nas características morfológicas das espécies de pinguins do arquipélago Palmer?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Pinguins com dieta diferente possuem diferentes características morfológicas</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Preditora: espécie (categórica com três níveis)</li>
<li>Dependentes: variáveis morfológicas (contínua)</li>
</ul>
<p><strong>Análises</strong></p>
<p>Antes de começar, é necessário remover dados ausentes (se houver) e editar nomes das variáveis (ponto importante para determinar como devem aparecer no gráfico).</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="cap9.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Verificar se existem NAs nos dados</span></span>
<span id="cb355-2"><a href="cap9.html#cb355-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(penguins))</span>
<span id="cb355-3"><a href="cap9.html#cb355-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 19</span></span>
<span id="cb355-4"><a href="cap9.html#cb355-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-5"><a href="cap9.html#cb355-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Remover dados ausentes (NA), quando houver</span></span>
<span id="cb355-6"><a href="cap9.html#cb355-6" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(penguins)</span>
<span id="cb355-7"><a href="cap9.html#cb355-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-8"><a href="cap9.html#cb355-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Editar nomes para aparecer nos gráficos</span></span>
<span id="cb355-9"><a href="cap9.html#cb355-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(penguins) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;species&quot;</span>, <span class="st">&quot;island&quot;</span>, <span class="st">&quot;Bill length&quot;</span>, <span class="st">&quot;Bill depth&quot;</span>, <span class="st">&quot;Flipper length&quot;</span>,</span>
<span id="cb355-10"><a href="cap9.html#cb355-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Body mass&quot;</span>, <span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Year&quot;</span>)</span>
<span id="cb355-11"><a href="cap9.html#cb355-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-12"><a href="cap9.html#cb355-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Manter somentes dados contínuos que pretende aplicar a PCA</span></span>
<span id="cb355-13"><a href="cap9.html#cb355-13" aria-hidden="true" tabindex="-1"></a>penguins_trait <span class="ot">&lt;-</span> penguins[, <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]</span></code></pre></div>
<p>Agora sim, os dados estão prontos para fazer a PCA. Um argumento é essencial na análise, o <code>scale.unit</code>. Se você utilizar dentro deste argumento o seleção <code>TRUE</code>, a função padroniza automaticamente as variáveis para terem a média 0 e variância 1. Esta padronização é essencial quando as variáveis estão em escalas muito diferentes. No exemplo selecionado, temos variáveis como comprimento do bico (em milímetros) e massa corporal (em gramas).</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="cap9.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compare com este código a variância das variáveis</span></span>
<span id="cb356-2"><a href="cap9.html#cb356-2" aria-hidden="true" tabindex="-1"></a>penguins_trait <span class="sc">%&gt;%</span></span>
<span id="cb356-3"><a href="cap9.html#cb356-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">var</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb356-4"><a href="cap9.html#cb356-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 4</span></span>
<span id="cb356-5"><a href="cap9.html#cb356-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   `Bill length` `Bill depth` `Flipper length` `Body mass`</span></span>
<span id="cb356-6"><a href="cap9.html#cb356-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb356-7"><a href="cap9.html#cb356-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          29.9         3.88             196.     648372.</span></span>
<span id="cb356-8"><a href="cap9.html#cb356-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-9"><a href="cap9.html#cb356-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Agora, veja o mesmo cálculo se fizer a padronização (scale.unit da função</span></span>
<span id="cb356-10"><a href="cap9.html#cb356-10" aria-hidden="true" tabindex="-1"></a><span class="do">## PCA)</span></span>
<span id="cb356-11"><a href="cap9.html#cb356-11" aria-hidden="true" tabindex="-1"></a>penguins_pad <span class="ot">&lt;-</span> <span class="fu">decostand</span>(<span class="at">x =</span> penguins_trait, <span class="at">method =</span> <span class="st">&quot;standardize&quot;</span>)</span>
<span id="cb356-12"><a href="cap9.html#cb356-12" aria-hidden="true" tabindex="-1"></a>penguins_pad <span class="sc">%&gt;%</span></span>
<span id="cb356-13"><a href="cap9.html#cb356-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">var</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb356-14"><a href="cap9.html#cb356-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Bill length Bill depth Flipper length Body mass</span></span>
<span id="cb356-15"><a href="cap9.html#cb356-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1           1          1              1         1</span></span>
<span id="cb356-16"><a href="cap9.html#cb356-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-17"><a href="cap9.html#cb356-17" aria-hidden="true" tabindex="-1"></a><span class="do">## PCA</span></span>
<span id="cb356-18"><a href="cap9.html#cb356-18" aria-hidden="true" tabindex="-1"></a>pca.p <span class="ot">&lt;-</span> <span class="fu">PCA</span>(<span class="at">X =</span> penguins_trait, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Apesar da simplicidade do código para executar a PCA, o objeto resultante da análise possui diversas informações que são essenciais para sua plena interpretação. Dentre elas, se destacam os autovalores, escores e cargas (<em>loadings</em>). Os autovalores representam a porcentagem de explicação de cada eixo. Os escores representam as coordenadas (posições no espaço multidimensional) representando os objetos (geralmente localidades ou indivíduos) e descritores (geralmente espécies ou variáveis ambientais e espaciais). Os <em>loadings</em>, por sua vez, representam a combinação linear entre os escores (nova posição do valor do descritor no espaço ordenado) e os valores originais dos descritores (Figura <a href="cap9.html#fig:fig-pca-scree">9.7</a>).</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="cap9.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Autovalores: porcentagem de explicação para usar no gráfico</span></span>
<span id="cb357-2"><a href="cap9.html#cb357-2" aria-hidden="true" tabindex="-1"></a>pca.p<span class="sc">$</span>eig</span>
<span id="cb357-3"><a href="cap9.html#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        eigenvalue percentage of variance cumulative percentage of variance</span></span>
<span id="cb357-4"><a href="cap9.html#cb357-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 1  2.7453557              68.633893                          68.63389</span></span>
<span id="cb357-5"><a href="cap9.html#cb357-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 2  0.7781172              19.452929                          88.08682</span></span>
<span id="cb357-6"><a href="cap9.html#cb357-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 3  0.3686425               9.216063                          97.30289</span></span>
<span id="cb357-7"><a href="cap9.html#cb357-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 4  0.1078846               2.697115                         100.00000</span></span>
<span id="cb357-8"><a href="cap9.html#cb357-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-9"><a href="cap9.html#cb357-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Visualização da porcentagem de explicação de cada eixo nota: é necessário</span></span>
<span id="cb357-10"><a href="cap9.html#cb357-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ficar atento ao valor máximo do eixo 1 da análise para determinar o valor do</span></span>
<span id="cb357-11"><a href="cap9.html#cb357-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ylim (neste caso, colocamos que o eixo varia de 0 a 70).</span></span>
<span id="cb357-12"><a href="cap9.html#cb357-12" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_screeplot</span>(pca.p, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">70</span>))</span>
<span id="cb357-13"><a href="cap9.html#cb357-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-14"><a href="cap9.html#cb357-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Outros valores importantes</span></span>
<span id="cb357-15"><a href="cap9.html#cb357-15" aria-hidden="true" tabindex="-1"></a>var_env <span class="ot">&lt;-</span> <span class="fu">get_pca_var</span>(pca.p)</span>
<span id="cb357-16"><a href="cap9.html#cb357-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-17"><a href="cap9.html#cb357-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Escores (posição) das variáveis em cada eixo</span></span>
<span id="cb357-18"><a href="cap9.html#cb357-18" aria-hidden="true" tabindex="-1"></a>var_env<span class="sc">$</span>coord</span>
<span id="cb357-19"><a href="cap9.html#cb357-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Dim.1      Dim.2      Dim.3       Dim.4</span></span>
<span id="cb357-20"><a href="cap9.html#cb357-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill length     0.7518288 0.52943763 -0.3900969 -0.04768208</span></span>
<span id="cb357-21"><a href="cap9.html#cb357-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill depth     -0.6611860 0.70230869  0.2585287  0.05252186</span></span>
<span id="cb357-22"><a href="cap9.html#cb357-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Flipper length  0.9557480 0.00510580  0.1433474  0.25684871</span></span>
<span id="cb357-23"><a href="cap9.html#cb357-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Body mass       0.9107624 0.06744932  0.3592789 -0.19204478</span></span>
<span id="cb357-24"><a href="cap9.html#cb357-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-25"><a href="cap9.html#cb357-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Contribuição (%) das variáveis para cada eixo</span></span>
<span id="cb357-26"><a href="cap9.html#cb357-26" aria-hidden="true" tabindex="-1"></a>var_env<span class="sc">$</span>contrib</span>
<span id="cb357-27"><a href="cap9.html#cb357-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   Dim.1        Dim.2     Dim.3     Dim.4</span></span>
<span id="cb357-28"><a href="cap9.html#cb357-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill length    20.58919 36.023392267 41.279994  2.107420</span></span>
<span id="cb357-29"><a href="cap9.html#cb357-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill depth     15.92387 63.388588337 18.130600  2.556942</span></span>
<span id="cb357-30"><a href="cap9.html#cb357-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Flipper length 33.27271  0.003350291  5.574092 61.149849</span></span>
<span id="cb357-31"><a href="cap9.html#cb357-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Body mass      30.21423  0.584669105 35.015313 34.185789</span></span>
<span id="cb357-32"><a href="cap9.html#cb357-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-33"><a href="cap9.html#cb357-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Loadings - correlação das variáveis com os eixos</span></span>
<span id="cb357-34"><a href="cap9.html#cb357-34" aria-hidden="true" tabindex="-1"></a>var_env<span class="sc">$</span>cor</span>
<span id="cb357-35"><a href="cap9.html#cb357-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Dim.1      Dim.2      Dim.3       Dim.4</span></span>
<span id="cb357-36"><a href="cap9.html#cb357-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill length     0.7518288 0.52943763 -0.3900969 -0.04768208</span></span>
<span id="cb357-37"><a href="cap9.html#cb357-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill depth     -0.6611860 0.70230869  0.2585287  0.05252186</span></span>
<span id="cb357-38"><a href="cap9.html#cb357-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Flipper length  0.9557480 0.00510580  0.1433474  0.25684871</span></span>
<span id="cb357-39"><a href="cap9.html#cb357-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Body mass       0.9107624 0.06744932  0.3592789 -0.19204478</span></span>
<span id="cb357-40"><a href="cap9.html#cb357-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-41"><a href="cap9.html#cb357-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Qualidade da representação da variável. Esse valor é obtido multiplicado</span></span>
<span id="cb357-42"><a href="cap9.html#cb357-42" aria-hidden="true" tabindex="-1"></a><span class="do">## var_env$coord por var_env$coord</span></span>
<span id="cb357-43"><a href="cap9.html#cb357-43" aria-hidden="true" tabindex="-1"></a>var_env<span class="sc">$</span>cos2</span>
<span id="cb357-44"><a href="cap9.html#cb357-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    Dim.1        Dim.2      Dim.3       Dim.4</span></span>
<span id="cb357-45"><a href="cap9.html#cb357-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill length    0.5652466 2.803042e-01 0.15217561 0.002273581</span></span>
<span id="cb357-46"><a href="cap9.html#cb357-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill depth     0.4371669 4.932375e-01 0.06683710 0.002758546</span></span>
<span id="cb357-47"><a href="cap9.html#cb357-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Flipper length 0.9134542 2.606919e-05 0.02054847 0.065971260</span></span>
<span id="cb357-48"><a href="cap9.html#cb357-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Body mass      0.8294881 4.549411e-03 0.12908133 0.036881196</span></span>
<span id="cb357-49"><a href="cap9.html#cb357-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-50"><a href="cap9.html#cb357-50" aria-hidden="true" tabindex="-1"></a><span class="do">## Escores (posição) das localidades (&#39;site scores&#39;) em cada eixo</span></span>
<span id="cb357-51"><a href="cap9.html#cb357-51" aria-hidden="true" tabindex="-1"></a>ind_env <span class="ot">&lt;-</span> <span class="fu">get_pca_ind</span>(pca.p)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-pca-scree"></span>
<img src="livro_files/figure-html/fig-pca-scree-1.png" alt="Scree plot mostrando a porcentagem de contribuição de cada eixo para a ordenação dos dados de penguins." width="100%" height="100%" />
<p class="caption">
Figura 9.7: Scree plot mostrando a porcentagem de contribuição de cada eixo para a ordenação dos dados de penguins.
</p>
</div>
<p>O pacote <code>FactoMineR</code> criou uma função (<code>dimdesc()</code>) que seleciona as melhores variáveis (aquelas mais explicativas) para cada eixo através de uma análise fatorial. No exemplo com pinguins, o primeiro eixo (objeto <code>pca.p$eig</code>) explica ~69% da variação morfológica. A função <code>dimdesc()</code> mostra que as quatro variáveis morfológicas estão fortemente associadas com o eixo 1. Porém, enquanto comprimento da nadadeira, massa corporal e comprimento do bico estão positivamente associados com o eixo 1 (correlação positiva), a largura do bico tem relação negativa. O eixo 2, por sua vez, explica ~20% da variação, sendo relacionado somente com largura e comprimento do bico.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="cap9.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Variáveis mais importantes para o Eixo 1</span></span>
<span id="cb358-2"><a href="cap9.html#cb358-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dimdesc</span>(pca.p)<span class="sc">$</span>Dim<span class="fl">.1</span></span>
<span id="cb358-3"><a href="cap9.html#cb358-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $quanti</span></span>
<span id="cb358-4"><a href="cap9.html#cb358-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                correlation       p.value</span></span>
<span id="cb358-5"><a href="cap9.html#cb358-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Flipper length   0.9557480 5.962756e-178</span></span>
<span id="cb358-6"><a href="cap9.html#cb358-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Body mass        0.9107624 3.447018e-129</span></span>
<span id="cb358-7"><a href="cap9.html#cb358-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill length      0.7518288  7.830597e-62</span></span>
<span id="cb358-8"><a href="cap9.html#cb358-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill depth      -0.6611860  3.217695e-43</span></span>
<span id="cb358-9"><a href="cap9.html#cb358-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb358-10"><a href="cap9.html#cb358-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb358-11"><a href="cap9.html#cb358-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;condes&quot; &quot;list&quot;</span></span>
<span id="cb358-12"><a href="cap9.html#cb358-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-13"><a href="cap9.html#cb358-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Variáveis mais importantes para o Eixo 2</span></span>
<span id="cb358-14"><a href="cap9.html#cb358-14" aria-hidden="true" tabindex="-1"></a><span class="fu">dimdesc</span>(pca.p)<span class="sc">$</span>Dim<span class="fl">.2</span></span>
<span id="cb358-15"><a href="cap9.html#cb358-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $quanti</span></span>
<span id="cb358-16"><a href="cap9.html#cb358-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             correlation      p.value</span></span>
<span id="cb358-17"><a href="cap9.html#cb358-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill depth    0.7023087 8.689230e-51</span></span>
<span id="cb358-18"><a href="cap9.html#cb358-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bill length   0.5294376 1.873918e-25</span></span>
<span id="cb358-19"><a href="cap9.html#cb358-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb358-20"><a href="cap9.html#cb358-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb358-21"><a href="cap9.html#cb358-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;condes&quot; &quot;list&quot;</span></span></code></pre></div>
<p>Agora podemos utilizar o famoso <strong>biplot</strong> para representar a comparação morfológica dos pinguins dentro e entre espécies (Figura <a href="cap9.html#fig:fig-pca-biplot">9.8</a>).</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="cap9.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(<span class="at">X =</span> pca.p, <span class="at">geom.ind =</span> <span class="st">&quot;point&quot;</span>, <span class="at">fill.ind =</span> penguins<span class="sc">$</span>species, <span class="at">col.ind =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb359-2"><a href="cap9.html#cb359-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha.ind =</span> <span class="fl">0.7</span>, <span class="at">pointshape =</span> <span class="dv">21</span>, <span class="at">pointsize =</span> <span class="dv">4</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;darkorchid&quot;</span>,</span>
<span id="cb359-3"><a href="cap9.html#cb359-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;cyan4&quot;</span>), <span class="at">col.var =</span> <span class="st">&quot;black&quot;</span>, <span class="at">invisible =</span> <span class="st">&quot;quali&quot;</span>, <span class="at">title =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;PC1 (68.63%)&quot;</span>,</span>
<span id="cb359-4"><a href="cap9.html#cb359-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;PC2 (19.45%)&quot;</span>) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-pca-biplot"></span>
<img src="livro_files/figure-html/fig-pca-biplot-1.png" alt="Biplot da PCA ordenando os dados morfológicos de penguins." width="100%" height="100%" />
<p class="caption">
Figura 9.8: Biplot da PCA ordenando os dados morfológicos de penguins.
</p>
</div>
</div>
<div id="análises-de-coordenadas-principais-pcoa" class="section level3" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Análises de Coordenadas Principais (PCoA)</h3>
<p>Diferentemente da PCA, a Análises de Coordenadas Principais (<em>Principal Coordinate Analysis</em> - PCoA) é uma análise de ordenação irrestrita que aceita dados de diferentes tipos, como contínuos, categóricos, ordinais, binários, entre outros. Assim, a PCoA é aplicada para casos em que a distância euclidiana não é aplicada (como na PCA). Desse modo, o primeiro passo da análise é calcular uma matriz de similaridade ou de distância (discutido acima). Depois, os passos para obter autovalores e autovetores são bastante parecidos com a PCA. Da mesma forma, os eixos da PCoA e os valores ou posições dos objetos nesses eixos representam a relação de semelhança (ou diferença) baseada nos descritores desses objetos. A diferença, neste caso, é que a PCoA representa um espaço não-euclidiano, que irá ser afetado pela escolha do método de similaridade.</p>
<p>As utilizações mais comuns da PCoA são a ordenação: i) da matriz de composição de espécies usando a distância apropriada (Jaccard, Sorensen, Bray-Curtis), ii) da matriz de variáveis ambientais com mistos (contínuos, categóricos, circulares, etc.), e iii) da matriz filogenética <span class="citation">(método PVR <a href="#ref-diniz-filho_eigenvector_1998" role="doc-biblioref">Diniz-Filho et al., 1998</a>)</span>. Abaixo, exemplificamos a ordenação da matriz de composição de espécies.</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Compare as dimensões das matrizes utilizadas para a PCoA. Com bastante frequência, a tentativa de combinar dados categóricos (algum descritor dos objetos) com os valores obtidos com a PCoA gera erros para plotar a figura ou para executar a análise. Verifique, então, se as linhas são as mesmas (nome das localidades ou indivíduos e quantidade)</p></li>
<li><p>É fundamental conhecer o tipo de dados que está usando para selecionar a medida de distância apropriada. Essa escolha vai afetar a qualidade da ordenação e sua habilidade para interpretar a relação de semelhança entre os objetos comparados</p></li>
<li><p>Diferente da PCA, a PCoA aceita dados ausentes se a medida de distância escolhida também não tiver esta limitação. Por exemplo, a distância de Gower produz matrizes de similaridade mesmo com dados ausentes em determinados objetos</p></li>
<li><p>Em alguns casos, autovalores negativos são produzidos na ordenação com PCoA. Veja as principais causas desses valores em Legendre &amp; Legendre <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">2012</a>)</span>. Apesar deste problema, os autovalores mais importantes (eixos iniciais) não são afetados e, deste modo, a qualidade da representação dos objetos no espaço multidimensional não é afetada. Alguns autores sugerem utilizar correções métodos de correção, como Lingoes ou Cailliez <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>.</p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar a composição de ácaros Oribatidae em 70 manchas de musgo coletados por Borcard et al. <span class="citation">(<a href="#ref-borcard_partialling_1992" role="doc-biblioref">1992</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>A composição de espécies de ácaros muda entre diferentes topografias?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Iremos encontrar ao menos dois grupos de espécies: aquelas que ocorrem em poças dentro de floresta <em>versus</em> aquelas que ocorrem em poças de áreas abertas</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Preditora: topografia (categórica com dois níveis)</li>
<li>Dependentes: composição de espécies de ácaro</li>
</ul>
<p><strong>Análises</strong></p>
<p>Vamos primeramente padronizar dos dados, calcular uma matriz de distância com método Bray-Curtis e depois calcular a PCoA.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="cap9.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Padronização dos dados com Hellinger</span></span>
<span id="cb360-2"><a href="cap9.html#cb360-2" aria-hidden="true" tabindex="-1"></a>mite.hel <span class="ot">&lt;-</span> <span class="fu">decostand</span>(<span class="at">x =</span> mite, <span class="at">method =</span> <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb360-3"><a href="cap9.html#cb360-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-4"><a href="cap9.html#cb360-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Cálculo da matriz de distância com método Bray-Curtis</span></span>
<span id="cb360-5"><a href="cap9.html#cb360-5" aria-hidden="true" tabindex="-1"></a>sps.dis <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="at">x =</span> mite.hel, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb360-6"><a href="cap9.html#cb360-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-7"><a href="cap9.html#cb360-7" aria-hidden="true" tabindex="-1"></a><span class="do">## PCoA</span></span>
<span id="cb360-8"><a href="cap9.html#cb360-8" aria-hidden="true" tabindex="-1"></a>pcoa.sps <span class="ot">&lt;-</span> <span class="fu">pcoa</span>(<span class="at">D =</span> sps.dis, <span class="at">correction =</span> <span class="st">&quot;cailliez&quot;</span>)</span></code></pre></div>
<p>Assim como na PCA, a porcentagem de explicação dos eixos é uma das informações mais importantes pois descrevem a efetividade da redução da dimensionalidade dos dados.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="cap9.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Porcentagem de explicação do Eixo 1</span></span>
<span id="cb361-2"><a href="cap9.html#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> (pcoa.sps<span class="sc">$</span>values[, <span class="dv">1</span>]<span class="sc">/</span>pcoa.sps<span class="sc">$</span>trace)[<span class="dv">1</span>]</span>
<span id="cb361-3"><a href="cap9.html#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 49.10564</span></span>
<span id="cb361-4"><a href="cap9.html#cb361-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-5"><a href="cap9.html#cb361-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Porcentagem de explicação dos Eixo 2</span></span>
<span id="cb361-6"><a href="cap9.html#cb361-6" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> (pcoa.sps<span class="sc">$</span>values[, <span class="dv">1</span>]<span class="sc">/</span>pcoa.sps<span class="sc">$</span>trace)[<span class="dv">2</span>]</span>
<span id="cb361-7"><a href="cap9.html#cb361-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 14.30308</span></span>
<span id="cb361-8"><a href="cap9.html#cb361-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-9"><a href="cap9.html#cb361-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Porcentagem de explicação acumulada dos dois primeiros eixos</span></span>
<span id="cb361-10"><a href="cap9.html#cb361-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="dv">100</span> <span class="sc">*</span> (pcoa.sps<span class="sc">$</span>values[, <span class="dv">1</span>]<span class="sc">/</span>pcoa.sps<span class="sc">$</span>trace)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb361-11"><a href="cap9.html#cb361-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 63.40872</span></span>
<span id="cb361-12"><a href="cap9.html#cb361-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-13"><a href="cap9.html#cb361-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Selecionar os dois primeiros eixos</span></span>
<span id="cb361-14"><a href="cap9.html#cb361-14" aria-hidden="true" tabindex="-1"></a>eixos <span class="ot">&lt;-</span> pcoa.sps<span class="sc">$</span>vectors[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb361-15"><a href="cap9.html#cb361-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-16"><a href="cap9.html#cb361-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Juntar com algum dado categórico de interesse para fazer a figura</span></span>
<span id="cb361-17"><a href="cap9.html#cb361-17" aria-hidden="true" tabindex="-1"></a>pcoa.dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">topografia =</span> mite.env<span class="sc">$</span>Topo, eixos)</span></code></pre></div>
<p>Para visualizar os resultados da PCoA, vamos exportar os escores dos eixos para usar no pacote <code>ggplot2</code> (Figura <a href="cap9.html#fig:fig-pcoa-biplot">9.9</a>).</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="cap9.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Escores dos dois primeiros eixos</span></span>
<span id="cb362-2"><a href="cap9.html#cb362-2" aria-hidden="true" tabindex="-1"></a>eixos <span class="ot">&lt;-</span> pcoa.sps<span class="sc">$</span>vectors[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb362-3"><a href="cap9.html#cb362-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-4"><a href="cap9.html#cb362-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Combinar dados dos escores com um dado categórico de interesse para nossa</span></span>
<span id="cb362-5"><a href="cap9.html#cb362-5" aria-hidden="true" tabindex="-1"></a><span class="do">## pergunta</span></span>
<span id="cb362-6"><a href="cap9.html#cb362-6" aria-hidden="true" tabindex="-1"></a>pcoa.dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">topografia =</span> mite.env<span class="sc">$</span>Topo, eixos)</span>
<span id="cb362-7"><a href="cap9.html#cb362-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-8"><a href="cap9.html#cb362-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Gráfico biplot da PCoA</span></span>
<span id="cb362-9"><a href="cap9.html#cb362-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pcoa.dat, <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>, <span class="at">y =</span> Axis<span class="fl">.2</span>, <span class="at">fill =</span> topografia, <span class="at">color =</span> topografia,</span>
<span id="cb362-10"><a href="cap9.html#cb362-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> topografia)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,</span>
<span id="cb362-11"><a href="cap9.html#cb362-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">22</span>)) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb362-12"><a href="cap9.html#cb362-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;PCO 1 (49.11%)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;PCO 2 (14.30%)&quot;</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb362-13"><a href="cap9.html#cb362-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-pcoa-biplot"></span>
<img src="livro_files/figure-html/fig-pcoa-biplot-1.png" alt="Biplot da PCoA ordenando as espécies de ácaros entre diferentes topografias." width="100%" height="100%" />
<p class="caption">
Figura 9.9: Biplot da PCoA ordenando as espécies de ácaros entre diferentes topografias.
</p>
</div>
<p><strong>Limitações importantes das ordenações irrestritas</strong></p>
<p>Com frequência, pesquisadores utilizam análises como PCA e PCoA para “testar” diferenças na composição de espécies entre determinados fatores relevantes (altitude, clima, etc.). Porém, como falado acima, as análises de ordenação irrestritas não são utilizadas para testar qualquer hipótese. Ao invés disso, essas análises representam uma poderosa ferramente para explorar padrões em variáveis dependentes ou independentes para ajudar na interpretação ou mesmo para testar hipóteses em análises combinadas com as ordenações restritas.</p>
</div>
<div id="regressão-de-componentes-principais-pcr" class="section level3" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> Regressão de Componentes Principais (PCR)</h3>
<p>Uma maneira de testar hipóteses utilizando ordenações irrestritas é utilizando os resultados da ordenação (escores) como variáveis preditoras ou dependentes como, por exemplo, em modelos lineares (e.g., regressão múltipla Capítulo <a href="cap7.html#cap7">7</a>). O primeiro passo é utilizar uma ordenação, como a PCA, para gerar os “novos” dados que serão usados na análise. A utilização desses novos dados (que representam as coordenadas principais ou escores da PCA) vai depender da pergunta em questão. Por exemplo, pode ser que esses valores representem gradientes climáticos e, por este motivo, serão utilizados como variáveis preditoras em um modelo linear (e.g., regressão múltipla). Por outro lado, esses valores podem representar o espaço morfológicos de espécies de peixes e, como consequência, serão utilizados como variáveis dependentes para entender o efeito da presença de predador sobre a morfologia.</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Compare as dimensões das matrizes utilizadas para a PCR. Com bastante frequência, a tentativa de combinar dados categóricos (algum descritor dos objetos) com os valores obtidos com a PCoA gera erros para plotar a figura ou para executar a análise. Verifique, então, se as linhas são as mesmas (nome das localidades ou indivíduos e quantidade)</p></li>
<li><p>Estudos recentes têm criticado a utilização de PCR para testar hipóteses ecológicas pelo fato dos escores não representarem, necessariamente, a variação total das variáveis originais, bem como a relação entre a variável preditora e a dependente</p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar a composição de espécies de aves em 23 regiões dos alpes franceses. Os dados ambientais (env) representam variáveis climáticas (temperatura e chuva) e altitude.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Gradientes climáticos afetam a riqueza de aves?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>O aumento da umidade e redução da temperatura aumentam o número de espécies de aves</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Preditora: temperatura e chuva (contínuas) e altitude (categórica com três níveis)</li>
<li>Dependentes: riqueza de espécies de aves</li>
</ul>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="cap9.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados</span></span>
<span id="cb363-2"><a href="cap9.html#cb363-2" aria-hidden="true" tabindex="-1"></a>env_cont <span class="ot">&lt;-</span> env[, <span class="sc">-</span><span class="dv">8</span>]</span>
<span id="cb363-3"><a href="cap9.html#cb363-3" aria-hidden="true" tabindex="-1"></a>env.pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(env_cont, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb363-4"><a href="cap9.html#cb363-4" aria-hidden="true" tabindex="-1"></a>var_env <span class="ot">&lt;-</span> <span class="fu">get_pca_var</span>(env.pca)</span>
<span id="cb363-5"><a href="cap9.html#cb363-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-6"><a href="cap9.html#cb363-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Contribuição (%) das variáveis para cada eixo</span></span>
<span id="cb363-7"><a href="cap9.html#cb363-7" aria-hidden="true" tabindex="-1"></a>var_env<span class="sc">$</span>contrib</span>
<span id="cb363-8"><a href="cap9.html#cb363-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Dim.1      Dim.2      Dim.3      Dim.4       Dim.5</span></span>
<span id="cb363-9"><a href="cap9.html#cb363-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jan 10.93489 22.2975487 16.1607726  7.6025527  0.01782438</span></span>
<span id="cb363-10"><a href="cap9.html#cb363-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jan 20.18065  3.2890767  2.1814486  4.2756350 41.05646526</span></span>
<span id="cb363-11"><a href="cap9.html#cb363-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jul 11.87396 21.1379132  0.3428843  0.7750666 44.70209396</span></span>
<span id="cb363-12"><a href="cap9.html#cb363-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jul 18.47244  0.9159957 56.5369988  9.4368661  2.59283074</span></span>
<span id="cb363-13"><a href="cap9.html#cb363-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jan  9.95206 21.5387403  6.5737927 53.7375738  4.44283706</span></span>
<span id="cb363-14"><a href="cap9.html#cb363-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jul 16.14997 11.2368132  7.2608047 19.6972097  0.71454880</span></span>
<span id="cb363-15"><a href="cap9.html#cb363-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.tot 12.43603 19.5839121 10.9432983  4.4750959  6.47339980</span></span>
<span id="cb363-16"><a href="cap9.html#cb363-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-17"><a href="cap9.html#cb363-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Loadings - correlação das variáveis com os eixos</span></span>
<span id="cb363-18"><a href="cap9.html#cb363-18" aria-hidden="true" tabindex="-1"></a>var_env<span class="sc">$</span>cor</span>
<span id="cb363-19"><a href="cap9.html#cb363-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Dim.1     Dim.2       Dim.3       Dim.4        Dim.5</span></span>
<span id="cb363-20"><a href="cap9.html#cb363-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jan  0.6830371 0.6766524 -0.21924927  0.12298817 -0.004517369</span></span>
<span id="cb363-21"><a href="cap9.html#cb363-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jan  0.9279073 0.2598807 -0.08055260  0.09223249  0.216804944</span></span>
<span id="cb363-22"><a href="cap9.html#cb363-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jul  0.7117620 0.6588220  0.03193603 -0.03926930 -0.226225907</span></span>
<span id="cb363-23"><a href="cap9.html#cb363-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jul  0.8877675 0.1371462  0.41008461 -0.13702428  0.054483561</span></span>
<span id="cb363-24"><a href="cap9.html#cb363-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jan -0.6516187 0.6650391 -0.13983474 -0.32698110  0.071319550</span></span>
<span id="cb363-25"><a href="cap9.html#cb363-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jul -0.8300858 0.4803509  0.14696011  0.19796389 -0.028601865</span></span>
<span id="cb363-26"><a href="cap9.html#cb363-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.tot -0.7284135 0.6341424  0.18041856  0.09435932  0.086088397</span></span>
<span id="cb363-27"><a href="cap9.html#cb363-27" aria-hidden="true" tabindex="-1"></a>ind_env <span class="ot">&lt;-</span> <span class="fu">get_pca_ind</span>(env.pca)</span>
<span id="cb363-28"><a href="cap9.html#cb363-28" aria-hidden="true" tabindex="-1"></a>env.pca<span class="sc">$</span>eig</span>
<span id="cb363-29"><a href="cap9.html#cb363-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        eigenvalue percentage of variance cumulative percentage of variance</span></span>
<span id="cb363-30"><a href="cap9.html#cb363-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 1 4.26652359             60.9503370                          60.95034</span></span>
<span id="cb363-31"><a href="cap9.html#cb363-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 2 2.05340251             29.3343216                          90.28466</span></span>
<span id="cb363-32"><a href="cap9.html#cb363-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 3 0.29745014              4.2492878                          94.53395</span></span>
<span id="cb363-33"><a href="cap9.html#cb363-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 4 0.19896067              2.8422953                          97.37624</span></span>
<span id="cb363-34"><a href="cap9.html#cb363-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 5 0.11448717              1.6355310                          99.01177</span></span>
<span id="cb363-35"><a href="cap9.html#cb363-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 6 0.04312874              0.6161248                          99.62790</span></span>
<span id="cb363-36"><a href="cap9.html#cb363-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 7 0.02604718              0.3721025                         100.00000</span></span></code></pre></div>
<p>O objeto <code>env.pca$eig</code> demonstra que os três primeiros eixos explicam 94.54% da variação total dos dados climáticos. O intuito da PCR é reduzir a dimensionalidade, ou seja, o número de variáveis preditoras ou depedentes para facilitar a interpretação e garantir que as variáveis não sejam correlacionadas. O próximo passo então é obter os valores dos escores que representam os valores convertidos para serem usados em uma determinada análise, como a regressão múltipla.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="cap9.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 1: obter os primeiros eixos</span></span>
<span id="cb364-2"><a href="cap9.html#cb364-2" aria-hidden="true" tabindex="-1"></a>pred.env <span class="ot">&lt;-</span> ind_env<span class="sc">$</span>coord[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb364-3"><a href="cap9.html#cb364-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-4"><a href="cap9.html#cb364-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 2: calcular a riqueza de espécies</span></span>
<span id="cb364-5"><a href="cap9.html#cb364-5" aria-hidden="true" tabindex="-1"></a>riqueza <span class="ot">&lt;-</span> <span class="fu">specnumber</span>(species)</span>
<span id="cb364-6"><a href="cap9.html#cb364-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-7"><a href="cap9.html#cb364-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 3: combinar os dois valores em um único data.frame</span></span>
<span id="cb364-8"><a href="cap9.html#cb364-8" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pred.env, riqueza)</span></code></pre></div>
<p>Agora que os dados foram combinados em uma único data frame, podemos utilizar os códigos apresentados no Capítulo <a href="cap7.html#cap7">7</a> para testar nossa hipótese (Figura <a href="cap9.html#fig:fig-pcr-aves-diag">9.10</a>).</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="cap9.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Regressão múltipla</span></span>
<span id="cb365-2"><a href="cap9.html#cb365-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(riqueza <span class="sc">~</span> Dim<span class="fl">.1</span> <span class="sc">+</span> Dim<span class="fl">.2</span> <span class="sc">+</span> Dim<span class="fl">.3</span>, <span class="at">data =</span> dat)</span>
<span id="cb365-3"><a href="cap9.html#cb365-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb365-4"><a href="cap9.html#cb365-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1)  <span class="co"># verificar pressupostos dos modelos lineares</span></span>
<span id="cb365-5"><a href="cap9.html#cb365-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)  <span class="co"># resultados do  teste</span></span>
<span id="cb365-6"><a href="cap9.html#cb365-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb365-7"><a href="cap9.html#cb365-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb365-8"><a href="cap9.html#cb365-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = riqueza ~ Dim.1 + Dim.2 + Dim.3, data = dat)</span></span>
<span id="cb365-9"><a href="cap9.html#cb365-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb365-10"><a href="cap9.html#cb365-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb365-11"><a href="cap9.html#cb365-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb365-12"><a href="cap9.html#cb365-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -3.4008 -1.1729  0.4356  1.2072  2.4571 </span></span>
<span id="cb365-13"><a href="cap9.html#cb365-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb365-14"><a href="cap9.html#cb365-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb365-15"><a href="cap9.html#cb365-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb365-16"><a href="cap9.html#cb365-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 13.30435    0.37639  35.347  &lt; 2e-16 ***</span></span>
<span id="cb365-17"><a href="cap9.html#cb365-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dim.1        0.68591    0.18222   3.764  0.00131 ** </span></span>
<span id="cb365-18"><a href="cap9.html#cb365-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dim.2       -0.09961    0.26267  -0.379  0.70874    </span></span>
<span id="cb365-19"><a href="cap9.html#cb365-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dim.3       -0.21708    0.69014  -0.315  0.75654    </span></span>
<span id="cb365-20"><a href="cap9.html#cb365-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb365-21"><a href="cap9.html#cb365-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb365-22"><a href="cap9.html#cb365-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb365-23"><a href="cap9.html#cb365-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 1.805 on 19 degrees of freedom</span></span>
<span id="cb365-24"><a href="cap9.html#cb365-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.4313, Adjusted R-squared:  0.3415 </span></span>
<span id="cb365-25"><a href="cap9.html#cb365-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 4.804 on 3 and 19 DF,  p-value: 0.01179</span></span>
<span id="cb365-26"><a href="cap9.html#cb365-26" aria-hidden="true" tabindex="-1"></a><span class="fu">dimdesc</span>(env.pca)<span class="sc">$</span>Dim<span class="fl">.1</span></span>
<span id="cb365-27"><a href="cap9.html#cb365-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $quanti</span></span>
<span id="cb365-28"><a href="cap9.html#cb365-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          correlation      p.value</span></span>
<span id="cb365-29"><a href="cap9.html#cb365-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jan   0.9279073 1.846790e-10</span></span>
<span id="cb365-30"><a href="cap9.html#cb365-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jul   0.8877675 1.607390e-08</span></span>
<span id="cb365-31"><a href="cap9.html#cb365-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jul   0.7117620 1.396338e-04</span></span>
<span id="cb365-32"><a href="cap9.html#cb365-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jan   0.6830371 3.282701e-04</span></span>
<span id="cb365-33"><a href="cap9.html#cb365-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jan  -0.6516187 7.559358e-04</span></span>
<span id="cb365-34"><a href="cap9.html#cb365-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.tot  -0.7284135 8.112903e-05</span></span>
<span id="cb365-35"><a href="cap9.html#cb365-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jul  -0.8300858 9.588034e-07</span></span>
<span id="cb365-36"><a href="cap9.html#cb365-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb365-37"><a href="cap9.html#cb365-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb365-38"><a href="cap9.html#cb365-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;condes&quot; &quot;list&quot;</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-pcr-aves-diag"></span>
<img src="livro_files/figure-html/fig-pcr-aves-diag-1.png" alt="Diagnósticos dos modelo PCR para aves." width="100%" height="100%" />
<p class="caption">
Figura 9.10: Diagnósticos dos modelo PCR para aves.
</p>
</div>
<p>Como percebemos, a Dim.1 foi o único gradiente ambiental que afetou a riqueza de espécies. Para interpretar esta dimensão (e outras importantes), podemos usar a função <code>dimdesc()</code> para verificar as variáveis mais importantes. Neste caso, os valores mais extremos de correlação (maior que 0.8) indicam que a temperatura do mês de janeiro e julho bem como a chuva do mês de julho foram as variáveis mais importantes para determinar o gradiente ambiental expresso na dimensão 1. Assim, podemos fazer um gráfico para representar a relação entre Eixo 1 (gradiente chuva-temperatura) e a riqueza de espécies de aves. Valores negativos do eixo 1 (Gradiente ambiental - PC1) representam localidades com mais chuva, ao passo que valores positivos indicam localidades com temperaturas maiores (Figura <a href="cap9.html#fig:fig-pcr-aves-model">9.11</a>).</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="cap9.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> Dim<span class="fl">.1</span>, <span class="at">y =</span> riqueza)) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">fill =</span> <span class="st">&quot;#525252&quot;</span>,</span>
<span id="cb366-2"><a href="cap9.html#cb366-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&quot;#1a1a1a&quot;</span>,</span>
<span id="cb366-3"><a href="cap9.html#cb366-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;cyan4&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Gradiente ambiental (PC1)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Riqueza de aves&quot;</span>) <span class="sc">+</span></span>
<span id="cb366-4"><a href="cap9.html#cb366-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-pcr-aves-model"></span>
<img src="livro_files/figure-html/fig-pcr-aves-model-1.png" alt="Modelo linear representando a relação entre Eixo 1 (gradiente chuva-temperatura) e a riqueza de espécies de aves." width="100%" height="100%" />
<p class="caption">
Figura 9.11: Modelo linear representando a relação entre Eixo 1 (gradiente chuva-temperatura) e a riqueza de espécies de aves.
</p>
</div>
<p><strong>Exemplo 2</strong></p>
<p>É possível que os dados utilizados em seu estudo sejam mistos, ou seja, incluem tanto variáveis categóricas quanto contínuas. Como falado acima, nesses casos a análise indicada é a PCoA. Assim como na PCA, podemos extrair os escores da PCoA para utilizar em análises univariadas e multivariadas.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Variáveis climáticas, vegetacionais e topográficas afetam a riqueza de ácaros?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>A densidade da vegetação e disponibilidade de água aumentam a riqueza de espécies de ácaros</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Preditoras: densidade de substrado e disponibilidade de água (contínuas), tipo de substrado (categórica com 7 níveis), densidade arbusto (ordinal com 3 níveis), e topografia (categórica com 2 níveis)</li>
<li>Dependentes: riqueza de espécies de ácaros</li>
</ul>
<p>O primeiro passo então é utilizar um método de distância apropriado para o seu conjunto de dados. Em nosso exemplo, utilizaremos a distância de Gower, que é usada para dados mistos (veja Capítulo <a href="cap14.html#cap14">14</a>).</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="cap9.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Matriz de distância</span></span>
<span id="cb367-2"><a href="cap9.html#cb367-2" aria-hidden="true" tabindex="-1"></a>env.dist <span class="ot">&lt;-</span> <span class="fu">gowdis</span>(mite.env)</span>
<span id="cb367-3"><a href="cap9.html#cb367-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-4"><a href="cap9.html#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="do">## PCoA</span></span>
<span id="cb367-5"><a href="cap9.html#cb367-5" aria-hidden="true" tabindex="-1"></a>env.mite.pco <span class="ot">&lt;-</span> <span class="fu">pcoa</span>(env.dist, <span class="at">correction =</span> <span class="st">&quot;cailliez&quot;</span>)</span>
<span id="cb367-6"><a href="cap9.html#cb367-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-7"><a href="cap9.html#cb367-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Porcentagem de explicação do Eixo 1</span></span>
<span id="cb367-8"><a href="cap9.html#cb367-8" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> (env.mite.pco<span class="sc">$</span>values[, <span class="dv">1</span>]<span class="sc">/</span>env.mite.pco<span class="sc">$</span>trace)[<span class="dv">1</span>]</span>
<span id="cb367-9"><a href="cap9.html#cb367-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 61.49635</span></span>
<span id="cb367-10"><a href="cap9.html#cb367-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-11"><a href="cap9.html#cb367-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Porcentagem de explicação dos Eixo 2</span></span>
<span id="cb367-12"><a href="cap9.html#cb367-12" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> (env.mite.pco<span class="sc">$</span>values[, <span class="dv">1</span>]<span class="sc">/</span>env.mite.pco<span class="sc">$</span>trace)[<span class="dv">2</span>]</span>
<span id="cb367-13"><a href="cap9.html#cb367-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 32.15486</span></span></code></pre></div>
<p>O próximo passo é exportar os escores para as análises <em>a posteriori</em> (Figura <a href="cap9.html#fig:fig-pcr-acaros-diag">9.12</a>).</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="cap9.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Selecionar os dois primeiros eixos</span></span>
<span id="cb368-2"><a href="cap9.html#cb368-2" aria-hidden="true" tabindex="-1"></a>pred.scores.mite <span class="ot">&lt;-</span> env.mite.pco<span class="sc">$</span>vectors[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb368-3"><a href="cap9.html#cb368-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-4"><a href="cap9.html#cb368-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Juntar com os dados da área para fazer a figura</span></span>
<span id="cb368-5"><a href="cap9.html#cb368-5" aria-hidden="true" tabindex="-1"></a>mite.riqueza <span class="ot">&lt;-</span> <span class="fu">specnumber</span>(mite)</span>
<span id="cb368-6"><a href="cap9.html#cb368-6" aria-hidden="true" tabindex="-1"></a>pred.vars <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">riqueza =</span> mite.riqueza, pred.scores.mite)</span>
<span id="cb368-7"><a href="cap9.html#cb368-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-8"><a href="cap9.html#cb368-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Regressão múltipla</span></span>
<span id="cb368-9"><a href="cap9.html#cb368-9" aria-hidden="true" tabindex="-1"></a>mod.mite <span class="ot">&lt;-</span> <span class="fu">lm</span>(riqueza <span class="sc">~</span> Axis<span class="fl">.1</span> <span class="sc">+</span> Axis<span class="fl">.2</span>, <span class="at">data =</span> pred.vars)</span>
<span id="cb368-10"><a href="cap9.html#cb368-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb368-11"><a href="cap9.html#cb368-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.mite)</span>
<span id="cb368-12"><a href="cap9.html#cb368-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.mite)</span>
<span id="cb368-13"><a href="cap9.html#cb368-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb368-14"><a href="cap9.html#cb368-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb368-15"><a href="cap9.html#cb368-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = riqueza ~ Axis.1 + Axis.2, data = pred.vars)</span></span>
<span id="cb368-16"><a href="cap9.html#cb368-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb368-17"><a href="cap9.html#cb368-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb368-18"><a href="cap9.html#cb368-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb368-19"><a href="cap9.html#cb368-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -10.6874  -2.3960  -0.1378   2.5032   8.6873 </span></span>
<span id="cb368-20"><a href="cap9.html#cb368-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb368-21"><a href="cap9.html#cb368-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb368-22"><a href="cap9.html#cb368-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb368-23"><a href="cap9.html#cb368-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  15.1143     0.4523  33.415  &lt; 2e-16 ***</span></span>
<span id="cb368-24"><a href="cap9.html#cb368-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Axis.1      -11.4303     2.0013  -5.711  2.8e-07 ***</span></span>
<span id="cb368-25"><a href="cap9.html#cb368-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Axis.2        5.6832     2.7677   2.053   0.0439 *  </span></span>
<span id="cb368-26"><a href="cap9.html#cb368-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb368-27"><a href="cap9.html#cb368-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb368-28"><a href="cap9.html#cb368-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb368-29"><a href="cap9.html#cb368-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 3.784 on 67 degrees of freedom</span></span>
<span id="cb368-30"><a href="cap9.html#cb368-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.3548, Adjusted R-squared:  0.3355 </span></span>
<span id="cb368-31"><a href="cap9.html#cb368-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 18.42 on 2 and 67 DF,  p-value: 4.225e-07</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-pcr-acaros-diag"></span>
<img src="livro_files/figure-html/fig-pcr-acaros-diag-1.png" alt="Diagnósticos dos modelo PCR para ácaros." width="100%" height="100%" />
<p class="caption">
Figura 9.12: Diagnósticos dos modelo PCR para ácaros.
</p>
</div>
<p>Finalmente, após interpretar os resultados do modelo, podemos fazer a figura com as variáveis (eixos) importantes (Figura <a href="cap9.html#fig:fig-pcr-acaros-model">9.13</a>).</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="cap9.html#cb369-1" aria-hidden="true" tabindex="-1"></a>g_acari_axi1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pred.vars, <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.1</span>, <span class="at">y =</span> riqueza)) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb369-2"><a href="cap9.html#cb369-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;#525252&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb369-3"><a href="cap9.html#cb369-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;#1a1a1a&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;cyan4&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Gradiente ambiental (PC1)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Riqueza de ácaros&quot;</span>) <span class="sc">+</span></span>
<span id="cb369-4"><a href="cap9.html#cb369-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tema_livro</span>()</span>
<span id="cb369-5"><a href="cap9.html#cb369-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-6"><a href="cap9.html#cb369-6" aria-hidden="true" tabindex="-1"></a>g_acari_axi2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pred.vars, <span class="fu">aes</span>(<span class="at">x =</span> Axis<span class="fl">.2</span>, <span class="at">y =</span> riqueza)) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb369-7"><a href="cap9.html#cb369-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;#525252&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb369-8"><a href="cap9.html#cb369-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;#1a1a1a&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;darkorange&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Gradiente ambiental (PC2)&quot;</span>,</span>
<span id="cb369-9"><a href="cap9.html#cb369-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Riqueza de ácaros&quot;</span>) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span>
<span id="cb369-10"><a href="cap9.html#cb369-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-11"><a href="cap9.html#cb369-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Função para combinar os dois plots em uma única janela</span></span>
<span id="cb369-12"><a href="cap9.html#cb369-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g_acari_axi1, g_acari_axi2, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-pcr-acaros-model"></span>
<img src="livro_files/figure-html/fig-pcr-acaros-model-1.png" alt="Modelo linear representando a relação entre Eixo 1 e Eixo 2 e a riqueza de espécies de ácaros." width="100%" height="100%" />
<p class="caption">
Figura 9.13: Modelo linear representando a relação entre Eixo 1 e Eixo 2 e a riqueza de espécies de ácaros.
</p>
</div>
</div>
</div>
<div id="ordenação-restrita" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Ordenação restrita</h2>
<p>A ordenação restrita ou análise de gradiente direto, organiza os objetos de acordo com suas relações com outras variáveis (preditoras) coletadas nas mesmas unidades amostrais. O exemplo mais comum na ecologia é de investigar a relação entre diversas variáveis ambientais (matriz <strong>X</strong>) coletadas em <em>n</em> localidades e a abundância (ou presença ausência) de <em>y</em> espécies coletadas nas mesmas localidades (matrix <strong>Y</strong>). Com frequência, outras dados são utilizados como as coordenadas geográficas das unidades amostrais (matriz <strong>W</strong>), os atributos funcionais das espécies coletadas (matriz <strong>T</strong>) e a relação filogenética dessas espécies (matriz <strong>P</strong>). Diversos métodos são utilizados para combinar duas ou mais matrizes, mas neste capítulo iremos apresentar a Análise de Redundância (RDA), Análise de Redundância parcial (RDAp) e métodos espaciais para incluir a matriz <strong>W</strong> nas análises de gradiente direto.</p>
<div id="análise-de-redundância-rda" class="section level3" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> Análise de Redundância (RDA)</h3>
<p>A RDA é uma análise semelhante à regressão múltipla (Capítulo <a href="cap7.html#cap7">7</a>), mas que usa dados multivariados como variável dependente. As duas matrizes comuns, matriz X (<em>n</em> unidades amostraits e <em>m</em> variáveis) e matriz Y (<em>n</em> unidades amostrais e <em>p</em> descritores - geralmente, espécies). O primeiro passo da RDA é centralizar (assim como na PCA, exemplo acima) as matrizes X e Y. Após a centralização, realiza-se regressões lineares entre X e Y para obter os valores preditos de Y (ou seja, os valores de Y que representação uma combinação linear com X). O passo seguinte é realizar uma PCA dos valores preditos de Y. Este último procedimento gera os autovalores, autovetores e os eixos canônicos que correspondem às coordenadas dos objetos (unidades amostrais), variáveis preditoras e das variáveis resposta. A diferença da ordenação do valor de Y predito e da ordenação somente de Y (como na PCA implementada acima) é que a segunda mostra a posição prevista pela relação linear entre X e Y. Logo, essa é exatamente o motivo da ordenação ser conhecida como restrita, pois a variação em Y é restrita (linearmente) pela variação de X. Assim como na regressão múltipla, a estatística da RDA é representada pelo valor de <em>R<sup>2</sup></em> e <em>F</em>. O valor de <em>R<sup>2</sup></em> indica a força da relação linear entre X e Y e o valor do <em>F</em> representa o teste global de significância. Além disso, é possível testar a significância de cada um dos eixos da ordenação (e a presença de pelo menos um eixo significativo é pré-requisito para que exista a relação linear entre X e Y) e de cada uma das variáveis preditoras da matriz X.</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Variáveis preditoras: importante verificar se: i) a estrutura de correlação das variáveis ambientais, e a ii) presença de autocorrelação espacial</p></li>
<li><p>Composição de espécies como matriz Y: fundamental observar se os valores utilizados representam abundância ou presença-ausência e qual a necessidade de padronização (e.g., Hellinger)</p></li>
<li><p>Assim como em modelos de regressão linear simples e múltipla, os valores de <em>R<sup>2</sup></em> ajustado devem ser selecionados ao invés do valor de <em>R<sup>2</sup></em></p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Espécies de aves que ocorrem em localidades com diferentes altitudes.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>O clima e a altitude modificam a composição de espécies de aves?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Diferenças climáticas (temperatura e chuva) e altitudinais alteram a composição de espécies de aves</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Preditoras: Temperatura e precipitação (contínuas) e altitude (categórica com três níveis)</li>
<li>Dependente: composição de espécies de aves</li>
</ul>
<p><strong>Análises</strong></p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="cap9.html#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 1: transformação de hellinger da matriz de espécies caso tenha dados</span></span>
<span id="cb370-2"><a href="cap9.html#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="do">## de abundância.</span></span>
<span id="cb370-3"><a href="cap9.html#cb370-3" aria-hidden="true" tabindex="-1"></a>species.hel <span class="ot">&lt;-</span> <span class="fu">decostand</span>(<span class="at">x =</span> species, <span class="at">method =</span> <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb370-4"><a href="cap9.html#cb370-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-5"><a href="cap9.html#cb370-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 2: selecionar variáveis importantes Para isso, é necessário remover a</span></span>
<span id="cb370-6"><a href="cap9.html#cb370-6" aria-hidden="true" tabindex="-1"></a><span class="do">## variável categórica.</span></span>
<span id="cb370-7"><a href="cap9.html#cb370-7" aria-hidden="true" tabindex="-1"></a>env.contin <span class="ot">&lt;-</span> env[, <span class="sc">-</span><span class="dv">8</span>]</span>
<span id="cb370-8"><a href="cap9.html#cb370-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-9"><a href="cap9.html#cb370-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Evite usar variáveis muito correlacionadas</span></span>
<span id="cb370-10"><a href="cap9.html#cb370-10" aria-hidden="true" tabindex="-1"></a>sel.vars <span class="ot">&lt;-</span> <span class="fu">forward.sel</span>(species.hel, env.contin)</span>
<span id="cb370-11"><a href="cap9.html#cb370-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Testing variable 1</span></span>
<span id="cb370-12"><a href="cap9.html#cb370-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Testing variable 2</span></span>
<span id="cb370-13"><a href="cap9.html#cb370-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Testing variable 3</span></span>
<span id="cb370-14"><a href="cap9.html#cb370-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 3 is 0.212000 (&gt; 0.050000)</span></span>
<span id="cb370-15"><a href="cap9.html#cb370-15" aria-hidden="true" tabindex="-1"></a>sel.vars<span class="sc">$</span>variables</span>
<span id="cb370-16"><a href="cap9.html#cb370-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;rain.jul&quot; &quot;maxi.jul&quot;</span></span>
<span id="cb370-17"><a href="cap9.html#cb370-17" aria-hidden="true" tabindex="-1"></a>env.sel <span class="ot">&lt;-</span> env[, sel.vars<span class="sc">$</span>variables]</span>
<span id="cb370-18"><a href="cap9.html#cb370-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-19"><a href="cap9.html#cb370-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 3: padronizar matriz ambiental (somente variáveis contínuas)</span></span>
<span id="cb370-20"><a href="cap9.html#cb370-20" aria-hidden="true" tabindex="-1"></a>env.pad <span class="ot">&lt;-</span> <span class="fu">decostand</span>(<span class="at">x =</span> env.sel, <span class="at">method =</span> <span class="st">&quot;standardize&quot;</span>)</span>
<span id="cb370-21"><a href="cap9.html#cb370-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-22"><a href="cap9.html#cb370-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Matriz final com variáveis preditoras</span></span>
<span id="cb370-23"><a href="cap9.html#cb370-23" aria-hidden="true" tabindex="-1"></a>env.pad.cat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(env.pad, <span class="at">altitude =</span> env<span class="sc">$</span>altitude)</span></code></pre></div>
<p>Depois de selecionar um subconjunto dos dados com o método Forward Selection e padronizá-los (média 0 e desvio padrão 1), o modelo da RDA é construído como modelos lineares (Figura <a href="cap9.html#fig:fig-rda">9.14</a>). A Ordenação Multi-Escala (MSO) também é ajustada para analisar a autocorrelação espacial.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="cap9.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="do">## RDA com dados selecionados e padronizados</span></span>
<span id="cb371-2"><a href="cap9.html#cb371-2" aria-hidden="true" tabindex="-1"></a>rda.bird <span class="ot">&lt;-</span> <span class="fu">rda</span>(species.hel <span class="sc">~</span> rain.jul <span class="sc">+</span> maxi.jul <span class="sc">+</span> altitude, <span class="at">data =</span> env.pad.cat)</span>
<span id="cb371-3"><a href="cap9.html#cb371-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-4"><a href="cap9.html#cb371-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Para interpretar, é necessário saber a significância dos eixos para</span></span>
<span id="cb371-5"><a href="cap9.html#cb371-5" aria-hidden="true" tabindex="-1"></a><span class="do">## representar a relação entre as variáveis preditoras e a composição de</span></span>
<span id="cb371-6"><a href="cap9.html#cb371-6" aria-hidden="true" tabindex="-1"></a><span class="do">## espécies</span></span>
<span id="cb371-7"><a href="cap9.html#cb371-7" aria-hidden="true" tabindex="-1"></a>res.axis <span class="ot">&lt;-</span> <span class="fu">anova.cca</span>(rda.bird, <span class="at">by =</span> <span class="st">&quot;axis&quot;</span>)</span>
<span id="cb371-8"><a href="cap9.html#cb371-8" aria-hidden="true" tabindex="-1"></a>res.axis</span>
<span id="cb371-9"><a href="cap9.html#cb371-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for rda under reduced model</span></span>
<span id="cb371-10"><a href="cap9.html#cb371-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Forward tests for axes</span></span>
<span id="cb371-11"><a href="cap9.html#cb371-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb371-12"><a href="cap9.html#cb371-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb371-13"><a href="cap9.html#cb371-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb371-14"><a href="cap9.html#cb371-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span></span>
<span id="cb371-15"><a href="cap9.html#cb371-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df Variance       F Pr(&gt;F)    </span></span>
<span id="cb371-16"><a href="cap9.html#cb371-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA1      1 0.045759 12.0225  0.001 ***</span></span>
<span id="cb371-17"><a href="cap9.html#cb371-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA2      1 0.009992  2.6252  0.061 .  </span></span>
<span id="cb371-18"><a href="cap9.html#cb371-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA3      1 0.007518  1.9752  0.136    </span></span>
<span id="cb371-19"><a href="cap9.html#cb371-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA4      1 0.003582  0.9410  0.470    </span></span>
<span id="cb371-20"><a href="cap9.html#cb371-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 18 0.068510                   </span></span>
<span id="cb371-21"><a href="cap9.html#cb371-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb371-22"><a href="cap9.html#cb371-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb371-23"><a href="cap9.html#cb371-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-24"><a href="cap9.html#cb371-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Em seguida, é possível identificar quais são as variáveis que contribuem ou</span></span>
<span id="cb371-25"><a href="cap9.html#cb371-25" aria-hidden="true" tabindex="-1"></a><span class="do">## que mais contribuem para a variação na composição de espécies</span></span>
<span id="cb371-26"><a href="cap9.html#cb371-26" aria-hidden="true" tabindex="-1"></a>res.var <span class="ot">&lt;-</span> <span class="fu">anova.cca</span>(rda.bird, <span class="at">by =</span> <span class="st">&quot;term&quot;</span>)  <span class="do">## Qual variável?</span></span>
<span id="cb371-27"><a href="cap9.html#cb371-27" aria-hidden="true" tabindex="-1"></a>res.var</span>
<span id="cb371-28"><a href="cap9.html#cb371-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for rda under reduced model</span></span>
<span id="cb371-29"><a href="cap9.html#cb371-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb371-30"><a href="cap9.html#cb371-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb371-31"><a href="cap9.html#cb371-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb371-32"><a href="cap9.html#cb371-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb371-33"><a href="cap9.html#cb371-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span></span>
<span id="cb371-34"><a href="cap9.html#cb371-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df Variance      F Pr(&gt;F)    </span></span>
<span id="cb371-35"><a href="cap9.html#cb371-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jul  1 0.036514 9.5936  0.001 ***</span></span>
<span id="cb371-36"><a href="cap9.html#cb371-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jul  1 0.011264 2.9596  0.016 *  </span></span>
<span id="cb371-37"><a href="cap9.html#cb371-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; altitude  2 0.019071 2.5053  0.011 *  </span></span>
<span id="cb371-38"><a href="cap9.html#cb371-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 18 0.068510                  </span></span>
<span id="cb371-39"><a href="cap9.html#cb371-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb371-40"><a href="cap9.html#cb371-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb371-41"><a href="cap9.html#cb371-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-42"><a href="cap9.html#cb371-42" aria-hidden="true" tabindex="-1"></a><span class="do">## Além disso, é possível obter o valor do R2 do modelo</span></span>
<span id="cb371-43"><a href="cap9.html#cb371-43" aria-hidden="true" tabindex="-1"></a>r_quadr <span class="ot">&lt;-</span> <span class="fu">RsquareAdj</span>(rda.bird)</span>
<span id="cb371-44"><a href="cap9.html#cb371-44" aria-hidden="true" tabindex="-1"></a>r_quadr</span>
<span id="cb371-45"><a href="cap9.html#cb371-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $r.squared</span></span>
<span id="cb371-46"><a href="cap9.html#cb371-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4938685</span></span>
<span id="cb371-47"><a href="cap9.html#cb371-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb371-48"><a href="cap9.html#cb371-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $adj.r.squared</span></span>
<span id="cb371-49"><a href="cap9.html#cb371-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3813949</span></span>
<span id="cb371-50"><a href="cap9.html#cb371-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-51"><a href="cap9.html#cb371-51" aria-hidden="true" tabindex="-1"></a><span class="do">## Ordenação multi-escala (MSO) para entender os resultados da ordenação em</span></span>
<span id="cb371-52"><a href="cap9.html#cb371-52" aria-hidden="true" tabindex="-1"></a><span class="do">## relação à distância geográfica</span></span>
<span id="cb371-53"><a href="cap9.html#cb371-53" aria-hidden="true" tabindex="-1"></a>bird.rda <span class="ot">&lt;-</span> <span class="fu">mso</span>(rda.bird, xy, <span class="at">grain =</span> <span class="dv">1</span>, <span class="at">permutations =</span> <span class="dv">99</span>)</span>
<span id="cb371-54"><a href="cap9.html#cb371-54" aria-hidden="true" tabindex="-1"></a><span class="fu">msoplot</span>(bird.rda)</span>
<span id="cb371-55"><a href="cap9.html#cb371-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error variance of regression model underestimated by -2.7 percent</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-rda"></span>
<img src="livro_files/figure-html/fig-rda-1.png" alt="Ordenação multi-escala (MSO) para entender os resultados da ordenação em relação à distância geográfica." width="100%" height="100%" />
<p class="caption">
Figura 9.14: Ordenação multi-escala (MSO) para entender os resultados da ordenação em relação à distância geográfica.
</p>
</div>
<p>Da mesma forma que nas ordenações irrestritas, podemos fazer um gráfico para visualizar as ordenações, mas agora esse gráfico é denominado “triplot,” pois possui os dados das duas ordenações (Figura <a href="cap9.html#fig:fig-rda-triplot">9.15</a>).</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="cap9.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Triplot da RDA</span></span>
<span id="cb372-2"><a href="cap9.html#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggord</span>(rda.bird, <span class="at">ptslab =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">addsize =</span> <span class="dv">3</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb372-3"><a href="cap9.html#cb372-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-rda-triplot"></span>
<img src="livro_files/figure-html/fig-rda-triplot-1.png" alt="Triplot da RDA." width="100%" height="100%" />
<p class="caption">
Figura 9.15: Triplot da RDA.
</p>
</div>
<p><strong>Interpretação dos resultados</strong></p>
<p>Os objetos <code>res.axis</code>, <code>res.var</code> e <code>r_quadr</code> mostram, respectivamente, i) as dimensões (RDA1, RDA2, etc.) que possuem variação na composição de espécies, ii) as variáveis preditoras que explicam esta variação, e iii) o valor do <em>R<sup>2</sup></em> ajustado. Neste exemplo, podemos observar que somente a dimensão 1 (RDA1) representa uma variação significativa da composição de espécies (<strong>P</strong> = 0,001). As variáveis <em>rain.jul</em>, <em>maxi.jul</em> e <em>altitude</em> foram todas preditoras importantes da composição de espécies, mas <em>rain.jul</em> se destacada com maior valor de <strong>F</strong>. Além disso, o valor do <em>R<sup>2</sup></em> ajustado de 0.381 indica forte contribuição dessas variáveis preditoras. Porém, uma das limitações desta análise é não considerar que tanto espécies quanto variáveis preditoras podem estar estruturadas espacialmente. Como resultado, os resíduos da análises podem apresentar autocorrelação espacial que, por sua vez, aumenta o Erro do Tipo I <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. A figura obtida com o código <code>msoplot(bird.rda)</code> demonstra que existe autocorrelação espacial em algumas distâncias da análise. Veja abaixo algumas alternativas para resíduos com autocorrelação espacial.</p>
</div>
<div id="análise-de-redundância-parcial-rdap" class="section level3" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> Análise de Redundância parcial (RDAp)</h3>
<p>Um dos problemas da abordagem anterior é que tanto a composição de espécies como as variáveis ambientais estão estruturadas espacialmente. Talvez mais importantes, para que os valores de probabilidade da RDA sejam interpretados corretamente (e para evitar Erro do Tipo I), os resíduos do modelo não devem estar correlacionados espacialmente, como demonstrado com a análise MSO. Uma alternativa é incluir a matriz de dados espaciais (matrix W) como valor condicional dentro da RDA. Esta análise é conhecida como RDA parcial.</p>
<p>Porém, a obtenção dos dados espaciais da matriz W é mais complexo do que simplesmente incluir dados de localização geográfica (latitude e longitude), como feito em alguns modelos lineares (e.g., <em>Generalized Least Squares</em> - GLS Capítulos <a href="cap7.html#cap7">7</a> e <a href="cap10.html#cap10">10</a>). Existem diversas ferramentas que descrevem e incorporam o componente espacial em métodos mulitidimensionais, mas os Mapas de Autovetores de Moran (MEM) são certamente os mais utilizados <span class="citation">(<a href="#ref-dray_community_2012" role="doc-biblioref">Dray et al., 2012</a>)</span>. A análise MEM consiste na ordenação (PCoA) de uma matriz truncada obtida através da localização geográfica das localidades utilizando distância euclidiana, matriz de conectividade e matriz espacial ponderada. Os autovalores obtidos no MEM são idênticos aos coeficientes de correlação espacial de Moran <em>I</em>. Um procedimento chave desta análise é a definição de um limiar de trucamento (do inglês <em>truncate threshold</em>). Este limiar é calculado a partir de uma “árvore de espaço mínimo” (<em>Minimum Spanning Tree</em> - MST) que conecta todos os pontos de coleta. Na prática, os valores menores do que o limiar definido pela MST indicam que os pontos com aqueles valores estão conectados e, assim possuem correlação positiva. Outro ponto importante desta análise é a obtenção da matriz espacial ponderada (<em>Spatial Weighting Matrix</em> - SWM). A seleção da matriz SWM é parte essencial do cálculo dos MEM e não deve ser feita arbitratiamente <span class="citation">(<a href="#ref-bauman_optimizing_2018" role="doc-biblioref">Bauman, Drouet, Fortin, et al., 2018</a>)</span>. Por este motivo, a análise recebe este nome <span class="citation">(<a href="#ref-legendre_numerical_2012" role="doc-biblioref">Legendre &amp; Legendre, 2012</a>)</span>. Finalmente, o método produz autovetores que representam preditores espaciais que podem ser utilizados na RDA parcial (e em outras análises). É importante ressaltar que o critério de seleção do número de autovetores é bastante debatido na literatura e, para isso, sugerimos a leitura dos seguintes artigos: <span class="citation"><a href="#ref-bauman_disentangling_2018" role="doc-biblioref">Bauman, Drouet, Dray, et al.</a> (<a href="#ref-bauman_disentangling_2018" role="doc-biblioref">2018</a>)</span>.</p>
<p>Então, o primeiro passo para realizar uma RDA parcial é de gerar os autovetores espaciais (MEMs).</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="cap9.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados Matriz padronizada de composição de espécies.</span></span>
<span id="cb373-2"><a href="cap9.html#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(species.hel)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb373-3"><a href="cap9.html#cb373-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Fauvette_orphee Fauvette_des_jardins Fauvette_a_tete_noire Fauvette_babillarde Fauvette_grisette</span></span>
<span id="cb373-4"><a href="cap9.html#cb373-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S01               0            0.3651484             0.3651484           0.2581989         0.2581989</span></span>
<span id="cb373-5"><a href="cap9.html#cb373-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S02               0            0.3333333             0.3333333           0.2357023         0.2357023</span></span>
<span id="cb373-6"><a href="cap9.html#cb373-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S03               0            0.3162278             0.3162278           0.3162278         0.2236068</span></span>
<span id="cb373-7"><a href="cap9.html#cb373-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S04               0            0.4200840             0.3429972           0.2425356         0.0000000</span></span>
<span id="cb373-8"><a href="cap9.html#cb373-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S05               0            0.3872983             0.3162278           0.2236068         0.3162278</span></span>
<span id="cb373-9"><a href="cap9.html#cb373-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S06               0            0.3779645             0.3779645           0.2672612         0.0000000</span></span>
<span id="cb373-10"><a href="cap9.html#cb373-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Fauvette_pitchou</span></span>
<span id="cb373-11"><a href="cap9.html#cb373-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S01                0</span></span>
<span id="cb373-12"><a href="cap9.html#cb373-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S02                0</span></span>
<span id="cb373-13"><a href="cap9.html#cb373-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S03                0</span></span>
<span id="cb373-14"><a href="cap9.html#cb373-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S04                0</span></span>
<span id="cb373-15"><a href="cap9.html#cb373-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S05                0</span></span>
<span id="cb373-16"><a href="cap9.html#cb373-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S06                0</span></span>
<span id="cb373-17"><a href="cap9.html#cb373-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-18"><a href="cap9.html#cb373-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Latitude e longitude</span></span>
<span id="cb373-19"><a href="cap9.html#cb373-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy)</span>
<span id="cb373-20"><a href="cap9.html#cb373-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       x   y</span></span>
<span id="cb373-21"><a href="cap9.html#cb373-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S01 156 252</span></span>
<span id="cb373-22"><a href="cap9.html#cb373-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S02 141 217</span></span>
<span id="cb373-23"><a href="cap9.html#cb373-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S03 171 233</span></span>
<span id="cb373-24"><a href="cap9.html#cb373-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S04 178 215</span></span>
<span id="cb373-25"><a href="cap9.html#cb373-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S05 123 189</span></span>
<span id="cb373-26"><a href="cap9.html#cb373-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S06 154 195</span></span>
<span id="cb373-27"><a href="cap9.html#cb373-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-28"><a href="cap9.html#cb373-28" aria-hidden="true" tabindex="-1"></a><span class="do">## dados ambientais padronizados e altitude</span></span>
<span id="cb373-29"><a href="cap9.html#cb373-29" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(env.pad.cat)</span>
<span id="cb373-30"><a href="cap9.html#cb373-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     rain.jul   maxi.jul      altitude</span></span>
<span id="cb373-31"><a href="cap9.html#cb373-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S01 1.333646  0.1462557    Montanhoso</span></span>
<span id="cb373-32"><a href="cap9.html#cb373-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S02 1.468827 -0.6848206 Intermediário</span></span>
<span id="cb373-33"><a href="cap9.html#cb373-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S03 1.505694 -0.2099199    Montanhoso</span></span>
<span id="cb373-34"><a href="cap9.html#cb373-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S04 1.296778 -2.0699476    Montanhoso</span></span>
<span id="cb373-35"><a href="cap9.html#cb373-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S05 1.075572 -0.3682201         Plano</span></span>
<span id="cb373-36"><a href="cap9.html#cb373-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S06 1.100151 -0.6056705 Intermediário</span></span>
<span id="cb373-37"><a href="cap9.html#cb373-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-38"><a href="cap9.html#cb373-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 1: Gerar um arquivo LIST W: list binária de vizinhança</span></span>
<span id="cb373-39"><a href="cap9.html#cb373-39" aria-hidden="true" tabindex="-1"></a>mat_knn <span class="ot">&lt;-</span> <span class="fu">knearneigh</span>(<span class="fu">as.matrix</span>(xy), <span class="at">k =</span> <span class="dv">2</span>, <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb373-40"><a href="cap9.html#cb373-40" aria-hidden="true" tabindex="-1"></a>mat_nb <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(mat_knn, <span class="at">sym =</span> <span class="cn">TRUE</span>)</span>
<span id="cb373-41"><a href="cap9.html#cb373-41" aria-hidden="true" tabindex="-1"></a>mat_listw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(mat_nb, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb373-42"><a href="cap9.html#cb373-42" aria-hidden="true" tabindex="-1"></a>mat_listw</span>
<span id="cb373-43"><a href="cap9.html#cb373-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Characteristics of weights list object:</span></span>
<span id="cb373-44"><a href="cap9.html#cb373-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Neighbour list object:</span></span>
<span id="cb373-45"><a href="cap9.html#cb373-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of regions: 23 </span></span>
<span id="cb373-46"><a href="cap9.html#cb373-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of nonzero links: 58 </span></span>
<span id="cb373-47"><a href="cap9.html#cb373-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Percentage nonzero weights: 10.96408 </span></span>
<span id="cb373-48"><a href="cap9.html#cb373-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Average number of links: 2.521739 </span></span>
<span id="cb373-49"><a href="cap9.html#cb373-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb373-50"><a href="cap9.html#cb373-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Weights style: W </span></span>
<span id="cb373-51"><a href="cap9.html#cb373-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Weights constants summary:</span></span>
<span id="cb373-52"><a href="cap9.html#cb373-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    n  nn S0       S1       S2</span></span>
<span id="cb373-53"><a href="cap9.html#cb373-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; W 23 529 23 18.84444 96.01111</span></span>
<span id="cb373-54"><a href="cap9.html#cb373-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-55"><a href="cap9.html#cb373-55" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 2: Listar os métodos &#39;candidatos&#39; para obter a matriz SWM</span></span>
<span id="cb373-56"><a href="cap9.html#cb373-56" aria-hidden="true" tabindex="-1"></a>MEM_mat <span class="ot">&lt;-</span> <span class="fu">scores.listw</span>(mat_listw, <span class="at">MEM.autocor =</span> <span class="st">&quot;positive&quot;</span>)</span>
<span id="cb373-57"><a href="cap9.html#cb373-57" aria-hidden="true" tabindex="-1"></a>candidates <span class="ot">&lt;-</span> <span class="fu">listw.candidates</span>(xy, <span class="at">nb =</span> <span class="fu">c</span>(<span class="st">&quot;gab&quot;</span>, <span class="st">&quot;mst&quot;</span>, <span class="st">&quot;dnear&quot;</span>), <span class="at">weights =</span> <span class="fu">c</span>(<span class="st">&quot;binary&quot;</span>,</span>
<span id="cb373-58"><a href="cap9.html#cb373-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;flin&quot;</span>))</span>
<span id="cb373-59"><a href="cap9.html#cb373-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-60"><a href="cap9.html#cb373-60" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 3: Selecionar a melhor matriz SWM e executar o MEM</span></span>
<span id="cb373-61"><a href="cap9.html#cb373-61" aria-hidden="true" tabindex="-1"></a>W_sel_mat <span class="ot">&lt;-</span> <span class="fu">listw.select</span>(species.hel, candidates, <span class="at">MEM.autocor =</span> <span class="st">&quot;positive&quot;</span>, <span class="at">p.adjust =</span> <span class="cn">TRUE</span>,</span>
<span id="cb373-62"><a href="cap9.html#cb373-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;FWD&quot;</span>)</span>
<span id="cb373-63"><a href="cap9.html#cb373-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 5 is 0.112000 (&gt; 0.050000)</span></span>
<span id="cb373-64"><a href="cap9.html#cb373-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 3 is 0.059000 (&gt; 0.050000)</span></span>
<span id="cb373-65"><a href="cap9.html#cb373-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 3 is 0.060000 (&gt; 0.050000)</span></span>
<span id="cb373-66"><a href="cap9.html#cb373-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 4 is 0.157000 (&gt; 0.050000)</span></span>
<span id="cb373-67"><a href="cap9.html#cb373-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-68"><a href="cap9.html#cb373-68" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 4: Matriz dos preditores espaciais escolhidos (MEMs)</span></span>
<span id="cb373-69"><a href="cap9.html#cb373-69" aria-hidden="true" tabindex="-1"></a>spatial.pred <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(W_sel_mat<span class="sc">$</span>best<span class="sc">$</span>MEM.select)</span>
<span id="cb373-70"><a href="cap9.html#cb373-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-71"><a href="cap9.html#cb373-71" aria-hidden="true" tabindex="-1"></a><span class="do">## É necessário atribuir os nomes das linhas</span></span>
<span id="cb373-72"><a href="cap9.html#cb373-72" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(spatial.pred) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(xy)</span></code></pre></div>
<p>Depois de gerar os valores dos autovetores espaciais (MEM), é possível executar a RDA parcial utilizando esses valores no argumento <code>Conditional</code>.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="cap9.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Combinar variáveis ambientais e espaciais em um único data.frame</span></span>
<span id="cb374-2"><a href="cap9.html#cb374-2" aria-hidden="true" tabindex="-1"></a>pred.vars <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(env.pad.cat, spatial.pred)</span>
<span id="cb374-3"><a href="cap9.html#cb374-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-4"><a href="cap9.html#cb374-4" aria-hidden="true" tabindex="-1"></a><span class="do">## RDA parcial</span></span>
<span id="cb374-5"><a href="cap9.html#cb374-5" aria-hidden="true" tabindex="-1"></a>rda.p <span class="ot">&lt;-</span> <span class="fu">rda</span>(species.hel <span class="sc">~</span></span>
<span id="cb374-6"><a href="cap9.html#cb374-6" aria-hidden="true" tabindex="-1"></a>                 rain.jul <span class="sc">+</span> maxi.jul <span class="sc">+</span> altitude <span class="sc">+</span> <span class="co"># Preditores ambientais</span></span>
<span id="cb374-7"><a href="cap9.html#cb374-7" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">Condition</span>(MEM1 <span class="sc">+</span> MEM2 <span class="sc">+</span> MEM4 <span class="sc">+</span> MEM5), <span class="co"># Preditores espaciais</span></span>
<span id="cb374-8"><a href="cap9.html#cb374-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> pred.vars)</span>
<span id="cb374-9"><a href="cap9.html#cb374-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-10"><a href="cap9.html#cb374-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Interpretação</span></span>
<span id="cb374-11"><a href="cap9.html#cb374-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Para interpretar, é necessário saber a significância dos eixos para representar a relação entre as variáveis preditoras e a composição de espécies.</span></span>
<span id="cb374-12"><a href="cap9.html#cb374-12" aria-hidden="true" tabindex="-1"></a>res.p.axis <span class="ot">&lt;-</span> <span class="fu">anova.cca</span>(rda.p, <span class="at">by =</span> <span class="st">&quot;axis&quot;</span>) </span>
<span id="cb374-13"><a href="cap9.html#cb374-13" aria-hidden="true" tabindex="-1"></a>res.p.axis</span>
<span id="cb374-14"><a href="cap9.html#cb374-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for rda under reduced model</span></span>
<span id="cb374-15"><a href="cap9.html#cb374-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Forward tests for axes</span></span>
<span id="cb374-16"><a href="cap9.html#cb374-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb374-17"><a href="cap9.html#cb374-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb374-18"><a href="cap9.html#cb374-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb374-19"><a href="cap9.html#cb374-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude + Condition(MEM1 + MEM2 + MEM4 + MEM5), data = pred.vars)</span></span>
<span id="cb374-20"><a href="cap9.html#cb374-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df Variance      F Pr(&gt;F)</span></span>
<span id="cb374-21"><a href="cap9.html#cb374-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA1      1 0.008471 2.1376  0.316</span></span>
<span id="cb374-22"><a href="cap9.html#cb374-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA2      1 0.004830 1.2189  0.779</span></span>
<span id="cb374-23"><a href="cap9.html#cb374-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA3      1 0.003240 0.8176  0.890</span></span>
<span id="cb374-24"><a href="cap9.html#cb374-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RDA4      1 0.001891 0.4773  0.895</span></span>
<span id="cb374-25"><a href="cap9.html#cb374-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 14 0.055477</span></span>
<span id="cb374-26"><a href="cap9.html#cb374-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-27"><a href="cap9.html#cb374-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Contribuição</span></span>
<span id="cb374-28"><a href="cap9.html#cb374-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Em seguida, é possível identificar quais são as variáveis que contribuem ou que mais contribuem para a variação na composição de espécies.</span></span>
<span id="cb374-29"><a href="cap9.html#cb374-29" aria-hidden="true" tabindex="-1"></a>res.p.var <span class="ot">&lt;-</span> <span class="fu">anova.cca</span>(rda.p, <span class="at">by =</span> <span class="st">&quot;term&quot;</span>) <span class="do">## Qual variável?</span></span>
<span id="cb374-30"><a href="cap9.html#cb374-30" aria-hidden="true" tabindex="-1"></a>res.p.var</span>
<span id="cb374-31"><a href="cap9.html#cb374-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for rda under reduced model</span></span>
<span id="cb374-32"><a href="cap9.html#cb374-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb374-33"><a href="cap9.html#cb374-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb374-34"><a href="cap9.html#cb374-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb374-35"><a href="cap9.html#cb374-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb374-36"><a href="cap9.html#cb374-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude + Condition(MEM1 + MEM2 + MEM4 + MEM5), data = pred.vars)</span></span>
<span id="cb374-37"><a href="cap9.html#cb374-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df Variance      F Pr(&gt;F)</span></span>
<span id="cb374-38"><a href="cap9.html#cb374-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jul  1 0.004406 1.1119  0.349</span></span>
<span id="cb374-39"><a href="cap9.html#cb374-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jul  1 0.004446 1.1220  0.338</span></span>
<span id="cb374-40"><a href="cap9.html#cb374-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; altitude  2 0.009579 1.2087  0.241</span></span>
<span id="cb374-41"><a href="cap9.html#cb374-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 14 0.055477</span></span>
<span id="cb374-42"><a href="cap9.html#cb374-42" aria-hidden="true" tabindex="-1"></a><span class="fu">RsquareAdj</span>(rda.p)</span>
<span id="cb374-43"><a href="cap9.html#cb374-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $r.squared</span></span>
<span id="cb374-44"><a href="cap9.html#cb374-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.1361661</span></span>
<span id="cb374-45"><a href="cap9.html#cb374-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb374-46"><a href="cap9.html#cb374-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $adj.r.squared</span></span>
<span id="cb374-47"><a href="cap9.html#cb374-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.02330319</span></span></code></pre></div>
<p>Se você comparar os resultados do objeto res.p.var (RDA parcial) com res.var (RDA simples) é possível perceber como a estrutura espacial nos resíduos aumenta a probabilidade de cometer Erro do Tipo I. O modelo da RDA parcial mostra que não existem qualquer efeito direto das variáveis ambientais sobre a composição de espécies (conclusão com a RDA simples). Na verdade, tanto a composição de espécies quanto as variáveis climáticas estão fortemente estruturadas no espaço, como demonstramos a seguir.</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="cap9.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Padrão espacial na composição de espécies</span></span>
<span id="cb375-2"><a href="cap9.html#cb375-2" aria-hidden="true" tabindex="-1"></a>pca.comp <span class="ot">&lt;-</span> <span class="fu">dudi.pca</span>(species.hel, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">scannf =</span> <span class="cn">FALSE</span>)</span>
<span id="cb375-3"><a href="cap9.html#cb375-3" aria-hidden="true" tabindex="-1"></a>moran.comp <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(pca.comp<span class="sc">$</span>li[, <span class="dv">1</span>], mat_listw, <span class="dv">999</span>)</span>
<span id="cb375-4"><a href="cap9.html#cb375-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5"><a href="cap9.html#cb375-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Padrão espacial das variáveis ambientais</span></span>
<span id="cb375-6"><a href="cap9.html#cb375-6" aria-hidden="true" tabindex="-1"></a>env<span class="sc">$</span>altitude <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(env<span class="sc">$</span>altitude)</span>
<span id="cb375-7"><a href="cap9.html#cb375-7" aria-hidden="true" tabindex="-1"></a>ca.env <span class="ot">&lt;-</span> <span class="fu">dudi.hillsmith</span>(env, <span class="at">scannf =</span> <span class="cn">FALSE</span>)</span>
<span id="cb375-8"><a href="cap9.html#cb375-8" aria-hidden="true" tabindex="-1"></a>moran.env <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(ca.env<span class="sc">$</span>li[, <span class="dv">1</span>], mat_listw, <span class="dv">999</span>)</span>
<span id="cb375-9"><a href="cap9.html#cb375-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10"><a href="cap9.html#cb375-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Estrutura espacial na composição de espécies?</span></span>
<span id="cb375-11"><a href="cap9.html#cb375-11" aria-hidden="true" tabindex="-1"></a>moran.comp</span>
<span id="cb375-12"><a href="cap9.html#cb375-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb375-13"><a href="cap9.html#cb375-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Monte-Carlo simulation of Moran I</span></span>
<span id="cb375-14"><a href="cap9.html#cb375-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb375-15"><a href="cap9.html#cb375-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  pca.comp$li[, 1] </span></span>
<span id="cb375-16"><a href="cap9.html#cb375-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; weights: mat_listw  </span></span>
<span id="cb375-17"><a href="cap9.html#cb375-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; number of simulations + 1: 1000 </span></span>
<span id="cb375-18"><a href="cap9.html#cb375-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb375-19"><a href="cap9.html#cb375-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; statistic = 0.62815, observed rank = 1000, p-value = 0.001</span></span>
<span id="cb375-20"><a href="cap9.html#cb375-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: greater</span></span>
<span id="cb375-21"><a href="cap9.html#cb375-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-22"><a href="cap9.html#cb375-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Estrutura espacial na variação ambiental?</span></span>
<span id="cb375-23"><a href="cap9.html#cb375-23" aria-hidden="true" tabindex="-1"></a>moran.env</span>
<span id="cb375-24"><a href="cap9.html#cb375-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb375-25"><a href="cap9.html#cb375-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Monte-Carlo simulation of Moran I</span></span>
<span id="cb375-26"><a href="cap9.html#cb375-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb375-27"><a href="cap9.html#cb375-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ca.env$li[, 1] </span></span>
<span id="cb375-28"><a href="cap9.html#cb375-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; weights: mat_listw  </span></span>
<span id="cb375-29"><a href="cap9.html#cb375-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; number of simulations + 1: 1000 </span></span>
<span id="cb375-30"><a href="cap9.html#cb375-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb375-31"><a href="cap9.html#cb375-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; statistic = 0.72714, observed rank = 1000, p-value = 0.001</span></span>
<span id="cb375-32"><a href="cap9.html#cb375-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: greater</span></span></code></pre></div>
<p>Como resultado, é possível que a variação ambiental espacialmente estruturada é o principal efeito sobre a composição de espécies. Uma maneira de visualizar a contribuição relativa de diferentes matrizes (ambiental e espacial, por exemplo) é utilizar o método de partição de variância. O resultado deste modelo indica que, de fato, não existe efeito direto das variáveis ambientais e sim do componente representado pela autocorrelação espacial dessas variáveis (Figura <a href="cap9.html#fig:fig-rda-parcial">9.16</a>).</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="cap9.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Triplot da RDA Partição de variância.</span></span>
<span id="cb376-2"><a href="cap9.html#cb376-2" aria-hidden="true" tabindex="-1"></a>pv.birds <span class="ot">&lt;-</span> <span class="fu">varpart</span>(species.hel, env.pad.cat, spatial.pred)</span>
<span id="cb376-3"><a href="cap9.html#cb376-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pv.birds)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-rda-parcial"></span>
<img src="livro_files/figure-html/fig-rda-parcial-1.png" alt="Diagrama de Venn mostrando a partição de variância da RDA." width="100%" height="100%" />
<p class="caption">
Figura 9.16: Diagrama de Venn mostrando a partição de variância da RDA.
</p>
</div>
</div>
<div id="análise-de-redundância-baseada-em-distância-db-rda" class="section level3" number="9.5.3">
<h3><span class="header-section-number">9.5.3</span> Análise de Redundância baseada em distância (db-RDA)</h3>
<p>Acima, apresentamos a análise RDA que permite comparar, por exemplo, se variáveis ambientais determinam a variação na composição de espécies. A RDA utiliza os dados brutos de composição de espécies e é baseada em uma PCA (i.e., requer distância euclidiana). Porém, em algumas situações é necessário utilizar outras medidas de distância tais como Bray-Curtis ou Gower. Esta analise é bastante útil também quando a matriz resposta já é uma matriz de distância, tais como as que são geradas por decomposição da diversidade beta. Neste caso, Legendre &amp; Anderson <span class="citation">(<a href="#ref-legendre_distance-based_1999" role="doc-biblioref">1999</a>)</span> propuseram a análise db-RDA (RDA baseada em distância). O primeiro passo da análise é gerar uma matriz de distância a partir da matriz bruta (e.g., composição de espécies). Depois, a técnica executa uma PCoA (corrigindo potenciais autovetores com autovalores negativos; ver discussão acima) para comparar com os termos do modelo (matriz <strong>X</strong>, como na RDA).
Para exemplificar como esta análise pode ser implementada no R, vamos usar o mesmo exemplo demontrado na análise RDA (ver acima). Porém, vamos fazer um ajuste sutil na pergunta “o clima e a altitude modificam a dissimilaridade (diversidade beta) de espécies de aves?” Veja que neste caso, estamos perguntando diretamente sobre uma medida de diversidade beta, que será calculada com o método Bray-Curtis. As variáveis preditoras serão as mesmas obtidas no exemplo da RDA: <code>env.pad.cat</code>.</p>
<p><strong>Análise</strong></p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="cap9.html#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 1: transformação de hellinger da matriz de espécies caso tenha dados</span></span>
<span id="cb377-2"><a href="cap9.html#cb377-2" aria-hidden="true" tabindex="-1"></a><span class="do">## de abundância.</span></span>
<span id="cb377-3"><a href="cap9.html#cb377-3" aria-hidden="true" tabindex="-1"></a>species.hel <span class="ot">&lt;-</span> <span class="fu">decostand</span>(species, <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb377-4"><a href="cap9.html#cb377-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-5"><a href="cap9.html#cb377-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 2: gerar matriz de distância (Diversidade beta: Bray-Curtis)</span></span>
<span id="cb377-6"><a href="cap9.html#cb377-6" aria-hidden="true" tabindex="-1"></a>dbeta <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(species.hel, <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb377-7"><a href="cap9.html#cb377-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-8"><a href="cap9.html#cb377-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Passo 2: dbRDA</span></span>
<span id="cb377-9"><a href="cap9.html#cb377-9" aria-hidden="true" tabindex="-1"></a>dbrda.bird <span class="ot">&lt;-</span> <span class="fu">capscale</span>(dbeta <span class="sc">~</span> rain.jul <span class="sc">+</span> maxi.jul <span class="sc">+</span> altitude, <span class="at">data =</span> env.pad.cat)</span>
<span id="cb377-10"><a href="cap9.html#cb377-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-11"><a href="cap9.html#cb377-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Para interpretar, é necessário saber a significância dos eixos para</span></span>
<span id="cb377-12"><a href="cap9.html#cb377-12" aria-hidden="true" tabindex="-1"></a><span class="co"># representar a relação entre as variáveis preditoras e a composição de</span></span>
<span id="cb377-13"><a href="cap9.html#cb377-13" aria-hidden="true" tabindex="-1"></a><span class="co"># espécies</span></span>
<span id="cb377-14"><a href="cap9.html#cb377-14" aria-hidden="true" tabindex="-1"></a>db.res.axis <span class="ot">&lt;-</span> <span class="fu">anova.cca</span>(dbrda.bird, <span class="at">by =</span> <span class="st">&quot;axis&quot;</span>)</span>
<span id="cb377-15"><a href="cap9.html#cb377-15" aria-hidden="true" tabindex="-1"></a>db.res.axis</span>
<span id="cb377-16"><a href="cap9.html#cb377-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for capscale under reduced model</span></span>
<span id="cb377-17"><a href="cap9.html#cb377-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Forward tests for axes</span></span>
<span id="cb377-18"><a href="cap9.html#cb377-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb377-19"><a href="cap9.html#cb377-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb377-20"><a href="cap9.html#cb377-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb377-21"><a href="cap9.html#cb377-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: capscale(formula = dbeta ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span></span>
<span id="cb377-22"><a href="cap9.html#cb377-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df SumOfSqs       F Pr(&gt;F)    </span></span>
<span id="cb377-23"><a href="cap9.html#cb377-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CAP1      1 0.274186 16.9355  0.001 ***</span></span>
<span id="cb377-24"><a href="cap9.html#cb377-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CAP2      1 0.044965  2.7773  0.110    </span></span>
<span id="cb377-25"><a href="cap9.html#cb377-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CAP3      1 0.018141  1.1205  0.656    </span></span>
<span id="cb377-26"><a href="cap9.html#cb377-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CAP4      1 0.009500  0.5868  0.788    </span></span>
<span id="cb377-27"><a href="cap9.html#cb377-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 18 0.291420                   </span></span>
<span id="cb377-28"><a href="cap9.html#cb377-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb377-29"><a href="cap9.html#cb377-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb377-30"><a href="cap9.html#cb377-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-31"><a href="cap9.html#cb377-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Em seguida, é possível identificar quais são as variáveis que contribuem ou</span></span>
<span id="cb377-32"><a href="cap9.html#cb377-32" aria-hidden="true" tabindex="-1"></a><span class="co"># que mais contribuem para a variação na composição de espécies</span></span>
<span id="cb377-33"><a href="cap9.html#cb377-33" aria-hidden="true" tabindex="-1"></a>db.res.var <span class="ot">&lt;-</span> <span class="fu">anova.cca</span>(rda.bird, <span class="at">by =</span> <span class="st">&quot;term&quot;</span>)  <span class="do">## Qual variável?</span></span>
<span id="cb377-34"><a href="cap9.html#cb377-34" aria-hidden="true" tabindex="-1"></a>db.res.var</span>
<span id="cb377-35"><a href="cap9.html#cb377-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for rda under reduced model</span></span>
<span id="cb377-36"><a href="cap9.html#cb377-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb377-37"><a href="cap9.html#cb377-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb377-38"><a href="cap9.html#cb377-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb377-39"><a href="cap9.html#cb377-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb377-40"><a href="cap9.html#cb377-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span></span>
<span id="cb377-41"><a href="cap9.html#cb377-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df Variance      F Pr(&gt;F)    </span></span>
<span id="cb377-42"><a href="cap9.html#cb377-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.jul  1 0.036514 9.5936  0.001 ***</span></span>
<span id="cb377-43"><a href="cap9.html#cb377-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; maxi.jul  1 0.011264 2.9596  0.015 *  </span></span>
<span id="cb377-44"><a href="cap9.html#cb377-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; altitude  2 0.019071 2.5053  0.011 *  </span></span>
<span id="cb377-45"><a href="cap9.html#cb377-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 18 0.068510                  </span></span>
<span id="cb377-46"><a href="cap9.html#cb377-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb377-47"><a href="cap9.html#cb377-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb377-48"><a href="cap9.html#cb377-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-49"><a href="cap9.html#cb377-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Além disso, é possível obter o valor do R2 do modelo</span></span>
<span id="cb377-50"><a href="cap9.html#cb377-50" aria-hidden="true" tabindex="-1"></a>db_r_quadr <span class="ot">&lt;-</span> <span class="fu">RsquareAdj</span>(dbrda.bird)</span>
<span id="cb377-51"><a href="cap9.html#cb377-51" aria-hidden="true" tabindex="-1"></a>db_r_quadr</span>
<span id="cb377-52"><a href="cap9.html#cb377-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $r.squared</span></span>
<span id="cb377-53"><a href="cap9.html#cb377-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.6116758</span></span>
<span id="cb377-54"><a href="cap9.html#cb377-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb377-55"><a href="cap9.html#cb377-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $adj.r.squared</span></span>
<span id="cb377-56"><a href="cap9.html#cb377-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.5253816</span></span></code></pre></div>
<p><strong>Interpretação dos resultados</strong></p>
<p>Assim como apresentado na RDA, os resultados obtidos em <code>db.res.var</code> sugerem que as variáveis <code>rain.jul</code>, <code>maxi.jul</code> e <code>altitude</code> afetam a diversidade beta de aves. O valor do <em>R<sup>2</sup></em> ajustado (0.495) sugere forte relação entre o gradiente ambiental e a diversidade beta. A comparação entre o valor do <code>db_r_quadr</code> e <code>r_quadr</code> indica que a db-RDA teve melhor ajuste para comparar o mesmo conjunto de dados.</p>
</div>
<div id="permanova" class="section level3" number="9.5.4">
<h3><span class="header-section-number">9.5.4</span> PERMANOVA</h3>
<p>A PERMANOVA é um acrônimo, em inglês, de <em>Permutational Multivariate Analysis of Variance</em>, análise proposta por Marti Anderson <span class="citation">(<a href="#ref-anderson_new_2001" role="doc-biblioref">M. J. Anderson, 2001</a>)</span>. A PERMANOVA é usada para testar hipóteses multivariadas que comparam a abundância de diferentes espécies em resposta a diferentes tratamentos ou gradientes ambientais. Essa análise foi desenvolvida como forma de solucionar algumas limitações da tradicional ANOVA multivariada (MANOVA). Em especial, o pressuposto da MANOVA de distribuição normal multivariada é raramente encontrado em dados ecológicos.</p>
<p>O primeiro passo da PERMANOVA é selecionar uma medida de distância apropriada aos dados e, além disso, verificar a necessidade de padronização ou transformação dos dados. Em seguida, as distâncias são comparadas entre os grupos de interesse (por exemplo, tratamento versus controle) usando a estatística <em>F</em> de maneira muito parecida com uma ANOVA (Capítulo <a href="cap7.html#cap7">7</a>), chamada de <em>pseudo-F</em>:</p>
<p><span class="math display">\[F_pseudo = (SSa / SSr)*[(N-g) / (g-1)]\]</span></p>
<p>Nessa equação</p>
<ul>
<li><em>SSa</em> representa a soma dos quadrados entre grupos</li>
<li><em>SSr</em> a soma de quadrados dentro do grupo (residual)</li>
<li><em>N</em> o número de unidades amostrais</li>
<li><em>g</em> os grupos (ou níveis da variável categórica)</li>
</ul>
<p>Esta fórmula do <em>pseudo-F</em> é específica para desenho experimental com um fator. Outros desenhos mais complexos são apresetandos em Anderson <span class="citation">(<a href="#ref-anderson_new_2001" role="doc-biblioref">2001</a>)</span>; <span class="citation">(<a href="#ref-anderson_permutational_2017" role="doc-biblioref">2017</a>)</span>. O cálculo do valor de probilidade é realizado por métodos de permutação que são discutidos em Anderson &amp; Ter Braak <span class="citation">(<a href="#ref-anderson_permutation_2003" role="doc-biblioref">2003</a>)</span>.</p>
<p><strong>Exemplo 1</strong></p>
<p>Espécies de aves que ocorrem em localidades com diferentes altitudes.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>O clima e a altitude modificam a composição de espécies de aves?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Diferenças climáticas (temperatura e chuva) e altitudinais alteram a composição de espécies de aves</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Preditoras: Temperatura e chuva (contínuas) e altitude (categórica com três níveis)</li>
<li>Dependente: composição de espécies de aves</li>
</ul>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="cap9.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Composição de espécies padronizar com método de Hellinger</span></span>
<span id="cb378-2"><a href="cap9.html#cb378-2" aria-hidden="true" tabindex="-1"></a>species.hel <span class="ot">&lt;-</span> <span class="fu">decostand</span>(<span class="at">x =</span> species, <span class="at">method =</span> <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb378-3"><a href="cap9.html#cb378-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-4"><a href="cap9.html#cb378-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Matriz de distância com método Bray-Curtis</span></span>
<span id="cb378-5"><a href="cap9.html#cb378-5" aria-hidden="true" tabindex="-1"></a>sps.dis <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="at">x =</span> species.hel, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
<p>Para reduzir o número de variáveis no modelo, você pode considerar duas abordangens. A primeira, e mais importante delas, é manter somente variáveis preditoras que você tenha razão biológica para mantê-la e, além disso, que esteja relacionada com suas hipóteses. Assim, uma vez que você já removeu variáveis que não possuem relevância biológica, você deve usar diferentes métodos para remover as variáveis muito correlacionadas (<em>forward selection</em>, <em>Variance Inflation Factor (VIF)</em>, entre outros). Neste exemplo, vamos simplesmente fazer uma correlação múltipla e remover as variáveis com correlação maior do que 0.9 ou -0.9. A função <code>ggpairs()</code> mostra um gráfico bem didático para representar a relação entre todas as variáveis e o valor (r) desta correlação (mais em Capítulo <a href="cap7.html#cap7">7</a>) (Figura <a href="cap9.html#fig:fig-permanova-prev">9.17</a>).</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="cap9.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Verifica correlação entre as variáveis</span></span>
<span id="cb379-2"><a href="cap9.html#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(env) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span>
<span id="cb379-3"><a href="cap9.html#cb379-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-4"><a href="cap9.html#cb379-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Após verificar a estrutura de correlação, vamos manter somente três</span></span>
<span id="cb379-5"><a href="cap9.html#cb379-5" aria-hidden="true" tabindex="-1"></a><span class="do">## variáveis</span></span>
<span id="cb379-6"><a href="cap9.html#cb379-6" aria-hidden="true" tabindex="-1"></a>env2 <span class="ot">&lt;-</span> env[, <span class="fu">c</span>(<span class="st">&quot;mini.jan&quot;</span>, <span class="st">&quot;rain.tot&quot;</span>, <span class="st">&quot;altitude&quot;</span>)]</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-permanova-prev"></span>
<img src="livro_files/figure-html/fig-permanova-prev-1.png" alt="Correlograma mostrando a correlação entre as variáveis." width="100%" height="100%" />
<p class="caption">
Figura 9.17: Correlograma mostrando a correlação entre as variáveis.
</p>
</div>
<p>Após selecionar as variáveis do modelo, vamos executar a PERMANOVA e entender as principais etapas para interpretar corretamente o teste. A função <code>adonis()</code> do pacote <code>vegan</code> é uma boa opção. Porém, é importante referir o programa PRIMER e PERMANOVA+ como ótima opção para implementar a PERMANOVA e ter maior controle em desenhos complexos <span class="citation">(<a href="#ref-anderson_permanova+_2008" role="doc-biblioref">M. J. Anderson et al., 2008</a>)</span>. Assim como nos modelos lineares apresentados no Capítulo <a href="cap7.html#cap7">7</a>, os argumento seguem o mesmo formato, com variável dependente separada por um “~” das variáveis preditoras. Porém, alguns autores demonstraram que a PERMANOVA (assim como Mantel e ANOSIM) não pode identificar se diferenças significativas do teste (usando a estatística <em>pseudo-F</em>) se devem a diferenças no posição, na dispersão ou ambos. Ou seja, ao comparar grupos não é possível identificar se existe mudanças de composição (posição) ou a variação da composição de espécies dentro de um grupo (dispersão) é maior do que a variação dentro do outro grupo <span class="citation">(<a href="#ref-anderson_permanova_2013" role="doc-biblioref">M. J. Anderson &amp; Walsh, 2013</a>)</span>. Para solucionar este problema, é possível combinar a PERMANOVA com a análise PERMDISP (ou BETADISPER, como chamado no pacote <code>vegan</code> implementado através da função <code>betadisper()</code>). Esta análise permite comparar se existe heterogeneidade nas variâncias entre grupos. Deste modo, com a presença de heterogeneidade de variâncias (valor do BETADISPER significativo), é possível saber que as diferenças entre os grupos ocorre principalmente por diferenças na dispersão e não, necessariamente, de posição. Mais detalhes sobre a relevância de combinar essas duas análises estão disponíveis em Anderson &amp; Walsh <span class="citation">(<a href="#ref-anderson_permanova_2013" role="doc-biblioref">2013</a>)</span>.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="cap9.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="do">## PERMANOVA</span></span>
<span id="cb380-2"><a href="cap9.html#cb380-2" aria-hidden="true" tabindex="-1"></a>perm.aves <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(sps.dis <span class="sc">~</span> mini.jan <span class="sc">+</span> rain.tot <span class="sc">+</span> altitude, <span class="at">data =</span> env2)</span>
<span id="cb380-3"><a href="cap9.html#cb380-3" aria-hidden="true" tabindex="-1"></a>perm.aves  <span class="do">### Diferenças entre os tratamentos?</span></span>
<span id="cb380-4"><a href="cap9.html#cb380-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for adonis under reduced model</span></span>
<span id="cb380-5"><a href="cap9.html#cb380-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb380-6"><a href="cap9.html#cb380-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb380-7"><a href="cap9.html#cb380-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb380-8"><a href="cap9.html#cb380-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb380-9"><a href="cap9.html#cb380-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; adonis2(formula = sps.dis ~ mini.jan + rain.tot + altitude, data = env2)</span></span>
<span id="cb380-10"><a href="cap9.html#cb380-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          Df SumOfSqs      R2      F Pr(&gt;F)    </span></span>
<span id="cb380-11"><a href="cap9.html#cb380-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mini.jan  1  0.09069 0.15997 6.3307  0.001 ***</span></span>
<span id="cb380-12"><a href="cap9.html#cb380-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rain.tot  1  0.12910 0.22771 9.0118  0.001 ***</span></span>
<span id="cb380-13"><a href="cap9.html#cb380-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; altitude  2  0.08929 0.15749 3.1163  0.011 *  </span></span>
<span id="cb380-14"><a href="cap9.html#cb380-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual 18  0.25787 0.45483                  </span></span>
<span id="cb380-15"><a href="cap9.html#cb380-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total    22  0.56695 1.00000                  </span></span>
<span id="cb380-16"><a href="cap9.html#cb380-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb380-17"><a href="cap9.html#cb380-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb380-18"><a href="cap9.html#cb380-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-19"><a href="cap9.html#cb380-19" aria-hidden="true" tabindex="-1"></a><span class="do">## BETADISPER</span></span>
<span id="cb380-20"><a href="cap9.html#cb380-20" aria-hidden="true" tabindex="-1"></a>betad.aves <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(sps.dis, env2<span class="sc">$</span>altitude)</span>
<span id="cb380-21"><a href="cap9.html#cb380-21" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betad.aves)</span>
<span id="cb380-22"><a href="cap9.html#cb380-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb380-23"><a href="cap9.html#cb380-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation test for homogeneity of multivariate dispersions</span></span>
<span id="cb380-24"><a href="cap9.html#cb380-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb380-25"><a href="cap9.html#cb380-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb380-26"><a href="cap9.html#cb380-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb380-27"><a href="cap9.html#cb380-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Response: Distances</span></span>
<span id="cb380-28"><a href="cap9.html#cb380-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Df    Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)</span></span>
<span id="cb380-29"><a href="cap9.html#cb380-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Groups     2 0.0042643 0.0021322 1.4672    999  0.265</span></span>
<span id="cb380-30"><a href="cap9.html#cb380-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals 20 0.0290636 0.0014532</span></span></code></pre></div>
<p>Em nosso exemplo, a temperatura, precipitação e altitude afetaram a variação na composição de espécies. Porém, para identificar se as diferenças de composição entre os níveis da variável altitude, é necessário interpretar os resultados da análise BETADISPER. O código <code>permutest(betad.aves)</code> mostra que o valor de probabilidade da análise foi de 0.253, ou seja, a hipótese nula de que a variância entre grupos é homogênea é aceita. Assim, não existe diferenças na dispersão entre grupos, sugerindo que a diferença encontrada na PERMANOVA (objeto <code>perm.aves</code>) se deve, em parte, à mudança na composição de espécies de aves entre diferentes altitudes (R<sup>2</sup> = 0.135). Além disso, a precipitação (R<sup>2</sup> = 0.183) e temperatura (R<sup>2</sup> = 0.127) foram fatores importantes na variação da composição de espécies.</p>
</div>
<div id="análise-de-escalonamento-não-métrico-nmds" class="section level3" number="9.5.5">
<h3><span class="header-section-number">9.5.5</span> Análise de Escalonamento não-Métrico (nMDS)</h3>
<p>Como falado anteriormente, as análises de ordenação irrestritas (PCA, PCoA, nMDS) são utilizadas para explorar dados. Uma maneira poderosa de usá-las é combinando com análises que testam hipóteses, como PERMANOVA e RDA (abaixo). A literatura ecológica tem usado a Análise de Escalonamento não-Métrico (<em>non-Metric Multidimensional Scaling</em> - nMDS) combinado com análises multidimensionais de variância (como a PERMANOVA) para visualização da similaridade na composição de espécies dentro e entre grupos. A seguir, implementamos o nMDS na matriz de composição de espécies de ácaros (Figura <a href="cap9.html#fig:fig-nmds">9.18</a>).</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="cap9.html#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Matriz de distância representando a variação na composição de espécies</span></span>
<span id="cb381-2"><a href="cap9.html#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="do">## (método Bray-Curtis)</span></span>
<span id="cb381-3"><a href="cap9.html#cb381-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(sps.dis)[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb381-4"><a href="cap9.html#cb381-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           S01        S02        S03       S04       S05       S06</span></span>
<span id="cb381-5"><a href="cap9.html#cb381-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S01 0.0000000 0.15133734 0.16720405 0.2559122 0.2559882 0.2588892</span></span>
<span id="cb381-6"><a href="cap9.html#cb381-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S02 0.1513373 0.00000000 0.04114702 0.1190172 0.1289682 0.1391056</span></span>
<span id="cb381-7"><a href="cap9.html#cb381-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S03 0.1672040 0.04114702 0.00000000 0.1420233 0.1358127 0.1410867</span></span>
<span id="cb381-8"><a href="cap9.html#cb381-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S04 0.2559122 0.11901720 0.14202325 0.0000000 0.1140283 0.1199803</span></span>
<span id="cb381-9"><a href="cap9.html#cb381-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S05 0.2559882 0.12896823 0.13581271 0.1140283 0.0000000 0.2129054</span></span>
<span id="cb381-10"><a href="cap9.html#cb381-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S06 0.2588892 0.13910558 0.14108668 0.1199803 0.2129054 0.0000000</span></span>
<span id="cb381-11"><a href="cap9.html#cb381-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-12"><a href="cap9.html#cb381-12" aria-hidden="true" tabindex="-1"></a><span class="do">## É preciso calcular uma primeira &#39;melhor&#39; solução do nMDS</span></span>
<span id="cb381-13"><a href="cap9.html#cb381-13" aria-hidden="true" tabindex="-1"></a>sol1 <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(sps.dis)</span>
<span id="cb381-14"><a href="cap9.html#cb381-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 0 stress 0.1344042 </span></span>
<span id="cb381-15"><a href="cap9.html#cb381-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 1 stress 0.3825954 </span></span>
<span id="cb381-16"><a href="cap9.html#cb381-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 2 stress 0.1272417 </span></span>
<span id="cb381-17"><a href="cap9.html#cb381-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... New best solution</span></span>
<span id="cb381-18"><a href="cap9.html#cb381-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 0.07890815  max resid 0.3526073 </span></span>
<span id="cb381-19"><a href="cap9.html#cb381-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 3 stress 0.1344042 </span></span>
<span id="cb381-20"><a href="cap9.html#cb381-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 4 stress 0.1338432 </span></span>
<span id="cb381-21"><a href="cap9.html#cb381-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 5 stress 0.1626783 </span></span>
<span id="cb381-22"><a href="cap9.html#cb381-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 6 stress 0.1336481 </span></span>
<span id="cb381-23"><a href="cap9.html#cb381-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 7 stress 0.1272417 </span></span>
<span id="cb381-24"><a href="cap9.html#cb381-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 6.723274e-06  max resid 1.889203e-05 </span></span>
<span id="cb381-25"><a href="cap9.html#cb381-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb381-26"><a href="cap9.html#cb381-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 8 stress 0.1338432 </span></span>
<span id="cb381-27"><a href="cap9.html#cb381-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 9 stress 0.1378506 </span></span>
<span id="cb381-28"><a href="cap9.html#cb381-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 10 stress 0.1272418 </span></span>
<span id="cb381-29"><a href="cap9.html#cb381-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 0.0001085155  max resid 0.0004162969 </span></span>
<span id="cb381-30"><a href="cap9.html#cb381-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb381-31"><a href="cap9.html#cb381-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 11 stress 0.1272418 </span></span>
<span id="cb381-32"><a href="cap9.html#cb381-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 4.197901e-05  max resid 0.000160606 </span></span>
<span id="cb381-33"><a href="cap9.html#cb381-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb381-34"><a href="cap9.html#cb381-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 12 stress 0.1378506 </span></span>
<span id="cb381-35"><a href="cap9.html#cb381-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 13 stress 0.1272418 </span></span>
<span id="cb381-36"><a href="cap9.html#cb381-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 5.310796e-05  max resid 0.0001988503 </span></span>
<span id="cb381-37"><a href="cap9.html#cb381-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb381-38"><a href="cap9.html#cb381-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 14 stress 0.1580523 </span></span>
<span id="cb381-39"><a href="cap9.html#cb381-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 15 stress 0.1344042 </span></span>
<span id="cb381-40"><a href="cap9.html#cb381-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 16 stress 0.1272418 </span></span>
<span id="cb381-41"><a href="cap9.html#cb381-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 2.586759e-05  max resid 9.827497e-05 </span></span>
<span id="cb381-42"><a href="cap9.html#cb381-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb381-43"><a href="cap9.html#cb381-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 17 stress 0.1584787 </span></span>
<span id="cb381-44"><a href="cap9.html#cb381-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 18 stress 0.1344042 </span></span>
<span id="cb381-45"><a href="cap9.html#cb381-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 19 stress 0.1344042 </span></span>
<span id="cb381-46"><a href="cap9.html#cb381-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 20 stress 0.1344042 </span></span>
<span id="cb381-47"><a href="cap9.html#cb381-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; *** Solution reached</span></span>
<span id="cb381-48"><a href="cap9.html#cb381-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-49"><a href="cap9.html#cb381-49" aria-hidden="true" tabindex="-1"></a><span class="do">## Melhor solução Depois, executar a mesma função, mas utilizando uma &#39;melhor</span></span>
<span id="cb381-50"><a href="cap9.html#cb381-50" aria-hidden="true" tabindex="-1"></a><span class="do">## solução inicial&#39; para evitar resultdos subótimos no nMDS .</span></span>
<span id="cb381-51"><a href="cap9.html#cb381-51" aria-hidden="true" tabindex="-1"></a>nmds.beta <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(sps.dis, <span class="at">previous.best =</span> sol1)</span>
<span id="cb381-52"><a href="cap9.html#cb381-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Starting from 2-dimensional configuration</span></span>
<span id="cb381-53"><a href="cap9.html#cb381-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 0 stress 0.1272417 </span></span>
<span id="cb381-54"><a href="cap9.html#cb381-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 1 stress 0.1272418 </span></span>
<span id="cb381-55"><a href="cap9.html#cb381-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 2.188819e-05  max resid 7.340362e-05 </span></span>
<span id="cb381-56"><a href="cap9.html#cb381-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb381-57"><a href="cap9.html#cb381-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 2 stress 0.1338432 </span></span>
<span id="cb381-58"><a href="cap9.html#cb381-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 3 stress 0.1584788 </span></span>
<span id="cb381-59"><a href="cap9.html#cb381-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 4 stress 0.1344043 </span></span>
<span id="cb381-60"><a href="cap9.html#cb381-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 5 stress 0.1338433 </span></span>
<span id="cb381-61"><a href="cap9.html#cb381-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 6 stress 0.1336481 </span></span>
<span id="cb381-62"><a href="cap9.html#cb381-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 7 stress 0.1344042 </span></span>
<span id="cb381-63"><a href="cap9.html#cb381-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 8 stress 0.1338432 </span></span>
<span id="cb381-64"><a href="cap9.html#cb381-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 9 stress 0.1272418 </span></span>
<span id="cb381-65"><a href="cap9.html#cb381-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 2.708248e-05  max resid 0.0001008894 </span></span>
<span id="cb381-66"><a href="cap9.html#cb381-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb381-67"><a href="cap9.html#cb381-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 10 stress 0.1336481 </span></span>
<span id="cb381-68"><a href="cap9.html#cb381-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 11 stress 0.1344042 </span></span>
<span id="cb381-69"><a href="cap9.html#cb381-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 12 stress 0.3798204 </span></span>
<span id="cb381-70"><a href="cap9.html#cb381-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 13 stress 0.1336481 </span></span>
<span id="cb381-71"><a href="cap9.html#cb381-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 14 stress 0.1336481 </span></span>
<span id="cb381-72"><a href="cap9.html#cb381-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 15 stress 0.1344042 </span></span>
<span id="cb381-73"><a href="cap9.html#cb381-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 16 stress 0.1336481 </span></span>
<span id="cb381-74"><a href="cap9.html#cb381-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 17 stress 0.1338432 </span></span>
<span id="cb381-75"><a href="cap9.html#cb381-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 18 stress 0.1272418 </span></span>
<span id="cb381-76"><a href="cap9.html#cb381-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Procrustes: rmse 2.303898e-05  max resid 8.758403e-05 </span></span>
<span id="cb381-77"><a href="cap9.html#cb381-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ... Similar to previous best</span></span>
<span id="cb381-78"><a href="cap9.html#cb381-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 19 stress 0.1344042 </span></span>
<span id="cb381-79"><a href="cap9.html#cb381-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Run 20 stress 0.1378506 </span></span>
<span id="cb381-80"><a href="cap9.html#cb381-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; *** Solution reached</span></span>
<span id="cb381-81"><a href="cap9.html#cb381-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-82"><a href="cap9.html#cb381-82" aria-hidden="true" tabindex="-1"></a><span class="do">## Stress O stress é o valor mais importante para interpretar a qualidade da</span></span>
<span id="cb381-83"><a href="cap9.html#cb381-83" aria-hidden="true" tabindex="-1"></a><span class="do">## ordenação.</span></span>
<span id="cb381-84"><a href="cap9.html#cb381-84" aria-hidden="true" tabindex="-1"></a>nmds.beta<span class="sc">$</span>stress  <span class="co"># valor ideal entre 0 e 0.2</span></span>
<span id="cb381-85"><a href="cap9.html#cb381-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.1272417</span></span>
<span id="cb381-86"><a href="cap9.html#cb381-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-87"><a href="cap9.html#cb381-87" aria-hidden="true" tabindex="-1"></a><span class="do">## Exportar os valores para fazer gráfico</span></span>
<span id="cb381-88"><a href="cap9.html#cb381-88" aria-hidden="true" tabindex="-1"></a>dat.graf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(vegan<span class="sc">::</span><span class="fu">scores</span>(nmds.beta), <span class="at">altitude =</span> env2<span class="sc">$</span>altitude)</span>
<span id="cb381-89"><a href="cap9.html#cb381-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-90"><a href="cap9.html#cb381-90" aria-hidden="true" tabindex="-1"></a><span class="do">## Definir os grupos (&#39;HULL&#39;) para serem categorizados no gráfico</span></span>
<span id="cb381-91"><a href="cap9.html#cb381-91" aria-hidden="true" tabindex="-1"></a>grp.mon <span class="ot">&lt;-</span> dat.graf[dat.graf<span class="sc">$</span>altitude <span class="sc">==</span> <span class="st">&quot;Montanhoso&quot;</span>, ][<span class="fu">chull</span>(dat.graf[dat.graf<span class="sc">$</span>altitude <span class="sc">==</span></span>
<span id="cb381-92"><a href="cap9.html#cb381-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Montanhoso&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;NMDS1&quot;</span>, <span class="st">&quot;NMDS2&quot;</span>)]), ]</span>
<span id="cb381-93"><a href="cap9.html#cb381-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-94"><a href="cap9.html#cb381-94" aria-hidden="true" tabindex="-1"></a>grp.int <span class="ot">&lt;-</span> dat.graf[dat.graf<span class="sc">$</span>altitude <span class="sc">==</span> <span class="st">&quot;Intermediário&quot;</span>, ][<span class="fu">chull</span>(dat.graf[dat.graf<span class="sc">$</span>altitude <span class="sc">==</span></span>
<span id="cb381-95"><a href="cap9.html#cb381-95" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Intermediário&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;NMDS1&quot;</span>, <span class="st">&quot;NMDS2&quot;</span>)]), ]</span>
<span id="cb381-96"><a href="cap9.html#cb381-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-97"><a href="cap9.html#cb381-97" aria-hidden="true" tabindex="-1"></a>grp.pla <span class="ot">&lt;-</span> dat.graf[dat.graf<span class="sc">$</span>altitude <span class="sc">==</span> <span class="st">&quot;Plano&quot;</span>, ][<span class="fu">chull</span>(dat.graf[dat.graf<span class="sc">$</span>altitude <span class="sc">==</span></span>
<span id="cb381-98"><a href="cap9.html#cb381-98" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Plano&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;NMDS1&quot;</span>, <span class="st">&quot;NMDS2&quot;</span>)]), ]</span>
<span id="cb381-99"><a href="cap9.html#cb381-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-100"><a href="cap9.html#cb381-100" aria-hidden="true" tabindex="-1"></a><span class="do">## Combinar dados dos grupos para cada Convex Hull</span></span>
<span id="cb381-101"><a href="cap9.html#cb381-101" aria-hidden="true" tabindex="-1"></a>hull.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(grp.mon, grp.int, grp.pla)</span>
<span id="cb381-102"><a href="cap9.html#cb381-102" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hull.data)</span>
<span id="cb381-103"><a href="cap9.html#cb381-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           NMDS1       NMDS2      altitude</span></span>
<span id="cb381-104"><a href="cap9.html#cb381-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S04 -0.10578586 -0.10682766    Montanhoso</span></span>
<span id="cb381-105"><a href="cap9.html#cb381-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S01 -0.25332406  0.04199004    Montanhoso</span></span>
<span id="cb381-106"><a href="cap9.html#cb381-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S11 -0.12504415  0.14477005    Montanhoso</span></span>
<span id="cb381-107"><a href="cap9.html#cb381-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S15  0.09166059  0.09857114    Montanhoso</span></span>
<span id="cb381-108"><a href="cap9.html#cb381-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S18  0.01968127 -0.12417579 Intermediário</span></span>
<span id="cb381-109"><a href="cap9.html#cb381-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; S06 -0.16053825 -0.08924030 Intermediário</span></span>
<span id="cb381-110"><a href="cap9.html#cb381-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-111"><a href="cap9.html#cb381-111" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb381-112"><a href="cap9.html#cb381-112" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat.graf, <span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2, <span class="at">color =</span> altitude, <span class="at">shape =</span> altitude)) <span class="sc">+</span></span>
<span id="cb381-113"><a href="cap9.html#cb381-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">geom_polygon</span>(<span class="at">data =</span> hull.data, <span class="fu">aes</span>(<span class="at">fill =</span> altitude,</span>
<span id="cb381-114"><a href="cap9.html#cb381-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> altitude), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb381-115"><a href="cap9.html#cb381-115" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;darkorchid&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;darkorchid&quot;</span>,</span>
<span id="cb381-116"><a href="cap9.html#cb381-116" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;NMDS1&quot;</span>, <span class="at">y =</span> <span class="st">&quot;NMDS2&quot;</span>) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-nmds"></span>
<img src="livro_files/figure-html/fig-nmds-1.png" alt="Biplot mostrando o resultado do nMDS." width="100%" height="100%" />
<p class="caption">
Figura 9.18: Biplot mostrando o resultado do nMDS.
</p>
</div>
</div>
</div>
<div id="mantel-e-mantel-parcial" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Mantel e Mantel parcial</h2>
<p>O teste de Mantel se aplica quando temos duas ou mais matrizes de distância (triangulares). Em estudos ecológicos, essas matrizes normalmente descrevem dados de distância ou (dis)similaridade na composição de espécies, distância geográfica, e similaridade ambiental. Mas este teste também é amplamente aplicado na área de genética de paisagem para testar hipóteses sobre como a composição genética de uma população varia em função do ambiente e/ou espaço geográfico <span class="citation">(<a href="#ref-legendre2010" role="doc-biblioref">LEGENDRE &amp; FORTIN, 2010</a>)</span>. O teste nada mais é do que uma generalização do coeficiente de correlação de Pearson (Capítulo <a href="cap7.html#cap7">7</a>) para lidar com matrizes de distância. Como essas matrizes descrevem a relação entre vários pares de locais, temos a repetição do mesmo local em outros pares. Neste caso é preciso um procedimento semelhante ao de correção para múltiplos testes.</p>
<p>Já o Mantel parcial pretende testar a correlação entre duas matrizes controlando para o efeito de uma terceira. Por exemplo, testar a associação entre a dissimilaridade na composição de espécies e dissimilaridade ambiental, controlando para a distância geográfica entre os locais. Isso nos permite levar em conta a possível autocorrelação espacial nas variáveis ambientais, ou seja, estaríamos testando de fato o efeito da dissimilaridade ambiental “pura” na dissimilaridae na composição de espécies, evitando o efeito do espaço em si. Portanto, note que sempre estamos raciocinando em termos de (dis)similaridade e não dos dados brutos em si, seja composição de espécies ou variáveis ambientais. É importante ter isto em mente na hora de interpretar os resultados.</p>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar um conjunto de dados que contém girinos de espécies de anfíbios anuros coletados em 14 poças d’água e os respectivos dados de variáveis ambientais destas mesmas poças <span class="citation">(<a href="#ref-provete_broad-scale_2014" role="doc-biblioref">Provete et al., 2014</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existe correlação entre a dissimilaridade na composição de espécies de girinos e a dissimilaridade ambiental?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Assumindo que processos baseados no nicho sejam predominantes, quanto mais diferentes as poças forem maior será a diferença na composição de espécies</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis: a matriz de distância (Bray-Curtis) da composição das espécies e outra matriz de distância (Euclideana) das variáveis ambientais</li>
</ul>
<p><strong>Análises</strong></p>
<p>Aqui vamos utilizar além do conjunto de dados <code>bocaina</code> já conhecido, outras duas matrizes disponíveis no pacote <code>ecodados</code>: <code>bocaina.xy</code> e <code>bocaina.env</code>, que contêm as coordenadas geográficas e variáveis ambientais das poças, respectivamente.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="cap9.html#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados</span></span>
<span id="cb382-2"><a href="cap9.html#cb382-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bocaina.env)</span>
<span id="cb382-3"><a href="cap9.html#cb382-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       pH  tur   DO  temp veg  dep canopy conduc hydro area</span></span>
<span id="cb382-4"><a href="cap9.html#cb382-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP3 7.07 0.66 2.26 18.93  30 0.35   30.3 0.0100   per  139</span></span>
<span id="cb382-5"><a href="cap9.html#cb382-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP4 6.85 0.33 2.78 20.53   0 0.33   32.1 0.0100   per  223</span></span>
<span id="cb382-6"><a href="cap9.html#cb382-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AP1 6.64 0.40 4.09 15.26   5 3.50   42.0 0.0105   per  681</span></span>
<span id="cb382-7"><a href="cap9.html#cb382-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AP2 6.13 0.80 3.47 15.40  70 2.50   82.0 0.0300   per  187</span></span>
<span id="cb382-8"><a href="cap9.html#cb382-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP1 5.80 0.75 3.22 16.75  70 0.70   91.4 0.0100   per   83</span></span>
<span id="cb382-9"><a href="cap9.html#cb382-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP2 5.32 4.00 2.10 15.90  95 0.27   75.3 0.0100   per  108</span></span>
<span id="cb382-10"><a href="cap9.html#cb382-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bocaina.xy)</span>
<span id="cb382-11"><a href="cap9.html#cb382-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Long      Lat</span></span>
<span id="cb382-12"><a href="cap9.html#cb382-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PT5 -44.6239 -22.7243</span></span>
<span id="cb382-13"><a href="cap9.html#cb382-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP3 -44.6340 -22.7228</span></span>
<span id="cb382-14"><a href="cap9.html#cb382-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PP4 -44.6334 -22.7228</span></span>
<span id="cb382-15"><a href="cap9.html#cb382-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BP4 -44.6212 -22.7262</span></span>
<span id="cb382-16"><a href="cap9.html#cb382-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BP2 -44.6155 -22.7289</span></span>
<span id="cb382-17"><a href="cap9.html#cb382-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PT1 -44.6170 -22.7350</span></span>
<span id="cb382-18"><a href="cap9.html#cb382-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-19"><a href="cap9.html#cb382-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Matriz de distância geográfica</span></span>
<span id="cb382-20"><a href="cap9.html#cb382-20" aria-hidden="true" tabindex="-1"></a>Dist.km <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="fu">rdist.earth</span>(bocaina.xy, <span class="at">miles =</span> F))  <span class="co"># matriz de distância geográfica (geodésica) considerando a curvatura da Terra</span></span>
<span id="cb382-21"><a href="cap9.html#cb382-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-22"><a href="cap9.html#cb382-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Padronizações</span></span>
<span id="cb382-23"><a href="cap9.html#cb382-23" aria-hidden="true" tabindex="-1"></a>comp.bo.pad <span class="ot">&lt;-</span> <span class="fu">decostand</span>(<span class="fu">t</span>(bocaina), <span class="st">&quot;hellinger&quot;</span>)</span>
<span id="cb382-24"><a href="cap9.html#cb382-24" aria-hidden="true" tabindex="-1"></a>env.bocaina <span class="ot">&lt;-</span> <span class="fu">decostand</span>(bocaina.env[, <span class="sc">-</span><span class="dv">9</span>], <span class="st">&quot;standardize&quot;</span>)</span>
<span id="cb382-25"><a href="cap9.html#cb382-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-26"><a href="cap9.html#cb382-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Similaridades</span></span>
<span id="cb382-27"><a href="cap9.html#cb382-27" aria-hidden="true" tabindex="-1"></a>simil.bocaina <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(comp.bo.pad, <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb382-28"><a href="cap9.html#cb382-28" aria-hidden="true" tabindex="-1"></a>simil.env <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(env.bocaina, <span class="st">&quot;euclidian&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="cap9.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mantel Espaço vs. ambiente</span></span>
<span id="cb383-2"><a href="cap9.html#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mantel</span>(Dist.km, simil.env)</span>
<span id="cb383-3"><a href="cap9.html#cb383-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-4"><a href="cap9.html#cb383-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mantel statistic based on Pearson&#39;s product-moment correlation </span></span>
<span id="cb383-5"><a href="cap9.html#cb383-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-6"><a href="cap9.html#cb383-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb383-7"><a href="cap9.html#cb383-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mantel(xdis = Dist.km, ydis = simil.env) </span></span>
<span id="cb383-8"><a href="cap9.html#cb383-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-9"><a href="cap9.html#cb383-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mantel statistic r: 0.4848 </span></span>
<span id="cb383-10"><a href="cap9.html#cb383-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Significance: 0.005 </span></span>
<span id="cb383-11"><a href="cap9.html#cb383-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-12"><a href="cap9.html#cb383-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Upper quantiles of permutations (null model):</span></span>
<span id="cb383-13"><a href="cap9.html#cb383-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   90%   95% 97.5%   99% </span></span>
<span id="cb383-14"><a href="cap9.html#cb383-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.250 0.330 0.393 0.447 </span></span>
<span id="cb383-15"><a href="cap9.html#cb383-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb383-16"><a href="cap9.html#cb383-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb383-17"><a href="cap9.html#cb383-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-18"><a href="cap9.html#cb383-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Espaço vs. composição</span></span>
<span id="cb383-19"><a href="cap9.html#cb383-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mantel</span>(Dist.km, simil.bocaina)</span>
<span id="cb383-20"><a href="cap9.html#cb383-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-21"><a href="cap9.html#cb383-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mantel statistic based on Pearson&#39;s product-moment correlation </span></span>
<span id="cb383-22"><a href="cap9.html#cb383-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-23"><a href="cap9.html#cb383-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb383-24"><a href="cap9.html#cb383-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mantel(xdis = Dist.km, ydis = simil.bocaina) </span></span>
<span id="cb383-25"><a href="cap9.html#cb383-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-26"><a href="cap9.html#cb383-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mantel statistic r: 0.3745 </span></span>
<span id="cb383-27"><a href="cap9.html#cb383-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Significance: 0.007 </span></span>
<span id="cb383-28"><a href="cap9.html#cb383-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-29"><a href="cap9.html#cb383-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Upper quantiles of permutations (null model):</span></span>
<span id="cb383-30"><a href="cap9.html#cb383-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   90%   95% 97.5%   99% </span></span>
<span id="cb383-31"><a href="cap9.html#cb383-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.149 0.215 0.279 0.335 </span></span>
<span id="cb383-32"><a href="cap9.html#cb383-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb383-33"><a href="cap9.html#cb383-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb383-34"><a href="cap9.html#cb383-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-35"><a href="cap9.html#cb383-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Ambiente vs. composição</span></span>
<span id="cb383-36"><a href="cap9.html#cb383-36" aria-hidden="true" tabindex="-1"></a><span class="fu">mantel</span>(simil.env, simil.bocaina)</span>
<span id="cb383-37"><a href="cap9.html#cb383-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-38"><a href="cap9.html#cb383-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mantel statistic based on Pearson&#39;s product-moment correlation </span></span>
<span id="cb383-39"><a href="cap9.html#cb383-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-40"><a href="cap9.html#cb383-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb383-41"><a href="cap9.html#cb383-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mantel(xdis = simil.env, ydis = simil.bocaina) </span></span>
<span id="cb383-42"><a href="cap9.html#cb383-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-43"><a href="cap9.html#cb383-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mantel statistic r: 0.2898 </span></span>
<span id="cb383-44"><a href="cap9.html#cb383-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Significance: 0.02 </span></span>
<span id="cb383-45"><a href="cap9.html#cb383-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb383-46"><a href="cap9.html#cb383-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Upper quantiles of permutations (null model):</span></span>
<span id="cb383-47"><a href="cap9.html#cb383-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   90%   95% 97.5%   99% </span></span>
<span id="cb383-48"><a href="cap9.html#cb383-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.171 0.227 0.266 0.322 </span></span>
<span id="cb383-49"><a href="cap9.html#cb383-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb383-50"><a href="cap9.html#cb383-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span></code></pre></div>
<p>Vamos agora fazer os gráficos relacionando as matrizes de similaridade dos dados (Figura <a href="cap9.html#fig:fig-mantel">9.19</a>).</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="cap9.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados</span></span>
<span id="cb384-2"><a href="cap9.html#cb384-2" aria-hidden="true" tabindex="-1"></a>matrix.bocaina.env <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">melt</span>(<span class="fu">as.matrix</span>(simil.bocaina))<span class="sc">$</span>value, <span class="at">y =</span> <span class="fu">melt</span>(<span class="fu">as.matrix</span>(simil.env))<span class="sc">$</span>value)</span>
<span id="cb384-3"><a href="cap9.html#cb384-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-4"><a href="cap9.html#cb384-4" aria-hidden="true" tabindex="-1"></a>matrix.dist.env <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">melt</span>(<span class="fu">as.matrix</span>(Dist.km))<span class="sc">$</span>value, <span class="at">y =</span> <span class="fu">melt</span>(<span class="fu">as.matrix</span>(simil.env))<span class="sc">$</span>value)</span>
<span id="cb384-5"><a href="cap9.html#cb384-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-6"><a href="cap9.html#cb384-6" aria-hidden="true" tabindex="-1"></a>matrix.dist.bocaina <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">melt</span>(<span class="fu">as.matrix</span>(<span class="fu">log</span>(Dist.km)))<span class="sc">$</span>value, <span class="at">y =</span> <span class="fu">melt</span>(<span class="fu">as.matrix</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span></span>
<span id="cb384-7"><a href="cap9.html#cb384-7" aria-hidden="true" tabindex="-1"></a>    simil.bocaina)))<span class="sc">$</span>value)</span>
<span id="cb384-8"><a href="cap9.html#cb384-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-9"><a href="cap9.html#cb384-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráficos</span></span>
<span id="cb384-10"><a href="cap9.html#cb384-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(matrix.bocaina.env, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Similaridade Bocaina&quot;</span>,</span>
<span id="cb384-11"><a href="cap9.html#cb384-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Similaridade Ambiental&quot;</span>) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span>
<span id="cb384-12"><a href="cap9.html#cb384-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-13"><a href="cap9.html#cb384-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(matrix.dist.env, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Distância geográfica (km)&quot;</span>,</span>
<span id="cb384-14"><a href="cap9.html#cb384-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Similaridade Ambiental&quot;</span>) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span>
<span id="cb384-15"><a href="cap9.html#cb384-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-16"><a href="cap9.html#cb384-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(matrix.dist.bocaina, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Distância geográfica (km)&quot;</span>,</span>
<span id="cb384-17"><a href="cap9.html#cb384-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Similaridade (Bray-Curtis)&quot;</span>) <span class="sc">+</span> <span class="fu">tema_livro</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mantel"></span>
<img src="livro_files/figure-html/fig-mantel-1.png" alt="Relação das matrizes de (dis)similaridade dos dados." width="100%" height="100%" /><img src="livro_files/figure-html/fig-mantel-2.png" alt="Relação das matrizes de (dis)similaridade dos dados." width="100%" height="100%" /><img src="livro_files/figure-html/fig-mantel-3.png" alt="Relação das matrizes de (dis)similaridade dos dados." width="100%" height="100%" />
<p class="caption">
Figura 9.19: Relação das matrizes de (dis)similaridade dos dados.
</p>
</div>
<p><strong>Interpretação dos resultados</strong></p>
<p>Os resultados mostraram que existe uma relação positiva, embora fraca, entre a dissimilaridade ambiental e a dissimilaridade na composição de espécies. Este resultado está de acordo com a nossa hipótese inicial. No entanto, vimos também que existe uma relação positiva e significativa entre a distância em linha reta entre as poças e a dissimilaridade ambiental. Logo, para de fato testar a relação entre o ambiente e a composição de espécies temos de levar em conta o espaço.</p>
<p>Para isto temos de realizar um teste de Mantel Parcial.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="cap9.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mantel Parcial</span></span>
<span id="cb385-2"><a href="cap9.html#cb385-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mantel.partial</span>(simil.bocaina, simil.env, Dist.km)  <span class="co">#comp. vs. ambiente controlando o espaço</span></span>
<span id="cb385-3"><a href="cap9.html#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb385-4"><a href="cap9.html#cb385-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Partial Mantel statistic based on Pearson&#39;s product-moment correlation </span></span>
<span id="cb385-5"><a href="cap9.html#cb385-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb385-6"><a href="cap9.html#cb385-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb385-7"><a href="cap9.html#cb385-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mantel.partial(xdis = simil.bocaina, ydis = simil.env, zdis = Dist.km) </span></span>
<span id="cb385-8"><a href="cap9.html#cb385-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb385-9"><a href="cap9.html#cb385-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mantel statistic r: 0.1334 </span></span>
<span id="cb385-10"><a href="cap9.html#cb385-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Significance: 0.123 </span></span>
<span id="cb385-11"><a href="cap9.html#cb385-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb385-12"><a href="cap9.html#cb385-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Upper quantiles of permutations (null model):</span></span>
<span id="cb385-13"><a href="cap9.html#cb385-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   90%   95% 97.5%   99% </span></span>
<span id="cb385-14"><a href="cap9.html#cb385-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.148 0.200 0.229 0.278 </span></span>
<span id="cb385-15"><a href="cap9.html#cb385-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb385-16"><a href="cap9.html#cb385-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span></code></pre></div>
<p>Agora sim, vimos que a relação entre ambiente e espécies se mantém, mas que a força dessa relação diminuiu bastante (veja o valor de r) quando controlamos o espaço.</p>
</div>
<div id="mantel-espacial-com-modelo-nulo-restrito-considerando-autocorrelação-espacial" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> Mantel espacial com modelo nulo restrito considerando autocorrelação espacial</h2>
<p>Embora seja um tipo de análise bastante popular, o Mantel e a sua versão parcial parecem não ser muito adequadas para lidar com autocorrelação espacial. Os autores dos artigos abaixo sugerem inclusive que esse tipo de análise não é adequado para testar a maioria das hipóteses em Ecologia, incluindo diversidade beta. Esse é um tema bastante discutido na literatura e não vamos nos alongar muito sobre isso, mas referimos o(a) leitor(a) para os seguintes artigos chave: <span class="citation">(<a href="#ref-legendre2015" role="doc-biblioref">Legendre et al., 2015</a>)</span>, <span class="citation">(<a href="#ref-legendre2010" role="doc-biblioref">LEGENDRE &amp; FORTIN, 2010</a>)</span>, <span class="citation">(<a href="#ref-legendre2000" role="doc-biblioref">Legendre, 2000</a>)</span>.</p>
<p>No entanto, recentemente um artigo (<span class="citation">(<a href="#ref-crabot2019" role="doc-biblioref">Crabot et al., 2019</a>)</span>) propos uma modificação no teste que leva em conta autocorrelação espacial ao gerar o modelo nulo usado para o teste de hipótese. É utilizado um procedimento chamado <em>Moran Spectral Randomization</em> porque preserva a autocorrelação global medida por meio do I de Moran global. A grande vantagem é que este teste utiliza toda a flexibilidade dos <em>Moran Eigenvector Maps</em> (MEMs), que é apresentado na parte de RDA, permitindo analisar relações entre as matrizes em múltiplas escalas espaciais. Vejamos como o teste funciona.</p>
<p>Primeiro precisamos construir um objeto com as duas matrizes que desejamos testar, no nosso caso composição de espécies e espaço. Depois precisamos construir explicitamente a nossa hipótese de relação espacial entre os locais por meio de uma rede de vizinhança. Esta rede é uma estrutura que nos dirá como (e eventualmente com qual intensidade) se há relação entre os locais. Aqui, entende-se que nos referimos à probabilidade de fluxo de indivíduos entre os locais.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="cap9.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mantel</span></span>
<span id="cb386-2"><a href="cap9.html#cb386-2" aria-hidden="true" tabindex="-1"></a>compos_espac <span class="ot">&lt;-</span> <span class="fu">mantel.randtest</span>(<span class="fu">sqrt</span>(simil.bocaina), Dist.km)</span>
<span id="cb386-3"><a href="cap9.html#cb386-3" aria-hidden="true" tabindex="-1"></a>compos_espac</span>
<span id="cb386-4"><a href="cap9.html#cb386-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Monte-Carlo test</span></span>
<span id="cb386-5"><a href="cap9.html#cb386-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call: mantel.randtest(m1 = sqrt(simil.bocaina), m2 = Dist.km)</span></span>
<span id="cb386-6"><a href="cap9.html#cb386-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb386-7"><a href="cap9.html#cb386-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Observation: 0.3738076 </span></span>
<span id="cb386-8"><a href="cap9.html#cb386-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb386-9"><a href="cap9.html#cb386-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Based on 999 replicates</span></span>
<span id="cb386-10"><a href="cap9.html#cb386-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simulated p-value: 0.005 </span></span>
<span id="cb386-11"><a href="cap9.html#cb386-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Alternative hypothesis: greater </span></span>
<span id="cb386-12"><a href="cap9.html#cb386-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb386-13"><a href="cap9.html#cb386-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Std.Obs Expectation    Variance </span></span>
<span id="cb386-14"><a href="cap9.html#cb386-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3.265589171 0.002421976 0.012933827</span></span></code></pre></div>
<p>Note que até aqui não há nada de novo, apenas utilizamos uma função diferente para realizar o teste de Mantel, agora no pacote <code>ade4</code> ao invés do <code>vegan</code>. Agora temos de construir a nossa rede de vizinhança. Optamos neste exemplo por uma rede bastante simples, que é a <em>Minimum Spanning Tree</em>. Essa é a rede espacial mínima que mantém todos os pontos ligados entre si (Figura <a href="cap9.html#fig:fig-mantel-espacial">9.20</a>).</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="cap9.html#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Minimum Spanning Tree</span></span>
<span id="cb387-2"><a href="cap9.html#cb387-2" aria-hidden="true" tabindex="-1"></a>nb.boc <span class="ot">&lt;-</span> <span class="fu">mst.nb</span>(Dist.km)  <span class="co"># calcula uma Minimum Spanning Tree</span></span>
<span id="cb387-3"><a href="cap9.html#cb387-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nb.boc, bocaina.xy)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mantel-espacial"></span>
<img src="livro_files/figure-html/fig-mantel-espacial-1.png" alt="Rede de vizinhança com a *Minimum Spanning Tree*" width="100%" height="100%" />
<p class="caption">
Figura 9.20: Rede de vizinhança com a <em>Minimum Spanning Tree</em>
</p>
</div>
<p>No gráfico, podemos ver a “cara” da rede. Cada ponto representa um local (poça) e as linhas representam a ligação hipótetica entre eles, plotamos no espaço geográfico, ou seja, o Norte aponta pra cima. Agora temos apenas que converter o formato <code>nb</code> para <code>listw</code> e finalmente entrar com esses objetos na função que realizará a análise.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="cap9.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Conversão</span></span>
<span id="cb388-2"><a href="cap9.html#cb388-2" aria-hidden="true" tabindex="-1"></a>lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb.boc)</span>
<span id="cb388-3"><a href="cap9.html#cb388-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-4"><a href="cap9.html#cb388-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Mantel espacial</span></span>
<span id="cb388-5"><a href="cap9.html#cb388-5" aria-hidden="true" tabindex="-1"></a><span class="fu">msr</span>(compos_espac, lw, <span class="at">method =</span> <span class="st">&quot;pair&quot;</span>)</span>
<span id="cb388-6"><a href="cap9.html#cb388-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Monte-Carlo test</span></span>
<span id="cb388-7"><a href="cap9.html#cb388-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call: msr.mantelrtest(x = compos_espac, listwORorthobasis = lw, method = &quot;pair&quot;)</span></span>
<span id="cb388-8"><a href="cap9.html#cb388-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb388-9"><a href="cap9.html#cb388-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Observation: 0.3738076 </span></span>
<span id="cb388-10"><a href="cap9.html#cb388-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb388-11"><a href="cap9.html#cb388-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Based on 999 replicates</span></span>
<span id="cb388-12"><a href="cap9.html#cb388-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simulated p-value: 0.127 </span></span>
<span id="cb388-13"><a href="cap9.html#cb388-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Alternative hypothesis: greater </span></span>
<span id="cb388-14"><a href="cap9.html#cb388-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb388-15"><a href="cap9.html#cb388-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Std.Obs Expectation    Variance </span></span>
<span id="cb388-16"><a href="cap9.html#cb388-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.21335033  0.17433665  0.02702631</span></span></code></pre></div>
<p><strong>Interpretação dos resultados</strong></p>
<p>Vamos comparar com o Mantel comum.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="cap9.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mantel comum</span></span>
<span id="cb389-2"><a href="cap9.html#cb389-2" aria-hidden="true" tabindex="-1"></a>compos_espac</span>
<span id="cb389-3"><a href="cap9.html#cb389-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Monte-Carlo test</span></span>
<span id="cb389-4"><a href="cap9.html#cb389-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call: mantel.randtest(m1 = sqrt(simil.bocaina), m2 = Dist.km)</span></span>
<span id="cb389-5"><a href="cap9.html#cb389-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb389-6"><a href="cap9.html#cb389-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Observation: 0.3738076 </span></span>
<span id="cb389-7"><a href="cap9.html#cb389-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb389-8"><a href="cap9.html#cb389-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Based on 999 replicates</span></span>
<span id="cb389-9"><a href="cap9.html#cb389-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simulated p-value: 0.005 </span></span>
<span id="cb389-10"><a href="cap9.html#cb389-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Alternative hypothesis: greater </span></span>
<span id="cb389-11"><a href="cap9.html#cb389-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb389-12"><a href="cap9.html#cb389-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Std.Obs Expectation    Variance </span></span>
<span id="cb389-13"><a href="cap9.html#cb389-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3.265589171 0.002421976 0.012933827</span></span></code></pre></div>
<p>Note que o valor da estatística do teste, ou seja, o r de Mantel é exatamente o mesmo. No entanto, o valor de <em>P</em> que indicava que o teste havia sido significativo anteriormente mudou e passou a ser não significativo. Isso ocorreu porque, embora a maneira de calcular a estatística do teste seja a mesma, a forma de construir a distribuição nula, a partir da qual será calculado o valor de <em>P</em> mudou drasticamente, resultando num teste não significativo.</p>
</div>
<div id="procrustes-e-protest" class="section level2" number="9.8">
<h2><span class="header-section-number">9.8</span> PROCRUSTES e PROTEST</h2>
<p>Uma alternativa ao Mantel para comparar o grau de associação entre conjuntos multidimensionais de dados (e.g., matriz de espécies e matriz ambiental) é a análise conhecida como Procrustes <span class="citation">(<a href="#ref-gower_statistical_1971" role="doc-biblioref">Gower, 1971</a>; <a href="#ref-jackson_protest_1995" role="doc-biblioref">Jackson, 1995</a>)</span>. Esta análise compara duas matrizes (objetos nas linhas e variáveis nas colunas) minimizando a soma dos desvios quadrados entre os valores através das seguintes técnicas: translação, escalonamento e rotação. É importante notar que os objetos devem ser os mesmos e, desse modo, o número de linhas é obrigatoriamente igual, ao passo que o número de colunas pode variar. A posição do objeto X<sub>i</sub> (i = 1, …n) é comparada com o objeto Y<sub>i</sub> da matriz correspondente, movimentando os pontos via translação, reflexão, rotação e dilatação. Assim, os objetos da matriz X resultam na matrix X’ que é representada pelo melhor ajuste (menor valor residual da soma dos quadrados: estatística m<sub>12</sub>) entre a matriz X e Y. A estatística m<sub>12</sub> mede, então, o grau de concordância entre as duas matrizes. Os valores de m<sub>12</sub> variam de 1 (sem concordância) a 0 (máxima concordância) <span class="citation"><a href="#ref-lisboa_much_2014" role="doc-biblioref">Lisboa et al.</a> (<a href="#ref-lisboa_much_2014" role="doc-biblioref">2014</a>)</span>. Para testar a significância do valor observado de m<sub>12</sub>, Jackson <span class="citation">(<a href="#ref-jackson_protest_1995" role="doc-biblioref">1995</a>)</span> sugeriu um teste de aleatorização chamado PROTEST.</p>
<p>As possibilidades de aplicação do Procrustes para ecologia são diversas. Dentre elas, se destacam a: i) morfometria geométrica e ii) ecologia de comunidades (concordância de comunidades). Uma característica interessante do Procrustes é a possibilidade de usar matriz bruta (e.g., variáveis ambientais) ou matriz de distância, o que amplia as possibilidades analíticas. Para comparações com matrizes brutas, análises de ordenação irrestrita (PCA, CA) devem ser realizadas antes do Procrustes. Por outro lado, para comparações com matrizes de distância (e.g., Euclidiana, Jaccard, Bray-Curtis), análises como PCoA e nMDS devem preceder à análise de Procrustes <span class="citation">(veja Figura 4 em <a href="#ref-peres-neto_how_2001" role="doc-biblioref">Peres-Neto &amp; Jackson, 2001</a>)</span>. Nos dois casos, a ordenação é importante para gerar matrizes com a mesma dimensionalidade o que, por sua vez, permite comparar matrizes com número de colunas diferentes.</p>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar dois conjuntos de dados simulados de peixes e macroinvertebrados aquáticos coletados em riachos. Neste exemplo hipotético, existe uma rede de 12 riachos com diferentes graus de poluição. Em cada riacho, foi produzida uma lista de espécies de peixes e de macroinvertebrados (com dados de abundância).</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existe concordância na distribuição na composição de espécies de peixes e macroinvertebrados?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Assumindo que alguns poluentes, tais como metais pesados, podem atuar como filtro ambiental e limitar a ocorrência de determinados organismos aquáticos, espera-se encontrar alta concordância entre as duas matrizes (peixes e macroinvertebrados). Ou seja, a comunidade tanto de peixes quanto de macroinvertebrados responderão de forma similar ao gradiente ambiental</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis: composição das espécies de peixes e macroinverebrados aquáticos</li>
</ul>
<p><strong>Análises</strong></p>
<p>No exemplo escolhido, as duas matrizes representam a composição de espécies em diferentes riachos. Desse modo, o ideal é transformar esta matriz bruta em matriz de distância com o método Bray-Curtis (<code>vegdist()</code>). O próximo passo, então, é realizar uma <code>Análise de Coordenadas Principais (PCoA)</code> (veja abaixo) para gerar duas matrizes de ordenação que serão comparadas com a função <code>procrustes()</code>. Por fim, utilizamos a função <code>protest()</code> para testar a significância da concordância entre as matrizes (Figura <a href="cap9.html#fig:fig-procrustes">9.21</a>).</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="cap9.html#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados</span></span>
<span id="cb390-2"><a href="cap9.html#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fish)</span>
<span id="cb390-3"><a href="cap9.html#cb390-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       sp1 sp2 sp3 sp4 sp5 sp6 sp7 sp8 sp9 sp10 sp11 sp12 sp13 sp14 sp15 sp16 sp17 sp18 sp19 sp20 sp21 sp22 sp23</span></span>
<span id="cb390-4"><a href="cap9.html#cb390-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site1   0   0   0   1   1   0   4   0   0    0    1    0    1    1    0    5    0    0    0    0    0    1    0</span></span>
<span id="cb390-5"><a href="cap9.html#cb390-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site2   0   0   0   1   0   1   5   0   2    1    1    2    1    0    0    1    0    0    0    0    0    0    1</span></span>
<span id="cb390-6"><a href="cap9.html#cb390-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site3   0   1   0   4   0   0   0   1   5    0    5    0    0    5    0    1    0    1    0    0    2    0    0</span></span>
<span id="cb390-7"><a href="cap9.html#cb390-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site4   0   5   0   1   0   1   0   0   2    0    0    0    0    2    1    0    0    0    0    1    1    0    0</span></span>
<span id="cb390-8"><a href="cap9.html#cb390-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site5   0   2   0   0   0   0   0   0   0    0    4    0    0    1    0    4    0    0    0    1    5    0    5</span></span>
<span id="cb390-9"><a href="cap9.html#cb390-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site6   0   2   1   0   0   0   0   1   1    0    0    2    0    2    0    0    0    0    0    0    0    0    4</span></span>
<span id="cb390-10"><a href="cap9.html#cb390-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       sp24</span></span>
<span id="cb390-11"><a href="cap9.html#cb390-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site1    3</span></span>
<span id="cb390-12"><a href="cap9.html#cb390-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site2    0</span></span>
<span id="cb390-13"><a href="cap9.html#cb390-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site3    0</span></span>
<span id="cb390-14"><a href="cap9.html#cb390-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site4    2</span></span>
<span id="cb390-15"><a href="cap9.html#cb390-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site5    0</span></span>
<span id="cb390-16"><a href="cap9.html#cb390-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site6    0</span></span>
<span id="cb390-17"><a href="cap9.html#cb390-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(macroinv)</span>
<span id="cb390-18"><a href="cap9.html#cb390-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       sp1 sp2 sp3 sp4 sp5 sp6 sp7 sp8 sp9 sp10 sp11 sp12 sp13 sp14 sp15 sp16 sp17 sp18 sp19 sp20 sp21 sp22 sp23</span></span>
<span id="cb390-19"><a href="cap9.html#cb390-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site1   0   1   1   0   0   0   0   0   0    1    2    0    0    0    0    1    1    0    4    0    0    0    1</span></span>
<span id="cb390-20"><a href="cap9.html#cb390-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site2   0   2   1   0   0   0   0   1   1    0    0    2    0    1    1    0    0    0    0    0    0    1    2</span></span>
<span id="cb390-21"><a href="cap9.html#cb390-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site3   0   0   0   1   0   1   5   0   2    1    1    2    0    4    0    1    0    0    1    0    0    0    0</span></span>
<span id="cb390-22"><a href="cap9.html#cb390-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site4   0   1   0   4   0   0   0   1   5    0    5    0    0    5    0    1    0    1    0    0    2    0    0</span></span>
<span id="cb390-23"><a href="cap9.html#cb390-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site5   0   2   0   0   0   0   0   0   0    0    4    0    0    2    1    0    0    0    0    1    1    0    0</span></span>
<span id="cb390-24"><a href="cap9.html#cb390-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site6   1   0   0   1   0   0   0   0   0    0    1    0    0    2    0    0    0    0    0    0    0    0    4</span></span>
<span id="cb390-25"><a href="cap9.html#cb390-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       sp24 sp25 sp26 sp27 sp28 sp29 sp30 sp31 sp32 sp33 sp34 sp35 sp36</span></span>
<span id="cb390-26"><a href="cap9.html#cb390-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site1    0    0    1    0    4    0    0    0    1    5    0    5    0</span></span>
<span id="cb390-27"><a href="cap9.html#cb390-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site2    0    1    0    1    1    0    0    1    0    0    1    0    0</span></span>
<span id="cb390-28"><a href="cap9.html#cb390-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site3    1    0    2    1    0    0    0    0    1    1    0    0    2</span></span>
<span id="cb390-29"><a href="cap9.html#cb390-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site4    0    0    2    1    0    0    0    0    0    0    5    1    0</span></span>
<span id="cb390-30"><a href="cap9.html#cb390-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site5    2    0    5    0    1    0    1    0    0    2    0    0    0</span></span>
<span id="cb390-31"><a href="cap9.html#cb390-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; site6    0    0    2    0    0    0    0    0    0    0    0    4    0</span></span>
<span id="cb390-32"><a href="cap9.html#cb390-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-33"><a href="cap9.html#cb390-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Fixar a amostragem</span></span>
<span id="cb390-34"><a href="cap9.html#cb390-34" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb390-35"><a href="cap9.html#cb390-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-36"><a href="cap9.html#cb390-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrizes de distância de PCoA</span></span>
<span id="cb390-37"><a href="cap9.html#cb390-37" aria-hidden="true" tabindex="-1"></a>d_macro <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(macroinv, <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb390-38"><a href="cap9.html#cb390-38" aria-hidden="true" tabindex="-1"></a>pcoa_macro <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(d_macro)</span>
<span id="cb390-39"><a href="cap9.html#cb390-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-40"><a href="cap9.html#cb390-40" aria-hidden="true" tabindex="-1"></a>d_fish <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(fish, <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb390-41"><a href="cap9.html#cb390-41" aria-hidden="true" tabindex="-1"></a>pcoa_fish <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(d_fish)</span>
<span id="cb390-42"><a href="cap9.html#cb390-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-43"><a href="cap9.html#cb390-43" aria-hidden="true" tabindex="-1"></a><span class="do">## PROCRUSTES</span></span>
<span id="cb390-44"><a href="cap9.html#cb390-44" aria-hidden="true" tabindex="-1"></a>concord <span class="ot">&lt;-</span> <span class="fu">procrustes</span>(pcoa_macro, pcoa_fish)</span>
<span id="cb390-45"><a href="cap9.html#cb390-45" aria-hidden="true" tabindex="-1"></a><span class="fu">protest</span>(pcoa_macro, pcoa_fish)</span>
<span id="cb390-46"><a href="cap9.html#cb390-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb390-47"><a href="cap9.html#cb390-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb390-48"><a href="cap9.html#cb390-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; protest(X = pcoa_macro, Y = pcoa_fish) </span></span>
<span id="cb390-49"><a href="cap9.html#cb390-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb390-50"><a href="cap9.html#cb390-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Procrustes Sum of Squares (m12 squared):        0.6185 </span></span>
<span id="cb390-51"><a href="cap9.html#cb390-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation in a symmetric Procrustes rotation: 0.6176 </span></span>
<span id="cb390-52"><a href="cap9.html#cb390-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Significance:  0.019 </span></span>
<span id="cb390-53"><a href="cap9.html#cb390-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb390-54"><a href="cap9.html#cb390-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Permutation: free</span></span>
<span id="cb390-55"><a href="cap9.html#cb390-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of permutations: 999</span></span>
<span id="cb390-56"><a href="cap9.html#cb390-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-57"><a href="cap9.html#cb390-57" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb390-58"><a href="cap9.html#cb390-58" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(concord)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-procrustes"></span>
<img src="livro_files/figure-html/fig-procrustes-1.png" alt="Biplot mostrando o resultado da análise de PROCRUSTES." width="100%" height="100%" />
<p class="caption">
Figura 9.21: Biplot mostrando o resultado da análise de PROCRUSTES.
</p>
</div>
<p><strong>Interpretação dos resultados</strong></p>
<p>A função <code>protest()</code> apresenta dois resultados importantes: i) a estatística m<sub>12</sub> e ii) o valor de significância (p). No exemplo, o valor de m<sub>12</sub> é igual a <code>0.6185</code> e o valor de p é <code>0,019</code>. Desse modo, podemos concluir que existe concordância entre a composição de espécies de peixes e macroinvertebrados aquáticos, sugerindo que o nível de poluição pode gerar padrões previsíveis de distribuição de diferentes organismos aquáticos. A figura produzida pelo código <code>plot(concord)</code> mostra um gráfico típico do Procrustes, onde a base da seta representa a matriz <strong>X</strong> e a ponta da seta a matriz alvo (<strong>Y</strong>) após a rotação para comparar o grau de concordância entre <strong>X</strong> e <strong>Y</strong>. Cada ponto representa um objeto (linha) das matrizes <strong>X</strong> e <strong>Y</strong>. Quanto menor for o tamanho das setas, mais concordantes são as observações em cada objeto.</p>
</div>
<div id="métodos-multivariados-baseados-em-modelos" class="section level2" number="9.9">
<h2><span class="header-section-number">9.9</span> Métodos multivariados baseados em modelos</h2>
<p>Mais recentemente, alguns autores têm proposto métodos multivariados baseados em modelos. Estes métodos têm se diversificado hoje em dia e existem pacotes que realizam praticamente todas as análises que vimos acima, com a diferença que utilizam distribuições de probabilidade dado um modelo (e.g., Poisson) ao invés de coeficientes de dissimilaridades. Vamos exemplificar o uso de um desses métodos, mas não vamos fazer uma revisão extensiva. Caso o(a) leitor(a) deseje conhecer mais, recomendamos consultar principalmente os pacotes <code>gllvm</code>, <code>ecoCopula</code> e <code>Hmsc</code>.</p>
<p>Um dos primeiros métodos foi proposto em 2012 pelo grupo de David Warton <span class="citation">(<a href="#ref-warton2012" role="doc-biblioref">Warton et al., 2012</a>)</span>, implementado no pacote <code>mvabund</code>. Anteriormente neste mesmo ano foi publicado um artigo pelo mesmo grupo <span class="citation">(<a href="#ref-wang2012" role="doc-biblioref">Wang et al., 2012</a>)</span> em que os autores demonstraram que métodos baseados em dissimilaridade, especialmente PERMANOVA, não conseguem modelar adequadamente dados multivariados de contagem (e.g., abundância) por não levarem em conta a relação monotônica entre média e variância. Vejamos o que isso quer dizer utilizando os dados do artigo de <span class="citation">(<a href="#ref-dasilva2017" role="doc-biblioref">2017</a>)</span> (Figura <a href="cap9.html#fig:fig-media-var">9.22</a>).</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="cap9.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Dados</span></span>
<span id="cb391-2"><a href="cap9.html#cb391-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(anuros_permanova)</span>
<span id="cb391-3"><a href="cap9.html#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   Chiasmocleis_albopunctata Dendropsophus_elianae Dendropsophus_jimi Dendropsophus_nanus</span></span>
<span id="cb391-4"><a href="cap9.html#cb391-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Araras                                    6                     0                  0                   0</span></span>
<span id="cb391-5"><a href="cap9.html#cb391-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Artur Nogueira                            0                     0                  0                   0</span></span>
<span id="cb391-6"><a href="cap9.html#cb391-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conchal                                   0                     0                  0                   0</span></span>
<span id="cb391-7"><a href="cap9.html#cb391-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Engenheiro Coelho                         1                     0                  0                   0</span></span>
<span id="cb391-8"><a href="cap9.html#cb391-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Jaguari\xfana                             8                     0                  0                   0</span></span>
<span id="cb391-9"><a href="cap9.html#cb391-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Limeira                                   0                    11                 15                   0</span></span>
<span id="cb391-10"><a href="cap9.html#cb391-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   Dendropsophus_minutus Dendropsophus_sanborni Elachistocleis_cesari Hypsiboas_albopunctatus</span></span>
<span id="cb391-11"><a href="cap9.html#cb391-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Araras                                1                      0                     1                       0</span></span>
<span id="cb391-12"><a href="cap9.html#cb391-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Artur Nogueira                        6                      0                     2                      26</span></span>
<span id="cb391-13"><a href="cap9.html#cb391-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conchal                               0                      0                     0                       0</span></span>
<span id="cb391-14"><a href="cap9.html#cb391-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Engenheiro Coelho                     2                      0                     0                       0</span></span>
<span id="cb391-15"><a href="cap9.html#cb391-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Jaguari\xfana                         0                      0                     0                       0</span></span>
<span id="cb391-16"><a href="cap9.html#cb391-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Limeira                              15                      0                     0                      10</span></span>
<span id="cb391-17"><a href="cap9.html#cb391-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   Hypsiboas_faber Hypsiboas_lundii Hypsiboas_prasinus Itapotihyla_langsdorffii</span></span>
<span id="cb391-18"><a href="cap9.html#cb391-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Araras                          0                0                  0                        0</span></span>
<span id="cb391-19"><a href="cap9.html#cb391-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Artur Nogueira                  0                0                  0                       13</span></span>
<span id="cb391-20"><a href="cap9.html#cb391-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conchal                         0                0                  0                        0</span></span>
<span id="cb391-21"><a href="cap9.html#cb391-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Engenheiro Coelho               0                2                  0                        0</span></span>
<span id="cb391-22"><a href="cap9.html#cb391-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Jaguari\xfana                   0                0                  0                        0</span></span>
<span id="cb391-23"><a href="cap9.html#cb391-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Limeira                         3                0                  3                        0</span></span>
<span id="cb391-24"><a href="cap9.html#cb391-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   Leptodactylus_fuscus Leptodactylus_latrans Leptodactylus_mystaceus Leptodactylus_mystacinus</span></span>
<span id="cb391-25"><a href="cap9.html#cb391-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Araras                              32                     1                      27                       48</span></span>
<span id="cb391-26"><a href="cap9.html#cb391-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Artur Nogueira                      15                     0                       1                        1</span></span>
<span id="cb391-27"><a href="cap9.html#cb391-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conchal                              0                     0                       0                        3</span></span>
<span id="cb391-28"><a href="cap9.html#cb391-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Engenheiro Coelho                   33                     0                       0                        4</span></span>
<span id="cb391-29"><a href="cap9.html#cb391-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Jaguari\xfana                        0                     0                       0                       42</span></span>
<span id="cb391-30"><a href="cap9.html#cb391-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Limeira                             31                     0                       0                       16</span></span>
<span id="cb391-31"><a href="cap9.html#cb391-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   Physalaemus_centralis Physalaemus_cuvieri Physalaemus_marmoratus Physalaemus_nattereri</span></span>
<span id="cb391-32"><a href="cap9.html#cb391-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Araras                                0                  13                      0                     5</span></span>
<span id="cb391-33"><a href="cap9.html#cb391-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Artur Nogueira                        0                  19                      0                    22</span></span>
<span id="cb391-34"><a href="cap9.html#cb391-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conchal                               0                   3                      0                     5</span></span>
<span id="cb391-35"><a href="cap9.html#cb391-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Engenheiro Coelho                     0                   2                      1                    16</span></span>
<span id="cb391-36"><a href="cap9.html#cb391-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Jaguari\xfana                         0                  28                      0                    19</span></span>
<span id="cb391-37"><a href="cap9.html#cb391-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Limeira                               0                  24                      1                    18</span></span>
<span id="cb391-38"><a href="cap9.html#cb391-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   Pseudis_paradoxa Rhinella_ornata Rhinella_schneideri Scinax_fuscomarginatus Scinax_fuscovarius</span></span>
<span id="cb391-39"><a href="cap9.html#cb391-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Araras                           0               4                   4                      0                 13</span></span>
<span id="cb391-40"><a href="cap9.html#cb391-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Artur Nogueira                   0              23                   0                      0                 11</span></span>
<span id="cb391-41"><a href="cap9.html#cb391-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conchal                          0               1                   1                      0                  0</span></span>
<span id="cb391-42"><a href="cap9.html#cb391-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Engenheiro Coelho                0              15                   0                      0                 11</span></span>
<span id="cb391-43"><a href="cap9.html#cb391-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Jaguari\xfana                    0               8                   0                      0                  0</span></span>
<span id="cb391-44"><a href="cap9.html#cb391-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Limeira                          0              21                   5                      0                  1</span></span>
<span id="cb391-45"><a href="cap9.html#cb391-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   Scinax_similis Trachycephalus_typhonius GRUPOS</span></span>
<span id="cb391-46"><a href="cap9.html#cb391-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Araras                         0                        1  CAMPO</span></span>
<span id="cb391-47"><a href="cap9.html#cb391-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Artur Nogueira                 0                        0  CAMPO</span></span>
<span id="cb391-48"><a href="cap9.html#cb391-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conchal                        0                        0  CAMPO</span></span>
<span id="cb391-49"><a href="cap9.html#cb391-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Engenheiro Coelho              0                        0  CAMPO</span></span>
<span id="cb391-50"><a href="cap9.html#cb391-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Jaguari\xfana                  0                        0  CAMPO</span></span>
<span id="cb391-51"><a href="cap9.html#cb391-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Limeira                        0                        1  CAMPO</span></span>
<span id="cb391-52"><a href="cap9.html#cb391-52" aria-hidden="true" tabindex="-1"></a>anuros_abund <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(anuros_permanova[, <span class="sc">-</span><span class="dv">28</span>])</span>
<span id="cb391-53"><a href="cap9.html#cb391-53" aria-hidden="true" tabindex="-1"></a>grupos <span class="ot">&lt;-</span> <span class="fu">factor</span>(anuros_permanova[, <span class="dv">28</span>])</span>
<span id="cb391-54"><a href="cap9.html#cb391-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-55"><a href="cap9.html#cb391-55" aria-hidden="true" tabindex="-1"></a><span class="do">## Média-variância</span></span>
<span id="cb391-56"><a href="cap9.html#cb391-56" aria-hidden="true" tabindex="-1"></a>abund_tr <span class="ot">&lt;-</span> <span class="fu">mvabund</span>(anuros_abund)  <span class="co"># criando um objeto da classe mvabund com os dados de abundância</span></span>
<span id="cb391-57"><a href="cap9.html#cb391-57" aria-hidden="true" tabindex="-1"></a><span class="fu">meanvar.plot</span>(abund_tr)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-media-var"></span>
<img src="livro_files/figure-html/fig-media-var-1.png" alt="Gráfico mostrando a média-variância para dados de abundância multivariada." width="100%" height="100%" />
<p class="caption">
Figura 9.22: Gráfico mostrando a média-variância para dados de abundância multivariada.
</p>
</div>
<p>Este conjunto de dados contém abundâncias de anfíbios coletados num conjunto de cidades do interior de São Paulo e também sua presença em museus. Aqui, vemos que há uma clara relação monotônica entre a média e a variância da abundância das espécies na matriz. Ou seja, à medida que espécies aumentam sua média de abundância, elas também aumentam quase que proporcionalmente a sua variância. Esta é uma propriedade bastante comum de dados multivariados de contagem, mas que não é muito bem modelada por métodos baseados em dissimilaridade, já que nesse caso apenas as espécies mais abundantes têm de fato um peso na análise.</p>
<p>A proposta implementada no pacote <code>mvabund</code> é baseada em Modelos Lineares Generalizados (GLMs) que você já conhece do Capítulo <a href="cap8.html#cap8">8</a>. Ou seja, este método permite que sejam modeladas as abundâncias das espécies num contexto multivariado utilizando explicitamente distribuições de probabilidade, tais como aquelas que utilizamos (e.g., Poisson, Binomial negativa, etc.). Isso faz com que demos peso semelhante às espécies. Vejamos um exemplo de como o modelo é ajustado e como é feito teste de hipótese.</p>
<p><strong>Exemplo 1</strong></p>
<p>A principal pergunta do artigo citado acima foi testar se a composição de espécies que obtemos em campo e de coleção científicas é diferente. Isso tem implicações para levantamentos de fauna, já que podemos complementar um tipo de dado com outro ou saber se eles são redundantes. Aqui, <code>grupos</code> é apenas um fator que indica se aquela linha da matriz apresenta dados obtidos em campo ou coleção. Vamos testar a hipótese nula de que não há diferença na composição entre as duas fontes de dados ajustando um modelo com Binomial negativa (Figura <a href="cap9.html#fig:fig-mvabund">9.23</a>).</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="cap9.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gráfico</span></span>
<span id="cb392-2"><a href="cap9.html#cb392-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(abund_tr <span class="sc">~</span> grupos, <span class="at">cex.axis =</span> <span class="fl">0.8</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb392-3"><a href="cap9.html#cb392-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb392-4"><a href="cap9.html#cb392-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  PIPING TO 2nd MVFACTOR</span></span>
<span id="cb392-5"><a href="cap9.html#cb392-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-6"><a href="cap9.html#cb392-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Modelo</span></span>
<span id="cb392-7"><a href="cap9.html#cb392-7" aria-hidden="true" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span> <span class="fu">manyglm</span>(abund_tr <span class="sc">~</span> grupos, <span class="at">family =</span> <span class="st">&quot;negative.binomial&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mvabund"></span>
<img src="livro_files/figure-html/fig-mvabund-1.png" alt="Gráfico mostrando as abundâncias para os dois grupos." width="100%" height="100%" />
<p class="caption">
Figura 9.23: Gráfico mostrando as abundâncias para os dois grupos.
</p>
</div>
<p>O gráfico mostrando os dados possui log da abundância das espécies e o fator (campo vs. coleção). Com essa análise exploratória de dados já podemos identificar se há diferença ou não na abundância das espécies em cada local. Vemos que algumas espécies são bem mais abundantes no campo do que em coleções, tais como <em>Leptodactylus mystacinus</em> e <em>Rhinella ornata</em>.</p>
<p>Uma grande vantagem desse tipo de método baseado em modelos é que, assim como um GLM típico, também podemos realizar diagnose dos resíduos utilizando plots de resíduos versus predito. Vejamos como isso funciona (Figura <a href="cap9.html#fig:fig-mvabund-diag">9.24</a>).</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="cap9.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Diagnose</span></span>
<span id="cb393-2"><a href="cap9.html#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo1)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-mvabund-diag"></span>
<img src="livro_files/figure-html/fig-mvabund-diag-1.png" alt="Diagnose dos resíduos do modelo ajustado." width="100%" height="100%" />
<p class="caption">
Figura 9.24: Diagnose dos resíduos do modelo ajustado.
</p>
</div>
<p>Aqui vemos que os dados se distribuem de maneira mais ou menos homogênea e sem um padrão claro ao redor do zero. Isso indica que a distribuição Binomial negativa foi adequada para modelar estes dados. E agora sim podemos interpretar os resultados com mais segurança.</p>
<p><strong>Interpretação dos resultados</strong></p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="cap9.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Resultados</span></span>
<span id="cb394-2"><a href="cap9.html#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo1)</span>
<span id="cb394-3"><a href="cap9.html#cb394-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb394-4"><a href="cap9.html#cb394-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistics:</span></span>
<span id="cb394-5"><a href="cap9.html#cb394-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               wald value Pr(&gt;wald)    </span></span>
<span id="cb394-6"><a href="cap9.html#cb394-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       18.947     0.001 ***</span></span>
<span id="cb394-7"><a href="cap9.html#cb394-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gruposCOLECAO      4.727     0.004 ** </span></span>
<span id="cb394-8"><a href="cap9.html#cb394-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --- </span></span>
<span id="cb394-9"><a href="cap9.html#cb394-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 </span></span>
<span id="cb394-10"><a href="cap9.html#cb394-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb394-11"><a href="cap9.html#cb394-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Test statistic:  4.727, p-value: 0.004 </span></span>
<span id="cb394-12"><a href="cap9.html#cb394-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments:</span></span>
<span id="cb394-13"><a href="cap9.html#cb394-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistics calculated assuming response assumed to be uncorrelated </span></span>
<span id="cb394-14"><a href="cap9.html#cb394-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  P-value calculated using 999 resampling iterations via pit.trap resampling (to account for correlation in testing).</span></span></code></pre></div>
<p>Aqui vemos que há sim uma diferença significativa na abundância relativa das espécies entre o campo e coleção. Mas até então estamos levando em conta toda a matriz numa abordagem multivariada. No entanto, não sabemos qual(is) espécie(s) são responsáveis por este padrão. Para investigar isso, podemos realizar uma Análise de Deviance separada para cada espécie, isso é o que a linha abaixo faz.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="cap9.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ANOVA</span></span>
<span id="cb395-2"><a href="cap9.html#cb395-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo1, <span class="at">p.uni =</span> <span class="st">&quot;adjusted&quot;</span>)</span>
<span id="cb395-3"><a href="cap9.html#cb395-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time elapsed: 0 hr 0 min 7 sec</span></span>
<span id="cb395-4"><a href="cap9.html#cb395-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb395-5"><a href="cap9.html#cb395-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb395-6"><a href="cap9.html#cb395-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model: abund_tr ~ grupos</span></span>
<span id="cb395-7"><a href="cap9.html#cb395-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb395-8"><a href="cap9.html#cb395-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multivariate test:</span></span>
<span id="cb395-9"><a href="cap9.html#cb395-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)   </span></span>
<span id="cb395-10"><a href="cap9.html#cb395-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      8                          </span></span>
<span id="cb395-11"><a href="cap9.html#cb395-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; grupos           7       1 94.08     0.01 **</span></span>
<span id="cb395-12"><a href="cap9.html#cb395-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb395-13"><a href="cap9.html#cb395-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb395-14"><a href="cap9.html#cb395-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb395-15"><a href="cap9.html#cb395-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Univariate Tests:</span></span>
<span id="cb395-16"><a href="cap9.html#cb395-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Chiasmocleis_albopunctata          Dendropsophus_elianae          Dendropsophus_jimi         </span></span>
<span id="cb395-17"><a href="cap9.html#cb395-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   Dev Pr(&gt;Dev)                   Dev Pr(&gt;Dev)                Dev Pr(&gt;Dev)</span></span>
<span id="cb395-18"><a href="cap9.html#cb395-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                                              </span></span>
<span id="cb395-19"><a href="cap9.html#cb395-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; grupos                          3.308    0.467                 0.394    0.836               0.23    0.836</span></span>
<span id="cb395-20"><a href="cap9.html#cb395-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Dendropsophus_nanus          Dendropsophus_minutus          Dendropsophus_sanborni         </span></span>
<span id="cb395-21"><a href="cap9.html#cb395-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             Dev Pr(&gt;Dev)                   Dev Pr(&gt;Dev)                    Dev Pr(&gt;Dev)</span></span>
<span id="cb395-22"><a href="cap9.html#cb395-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                                            </span></span>
<span id="cb395-23"><a href="cap9.html#cb395-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; grupos                    2.197    0.707                 4.752    0.309                  2.197    0.707</span></span>
<span id="cb395-24"><a href="cap9.html#cb395-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Elachistocleis_cesari          Hypsiboas_albopunctatus          Hypsiboas_faber         </span></span>
<span id="cb395-25"><a href="cap9.html#cb395-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                               Dev Pr(&gt;Dev)                     Dev Pr(&gt;Dev)             Dev Pr(&gt;Dev)</span></span>
<span id="cb395-26"><a href="cap9.html#cb395-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                                         </span></span>
<span id="cb395-27"><a href="cap9.html#cb395-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; grupos                      2.012    0.762                   2.069    0.762           0.913    0.822</span></span>
<span id="cb395-28"><a href="cap9.html#cb395-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Hypsiboas_lundii          Hypsiboas_prasinus          Itapotihyla_langsdorffii         </span></span>
<span id="cb395-29"><a href="cap9.html#cb395-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                          Dev Pr(&gt;Dev)                Dev Pr(&gt;Dev)                      Dev Pr(&gt;Dev)</span></span>
<span id="cb395-30"><a href="cap9.html#cb395-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                                        </span></span>
<span id="cb395-31"><a href="cap9.html#cb395-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; grupos                 0.915    0.822              0.913    0.822                    0.911    0.836</span></span>
<span id="cb395-32"><a href="cap9.html#cb395-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Leptodactylus_fuscus          Leptodactylus_latrans          Leptodactylus_mystaceus         </span></span>
<span id="cb395-33"><a href="cap9.html#cb395-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                              Dev Pr(&gt;Dev)                   Dev Pr(&gt;Dev)                     Dev Pr(&gt;Dev)</span></span>
<span id="cb395-34"><a href="cap9.html#cb395-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                                              </span></span>
<span id="cb395-35"><a href="cap9.html#cb395-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; grupos                     4.652    0.309                 0.811    0.836                   1.869    0.783</span></span>
<span id="cb395-36"><a href="cap9.html#cb395-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Leptodactylus_mystacinus          Physalaemus_centralis          Physalaemus_cuvieri         </span></span>
<span id="cb395-37"><a href="cap9.html#cb395-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                  Dev Pr(&gt;Dev)                   Dev Pr(&gt;Dev)                 Dev Pr(&gt;Dev)</span></span>
<span id="cb395-38"><a href="cap9.html#cb395-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                                              </span></span>
<span id="cb395-39"><a href="cap9.html#cb395-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; grupos                         9.772    0.045                 2.639    0.670               8.221    0.062</span></span>
<span id="cb395-40"><a href="cap9.html#cb395-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Physalaemus_marmoratus          Physalaemus_nattereri          Pseudis_paradoxa         </span></span>
<span id="cb395-41"><a href="cap9.html#cb395-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                Dev Pr(&gt;Dev)                   Dev Pr(&gt;Dev)              Dev Pr(&gt;Dev)</span></span>
<span id="cb395-42"><a href="cap9.html#cb395-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                                         </span></span>
<span id="cb395-43"><a href="cap9.html#cb395-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; grupos                       1.622    0.783                17.131    0.014             2.67    0.540</span></span>
<span id="cb395-44"><a href="cap9.html#cb395-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Rhinella_ornata          Rhinella_schneideri          Scinax_fuscomarginatus         </span></span>
<span id="cb395-45"><a href="cap9.html#cb395-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                         Dev Pr(&gt;Dev)                 Dev Pr(&gt;Dev)                    Dev Pr(&gt;Dev)</span></span>
<span id="cb395-46"><a href="cap9.html#cb395-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                                      </span></span>
<span id="cb395-47"><a href="cap9.html#cb395-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; grupos               11.961    0.027               3.363    0.467                   2.64    0.622</span></span>
<span id="cb395-48"><a href="cap9.html#cb395-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Scinax_fuscovarius          Scinax_similis          Trachycephalus_typhonius         </span></span>
<span id="cb395-49"><a href="cap9.html#cb395-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                            Dev Pr(&gt;Dev)            Dev Pr(&gt;Dev)                      Dev Pr(&gt;Dev)</span></span>
<span id="cb395-50"><a href="cap9.html#cb395-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                                                                                      </span></span>
<span id="cb395-51"><a href="cap9.html#cb395-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; grupos                   1.655    0.783          2.646    0.622                    1.622    0.783</span></span>
<span id="cb395-52"><a href="cap9.html#cb395-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Arguments:</span></span>
<span id="cb395-53"><a href="cap9.html#cb395-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Test statistics calculated assuming uncorrelated response (for faster computation) </span></span>
<span id="cb395-54"><a href="cap9.html#cb395-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; P-value calculated using 999 iterations via PIT-trap resampling.</span></span></code></pre></div>
<p>Aqui vemos que algumas espécies já identificadas no plot exploratório de fato são importantes para determinar o padrão, tais como: <em>Leptodactylus mystacinus</em>, <em>Physalaemus nattereri</em> e <em>Rhinella ornata</em>. Essas foram espécies cuja Deviance foi significativa.</p>
</div>
<div id="para-se-aprofundar-5" class="section level2" number="9.10">
<h2><span class="header-section-number">9.10</span> Para se aprofundar</h2>
<p>Listamos a seguir livros e artigos com material que recomendamos para seguir com sua aprendizagem em análises multivariadas em R: i) Legendre &amp; Legendre [-@] Numerical Ecology, ii) Borcard e colaboradores <span class="citation">(<a href="#ref-borcard2018" role="doc-biblioref">2018</a>)</span> Numerical Ecology with R, iii) Thioulouse e colaboradores <span class="citation">(<a href="#ref-thioulouse_multivariate_2018" role="doc-biblioref">2018</a>)</span> Multivariate Analysis of Ecological Data with ade4, iv) Ovaskainen &amp; Abrego <span class="citation">(<a href="#ref-ovaskainen_joint_2020" role="doc-biblioref">2020</a>)</span> Joint Species Distribution Modelling, v) James &amp; McCulloch <span class="citation">(<a href="#ref-james_multivariate_1990" role="doc-biblioref">1990</a>)</span> Multivariate Analysis in Ecology and Systematics: Panacea or Pandora’s Box? e vi) Dunstan e colaboradores <span class="citation">(<a href="#ref-dunstan_model_2011" role="doc-biblioref">2011</a>)</span> Model based grouping of species across environmental gradients.</p>

</div>
</div>
<h3>Referências</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-anderson_new_2001" class="csl-entry">
Anderson, M. J. (2001). <span class="nocase">A new method for non-parametric multivariate analysis of variance</span>. <em>Austral Ecology</em>, <em>26</em>(1), 32–46. <a href="https://doi.org/10.1046/j.1442-9993.2001.01070.x">https://doi.org/10.1046/j.1442-9993.2001.01070.x</a>
</div>
<div id="ref-anderson_permutational_2017" class="csl-entry">
Anderson, M. J. (2017). <span class="nocase">Permutational Multivariate Analysis of Variance (PERMANOVA)</span>. In <em>Wiley StatsRef: Statistics reference online</em> (pp. 1–15). Wiley. <a href="https://doi.org/10.1002/9781118445112.stat07841">https://doi.org/10.1002/9781118445112.stat07841</a>
</div>
<div id="ref-anderson2010" class="csl-entry">
Anderson, M. J., Crist, T. O., Chase, J. M., Vellend, M., Inouye, B. D., Freestone, A. L., Sanders, N. J., Cornell, H. V., Comita, L. S., Davies, K. F., Harrison, S. P., Kraft, N. J. B., Stegen, J. C., &amp; Swenson, N. G. (2011). <span class="nocase">Navigating the multiple meanings of <span class="math inline">\(\beta\)</span> diversity: A roadmap for the practicing ecologist</span>. <em>Ecology Letters</em>, <em>14</em>(1), 19–28. <a href="https://doi.org/10.1111/j.1461-0248.2010.01552.x">https://doi.org/10.1111/j.1461-0248.2010.01552.x</a>
</div>
<div id="ref-anderson_permanova+_2008" class="csl-entry">
Anderson, M. J., Gorley, R. N., &amp; Clarke, K. R. (2008). <em><span class="nocase">PERMANOVA+ for PRIMER: Guide to Software and Statistical Methods</span></em> (p. 214). Primer-E. <a href="http://updates.primer-e.com/primer7/manuals/PERMANOVA+_manual.pdf">http://updates.primer-e.com/primer7/manuals/PERMANOVA+_manual.pdf</a>
</div>
<div id="ref-anderson_permanova_2013" class="csl-entry">
Anderson, M. J., &amp; Walsh, D. C. I. (2013). <span class="nocase">PERMANOVA, ANOSIM, and the Mantel test in the face of heterogeneous dispersions: What null hypothesis are you testing?</span> <em>Ecological Monographs</em>, <em>83</em>(4), 557–574. <a href="https://doi.org/10.1890/12-2010.1">https://doi.org/10.1890/12-2010.1</a>
</div>
<div id="ref-anderson_permutation_2003" class="csl-entry">
Anderson, M., &amp; Ter Braak, C. (2003). <span class="nocase">Permutation tests for multi-factorial analysis of variance</span>. <em>Journal of Statistical Computation and Simulation</em>, <em>73</em>(2), 85–113. <a href="https://doi.org/10.1080/00949650215733">https://doi.org/10.1080/00949650215733</a>
</div>
<div id="ref-bauman_disentangling_2018" class="csl-entry">
Bauman, D., Drouet, T., Dray, S., &amp; Vleminckx, J. (2018). <span class="nocase">Disentangling good from bad practices in the selection of spatial or phylogenetic eigenvectors</span>. <em>Ecography</em>, <em>41</em>(10), 1638–1649. <a href="https://doi.org/10.1111/ecog.03380">https://doi.org/10.1111/ecog.03380</a>
</div>
<div id="ref-bauman_optimizing_2018" class="csl-entry">
Bauman, D., Drouet, T., Fortin, M.-J., &amp; Dray, S. (2018). <span class="nocase">Optimizing the choice of a spatial weighting matrix in eigenvector-based methods</span>. <em>Ecology</em>, <em>99</em>(10), 2159–2166. <a href="https://doi.org/10.1002/ecy.2469">https://doi.org/10.1002/ecy.2469</a>
</div>
<div id="ref-blascomoreno2019" class="csl-entry">
Blasco‐Moreno, A., Pérez‐Casany, M., Puig, P., Morante, M., &amp; Castells, E. (2019). <span class="nocase">What does a zero mean? Understanding false, random and structural zeros in ecology</span>. <em>Methods in Ecology and Evolution</em>, <em>10</em>(7), 949–959. <a href="https://doi.org/10.1111/2041-210X.13185">https://doi.org/10.1111/2041-210X.13185</a>
</div>
<div id="ref-borcard2018" class="csl-entry">
Borcard, D., Gillet, F., &amp; Legendre, P. (2018). <em><span class="nocase">Numerical Ecology with R</span></em>. Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-71404-2">https://doi.org/10.1007/978-3-319-71404-2</a>
</div>
<div id="ref-borcard_partialling_1992" class="csl-entry">
Borcard, D., Legendre, P., &amp; Drapeau, P. (1992). <span class="nocase">Partialling out the spatial component of ecological variation</span>. <em>Ecology</em>, <em>73</em>(3), 1045–1055. <a href="https://doi.org/10.2307/1940179">https://doi.org/10.2307/1940179</a>
</div>
<div id="ref-crabot2019" class="csl-entry">
Crabot, J., Clappe, S., Dray, S., &amp; Datry, T. (2019). Testing the mantel statistic with a spatially-constrained permutation procedure. <em>Methods in Ecology and Evolution</em>, <em>10</em>(4), 532–540. https://doi.org/<a href="https://doi.org/10.1111/2041-210X.13141">https://doi.org/10.1111/2041-210X.13141</a>
</div>
<div id="ref-diniz-filho_eigenvector_1998" class="csl-entry">
Diniz-Filho, J. A. F., de Sant’Ana, C. E. R., &amp; Bini, L. M. (1998). <span class="nocase">An eigenvector method for estimating phylogenetic inertia</span>. <em>Evolution</em>, <em>52</em>(5), 1247. <a href="https://doi.org/10.2307/2411294">https://doi.org/10.2307/2411294</a>
</div>
<div id="ref-dray_community_2012" class="csl-entry">
Dray, S., Pélissier, R., Couteron, P., Fortin, M. J., Legendre, P., Peres-Neto, P. R., Bellier, E., Bivand, R., Blanchet, F. G., De Cáceres, M., Dufour, A. B., Heegaard, E., Jombart, T., Munoz, F., Oksanen, J., Thioulouse, J., &amp; Wagner, H. H. (2012). <span class="nocase">Community ecology in the age of multivariate multiscale spatial analysis</span>. <em>Ecological Monographs</em>, <em>82</em>(3), 257–275. <a href="https://doi.org/10.1890/11-1183.1">https://doi.org/10.1890/11-1183.1</a>
</div>
<div id="ref-dufrene_species_1997" class="csl-entry">
Dufrêne, M., &amp; Legendre, P. (1997). <span class="nocase">Species assemblages and indicator species the need for a flexible asymmetrical approach</span>. <em>Ecological Monographs</em>, <em>67</em>(3), 345–366. <a href="https://doi.org/10.1890/0012-9615(1997)067[0345:SAAIST]2.0.CO;2">https://doi.org/10.1890/0012-9615(1997)067[0345:SAAIST]2.0.CO;2</a>
</div>
<div id="ref-dunstan_model_2011" class="csl-entry">
Dunstan, P. K., Foster, S. D., &amp; Darnell, R. (2011). Model based grouping of species across environmental gradients. <em>Ecological Modelling</em>, <em>222</em>(4), 955–963. <a href="https://doi.org/10.1016/j.ecolmodel.2010.11.030">https://doi.org/10.1016/j.ecolmodel.2010.11.030</a>
</div>
<div id="ref-gower_statistical_1971" class="csl-entry">
Gower, J. C. (1971). Statistical methods of comparing different multivariate analyses of the same data. In F. R. Hodson, D. G. Kendall, &amp; P. Tautu (Eds.), <em>Mathematics in the archaeological and historical science</em> (pp. 138–149). Edinburgh University Press. <a href="https://repository.rothamsted.ac.uk/item/8wv79/statistical-methods-of-comparing-different-multivariate-analyses-of-the-same-data">https://repository.rothamsted.ac.uk/item/8wv79/statistical-methods-of-comparing-different-multivariate-analyses-of-the-same-data</a>
</div>
<div id="ref-jackson_protest_1995" class="csl-entry">
Jackson, D. A. (1995). PROTEST: A PROcrustean randomization TEST of community environment concordance. <em>Ecoscience</em>, <em>2</em>(3), 297–303.
</div>
<div id="ref-james_multivariate_1990" class="csl-entry">
James, F. C., &amp; McCulloch, C. E. (1990). Multivariate <span>Analysis</span> in <span>Ecology</span> and <span>Systematics</span>: <span>Panacea</span> or <span>Pandora</span>’s <span>Box</span>? <em>Annual Review of Ecology and Systematics</em>, <em>21</em>(1), 129–166. <a href="https://doi.org/10.1146/annurev.es.21.110190.001021">https://doi.org/10.1146/annurev.es.21.110190.001021</a>
</div>
<div id="ref-legendre2000" class="csl-entry">
Legendre, P. (2000). Comparison of permutation methods for the partial correlation and partial mantel tests. <em>Journal of Statistical Computation and Simulation</em>, <em>67</em>(1), 37–73. <a href="https://doi.org/10.1080/00949650008812035">https://doi.org/10.1080/00949650008812035</a>
</div>
<div id="ref-legendre_distance-based_1999" class="csl-entry">
Legendre, P., &amp; Anderson, M. J. (1999). Distance-based redundancy analysis: Testing multispecies responses in multifactorial ecological experiments. <em>Ecological Monographs</em>, <em>69</em>(1), 1–24.
</div>
<div id="ref-legendre2018" class="csl-entry">
Legendre, P., &amp; Borcard, D. (2018). <span class="nocase">Box-Cox-chord transformations for community composition data prior to beta diversity analysis</span>. <em>Ecography</em>, <em>41</em>(11), 1820–1824. <a href="https://doi.org/10.1111/ecog.03498">https://doi.org/10.1111/ecog.03498</a>
</div>
<div id="ref-legendre2013" class="csl-entry">
Legendre, P., &amp; De Cáceres, M. (2013). <span class="nocase">Beta diversity as the variance of community data: dissimilarity coefficients and partitioning</span>. <em>Ecology Letters</em>, <em>16</em>(8), 951–963. <a href="https://doi.org/10.1111/ele.12141">https://doi.org/10.1111/ele.12141</a>
</div>
<div id="ref-legendre2015" class="csl-entry">
Legendre, P., Fortin, M.-J., &amp; Borcard, D. (2015). Should the mantel test be used in spatial analysis? <em>Methods in Ecology and Evolution</em>, <em>6</em>(11), 1239–1247. https://doi.org/<a href="https://doi.org/10.1111/2041-210X.12425">https://doi.org/10.1111/2041-210X.12425</a>
</div>
<div id="ref-legendre2001" class="csl-entry">
Legendre, P., &amp; Gallagher, E. D. (2001). <span class="nocase">Ecologically meaningful transformations for ordination of species data</span>. <em>Oecologia</em>, <em>129</em>(2), 271–280. <a href="https://doi.org/10.1007/s004420100716">https://doi.org/10.1007/s004420100716</a>
</div>
<div id="ref-legendre_numerical_2012" class="csl-entry">
Legendre, P., &amp; Legendre, L. (2012). <em><span>Numerical Ecology</span></em> (3rd ed., p. 1006). Elsevier.
</div>
<div id="ref-legendre2010" class="csl-entry">
LEGENDRE, P., &amp; FORTIN, M.-J. (2010). Comparison of the mantel test and alternative approaches for detecting complex multivariate relationships in the spatial analysis of genetic data. <em>Molecular Ecology Resources</em>, <em>10</em>(5), 831–844. https://doi.org/<a href="https://doi.org/10.1111/j.1755-0998.2010.02866.x">https://doi.org/10.1111/j.1755-0998.2010.02866.x</a>
</div>
<div id="ref-lisboa_much_2014" class="csl-entry">
Lisboa, F. J. G., Peres-Neto, P. R., Chaer, G. M., Jesus, E. da C., Mitchell, R. J., Chapman, S. J., &amp; Berbara, R. L. L. (2014). Much beyond mantel: Bringing procrustes association metric to the plant and soil ecologist’s toolbox. <em>PLoS One</em>, <em>9</em>(6), e101238.
</div>
<div id="ref-ovaskainen_joint_2020" class="csl-entry">
Ovaskainen, O., &amp; Abrego, N. (2020). <em>Joint <span>Species</span> <span>Distribution</span> <span>Modelling</span></em>.
</div>
<div id="ref-peres-neto_how_2001" class="csl-entry">
Peres-Neto, P. R., &amp; Jackson, D. A. (2001). How well do multivariate data sets match? The advantages of a procrustean superimposition approach over the mantel test. <em>Oecologia</em>, <em>129</em>(2), 169–178.
</div>
<div id="ref-provete_broad-scale_2014" class="csl-entry">
Provete, D. B., Gonçalves-Souza, T., Garey, M. V., Martins, I. A., &amp; Rossa-Feres, D. de C. (2014). Broad-scale spatial patterns of canopy cover and pond morphology affect the structure of a <span>Neotropical</span> amphibian metacommunity. <em>Hydrobiologia</em>, <em>734</em>(1), 69–79. <a href="https://doi.org/10.1007/s10750-014-1870-0">https://doi.org/10.1007/s10750-014-1870-0</a>
</div>
<div id="ref-dasilva2017" class="csl-entry">
Silva, F. R. da, Provete, D. B., Gerassi, L. K., &amp; Bovo, R. P. (2017). <span class="nocase">What do Data from Fieldwork and Scientific Collections Tell us about Species Richness and Composition of Amphibians and Reptiles?</span> <em>South American Journal of Herpetology</em>, <em>12</em>(2), 99–106. <a href="https://doi.org/10.2994/SAJH-D-16-00051.1">https://doi.org/10.2994/SAJH-D-16-00051.1</a>
</div>
<div id="ref-sneath_numerical_1973" class="csl-entry">
Sneath, P. H. A., &amp; Sokal, R. R. (1973). <em><span class="nocase">Numerical taxonomy: the principles and practice of numerical classification</span></em>. W. H. Freeman.
</div>
<div id="ref-thioulouse_multivariate_2018" class="csl-entry">
Thioulouse, J., Dray, S., Dufour, A.-B., Siberchicot, A., Jombart, T., &amp; Pavoine, S. (2018). <em>Multivariate <span>Analysis</span> of <span>Ecological</span> <span>Data</span> with ade4</em>. Springer New York. <a href="https://doi.org/10.1007/978-1-4939-8850-1">https://doi.org/10.1007/978-1-4939-8850-1</a>
</div>
<div id="ref-wang2012" class="csl-entry">
Wang, Y., Naumann, U., Wright, S. T., &amp; Warton, D. I. (2012). Mvabundâ€“ an r package for model-based analysis of multivariate abundance data. <em>Methods in Ecology and Evolution</em>, <em>3</em>(3), 471–474. https://doi.org/<a href="https://doi.org/10.1111/j.2041-210X.2012.00190.x">https://doi.org/10.1111/j.2041-210X.2012.00190.x</a>
</div>
<div id="ref-warton2012" class="csl-entry">
Warton, D. I., Wright, S. T., &amp; Wang, Y. (2012). Distance-based multivariate analyses confound location and dispersion effects. <em>Methods in Ecology and Evolution</em>, <em>3</em>(1), 89–101. https://doi.org/<a href="https://doi.org/10.1111/j.2041-210X.2011.00127.x">https://doi.org/10.1111/j.2041-210X.2011.00127.x</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cap8.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cap10.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/paternogbc/livro_aer/edit/master/09_analises_multidimensionais.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/paternogbc/livro_aer/blob/master/09_analises_multidimensionais.Rmd",
"text": null
},
"download": ["livro.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
