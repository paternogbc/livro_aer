[{"path":"index.html","id":"bem-vindos","chapter":"Bem-vindos","heading":"Bem-vindos","text":" Essa √© p√°gina online livro An√°lises Ecol√≥gicas R. Este livro cont√©m 15 cap√≠tulos que v√£o desde como baixar e instalar o R, passando por manipula√ß√£o de dados, an√°lises de diversidade, estat√≠stica b√°sica, m√©todos multidimensionais e visualiza√ß√£o de dados geoespaciais. Este √© um material introdut√≥rio destinado principalmente estudantes de gradua√ß√£o e cursos de p√≥s-gradua√ß√£o em estat√≠stica e ecologia. Esperamos que ele seja utilizado tanto por quem quer se aprofundar em an√°lises comumente utilizadas em ecologia, quanto por quem n√£o tem nenhuma ou poucas habilidades quantitativas. Este livro √© um dos poucos, sen√£o √∫nico, material em portugu√™s com essa abrang√™ncia e visa ser o principal manual de entrada para aprendizagem de R e suas aplica√ß√µes em ecologia, conserva√ß√£o e ci√™ncias ambientais. Para isso, propomos uma estrat√©gia que facilite escolha teste estat√≠stico, por meio da sele√ß√£o de quest√µes/hip√≥teses claras e da liga√ß√£o dessas hip√≥teses com teoria e o m√©todo. Ainda, cada cap√≠tulo cont√©m exerc√≠cios propostos, e suas solu√ß√µes, recomenda√ß√µes de literatura e links especializados para cada cap√≠tulo livro, e uma sess√£o sobre como utilizar o livro em grupos de discuss√£o e sala de aula.vers√£o -line est√° dispon√≠vel gratuitamente e o c√≥digo fonte necess√°rio para reproduzir todo o conte√∫do livro est√° depositado Github.Este livro foi escrito em Rmarkdown e compilado utilizando o pacote bookdown.","code":""},{"path":"index.html","id":"como-contribuir","chapter":"Bem-vindos","heading":"Como contribuir?","text":"Para contribuir com o livro √© necess√°rio que voc√™ se cadastre Github.\nCaso encontre erros livro ou tenha sugest√µes para melhorar o seu conte√∫do, abra um chamado reposit√≥rio e descreva o problema encontrado ou apresente suas sugest√µes. Caso encontre erros de digita√ß√£o, voc√™ pode corrigi-los clicando em ‚ÄúEdite esta p√°gina‚Äù na barra lateral direita. Depois de corrigir os erros, submeta um pull request pelo Github. Sua contribui√ß√£o √© muito importante e bem-vinda para que possamos aprimorar o conte√∫do livro para pr√≥ximas edi√ß√µes.","code":""},{"path":"index.html","id":"licen√ßa","chapter":"Bem-vindos","heading":"Licen√ßa","text":"vers√£o online deste livro ser√° sempre gratuita e distribu√≠da sob lice√ßa XXX.p√°gina online livro est√° hospedada pela plataforma Netlify.","code":""},{"path":"pref√°cio.html","id":"pref√°cio","chapter":"Pref√°cio","heading":"Pref√°cio","text":"Prof.¬†Tadeu de Siqueira Barros\nDocente Departamento de Biodiversidade, UNESP, Rio Claro","code":""},{"path":"dedicat√≥ria.html","id":"dedicat√≥ria","chapter":"Dedicat√≥ria","heading":"Dedicat√≥ria","text":"Dedicamos esse livro √†s nossas companheiras que nos apoiaram durante o longo processo de constru√ß√£o livro, e aos nossos filhos e filhas pelas distra√ß√µes e alegrias quando est√°vamos longe dos infinitos erros durante compila√ß√µes.","code":""},{"path":"sobre-os-autores.html","id":"sobre-os-autores","chapter":"Sobre os autores","heading":"Sobre os autores","text":"Fernando Rodrigues da SilvaPiadista descomedido de Barueri/SP, pai da √Åria, companheiro da Winter, respons√°vel pela Filomena (gata), Z√© (gato), Cenoura (cachorra) e Chica (cachorra), admirador de botecos, viagens, mato, cerveja, poker, basquete e prosa com os amigos. Formado em Ci√™ncias Biol√≥gicas na UNESP-Assis e com mestrado e doutorado em Biologia Animal pela UNESP-S√£o Jos√© Rio Preto. Realizou doutorado sandu√≠che na SUNY ‚Äì College Environmental Science Forest. Atualmente √© Professor Associado II Departamento de Ci√™ncias Ambientais, UFSCAR-Sorocaba e trabalha na linha de pesquisa de ecologia de comunidades, metacomunidades, macroecologia, biogeografia e hist√≥ria natural de anf√≠bios.Site: http://fernandoecologia.wix.com/fernandorodriguesThiago Gon√ßalves-SouzaCapixaba de Cachoeiro Itapemirim/ES, pai Lucas, companheiro da Nat√°lia, praticante de Muay Thai, Boxe e da arte de provar cervejas. Formado em Ci√™ncias Biol√≥gicas na Escola Superior S√£o Francisco de Assis/ES e com mestrado e doutorado em Biologia Animal pela UNESP-S√£o Jos√© Rio Preto. Realizou doutorado sandu√≠che na University Guelph (Canad√°) e p√≥s-doutorado na UNICAMP. Atualmente √© Professor Adjunto III Departamento de Biologia da Universidade Federal Rural de Pernambuco, trabalhando nas linhas de pesquisa de ecologia de comunidades, ecologia funcional, macroecologia e metacomunidades.Site: https://thiagocalvesouza.wixsite.com/ecofunGustavo Brant PaternoCompositor de cantigas e violeiro, nascido em Ribeir√£o Preto/SP, pai Rud√° e da Maria Flor, e apaixonado por Mila. Admira profundamente incr√≠vel diversidade da vida na Terra. Gosta de trilha, m√∫sica, skate, surf, fotografia de estrelas e programa√ß√£o. √â Ec√≥logo com muito orgulho pela forma√ß√£o na UFRN/Natal, com mestrado e doutorado em Ecologia pela mesma universidade. Realizou sandu√≠che na Macquarie University (Austr√°lia). Possui grande interesse em Ci√™ncia aberta e software livre e √© embaixador projeto Open Science Framework (OSF). Atualmente √© pesquisador de p√≥s-doutorado na Faculty Forest Sciences Forest Ecology da Universidade de Gottingen (Alemanha). Atua na interface entre ecologia evolutiva, biodiversidade-funcionamento de ecossistemas e ecologia da restaura√ß√£o.Site: https://gustavopaterno.netlify.app/Diogo Borges ProveteCapixaba da gema, nascido em Bom Jesus Norte/ES (na verdade registrado nessa cidade e nascido em Bom Jesus Itabapoana/RJ outro lado da ponte, porque ES n√£o tinha hospital :D ), pai orgulhoso da Manuela e esposo apaixonado da Lilian. Apreciador das boas Ale Belgas e Inglesas e vinhos Chilenos e Brasileiros. J√° fui nadador, jogador de futebol, e um p√©ssimo jogador de Xadrez. Dizem que gosto de livros e HQs. Graduado em Ci√™ncias Biol√≥gicas na Universidade Federal de Alfenas-MG, com mestrado em Biologia Animal na UNESP-S√£o Jos√© Rio Preto e Doutorado em Ecologia e Evolu√ß√£o na Universidade Federal de Goi√°s. Atualmente √© Professor Adjunto na Universidade Federal de Mato Grosso Sul. Meu programa de pesquisa tenta integrar evolu√ß√£o fenot√≠pica e processos micro- e macroevolutivos para entender padr√µes de distribui√ß√£o de esp√©cies em escala de metacomunidades, especialmente em ambientes de √°gua doce.Site: http://diogoprovete.weebly.comMaur√≠cio Humberto VancineCaipira interior de Socorro/SP, pai Dudu, companheiro da Japa, amante de m√∫sica instrumenral, livros, games, softwares livres, programa√ß√£o, uma boa cerveja, al√©m de um dedo de cacha√ßa e uma longa prosa. Mais recentemente tenta n√£o levar muitos tombos ao aprender andar de skate depois dos 30. Graduado em Ecologia e mestre em Zoologia, ambos pela UNESP-Rio Claro. Atualmente √© Doutorando PPG de Ecologia, Evolu√ß√£o e Biodiversidade da UNESP-Rio Claro e atua na linha de pesquisa de Ecologia Espacial, Ecologia da Paisagem, Modelagem Ecol√≥gica e Ecologia de Anf√≠bios.Site: https://mauriciovancine.github.io/","code":""},{"path":"revisores-e-colaboradores.html","id":"revisores-e-colaboradores","chapter":"Revisores e colaboradores","heading":"Revisores e colaboradores","text":"Expressamos nossos sinceros agradecimentos aos pesquisadores, alunos e colegas indicados abaixo, pelo imprescind√≠vel trabalho de avalia√ß√£o, revis√£o e cr√≠tica conte√∫do deste livro.Andr√© Padial - Setor de Ci√™ncias Biol√≥gicas, Universidade Federal Paran√°, Curitiba, Paran√°Andr√© Padial - Setor de Ci√™ncias Biol√≥gicas, Universidade Federal Paran√°, Curitiba, Paran√°Adriano Sanches Melo - Instituto de Bioci√™ncias, Universidade Federal Rio Grande Sul (UFRGS), campus Vale, Porto Alegre, Rio Grande SulAdriano Sanches Melo - Instituto de Bioci√™ncias, Universidade Federal Rio Grande Sul (UFRGS), campus Vale, Porto Alegre, Rio Grande SulBeatriz Milz - Programa de P√≥s-Gradua√ß√£o em Ci√™ncia Ambiental, Instituto de Energia e Ambiente, Universidade de S√£o Paulo (PROCAM/IEE/USP), S√£o Paulo, S√£o PauloBeatriz Milz - Programa de P√≥s-Gradua√ß√£o em Ci√™ncia Ambiental, Instituto de Energia e Ambiente, Universidade de S√£o Paulo (PROCAM/IEE/USP), S√£o Paulo, S√£o PauloFelipe Sodr√© Mendes Barros - Departamento de Geografia, Instituto Superior Antonio Ruiz de Montoya, Instituto Misionero de Biodiversidad - IMiBio, Ambiental Analytics, Misiones, ArgentinaFelipe Sodr√© Mendes Barros - Departamento de Geografia, Instituto Superior Antonio Ruiz de Montoya, Instituto Misionero de Biodiversidad - IMiBio, Ambiental Analytics, Misiones, ArgentinaIngrid da Silva Lima - Programa de Etnobiologia e Conserva√ß√£o da Natureza (PPGEtno), Universidade Federal Rural de Pernambuco (UFRPE), Recife, PernambucoIngrid da Silva Lima - Programa de Etnobiologia e Conserva√ß√£o da Natureza (PPGEtno), Universidade Federal Rural de Pernambuco (UFRPE), Recife, PernambucoMaur√≠cio Cetra - Departamento de Ci√™ncias Ambientais, Universidade Federal de S√£o Carlos (UFSCar), campus Sorocaba, S√£o PauloMaur√≠cio Cetra - Departamento de Ci√™ncias Ambientais, Universidade Federal de S√£o Carlos (UFSCar), campus Sorocaba, S√£o PauloMarcos Rafael Severgnini - Programa de P√≥s Gradua√ß√£o em Ecologia e Conserva√ß√£o, Universidade Federal de Mato Grosso Sul, Campo Grande, Mato Grosso SulMarcos Rafael Severgnini - Programa de P√≥s Gradua√ß√£o em Ecologia e Conserva√ß√£o, Universidade Federal de Mato Grosso Sul, Campo Grande, Mato Grosso SulMarcos Robalinho Lima - Departamento de Biologia Animal e Plantas, Universidade Estadual de Londrina, Londrina, Paran√°Marcos Robalinho Lima - Departamento de Biologia Animal e Plantas, Universidade Estadual de Londrina, Londrina, Paran√°Michel Varaj√£o Garey - Instituto Latino Americano de Ci√™ncias da Vida e da Natureza (ILACVN), Universidade Federal da Integra√ß√£o Latino-Americana (UNILA), Foz Igua√ßu, Paran√°Michel Varaj√£o Garey - Instituto Latino Americano de Ci√™ncias da Vida e da Natureza (ILACVN), Universidade Federal da Integra√ß√£o Latino-Americana (UNILA), Foz Igua√ßu, Paran√°Paulo Mateus Martins Sobrinho - Programa de Etnobiologia e Conserva√ß√£o da Natureza (PPGEtno), Universidade Federal Rural de Pernambuco (UFRPE), Recife, PernambucoPaulo Mateus Martins Sobrinho - Programa de Etnobiologia e Conserva√ß√£o da Natureza (PPGEtno), Universidade Federal Rural de Pernambuco (UFRPE), Recife, PernambucoPaulo S√©rgio Monteiro Ferreira - Secretaria Estado da Educa√ß√£o da Para√≠ba, Para√≠baPaulo S√©rgio Monteiro Ferreira - Secretaria Estado da Educa√ß√£o da Para√≠ba, Para√≠baPedro Henrique Albuquerque Sena - Centro de Pesquisas Ambientais Nordeste (Cepan), Recife, PernambucoPedro Henrique Albuquerque Sena - Centro de Pesquisas Ambientais Nordeste (Cepan), Recife, PernambucoReginaldo Augusto Farias de Gusm√£o - Programa de Etnobiologia e Conserva√ß√£o da Natureza (PPGEtno), Universidade Federal Rural de Pernambuco (UFRPE), Recife, PernambucoReginaldo Augusto Farias de Gusm√£o - Programa de Etnobiologia e Conserva√ß√£o da Natureza (PPGEtno), Universidade Federal Rural de Pernambuco (UFRPE), Recife, PernambucoVictor Satoru Saito - Departamento de Ci√™ncias Ambientais, Universidade Federal de S√£o Carlos (UFSCar), campus S√£o Carlos, S√£o PauloVictor Satoru Saito - Departamento de Ci√™ncias Ambientais, Universidade Federal de S√£o Carlos (UFSCar), campus S√£o Carlos, S√£o Paulo","code":""},{"path":"cap1.html","id":"cap1","chapter":"Cap√≠tulo 1 Introdu√ß√£o","heading":"Cap√≠tulo 1 Introdu√ß√£o","text":"","code":""},{"path":"cap1.html","id":"hist√≥rico-deste-livro","chapter":"Cap√≠tulo 1 Introdu√ß√£o","heading":"1.1 Hist√≥rico deste livro","text":"Este livro foi estruturado partir da apostila elaborada pelos pesquisadores Diogo B. Provete, Fernando R. da Silva e Thiago Gon√ßalves-Souza para ministrar o curso Estat√≠stica aplicada √† ecologia usando o R PPG em Biologia Animal da UNESP de S√£o Jos√© Rio Preto/SP, em abril de 2011. Os tr√™s pesquisadores eram ent√£o alunos PPG em Biologia Animal quando elaboraram o material disponibilizado na apostila Estat√≠stica aplicada √† ecologia usando o R. proposta de transformar apostila em livro sempre foi um t√≥pico recorrente desde 2011, e concretizado agora, um pouco mais de 10 anos depois.Neste per√≠odo, Diogo, Fernando e Thiago foram contratados pela Universidade Federal de Mato Grosso Sul, Universidade Federal de S√£o Carlos campus Sorocaba, e Universidade Federal Rural de Pernambuco, respectivamente. Nestes anos eles ofertaram diferentes vers√µes curso Estat√≠stica aplicada √† ecologia usando o R para alunos de gradua√ß√£o e p√≥s-gradua√ß√£o em diferentes institui√ß√µes Brasil. possibilidade da oferta destes novos cursos fortaleceu ideia de transformar apostila em um livro com base nas experi√™ncias dos pesquisadores em sala de aula.Considerando que novas abordagens ecol√≥gicas v√™m sendo descritas e criadas uma taxa elevada nos √∫ltimos anos, era de se esperar que informa√ß√µes dispon√≠veis na apostila estivessem defasadas ap√≥s uma d√©cada. Por este motivo, Diogo, Fernando e Thiago convidaram outros dois pesquisadores, Gustavo B. Paterno da Georg-August-University G√∂ttingen e Maur√≠cio H. Vancine PPG em Ecologia, Evolu√ß√£o e Biodiversidade da UNESP de Rio Claro/SP, que s√£o refer√™ncias uso de estat√≠stica em ecologia usando o R. Com o time completo, passaram mais de um ano realizando reuni√µes, compartilhando scripts e pagando cerveja para os coautores por cap√≠tulos atrasados at√© chegarem nesta primeira vers√£o livro.","code":""},{"path":"cap1.html","id":"objetivo-deste-livro","chapter":"Cap√≠tulo 1 Introdu√ß√£o","heading":"1.2 Objetivo deste livro","text":"Nossa proposta com este livro √© tra√ßar o melhor caminho, pelo menos nosso ponto de vista, entre quest√µes ecol√≥gicas e os m√©todos estat√≠sticos mais robustos para test√°-las. Guiar seus passos nesse caminho (nem sempre linear) necessita que voc√™ utilize um requisito b√°sico: o de se esfor√ßar para caminhar. O nosso esfor√ßo, em contrapartida, ser√° o de indicar melhores dire√ß√µes para que voc√™ adquira certa independ√™ncia em an√°lises ecol√≥gicas. Um dos nossos objetivos √© mostrar que o conhecimento de teorias ecol√≥gicas e formula√ß√£o de quest√µes apropriadas s√£o o primeiro passo na caminhada rumo √† compreens√£o da l√≥gica estat√≠stica. N√£o deixe que estat√≠stica se torne ‚Äúpedra seu caminho.‚Äù Em nossa opini√£o, programas com ambiente de programa√ß√£o favorecem o entendimento da l√≥gica estat√≠stica, uma vez que cada passo (lembre-se de que voc√™ est√° caminhando em uma estrada desconhecida e cheia de pedras) precisa ser coordenado, ou seja, linhas de c√≥digo (detalhes abaixo) precisam ser compreendidas para que voc√™ teste suas hip√≥teses. entanto, tome cuidado ao copiar deliberadamente scripts sem entender cada um dos passos da an√°lise ou gr√°fico realizado.primeira parte deste livro pretende utilizar uma estrat√©gia que facilita escolha teste estat√≠stico apropriado, por meio da sele√ß√£o de quest√µes/hip√≥teses claras e da liga√ß√£o dessas hip√≥teses com teoria e o m√©todo (veja Figura 2.1 Cap√≠tulo 2). Enfatizamos que √© fundamental ter em mente aonde se quer chegar, para poder escolher o que deve ser feito. Posteriormente √† escolha de suas quest√µes, √© necess√°rio transferir o contexto ecol√≥gico para um contexto meramente estat√≠stico (hip√≥tese nula/alternativa). partir da defini√ß√£o de uma hip√≥tese nula, partiremos para aplica√ß√£o de cada teste estat√≠stico (de modelos lineares generalizados an√°lises multivariadas) utilizando linguagem R.Antes de detalhar cada an√°lise estat√≠stica, apresentaremos o funcionamento b√°sico da utiliza√ß√£o da linguagem R e os tipos de distribui√ß√£o estat√≠stica que s√£o essenciais para compreens√£o dos testes estat√≠sticos. Para isso, organizamos um esquema que chamamos de ‚Äúestrutura l√≥gica‚Äù que facilita compreens√£o dos passos necess√°rios para testar suas hip√≥teses (veja Figura 2.1 Cap√≠tulo 2) (Gon√ßalves-Souza, Provete, et al. 2019).","code":""},{"path":"cap1.html","id":"o-que-voc√™-n√£o-encontrar√°-neste-livro","chapter":"Cap√≠tulo 1 Introdu√ß√£o","heading":"1.3 O que voc√™ n√£o encontrar√° neste livro","text":"Aprofundamento te√≥rico, detalhes matem√°ticos e explica√ß√£o dos algoritmos s√£o informa√ß√µes que infelizmente n√£o ser√£o abordadas neste livro. O foco aqui √© explica√ß√£o de como cada teste funciona (teoria e procedimentos matem√°ticos b√°sicos) e sua aplica√ß√£o em testes ecol√≥gicos usando scripts na linguagem R. Recomendamos aos leitores () que consultem os livros indicados final deste cap√≠tulo caso desejem maior aprofundamento te√≥rico e pr√°tico.","code":""},{"path":"cap1.html","id":"por-que-usar-o-r","chapter":"Cap√≠tulo 1 Introdu√ß√£o","heading":"1.4 Por que usar o R?","text":"Os criadores R o chamam de uma linguagem e ambiente de programa√ß√£o estat√≠stica e gr√°fica (Venables Ripley 2002). linguagem R tamb√©m √© chamada de programa√ß√£o ‚Äúorientada ao objeto‚Äù (object oriented programming), o que significa que utilizar o R envolve basicamente cria√ß√£o e manipula√ß√£o de objetos em um terminal, em que o usu√°rio tem de dizer exatamente o que deseja que o programa execute, ao inv√©s de simplesmente clicar em bot√µes. E vem da√≠ uma das grandes vantagens em se usar o R: o usu√°rio tem total controle sobre o que est√° acontecendo e tamb√©m tem de compreender o que deseja antes de executar uma an√°lise. Al√©m disso, o R permite integra√ß√£o com outros programas escritos em Fortran, C++, Python e Java, permitindo que os usu√°rios possam aplicar novas metodologias sem ter que aprender novas linguagens.Na p√°gina pessoal Prof.¬†Nicolas J. Gotelli (link) existem v√°rios conselhos para um estudante iniciante de ecologia. Dentre esses conselhos, o Prof.¬†Gotelli menciona que o dom√≠nio de uma linguagem de programa√ß√£o √© uma das habilidades mais importantes, porque d√° liberdade ao ec√≥logo para executar tarefas que v√£o al√©m daquelas dispon√≠veis em pacotes estat√≠sticos comerciais. Al√©m disso, maioria das novas an√°lises propostas nos mais reconhecidos peri√≥dicos em ecologia normalmente s√£o implementadas na linguagem R, e os autores geralmente incluem o c√≥digo fonte material suplementar dos artigos, tornando an√°lise acess√≠vel e reprodut√≠vel. partir momento que essas an√°lises ficam dispon√≠veis (seja por c√≥digo fornecido pelo autor ou por implementa√ß√£o em pacotes pr√©-existentes), √© mais simples entendermos l√≥gica de an√°lises complexas, especialmente multivariadas, utilizando nossos pr√≥prios dados, realizando-passo passo. Sem utiliza√ß√£o R, normalmente temos que contatar os autores que nem sempre s√£o t√£o acess√≠veis.Especificamente em Ecologia, o uso da linguagem R para an√°lise de dados cresceu enormemente nas duas √∫ltimas d√©cadas. Em um artigo de revis√£o, Lai et al. (2019) analisaram mais de 60.000 artigos revisados por pares publicados em 30 peri√≥dicos de Ecologia durante um per√≠odo de 10 anos. O n√∫mero de estudos usando R aumentou linearmente de 11,4% em 2008 para 58,0% em 2017, e os 10 principais pacotes utilizados e ordenados por maior frequ√™ncia de uso foram: lme4, vegan, nlme, ape, MuMIn, MASS, mgcv, ade4, multcomp e car. Os autores afirmam que crescente popularidade R promoveu ci√™ncia aberta na pesquisa ecol√≥gica, melhorando reprodutibilidade das an√°lises e o fluxo de trabalho, principalmente quando scripts e c√≥digos foram inclu√≠dos e compartilhados nos artigos. Eles finalizam dizendo que partir dos resultados encontrados, linguagem R √© um componente significativo das an√°lises campo da Ecologia.Uma √∫ltima vantagem √© que por ser um software livre, cita√ß√£o R em artigos √© permitida e at√© aconselh√°vel. Para saber como citar o R, digite citation() na linha de comando. Para citar um pacote espec√≠fico, digite citation() com o nome pacote entre aspas dentro dos par√™nteses. Mais detalhes sobre cita√ß√µes podem ser vistos Cap√≠tulo 4. Neste ponto, esperamos ter convencido voc√™ leitor(), de que aprender utilizar o R tem in√∫meras vantagens. Entretanto, provavelmente vai ser dif√≠cil come√ßo, mas continue e perceber√° que o investimento vai valer √† pena futuro.","code":""},{"path":"cap1.html","id":"indo-al√©m-da-linguagem-de-programa√ß√£o-para-a-ecologia","chapter":"Cap√≠tulo 1 Introdu√ß√£o","heading":"1.5 Indo al√©m da linguagem de programa√ß√£o para a Ecologia","text":"Um ponto em comum em que todos os autores deste livro concordaram em conversas durante sua estrutura√ß√£o, foi dificuldade que todos tivemos quando est√°vamos aprendendo linguagem:Como transcrever os objetivos (manipula√ß√£o de dados, an√°lises e gr√°ficos) em linguagem RComo interpretar os resultados das an√°lises estat√≠sticas R para os objetivos ecol√≥gicosNum primeiro momento, quando estamos aprendendo linguagem R √© muito desafiador pensar em como estruturar nossos c√≥digos para que eles fa√ßam o que precisamos: importar dados, selecionar linhas ou colunas, qual pacote ou fun√ß√£o usar para uma certa an√°lise ou como fazer um gr√°fico que nas nossas anota√ß√µes s√£o simples, mas c√≥digo parece imposs√≠vel. Bem, n√£o h√° um caminho f√°cil nesse sentido e ele depende muito da experi√™ncia e familiaridade adquirida com o tempo de uso da linguagem, assim como outra l√≠ngua qualquer, como ingl√™s ou espanhol. Entretanto, uma dica pode ajudar: estruture seus c√≥digos antes de partir para o R. Por exemplo, escreva um papel os pontos que deseja executar em seus c√≥digos, como se estivesse explicando para algu√©m os passos que precisa para realizar tarefas. Depois disso, transcreva para o script (arquivo onde os c√≥digos s√£o escritos, mas n√£o se preocupe, iremos explicar esse conceito Cap√≠tulo 4) esses pontos em formato de texto. Por fim, traduza isso em linguagem R. Pode parecer ma√ßante e cansativo come√ßo, mas isso o ajudar√° ter maior dom√≠nio da linguagem, sendo que esse passo se tornar√° desnecess√°rio quando se adquire bastante experi√™ncia.Uma vez que esta barreira inicial foi transposta e voc√™ conseguiu obter os primeiros resultados de suas an√°lises com valores de estat√≠sticas, par√¢metros estimados, valores de p e R¬≤, gr√°ficos, e etc., como interpretamos √† luz da teoria ecol√≥gica? Esse ponto √© talvez um dos mais complicados. Com o tempo, ter um valor final de uma estat√≠stica ou gr√°fico √† partir da linguagem R √© relativamente simples, mas o que esse valor ou gr√°fico significam para nossa hip√≥tese ecol√≥gica √© o ponto mais complexo. Essa dificuldade por ser por inexperi√™ncia te√≥rica (ainda n√£o lemos muito sobre um aspecto ecol√≥gico) ou inexperi√™ncia cient√≠fica (ainda temos dificuldade para expandir nossos argumentos de forma indutiva). Destacamos esse ponto porque ele √© fundamental processo cient√≠fico e talvez seja o principal aspecto que diferencia os cientistas de outros profissionais: sua capacidade de entendimento dos padr√µes √† partir dos processos e mecanismos atrelados. Nesse ponto, quase sempre recorremos aos nossos orientadores ou colegas mais experientes para nos ajudar, mas √© natural e faz parte processo de aprendizado de uso da linguagem R junto √† Ecologia como Ci√™ncia. Entretanto, contrapomos import√¢ncia dessa extrapola√ß√£o para n√£o nos tornarmos apenas especialistas em linguagem R sem fundamental capacidade de entendimento sistema ecol√≥gico que estamos estudando.","code":""},{"path":"cap1.html","id":"como-usar-este-livro","chapter":"Cap√≠tulo 1 Introdu√ß√£o","heading":"1.6 Como usar este livro","text":"Os conte√∫dos apresentados em cada cap√≠tulo s√£o independentes entre si. Portanto, voc√™ pode utilizar este livro de duas formas. primeira √© seguir uma ordem sequencial (cap√≠tulos 1, 2, 3, ‚Ä¶) que recomendamos, principalmente, para pessoas que n√£o possuem familiaridade com linguagem R. segunda forma, √© selecionar o cap√≠tulo que cont√©m an√°lise de seu interesse e mudar de um cap√≠tulo para outro sem seguir sequ√™ncia apresentada livro.Com exce√ß√£o dos cap√≠tulos 2, 3, 4, 5, 6 e 15, os outros cap√≠tulos foram elaborados seguindo mesma estrutura, contendo uma descri√ß√£o da an√°lise estat√≠stica (aspectos te√≥ricos) e exemplos relacionados com quest√µes ecol√≥gicas que podem ser respondidas por esta an√°lise e exerc√≠cios. Todos os exemplos s√£o compostos por: ) uma descri√ß√£o dos dados utilizados, ii) pergunta e predi√ß√£o trabalho, iii) descri√ß√£o das vari√°veis resposta(s) e preditora(s), e iv) descri√ß√£o e explica√ß√£o das linhas de c√≥digo R necess√°rias para realiza√ß√£o das an√°lises. maioria dos exemplos utilizados s√£o baseados em dados reais que j√° foram publicados em artigos cient√≠ficos ou s√£o dados coletados por um dos autores deste livro. N√≥s recomendamos que primeiro voc√™ utilize estes exemplos para se familiarizar com an√°lises e formata√ß√£o das linhas e colunas das planilhas. Em seguida, fa√ßa os exerc√≠cios propostos final de cada cap√≠tulo, e por fim, utilize seus pr√≥prios dados para realizar an√°lises. Esta √© melhor maneira de se familiarizar com linhas de c√≥digo R. üìù Importante \nMuitas das m√©tricas ou √≠ndices apresentados neste livro n√£o foram traduzidas para o portugu√™s, porque seus acr√¥nimos s√£o cl√°ssicos e bem estabelecidos na literatura ecol√≥gica. Nestes casos, consideramos que tradu√ß√£o poderia confundir pessoas que est√£o come√ßando se familiarizar com literatura espec√≠fica. Al√©m disso, optamos por manter vers√£o padr√£o em alguns gr√°ficos utilizados nos Cap√≠tulos 7 e 15, principalmente aqueles gr√°ficos que s√£o ‚Äúoutput‚Äù de an√°lises como, por exemplo, visualiza√ß√£o de normalidade de res√≠duos, homogeneidade de vari√¢ncias, entre outros. Em geral, esses gr√°ficos s√£o usados processo de decis√£o de algum passo da an√°lise e n√£o possuem qualidade de publica√ß√£o. Como o usu√°rio vai obter o mesmo gr√°fico quando replicar an√°lises propostas aqui ou suas pr√≥prias an√°lises, julgamos ser mais did√°tico manter vers√£o original, em ingl√™s.Real√ßamos que n√£o estamos abordando todas possibilidades dispon√≠veis, e existem muitos outros pacotes e fun√ß√µes R que realizam mesmas an√°lises. Contudo, esperamos que o conte√∫do apresentado permita que os leitores() adquiram independ√™ncia e seguran√ßa para que possam caminhar sozinhos() na explora√ß√£o de novos pacotes e fun√ß√µes para responderem suas perguntas biol√≥gicas e ecol√≥gicas.","code":""},{"path":"cap1.html","id":"como-ensinar-e-aprender-com-esse-livro","chapter":"Cap√≠tulo 1 Introdu√ß√£o","heading":"1.7 Como ensinar e aprender com esse livro","text":"Uma forma bastante interessante de aprender ou aprofundar seu conhecimento sobre um tema √© partir de grupos de estudo. Aproveitando din√¢micas de estudos que os pr√≥prios autores fizeram em seus laborat√≥rios (seja como discente ou professor), sugerimos abaixo alguns formatos que podem ser usados por um grupo de discentes (sem presen√ßa de um orientador) ou pelo laborat√≥rio. √â importante ressaltar que esses formatos n√£o s√£o os √∫nicos que podem ser testados. O leitor pode juntar ideias de diferentes propostas ou mesmo usar parte das propostas e inserir suas pr√≥prias ideias, tendo como base caracter√≠sticas grupo que ir√° se reunir.","code":""},{"path":"cap1.html","id":"em-laborat√≥rios-ou-grupos-de-pesquisa","chapter":"Cap√≠tulo 1 Introdu√ß√£o","heading":"1.7.1 Em laborat√≥rios ou grupos de pesquisa","text":"L√≠der aleat√≥rioCada cap√≠tulo √© sorteado para um integrante grupo que ficar√° respons√°vel por estudar, apresentar e enviar outros materiais que julgar necess√°rio. Neste formato, existem duas possibilidades interessantes. primeira √© de um grupo de estudantes que √© iniciante em determinado tema (e.g., an√°lise multivariada) e, desse modo, todos integrantes ser√£o estimulados participarem processo de ensino e de aprendizagem. O segundo ponto interessante √© para grupos heterog√™neos onde pessoas diferentes possuem dom√≠nio de diferentes ferramentas. Neste caso, √© importante que mesmo que determinado integrante seja especialista na an√°lise X, ele poder√° aleatoriamente ter que aprender e ensinar an√°lise Y. Como resultado, espera-se que os grupos de estudo neste formato tenham ampla discuss√£o, uma vez que integrantes com baixo, m√©dio ou alto conhecimento em determinada an√°lise ser√£o tanto professores como aprendizes.L√≠der especialista (discentes como l√≠deres)Cada cap√≠tulo √© liderado pelo ‚Äúmaior especialista‚Äù naquele determinado assunto, que ficar√° respons√°vel por organizar toda din√¢mica grupo. O ideal √© que especialistas distintos liderem discuss√£o de diferentes cap√≠tulos, para que todos os membros grupo sejam l√≠deres em m√≠nimo um cap√≠tulo.L√≠der especialista II (orientador ou p√≥s-doc)O orientador (ou p√≥s-doc ou ambos) selecionam os cap√≠tulos sobre o assunto de interesse (ou todos os cap√≠tulos livro) e se re√∫ne regularmente para discuss√£o com discentes. Al√©m da leitura dos cap√≠tulos, o l√≠der pode enviar atividades extras ou desafios para estimular que os discentes leiam o conte√∫do e tamb√©m executem comandos R. Por exemplo, em cada cap√≠tulo, o desafio pode ser criar hip√≥teses sobre um tema de estudo, gerar dados fict√≠cios (ou usar dados reais dispon√≠veis) e analisar os dados com determinado teste estat√≠stico R.\nL√≠der especialista ou II integrando com teoria (espec√≠fico para cap√≠tulos 8 15):\nEsta proposta expande o L√≠der especialista uma vez que n√£o estar√° focada somente na an√°lise estat√≠stica apresentada livro. Al√©m de inserir este componente anal√≠tico, o l√≠der ir√° apresentar o arcabou√ßo te√≥rico ecol√≥gico que √© geralmente usado em estudos que utilizaram determinada an√°lise. Por exemplo, o cap√≠tulo que apresenta regress√£o linear seria combinado com teoria de biogeografia de ilhas para entender rela√ß√£o esp√©cies-√°rea. Desse modo, n√£o seria apresentado somente especificidades da regress√£o linear, mas tamb√©m teoria de biogeografia de ilhas.","code":""},{"path":"cap1.html","id":"em-disciplinas-da-gradua√ß√£o-ou-p√≥s-gradua√ß√£o","chapter":"Cap√≠tulo 1 Introdu√ß√£o","heading":"1.7.2 Em disciplinas da gradua√ß√£o ou p√≥s-gradua√ß√£o","text":"Atividade em grupo em sala invertidaO professor pode sortear diferentes grupos que ficar√£o respons√°veis por cada cap√≠tulo livro (depender conte√∫do da disciplina). Cada componente grupo pode ficar respons√°vel por diferentes partes cap√≠tulo. Por exemplo, se disciplina de gr√°ficos, um discente pode discutir estrutura das fun√ß√µes pacote ggplot2, outro discente pode apresentar conex√£o entre tipos de vari√°veis e gr√°ficos, enquanto um terceiro discente se responsabiliza por executar os comandos dos gr√°ficos R. atividades devem ser realizadas e apresentadas antes da aula te√≥rica/pr√°tica sobre aquela tem√°tica, e o docente ficar√° respons√°vel por mediar apresenta√ß√µes e discuss√µes.Sala convencionalO professor pode usar o livro como material did√°tico seguindo o conte√∫do de acordo com disciplina em quest√£o, seja ela da linguagem R, de an√°lises univariadas, multivariadas ou espaciais. Al√©m disso, o professor pode fornecer dados para os discentes (ou estimular que discentes usem os pr√≥prios dados) e replicar gr√°ficos e an√°lises usando os scripts fornecidos livro.","code":""},{"path":"cap1.html","id":"livros-que-recomendamos-para-aprofundamento-te√≥rico","chapter":"Cap√≠tulo 1 Introdu√ß√£o","heading":"1.8 Livros que recomendamos para aprofundamento te√≥rico","text":"Hands-Programming R (Grolemund 2014): Esse livro √© para quem quer se aprofundar e aprender programar em R, com exemplos pr√°ticos. Nas palavras autor, ele disse que escreveu o livro para n√£o programadores, com o intuito de fornecer uma introdu√ß√£o amig√°vel √† linguagem R. Nele, √© apresentado como carregar dados, montar e desmontar objetos de dados, navegar sistema de ambiente R, escrever fun√ß√µes e usar ferramentas de programa√ß√£o R para solu√ß√£o de problemas pr√°ticos de ci√™ncia de dados. O livro est√° dispon√≠vel nesse link.Hands-Programming R (Grolemund 2014): Esse livro √© para quem quer se aprofundar e aprender programar em R, com exemplos pr√°ticos. Nas palavras autor, ele disse que escreveu o livro para n√£o programadores, com o intuito de fornecer uma introdu√ß√£o amig√°vel √† linguagem R. Nele, √© apresentado como carregar dados, montar e desmontar objetos de dados, navegar sistema de ambiente R, escrever fun√ß√µes e usar ferramentas de programa√ß√£o R para solu√ß√£o de problemas pr√°ticos de ci√™ncia de dados. O livro est√° dispon√≠vel nesse link.R Data Science: Import, Tidy, Transform, Visualize, Model Data (Wickham & Grolemund 2017): Tamb√©m conhecido como R4DS, esse livro √© uma das primeiras refer√™ncias sobre tidyverse e de Ci√™ncia de Dados R. O livro aborda principais etapas de importa√ß√£o, convers√£o, explora√ß√£o e modelagem de dados e comunica√ß√£o dos resultados. Ele apresenta uma compreens√£o ciclo da ci√™ncia de dados, juntamente com ferramentas b√°sicas necess√°rias para gerenciar os detalhes sobre cada etapa ciclo. Cada se√ß√£o livro √© combinada com exerc√≠cios para ajudar na fixa√ß√£o conte√∫do. Os principais t√≥picos s√£o: ) transformar conjuntos de dados em um formato conveniente para an√°lise, ii) programa√ß√£o com ferramentas poderosas R para resolver problemas de dados com maior clareza e facilidade, iii) examinar os dados, gerar hip√≥teses e test√°-las rapidamente, iv) gerar modelos que forne√ßam um resumo dos dados e que capture ‚Äúsinais‚Äù conjunto de dados, e v) aprendar R Markdown para integrar texto, c√≥digo e resultados. O livro est√° dispon√≠vel nesse link.R Data Science: Import, Tidy, Transform, Visualize, Model Data (Wickham & Grolemund 2017): Tamb√©m conhecido como R4DS, esse livro √© uma das primeiras refer√™ncias sobre tidyverse e de Ci√™ncia de Dados R. O livro aborda principais etapas de importa√ß√£o, convers√£o, explora√ß√£o e modelagem de dados e comunica√ß√£o dos resultados. Ele apresenta uma compreens√£o ciclo da ci√™ncia de dados, juntamente com ferramentas b√°sicas necess√°rias para gerenciar os detalhes sobre cada etapa ciclo. Cada se√ß√£o livro √© combinada com exerc√≠cios para ajudar na fixa√ß√£o conte√∫do. Os principais t√≥picos s√£o: ) transformar conjuntos de dados em um formato conveniente para an√°lise, ii) programa√ß√£o com ferramentas poderosas R para resolver problemas de dados com maior clareza e facilidade, iii) examinar os dados, gerar hip√≥teses e test√°-las rapidamente, iv) gerar modelos que forne√ßam um resumo dos dados e que capture ‚Äúsinais‚Äù conjunto de dados, e v) aprendar R Markdown para integrar texto, c√≥digo e resultados. O livro est√° dispon√≠vel nesse link.primer ecological statistics, 2a edi√ß√£o (Gotelli & Ellison 2012): Este livro traz um apanhado geral sobre desenhos amostrais voltados para experimenta√ß√£o e uma introdu√ß√£o √† estat√≠stica multivariada. Existe uma tradu√ß√£o para o portugu√™s da primeira edi√ß√£o, chamada ‚ÄúPrinc√≠pios de Estat√≠stica em Ecologia‚Äù que saiu pela ed ArtMed em 2010. Este √© uma excelente refer√™ncia para quem quer come√ßar estudar estat√≠stica b√°sica, especialmente com aplica√ß√µes em ecologia.primer ecological statistics, 2a edi√ß√£o (Gotelli & Ellison 2012): Este livro traz um apanhado geral sobre desenhos amostrais voltados para experimenta√ß√£o e uma introdu√ß√£o √† estat√≠stica multivariada. Existe uma tradu√ß√£o para o portugu√™s da primeira edi√ß√£o, chamada ‚ÄúPrinc√≠pios de Estat√≠stica em Ecologia‚Äù que saiu pela ed ArtMed em 2010. Este √© uma excelente refer√™ncia para quem quer come√ßar estudar estat√≠stica b√°sica, especialmente com aplica√ß√µes em ecologia.Experimental Design Data Analysis Biologists (Quinn & Keough 2002): Outro execelente livro introdut√≥rio sobre estat√≠stica com exemplos pr√°ticos para ecologia e um dos preferidos dos autores deste livro aqui. Ele aborda os modelos lineares mais comuns vistos em disciplinas de bioestat√≠stica, tais como regress√£o e ANOVA, mas tamb√©m traz uma boa introdu√ß√£o sobre GLMs e m√©todos mais modernos de an√°lise de dados. Mas o mais importante, l√≥gica de ensino dos m√©todos segue muito o que preconizamos neste livro e n√£o podemos recomend√°-lo o bastante para quem est√° come√ßando estudar estat√≠stica.Experimental Design Data Analysis Biologists (Quinn & Keough 2002): Outro execelente livro introdut√≥rio sobre estat√≠stica com exemplos pr√°ticos para ecologia e um dos preferidos dos autores deste livro aqui. Ele aborda os modelos lineares mais comuns vistos em disciplinas de bioestat√≠stica, tais como regress√£o e ANOVA, mas tamb√©m traz uma boa introdu√ß√£o sobre GLMs e m√©todos mais modernos de an√°lise de dados. Mas o mais importante, l√≥gica de ensino dos m√©todos segue muito o que preconizamos neste livro e n√£o podemos recomend√°-lo o bastante para quem est√° come√ßando estudar estat√≠stica.R book, 2a edi√ß√£o (Crawley 2012): Livro que vai b√°sico ao avan√ßado, tem informa√ß√µes sobre linguagem R, estat√≠stica univariada, multivariada e modelagem. Relativamente f√°cil de compreender. Cap√≠tulos trazem fun√ß√µes para cria√ß√£o e manipula√ß√£o de gr√°ficos passo--passo.R book, 2a edi√ß√£o (Crawley 2012): Livro que vai b√°sico ao avan√ßado, tem informa√ß√µes sobre linguagem R, estat√≠stica univariada, multivariada e modelagem. Relativamente f√°cil de compreender. Cap√≠tulos trazem fun√ß√µes para cria√ß√£o e manipula√ß√£o de gr√°ficos passo--passo.Numerical ecology, 3a edi√ß√£o (Legendre & Legendre 2012): Este √© o manual te√≥rico essencial e leitura obrigat√≥ria para entender mais fundo qualquer an√°lise multivariada. Esta nova edi√ß√£o traz um cap√≠tulo novo sobre an√°lises multiescalares em ecologia de comunidade, com exemplos de aplica√ß√£o de Moran Eigenvector Maps (MEMs).Numerical ecology, 3a edi√ß√£o (Legendre & Legendre 2012): Este √© o manual te√≥rico essencial e leitura obrigat√≥ria para entender mais fundo qualquer an√°lise multivariada. Esta nova edi√ß√£o traz um cap√≠tulo novo sobre an√°lises multiescalares em ecologia de comunidade, com exemplos de aplica√ß√£o de Moran Eigenvector Maps (MEMs).Biological Diversity: Frontiers Measurement Assessment (Magurran & McGill 2012): Livro editado com v√°rios cap√≠tulos sobre medidas tradicionais e alternativas de biodiversidade. Tamb√©m atualiza medidas de estimativa de diversidade, uma revis√£o sobre diversidade funcional e filogen√©tica. Esse √© uma boa porta de entrada para entender os aspectos te√≥ricos e meandros da an√°lise de dados de biodiversidade.Biological Diversity: Frontiers Measurement Assessment (Magurran & McGill 2012): Livro editado com v√°rios cap√≠tulos sobre medidas tradicionais e alternativas de biodiversidade. Tamb√©m atualiza medidas de estimativa de diversidade, uma revis√£o sobre diversidade funcional e filogen√©tica. Esse √© uma boa porta de entrada para entender os aspectos te√≥ricos e meandros da an√°lise de dados de biodiversidade.Mixed effects models extensions ecology R (Zuur et al.¬†2009): Este continua sendo melhor introdu√ß√£o para modelos lineares generalizados (e de efeito misto), modelos de m√≠nimos quadrados generalizados, Modelos Aditivos Generalizados para bi√≥logos e ec√≥logos. O livro cont√©m v√°rios cap√≠tulos em que o funcionamento dos modelos √© explicado de maneira bastante atraente, mantendo matem√°tica m√≠nimo. Todos os exemplos s√£o com dados reais produzidor por ec√≥logos. Este √© um bom livro intermedi√°rio para quem quer se aprofundar nas an√°lises mais modernas feitas em ecologia.Mixed effects models extensions ecology R (Zuur et al.¬†2009): Este continua sendo melhor introdu√ß√£o para modelos lineares generalizados (e de efeito misto), modelos de m√≠nimos quadrados generalizados, Modelos Aditivos Generalizados para bi√≥logos e ec√≥logos. O livro cont√©m v√°rios cap√≠tulos em que o funcionamento dos modelos √© explicado de maneira bastante atraente, mantendo matem√°tica m√≠nimo. Todos os exemplos s√£o com dados reais produzidor por ec√≥logos. Este √© um bom livro intermedi√°rio para quem quer se aprofundar nas an√°lises mais modernas feitas em ecologia.Geocomputation R (Lovelace et al.¬†2020): Esse livro tornou-se rapidamente principal refer√™ncia sobre manipula√ß√£o, visualiza√ß√£o, an√°lise e modelagem de dados geoespaciais R. O livro √© dividido em tr√™s partes: ) fundamentos, ii) extens√µes e iii) aplica√ß√µes. parte um √© voltada para fundamenta√ß√£o dos dados geogr√°ficos R, descrevendo natureza dos conjuntos de dados espaciais e m√©todos para manipul√°-los, assim como importa√ß√£o/exporta√ß√£o de dados geogr√°ficos e transforma√ß√£o de sistemas de refer√™ncia de coordenadas. Parte II representa m√©todos que se baseiam nessas funda√ß√µes, abrange cria√ß√£o de mapas avan√ßados (incluindo mapeamento da web), ‚Äúpontes‚Äù para GIS, compartilhamento de c√≥digo reproduz√≠vel e como fazer valida√ß√£o cruzada na presen√ßa de autocorrela√ß√£o espacial. Parte III aplica o conhecimento adquirido para resolver problemas mundo real, incluindo representa√ß√£o e modelagem de sistemas de transporte, localiza√ß√£o ideal para lojas ou servi√ßos e modelagem ecol√≥gica. Os exerc√≠cios final de cada cap√≠tulo fornecem habilidades necess√°rias para lidar com uma s√©rie de problemas geoespaciais. solu√ß√µes para cada cap√≠tulo e materiais complementares est√£o dispon√≠veis nesse link e o livro nesse link.Geocomputation R (Lovelace et al.¬†2020): Esse livro tornou-se rapidamente principal refer√™ncia sobre manipula√ß√£o, visualiza√ß√£o, an√°lise e modelagem de dados geoespaciais R. O livro √© dividido em tr√™s partes: ) fundamentos, ii) extens√µes e iii) aplica√ß√µes. parte um √© voltada para fundamenta√ß√£o dos dados geogr√°ficos R, descrevendo natureza dos conjuntos de dados espaciais e m√©todos para manipul√°-los, assim como importa√ß√£o/exporta√ß√£o de dados geogr√°ficos e transforma√ß√£o de sistemas de refer√™ncia de coordenadas. Parte II representa m√©todos que se baseiam nessas funda√ß√µes, abrange cria√ß√£o de mapas avan√ßados (incluindo mapeamento da web), ‚Äúpontes‚Äù para GIS, compartilhamento de c√≥digo reproduz√≠vel e como fazer valida√ß√£o cruzada na presen√ßa de autocorrela√ß√£o espacial. Parte III aplica o conhecimento adquirido para resolver problemas mundo real, incluindo representa√ß√£o e modelagem de sistemas de transporte, localiza√ß√£o ideal para lojas ou servi√ßos e modelagem ecol√≥gica. Os exerc√≠cios final de cada cap√≠tulo fornecem habilidades necess√°rias para lidar com uma s√©rie de problemas geoespaciais. solu√ß√µes para cada cap√≠tulo e materiais complementares est√£o dispon√≠veis nesse link e o livro nesse link.Recomendamos ainda para o amadurecimento em an√°lises ecol√≥gicas seguintes leituras: Manly (1991), Pinheiro Bates (2000), Scheiner Gurevitch (2001), K. P. Burnham Anderson (2014), Venables Ripley (2002), Zar (2010), . F. Zuur, Ieno, Smith (2007), G. James et al. (2013), Fox, Negrete-Yankelevich, Sosa (2015), Thioulouse et al. (2018) e Touchon (2021).","code":""},{"path":"cap2.html","id":"cap2","chapter":"Cap√≠tulo 2 Voltando ao b√°sico: como dominar a arte de fazer perguntas cientificamente relevantes","heading":"Cap√≠tulo 2 Voltando ao b√°sico: como dominar a arte de fazer perguntas cientificamente relevantes","text":"Cap√≠tulo originalmente publicado por Gon√ßalves-Souza, Provete, Garey, da Silva & Albuquerque (2019), Methods Techniques Ethnobiology Ethnoecology (publica√ß√£o autorizada por Springer, licen√ßa 5230220198680).","code":""},{"path":"cap2.html","id":"introdu√ß√£o","chapter":"Cap√≠tulo 2 Voltando ao b√°sico: como dominar a arte de fazer perguntas cientificamente relevantes","heading":"2.1 Introdu√ß√£o","text":"Aquele que ama pr√°tica sem teoria √© como um marinheiro que embarca em um barco sem um leme e uma b√∫ssola e nunca sabe onde pode atracar - Leonardo da Vinci.Qual √© sua pergunta? Talvez esta seja frase que pesquisadores mais jovens ouvem quando come√ßam suas atividades cient√≠ficas. Apesar de aparentemente simples, responder esta pergunta se torna um dos maiores desafios da forma√ß√£o cient√≠fica. Seja na pesquisa quantitativa ou qualitativa, todo processo de busca de conhecimento parte de uma quest√£o/problema formulada pelo pesquisador in√≠cio desse processo. Esta quest√£o guiar√° o pesquisador em todas etapas da pesquisa. caso espec√≠fico de pesquisa quantitativa, quest√£o √© porta de entrada de uma das formas mais poderosas de pensar cientificamente: o m√©todo hipot√©tico-dedutivo (MHD) definido por Karl Popper (1959). Este cap√≠tulo prop√µe uma maneira de pensar sobre hip√≥teses (geradas dentro MHD) para melhorar o pensamento estat√≠stico usando um fluxograma que relaciona vari√°veis por liga√ß√µes causais. Al√©m disso, argumentamos que voc√™ pode facilmente usar fluxogramas para: ) identificar vari√°veis relevantes e como elas afetam umas √†s outras; ii) melhorar (quando necess√°rio) o desenho experimental/observacional; iii) facilitar escolha de an√°lises estat√≠sticas; e iv) melhorar interpreta√ß√£o e comunica√ß√£o dos dados e an√°lises.","code":""},{"path":"cap2.html","id":"perguntas-devem-preceder-as-an√°lises-estat√≠sticas","chapter":"Cap√≠tulo 2 Voltando ao b√°sico: como dominar a arte de fazer perguntas cientificamente relevantes","heading":"2.2 Perguntas devem preceder as an√°lises estat√≠sticas","text":"","code":""},{"path":"cap2.html","id":"um-besti√°rioperguntas_ecologia-1-para-o-teste-de-hip√≥teses-voc√™-est√°-fazendo-a-pergunta-certa","chapter":"Cap√≠tulo 2 Voltando ao b√°sico: como dominar a arte de fazer perguntas cientificamente relevantes","heading":"2.2.1 Um besti√°rio1 para o teste de hip√≥teses (Voc√™ est√° fazendo a pergunta certa?)","text":"maioria dos alunos e professores de ci√™ncias biol√≥gicas possuem avers√£o √† palavra ‚Äúestat√≠stica.‚Äù N√£o surpreendentemente, enquanto maioria das disciplinas acad√™micas que comp√µem o ‚ÄúSTEM‚Äù (termo em ingl√™s para aglomerar Ci√™ncia, Tecnologia, Engenharia e Matem√°tica) t√™m uma s√≥lida forma√ß√£o estat√≠stica durante gradua√ß√£o, cursos de ci√™ncias biol√≥gicas t√™m um curr√≠culo fraco ao integrar o pensamento estat√≠stico dentro de um contexto biol√≥gico (Metz 2008). Esses cursos t√™m sido frequentemente ministrados sem qualquer abordagem pr√°tica para integrar os alunos em uma plataforma de solu√ß√£o de problemas (Horgan et al. 1999). Infelizmente, Etnobiologia, Ecologia e Conserva√ß√£o (daqui em diante EEC) n√£o s√£o exce√ß√µes. Talvez mais importante, uma grande preocupa√ß√£o durante o treinamento estat√≠stico de estudantes de EEC √© necessidade de trabalhar com problemas complexos e multidimensionais que exigem solu√ß√µes anal√≠ticas ainda mais complicadas para um p√∫blico sem experi√™ncia em estat√≠stica e matem√°tica. Por este motivo, muitos pesquisadores consideram estat√≠stica como parte mais problem√°tica de sua pesquisa cient√≠fica. Argumentamos neste cap√≠tulo que dificuldade de usar estat√≠stica em EEC est√° associada √† aus√™ncia de uma plataforma de solu√ß√£o de problemas gerando hip√≥teses claras que s√£o derivadas de uma teoria. entanto, concordamos que h√° um grande desafio em algumas disciplinas como Etnobiologia para integrar esta abordagem direcionada por hip√≥teses, uma vez que foi introduzida apenas recentemente (veja Phillips Gentry 1993; Albuquerque Hanazaki 2009). Devido √† falta de uma plataforma de solu√ß√£o de problemas, frequentemente percebemos que alunos/pesquisadores na EEC geralmente t√™m dificuldades de responder perguntas b√°sicas para uma pesquisa cient√≠fica, tais como:Qual √© principal teoria ou racioc√≠nio l√≥gico seu estudo?Qual √© quest√£o principal seu estudo?Qual √© sua hip√≥tese? Quais s√£o suas predi√ß√µes?Qual √© unidade amostral, vari√°vel independente e dependente seu trabalho? Existe alguma covari√°vel?Qual √© o grupo controle?Como selecionar qualquer teste estat√≠stico sem responder essas cinco perguntas? estrutura estat√≠stica frequentista fornece uma maneira de ir progressivamente suportando ou falseando uma hip√≥tese (Neyman Pearson 1933; Popper 1959). decis√£o de rejeitar uma hip√≥tese nula √© feita usando um valor de probabilidade (geralmente P < 0,05) calculado pela compara√ß√£o de eventos observados com observa√ß√µes repetidas obtidas partir de uma distribui√ß√£o nula.Agora, vamos ensinar atrav√©s de um exemplo e apresentar um ‚Äúguia para o pensamento estat√≠stico‚Äù que conecta alguns elementos essenciais para executar qualquer an√°lise multivariada (ou univariada) (Figura 2.1. Primeiro, imagine que voc√™ observou os seguintes fen√¥menos na natureza: ) ‚Äúindiv√≠duos de uma popula√ß√£o tradicional selecionar algumas plantas para fins m√©dicos‚Äù e ii) ‚Äúmanchas monodominantes da √°rvore Prosopis juliflora, uma esp√©cie invasora em v√°rias regi√µes.‚Äù lado da etnobiologia, para entender como e porque o conhecimento tradicional √© constru√≠do, existe uma teoria ou hip√≥tese (por exemplo, hip√≥tese de apar√™ncia: Gon√ßalves, Albuquerque, Medeiros (2016)) explicando os principais processos que ditam sele√ß√£o da planta (Figura 2.1a). Ent√£o, voc√™ pode fazer uma ou mais perguntas relacionadas √†quele fen√¥meno observado (Figura 2.1b). Por exemplo, como urbaniza√ß√£o afeta o conhecimento das pessoas sobre o uso de plantas medicinais em diferentes biomas? lado ecol√≥gico/conserva√ß√£o, para entender por que esp√©cies introduzidas afetam esp√©cies nativas locais, voc√™ precisa entender teorias nicho ecol√≥gico e evolutiva (MacDougall, Gilbert, Levine 2009; Saul Jeschke 2015). Voc√™ pode perguntar, por exemplo, como plantas ex√≥ticas afetam estrutura de comunidades de plantas nativas? Quest√µes complexas ou vagas dificultam constru√ß√£o fluxograma de pesquisa (ver descri√ß√£o abaixo) e sele√ß√£o de testes estat√≠sticos. Em vez disso, uma pergunta √∫til deve indicar vari√°veis relevantes seu estudo, como independentes e dependentes, covari√°veis, unidade amostral e escala espacial de interesse (Figura 2.1b). exemplo etnobiol√≥gico fornecido, urbaniza√ß√£o e o conhecimento das pessoas s√£o vari√°veis independentes e dependentes, respectivamente. Al√©m disso, este estudo tem uma escala ampla, pois compara biomas diferentes. pr√≥xima etapa √© construir hip√≥tese biol√≥gica (Figura 2.1c), que indicar√° associa√ß√£o entre vari√°veis independentes e dependentes. exemplo etnobiol√≥gico, hip√≥tese √© que ) ‚Äúurbaniza√ß√£o afeta o conhecimento das pessoas sobre o uso de plantas medicinais,‚Äù enquanto hip√≥tese ecol√≥gica √© que ii) ‚Äúesp√©cies ex√≥ticas afetam estrutura de comunidades de plantas nativas.‚Äù Observe que isso √© muito semelhante √† quest√£o principal. Mas voc√™ pode ter m√∫ltiplas hip√≥teses (Platt 1964) derivado de uma teoria. Depois de selecionar hip√≥tese biol√≥gica (ou cient√≠fica), √© hora de pensar sobre deriva√ß√£o l√≥gica da hip√≥tese, que √© chamada de predi√ß√£o ou previs√£o (Figura 2.1d). Os padr√µes preditos s√£o uma etapa muito importante, pois ap√≥s defini-los voc√™ pode operacionalizar suas vari√°veis e visualizar seus dados. Por exemplo, vari√°vel te√≥rica ‚ÄúUrbaniza√ß√£o‚Äù pode ser medida como ‚Äúgrau de urbaniza√ß√£o ao longo das √°reas urbanas, periurbanas e rurais‚Äù e ‚Äúconhecimento das pessoas‚Äù como ‚Äúo n√∫mero e tipo de esp√©cies de plantas √∫teis usadas para diferentes doen√ßas.‚Äù Assim, predi√ß√£o √© que o grau de urbaniza√ß√£o diminua o n√∫mero e tipo de esp√©cies de plantas conhecidas utilizadas para fins medicinais. exemplo ecol√≥gico, vari√°vel ‚Äúesp√©cies ex√≥ticas‚Äù pode ser medida como ‚Äúdensidade da planta ex√≥tica Prosopis juliflora‚Äù e ‚ÄúEstrutura da comunidade‚Äù como ‚Äúriqueza e composi√ß√£o de esp√©cies nativas.‚Äù Depois de operacionalizar o seu trabalho √† luz m√©todo hipot√©tico-dedutivo (HDM), o pr√≥ximo passo √© ‚Äúpensar estatisticamente‚Äù sobre hip√≥tese biol√≥gica formulada (ver Figura 2.1e, f). Veja tamb√©m Figura 1 em Underwood (1997), Figura 1 em Ford (2000) e Figura 1.3 em Legendre & Legendre (2012).\nFigura 2.1: Um guia para o pensamento estat√≠stico combinando o m√©todo hipot√©tico-dedutivo (‚Äì d, ) e estat√≠stica frequentista (e ‚Äì ).\nEnt√£o, voc√™ precisa definir hip√≥teses estat√≠sticas nula (H0) e alternativa (H1). Duas ‚Äúhip√≥teses estat√≠sticas‚Äù diferentes podem ser derivadas de uma hip√≥tese biol√≥gica (Figura 2.1e). Portanto, n√≥s usamos o termo ‚Äúhip√≥tese estat√≠stica‚Äù entre aspas, porque chamadas hip√≥teses estat√≠sticas s√£o predi√ß√µes sensu stricto, e muitas vezes confundem jovens estudantes. hip√≥tese estat√≠stica nula representa uma aus√™ncia de rela√ß√£o entre vari√°veis independentes e dependentes. Depois de definir hip√≥tese estat√≠stica nula, voc√™ pode derivar uma ou v√°rias hip√≥teses estat√≠sticas alternativas, que demonstram (s) associa√ß√£o(√µes) esperada(s) entre suas vari√°veis (Figura 2.1e). Em nosso exemplo, hip√≥tese nula √© que ‚Äúo grau de urbaniza√ß√£o n√£o afeta o n√∫mero de esp√©cies de plantas √∫teis conhecidas pela popula√ß√£o local.‚Äù Por sua vez, hip√≥tese alternativa √© que ‚Äúo grau de urbaniza√ß√£o afeta o n√∫mero de esp√©cies de plantas √∫teis conhecidas pela popula√ß√£o local.‚Äù Depois de operacionalizar suas vari√°veis e definir o valor nulo e hip√≥teses alternativas, √© hora de visualizar o resultado esperado (Figura 2.2, Caixa 1) e escolher um m√©todo estat√≠stico adequado. Por exemplo, se voc√™ deseja comparar diferen√ßa na composi√ß√£o de plantas √∫teis entre √°reas urbanas, periurbanas e rurais, voc√™ pode executar uma PERMANOVA (Gon√ßalves-Souza, Garey, et al. 2019) que usa uma estat√≠stica de teste chamada pseudo-F. Ent√£o, voc√™ deve escolher o limite de probabilidade (o valor P) teste estat√≠stico para decidir se hip√≥tese nula deve ou n√£o deve ser rejeitada (Gotelli Ellison 2012). Se voc√™ encontrar um P < 0,05, voc√™ deve rejeitar hip√≥tese estat√≠stica nula (urbaniza√ß√£o n√£o afeta o n√∫mero e composi√ß√£o das plantas). Por outro lado, um P > 0,05 indica que voc√™ n√£o pode rejeitar hip√≥tese nula estat√≠stica. Assim, estat√≠stica teste e o valor P representam √∫ltima parte teste de hip√≥tese estat√≠stica, que √© decis√£o e conclus√µes apropriadas que ser√£o usadas para retroalimentar teoria principal (Figura 2.1g ‚Äì ). Generalizando seus resultados e falseando (ou n√£o) suas hip√≥teses, o estudo busca refinar constru√ß√£o conceitual da teoria, que muda constantemente (Figura 1i, Ford 2000). entanto, h√° um ponto cr√≠tico nesta √∫ltima frase, porque signific√¢ncia estat√≠stica n√£o significa necessariamente relev√¢ncia biol√≥gica [ver discuss√£o em Gotelli e Ellison (2012) e Mart√≠nez-Abra√≠n (2008). Nas palavras de Ford (2000): ‚Äúestat√≠sticas s√£o usadas para iluminar o problema, e n√£o para apoiar uma posi√ß√£o.‚Äù Al√©m disso, o procedimento de teste de hip√≥tese tem alguma incerteza, que pode influenciar resultados ‚Äúfalso-positivos‚Äù (erro tipo 1) e ‚Äúfalso-negativos‚Äù (erro tipo 2) (Whitlock Schluter 2015). Para simplificar, n√£o discutiremos em detalhes os pr√≥s e contras da estat√≠stica frequentista, bem como m√©todos alternativos (por exemplo, Bayesiano e M√°xima Verossimilhan√ßa), e quest√µes filos√≥ficas relativas ao ‚Äúvalor P‚Äù (para uma discuss√£o sobre esses t√≥picos, consulte o f√≥rum em Ellison et al. 2014).Caixa 1. Tipo de vari√°veis e visualiza√ß√£o de dados. Conforme descrito na Se√ß√£o 2.3, o fluxograma √© essencial para conectar vari√°veis relevantes para pesquisa. Para aproveitar ao m√°ximo esta abordagem, voc√™ pode desenhar suas pr√≥prias predi√ß√µes gr√°ficas para te ajudar pensar sobre diferentes possibilidades anal√≠ticas. Aqui, n√≥s fornecemos uma descri√ß√£o completa dos tipos de vari√°veis que voc√™ deve saber antes de executar qualquer an√°lise estat√≠stica e representar seus resultados. Al√©m disso, mostramos uma breve galeria (Figura 2.2) com exemplos de boas pr√°ticas em visualiza√ß√£o de dados (Figura 2.3b, veja tamb√©m figuras em Gon√ßalves-Souza, Garey, et al. 2019). Al√©m de conectar diferentes vari√°veis fluxograma, voc√™ deve distinguir o tipo de vari√°vel. Primeiro voc√™ deve identificar vari√°veis independentes (tamb√©m conhecidos como explicativas ou preditoras) e dependentes (tamb√©m conhecidas como resposta). vari√°vel independente √© aquela (ou aquelas) que prev√™ ou afeta vari√°vel resposta (por exemplo, fertilidade solo √© vari√°vel independente capaz de afetar abund√¢ncia de uma esp√©cie de planta focal, vari√°vel dependente). Al√©m disso, uma covari√°vel √© uma vari√°vel cont√≠nua que pode afetar tanto vari√°vel resposta quanto independente (ou ambos), mas geralmente n√£o √© interesse pesquisador. Depois de definir vari√°veis relevantes, conectando-fluxograma, √© hora de diferenciar seu tipo: ) quantitativa ou cont√≠nua, e ii) categ√≥rica ou qualitativa (Figura 2.2, Caixa 1). O tipo de vari√°vel ir√° definir que tipo de figura voc√™ pode selecionar. Por exemplo, se voc√™ est√° comparando duas vari√°veis cont√≠nuas ou uma vari√°vel cont√≠nua e uma bin√°ria, melhor maneira de visualiz√°-los (Figura 2.2) √© um gr√°fico de dispers√£o (Figura 2.2). linha representa os valores preditos pelo modelo estat√≠stico usado (por exemplo, linear ou log√≠stico). Se voc√™ est√° interessado em comparar gama de diferentes atributos (ou descri√ß√£o de qualquer vari√°vel num√©rica) entre vari√°veis categ√≥ricas (por exemplo, esp√©cies ou popula√ß√µes locais), um gr√°fico de halteres (ingl√™s Dumbbell plot) √© uma boa op√ß√£o (Figura 2.2). Histogramas tamb√©m podem ser usados para mostrar distribui√ß√£o de duas vari√°veis cont√≠nuas de dois grupos ou fatores (Figura 2.2). entanto, se voc√™ quiser testar o efeito de uma vari√°vel categ√≥rica independente (como em um desenho de ANOVA) sobre uma vari√°vel dependente, boxplots (Figura 2.2) ou gr√°ficos de violino podem resumir essas rela√ß√µes de maneira elegante. Conjuntos de dados multivariados, por sua vez, podem ser visualizados com ordena√ß√£o (Figura 2.2) ou gr√°ficos de agrupamento (n√£o mostrados). Existe um site abrangente apresentando v√°rias maneiras de visualizar dados chamado datavizproject.\nFigura 2.2: () Tipos de vari√°veis e (B) visualiza√ß√£o de dados para representar rela√ß√£o entre vari√°veis independentes e dependentes ou covari√°veis.\n","code":""},{"path":"cap2.html","id":"fluxograma-conectando-vari√°veis-para-melhorar-o-desenho-experimental-e-as-an√°lises-estat√≠sticas","chapter":"Cap√≠tulo 2 Voltando ao b√°sico: como dominar a arte de fazer perguntas cientificamente relevantes","heading":"2.3 Fluxograma: Conectando vari√°veis para melhorar o desenho experimental e as an√°lises estat√≠sticas","text":"McIntosh e Pontius (2017) afirmaram que o pensamento estat√≠stico (representado na Figura 2.1 inclui quatro etapas importantes: ) quais perguntas voc√™ investigaria (Se√ß√£o 2.4), ii) como e onde coletar os dados (Ruxton Colegrave 2016), iii) quais fatores devem ser considerados e como eles afetam suas vari√°veis de interesse (e como elas afetam umas √†s outras), e iv) qual an√°lise estat√≠stica voc√™ deve usar e como interpretar e comunicar os resultados (Se√ß√£o 2.4). entanto, etapa (3) deve ser feita antes de coletar os dados. Por exemplo, se voc√™ est√° interessado na investiga√ß√£o dos benef√≠cios das matas ciliares para esp√©cies nativas de peixes, quais vari√°veis devem ser inclu√≠das estudo? Se voc√™ escolher rios com e sem mata ciliar como √∫nica vari√°vel preditora, seu projeto de amostragem ir√° omitir outras vari√°veis de confus√£o, como ordem rio e carbono org√¢nico solo montante. Vellend (2016) nomeou este problema como o ‚Äúproblema de tr√™s caixas‚Äù (ver tamb√©m Ruxton Colegrave 2016), que se refere √† limita√ß√£o em inferir que X (vari√°vel independente) causa varia√ß√£o em Y (vari√°vel depende) quando outras vari√°veis criam ou ampliam correla√ß√£o entre X e Y (ver Figura 2 em Ruxton Colegrave 2016). Uma ferramenta √∫til para compreender rela√ß√£o entre todas vari√°veis relevantes seu estudo √© um fluxograma. ‚Äúfluxograma de pesquisa‚Äù (ver tamb√©m Magnusson MouraÃÉo 2004) proposto aqui, vari√°veis dependentes (tamb√©m conhecidas como resposta) e independentes (ou preditora), bem como covari√°veis s√£o representadas como caixas (com formas distintas: Figura 2.3). Al√©m disso, voc√™ pode usar uma seta para representar uma (poss√≠vel) via causal indicando for√ßa e sinal (positivo ou negativo) da vari√°vel preditora na vari√°vel dependente (Figura 2.3). Ao fazer isso, voc√™ pode melhorar o desenho experimental ou observacional incluindo ou controlando vari√°veis de confus√£o o que, por sua vez, pode ajudar separar contribui√ß√£o relativa de diferentes vari√°veis preditoras em seu sistema. Mais importante, fazer conex√µes entre vari√°veis melhora sua capacidade de visualizar o ‚ÄúQuadro geral‚Äù de sua pesquisa, o que pode afetar seu experimento, an√°lise estat√≠stica e revis√£o da literatura. Na verdade, Arlidge et al. (2017) argumentam que fluxogramas facilitam constru√ß√£o de narrativas, melhorando: ) defini√ß√£o de m√∫ltiplas hip√≥teses, ii) coleta, interpreta√ß√£o e dissemina√ß√£o de dados e iii) comunica√ß√£o conte√∫do estudo. Voc√™ tamb√©m pode ler os livros de Magnusson et al. (2004) para entender mais como usar fluxogramas para auxiliar an√°lises estat√≠sticas e Ford (2000) que recomenda o uso de uma abordagem anal√≠tica para fomentar o desenvolvimento da pesquisa. Al√©m disso, o fluxograma de pesquisa pode ser usado como uma ferramenta forte para contemplar os conselhos de Ford (2000), que foram: ) definir pergunta da pesquisa, ii) definir teoria ser usada, iii) definir t√©cnica de investiga√ß√£o (por exemplo, experimento, observa√ß√£o de campo), iv) definir medi√ß√µes, v) definir como fazer infer√™ncia, e vi) interpretar, generalizar e sintetizar partir de dados que, por sua vez, s√£o usados para refinar teoria e modificar (quando necess√°rio) quest√µes futuras (Fig. 2.1).\nFigura 2.3: Exemplo de como usar um fluxograma para melhorar o entendimento sistema estudado. pergunta te√≥rica ‚ÄúQual √© o impacto da invas√£o na comunidade nativa e nas propriedades ecossistema?‚Äù pode gerar duas predi√ß√µes: ) planta ex√≥tica Prosopis juliflora reduz diversidade beta de comunidades de plantas nativas, e ii) Prosopis juliflora modifica composi√ß√£o das comunidades de plantas e reduz o estoque de carbono e taxas de decomposi√ß√£o. Ap√≥s selecionar suas predi√ß√µes, voc√™ pode construir um fluxograma conectando vari√°veis relevantes e associa√ß√µes entre elas. Al√©m disso, voc√™ pode usar informa√ß√µes na Caixa 1 para identificar que tipo de vari√°vel voc√™ ir√° coletar e quais figuras podem ser usadas (b).\n","code":""},{"path":"cap2.html","id":"quest√µes-fundamentais-em-etnobiologia-ecologia-e-conserva√ß√£o","chapter":"Cap√≠tulo 2 Voltando ao b√°sico: como dominar a arte de fazer perguntas cientificamente relevantes","heading":"2.4 Quest√µes fundamentais em etnobiologia, ecologia e conserva√ß√£o","text":"teorias s√£o generaliza√ß√µes. teorias cont√™m perguntas. Para algumas teorias, perguntas s√£o expl√≠citas e representam o que teoria pretende explicar. Para outras, quest√µes s√£o impl√≠citas e se relacionam com quantidade e tipo de generaliza√ß√£o, dada escolha de m√©todos e exemplos usados por pesquisadores na constru√ß√£o da teoria. teorias mudam continuamente, √† medida que exce√ß√µes s√£o encontradas √†s suas generaliza√ß√µes e como quest√µes impl√≠citas sobre m√©todo e op√ß√µes de estudos s√£o expostas. - E. David Ford (2000)Como argumentamos antes, uma quest√£o relevante e test√°vel precede an√°lises estat√≠sticas. Assim, apresentamos seguir 12 quest√µes que podem estimular pesquisas futuras na ECC. Observe, entanto, que n√£o queremos dizer que eles s√£o √∫nicas quest√µes relevantes serem testadas na EEC - ver, por exemplo, Sutherland et al. (2013) para uma avalia√ß√£o completa da pesquisa de ponta em Ecologia; e Caixa 6.1 em Pickett et al. (2007)2. Especificamente, essas quest√µes s√£o muito amplas e podem ser desenvolvidas em perguntas, hip√≥teses e predi√ß√µes mais restritas. Depois de cada quest√£o te√≥rica, apresentamos um estudo que testou essas hip√≥teses bem como vari√°veis relevantes que podem estimular estudos futuros.Como o uso da terra afeta manuten√ß√£o da biodiversidade e distribui√ß√£o de esp√©cies em diferentes escalas espaciais?Exemplo: V√°rios estudos em diferentes ecossistemas e escalas investigaram como o uso da terra afeta biodiversidade. entanto, destacamos um estudo comparando os efeitos globais uso da terra (por exemplo, densidade populacional humana, paisagem para usos humanos, tempo desde convers√£o da floresta) em esp√©cies terrestres (por exemplo, mudan√ßa l√≠quida na riqueza local, dissimilaridade composicional m√©dia) (Newbold et al. 2015).Qual √© o impacto da invas√£o bi√≥tica nas comunidades nativas e propriedades ecossistema?Exemplo: Investigar como o estabelecimento de esp√©cies ex√≥ticas afetam riqueza de esp√©cies receptor, comunidades nativas, bem como isso afeta entrega dos servi√ßos ecossist√™micos. Estudos anteriores controlaram presen√ßa de esp√©cies invasoras ou registros hist√≥ricos comparados (estudos observacionais) dessas esp√©cies e como elas impactam biodiversidade. Al√©m disso, h√° algum esfor√ßo em compreender os preditores de invasibilidade (por exemplo, produto interno bruto de regi√µes, densidade populacional humana, litoral continental e ilhas) (Dawson et al. 2017).Como o decl√≠nio predador de topo afeta entrega de servi√ßos ecossist√™micos?Exemplo: Investigar como remo√ß√£o de grandes carn√≠voros afeta o fornecimento de servi√ßos ecossist√™micos, como o sequestro de carbono, doen√ßas e controle de danos √†s colheitas. Estudos anteriores investigaram esta quest√£o controlando presen√ßa de predadores de topo ou comparando registros hist√≥ricos (estudo observacionais) de esp√©cies e v√°rios preditores (por exemplo, perda e fragmenta√ß√£o de habitat, conflito entre humanos e esp√©cies ca√ßadas, utiliza√ß√£o para medicina tradicional e superexplora√ß√£o de presas) (Ripple et al. 2014).Como acidifica√ß√£o dos oceanos afeta produtividade prim√°ria e teias alimentares em ecossistemas marinhos?Exemplo: Estudos recentes testaram os efeitos individuais e interativos da acidifica√ß√£o e aquecimento oceano nas intera√ß√µes tr√≥ficas em uma teia alimentar. acidifica√ß√£o e o aquecimento foram manipulados pela mudan√ßa dos n√≠veis de CO2 e temperatura, respectivamente. Estudos anteriores demonstraram que eleva√ß√£o de CO2 e temperatura aumentou produtividade prim√°ria e afetou for√ßa controle de cima para baixo exercido por predadores (Goldenberg et al. 2017).Como podemos reconciliar necessidades da sociedade por recursos naturais com conserva√ß√£o da Natureza?Exemplo: Existe uma literatura crescente usando abordagens de paisagem para melhorar gest√£o da terra para reconciliar conserva√ß√£o e desenvolvimento econ√¥mico. Os estudos possuem diversos objetivos, mas em geral eles usaram o engajamento das partes interessadas, apoio institucional, estruturas eficazes de governan√ßa como vari√°veis preditoras e melhorias ambientais (por exemplo, conserva√ß√£o solo e da √°gua, cobertura vegetal) e socioecon√¥micas (renda, capital social, sa√∫de p√∫blica, emprego) como vari√°veis dependentes (Reed et al. 2017).Qual √© o papel das √°reas protegidas (UCs) para manuten√ß√£o da biodiversidade e dos servi√ßos ecossist√™micos?Exemplo: Houve um trabalho consider√°vel na √∫ltima d√©cada comparando efic√°cia das UCs para conserva√ß√£o da biodiversidade. Embora esta quest√£o n√£o esteja completamente separada da quest√£o anterior, o desenho dos estudos √© relativamente distinto. Em geral, os pesquisadores contrastam o n√∫mero de esp√©cies e o fornecimento de servi√ßos ecossist√™micos (por exemplo, reten√ß√£o de √°gua e solo, sequestro de carbono) entre √°reas legalmente protegidas (UCs) e n√£o protegidas (Xu et al. 2017).Como integrar o conhecimento cient√≠fico e das pessoas locais para mitigar os impactos negativos das mudan√ßas clim√°ticas e uso da terra na biodiversidade?Exemplo: Eventos clim√°ticos extremos podem ter forte impacto sobre rendimento agr√≠cola e produ√ß√£o de alimentos. Autores recentes t√™m argumentado que esse efeito pode ser mais forte para os pequenos agricultores. Estudos futuros podem investigar como precipita√ß√£o e temperatura afetam o rendimento agr√≠cola e como os agricultores tradicionais ou ind√≠genas lidam com esse impacto negativo. Sistemas de agricultura tradicional t√™m menor eros√£o solo e emiss√µes de N2O / CO2 que monoculturas e, portanto, podem ser vistos como uma atividade de mitiga√ß√£o vi√°vel em um mundo em constante mudan√ßa (Niggli et al. 2009; Altieri Nicholls 2017).Como mudan√ßas clim√°ticas afetam resili√™ncia e estrat√©gias adaptativas em sistemas socioecol√≥gicos?Exemplo: mudan√ßa clima altera tanto pesca quanto agricultura em todo o mundo, o que por sua vez obriga os humanos mudar suas estrat√©gias de cultivo. Estudos recentes t√™m argumentado que agricultura em alguns pa√≠ses enfrentar√° riscos com mudan√ßas clim√°ticas. Esses estudos comparam diferentes sistemas de produ√ß√£o, de agricultura convencional outros tipos empregados por popula√ß√µes locais. Por exemplo, h√° uma forte conex√£o entre ) esp√©cies amea√ßadas e sobrepesca, ii) √≠ndice de desenvolvimento humano (IDH) e depend√™ncia m√©dia da pesca e aquicultura. Al√©m disso, h√° evid√™ncias de que biodiversidade pode amortecer os impactos das mudan√ßas clim√°ticas aumentando resili√™ncia da terra (Niggli et al. 2009; Altieri Nicholls 2017; Blanchard et al. 2017). Uma abordagem interessante √© investigar como popula√ß√µes locais lidam com esses desafios em termos de percep√ß√µes e comportamento.Como invas√£o biol√≥gica afeta espacial e temporalmente estrutura e funcionalidade dos sistemas s√≥cio-ecol√≥gicos?Exemplo: Muitos estudos demonstraram que esp√©cies invasoras t√™m consequ√™ncias biol√≥gicas, econ√¥micas e sociais negativas. Aqui, da mesma forma que pergunta B, os pesquisadores controlaram presen√ßa de esp√©cies invasoras ou utilizaram registros hist√≥ricos. entanto, trabalhos recentes quantificam n√£o apenas riqueza e composi√ß√£o de esp√©cies nativas, mas tamb√©m atributos funcionais de animais/vegetais que afetam diretamente o fornecimento de servi√ßos ecossist√™micos como abastecimento (comida, √°gua), regula√ß√£o (clima, controle de inunda√ß√µes), suporte (ciclagem de nutrientes, forma√ß√£o solo) e cultural (ecoturismo, patrim√¥nio cultural) (Chaffin et al. 2016). Mas, esp√©cies invasoras podem provocar efeitos positivos sistema s√≥cio-ecol√≥gico aumentando disponibilidade de recursos naturais, impactando como pessoas gerenciam e usam biodiversidade local.Qual √© rela√ß√£o entre diversidades filogen√©tica e taxon√¥mica com diversidade biocultural?Exemplo: Estudos recentes mostraram que existe um padr√£o filogen√©tico e taxon√¥mico nos recursos que pessoas incorporam em seus sistemas s√≥cio-ecol√≥gicos, especialmente em plantas medicinais. Existe uma tend√™ncia para pessoas, em diferentes partes mundo, para usar plantas pr√≥ximas filogeneticamente para os mesmos prop√≥sitos. Aqui, os pesquisadores podem testar o quanto isso afeta diversidade de pr√°ticas em um sistema s√≥cio-ecol√≥gico considerando o ambiente, bem como sua estrutura e fun√ß√µes (Saslis-Lagoudakis et al. 2012, 2014).Quais vari√°veis ambientais e s√≥cio-pol√≠ticas mudam estrutura e funcionalidade dos sistemas s√≥cio-ecol√≥gicos tropicais?Exemplo: Testar influ√™ncia das mudan√ßas ambientais afetadas pela esp√©cie humana (por exemplo, fogo, explora√ß√£o madeireira, aquecimento) em esp√©cies-chave e, consequentemente, como esse efeito em cascata pode afetar outras esp√©cies e servi√ßos ecossist√™micos (por exemplo, armazenamento de carbono, ciclo da √°gua e din√¢mica fogo) (Lindenmayer Sato 2018).Os atributos das esp√©cies influenciam como popula√ß√µes locais distinguem plantas ou animais √∫teis e n√£o-√∫teis?Exemplo: Investigar se popula√ß√£o local possui prefer√™ncia ao selecionar esp√©cies de animais ou plantas. Voc√™ pode avaliar se grupos diferentes (por exemplo, turistas) ou popula√ß√µes locais (por exemplo, pescadores) selecionam esp√©cies com base em atributos das esp√©cies. Estudos recentes t√™m mostrado uma liga√ß√£o potencial entre planta (por exemplo, cor, folha, flora√ß√£o) e p√°ssaro (por exemplo, cor, vocaliza√ß√£o) e alguns servi√ßos culturais ecossistema, como est√©tica, recreativa e espiritual/religiosa (Goodness et al. 2016).Como voc√™ notou, quest√µes eram mais te√≥ricas e, consequentemente, voc√™ pode derivar predi√ß√µes test√°veis (usando vari√°veis) partir delas (Figuras 2.1, 2.3). Por exemplo, da quest√£o ‚ÄúComo o uso da terra afeta manuten√ß√£o da biodiversidade e distribui√ß√£o de esp√©cies em diferentes escalas?‚Äù podemos derivar duas predi√ß√µes diferentes: ) densidade populacional (vari√°vel operacional de uso da terra) muda composi√ß√£o de esp√©cies e reduz riqueza de esp√©cies na escala da paisagem (predi√ß√£o derivada da hip√≥tese da homogeneiza√ß√£o bi√≥tica: Solar et al. 2015); ii) composi√ß√£o dos atributos funcionais das plantas √© diferente em remanescentes florestais com diferentes matrizes (cana-de-a√ß√∫car, gado, cidade, etc.).","code":""},{"path":"cap2.html","id":"considera√ß√µes-finais","chapter":"Cap√≠tulo 2 Voltando ao b√°sico: como dominar a arte de fazer perguntas cientificamente relevantes","heading":"2.5 Considera√ß√µes Finais","text":"Conte-seus segredosE fa√ßa-suas perguntasOh, vamos voltar para o in√≠cioCorrendo em c√≠rculos, perseguindo caudasCabe√ßas em uma ci√™ncia √† parteNingu√©m disse que seria f√°cil(‚Ä¶) Desfazendo enigmasQuest√µes da ci√™ncia, ci√™ncia e progresso- O Cientista, ColdplayEste √© um trecho de uma m√∫sica da banda brit√¢nica de rock Coldplay, √°lbum de 2002 Rush Blood Head. letra √© uma compara√ß√£o incr√≠vel entre ci√™ncia e os altos e baixos de um relacionamento fadado ao fracasso. banda traz uma mensagem surpreendentemente clara de que como cientistas, n√≥s dever√≠amos frequentemente fazer perguntas, voltar ao in√≠cio ap√≥s descobrir que est√°vamos errados (ou n√£o) e que corremos em c√≠rculos tentando melhorar nosso conhecimento. banda descreveu de uma forma t√£o precisa o qu√£o c√≠clico (mas n√£o repetitivo) √© o m√©todo cient√≠fico. Como disse can√ß√£o: n√£o √© f√°cil, mas aprender como fazer boas perguntas √© um passo essencial para consolida√ß√£o conhecimento. Ao incluir o teste de hip√≥tese EEC, podemos ser mais precisos. Definitivamente, isso n√£o significa que ci√™ncia descritiva seja in√∫til. Ao contr√°rio, o desenvolvimento da ECC e principalmente da Etnobiologia, foi constru√≠do sobre uma linha de frente descritiva, o que significa que foi valioso para funda√ß√£o da Etnobiologia como disciplina consolidada (Group 2003; Stepp 2005). entanto, estudos recentes defendem que etnobiologia deve dialogar com disciplinas com maior respaldo te√≥rico, como ecologia e biologia evolutiva para melhorar pesquisa sobre biodiversidade (Albuquerque Ferreira J√∫nior 2017). Por sua vez, incorporando o conhecimento local em ecologia e evolu√ß√£o ir√° certamente refinar seu pr√≥prio desenvolvimento, que em √∫ltima an√°lise beneficia conserva√ß√£o biol√≥gica (Saslis-Lagoudakis Clarke 2013). Al√©m disso, h√° uma necessidade urgente de formar jovens pesquisadores em filosofia e metodologia da ci√™ncia, bem como comunica√ß√£o e produ√ß√£o cient√≠fica (Albuquerque 2013). Como coment√°rio final, acreditamos que forma√ß√£o dos alunos em EEC precisa de uma reavalia√ß√£o que necessariamente volta aos conceitos e m√©todos b√°sicos. Assim, os pesquisadores podem combinar o m√©todo hipot√©tico-dedutivo com pensamento estat√≠stico usando um fluxograma de pesquisa para ir al√©m da descri√ß√£o b√°sica.","code":""},{"path":"cap3.html","id":"cap3","chapter":"Cap√≠tulo 3 Pr√©-requisitos","heading":"Cap√≠tulo 3 Pr√©-requisitos","text":"","code":""},{"path":"cap3.html","id":"introdu√ß√£o-1","chapter":"Cap√≠tulo 3 Pr√©-requisitos","heading":"3.1 Introdu√ß√£o","text":"O objetivo deste cap√≠tulo √© informar como fazer instala√ß√£o dos Programas R e RStudio, al√©m de descrever os pacotes e dados necess√°rios para reproduzir os exemplos livro.","code":""},{"path":"cap3.html","id":"instala√ß√£o-do-r","chapter":"Cap√≠tulo 3 Pr√©-requisitos","heading":"3.2 Instala√ß√£o do R","text":"Abaixo descrevemos os sete passos necess√°rios para instala√ß√£o programa R seu computador (Figura 3.1):Para come√ßarmos trabalhar com o R √© necess√°rio baix√°-lo na p√°gina R Project. Ent√£o, acesse esse site http://www.r-project.orgClique link download RNa p√°gina CRAN Mirros (Comprehensive R Archive Network), escolha uma das p√°ginas espelho Brasil mais pr√≥xima de voc√™ para baixar o programaEscolha agora o sistema operacional seu computador (passos adicionais existem para diferentes distribui√ß√µes Linux ou MacOS). Aqui faremos o exemplo com o WindowsClique em base para finalmente chegar √† p√°gina de download com vers√£o mais recente RClique arquivo Download R (vers√£o mais recente) Windows que ser√° instalado seu computadorAbra o arquivo que foi baixado seu computador e siga os passos indicados para finalizar instala√ß√£o programa R\nFigura 3.1: Esquema ilustrativo demonstrando os passos necess√°rios para instala√ß√£o programa R computador. Fonte das figuras: imagem computador e imagem da lupa.\n üìù Importante \nPara o Sistema Operacional () Windows, alguns pacotes s√£o dependentes da instala√ß√£o separada Rtools40. Da mesma forma, GNU/Linux e MacOS tamb√©m possuem depend√™ncias de outras bibliotecas para pacotes espec√≠ficos, mas que n√£o abordaremos aqui. Essas informa√ß√µes de depend√™ncia geralmente s√£o retornadas como erros ou voc√™ pode procurar ajuda em f√≥runs espec√≠ficos.","code":""},{"path":"cap3.html","id":"instala√ß√£o-do-rstudio","chapter":"Cap√≠tulo 3 Pr√©-requisitos","heading":"3.3 Instala√ß√£o do RStudio","text":"O RStudio possui algumas caracter√≠sticas que o tornam popular: v√°rias janelas de visualiza√ß√£o, marca√ß√£o e preenchimento autom√°tico script, integra√ß√£o com controle de vers√£o, dentre outras funcionalidades.Abaixo descrevemos os cinco passos necess√°rios para instala√ß√£o RStudio seu computador (Figura 3.2):Para fazer o download RStudio, acessamos o site https://www.rstudio.com/Clique em downloadEscolha vers√£o gratuitaEscolha o instalador com base seu sistema operacionalAbra o arquivo que foi baixado seu computador e siga os passos indicados para finalizar instala√ß√£o programa RStudio\nFigura 3.2: Esquema ilustrativo demonstrando os passos necess√°rios para instala√ß√£o programa RStudio computador. Fonte das figuras: imagem computador e imagem da lupa.\n","code":""},{"path":"cap3.html","id":"vers√£o-do-r","chapter":"Cap√≠tulo 3 Pr√©-requisitos","heading":"3.4 Vers√£o do R","text":"Todas os c√≥digos, pacotes e an√°lises disponibilizados livro foram realizados Programa R vers√£o 4.1.2 (10-12-2021).","code":""},{"path":"cap3.html","id":"pacotes","chapter":"Cap√≠tulo 3 Pr√©-requisitos","heading":"3.5 Pacotes","text":"Descrevemos Cap√≠tulo 4 o que s√£o e como instalar os pacotes para realizar an√°lises estat√≠sticas R. üìù Importante \nCriamos o pacote ecodados que cont√©m todas informa√ß√µes e dados utilizados neste livro. Assim, recomendamos que voc√™ instale e carregue este pacote in√≠cio de cada cap√≠tulo para ter acesso aos dados necess√°rios para executar fun√ß√µes R.Abaixo, listamos todos os pacotes utilizados livro. Voc√™ pode instalar os pacotes agora ou esperar para instal√°-los quando ler o Cap√≠tulo 4 e entender o que s√£o fun√ß√µes install.packages(), library() e install_github(). Para fazer instala√ß√£o, voc√™ vai precisar estar conectado √† internet.Diferente dos pacotes anteriores que s√£o baixados CRAN, alguns pacotes s√£o baixados GitHub dos pesquisadores respons√°veis pelos pacotes. GitHub √© um reposit√≥rio remoto de c√≥digos que permite controle de vers√£o, muito utilizado por desenvolvedores e programadores. Nestes casos, precisamos carregar o pacote devtools para acessar fun√ß√£o install_github. Durante instala√ß√µes destes pacotes, algumas vezes o R ir√° pedir para voc√™ digitar um n√∫mero indicando os pacotes que voc√™ deseja fazer update. Neste caso, digite 1 para indicar que ele deve atualizar os pacotes dependentes antes de instalar os pacotes requeridos.","code":"\ninstall.packages(c(\"ade4\", \"adespatial\", \"ape\", \"bbmle\", \"betapart\", \"BiodiversityR\", \"car\", \"cati\", \"datasauRus\", \"devtools\", \"DHARMa\", \"dplyr\", \"ecolottery\", \"emmeans\", \"factoextra\", \"FactoMineR\", \"fasterize\", \"FD\", \"forcats\", \"geobr\", \"generalhoslem\", \"GGally\", \"ggExtra\", \"ggforce\", \"ggplot2\", \"ggpubr\", \"ggrepel\", \"ggspatial\", \"glmmTMB\", \"grid\", \"gridExtra\", \"here\", \"hillR\", \"iNEXT\", \"janitor\", \"kableExtra\", \"knitr\", \"labdsv\", \"lattice\", \"leaflet\", \"lmtest\", \"lsmeans\", \"lubridate\", \"mapview\", \"MASS\", \"MuMIn\", \"naniar\", \"nlme\", \"ordinal\", \"palmerpenguins\", \"performance\", \"pez\", \"phyloregion\", \"phytools\", \"picante\", \"piecewiseSEM\", \"purrr\", \"pvclust\", \"raster\", \"readr\", \"reshape2\", \"rgdal\" , \"Rmisc\", \"rnaturalearth\", \"RVAideMemoire\", \"sciplot\", \"sf\", \"sidrar\", \"sjPlot\", \"spData\", \"spdep\", \"stringr\", \"SYNCSA\", \"tibble\", \"tidyr\", \"tidyverse\", \"tmap\", \"tmaptools\", \"TPD\", \"vcd\", \"vegan\", \"viridis\", \"visdat\", \"mvabund\", \"rdist\", \"udunits2\"), dependencies = TRUE)\nlibrary(devtools) \ninstall_github(\"paternogbc/ecodados\")\ninstall_github(\"mwpennell/geiger-v2\")\ninstall_github(\"fawda123/ggord\")\ninstall_github(\"jinyizju/V.PhyloMaker\")"},{"path":"cap3.html","id":"dados","chapter":"Cap√≠tulo 3 Pr√©-requisitos","heading":"3.6 Dados","text":"maioria dos exemplos utilizados s√£o baseados em dados reais que j√° foram publicados em artigos cient√≠ficos ou s√£o dados coletados por um dos autores deste livro. Em alguns casos, os dados foram simulados para facilitar interpreta√ß√£o dos resultados de algumas an√°lises estat√≠sticas. Todos os dados, publicados ou simulados, est√£o dispon√≠veis pacote ecodados. Al√©m disso, em cada cap√≠tulo fazemos uma breve descri√ß√£o dos dados para facilitar compreens√£o sobre o que √© vari√°vel resposta ou preditora, como essas vari√°veis est√£o relacionadas com perguntas e predi√ß√µes exemplo.","code":""},{"path":"cap4.html","id":"cap4","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"Cap√≠tulo 4 Introdu√ß√£o ao R","text":"","code":""},{"path":"cap4.html","id":"pr√©-requisitos-do-cap√≠tulo","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"Pr√©-requisitos do cap√≠tulo","text":"Pacotes e dados que ser√£o utilizados nesse cap√≠tulo.","code":"\n## Pacotes\nlibrary(ecodados)\n\n## Dados necess√°rios\nintror_anfibios_locais <- ecodados::intror_anfibios_locais"},{"path":"cap4.html","id":"contextualiza√ß√£o","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.1 Contextualiza√ß√£o","text":"O objetivo deste cap√≠tulo √© apresentar os aspectos b√°sicos da linguagem R para realiza√ß√£o dos principais passos para manipula√ß√£o, visualiza√ß√£o e an√°lise de dados. Abordaremos aqui quest√µes b√°sicas sobre linguagem R, como: ) R e RStudio, ii) funcionamento da linguagem, iii) estrutura e manipula√ß√£o de objetos, iv) exerc√≠cios e v) principais livros e material para se aprofundar nos seus estudos.Todo processo de aprendizagem torna-se mais efetivo quando teoria √© combinada com pr√°tica. Assim, recomendamos fortemente que voc√™, leitor() acompanhe os c√≥digos e exerc√≠cios deste livro, ao mesmo tempo que os executa em seu computador e n√£o s√≥ os leia passivamente. Al√©m disso, se voc√™ tiver seus pr√≥prios dados √© muito importante tentar executar e/ou replicar an√°lises e/ou gr√°ficos. Por motivos de espa√ßo, n√£o abordaremos todas quest√µes relacionadas ao uso da linguagem R neste cap√≠tulo. Logo, aconselhamos que voc√™ consulte o material sugerido final cap√≠tulo para se aprofundar.Este cap√≠tulo, na maioria das vezes, pode desestimular pessoas que est√£o iniciando, uma vez que o mesmo n√£o apresenta os c√≥digos para realizar an√°lises estat√≠sticas. Contudo, ele √© essencial para o entendimento e interpreta√ß√£o que est√° sendo informado nas linhas de c√≥digo, al√©m de facilitar manipula√ß√£o dos dados antes de realizar an√°lises estat√≠sticas. Voc√™ perceber√° que n√£o usar√° este cap√≠tulo para fazer an√°lises, mas voltar√° aqui diversas vezes para relembrar qual √© o c√≥digo ou o que significa determinada express√£o ou fun√ß√£o usada nos pr√≥ximos cap√≠tulos.","code":""},{"path":"cap4.html","id":"r-e-rstudio","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.2 R e RStudio","text":"Com o R, √© poss√≠vel manipular, analisar e visualizar dados, al√©m de escrever desde pequenas linhas de c√≥digos at√© programas inteiros. O R √© vers√£o em c√≥digo aberto de uma linguagem de programa√ß√£o chamada de S, criada por John M. Chambers (Stanford University, CA, EUA) nos anos 1980 Bell Labs, que contou com tr√™s vers√µes: Old S (1976-1987), New S (1988-1997) e S4 (1998), utilizada na IDE S-PLUS (1988-2008). Essa linguagem tornou-se bastante popular e v√°rios produtos comerciais que usam ainda est√£o dispon√≠veis, como o SAS.final dos anos 1990, Robert Gentleman e Ross Ihaka (ambos da Universidade de Auckland, Nova Zel√¢ndia), iniciaram o desenvolvimento da vers√£o livre da linguagem S, linguagem R, com o seguinte hist√≥rico: Desenvolvimento (1997-2000), Vers√£o 1 (2000-2004), Vers√£o 2 (2004-2013), Vers√£o 3 (2013-2020) e Vers√£o 4 (2020). Para mais detalhes hist√≥rico de desenvolvimento das linguagens S e R, consultar Wickham (2013). Atualmente linguagem R √© mantida por uma rede de colaboradores denominada R Core Team. origem nome R √© desconhecida, mas reza lenda que ao lan√ßarem o nome da linguagem os autores se valeram da letra que vinha antes S, uma vez que linguagem R foi baseada nela e utilizaram letra ‚ÄúR.‚Äù Outra hist√≥ria conta que pelo fato nome dos dois autores iniciarem por ‚ÄúR,‚Äù batizaram linguagem com essa letra, vai saber.Um aspecto digno de nota √© que linguagem R √© uma linguagem de programa√ß√£o interpretada, assim como o Python, mas contr√°ria outras linguagens como C e Java, que s√£o compiladas. Isso faz ser mais f√°cil de ser utilizada, pois processa linhas de c√≥digo e transforma em linguagem de m√°quina (c√≥digo bin√°rio que o computador efetivamente l√™), apesar desse fato diminuir velocidade de processamento.Para come√ßarmos trabalhar com o R √© necess√°rio baix√°-lo na p√°gina R Project. Os detalhes de instala√ß√£o s√£o apresentados Cap√≠tulo 3. Reserve algum tempo para explorar esta p√°gina R-Project. Existem v√°rios livros dedicados diversos assuntos baseados R. Al√©m disso, est√£o dispon√≠veis manuais em diversas l√≠nguas para serem baixados gratuitamente.Como o R √© um software livre, n√£o existe possibilidade de o usu√°rio entrar em contato com um servi√ßo de suporte de usu√°rios, muito comuns em softwares pagos. Ao inv√©s disso, existem v√°rias listas de e-mails que fornecem suporte √† comunidade de usu√°rios. N√≥s, particularmente, recomendamos o ingresso nas seguintes listas: R-help, R-sig-ecolog, R-br e discourse.curso-r. Este √∫ltimo re√∫ne um grupo de pessoas usu√°rias brasileiras programa R.Apesar de podermos utilizar o R com o IDE (Ambiente de Desenvolvimento Integrado - Integrated Development Environment) RGui que vem com instala√ß√£o da linguagem R para usu√°rios Windows (Figura 4.1) ou pr√≥prio terminal para usu√°rios Linux e MacOS, existem alguns IDEs espec√≠ficos para facilitar nosso uso dessa linguagem.\nFigura 4.1: Interface RGui. Os n√∫meros indicam: (1) R Script, (2) R Console, e (3) R Graphics.\nDessa forma, n√≥s que escrevemos este livro utilizamos o IDE RStudio e assumimos que voc√™ que est√° lendo far√° o mesmo.O RStudio permite diversas personaliza√ß√µes, grande parte delas contidas em Tools > Global options. Incentivamos leitoras e leitores ‚Äúfu√ßar‚Äù com certa dose de cuidado, nas op√ß√µes para personaliza√ß√£o. Dentre essas mudan√ßas, destacamos duas:Tools > Global options > Appearance > Editor theme: para escolher um tema para seu RStudioTools > Global options > Code > [X] Soft-wrap R source files: com essa op√ß√£o habilitada, quando escrevemos coment√°rios longos ou mudamos largura da janela que estamos trabalhando, todo o texto e o c√≥digo se ajustam janela automaticamenteTools > Global options > Code > Display > [X Show Margis] e Margin column (80): com essa op√ß√£o habilitada e para esse valor (80), uma linha vertical ir√° aparecer script marcando 80 caracteres, um comprimento m√°ximo recomendado para padroniza√ß√£o dos scripts üìù Importante \nPara evitar poss√≠veis erros √© importante instalar primeiro o software da linguagem R e depois o IDE RStudio.","code":""},{"path":"cap4.html","id":"funcionamento-da-linguagem-r","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.3 Funcionamento da linguagem R","text":"Nesta se√ß√£o, veremos os principais conceitos para entender como linguagem R funciona ou como geralmente utilizamos o IDE RStudio dia dia, para executar nossas rotinas utilizando linguagem R. Veremos ent√£o: ) console, ii) script, iii) operadores, iv) objetos, v) fun√ß√µes, vi) pacotes, vii) ajuda (help), viii) ambiente (environment/workspace), ix) cita√ß√µes e x) principais erros.Antes de iniciarmos o uso R pelo RStudio √© fundamental entendermos alguns pontos sobre janelas e o funcionamento delas RStudio (Figura 4.2).\nFigura 4.2: Interface RStudio. Os n√∫meros indicam: (1) janela com abas de Script, R Markdown, dentre outras; (2) janela com abas de Console, Terminal e Jobs; (3) janela com abas de Environment, History, Conections e Tutorial; e (4) janela com abas de Files, Plots, Packages, Help e Viewer.\nDetalhando algumas dessas janelas e abas, temos:Console: painel onde os c√≥digos s√£o rodados e vemos sa√≠dasEditor/Script: painel onde escrevemos nossos c√≥digos em R, R Markdown ou outro formatoEnvironment: painel com todos os objetos criados na sess√£oHistory: painel com o hist√≥rico dos c√≥digos rodadosFiles: painel que mostra os arquivos diret√≥rio de trabalhoPlots: painel onde os gr√°ficos s√£o apresentadosPackages: painel que lista os pacotesHelp: painel onde documenta√ß√£o das fun√ß√µes √© exibidaNo RStudio, alguns atalhos s√£o fundamentais para aumentar nossa produtividade:F1: abre o painel de Help quando digitado em cima de uma fun√ß√£oCtrl + Enter: roda linha de c√≥digo selecionada scriptCtrl + Shift + N: abre um novo scriptCtrl + S: salva um scriptCtrl + Z: desfaz uma opera√ß√£oCtrl + Shift + Z: refaz uma opera√ß√£oAlt + -: insere um sinal de atribui√ß√£o (<-)Ctrl + Shift + M: insere um operador pipe (%>%)Ctrl + Shift + C: comenta uma linha script - insere um (#)Ctrl + : indenta (recuo inicial das linhas) linhasCtrl + Shift + : reformata o c√≥digoCtrl + Shift + R: insere uma sess√£o (# ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-)Ctrl + Shift + H: abre uma janela para selecionar o diret√≥rio de trabalhoCtrl + Shift + F10: reinicia o consoleCtrl + L: limpa os c√≥digos consoleAlt + Shift + K: abre uma janela com todos os atalhos dispon√≠veis","code":""},{"path":"cap4.html","id":"console","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.3.1 Console","text":"O console √© onde vers√£o da linguagem R instalada √© carregada para executar os c√≥digos da linguagem R (Figura 4.2 janela 2). Na janela console aparecer√° o s√≠mbolo >, seguido de uma barra vertical | que fica piscando (cursor), onde digitaremos ou enviaremos nossos c√≥digos script. Podemos fazer um pequeno exerc√≠cio: vamos digitar 10 + 2, seguido da tecla Enter para que essa opera√ß√£o seja executada.O resultado retorna o valor 12, precedido de um valor entre colchetes. Esses colchetes demonstram posi√ß√£o elemento numa sequ√™ncia de valores. Se fizermos essa outra opera√ß√£o 1:42, o R vai criar uma sequ√™ncia unit√°ria de valores de 1 42. depender da largura da janela console, vai aparecer um n√∫mero diferente entre colchetes indicando sua posi√ß√£o na sequ√™ncia: antes n√∫mero 1 vai aparecer o [1], depois quando sequ√™ncia quebrada, vai aparecer o n√∫mero correspondente da posi√ß√£o elemento, por exemplo, [37].Podemos ver o hist√≥rico dos c√≥digos executados console na aba History (Figura 4.2 janela 3).","code":"\n10 + 2\n#> [1] 12\n1:42\n#>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39\n#> [40] 40 41 42"},{"path":"cap4.html","id":"scripts","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.3.2 Scripts","text":"Scripts s√£o arquivos de texto simples, criados com extens√£o (termina√ß√£o) .R (Figura 4.2 janela 1). Para criar um script, basta ir em File > New File > R Script, ou clicando √≠cone com uma folha branca e um c√≠rculo verde com um sinal de +, logo abaixo de File, ou ainda usando o atalho Ctrl + Shift + N.Uma vez escrito os c√≥digos script podemos rodar esses c√≥digos de duas formas: ) todo o script de uma vez, clicando em Source ou usando o atalho Ctrl + Shift + Enter; ou ii) apenas linha onde o cursor estiver posicionado, independentemente de sua posi√ß√£o naquela linha, clicando em Run ou usando o atalho Ctrl + Enter.Devemos sempre salvar nossos scripts, tomando por via de regra: primeiro criar o arquivo e depois ir salvando nesse mesmo arquivo cada passo de desenvolvimento das an√°lises (n√£o √© raro o RStudio fechar sozinho e voc√™ perder algum tempo de trabalho). H√° diversos motivos para criar um script: continuar o desenvolvimento desse script em outro momento ou em outro computador, preservar trabalhos passados, ou ainda compartilhar seus c√≥digos com outras pessoas. Para criar ou salvar um script basta ir em File > Save, escolher um diret√≥rio e nome para o script e salv√°-lo. Podemos ainda utilizar o atalho Ctrl + S.Em rela√ß√£o aos scripts, h√° ainda os coment√°rios, representados pelos s√≠mbolos # (hash), #' (hash-linha) e #> (hash-maior). diferen√ßa entre eles √© que para o segundo e terceiro, quando pressionamos tecla Enter o coment√°rio #' e #> s√£o inseridos automaticamente na linha seguinte. Linhas de c√≥digos script contendo coment√°rios em seu in√≠cio n√£o s√£o lidos pelo console R. Se o coment√°rio estiver final da linha, essa linha de c√≥digo ainda ser√° lida. Os coment√°rios s√£o utilizados geralmente para: ) descrever informa√ß√µes sobre dados ou fun√ß√µes e/ou ii) suprimir linhas de c√≥digo.√â interessante ter in√≠cio de cada script um cabe√ßalho identificando o objetivo ou an√°lise, autor e data para facilitar o compartilhamento e reprodutibilidade. Os coment√°rios podem ser inseridos ou retirados das linhas com o atalho: Ctrl + Shift + C.Al√©m disso, podemos usar coment√°rios para adicionar informa√ß√µes sobre os c√≥digos.Por fim, outro ponto fundamental √© ter boas pr√°ticas de estilo de c√≥digo. Quanto mais organizado e padronizado estiver seus scripts, mais f√°cil de entend√™-los e de procurar poss√≠veis erros. Existem dois guias de boas pr√°ticas para adequar seus scripts: Hadley Wickham e Google.Ainda em rela√ß√£o aos scripts, temos os Code Snippets (Fragmentos de c√≥digo), que s√£o macros de texto usadas para inserir rapidamente fragmentos comuns de c√≥digo. Por exemplo, o snippet fun insere uma defini√ß√£o de fun√ß√£o R. Para mais detalhes, ler o artigo RStudio: link.Uma aplica√ß√£o bem interessante dos Code Snippets script √© o ts. Basta digitar esse c√≥digo e em seguida pressionar tecla Tab para inserir rapidamente data e hor√°rio atuais script em forma de coment√°rio.","code":"\n#' ---\n#' T√≠tulo: Cap√≠tulo 04 - Introdu√ß√£o ao R\n#' Autor: Maur√≠cio Vancine\n#' Data: 11-11-2021\n#' ---\n## Coment√°rios\n# O R n√£o l√™ a linha do c√≥digo depois do # (hash).\n42 # Essas palavras n√£o s√£o executadas, apenas o 42, a resposta para quest√£o fundamental da vida, o universo e tudo mais.\n#> [1] 42\n# fun {snippet}\nfun\nname <- function(variables) {\n    \n}\n# ts {snippet}\n# Thu Nov 11 18:19:26 2021 ------------------------------"},{"path":"cap4.html","id":"operadores","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.3.3 Operadores","text":"R, podemos agrupar os operadores em cinco tipos: aritm√©ticos, relacionais, l√≥gicos, atribui√ß√£o e diversos. Grande parte deles s√£o descritos na Tabela 4.1.\nTabela 4.1: Principais operadores R.\nComo exemplo, podemos fazer opera√ß√µes simples usando os operadores aritm√©ticos.Precisamos ficar atentos √† prioridade dos operadores aritm√©ticos:PRIORIT√ÅRIO () > ^ > * ou / > + ou - N√ÉO PRIORIT√ÅRIOVeja exemplo abaixo como o uso dos par√™nteses muda o resultado.","code":"\n## Opera√ß√µes aritm√©ticas\n10 + 2 # adi√ß√£o\n#> [1] 12\n10 * 2 # multiplica√ß√£o\n#> [1] 20\n## Sem especificar a ordem\n# Segue a ordem dos operadores.\n1 * 2 + 2 / 2 ^ 2\n#> [1] 2.5\n\n## Especificando a ordem\n# Segue a ordem dos parenteses.\n((1 * 2) + (2 / 2)) ^ 2\n#> [1] 9"},{"path":"cap4.html","id":"objetos","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.3.4 Objetos","text":"Objetos s√£o palavras √†s quais s√£o atribu√≠dos dados. atribui√ß√£o possibilita manipula√ß√£o de dados ou armazenar os resultados de an√°lises. Utilizaremos os s√≠mbolos < (menor), seguido de - (menos), sem espa√ßo, dessa forma <-. Tamb√©m podemos utilizar o s√≠mbolo de igual (=), mas n√£o recomendamos, por n√£o fazer parte das boas pr√°ticas de escrita de c√≥digos em R. Podemos inserir essa combina√ß√£o de s√≠mbolos com o atalho Alt + -. Para demonstrar, vamos atribuir o valor 10 √† palavra obj_10, e chamar esse objeto novamente para verificar seu conte√∫do. üìù Importante \nRecomendamos sempre verificar o conte√∫do dos objetos chamando-os novamente para confirmar se atribui√ß√£o foi realizada corretamente e se o conte√∫do corresponde √† opera√ß√£o realizada.Todos os objetos criados numa sess√£o R ficam listados na aba Environment (Figura 4.2 janela 3). Al√©m disso, o RStudio possui fun√ß√£o autocomplete, ou seja, podemos digitar primeiras letras de um objeto (ou fun√ß√£o) e em seguida apertar Tab para que o RStudio liste tudo que come√ßar com essas letras.Dois pontos importantes sobre atribui√ß√µes: primeiro, o R sobrescreve os valores dos objetos com o mesmo nome, deixando o objeto com o valor da √∫ltima atribui√ß√£o.Segundo, o R tem limita√ß√µes ao nomear objetos:nome de objetos s√≥ podem come√ßar por letras (-z ou -Z) ou pontos (.)nome de objetos s√≥ podem conter letras (-z ou -Z), n√∫meros (0-9), underscores (_) ou pontos (.)R √© case-sensitive, .e., ele reconhece letras mai√∫sculas como diferentes de letras min√∫scula. Assim, um objeto chamado ‚Äúresposta‚Äù √© diferente objeto ‚ÄúRESPOSTA‚Äùdevemos evitar acentos ou cedilha (√ß) para facilitar memoriza√ß√£o dos objetos e tamb√©m para evitar erros de codifica√ß√£o (encoding) de caracteresnomes de objetos n√£o podem ser iguais nomes especiais, reservados para programa√ß√£o (break, else, FALSE, , function, , Inf, NA, NaN, next, repeat, return, TRUE, )Podemos ainda utilizar objetos para fazer opera√ß√µes e criar objetos. Isso pode parecer um pouco confuso para os iniciantes, mas √© fundamental aprender essa l√≥gica para passar para os pr√≥ximos passos.","code":"\n## Atribui√ß√£o - s√≠mbolo (<-)\nobj_10 <- 10\nobj_10\n#> [1] 10\n## Sobrescreve o valor dos objetos\nobj <- 100\nobj\n#> [1] 100\n\n## O objeto 'obj' agora vale 2\nobj <- 2\nobj\n#> [1] 2\n## Definir dois objetos\nva1 <- 10\nva2 <- 2\n\n## Opera√ß√µes com objetos e atribuic√£o\nadi <- va1 + va2\nadi\n#> [1] 12"},{"path":"cap4.html","id":"fun√ß√µes","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.3.5 Fun√ß√µes","text":"Fun√ß√µes s√£o c√≥digos preparados para realizar uma tarefa espec√≠fica de modo simples. Outra forma de entender uma fun√ß√£o √©: c√≥digos que realizam opera√ß√µes em argumentos. Devemos retomar ao conceito ensino m√©dio de fun√ß√µes: os dados de entrada s√£o argumentos e fun√ß√£o realizar√° alguma opera√ß√£o para modificar esses dados de entrada. estrutura de uma fun√ß√£o √© muito similar √† sintaxe usada em planilhas eletr√¥nicas, sendo composta por:nome_da_fun√ß√£o(argumento1, argumento2, ‚Ä¶)Nome da fun√ß√£o: remete ao que ela fazPar√™nteses: limitam fun√ß√£oArgumentos: valores, par√¢metros ou express√µes onde fun√ß√£o atuar√°V√≠rgulas: separam os argumentosOs argumentos de uma fun√ß√£o podem ser de dois tipos:Valores ou objetos: fun√ß√£o alterar√° os valores em si ou os valores atribu√≠dos aos objetosPar√¢metros: valores fixos que informam um m√©todo ou realiza√ß√£o de uma opera√ß√£o. Informa-se o nome desse argumento, seguido de ‚Äú=‚Äù e um n√∫mero, texto ou TRUE ou FALSEAlguns exemplos de argumentos como valores ou objetos.Vamos ver agora alguns exemplos de argumentos usados como par√¢metros. Note que apesar valor argumento ser o mesmo (10), seu efeito resultado da fun√ß√£o rep() muda drasticamente. Aqui tamb√©m √© importante destacar um ponto: ) podemos informar os argumentos sequencialmente, sem explicitar seus nomes, ou ii) independente da ordem, mas explicitando seus nomes. Entretanto, como exemplo abaixo, devemos informar o nome argumento (.e., par√¢metro), para que seu efeito seja o que desejamos.Um ponto fundamental e que deve ser entendido nesse ponto, √© o fluxo de atribui√ß√µes resultado da opera√ß√£o de fun√ß√µes novos objetos. desenvolvimento de qualquer script na linguagem R, grande parte da estrutura mesmo ser√° dessa forma: atribui√ß√£o de dados objetos > opera√ß√µes com fun√ß√µes > atribui√ß√£o dos resultados novos objetos > opera√ß√µes com fun√ß√µes desses novos objetos > atribui√ß√£o dos resultados novos objetos. Ao entender esse funcionamento, come√ßamos entender como devemos pensar na organiza√ß√£o nosso script para montar an√°lises que precisamos.Por fim, √© fundamental tamb√©m entender origem das fun√ß√µes que usamos R. Todas fun√ß√µes s√£o advindas de pacotes. Esses pacotes possuem duas origens.pacotes j√° instalados por padr√£o e que s√£o carregados quando abrimos o R (R Base)pacotes que instalamos e carregamos com fun√ß√µes","code":"\n## Fun√ß√µes - argumentos como valores\nsum(10, 2)\n#> [1] 12\n\n## Fun√ß√µes - argumentos como objetos\nsum(va1, va2)\n#> [1] 12\n## Fun√ß√µes - argumentos como par√¢metros\n## Repeti√ß√£o - repete todos os elementos\nrep(x = 1:5, times = 10)\n#>  [1] 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5\n\n## Repeti√ß√£o - repete cada um dos elementos\nrep(x = 1:5, each = 10)\n#>  [1] 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 4 4 4 4 4 4 4 4 4 4 5 5 5 5 5 5 5 5 5 5\n## Atribuic√£o dos resultados\n## Repeti√ß√£o\nrep_times <- rep(1:5, times = 10)\nrep_times\n#>  [1] 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5\n\n## Somar e atribuir\nrep_times_soma <- sum(rep_times)\nrep_times_soma\n#> [1] 150\n\n## Raiz e atribuir\nrep_times_soma_raiz <- sqrt(rep_times_soma)\nrep_times_soma_raiz\n#> [1] 12.24745"},{"path":"cap4.html","id":"pacotes-1","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.3.6 Pacotes","text":"Pacotes s√£o conjuntos extras de fun√ß√µes para executar tarefas espec√≠ficas, al√©m dos pacotes instalados R Base. Existe literalmente milhares de pacotes (~19,000 enquanto escrever esse livro) para mais diversas tarefas: estat√≠stica, ecologia, geografia, sensoriamento remoto, econometria, ci√™ncias sociais, gr√°ficos, machine learning, etc. Podemos verificar este vasto conjunto de pacotes pelo link que lista por nome os pacotes oficiais, ou seja, que passaram pelo crivo CRAN. Existem ainda muito mais pacotes em desenvolvimento, geralmente disponibilizados em reposit√≥rios GitHub ou GitLab.Podemos listar esses pacotes dispon√≠veis CRAN com esse c√≥digo.Primeiramente, com uma sess√£o R sem carregar nenhum pacote extra, podemos verificar pacotes carregados pelo R Base utilizando fun√ß√£o search().Podemos ainda verificar todos pacotes instalados em nosso computador com fun√ß√£o library().R, quando tratamos de pacotes, devemos destacar diferen√ßa de dois conceitos: instalar um pacote e carregar um pacote. instala√ß√£o de pacotes possui algumas caracter√≠sticas:Instala-se um pacote apenas uma vezPrecisamos estar conectados √† internetO nome pacote precisa estar entre aspas na fun√ß√£o de instala√ß√£oFun√ß√£o (CRAN): install.packages()Vamos instalar o pacote vegan diretamente CRAN, que possui fun√ß√µes para realizar uma s√©rie de an√°lise em ecologia (veja mais Cap√≠tulo 10). Para isso, podemos ir em Tools > Install Packages..., ou ir na aba Packages (Figura 4.2 janela 4), procurar o pacote e simplesmente clicar em ‚ÄúInstall.‚Äù Podemos ainda utilizar fun√ß√£o install.packages().Podemos conferir em que diret√≥rios um pacote ser√° instalado com fun√ß√£o .libPaths(). üìù Importante \nUma vez instalado um pacote, n√£o h√° necessidade de instal√°-lo novamente. Entretanto, todas √†s vezes que iniciarmos uma sess√£o R, precisamos carregar os pacotes com fun√ß√µes que precisamos utilizar.O carregamento de pacotes possui algumas caracter√≠sticas:Carrega-se o pacote toda vez que se abre uma nova sess√£o RN√£o precisamos estar conectados √† internetO nome pacote n√£o precisa estar entre aspas na fun√ß√£o de carregamentoFun√ß√µes: library() ou require()Vamos carregar o pacote vegan que instalamos anteriormente. Podemos ir na aba Packages (Figura 4.2 janela 4) e assinalar o pacote que queremos carregar ou utilizar fun√ß√£o library().Como dissemos, alguns pacotes em desenvolvimento encontram-se dispon√≠veis em reposit√≥rios GitHub, GitLab e Bioconductor. Para instalar pacotes GitHub, por exemplo, precisamos instalar e carregar o pacote devtools.Uma vez instalado e carregado esse pacote, podemos instalar o pacote GitHub, utilizando fun√ß√£o devtools::install_github(). Precisamos atentar para usar essa forma ‚Äúnome_usuario/nome_repositorio,‚Äù retirados link reposit√≥rio de interesse. Como exemplo, podemos instalar o pacote ecodados reposit√≥rio GitHub paternogbc/ecodados e depois utilizar fun√ß√£o library() para carreg√°-lo.Pode ser que em algumas circunst√¢ncias iremos precisar instalar pacotes com vers√µes espec√≠ficas para algumas an√°lises. forma mais simples de fazer isso √© instalar um pacote partir de um arquivo compactado .tar.gz. Para isso podemos ir √† base CRAN e realizar o download: https://cran.r-project.org/src/contrib/Archive/. Para exemplificar, vamos instalar o pacote vegan 2.4.0.Podemos ver descri√ß√£o de um pacote com fun√ß√£o packageDescription().maioria dos pacotes possui conjuntos de dados que podem ser acessados pela fun√ß√£o data(). Esses conjuntos de dados podem ser usados para testar fun√ß√µes pacote. Se estiver com d√∫vida na maneira como voc√™ deve preparar planilha para realizar uma an√°lise espec√≠fica, entre na Ajuda (Help) da fun√ß√£o e veja os conjuntos de dados que est√£o exemplo desta fun√ß√£o. Como exemplo, vamos carregar os dados dune pacote vegan, que s√£o dados de observa√ß√µes de 30 esp√©cies vegetais em 20 locais.Se por algum motivo precisarmos desinstalar um pacote, podemos utilizar fun√ß√£o remove.packages(). J√° para descarregar um pacote de uma sess√£o R, podemos usar fun√ß√£o detach().E um √∫ltimo ponto fundamental sobre pacotes, diz respeito √† atualiza√ß√£o dos mesmos. Os pacotes s√£o atualizados com frequ√™ncia, e infelizmente (ou felizmente, pois atualiza√ß√µes podem oferecer algumas quebras entre pacotes), n√£o se atualizam sozinhos. Muitas vezes, instala√ß√£o de um pacote pode depender da vers√£o dos pacotes dependentes, e geralmente uma janela com diversas op√ß√µes num√©ricas se abre perguntando se voc√™ quer que todos os pacotes dependentes sejam atualizados. Podemos ir na aba Packages (Figura 4.2 janela 4) e clicar em ‚ÄúUpdate‚Äù ou usar fun√ß√£o update.packages(checkBuilt = TRUE, ask = FALSE) para atualiz√°-los, entretanto, essa √© uma fun√ß√£o que costuma demorar muito para terminar de ser executada.Para fazer atualiza√ß√£o dos pacotes instalados pelo GitHub, recomendamos o uso pacote dtupdate.Destacamos e incentivamos ainda uma pr√°tica que achamos interessante para aumentar reprodutibilidade de nossos c√≥digos e scripts: de chamar fun√ß√µes de pacotes carregados dessa forma pacote::fun√ß√£o(). Com o uso dessa pr√°tica, deixamos claro o pacote em que fun√ß√£o est√° implementada. Esta pr√°tica √© importante por que com frequ√™ncia pacotes diferentes criam fun√ß√µes com mesmo nome, mas com caracter√≠sticas internas (argumentos) diferentes. Assim, n√£o expressar o pacote de interesse pode gerar erros na execu√ß√£o de suas an√°lises. Destacamos aqui o exemplo de como instalar pacotes GitHub pacote devtools.","code":"\n## N√∫mero atual de pacotes no CRAN\nnrow(available.packages())\n#> [1] 18963\n## Verificar pacotes carregados\nsearch()\n## Verificar pacotes instalados\nlibrary()\n## Instalar pacotes\ninstall.packages(\"vegan\")\n## Diret√≥rios de intala√ß√£o dos pacotes\n.libPaths()\n#> [1] \"/home/mude/R/x86_64-pc-linux-gnu-library/4.1\" \"/usr/local/lib/R/site-library\"               \n#> [3] \"/usr/lib/R/site-library\"                      \"/usr/lib/R/library\"\n## Carregar pacotes\nlibrary(vegan)\n## Instalar pacote devtools\ninstall.packages(\"devtools\")\n\n## Carregar pacote devtools\nlibrary(devtools)\n## Instalar pacote do github\ndevtools::install_github(\"paternogbc/ecodados\")\n\n## Carregar pacote do github\nlibrary(\"ecodados\")\n## Download do arquivo .tar.gz\ndownload.file(url = \"https://cran.r-project.org/src/contrib/Archive/vegan/vegan_2.4-0.tar.gz\",\n              destfile = \"vegan_2.4-0.tar.gz\", mode = \"auto\")\n\n## Instalar o pacote vegan 2.4.0\ninstall.packages(\"vegan_2.4-0.tar.gz\", repos = NULL, type = \"source\")\n## Descri√ß√£o de um pacote\npackageDescription(\"vegan\")\n#> Package: vegan\n#> Title: Community Ecology Package\n#> Version: 2.5-7\n#> Author: Jari Oksanen, F. Guillaume Blanchet, Michael Friendly, Roeland Kindt, Pierre Legendre, Dan McGlinn,\n#>             Peter R. Minchin, R. B. O'Hara, Gavin L. Simpson, Peter Solymos, M. Henry H. Stevens, Eduard\n#>             Szoecs, Helene Wagner\n#> Maintainer: Jari Oksanen <jhoksane@gmail.com>\n#> Depends: permute (>= 0.9-0), lattice, R (>= 3.4.0)\n#> Suggests: parallel, tcltk, knitr, markdown\n#> Imports: MASS, cluster, mgcv\n#> VignetteBuilder: utils, knitr\n#> Description: Ordination methods, diversity analysis and other functions for community and vegetation\n#>             ecologists.\n#> License: GPL-2\n#> BugReports: https://github.com/vegandevs/vegan/issues\n#> URL: https://cran.r-project.org, https://github.com/vegandevs/vegan\n#> NeedsCompilation: yes\n#> Packaged: 2020-11-27 13:22:03 UTC; jarioksa\n#> Repository: CRAN\n#> Date/Publication: 2020-11-28 15:10:02 UTC\n#> Built: R 4.1.2; x86_64-pc-linux-gnu; 2022-01-14 17:10:16 UTC; unix\n#> \n#> -- File: /home/mude/R/x86_64-pc-linux-gnu-library/4.1/vegan/Meta/package.rds\n## Carregar dados de um pacote\nlibrary(vegan)\ndata(dune)\ndune[1:6, 1:6]\n#>   Achimill Agrostol Airaprae Alopgeni Anthodor Bellpere\n#> 1        1        0        0        0        0        0\n#> 2        3        0        0        2        0        3\n#> 3        0        4        0        7        0        2\n#> 4        0        8        0        2        0        2\n#> 5        2        0        0        0        4        2\n#> 6        2        0        0        0        3        0\n## Desinstalar um pacote\nremove.packages(\"vegan\")\n\n## Descarregar um pacote\ndetach(\"package:vegan\", unload = TRUE)\n## Atualiza√ß√£o dos pacotes\nupdate.packages(checkBuilt = TRUE, ask = FALSE)\n## Atualiza√ß√£o dos pacotes instalados pelo GitHub\ndtupdate::github_update(auto.install = TRUE, ask = FALSE)\n## Pacote seguido da fun√ß√£o implementada daquele pacote\ndevtools::install_github()"},{"path":"cap4.html","id":"ajuda-help","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.3.7 Ajuda (Help)","text":"Um importante passo para melhorar usabilidade e ter mais familiaridade com linguagem R √© aprender usar ajuda (help) de cada fun√ß√£o. Para tanto, podemos utilizar fun√ß√£o help() ou o operador ?, depois de ter carregado o pacote, para abrir uma nova aba (Figura 4.2 janela 4) que possui diversas informa√ß√µes sobre fun√ß√£o de interesse. O arquivo de ajuda R possui geralmente nove ou dez t√≥picos, que nos auxiliam muito entendimento dos dados de entrada, argumentos e que opera√ß√µes est√£o sendo realizadas. Abaixo descrever esses t√≥picos:Description: resumo da fun√ß√£oUsage: como utilizar fun√ß√£o e quais os seus argumentosArguments: detalha os argumentos e como os mesmos devem ser especificadosDetails: detalhes importantes para se usar fun√ß√£oValue: mostra como interpretar sa√≠da (output) da fun√ß√£o (os resultados)Note: notas gerais sobre fun√ß√£oAuthors: autores da fun√ß√£oReferences: refer√™ncias bibliogr√°ficas para os m√©todos usados para constru√ß√£o da fun√ß√£oSee also: fun√ß√µes relacionadasExamples: exemplos uso da fun√ß√£o. √Äs vezes pode ser √∫til copiar esse trecho e colar R para ver como funciona e como usar fun√ß√£o.Vamos realizar um exemplo, buscando o help da fun√ß√£o aov(), que realiza uma an√°lise de vari√¢ncia (veja detalhes Cap√≠tulo 7).Al√©m das fun√ß√µes, podemos buscar detalhes de um pacote espec√≠fico, para uma p√°gina simples help utilizando fun√ß√£o help() ou o operador ?. Entretanto, para uma op√ß√£o que ofere√ßa uma descri√ß√£o detalhada e um √≠ndice de todas fun√ß√µes pacote, podemos utilizar fun√ß√£o library(), mas agora utilizando o argumento help, indicando o pacote de interesse entre aspas.Podemos ainda procurar o nome de uma fun√ß√£o para realizar uma an√°lise espec√≠fica utilizando fun√ß√£o help.search() com o termo que queremos em ingl√™s e entre aspas.Outra ferramenta de busca √© p√°gina rseek, na qual √© poss√≠vel buscar por um termo n√£o s√≥ nos pacotes R, mas tamb√©m em listas de emails, manuais, p√°ginas na internet e livros sobre o programa.","code":"\n## Ajuda\nhelp(aov)\n?aov\n## Ajuda do pacote\nhelp(vegan)\n?vegan\n\n## Help detalhado\nlibrary(help = \"vegan\")\n## Procurar por fun√ß√µes que realizam modelos lineares\nhelp.search(\"linear models\")"},{"path":"cap4.html","id":"ambiente-environment","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.3.8 Ambiente (Environment)","text":"O ambiente Environment como vimos √© onde os objetos criados s√£o armazenados. √â fundamental entender que um objeto √© uma aloca√ß√£o de um pequeno espa√ßo na mem√≥ria RAM nosso computador, onde o R armazenar√° um valor ou o resultado de uma fun√ß√£o, utilizando o nome dos objetos que definimos na atribui√ß√£o. Sendo assim, se fizermos uma atribui√ß√£o de um objeto maior que o tamanho da mem√≥ria RAM nosso computador, esse objeto n√£o ser√° alocado, e atribui√ß√£o n√£o funcionar√°, retornando um erro. Existem op√ß√µes para contornar esse tipo de limita√ß√£o, mas n√£o abordaremos aqui. Entretanto, podemos utilizar fun√ß√£o object.size() para saber quanto espa√ßo nosso objeto criado est√° alocando de mem√≥ria RAM.Podemos listar todos os objetos criados com fun√ß√£o ls() ou objects().Podemos ainda remover todos os objetos criados com fun√ß√£o rm() ou remove(). Ou ainda fazer uma fun√ß√£o composta para remover todos os objetos Environment.Quando usamos fun√ß√£o ls() agora, nenhum objeto √© listado.Toda vez que fechamos o R os objetos criados s√£o apagados Environment. Dessa forma, em algumas ocasi√µes, por exemplo, an√°lises estat√≠sticas que demoram um grande tempo para serem realizadas, pode ser interessante exportar alguns ou todos os objetos criados.Para salvar todos os objetos, ou seja, todo o Workspace, podemos ir em Session -> Save Workspace ... e escolher o nome arquivo Workspace, por exemplo, ‚Äúmeu_workspace.RData.‚Äù Podemos ainda utilizar fun√ß√µes para essas tarefas. fun√ß√£o save.image() salva todo Workspace com extens√£o .RData.Depois disso, podemos fechar o RStudio tranquilamente e quando formos trabalhar novamente, podemos carregar os objetos criados indo em Session -> Load Workspace... ou utilizando fun√ß√£o load().Entretanto, em algumas ocasi√µes, n√£o precisamos salvar todos os objetos. Dessa forma, podemos salvar apenas alguns objetos espec√≠ficos usando fun√ß√£o save(), tamb√©m com extens√£o .RData.Ou ainda podemos salvar apenas um objeto com extens√£o .rds. Para isso, usamos fun√ß√µes saveRDS() e readRDS(), para exportar e importar esses dados, respectivamente. √â importante ressaltar que nesse formato .rds, apenas um objeto √© salvo por arquivo criado e que para que o objeto seja criado Workspace R, ele precisa ser lido e atribu√≠do √† um objeto.","code":"\n## Tamanho de um objeto\nobject.size(adi)\n#> 56 bytes\n## Listar todos os objetos\nls()\n## Remover um objeto\nrm(adi)\n\n## Remover todos os objetos criados\nrm(list = ls())\n## Listar todos os objetos\nls()\n#> character(0)\n## Salvar todo o workspace\nsave.image(file = \"meu_workspace.RData\")\n## Carregar todo o workspace\nload(\"meu_workspace.RData\")\n## Salvar apenas um objeto\nsave(obj1, file = \"meu_obj.RData\")\n\n## Salvar apenas um objeto\nsave(obj1, obj2, file = \"meus_objs.RData\")\n\n## Carregar os objetos\nload(\"meus_objs.RData\")\n## Salvar um objeto para um arquivo\nsaveRDS(obj, file = \"meu_obj.rds\")\n\n## Carregar esse objeto\nobj <- readRDS(file = \"meu_obj.rds\")"},{"path":"cap4.html","id":"cita√ß√µes","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.3.9 Cita√ß√µes","text":"Ao utilizar o R para realizar alguma an√°lise em nossos estudos, √© fundamental cita√ß√£o mesmo. Para saber como citar o R em artigos, existe uma fun√ß√£o denominada citation(), que prov√™ um formato gen√©rico de cita√ß√£o e um BibTeX para arquivos LaTeX e R Markdown.resultado dessa fun√ß√£o, h√° uma mensagem muito interessante: ‚ÄúSee also ‚Äòcitation(‚Äúpkgname‚Äù)‚Äô citing R packages.‚Äù Dessa forma, aconselhamos, sempre que poss√≠vel, claro, citar tamb√©m os pacotes utilizados nas an√°lises para dar os devidos cr√©ditos aos desenvolvedores e desenvolvedoras das fun√ß√µes implementadas nos pacotes. Como exemplo, vamos ver como fica cita√ß√£o pacote vegan.Podemos ainda utilizar fun√ß√£o write_bib() pacote knitr para exportar cita√ß√£o pacote formato .bib.","code":"\n## Cita√ß√£o do R\ncitation()\n#> \n#> To cite R in publications use:\n#> \n#>   R Core Team (2021). R: A language and environment for statistical computing. R Foundation for Statistical\n#>   Computing, Vienna, Austria. URL https://www.R-project.org/.\n#> \n#> A BibTeX entry for LaTeX users is\n#> \n#>   @Manual{,\n#>     title = {R: A Language and Environment for Statistical Computing},\n#>     author = {{R Core Team}},\n#>     organization = {R Foundation for Statistical Computing},\n#>     address = {Vienna, Austria},\n#>     year = {2021},\n#>     url = {https://www.R-project.org/},\n#>   }\n#> \n#> We have invested a lot of time and effort in creating R, please cite it when using it for data analysis. See\n#> also 'citation(\"pkgname\")' for citing R packages.\n## Cita√ß√£o do pacote vegan\ncitation(\"vegan\")\n#> \n#> To cite package 'vegan' in publications use:\n#> \n#>   Jari Oksanen, F. Guillaume Blanchet, Michael Friendly, Roeland Kindt, Pierre Legendre, Dan McGlinn, Peter\n#>   R. Minchin, R. B. O'Hara, Gavin L. Simpson, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs and Helene\n#>   Wagner (2020). vegan: Community Ecology Package. R package version 2.5-7.\n#>   https://CRAN.R-project.org/package=vegan\n#> \n#> A BibTeX entry for LaTeX users is\n#> \n#>   @Manual{,\n#>     title = {vegan: Community Ecology Package},\n#>     author = {Jari Oksanen and F. Guillaume Blanchet and Michael Friendly and Roeland Kindt and Pierre Legendre and Dan McGlinn and Peter R. Minchin and R. B. O'Hara and Gavin L. Simpson and Peter Solymos and M. Henry H. Stevens and Eduard Szoecs and Helene Wagner},\n#>     year = {2020},\n#>     note = {R package version 2.5-7},\n#>     url = {https://CRAN.R-project.org/package=vegan},\n#>   }\n#> \n#> ATTENTION: This citation information has been auto-generated from the package DESCRIPTION file and may need\n#> manual editing, see 'help(\"citation\")'.\n## Exportar uma cita√ß√£o em formato .bib\nknitr::write_bib(\"vegan\", file = \"vegan_ex.bib\")"},{"path":"cap4.html","id":"principais-erros-de-iniciantes","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.3.10 Principais erros de iniciantes","text":"Errar quando est√° come√ßando usar o R √© muito comum e faz parte aprendizado. Entretanto, os erros nunca devem ser encarados como uma forma de desest√≠mulo, mas sim como um desafio para continuar tentando. Todos n√≥s, autores desse livro, e provavelmente usu√°rios mais ou menos experientes, j√° passaram por um momento em que se quer desistir de tudo. Jovem aprendiz de R, √∫nica diferen√ßa entre voc√™ que est√° iniciando agora e n√≥s que usamos h√° mais tempo s√£o horas mais de uso (e √≥dio). O que temos mais √© experi√™ncia para olhar o erro, l√™-lo e conseguir interpretar o que est√° errado e saber buscar ajuda.Dessa forma, o ponto mais importante de quem est√° iniciando √© ter paci√™ncia, calma, bom humor, ler e entender mensagens de erros. Recomendamos uma pr√°tica que pode ajudar: caso n√£o esteja conseguindo resolver alguma parte seu c√≥digo, deixe ele de lado um tempo, descanse, fa√ßa uma caminhada, tome um banho, converse com seus animais de estima√ß√£o ou plantas, tenha um pato de borracha ou outro objeto inanimado (um dos autores tem um sapinho de madeira), explique esse c√≥digo para esse pato (processo conhecido como Debug com Pato de Borracha), logo solu√ß√£o deve aparecer.Listaremos aqui o que consideramos os principais erros dos iniciantes R.1. Esquecer de completar uma fun√ß√£o ou bloco de c√≥digosEsquecer de completar uma fun√ß√£o ou bloco de c√≥digos √© algo bem comum. Geralmente esquecemos de fechar aspas \"\" ou par√™nteses (), mas geralmente o R nos informa isso, indicando um s√≠mbolo de + console. Se voc√™ cometeu esse erro, lembre-se de apertar tecla esc seu computador clicando antes com o cursor mouse console R.2. Esquecer de v√≠rgulas dentro de fun√ß√µesOutro erro bastante comum √© esquecer de acrescentar v√≠rgula , para separar argumentos dentro de uma fun√ß√£o, principalmente se estamos compondo v√°rias fun√ß√µes acopladas, .e., uma fun√ß√£o dentro da outra.3. Chamar um objeto pelo nome erradoPode parecer simples, mas esse √© de longe o erro mais comum que pessoas iniciantes comentem. Quando temos um script longo, √© de se esperar que tenhamos atribu√≠do diversos objetos e em algum momento atribu√≠mos um nome qual n√£o lembramos. Dessa forma, quando chamamos o objeto ele n√£o existe e o console informa um erro. Entretanto, esse tipo de erro pode ser facilmente identificado, como o exemplo abaixo.4. Esquecer de carregar um pacoteEsse tamb√©m √© um erro recorrente, mesmo para usu√°rios mais experientes. Em scripts de an√°lises complexas, que requerem v√°rios pacotes, geralmente esquecemos de um ou outro pacote. melhor forma de evitar esse tipo de erro √© listar os pacotes que vamos precisar usar logo in√≠cio script.Geralmente mensagem de erro ser√° de que fun√ß√£o n√£o foi encontrada ou algo nesse sentido. Carregando o pacote, esse erro √© contornado.5. Usar o nome da fun√ß√£o de forma err√¥neaEsse erro n√£o √© t√£o comum, mas pode ser inc√¥modo √†s vezes. Algumas fun√ß√µes possuem nomes padr√£o ‚ÄúCamel Case,‚Äù .e., com letras mai√∫sculas meio nome da fun√ß√£o. Isso √†s vezes pode confundir, ou ainda, fun√ß√µes podem ou n√£o ser separadas com ., como row.names() e rownames(). Cap√≠tulo 5 sobre tidyverse, veremos que houve uma tentativa de padroniza√ß√£o nos nomes das fun√ß√µes para ‚ÄúSnake Case,‚Äù .e, todas fun√ß√µes possuem letras min√∫sculas, com palavras separadas por underscore _.6. Atentar para o diret√≥rio corretoMuitas vezes o erro √© simplesmente porque o usu√°rio() n√£o definiu o diret√≥rio correto onde est√° o arquivo ser importado ou exportado. Por isso √© fundamental sempre verificar se o diret√≥rio foi definido corretamente, geralmente usando fun√ß√µes dir() ou list.files() para listar console lista de arquivos diret√≥rio. Podemos ainda usar o argumento pattern para listar arquivos por um padr√£o textual.Al√©m disso, √© fundamental ressaltar import√¢ncia de verificar se o nome arquivo que importaremos foi digitado corretamente, atentando-se tamb√©m para extens√£o: .csv, .txt, .xlsx, etc.","code":"sum(1, 2\n  +\n#> Error: <text>:3:0: unexpected end of input\n#> 1: sum(1, 2\n#> 2:   +\n#>   ^sum(1 2)\n#> Error: <text>:1:7: unexpected numeric constant\n#> 1: sum(1 2\n#>           ^\nobj <- 10\nOBJ\n#> Error in eval(expr, envir, enclos): object 'OBJ' not found\n## Carregar dados\ndata(dune)\n\n## Fun√ß√£o do pacote vegan\ndecostand(dune[1:6, 1:6], \"hell\")\n#> Error in decostand(dune[1:6, 1:6], \"hell\"): could not find function \"decostand\"\n## Carregar o pacote\nlibrary(vegan)\n\n## Carregar dados\ndata(dune)\n\n## Fun√ß√£o do pacote vegan\ndecostand(dune[1:6, 1:6], \"hell\")\n#>    Achimill  Agrostol Airaprae  Alopgeni  Anthodor  Bellpere\n#> 1 1.0000000 0.0000000        0 0.0000000 0.0000000 0.0000000\n#> 2 0.6123724 0.0000000        0 0.5000000 0.0000000 0.6123724\n#> 3 0.0000000 0.5547002        0 0.7337994 0.0000000 0.3922323\n#> 4 0.0000000 0.8164966        0 0.4082483 0.0000000 0.4082483\n#> 5 0.5000000 0.0000000        0 0.0000000 0.7071068 0.5000000\n#> 6 0.6324555 0.0000000        0 0.0000000 0.7745967 0.0000000\n## Soma das colunas\ncolsums(dune)\n#> Error in colsums(dune): could not find function \"colsums\"\n## Soma das colunas\ncolSums(dune)\n#> Achimill Agrostol Airaprae Alopgeni Anthodor Bellpere Bromhord Chenalbu Cirsarve Comapalu Eleopalu Elymrepe Empenigr \n#>       16       48        5       36       21       13       15        1        2        4       25       26        2 \n#> Hyporadi Juncarti Juncbufo Lolipere Planlanc  Poaprat  Poatriv Ranuflam Rumeacet Sagiproc Salirepe Scorautu Trifprat \n#>        9       18       13       58       26       48       63       14       18       20       11       54        9 \n#> Trifrepe Vicilath Bracruta Callcusp \n#>       47        4       49       10\n## Listar os arquivos do diret√≥rio definido\ndir()\nlist.files()\n\n## Listar os arquivos do diret√≥rio definido por um padr√£o\ndir(pattern = \".csv\")"},{"path":"cap4.html","id":"estrutura-e-manipula√ß√£o-de-objetos","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.4 Estrutura e manipula√ß√£o de objetos","text":"O conhecimento sobre estrutura e manipula√ß√£o de objetos √© fundamental para ter dom√≠nio e entendimento funcionamento da linguagem R. Nesta se√ß√£o, trataremos da estrutura e manipula√ß√£o de dados R, que ficou conhecido como modo R Base, em contrapartida ao tidyverse, t√≥pico tratado Cap√≠tulo 5. Abordaremos aqui temas chaves, como: ) atributos de objetos, ii) manipula√ß√£o de objetos unidimensionais e multidimensionais, iii) valores faltantes e especiais, iv) diret√≥rio de trabalho e v) importar, conferir e exportar dados tabulares.","code":""},{"path":"cap4.html","id":"atributo-dos-objetos","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.4.1 Atributo dos objetos","text":"Quando fazemos atribui√ß√µes de dados R (<-), os objetos gerados possuem tr√™s caracter√≠sticas.Nome: palavra que o R reconhece os dados atribu√≠dosConte√∫do: dados em siAtributos: modos (natureza) e estruturas (organiza√ß√£o) dos elementosVamos explorar mais fundo os modos e estruturas dos objetos. Vale ressaltar que isso √© uma simplifica√ß√£o, pois h√° muitas classes de objetos, como fun√ß√µes e sa√≠das de fun√ß√µes que possuem outros atributos.Podemos verificar os atributos dos objetos com fun√ß√£o attributes().Modo dos objetosA depender da natureza dos elementos que comp√µem os dados e que foram atribu√≠dos aos objetos, esses objetos podem ser, de forma simples um dos cinco modos: num√©rico tipo inteiro (integer), num√©rico tipo flutuante (double), texto (character), l√≥gico (logical) ou complexo (complex).atribui√ß√£o de n√∫meros R pode gerar dois tipos de modos: integer para n√∫meros inteiros e double para n√∫meros flutuantes ou com decimais.t√≠tulo de praticidade, ambos s√£o incorporados como o modo numeric, com o tipo double, menos que especifiquemos que seja inteiro com letra L depois n√∫mero, representando palavra Larger, geralmente usando para armazenar n√∫meros muito grandes.Al√©m de n√∫meros, podemos atribuir textos, utilizando para isso aspas \"\".Em algumas situa√ß√µes, precisamos indicar ocorr√™ncia ou n√£o de um evento ou uma opera√ß√£o. Para isso, utilizamos palavras reservadas (TRUE e FALSE), chamadas de vari√°veis booleanas, pois assumem apenas duas possibilidades: falso (0) ou verdadeiro (1). Devemos nos ater para o fato dessas palavras serem escritas com letras mai√∫sculas e sem aspas.Por fim, existe um modo pouco utilizado que cria n√∫meros complexos (raiz de n√∫meros negativos).Podemos verificar o modo dos objetos ou fazer convers√£o entre esses modos com diversas fun√ß√µes.Estrutura dos objetosUma vez entendido natureza dos modos dos elementos dos objetos R, podemos passar para o passo seguinte e entender como esses elementos s√£o estruturados dentro dos objetos.Essa estrutura√ß√£o ir√° nos contar sobre organiza√ß√£o dos elementos, com rela√ß√£o aos modos e dimensionalidade da disposi√ß√£o dos elementos (Figura 4.3. De modo bem simples, os elementos podem ser estruturados em cinco tipos:Vetores e fatores: homog√™neo (um modo) e unidimensional (uma dimens√£o). Um tipo especial de vetor s√£o os fatores, usados para designar vari√°veis categ√≥ricasMatrizes: homog√™neo (um modo) e bidimensional (duas dimens√µes)Arrays: homog√™neo (um modo) e multidimensional (mais de duas dimens√µes)Data frames: heterog√™neo (mais de um modo) e bidimensional (duas dimens√µes)Listas: heterog√™neo (mais de um modo) e unidimensional (uma dimens√£o)\nFigura 4.3: Estruturas de dados mais comuns R: vetores, matrizes, arrays, listas e data frames. Adaptado de Grolemund (2014)).\nVetorVetores representam o encadeamento de elementos numa sequ√™ncia unidimensional. Cap√≠tulo 2 na Figura 2.2, vimos o conceito de vari√°vel aleat√≥ria e seus tipos. R, essas vari√°veis podem ser operacionalizadas como vetores. Dessa forma, essa estrutura de dados pode ser traduzida como medidas de uma vari√°vel num√©rica (discretas ou cont√≠nuas), vari√°vel bin√°ria (booleana - TRUE e FALSE) ou descri√ß√£o (informa√ß√µes em texto).H√° diversas formas de se criar um vetor R:Concatenando elementos com fun√ß√£o c()Criando sequ√™ncias unit√°rias : ou com fun√ß√£o seq()Criando repeti√ß√µes com fun√ß√£o rep()‚ÄúColar‚Äù palavras com uma sequ√™ncia num√©rica com fun√ß√£o paste() ou paste0()Amostrando aleatoriamente elementos com fun√ß√£o sample()Como os vetores s√£o homog√™neos, .e., s√≥ comportam um modo, quando combinamos mais de um modo mesmo objeto ocorre uma domin√¢ncia de modos. Existe, dessa forma, uma coer√ß√£o dos elementos combinados para que todos fiquem iguais. Essa domin√¢ncia segue essa ordem:DOMINANTE character > double > integer > logical RECESSIVOAl√©m disso, podemos utilizar convers√µes listadas anteriormente para alterar os modos. Vamos exemplificar combinando os vetores criados anteriormente e convertendo-os.FatorO fator representa medidas de uma vari√°vel categ√≥rica, podendo ser nominal ou ordinal. √â fundamental destacar que fatores R devem ser entendidos como um vetor de integer, .e., ele √© composto por n√∫meros inteiros representando os n√≠veis da vari√°vel categ√≥rica.Para criar um fator R usamos uma fun√ß√£o espec√≠fica factor(), na qual podemos especificar os n√≠veis com o argumento level, ou fazemos uma convers√£o usando fun√ß√£o .factor(). Trabalhar com fatores R Base n√£o √© das tarefas mais agrad√°veis, sendo assim, Cap√≠tulo 5 usamos vers√£o tidyverse usando o pacote forcats. Destacamos ainda exist√™ncia de fatores nominais para vari√°veis categ√≥ricas nominais e fatores ordinais para vari√°veis categ√≥ricas ordinais, quando h√° ordenamento entre os n√≠veis, como dias da semana ou classes de altura.MatrizA matriz representa dados formato de tabela, com linhas e colunas. linhas geralmente representam unidades amostrais (locais, transectos, parcelas) e colunas representam vari√°veis num√©ricas (discretas ou cont√≠nuas), vari√°veis bin√°rias (TRUE ou FALSE) ou descri√ß√µes (informa√ß√µes em texto).Podemos criar matrizes R de duas formas. primeira delas dispondo elementos de um vetor em um certo n√∫mero de linhas e colunas com fun√ß√£o matrix(), podendo preencher essa matriz com os elementos vetor por linhas ou por colunas alterando o argumento byrow.segundo forma, podemos combinar vetores, utilizando fun√ß√£o rbind() para combinar vetores por linha, .e., um vetor embaixo outro, e cbind() para combinar vetores por coluna, .e., um vetor ao lado outro.ArrayO array representa combina√ß√£o de tabelas, com linhas, colunas e dimens√µes. Essa combina√ß√£o pode ser feita em m√∫ltiplas dimens√µes, mas apesar disso, geralmente √© mais comum o uso em Ecologia para tr√™s dimens√µes, por exemplo: linhas (unidades amostrais), colunas (esp√©cies) e dimens√£o (tempo). Isso gera um ‚Äúcubo m√°gico‚Äù ou ‚Äúcartas de um baralho,‚Äù onde podemos comparar, nesse caso, comunidades ao longo tempo. Al√©m disso, arrays tamb√©m s√£o muito comuns em morfometria geom√©trica ou sensoriamento remoto.Podemos criar arrays R dispondo elementos de um vetor em um certo n√∫mero de linhas, colunas e dimens√µes com fun√ß√£o array(). Em nosso exemplo, vamos compor cinco comunidades de cinco esp√©cies ao longo de tr√™s per√≠odos.Data frameO data frame tamb√©m representa dados formato de tabela, com linhas e colunas, muito semelhante √† matriz. Mas diferentemente das matrizes, os data frames comportam mais de um modo em suas colunas. Dessa forma, linhas data frame ainda representam unidades amostrais (locais, transectos, parcelas), mas colunas agora podem representar descri√ß√µes (informa√ß√µes em texto), vari√°veis num√©ricas (discretas ou cont√≠nuas), vari√°veis bin√°rias (TRUE ou FALSE) e vari√°veis categ√≥ricas (nominais ou ordinais).forma mais simples de se criar data frames R √© atrav√©s da combina√ß√£o de vetores. Essa combina√ß√£o √© feita com fun√ß√£o data.frame() e ocorre de forma horizontal, semelhante √† fun√ß√£o cbind(). Sendo assim, todos os vetores precisam ter o mesmo n√∫mero de elementos, ou seja, o mesmo comprimento. Podemos ainda nomear colunas de cada vetor. Outra forma, seria converter uma matriz em um data frame, utilizando fun√ß√£o .data.frame().ListaA lista √© um tipo especial de vetor que aceita objetos como elementos. Ela √© estrutura de dados utilizada para agrupar objetos, e √© geralmente sa√≠da de muitas fun√ß√µes.Podemos criar listas atrav√©s da fun√ß√£o list(). Essa fun√ß√£o funciona de forma semelhante √† fun√ß√£o c() para cria√ß√£o de vetores, mas agora estamos concatenando objetos. Podemos ainda nomear os elementos (objetos) que estamos combinando.Um ponto interessante para entender data frames, √© que eles s√£o listas, em que todos os elementos (colunas) possuem o mesmo n√∫mero de elementos, ou seja, mesmo comprimento.Fun√ß√µesUma √∫ltima estrutura de objetos criados R s√£o fun√ß√µes. Elas s√£o objetos criados pelo usu√°rio e reutilizados para fazer opera√ß√µes espec√≠ficas. cria√ß√£o de fun√ß√µes geralmente √© um t√≥pico tratado num segundo momento, quando o usu√°rio de R adquire certo conhecimento da linguagem. Aqui abordaremos apenas seu funcionamento b√°sico, diferenciando sua estrutura para entendimento e sua diferencia√ß√£o das demais estruturas.Vamos criar uma fun√ß√£o simples que retorna multiplica√ß√£o de dois termos. Criaremos fun√ß√£o com o nome multi, √† qual ser√° atribu√≠da uma fun√ß√£o com o nome function(), com dois argumentos x e y. Depois disso abrimos chaves {}, que √© onde iremos incluir nosso bloco de c√≥digo. Nosso bloco de c√≥digo √© composto por duas linhas, primeira contendo opera√ß√£o de multiplica√ß√£o dos argumento com atribui√ß√£o ao objeto mu e segunda contendo fun√ß√£o return() para retornar o valor da multiplica√ß√£o.","code":"\n## Atributos\nattributes(dune)\n#> $names\n#>  [1] \"Achimill\" \"Agrostol\" \"Airaprae\" \"Alopgeni\" \"Anthodor\" \"Bellpere\" \"Bromhord\" \"Chenalbu\" \"Cirsarve\" \"Comapalu\"\n#> [11] \"Eleopalu\" \"Elymrepe\" \"Empenigr\" \"Hyporadi\" \"Juncarti\" \"Juncbufo\" \"Lolipere\" \"Planlanc\" \"Poaprat\"  \"Poatriv\" \n#> [21] \"Ranuflam\" \"Rumeacet\" \"Sagiproc\" \"Salirepe\" \"Scorautu\" \"Trifprat\" \"Trifrepe\" \"Vicilath\" \"Bracruta\" \"Callcusp\"\n#> \n#> $row.names\n#>  [1] \"1\"  \"2\"  \"3\"  \"4\"  \"5\"  \"6\"  \"7\"  \"8\"  \"9\"  \"10\" \"11\" \"12\" \"13\" \"14\" \"15\" \"16\" \"17\" \"18\" \"19\" \"20\"\n#> \n#> $class\n#> [1] \"data.frame\"\n## Num√©rico double\nobj_numerico_double <- 1\n\n## Modo\nmode(obj_numerico_double)\n#> [1] \"numeric\"\n\n## Tipo\ntypeof(obj_numerico_double)\n#> [1] \"double\"\n## Num√©rico integer\nobj_numerico_inteiro <- 1L\n\n## Modo\nmode(obj_numerico_inteiro)\n#> [1] \"numeric\"\n\n## Tipo\ntypeof(obj_numerico_inteiro)\n#> [1] \"integer\"\n## Caracter ou string\nobj_caracter <- \"a\" # atencao para as aspas\n\n## Modo\nmode(obj_caracter)\n#> [1] \"character\"\n## L√≥gico\nobj_logico <- TRUE # maiusculas e sem aspas\n\n## Modo\nmode(obj_logico)\n#> [1] \"logical\"\n## Complexo\nobj_complexo <- 1+1i\n\n## Modo\nmode(obj_complexo)\n#> [1] \"complex\"\n## Verificar o modo dos objetos\nis.numeric()\nis.integer()\nis.character()\nis.logical()\nis.complex()\n\n## Convers√µes entre modos\nas.numeric()\nas.integer()\nas.character()\nas.logical()\nas.complex()\n\n## Exemplo\nnum <- 1:5\nnum\nclass(num)\n\nfac <- as.factor(num)\nfac\nclass(fac)\n## Concatenar elementos num√©ricos\nconcatenar <- c(15, 18, 20, 22, 18)\nconcatenar\n#> [1] 15 18 20 22 18\n\n## Sequ√™ncia unit√°ria (x1:x2)\nsequencia <- 1:10\nsequencia\n#>  [1]  1  2  3  4  5  6  7  8  9 10\n\n## Sequ√™ncia com diferentes espa√ßamentos \nsequencia_esp <- seq(from = 0, to = 100, by = 10) \nsequencia_esp\n#>  [1]   0  10  20  30  40  50  60  70  80  90 100\n\n## Repeti√ß√£o\nrepeticao <- rep(x = c(TRUE, FALSE), times = 5)\nrepeticao\n#>  [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE\n\n## Cola palavra e sequ√™ncia num√©rica\ncolar <- paste(\"amostra\", 1:5)\ncolar\n#> [1] \"amostra 1\" \"amostra 2\" \"amostra 3\" \"amostra 4\" \"amostra 5\"\n\n## Amostragem aleat√≥ria\namostragem <- sample(x = 1:100, size = 10)\namostragem\n#>  [1] 45 23 76 63 47 31 68 73 69  5\n## Coer√ß√£o\nc(colar, amostragem)\n#>  [1] \"amostra 1\" \"amostra 2\" \"amostra 3\" \"amostra 4\" \"amostra 5\" \"45\"        \"23\"        \"76\"        \"63\"       \n#> [10] \"47\"        \"31\"        \"68\"        \"73\"        \"69\"        \"5\"\n\n## Convers√£o\nas.numeric(repeticao)\n#>  [1] 1 0 1 0 1 0 1 0 1 0\n## Fator nominal\nfator_nominal <- factor(x = sample(x = c(\"floresta\", \"pastagem\", \"cerrado\"), \n                                   size = 20, replace = TRUE),\n                        levels = c(\"floresta\", \"pastagem\", \"cerrado\"))\nfator_nominal\n#>  [1] cerrado  cerrado  floresta pastagem pastagem cerrado  cerrado  pastagem cerrado  floresta floresta floresta pastagem\n#> [14] pastagem cerrado  cerrado  pastagem cerrado  floresta pastagem\n#> Levels: floresta pastagem cerrado\n\n## Fator ordinal\nfator_ordinal <- factor(x = sample(x = c(\"baixa\", \"media\", \"alta\"), \n                                   size = 20, replace = TRUE),\n                        levels = c(\"baixa\", \"media\", \"alta\"), ordered = TRUE)\nfator_ordinal\n#>  [1] alta  alta  baixa media baixa media alta  media baixa media baixa media alta  baixa media media alta  media baixa\n#> [20] baixa\n#> Levels: baixa < media < alta\n\n## Convers√£o\nfator <- as.factor(x = sample(x = c(\"floresta\", \"pastagem\", \"cerrado\"), \n                              size = 20, replace = TRUE))\nfator\n#>  [1] cerrado  pastagem floresta floresta cerrado  cerrado  pastagem cerrado  pastagem cerrado  pastagem cerrado  pastagem\n#> [14] pastagem floresta cerrado  pastagem pastagem cerrado  floresta\n#> Levels: cerrado floresta pastagem\n## Vetor\nve <- 1:12\n\n## Matrix - preenchimento por linhas - horizontal\nma_row <- matrix(data = ve, nrow = 4, ncol = 3, byrow = TRUE)\nma_row\n#>      [,1] [,2] [,3]\n#> [1,]    1    2    3\n#> [2,]    4    5    6\n#> [3,]    7    8    9\n#> [4,]   10   11   12\n\n## Matrix - preenchimento por colunas - vertical\nma_col <- matrix(data = ve, nrow = 4, ncol = 3, byrow = FALSE)\nma_col\n#>      [,1] [,2] [,3]\n#> [1,]    1    5    9\n#> [2,]    2    6   10\n#> [3,]    3    7   11\n#> [4,]    4    8   12\n## Criar dois vetores\nvec_1 <- c(1, 2, 3)\nvec_2 <- c(4, 5, 6)\n\n## Combinar por linhas - vertical - um embaixo do outro\nma_rbind <- rbind(vec_1, vec_2)\nma_rbind\n#>       [,1] [,2] [,3]\n#> vec_1    1    2    3\n#> vec_2    4    5    6\n\n## Combinar por colunas - horizontal - um ao lado do outro\nma_cbind <- cbind(vec_1, vec_2)\nma_cbind\n#>      vec_1 vec_2\n#> [1,]     1     4\n#> [2,]     2     5\n#> [3,]     3     6\n## Array\nar <- array(data = sample(x = c(0, 1), size = 75, rep = TRUE), \n            dim = c(5, 5, 3))\nar\n#> , , 1\n#> \n#>      [,1] [,2] [,3] [,4] [,5]\n#> [1,]    1    0    1    1    0\n#> [2,]    1    0    1    1    0\n#> [3,]    1    1    1    1    1\n#> [4,]    0    1    0    1    0\n#> [5,]    1    0    1    0    0\n#> \n#> , , 2\n#> \n#>      [,1] [,2] [,3] [,4] [,5]\n#> [1,]    0    0    0    1    0\n#> [2,]    0    1    0    1    0\n#> [3,]    1    1    1    1    0\n#> [4,]    0    0    0    0    1\n#> [5,]    0    0    0    0    0\n#> \n#> , , 3\n#> \n#>      [,1] [,2] [,3] [,4] [,5]\n#> [1,]    0    1    1    1    1\n#> [2,]    0    0    0    0    0\n#> [3,]    0    1    1    1    1\n#> [4,]    0    0    1    0    0\n#> [5,]    0    1    0    1    0\n## Criar tr√™s vetores\nvec_ch <- c(\"sp1\", \"sp2\", \"sp3\")\nvec_nu <- c(4, 5, 6)\nvec_fa <- factor(c(\"campo\", \"floresta\", \"floresta\"))\n\n## Data frame - combinar por colunas - horizontal - um ao lado do outro\ndf <- data.frame(vec_ch, vec_nu, vec_fa)\n\ndf\n#>   vec_ch vec_nu   vec_fa\n#> 1    sp1      4    campo\n#> 2    sp2      5 floresta\n#> 3    sp3      6 floresta\n\n## Data frame - nomear as colunas\ndf <- data.frame(especies = vec_ch, \n                 abundancia = vec_nu, \n                 vegetacao = vec_fa)\ndf\n#>   especies abundancia vegetacao\n#> 1      sp1          4     campo\n#> 2      sp2          5  floresta\n#> 3      sp3          6  floresta\n\n## Data frame - converter uma matriz\nma <- matrix(data = ve, nrow = 4, ncol = 3, byrow = TRUE)\nma\n#>      [,1] [,2] [,3]\n#> [1,]    1    2    3\n#> [2,]    4    5    6\n#> [3,]    7    8    9\n#> [4,]   10   11   12\n\ndf_ma <- as.data.frame(ma)\ndf_ma\n#>   V1 V2 V3\n#> 1  1  2  3\n#> 2  4  5  6\n#> 3  7  8  9\n#> 4 10 11 12\n## Lista\nlista <- list(rep(1, 20), # vector\n              factor(1, 1), # factor\n              cbind(c(1, 2), c(1, 2))) # matrix\nlista\n#> [[1]]\n#>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n#> \n#> [[2]]\n#> [1] 1\n#> Levels: 1\n#> \n#> [[3]]\n#>      [,1] [,2]\n#> [1,]    1    1\n#> [2,]    2    2\n\n## Lista - nomear os elementos\nlista_nome <- list(vector = rep(1, 20), # vector\n              factor = factor(1, 1), # factor\n              matrix = cbind(c(1, 2), c(1, 2))) # matrix\nlista_nome\n#> $vector\n#>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n#> \n#> $factor\n#> [1] 1\n#> Levels: 1\n#> \n#> $matrix\n#>      [,1] [,2]\n#> [1,]    1    1\n#> [2,]    2    2\n## Criar uma fun√ß√£o\nmulti <- function(x, y){\n  \n  mu <- (x * y)\n  return(mu)\n \n}\nmulti\n#> function(x, y){\n#>   \n#>   mu <- (x * y)\n#>   return(mu)\n#>  \n#> }\n\n## Uso da fun√ß√£o\nmulti(42, 23)\n#> [1] 966"},{"path":"cap4.html","id":"manipula√ß√£o-de-objetos-unidimensionais","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.4.2 Manipula√ß√£o de objetos unidimensionais","text":"Vamos agora explorar formas de manipular elementos de objetos unidimensionais, ou seja, vetores, fatores e listas.primeira forma de manipula√ß√£o √© atrav√©s da indexa√ß√£o, utilizando os operadores []. Com indexa√ß√£o podemos acessar elementos de vetores e fatores por sua posi√ß√£o. Utilizaremos n√∫meros, sequ√™ncia de n√∫meros ou opera√ß√µes booleanas para retornar partes dos vetores ou fatores. Podemos ainda retirar elementos dessas estruturas com o operador aritm√©tico -.exemplo seguir, iremos fixar o ponto de partida da amostragem da fun√ß√£o sample(), utilizando fun√ß√£o set.seed(42) (usamos 42 porque √© resposta para vida, o universo e tudo mais - O Guia Mochileiro das Gal√°xias, mas poderia ser outro n√∫mero qualquer). Isso permite que o resultado da amostragem aleat√≥ria seja igual em diferentes computadores.Podemos ainda fazer uma sele√ß√£o condicional vetor. Ao utilizarmos operadores relacionais, teremos como resposta um vetor l√≥gico. Esse vetor l√≥gico pode ser utilizado dentro da indexa√ß√£o para sele√ß√£o de elementos.Al√©m da indexa√ß√£o, temos algumas fun√ß√µes que nos auxiliam em algumas opera√ß√µes com objetos unidimensionais, listadas na Tabela 4.2.\nTabela 4.2: Fun√ß√µes para verifica√ß√£o e resumo de dados unidimensionais.\nPara listas, tamb√©m podemos usar indexa√ß√£o [] para acessar ou retirar elementos.Podemos ainda usar indexa√ß√£o dupla [[]] para acessar os valores desses elementos.Para listas nomeadas, podemos ainda utilizar o operador $ para acessar elementos pelo seu nome.E ainda podemos utilizar fun√ß√µes para medir o comprimento dessa lista, listar os nomes dos elementos ou ainda renomear os elementos: length() e names().","code":"\n## Fixar a amostragem\nset.seed(42)\n\n## Amostrar 10 elementos de uma sequ√™ncia\nve <- sample(x = seq(0, 2, .05), size = 10)\nve\n#>  [1] 1.80 0.00 1.20 0.45 1.75 0.85 1.15 0.30 1.90 0.20\n\n## Seleciona o quinto elemento\nve[5]\n#> [1] 1.75\n\n## Seleciona os elementos de 1 a 5\nve[1:5]\n#> [1] 1.80 0.00 1.20 0.45 1.75\n\n## Retira o decimo elemento\nve[-10]\n#> [1] 1.80 0.00 1.20 0.45 1.75 0.85 1.15 0.30 1.90\n\n## Retira os elementos 2 a 9\nve[-(2:9)]\n#> [1] 1.8 0.2\n## Quais valores sao maiores que 1?\nve > 1\n#>  [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE\n\n## Selecionar os valores acima de 1 no vetor ve\nve[ve > 1]\n#> [1] 1.80 1.20 1.75 1.15 1.90\n## Lista\nli <- list(elem1 = 1, elem2 = 2, elem3 = 3)\n\n## Acessar o primeiro elemento\nli[1]\n#> $elem1\n#> [1] 1\n\n## Retirar o primeiro elemento\nli[-1]\n#> $elem2\n#> [1] 2\n#> \n#> $elem3\n#> [1] 3\n## Acessar o valor do primeiro elemento\nli[[1]]\n#> [1] 1\n\n## Acessar o valor do segundo elemento\nli[[2]]\n#> [1] 2\n## Acessar o primeiro elemento\nli$elem1\n#> [1] 1\n## Comprimento\nlength(li)\n#> [1] 3\n\n## Nomes\nnames(li)\n#> [1] \"elem1\" \"elem2\" \"elem3\"\n\n## Renomear\nnames(li) <- paste0(\"elemento0\", 1:3)\nli\n#> $elemento01\n#> [1] 1\n#> \n#> $elemento02\n#> [1] 2\n#> \n#> $elemento03\n#> [1] 3"},{"path":"cap4.html","id":"manipula√ß√£o-de-objetos-multidimensionais","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.4.3 Manipula√ß√£o de objetos multidimensionais","text":"Da mesma forma que para objetos unidimensionais, podemos manipular elementos de objetos multidimensionais, ou seja, matrizes, data frames e arrays.Novamente, primeira forma de manipula√ß√£o √© atrav√©s da indexa√ß√£o, utilizando os operadores []. Com indexa√ß√£o podemos acessar elementos de matrizes, data frames e arrays por sua posi√ß√£o. Podemos ainda retirar elementos dessas estruturas com o operador aritm√©tico -.Entretanto, agora temos mais de uma dimens√£o na estrutura√ß√£o dos elementos dentro dos objetos. Assim, utilizamos n√∫meros, sequ√™ncia de n√∫meros ou opera√ß√£o booleanas para retornar partes desses objetos, mas dimens√µes t√™m de ser explicitadas e separadas por v√≠rgulas para acessar linhas e colunas. Essa indexa√ß√£o funciona para matrizes e data frames. Para arrays, especificamos tamb√©m dimens√µes, tamb√©m separadas por v√≠rgulas para acessar essas dimens√µes.Para data frames, al√©m de utilizar n√∫meros e/ou sequ√™ncias de n√∫meros dentro operador [] simples, podemos utilizar o operador [[]] duplo para retornar apenas os valores de uma linha ou uma coluna. Se colunas estiverem nomeadas, podemos utilizar o nome da coluna de interesse entre aspas dentro dos operadores [] (retornar coluna) e [[]] (retornar apenas os valores), assim como ainda podemos utilizar o operador $ para data frames. Essas √∫ltimas opera√ß√µes retornam um vetor, para o qual podemos fazer opera√ß√µes de vetores ou ainda atualizar o valor dessa coluna selecionada ou adicionar outra coluna.Podemos ainda fazer sele√ß√µes condicionais para retornar linhas com valores que temos interesse, semelhante ao uso de filtro de uma planilha eletr√¥nica.Al√©m disso, h√° uma s√©rie de fun√ß√µes para confer√™ncia e manipula√ß√£o de dados que listamos na Tabela 4.3.\nTabela 4.3: Fun√ß√µes para verifica√ß√£o e resumo de dados multidimensionais.\n","code":"\n## Matriz\nma <- matrix(1:12, 4, 3)\nma\n#>      [,1] [,2] [,3]\n#> [1,]    1    5    9\n#> [2,]    2    6   10\n#> [3,]    3    7   11\n#> [4,]    4    8   12\n\n## Indexa√ß√£o\nma[3, ] # linha 3\n#> [1]  3  7 11\nma[, 2] # coluna 2\n#> [1] 5 6 7 8\nma[1, 2] # elemento da linha 1 e coluna 2\n#> [1] 5\nma[1, 1:2] # elementos da linha 1 e coluna 1 e 2\n#> [1] 1 5\nma[1, c(1, 3)] # elementos da linha 1 e coluna 1 e 3\n#> [1] 1 9\nma[-1, ] # retirar a linha 1\n#>      [,1] [,2] [,3]\n#> [1,]    2    6   10\n#> [2,]    3    7   11\n#> [3,]    4    8   12\nma[, -3] # retirar a coluna 3\n#>      [,1] [,2]\n#> [1,]    1    5\n#> [2,]    2    6\n#> [3,]    3    7\n#> [4,]    4    8\n## Criar tr√™s vetores\nsp <- paste(\"sp\", 1:10, sep = \"\")\nabu <- 1:10\nflo <- factor(rep(c(\"campo\", \"floresta\"), each = 5))\n\n## data frame\ndf <- data.frame(sp, abu, flo)\ndf\n#>      sp abu      flo\n#> 1   sp1   1    campo\n#> 2   sp2   2    campo\n#> 3   sp3   3    campo\n#> 4   sp4   4    campo\n#> 5   sp5   5    campo\n#> 6   sp6   6 floresta\n#> 7   sp7   7 floresta\n#> 8   sp8   8 floresta\n#> 9   sp9   9 floresta\n#> 10 sp10  10 floresta\n\n## [] - n√∫meros\ndf[, 1]\n#>  [1] \"sp1\"  \"sp2\"  \"sp3\"  \"sp4\"  \"sp5\"  \"sp6\"  \"sp7\"  \"sp8\"  \"sp9\"  \"sp10\"\n\n## [] - nome das colunas - retorna coluna\ndf[\"flo\"]\n#>         flo\n#> 1     campo\n#> 2     campo\n#> 3     campo\n#> 4     campo\n#> 5     campo\n#> 6  floresta\n#> 7  floresta\n#> 8  floresta\n#> 9  floresta\n#> 10 floresta\n\n## [[]] - nome das colunas - retorna apenas os valores\ndf[[\"flo\"]]\n#>  [1] campo    campo    campo    campo    campo    floresta floresta floresta floresta floresta\n#> Levels: campo floresta\n\n## $ funciona apenas para data frame \ndf$sp\n#>  [1] \"sp1\"  \"sp2\"  \"sp3\"  \"sp4\"  \"sp5\"  \"sp6\"  \"sp7\"  \"sp8\"  \"sp9\"  \"sp10\"\n\n## Opera√ß√£o de vetors\nlength(df$abu)\n#> [1] 10\n\n## Converter colunas\ndf$abu <- as.character(df$abu)\nmode(df$abu)\n#> [1] \"character\"\n\n## Adicionar ou mudar colunas\nset.seed(42)\ndf$abu2 <- sample(x = 0:1, size = nrow(df), rep = TRUE)\ndf\n#>      sp abu      flo abu2\n#> 1   sp1   1    campo    0\n#> 2   sp2   2    campo    0\n#> 3   sp3   3    campo    0\n#> 4   sp4   4    campo    0\n#> 5   sp5   5    campo    1\n#> 6   sp6   6 floresta    1\n#> 7   sp7   7 floresta    1\n#> 8   sp8   8 floresta    1\n#> 9   sp9   9 floresta    0\n#> 10 sp10  10 floresta    1\n## Selecionar linhas de uma matriz ou data frame \ndf[df$abu > 4, ]\n#>    sp abu      flo abu2\n#> 5 sp5   5    campo    1\n#> 6 sp6   6 floresta    1\n#> 7 sp7   7 floresta    1\n#> 8 sp8   8 floresta    1\n#> 9 sp9   9 floresta    0\n\ndf[df$flo == \"floresta\", ]\n#>      sp abu      flo abu2\n#> 6   sp6   6 floresta    1\n#> 7   sp7   7 floresta    1\n#> 8   sp8   8 floresta    1\n#> 9   sp9   9 floresta    0\n#> 10 sp10  10 floresta    1"},{"path":"cap4.html","id":"valores-faltantes-e-especiais","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.4.4 Valores faltantes e especiais","text":"Valores faltantes e especiais s√£o valores reservados que representam dados faltantes, indefini√ß√µes matem√°ticas, infinitos e objetos nulos.NA (Available): significa dado faltante ou indispon√≠velNaN (Number): representa indefini√ß√µes matem√°ticasInf (Infinito): √© um n√∫mero muito grande ou um limite matem√°ticoNULL (Nulo): representa um objeto nulo, sendo √∫til para preenchimento em aplica√ß√µes de programa√ß√£o","code":"\n## Data frame com elemento NA\ndf <- data.frame(var1 = c(1, 4, 2, NA), var2 = c(1, 4, 5, 2))\ndf\n#>   var1 var2\n#> 1    1    1\n#> 2    4    4\n#> 3    2    5\n#> 4   NA    2\n\n## Resposta booleana para elementos NA\nis.na(df)\n#>       var1  var2\n#> [1,] FALSE FALSE\n#> [2,] FALSE FALSE\n#> [3,] FALSE FALSE\n#> [4,]  TRUE FALSE\n\n## Algum elemento √© NA?\nany(is.na(df))\n#> [1] TRUE\n\n## Remover as linhas com NAs\ndf_sem_na <- na.omit(df)\ndf_sem_na\n#>   var1 var2\n#> 1    1    1\n#> 2    4    4\n#> 3    2    5\n\n## Substituir NAs por 0\ndf[is.na(df)] <- 0\ndf\n#>   var1 var2\n#> 1    1    1\n#> 2    4    4\n#> 3    2    5\n#> 4    0    2\n\n## Desconsiderar os NAs em fun√ß√µes com o argumento rm.na = TRUE\nsum(1, 2, 3, 4, NA, na.rm = TRUE)\n#> [1] 10\n\n## NaN - not a number\n0/0\n#> [1] NaN\nlog(-1)\n#> [1] NaN\n\n## Limite matem√°tico\n1/0\n#> [1] Inf\n\n## N√∫mero grande\n10^310\n#> [1] Inf\n\n## Objeto nulo\nnulo <- NULL\nnulo\n#> NULL"},{"path":"cap4.html","id":"diret√≥rio-de-trabalho","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.4.5 Diret√≥rio de trabalho","text":"O diret√≥rio de trabalho √© o endere√ßo da pasta (ou diret√≥rio) de onde o R importar√° ou exportar nossos dados.Podemos utilizar o pr√≥prio RStudio para tal tarefa, indo em Session > Set Work Directory > Choose Directory... ou simplesmente utilizar o atalho Ctrl + Shift + H.Podemos ainda utilizar fun√ß√µes R para definir o diret√≥rio. Para tanto, podemos navegar com o aplicativo de gerenciador de arquivos (e.g., Windows Explorer) at√© nosso diret√≥rio de interesse e copiar o endere√ßo na barra superior. Voltamos para o R e colamos esse endere√ßo entre aspas como um argumento da fun√ß√£o setwd(). √â fundamental destacar que em Windows √© necess√°rio inverter barras (\\ por / ou duplicar elas \\\\).Aconselhamos ainda utilizar fun√ß√µes getwd() para retornar o diret√≥rio definido na sess√£o R, assim como fun√ß√µes dir() ou list.files() para listagem dos arquivos diret√≥rio, ambas medidas de confer√™ncia diret√≥rio correto.Outra forma de definir o diret√≥rio √© digitar tecla tab dentro da fun√ß√£o setwd(\"tab\"). Quando apertamos tab dentro das aspas conseguimos selecionar o diret√≥rio manualmente, pois abre-se uma lista de diret√≥rio que podemos ir selecionando at√© chegar diret√≥rio de interesse.","code":"\n## Definir o diret√≥rio de trabalho\nsetwd(\"/home/mude/data/github/livro_r_ecologia/dados\")\n\n## Verificar o diret√≥rio\ngetwd()\n\n## Listar os arquivos no diret√≥rio\ndir()\nlist.files()\n## Mudar o diret√≥rio com a tecla tab\nsetwd(\"`tab`\")"},{"path":"cap4.html","id":"importar-dados","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.4.6 Importar dados","text":"Uma das opera√ß√µes mais corriqueiras R, antes de realizar alguma an√°lise ou plotar um gr√°fico, √© de importar dados que foram tabulados numa planilha eletr√¥nica e salvos formato .csv, .txt ou .xlsx. Ao importar esse tipo de dado para o R, o formato que o mesmo assume, se nenhum par√¢metro especificado, √© o da classe data frame, prevendo que planilha de dados possua colunas com diferentes modos.Existem diversas formas de importar dados para o R. Podemos importar utilizando o RStudio, indo na janela Environment (Figura 4.2 janela 3) e clicar em ‚ÄúImportar Dataset.‚ÄùEntretanto, aconselhamos o uso de fun√ß√µes que fiquem salvas em um script para aumentar reprodutibilidade mesmo. Dessa forma, tr√™s principais fun√ß√µes para importar os arquivos nos tr√™s principais extens√µes (.csv, .txt ou .xlsx) s√£o, respectivamente: read.csv(), read.table() e openxlsx::read.xlsx(), sendo o √∫ltimo pacote openxlsx.Para exemplificar como importar dados R, vamos usar os dados de comunidades de anf√≠bios da Mata Atl√¢ntica (Vancine et al. 2018). Faremos o download diretamente site da fonte dos dados.Vamos antes escolher um diret√≥rio de trabalho com fun√ß√£o setwd(), e em seguida criar um diret√≥rio com fun√ß√£o dir.create() chamado ‚Äúdados.‚Äù Em seguida, vamos mudar nosso diret√≥rio para essa pasta e criar mais um diret√≥rio chamado ‚Äútabelas,‚Äù e por fim, definir esse diret√≥rio para que o conte√∫do download seja armazenado ali.Agora podemos fazer o download arquivo .zip e extrair tabelas usando fun√ß√£o unzip() nesse mesmo diret√≥rio.Agora podemos importar tabela de dados com fun√ß√£o read.csv(), atribuindo ao objeto intror_anfibios_locais. Devemos atentar para o argumento encoding, que selecionamos aqui como latin1 para corrigir um erro de caracteres, que o autor dos dados cometeu quando publicou esse data paper. Geralmente n√£o precisamos especificar esse tipo de informa√ß√£o, mas caso depois de importar os dados e na confer√™ncia, os caracteres como acento n√£o estiverem formatados, procure especificar argumento encoding um padr√£o para corrigir esse erro.Esse arquivo foi criado com separador de decimais sendo . e separador de colunas sendo ,. Caso tivesse sido criado com separador de decimais sendo , e separador de colunas sendo ;, usar√≠amos fun√ß√£o read.csv2().Para outros formatos, basta usar outras fun√ß√µes apresentadas, atentando-se para os argumentos espec√≠ficos de cada fun√ß√£o.Outra forma de importar dados, principalmente quando n√£o sabemos exatamente o nome arquivo e tamb√©m para evitar erros de digita√ß√£o, √© utilizar tecla tab dentro das aspas da fun√ß√£o de importa√ß√£o. Dessa forma, conseguimos ter acesso aos arquivos nosso diret√≥rio e temos possibilidade de selecion√°-los sem erros de digita√ß√£o.Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.","code":"\n## Escolher um diret√≥rio\nsetwd(\"/home/mude/data/github/livro_aer\")\n\n## Criar um diret√≥rio 'dados'\ndir.create(\"dados\")\n\n## Escolher diret√≥rio 'dados'\nsetwd(\"dados\")\n\n## Criar um diret√≥rio 'tabelas'\ndir.create(\"tabelas\")\n\n## Escolher diret√≥rio 'tabelas'\nsetwd(\"tabelas\")\n## Download\ndownload.file(url = \"https://esajournals.onlinelibrary.wiley.com/action/downloadSupplement?doi=10.1002%2Fecy.2392&file=ecy2392-sup-0001-DataS1.zip\",\n              destfile = \"atlantic_amphibians.zip\", mode = \"auto\")\n\n## Unzip\nunzip(zipfile = \"atlantic_amphibians.zip\")\n## Importar a tabela de locais\nintror_anfibios_locais <- read.csv(\"dados/tabelas/ATLANTIC_AMPHIBIANS_sites.csv\", encoding = \"latin1\")\n## Importar usando a tecla tab\nintror_anfibios_locais <- read.csv(\"`tab`\")\nintror_anfibios_locais\n## Importar os dados pelo pacote ecodados\nintror_anfibios_locais <- ecodados::intror_anfibios_locais\nhead(intror_anfibios_locais)\n#>        id reference_number species_number record sampled_habitat active_methods passive_methods complementary_methods\n#> 1 amp1001             1001             19     ab           fo,ll             as              pt                  <NA>\n#> 2 amp1002             1002             16     co        fo,la,ll             as              pt                  <NA>\n#> 3 amp1003             1002             14     co        fo,la,ll             as              pt                  <NA>\n#> 4 amp1004             1002             13     co        fo,la,ll             as              pt                  <NA>\n#> 5 amp1005             1003             30     co        fo,ll,br             as            <NA>                  <NA>\n#> 6 amp1006             1004             42     co  tp,pp,la,ll,is           <NA>            <NA>                  <NA>\n#>        period month_start year_start month_finish year_finish effort_months country state state_abbreviation\n#> 1 mo,da,tw,ni           9       2000            1        2002            16  Brazil Piau√≠              BR-PI\n#> 2 mo,da,tw,ni          12       2007            5        2009            17  Brazil Cear√°              BR-CE\n#> 3 mo,da,tw,ni          12       2007            5        2009            17  Brazil Cear√°              BR-CE\n#> 4 mo,da,tw,ni          12       2007            5        2009            17  Brazil Cear√°              BR-CE\n#> 5    mo,da,ni           7       1988            8        2001           157  Brazil Cear√°              BR-CE\n#> 6        <NA>          NA         NA           NA          NA            NA  Brazil Cear√°              BR-CE\n#>              municipality                                site  latitude longitude coordinate_precision altitude\n#> 1         Canto do Buriti Parque Nacional Serra das Confus√µes -8.680000 -43.42194                   gm      543\n#> 2 S√£o Gon√ßalo do Amarante                               Dunas -3.545527 -38.85783                   dd       15\n#> 3 S√£o Gon√ßalo do Amarante  Jardim Bot√¢nico¬†Municipal de¬†Bauru -3.574194 -38.88869                   dd       29\n#> 4 S√£o Gon√ßalo do Amarante                               Ta√≠ba -3.515250 -38.91880                   dd       25\n#> 5                Baturit√©                   Serra de Baturit√© -4.280556 -38.91083                   gm      750\n#> 6             Quebrangulo  Reserva Biol√≥gica de Pedra Talhada -9.229167 -36.42806                 <NA>      745\n#>   temperature precipitation\n#> 1       24.98           853\n#> 2       26.53          1318\n#> 3       26.45          1248\n#> 4       26.55          1376\n#> 5       21.35          1689\n#> 6       20.45          1249"},{"path":"cap4.html","id":"confer√™ncia-dos-dados-importados","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.4.7 Confer√™ncia dos dados importados","text":"Uma vez importados os dados para o R, geralmente antes de iniciarmos qualquer manipula√ß√£o, visualiza√ß√£o ou an√°lise de dados, fazemos confer√™ncia desses dados. Para isso, podemos utilizar fun√ß√µes listadas na Tabela 4.3.Dentre todas essas fun√ß√µes de verifica√ß√£o, destacamos import√¢ncia destas fun√ß√µes apresentadas abaixo para saber se vari√°veis foram importadas e interpretadas corretamente e reconhecer erros de digita√ß√£o, por exemplo. üìù Importante \nfun√ß√£o na.omit() retira linha inteira que possui algum NA, inclusive colunas que possuem dados que voc√™ n√£o tem interesse em excluir. Dessa forma, tenha em mente quais dados voc√™ realmente quer remover da sua tabela.Al√©m das fun√ß√µes apresentadas, recomendamos olhar os seguintes pacotes que ajudam na confer√™ncia dos dados importados: Hmisc, skimr e inspectDF.","code":"\n## Primeiras linhas\nhead(intror_anfibios_locais)\n#>        id reference_number species_number record sampled_habitat active_methods passive_methods complementary_methods\n#> 1 amp1001             1001             19     ab           fo,ll             as              pt                  <NA>\n#> 2 amp1002             1002             16     co        fo,la,ll             as              pt                  <NA>\n#> 3 amp1003             1002             14     co        fo,la,ll             as              pt                  <NA>\n#> 4 amp1004             1002             13     co        fo,la,ll             as              pt                  <NA>\n#> 5 amp1005             1003             30     co        fo,ll,br             as            <NA>                  <NA>\n#> 6 amp1006             1004             42     co  tp,pp,la,ll,is           <NA>            <NA>                  <NA>\n#>        period month_start year_start month_finish year_finish effort_months country state state_abbreviation\n#> 1 mo,da,tw,ni           9       2000            1        2002            16  Brazil Piau√≠              BR-PI\n#> 2 mo,da,tw,ni          12       2007            5        2009            17  Brazil Cear√°              BR-CE\n#> 3 mo,da,tw,ni          12       2007            5        2009            17  Brazil Cear√°              BR-CE\n#> 4 mo,da,tw,ni          12       2007            5        2009            17  Brazil Cear√°              BR-CE\n#> 5    mo,da,ni           7       1988            8        2001           157  Brazil Cear√°              BR-CE\n#> 6        <NA>          NA         NA           NA          NA            NA  Brazil Cear√°              BR-CE\n#>              municipality                                site  latitude longitude coordinate_precision altitude\n#> 1         Canto do Buriti Parque Nacional Serra das Confus√µes -8.680000 -43.42194                   gm      543\n#> 2 S√£o Gon√ßalo do Amarante                               Dunas -3.545527 -38.85783                   dd       15\n#> 3 S√£o Gon√ßalo do Amarante  Jardim Bot√¢nico¬†Municipal de¬†Bauru -3.574194 -38.88869                   dd       29\n#> 4 S√£o Gon√ßalo do Amarante                               Ta√≠ba -3.515250 -38.91880                   dd       25\n#> 5                Baturit√©                   Serra de Baturit√© -4.280556 -38.91083                   gm      750\n#> 6             Quebrangulo  Reserva Biol√≥gica de Pedra Talhada -9.229167 -36.42806                 <NA>      745\n#>   temperature precipitation\n#> 1       24.98           853\n#> 2       26.53          1318\n#> 3       26.45          1248\n#> 4       26.55          1376\n#> 5       21.35          1689\n#> 6       20.45          1249\n\n## √öltimas linhas\ntail(intror_anfibios_locais)\n#>           id reference_number species_number record sampled_habitat active_methods passive_methods complementary_methods\n#> 1158 amp2158             1389              3     co            <NA>           <NA>            <NA>                  <NA>\n#> 1159 amp2159             1389              9     co            <NA>           <NA>            <NA>                  <NA>\n#> 1160 amp2160             1389              6     co            <NA>           <NA>            <NA>                  <NA>\n#> 1161 amp2161             1389              1     co            <NA>           <NA>            <NA>                  <NA>\n#> 1162 amp2162             1389              2     co            <NA>           <NA>            <NA>                  <NA>\n#> 1163 amp2163             1389              2     co            <NA>           <NA>            <NA>                  <NA>\n#>      period month_start year_start month_finish year_finish effort_months   country    state state_abbreviation\n#> 1158   <NA>          NA         NA           NA          NA            NA Argentina Misiones               AR-N\n#> 1159   <NA>          NA         NA           NA          NA            NA Argentina Misiones               AR-N\n#> 1160   <NA>          NA         NA           NA          NA            NA Argentina Misiones               AR-N\n#> 1161   <NA>          NA         NA           NA          NA            NA Argentina Misiones               AR-N\n#> 1162   <NA>          NA         NA           NA          NA            NA Argentina Misiones               AR-N\n#> 1163   <NA>          NA         NA           NA          NA            NA Argentina Misiones               AR-N\n#>         municipality                          site  latitude longitude coordinate_precision altitude temperature\n#> 1158 Manuel Belgrano          Comandante Andresito -25.66944 -54.04556                  gms      251       19.94\n#> 1159         Posadas                       Posadas -27.45333 -55.89250                  gms      105       21.30\n#> 1160      Montecarlo                    Montecarlo -26.56889 -53.60889                  gms      597       18.35\n#> 1161       San Pedro                Refugio Mocon√° -27.14083 -53.92611                  gms      202       19.92\n#> 1162        Caingu√°s Balneario Municipal Cu√±√° Pir√∫ -27.08722 -54.95278                  gms      213       21.04\n#> 1163           Ober√°       Chacra San Juan de Dios -27.47333 -55.17194                  gms      254       20.67\n#>      precipitation\n#> 1158          1780\n#> 1159          1768\n#> 1160          1954\n#> 1161          1850\n#> 1162          1553\n#> 1163          1683\n\n## N√∫mero de linhas e colunas\nnrow(intror_anfibios_locais)\n#> [1] 1163\nncol(intror_anfibios_locais)\n#> [1] 25\ndim(intror_anfibios_locais)\n#> [1] 1163   25\n## Nome das linhas e colunas\nrownames(intror_anfibios_locais)\ncolnames(intror_anfibios_locais)\n\n## Estrutura dos dados\nstr(intror_anfibios_locais)\n\n## Resumo dos dados\nsummary(intror_anfibios_locais)\n\n## Verificar NAs\nany(is.na(intror_anfibios_locais))\nwhich(is.na(intror_anfibios_locais))\n\n## Remover as linhas com NAs\nintror_anfibios_locais_na <- na.omit(intror_anfibios_locais)"},{"path":"cap4.html","id":"exportar-dados","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.4.8 Exportar dados","text":"Uma vez realizado opera√ß√µes de manipula√ß√£o ou tendo dados que foram analisados e armazenados num objeto formato de data frame ou matriz, podemos exportar esses dados R para o diret√≥rio que definimos anteriormente.Para tanto, podemos utilizar fun√ß√µes de escrita de dados, como write.csv(), write.table() e openxlsx::write.xlsx(). Dois pontos s√£o fundamentais: ) o nome arquivo tem de estar entre aspas e final dele deve constar extens√£o que pretendemos que o arquivo tenha, e ii) √© interessante utilizar os argumentos row.names = FALSE e quote=FALSE, para que o arquivo escrito n√£o tenha o nome das linhas ou aspas em todas c√©lulas, respectivamente.","code":"\n## Exportar dados na extens√£o .csv\nwrite.csv(intror_anfibios_locais_na, \"ATLANTIC_AMPHIBIAN_sites_na.csv\", \n          row.names = FALSE, quote = FALSE)\n\n## Exportar dados na extens√£o .txt\nwrite.table(intror_anfibios_locais_na, \"ATLANTIC_AMPHIBIAN_sites_na.txt\", \n            row.names = FALSE, quote = FALSE)\n\n## Exportar dados na extens√£o .xlsx\nopenxlsx::write.xlsx(intror_anfibios_locais_na, \"ATLANTIC_AMPHIBIAN_sites_na.xlsx\", \n                     row.names = FALSE, quote = FALSE)"},{"path":"cap4.html","id":"para-se-aprofundar","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.5 Para se aprofundar","text":"Listamos seguir livros e links com material que recomendamos para seguir com sua aprendizagem em R Base.","code":""},{"path":"cap4.html","id":"livros","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.5.1 Livros","text":"Recomendamos aos interessados os livros: ) Crawley (2012) R Book, ii) Davies (2016) Book R: First Course Programming Statistics, iii) Gillespie e Lovelace (2017) Efficient R programming, iv) Holmes e Huber (2019) Modern Statistics Modern Biology, v) Irizarry e Love (2017) Data Analysis Life Sciences R, vi) James e colaboradores (2013) Introduction Statistical Learning: Applications R, vii) Kabacoff (2011) R Action: Data analysis graphics R, viii) Matloff (2011) Art R Programming: Tour Statistical Software Design, ix) Long e Teetor (2019) R Cookbook e x) Wickham (2019) Advanced R.","code":""},{"path":"cap4.html","id":"links","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.5.2 Links","text":"Existem centenas de ferramentas online para aprender e explorar o R. Dentre elas, indicamos os seguintes links (em portugu√™s e ingl√™s):Introdu√ß√£o ao RAn Introduction R - Douglas , Roos D, Mancini F, Couto , Lusseau DA () shortintroduction R - Paul Torfs & Claudia BrauerR Beginners - Emmanuel ParadisCi√™ncia de dados\n- Ci√™ncia de Dados em R - Curso-R\n- Data Science Ecologists Environmental Scientists - Coding ClubEstat√≠stica\n- Estat√≠stica Computacional com R - Mayer F. P., Bonat W. H., Zeviani W. M., Krainski E. T., Ribeiro Jr.¬†P. J\n- Data Analysis Visualization R Ecologists - Data CarpentryMiscel√¢neaMateriais sobre R - Beatriz MilzR resources (free courses, books, tutorials, & cheat sheets) - Paul van der Laken","code":""},{"path":"cap4.html","id":"exerc√≠cios","chapter":"Cap√≠tulo 4 Introdu√ß√£o ao R","heading":"4.6 Exerc√≠cios","text":"4.1\nUse o R para verificar o resultado da opera√ß√£o 7 + 7 √∑ 7 + 7 x 7 - 7.4.2\nVerifique atrav√©s R se 3x2¬≥ √© maior que 2x3¬≤.4.3\nCrie dois objetos (qualquer nome) com os valores 100 e 300. Multiplique esses objetos (fun√ß√£o prod()) e atribuam ao objeto mult. Fa√ßa o logaritmo natural (fun√ß√£o log()) objeto mult e atribuam ao objeto ln.4.4\nQuantos pacotes existem CRAN nesse momento? Execute essa combina√ß√£o Console: nrow(available.packages(repos = \"http://cran.r-project.org\")).4.5\nInstale o pacote tidyverse CRAN.4.6\nEscolha n√∫meros para jogar na mega-sena usando o R, nomeando o objeto como mega. Lembrando: s√£o 6 valores de 1 60 e atribuam um objeto.4.7\nCrie um fator chamado tr, com dois n√≠veis (‚Äúcont‚Äù e ‚Äútrat‚Äù) para descrever 300 locais de amostragem, 15 de cada tratamento. O fator deve ser dessa forma cont, cont, cont, ...., cont, trat, trat, ...., trat.4.8\nCrie uma matriz chamada ma, resultante da disposi√ß√£o de um vetor composto por 130 valores aleat√≥rios entre 0 e 10. matriz deve conter 100 linhas e ser disposta por colunas.4.9\nCrie um data frame chamado df, resultante da composi√ß√£o desses vetores:id: 1:30sp: sp01, sp02, ..., sp29, sp30ab: 30 valores aleat√≥rios entre 0 54.10\nCrie uma lista com os objetos criados anteriormente: mega, tr, ma e df.4.11\nSelecione os elementos √≠mpares objeto tr e atribua ao objeto tr_impar.4.12\nSelecione linhas com ids pares objeto df e atribua ao objeto df_ids_par.4.13\nFa√ßa uma amostragem de 10 linhas objeto df e atribua ao objeto df_amos10. Use fun√ß√£o set.seed() para fixar amostragem.4.14\nAmostre 10 linhas objeto ma, mas utilizando linhas amostradas df_amos10 e atribua ao objeto ma_amos10.4.15\nUna colunas dos objetos df_amos10 e ma_amos10 e atribua ao objeto dados_amos10.Solu√ß√µes dos exerc√≠cios.","code":""},{"path":"cap5.html","id":"cap5","chapter":"Cap√≠tulo 5 Tidyverse","heading":"Cap√≠tulo 5 Tidyverse","text":"","code":""},{"path":"cap5.html","id":"pr√©-requisitos-do-cap√≠tulo-1","chapter":"Cap√≠tulo 5 Tidyverse","heading":"Pr√©-requisitos do cap√≠tulo","text":"Pacotes e dados que ser√£o utilizados nesse cap√≠tulo.","code":"\n## Pacotes\nlibrary(tidyverse)\nlibrary(here)\nlibrary(ggplot2)\nlibrary(purrr)\nlibrary(tibble)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(stringr)\nlibrary(readr)\nlibrary(forcats)\nlibrary(palmerpenguins)\nlibrary(lubridate)\n\n## Dados\npenguins <- palmerpenguins::penguins\npenguins_raw <- palmerpenguins::penguins_raw\ntidy_anfibios_locais <- ecodados::tidy_anfibios_locais"},{"path":"cap5.html","id":"contextualiza√ß√£o-1","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.1 Contextualiza√ß√£o","text":"Como todo idioma, linguagem R vem passando por transforma√ß√µes nos √∫ltimos anos. Grande parte dessas mudan√ßas est√£o dentro paradigma de Ci√™ncia de Dados (Data Science), uma nova √°rea de conhecimento que vem se moldando partir desenvolvimento da sociedade em torno da era digital e da grande quantidade de dados gerados e dispon√≠veis pela internet, de onde adv√©m os pilares das inova√ß√µes tecnol√≥gicas: Big Data, Machine Learning e Internet Things. grande necessidade de computa√ß√£o para desenvolver esse novo paradigma colocaram o R e o python como principais linguagens de programa√ß√£o frente esses novos desafios. Apesar de n√£o serem √∫nicas ferramentas utilizadas para esse prop√≥sito, elas rapidamente se tornaram uma das melhores escolhas, dado v√°rios fatores como: ser de c√≥digo-aberto e gratuitas, possuir grandes comunidades contribuidoras, ser linguagens de interpreta√ß√£o (orientadas objeto) e relativamente f√°ceis de serem aprendidas e aplicadas.Essas mudan√ßas e expan√ß√µes na utiliza√ß√£o da linguagem R para Ci√™ncia de Dados come√ßaram ser implementadas principalmente devido um pesquisador: Hadley Wickham, que iniciou sua contribui√ß√£o √† comunidade R com o desenvolvimento j√° consagrado pacote ggplot2 (Wickham 2016) para composi√ß√£o de gr√°ficos R (ver mais Cap√≠tulo 6), baseado na gram√°tica de gr√°ficos (Wilkinson Wills 2005). Depois disso, Wickham dedicou-se ao desenvolvimento pensamento de uma nova abordagem dentro da manipula√ß√£o de dados, denominada Tidy Data (Dados organizados) (Wickham 2014), na qual focou na limpeza e organiza√ß√£o dos mesmos. ideia postula que dados est√£o tidy quando: ) vari√°veis est√£o nas colunas, ii) observa√ß√µes est√£o nas linhas e iii) valores est√£o nas c√©lulas, sendo que para esse √∫ltimo, n√£o deve haver mais de um valor por c√©lula (Figura 5.2).partir dessas ideias, o tidyverse foi operacionalizado R como uma cole√ß√£o de pacotes que atuam fluxo de trabalho comum da ci√™ncia de dados: importa√ß√£o, manipula√ß√£o, explora√ß√£o, visualiza√ß√£o, an√°lise e comunica√ß√£o de dados e an√°lises (Wickham et al. 2019) (Figura 5.1. O principal objetivo tidyverse √© aproximar linguagem para melhorar intera√ß√£o entre ser humano e computador sobre dados, de modo que os pacotes compartilham uma filosofia de design de alto n√≠vel e gram√°tica, al√©m da estrutura de dados de baixo n√≠vel (Wickham et al. 2019). principais leituras sobre o tema R s√£o os artigos ‚ÄúTidy Data‚Äù (Wickham 2014) e ‚ÄúWelcome Tidyverse‚Äù (Wickham et al. 2019), e o livro ‚ÄúR Data Science‚Äù (Wickham Grolemund 2017), al√©m Tidyverse que possui muito mais informa√ß√µes.\nFigura 5.1: Modelo das ferramentas necess√°rias em um projeto t√≠pico de ci√™ncia de dados: importar, organizar, entender (transformar, visualizar, modelar) e comunicar, envolto √† essas ferramentas est√° programa√ß√£o. Adaptado de Wickham & Grolemund (2017)).\n","code":""},{"path":"cap5.html","id":"tidyverse","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.2 tidyverse","text":"Uma vez instalado e carregado, o pacote tidyverse disponibiliza um conjunto de ferramentas atrav√©s de v√°rios pacotes. Esses pacotes compartilham uma filosofia de design, gram√°tica e estruturas. Podemos entender o tidyverse como um ‚Äúdialeto novo‚Äù para linguagem R, onde tidy quer dizer organizado, arrumado, ordenado, e verse √© universo. seguir, listamos os principais pacotes e suas funcionalidades.readr: importa dados tabulares (e.g.¬†.csv e .txt)tibble: implementa classe tibbletidyr: transforma√ß√£o de dados para tidydplyr: manipula√ß√£o de dadosstringr: manipula√ß√£o de caracteresforcats: manipula√ß√£o de fatoresggplot2: possibilita visualiza√ß√£o de dadospurrr: disponibiliza ferramentas para programa√ß√£o funcionalAl√©m dos pacotes principais, fazemos tamb√©m men√ß√£o outros pacotes que est√£o dentro dessa abordagem e que trataremos ainda neste cap√≠tulo, em outro momento livro, ou que voc√™ leitor() deve se familiarizar. Alguns pacotes comp√µem o tidyverse outros s√£o mais gerais, entretanto, todos est√£o envolvidos de alguma forma com ci√™ncia de dados.readxl e writexl: importa e exporta dados tabulares (.xlsx)janitor: examinar e limpar dados sujosDBI: interface de banco de dados Rhaven: importa e exporta dados SPSS, Stata e SAShttr: ferramentas para trabalhar com URLs e HTTPrvest: coletar facilmente (raspe) p√°ginas da webxml2: trabalhar com arquivos XMLjsonlite: um analisador e gerador JSON simples e robusto para Rhms: hora dialubridate: facilita o tratamento de datasmagrittr: prov√™ os operadores pipe (%>%, %$%, %<>%)glue: facilita combinar dados e caracteresrmarkdown: cria documentos de an√°lise din√¢mica que combinam c√≥digo, sa√≠da renderizada (como figuras) e textoknitr: projetado para ser um mecanismo transparente para gera√ß√£o de relat√≥rios din√¢micos com Rshiny: framework de aplicativo Web para Rflexdashboard: pain√©is interativos para Rhere: facilita defini√ß√£o de diret√≥riosusethis: automatiza tarefas durante configura√ß√£o e desenvolvimento de projetos (Git, ‚ÄòGitHub‚Äô e Projetos RStudio)data.table: pacote que fornece uma vers√£o de alto desempenho data.frame (importar, manipular e expotar)reticulate: pacote que fornece ferramentas para integrar Python e Rsparklyr: interface R para Apache Sparkbroom: converte objetos estat√≠sticos em tibbles organizadosmodelr: fun√ß√µes de modelagem que funcionam com o pipetidymodels: cole√ß√£o de pacotes para modelagem e aprendizado de m√°quina usando os princ√≠pios tidyverseDestacamos grande expans√£o e aplicabilidade dos pacotes rmarkdown, knitr e bookdown, que permitiram escrita desse livro usando essas ferramentas e linguagem de marca√ß√£o, chamada Markdown.Para instalar os principais pacotes que integram o tidyverse podemos instalar o pacote tidyverse.Quando carregamos o pacote tidyverse podemos notar uma mensagem indicando quais pacotes foram carregados, suas respectivas vers√µes e os conflitos com outros pacotes.Podemos ainda listar todos os pacotes tidyverse com fun√ß√£o tidyverse::tidyverse_packages().Tamb√©m podemos verificar se os pacotes est√£o atualizados, sen√£o, podemos atualiz√°-los com fun√ß√£o tidyverse::tidyverse_update().Todas fun√ß√µes dos pacotes tidyverse usam fonte min√∫scula e _ (underscore) para separar os nomes internos das fun√ß√µes, seguindo mesma sintaxe Python (‚ÄúSnake Case‚Äù). Neste sentido de padroniza√ß√£o, √© importante destacar ainda que existe um guia pr√≥prio para que os scripts sigam recomenda√ß√£o de padroniza√ß√£o, o tidyverse style guide, criado pelo pr√≥prio Hadley Wickham. Para pessoas que desenvolvem fun√ß√µes e pacotes existe o Tidyverse design guide criado pelo Tidyverse team.Por fim, para evitar poss√≠veis conflitos de fun√ß√µes com o mesmo nome entre pacotes, recomendamos fortemente o h√°bito de usar fun√ß√µes precedidas operador :: e o respectivo pacote. Assim, garante-se que fun√ß√£o utilizada √© referente ao pacote daquela fun√ß√£o. Segue um exemplo com fun√ß√µes apresentadas anteriormente.Seguindo essas ideias novo paradigma da Ci√™ncia de Dados, outro conjunto de pacotes foi desenvolvido, chamado de tidymodels que atuam fluxo de trabalho da an√°lise de dados em ci√™ncia de dados: separa√ß√£o e reamostragem, pr√©-processamento, ajuste de modelos e m√©tricas de performasse de ajustes. Por raz√µes de espa√ßo e especificidade, n√£o entraremos em detalhes desses pacotes.Seguindo estrutura da Figura 5.1, iremos ver nos itens das pr√≥ximas se√ß√µes como esses passos s√£o realizados com fun√ß√µes de cada pacote.","code":"\n## Instalar o pacote tidyverse\ninstall.packages(\"tidyverse\")\n## Carregar o pacote tidyverse\nlibrary(tidyverse)\n## Listar todos os pacotes do tidyverse \ntidyverse::tidyverse_packages()\n#>  [1] \"broom\"         \"cli\"           \"crayon\"        \"dbplyr\"        \"dplyr\"         \"dtplyr\"        \"forcats\"      \n#>  [8] \"googledrive\"   \"googlesheets4\" \"ggplot2\"       \"haven\"         \"hms\"           \"httr\"          \"jsonlite\"     \n#> [15] \"lubridate\"     \"magrittr\"      \"modelr\"        \"pillar\"        \"purrr\"         \"readr\"         \"readxl\"       \n#> [22] \"reprex\"        \"rlang\"         \"rstudioapi\"    \"rvest\"         \"stringr\"       \"tibble\"        \"tidyr\"        \n#> [29] \"xml2\"          \"tidyverse\"\n## Verificar e atualizar os pacotes do tidyverse \ntidyverse::tidyverse_update(repos = \"http://cran.us.r-project.org\")\n## Fun√ß√µes no formato snake case\nread_csv()\nread_tsv()\nas_tibble()\nleft_join()\ngroup_by()\n## Fun√ß√µes seguidas de seus respectivos pacotes\nreadr::read_csv()\nreadr::read_tsv()\ntibble::as_tibble()\ndplyr::left_join()\ndplyr::group_by()"},{"path":"cap5.html","id":"here","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.3 here","text":"Dentro fluxo de trabalho tidyverse, devemos sempre trabalhar com Projetos RStudio. Junto com o projeto, tamb√©m podemos fazer uso pacote . Ele permite construir caminhos para os arquivos projeto de forma mais simples e com maior reprodutibilidade.Esse pacote cobre o ponto de mudarmos o diret√≥rio de trabalho que discutimos Cap√≠tulo 4, dado que muitas vezes mudar o diret√≥rio com fun√ß√£o setwd() tende ser demorado e tedioso, principalmente quando se trata de um script em que v√°rias pessoas est√£o trabalhando em diferentes computadores e sistemas operacionais. Al√©m disso, ele elimina quest√£o da fragilidade dos scripts, pois geralmente um script est√° com os diret√≥rios conectados exatamente um lugar e um momento. Por fim, ele tamb√©m simplifica o trabalho com subdiret√≥rios, facilitando importar ou exportar arquivos para subpastas.Seu uso √© relativamente simples: uma vez criado e aberto o RStudio pelo Projeto RStudio, o diret√≥rio automaticamente √© definido para o diret√≥rio projeto. Depois disso, podemos usar fun√ß√£o ::() para definir os subdiret√≥rios onde est√£o os dados. O exemplo da aplica√ß√£o fica para se√ß√£o seguinte, quando iremos de fato importar um arquivo tabular para o R. Logo abaixo, mostramos como instalar e carregar o pacote .","code":"\n## Instalar\ninstall.packages(\"here\")\n\n## Carregar\nlibrary(here)"},{"path":"cap5.html","id":"readr-readxl-e-writexl","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.4 readr, readxl e writexl","text":"Dado que possu√≠mos um conjunto de dados e que geralmente esse conjunto de dados estar√° formato tabular com umas das extens√µes: .csv, .txt ou .xlsx, usaremos o pacote readr ou readxl para importar esses dados para o R. Esses pacotes leem e escrevem grandes arquivos de forma mais r√°pida, al√©m de fornecerem medidores de progresso de importa√ß√£o e exporta√ß√£o, e imprimir informa√ß√£o dos modos das colunas momento da importa√ß√£o. Outro ponto bastante positivo √© que tamb√©m classificam automaticamente o modo dos dados de cada coluna, .e., se uma coluna possui dados num√©ricos ou apenas texto, essa informa√ß√£o ser√° considerada para classificar o modo da coluna toda. classe objeto atribu√≠do quando lido por esses pacotes √© automaticamente um tibble, que veremos melhor na se√ß√£o seguinte. Todas fun√ß√µes deste pacote s√£o listadas na p√°gina de refer√™ncia pacote.Usamos fun√ß√µes readr::read_csv() e readr::write_csv() para importar e exportar arquivos .csv R, respectivamente. Para dados com extens√£o .txt, podemos utilizar fun√ß√µes readr::read_tsv() ou ainda readr::read_delim(). Para arquivos tabulares com extens√£o .xlsx, temos de instalar e carregar dois pacotes adicionais: readxl e writexl, dos quais usaremos fun√ß√µes readxl::read_excel(), readxl::read_xlsx() ou readxl::read_xls() para importar dados, atentado para o fato de podermos indicar aba com os dados com o argumento sheet, e writexl::write_xlsx() para exportar.Se o arquivo .csv foi criado com separador de decimais sendo . e separador de colunas sendo ,, usamos fun√ß√µes listadas acima normalmente. Caso seja criado com separador de decimais sendo , e separador de colunas sendo ;, devemos usar fun√ß√£o readr::read_csv2() para importar e readr::write_csv2() para exportar nesse formato, que √© mais comum Brasil.Para exemplificar como essas fun√ß√µes funcionam, vamos importar novamente os dados de comunidades de anf√≠bios da Mata Atl√¢ntica (Vancine et al. 2018), que fizemos o download Cap√≠tulo 4. Estamos usando fun√ß√£o readr::read_csv(), indicando os diret√≥rios com fun√ß√£o ::(), e classe arquivo √© tibble. Devemos atentar para o argumento locale = readr::locale(encoding = \"latin1\"),que selecionamos aqui como latin1 para corrigir um erro de caracteres, que o autor dos dados cometeu quando publicou esse data paper.Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.Para se aprofundar tema, recomendamos leitura Cap√≠tulo 11 Data import de Wickham & Grolemund (2017).","code":"\n## Importar locais\ntidy_anfibios_locais <- readr::read_csv(\n    here::here(\"dados\", \"tabelas\", \"ATLANTIC_AMPHIBIANS_sites.csv\"),\n    locale = readr::locale(encoding = \"latin1\")\n)\n#> Rows: 1163 Columns: 25\n#> ‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n#> Delimiter: \",\"\n#> chr (13): id, record, sampled_habitat, active_methods, passive_methods, complementary_methods, period, country, state, ...\n#> dbl (12): reference_number, species_number, month_start, year_start, month_finish, year_finish, effort_months, latitude...\n#> \n#> ‚Ñπ Use `spec()` to retrieve the full column specification for this data.\n#> ‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n## Importar os dados pelo pacote ecodados\ntidy_anfibios_locais <- ecodados::tidy_anfibios_locais\nhead(tidy_anfibios_locais)"},{"path":"cap5.html","id":"tibble","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.5 tibble","text":"O tibble (tbl_sf) √© uma vers√£o aprimorada data frame (data.frame). Ele √© classe aconselhada para que fun√ß√µes tidyverse funcionem melhor sobre conjuntos de dados tabulares importados para o R.Geralmente, quando utilizamos fun√ß√µes tidyverse para importar dados para o R, √© essa classe que os dados adquirem depois de serem importados. Al√©m da importa√ß√£o de dados, podemos criar um tibble R usando fun√ß√£o tibble::tibble(), semelhante ao uso da fun√ß√£o data.frame(). Podemos ainda converter um data.frame para um tibble usando fun√ß√£o tibble::as_tibble(). Entretanto, em alguns momentos precisaremos da classe data.frame para algumas fun√ß√µes espec√≠ficas, e podemos converter um tibble para data.frame usando fun√ß√£o tibble::as_data_frame().Existem duas diferen√ßas principais uso tibble e data.frame: impress√£o e subconjunto. Objetos da classe tibbles possuem um m√©todo de impress√£o que mostra contagem n√∫mero de linhas e colunas, e apenas primeiras 10 linhas e todas colunas que cabem na tela console, al√©m dos modos ou tipos das colunas. Dessa forma, cada coluna ou vari√°vel, pode ser modo numbers (int ou dbl), character (chr), logical (lgl), factor (fctr), date + time (dttm) e date (date), al√©m de outras in√∫meras possibilidades.Todas fun√ß√µes deste pacote s√£o listadas na p√°gina de refer√™ncia pacote.Para o subconjunto, como vimos Cap√≠tulo 4, para selecionar colunas e linhas de objetos bidimensionais podemos utilizar os operadores [] ou [[]], associado com n√∫meros separados por v√≠rgulas ou o nome da coluna entre aspas, e o operador $ para extrair uma coluna pelo seu nome. Comparando um data.frame um tibble, o √∫ltimo √© mais r√≠gido na sele√ß√£o das colunas: eles nunca fazem correspond√™ncia parcial e geram um aviso se coluna que voc√™ est√° tentando acessar n√£o existir.Por fim, podemos ‚Äúespiar‚Äù os dados utilizando fun√ß√£o tibble::glimpse() para ter uma no√ß√£o geral de n√∫mero de linhas, colunas, e conte√∫do de todas colunas. Essa √© fun√ß√£o tidyverse da fun√ß√£o R Base str().Para se aprofundar tema, recomendamos leitura Cap√≠tulo 10 Tibbles de Wickham & Grolemund (2017).","code":"\n## Tibble - impress√£o\ntidy_anfibios_locais\n#> # A tibble: 1,163 √ó 25\n#>    id      reference_number species_number record sampled_habitat active_methods passive_methods complementary_meth‚Ä¶ period\n#>    <chr>              <dbl>          <dbl> <chr>  <chr>           <chr>          <chr>           <chr>               <chr> \n#>  1 amp1001             1001             19 ab     fo,ll           as             pt              <NA>                mo,da‚Ä¶\n#>  2 amp1002             1002             16 co     fo,la,ll        as             pt              <NA>                mo,da‚Ä¶\n#>  3 amp1003             1002             14 co     fo,la,ll        as             pt              <NA>                mo,da‚Ä¶\n#>  4 amp1004             1002             13 co     fo,la,ll        as             pt              <NA>                mo,da‚Ä¶\n#>  5 amp1005             1003             30 co     fo,ll,br        as             <NA>            <NA>                mo,da‚Ä¶\n#>  6 amp1006             1004             42 co     tp,pp,la,ll,is  <NA>           <NA>            <NA>                <NA>  \n#>  7 amp1007             1005             23 co     sp              as             <NA>            <NA>                <NA>  \n#>  8 amp1008             1005             19 co     sp,la,sw        as,sb,tr       <NA>            <NA>                tw,ni \n#>  9 amp1009             1005             13 ab     fo              <NA>           pt              <NA>                mo,da‚Ä¶\n#> 10 amp1010             1006              1 ab     fo              <NA>           pt              <NA>                mo,da‚Ä¶\n#> # ‚Ä¶ with 1,153 more rows, and 16 more variables: month_start <dbl>, year_start <dbl>, month_finish <dbl>,\n#> #   year_finish <dbl>, effort_months <dbl>, country <chr>, state <chr>, state_abbreviation <chr>, municipality <chr>,\n#> #   site <chr>, latitude <dbl>, longitude <dbl>, coordinate_precision <chr>, altitude <dbl>, temperature <dbl>,\n#> #   precipitation <dbl>\n## Tibble - subconjunto\ntidy_anfibios_locais$ref\n#> Warning: Unknown or uninitialised column: `ref`.\n#> NULL\n## Espiar os dados\ntibble::glimpse(tidy_anfibios_locais[, 1:10])\n#> Rows: 1,163\n#> Columns: 10\n#> $ id                    <chr> \"amp1001\", \"amp1002\", \"amp1003\", \"amp1004\", \"amp1005\", \"amp1006\", \"amp1007\", \"amp1008\", \"am‚Ä¶\n#> $ reference_number      <dbl> 1001, 1002, 1002, 1002, 1003, 1004, 1005, 1005, 1005, 1006, 1006, 1006, 1006, 1006, 1006, 1‚Ä¶\n#> $ species_number        <dbl> 19, 16, 14, 13, 30, 42, 23, 19, 13, 1, 1, 2, 4, 4, 6, 5, 8, 2, 5, 1, 2, 2, 1, 2, 2, 1, 2, 3‚Ä¶\n#> $ record                <chr> \"ab\", \"co\", \"co\", \"co\", \"co\", \"co\", \"co\", \"co\", \"ab\", \"ab\", \"ab\", \"ab\", \"ab\", \"ab\", \"ab\", \"‚Ä¶\n#> $ sampled_habitat       <chr> \"fo,ll\", \"fo,la,ll\", \"fo,la,ll\", \"fo,la,ll\", \"fo,ll,br\", \"tp,pp,la,ll,is\", \"sp\", \"sp,la,sw\"‚Ä¶\n#> $ active_methods        <chr> \"as\", \"as\", \"as\", \"as\", \"as\", NA, \"as\", \"as,sb,tr\", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,‚Ä¶\n#> $ passive_methods       <chr> \"pt\", \"pt\", \"pt\", \"pt\", NA, NA, NA, NA, \"pt\", \"pt\", \"pt\", \"pt\", \"pt\", \"pt\", \"pt\", \"pt\", \"pt‚Ä¶\n#> $ complementary_methods <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,‚Ä¶\n#> $ period                <chr> \"mo,da,tw,ni\", \"mo,da,tw,ni\", \"mo,da,tw,ni\", \"mo,da,tw,ni\", \"mo,da,ni\", NA, NA, \"tw,ni\", \"m‚Ä¶\n#> $ month_start           <dbl> 9, 12, 12, 12, 7, NA, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, ‚Ä¶"},{"path":"cap5.html","id":"magrittr-pipe--","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.6 magrittr (pipe - %>%)","text":"O operador pipe %>% permite o encadeamento de v√°rias fun√ß√µes, eliminando necessidade de criar objetos para armazenar resultados intermedi√°rios. Dessa forma, pipes s√£o uma ferramenta poderosa para expressar uma sequ√™ncia de m√∫ltiplas opera√ß√µes.O operador pipe %>% vem pacote magrittr, entretanto, todos os pacotes tidyverse automaticamente tornam o pipe dispon√≠vel. Essa fun√ß√£o torna os c√≥digos em R mais simples, pois realizamos m√∫ltiplas opera√ß√µes em uma √∫nica linha. Ele captura o resultado de uma declara√ß√£o e o torna primeira entrada da pr√≥xima declara√ß√£o, ent√£o podemos pensar como ‚ÄúEM SEGUIDA FA√áA‚Äù ao final de cada linha de c√≥digo.Todas fun√ß√µes deste pacote s√£o listadas na p√°gina de refer√™ncia pacote.principal vantagem uso dos pipes √© facilitar depura√ß√£o (debugging - achar erros) nos c√≥digos, porque seu uso torna linguagem R mais pr√≥xima que falamos e pensamos, uma vez que evita o uso de fun√ß√µes dentro de fun√ß√µes (fun√ß√µes compostas, lembra-se fog e gof ensino m√©dio? Evitamos eles aqui tamb√©m).Digitar %>% √© um pouco chato, dessa forma, existe um atalho para sua inser√ß√£o nos scripts: Ctrl + Shift + M.Para deixar esse t√≥pico menos estranho quem possa ver essa opera√ß√£o pela primeira vez, vamos fazer alguns exemplos.Essas opera√ß√µes ainda est√£o simples, vamos torn√°-las mais complexas com v√°rias fun√ß√µes compostas. √â nesses casos que propriedade organizacional uso pipe emerge: podemos facilmente ver o encadeamento de opera√ß√µes, onde cada fun√ß√£o √© disposta numa linha. Apenas um adendo: fun√ß√£o set.seed() que fixa amostragem de fun√ß√µes que geram valores aleat√≥rios, como √© o caso da fun√ß√£o rpois().O uso pipe vai se tornar especialmente √∫til quando seguirmos para os pacotes das pr√≥ximas duas se√ß√µes: tidyr e dplyr. Com esses pacotes faremos opera√ß√µes em linhas e colunas de nossos dados tabulares, ent√£o podemos encadear uma s√©rie de fun√ß√µes para manipula√ß√£o, limpeza e an√°lise de dados.H√° ainda tr√™s outras varia√ß√µes pipe que podem ser √∫teis em alguns momentos, mas que para funcionar precisam que o pacote magrittr esteja carregado:%T>%: retorna o lado esquerdo em vez lado direito da opera√ß√£o%$%: ‚Äúexplode‚Äù vari√°veis em um quadro de dados%<>%: permite atribui√ß√£o usando pipesPara se aprofundar tema, recomendamos leitura Cap√≠tulo 18 Pipes de Wickham & Grolemund (2017). üìù Importante \npartir da vers√£o R 4.1+ (18/05/2021), o operador pipe se tornou nativo R. Entretanto, o operador foi atualizado para |>, podendo ser inserido com o mesmo atalho Ctrl + Shift + M, mas necessitando uma mudan√ßa de op√ß√£o em Tools > Global Options > Code > [x] Use native pipe operator, |> (requires R 4.1+), necessitando que o RStudio esteja numa vers√£o igual ou superior 1.4.17+.","code":"\n## Base R - sem pipe\nsqrt(sum(1:100))\n#> [1] 71.06335\n\n## Tidyverse - com pipe\n1:100 %>% \n    sum() %>% \n    sqrt()\n#> [1] 71.06335\n## Fixar amostragem\nset.seed(42)\n\n## Base R - sem pipe\nve <- sum(sqrt(sin(log10(rpois(100, 10)))))\nve\n#> [1] 91.27018\n\n## Fixar amostragem\nset.seed(42)\n\n## Tidyverse - com pipe\nve <- rpois(100, 10) %>% \n    log10() %>%\n    sin() %>% \n    sqrt() %>% \n    sum()\nve\n#> [1] 91.27018"},{"path":"cap5.html","id":"tidyr","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.7 tidyr","text":"Os conjuntos de dados tidy (organizados) s√£o mais f√°ceis de manipular, modelar e visualizar. Um conjunto de dados est√° formato tidy ou n√£o, dependendo de como linhas, colunas e c√©lulas s√£o combinadas com observa√ß√µes, vari√°veis e valores. Nos dados tidy, vari√°veis est√£o nas colunas, observa√ß√µes est√£o nas linhas e valores est√£o nas c√©lulas, sendo que para esse √∫ltimo, n√£o deve haver mais de um valor por c√©lula (Figura 5.2.Cada vari√°vel em uma colunaCada observa√ß√£o em uma linhaCada valor como uma c√©lula\nFigura 5.2: tr√™s regras que tornam um conjunto de dados tidy. Adaptado de Wickham & Grolemund (2017)).\nTodas fun√ß√µes deste pacote s√£o listadas na p√°gina de refer√™ncia pacote.Para realizar diversas transforma√ß√µes nos dados, fim de ajust√°-los ao formato tidy existe uma s√©rie de fun√ß√µes para: unir colunas, separar colunas, lidar com valores faltantes (NA), transformar base de dados de formato longo para largo (ou vice-e-versa), al√©m de outras fun√ß√µes espec√≠ficas.unite(): junta dados de m√∫ltiplas colunas em uma colunaseparate(): separa caracteres em m√∫ltiplas colunasseparate_rows(): separa caracteres em m√∫ltiplas colunas e linhasdrop_na(): retira linhas com NA conjunto de dadosreplace_na(): substitui NA conjunto de dadospivot_wider(): transforma um conjunto de dados longo (long) para largo (wide)pivot_longer(): transforma um conjunto de dados largo (wide) para longo (long)","code":""},{"path":"cap5.html","id":"palmerpenguins","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.7.1 palmerpenguins","text":"Para exemplificar o funcionamento dessas fun√ß√µes, usaremos os dados de medidas de pinguins chamados palmerpenguins, dispon√≠veis pacote palmerpenguins.Esses dados foram coletados e disponibilizados pela Dra. Kristen Gorman e pela Palmer Station, Antarctica LTER, membro da Long Term Ecological Research Network.O pacote palmerpenguins cont√©m dois conjuntos de dados. Um √© chamado de penguins e √© uma vers√£o simplificada dos dados brutos. O segundo conjunto de dados √© penguins_raw e cont√©m todas vari√°veis e nomes originais baixados. Ambos os conjuntos de dados cont√™m dados para 344 pinguins, de tr√™s esp√©cies diferentes, coletados em tr√™s ilhas arquip√©lago de Palmer, na Ant√°rtica. Destacamos tamb√©m vers√£o traduzida desses dados para o portugu√™s, dispon√≠vel pacote dados.Vamos utilizar principalmente o conjunto de dados penguins_raw, que √© vers√£o dos dados brutos.Podemos ainda verificar os dados, pedindo uma ajuda de cada um dos objetos.","code":"\n## Instalar o pacote\ninstall.packages(\"palmerpenguins\")\n## Carregar o pacote palmerpenguins\nlibrary(palmerpenguins)\n## Ajuda dos dados\n?penguins\n?penguins_raw"},{"path":"cap5.html","id":"glimpse","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.7.2 glimpse()","text":"Primeiramente, vamos observar os dados e utilizar fun√ß√£o tibble::glimpse() para ter uma no√ß√£o geral dos dados.","code":"\n## Visualizar os dados\npenguins_raw\n#> # A tibble: 344 √ó 17\n#>    studyName `Sample Number` Species       Region Island Stage `Individual ID` `Clutch Comple‚Ä¶` `Date Egg` `Culmen Length‚Ä¶`\n#>    <chr>               <dbl> <chr>         <chr>  <chr>  <chr> <chr>           <chr>            <date>                <dbl>\n#>  1 PAL0708                 1 Adelie Pengu‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N1A1            Yes              2007-11-11             39.1\n#>  2 PAL0708                 2 Adelie Pengu‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N1A2            Yes              2007-11-11             39.5\n#>  3 PAL0708                 3 Adelie Pengu‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N2A1            Yes              2007-11-16             40.3\n#>  4 PAL0708                 4 Adelie Pengu‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N2A2            Yes              2007-11-16             NA  \n#>  5 PAL0708                 5 Adelie Pengu‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N3A1            Yes              2007-11-16             36.7\n#>  6 PAL0708                 6 Adelie Pengu‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N3A2            Yes              2007-11-16             39.3\n#>  7 PAL0708                 7 Adelie Pengu‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N4A1            No               2007-11-15             38.9\n#>  8 PAL0708                 8 Adelie Pengu‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N4A2            No               2007-11-15             39.2\n#>  9 PAL0708                 9 Adelie Pengu‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N5A1            Yes              2007-11-09             34.1\n#> 10 PAL0708                10 Adelie Pengu‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N5A2            Yes              2007-11-09             42  \n#> # ‚Ä¶ with 334 more rows, and 7 more variables: `Culmen Depth (mm)` <dbl>, `Flipper Length (mm)` <dbl>,\n#> #   `Body Mass (g)` <dbl>, Sex <chr>, `Delta 15 N (o/oo)` <dbl>, `Delta 13 C (o/oo)` <dbl>, Comments <chr>\n\n## Espiar os dados\ndplyr::glimpse(penguins_raw)\n#> Rows: 344\n#> Columns: 17\n#> $ studyName             <chr> \"PAL0708\", \"PAL0708\", \"PAL0708\", \"PAL0708\", \"PAL0708\", \"PAL0708\", \"PAL0708\", \"PAL0708\", \"PA‚Ä¶\n#> $ `Sample Number`       <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, ‚Ä¶\n#> $ Species               <chr> \"Adelie Penguin (Pygoscelis adeliae)\", \"Adelie Penguin (Pygoscelis adeliae)\", \"Adelie Pengu‚Ä¶\n#> $ Region                <chr> \"Anvers\", \"Anvers\", \"Anvers\", \"Anvers\", \"Anvers\", \"Anvers\", \"Anvers\", \"Anvers\", \"Anvers\", \"‚Ä¶\n#> $ Island                <chr> \"Torgersen\", \"Torgersen\", \"Torgersen\", \"Torgersen\", \"Torgersen\", \"Torgersen\", \"Torgersen\", ‚Ä¶\n#> $ Stage                 <chr> \"Adult, 1 Egg Stage\", \"Adult, 1 Egg Stage\", \"Adult, 1 Egg Stage\", \"Adult, 1 Egg Stage\", \"Ad‚Ä¶\n#> $ `Individual ID`       <chr> \"N1A1\", \"N1A2\", \"N2A1\", \"N2A2\", \"N3A1\", \"N3A2\", \"N4A1\", \"N4A2\", \"N5A1\", \"N5A2\", \"N6A1\", \"N6‚Ä¶\n#> $ `Clutch Completion`   <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"No\", \"No\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Y‚Ä¶\n#> $ `Date Egg`            <date> 2007-11-11, 2007-11-11, 2007-11-16, 2007-11-16, 2007-11-16, 2007-11-16, 2007-11-15, 2007-1‚Ä¶\n#> $ `Culmen Length (mm)`  <dbl> 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, 42.0, 37.8, 37.8, 41.1, 38.6, 34.6, 36.‚Ä¶\n#> $ `Culmen Depth (mm)`   <dbl> 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, 20.2, 17.1, 17.3, 17.6, 21.2, 21.1, 17.‚Ä¶\n#> $ `Flipper Length (mm)` <dbl> 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186, 180, 182, 191, 198, 185, 195, 197, 18‚Ä¶\n#> $ `Body Mass (g)`       <dbl> 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, 4250, 3300, 3700, 3200, 3800, 4400, 370‚Ä¶\n#> $ Sex                   <chr> \"MALE\", \"FEMALE\", \"FEMALE\", NA, \"FEMALE\", \"MALE\", \"FEMALE\", \"MALE\", NA, NA, NA, NA, \"FEMALE‚Ä¶\n#> $ `Delta 15 N (o/oo)`   <dbl> NA, 8.94956, 8.36821, NA, 8.76651, 8.66496, 9.18718, 9.46060, NA, 9.13362, 8.63243, NA, NA,‚Ä¶\n#> $ `Delta 13 C (o/oo)`   <dbl> NA, -24.69454, -25.33302, NA, -25.32426, -25.29805, -25.21799, -24.89958, NA, -25.09368, -2‚Ä¶\n#> $ Comments              <chr> \"Not enough blood for isotopes.\", NA, NA, \"Adult not sampled.\", NA, NA, \"Nest never observe‚Ä¶"},{"path":"cap5.html","id":"unite","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.7.3 unite()","text":"Primeiramente, vamos exemplificar como juntar e separar colunas. Vamos utilizar fun√ß√£o tidyr::unite() para unir colunas. H√° diversos par√¢metros para alterar como esta fun√ß√£o funciona, entretanto, √© importante destacar tr√™s deles: col nome da coluna que vai receber colunas unidas, sep indicando o caractere separador das colunas unidas, e remove para uma resposta l√≥gica se colunas unidas s√£o removidas ou n√£o. Vamos unir colunas ‚ÄúRegion‚Äù e ‚ÄúIsland‚Äù na nova coluna ‚Äúregion_island.‚Äù","code":"\n## Unir colunas\npenguins_raw_unir <- tidyr::unite(data = penguins_raw, \n                                  col = \"region_island\",\n                                  Region:Island, \n                                  sep = \", \",\n                                  remove = FALSE)\nhead(penguins_raw_unir[, c(\"Region\", \"Island\", \"region_island\")])\n#> # A tibble: 6 √ó 3\n#>   Region Island    region_island    \n#>   <chr>  <chr>     <chr>            \n#> 1 Anvers Torgersen Anvers, Torgersen\n#> 2 Anvers Torgersen Anvers, Torgersen\n#> 3 Anvers Torgersen Anvers, Torgersen\n#> 4 Anvers Torgersen Anvers, Torgersen\n#> 5 Anvers Torgersen Anvers, Torgersen\n#> 6 Anvers Torgersen Anvers, Torgersen"},{"path":"cap5.html","id":"separate","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.7.4 separate()","text":"De forma contr√°ria, podemos utilizar fun√ß√µes tidyr::separate() e tidyr::separate_rows() para separar elementos de uma coluna em mais colunas. Respectivamente, primeira fun√ß√£o separa uma coluna em novas colunas conforme separa√ß√£o, e segunda fun√ß√£o separa uma coluna, distribuindo os elementos nas linhas. Novamente, h√° diversos par√¢metros para mudar o comportamento dessas fun√ß√µes, mas destacaremos aqui quatro deles: col coluna ser separada, os nomes das novas colunas, sep indicando o caractere separador das colunas, e remove para uma resposta l√≥gica se colunas separadas s√£o removidas ou n√£o. Vamos separar coluna ‚ÄúStage‚Äù nas colunas ‚Äústage‚Äù e ‚Äúegg_stage.‚Äù","code":"\n## Separar colunas\npenguins_raw_separar <- tidyr::separate(data = penguins_raw, \n                                        col = Stage,\n                                        into = c(\"stage\", \"egg_stage\"), \n                                        sep = \", \",\n                                        remove = FALSE)\nhead(penguins_raw_separar[, c(\"Stage\", \"stage\", \"egg_stage\")])\n#> # A tibble: 6 √ó 3\n#>   Stage              stage egg_stage  \n#>   <chr>              <chr> <chr>      \n#> 1 Adult, 1 Egg Stage Adult 1 Egg Stage\n#> 2 Adult, 1 Egg Stage Adult 1 Egg Stage\n#> 3 Adult, 1 Egg Stage Adult 1 Egg Stage\n#> 4 Adult, 1 Egg Stage Adult 1 Egg Stage\n#> 5 Adult, 1 Egg Stage Adult 1 Egg Stage\n#> 6 Adult, 1 Egg Stage Adult 1 Egg Stage\n\n## Separar colunas em novas linhas\npenguins_raw_separar_linhas <- tidyr::separate_rows(data = penguins_raw,\n                                                    Stage,\n                                                    sep = \", \")\nhead(penguins_raw_separar_linhas[, c(\"studyName\", \"Sample Number\", \"Species\", \n                                     \"Region\", \"Island\", \"Stage\")])\n#> # A tibble: 6 √ó 6\n#>   studyName `Sample Number` Species                             Region Island    Stage      \n#>   <chr>               <dbl> <chr>                               <chr>  <chr>     <chr>      \n#> 1 PAL0708                 1 Adelie Penguin (Pygoscelis adeliae) Anvers Torgersen Adult      \n#> 2 PAL0708                 1 Adelie Penguin (Pygoscelis adeliae) Anvers Torgersen 1 Egg Stage\n#> 3 PAL0708                 2 Adelie Penguin (Pygoscelis adeliae) Anvers Torgersen Adult      \n#> 4 PAL0708                 2 Adelie Penguin (Pygoscelis adeliae) Anvers Torgersen 1 Egg Stage\n#> 5 PAL0708                 3 Adelie Penguin (Pygoscelis adeliae) Anvers Torgersen Adult      \n#> 6 PAL0708                 3 Adelie Penguin (Pygoscelis adeliae) Anvers Torgersen 1 Egg Stage"},{"path":"cap5.html","id":"drop_na-e-replace_na","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.7.5 drop_na() e replace_na()","text":"Valores faltantes (NA) √© um tipo especial de elemento que discutimos Cap√≠tulo 4 e s√£o relativamente comuns em conjuntos de dados. Em Base R, vimos algumas formas de lidar com esse tipo de elemento. formato tidyverse, existem tamb√©m v√°rias formas de lidar com eles, mas aqui focaremos nas fun√ß√µes tidyr::drop_na() e tidyr::replace_na(), para retirar linhas e substituir esses valores, respectivamente.","code":"\n## Remover todas as linhas com NAs\npenguins_raw_todas_na <- tidyr::drop_na(data = penguins_raw)\nhead(penguins_raw_todas_na)\n#> # A tibble: 6 √ó 17\n#>   studyName `Sample Number` Species        Region Island Stage `Individual ID` `Clutch Comple‚Ä¶` `Date Egg` `Culmen Length‚Ä¶`\n#>   <chr>               <dbl> <chr>          <chr>  <chr>  <chr> <chr>           <chr>            <date>                <dbl>\n#> 1 PAL0708                 7 Adelie Pengui‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N4A1            No               2007-11-15             38.9\n#> 2 PAL0708                 8 Adelie Pengui‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N4A2            No               2007-11-15             39.2\n#> 3 PAL0708                29 Adelie Pengui‚Ä¶ Anvers Biscoe Adul‚Ä¶ N18A1           No               2007-11-10             37.9\n#> 4 PAL0708                30 Adelie Pengui‚Ä¶ Anvers Biscoe Adul‚Ä¶ N18A2           No               2007-11-10             40.5\n#> 5 PAL0708                39 Adelie Pengui‚Ä¶ Anvers Dream  Adul‚Ä¶ N25A1           No               2007-11-13             37.6\n#> 6 PAL0809                69 Adelie Pengui‚Ä¶ Anvers Torge‚Ä¶ Adul‚Ä¶ N32A1           No               2008-11-11             35.9\n#> # ‚Ä¶ with 7 more variables: `Culmen Depth (mm)` <dbl>, `Flipper Length (mm)` <dbl>, `Body Mass (g)` <dbl>, Sex <chr>,\n#> #   `Delta 15 N (o/oo)` <dbl>, `Delta 13 C (o/oo)` <dbl>, Comments <chr>\n\n## Remover linhas de colunas espec√≠ficas com NAs\npenguins_raw_colunas_na <- tidyr::drop_na(data = penguins_raw,\n                                          any_of(\"Comments\"))\nhead(penguins_raw_colunas_na[, \"Comments\"])\n#> # A tibble: 6 √ó 1\n#>   Comments                             \n#>   <chr>                                \n#> 1 Not enough blood for isotopes.       \n#> 2 Adult not sampled.                   \n#> 3 Nest never observed with full clutch.\n#> 4 Nest never observed with full clutch.\n#> 5 No blood sample obtained.            \n#> 6 No blood sample obtained for sexing.\n\n## Substituir NAs por outro valor\npenguins_raw_subs_na <- tidyr::replace_na(data = penguins_raw,\n                                          list(Comments = \"Unknown\"))\nhead(penguins_raw_subs_na[, \"Comments\"])\n#> # A tibble: 6 √ó 1\n#>   Comments                      \n#>   <chr>                         \n#> 1 Not enough blood for isotopes.\n#> 2 Unknown                       \n#> 3 Unknown                       \n#> 4 Adult not sampled.            \n#> 5 Unknown                       \n#> 6 Unknown"},{"path":"cap5.html","id":"pivot_longer-e-pivot_wider","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.7.6 pivot_longer() e pivot_wider()","text":"Por fim, trataremos da pivotagem ou remodelagem de dados. Veremos como mudar o formato nosso conjunto de dados de longo (long) para largo (wide) e vice-versa. Primeiramente, vamos ver como partir de um dado longo (long) e criar um dado largo (wide). Essa √© uma opera√ß√£o semelhante √† ‚ÄúTabela Din√¢mica‚Äù das planilhas eletr√¥nicas. Consiste em usar uma coluna para distribuir seus valores em outras colunas, de modo que os valores dos elementos s√£o preenchidos corretamente, reduzindo assim o n√∫mero de linhas e aumentando o n√∫mero de colunas. Essa opera√ß√£o √© bastante comum em Ecologia de Comunidades, quando queremos transformar uma lista de esp√©cies em uma matriz de comunidades, com v√°rias esp√©cies nas colunas. Para realizar essa opera√ß√£o, usarmos fun√ß√£o tidyr::pivot_wider(). Dos diversos par√¢metros que podem compor essa fun√ß√£o, dois deles s√£o fundamentais: names_from que indica coluna de onde os nomes ser√£o usados e values_from coluna com os valores.De modo oposto, podemos partir de um conjunto de dados largo (wide), ou seja, com v√°rias colunas, e queremos que essas colunas preencham uma √∫nica coluna, e que os valores antes espalhados nessas v√°rias colunas sejam adicionados um embaixo outro, numa √∫nica coluna, formato longo (long). Para essa opera√ß√£o, podemos utilizar fun√ß√£o tidyr::pivot_longer(). Novamente, dos diversos par√¢metros que podem compor essa fun√ß√£o, tr√™s deles s√£o fundamentais: cols indicando colunas que ser√£o usadas para serem pivotadas, names_to que indica coluna de onde os nomes ser√£o usados e values_to coluna com os valores.Para se aprofundar tema, recomendamos leitura Cap√≠tulo 12 Tidy data de Wickham & Grolemund (2017).","code":"\n## Selecionar colunas\npenguins_raw_sel_col <- penguins_raw[, c(2, 3, 13)]\nhead(penguins_raw_sel_col)\n#> # A tibble: 6 √ó 3\n#>   `Sample Number` Species                             `Body Mass (g)`\n#>             <dbl> <chr>                                         <dbl>\n#> 1               1 Adelie Penguin (Pygoscelis adeliae)            3750\n#> 2               2 Adelie Penguin (Pygoscelis adeliae)            3800\n#> 3               3 Adelie Penguin (Pygoscelis adeliae)            3250\n#> 4               4 Adelie Penguin (Pygoscelis adeliae)              NA\n#> 5               5 Adelie Penguin (Pygoscelis adeliae)            3450\n#> 6               6 Adelie Penguin (Pygoscelis adeliae)            3650\n\n## Pivotar para largo\npenguins_raw_pivot_wider <- tidyr::pivot_wider(data = penguins_raw_sel_col, \n                                               names_from = Species, \n                                               values_from = `Body Mass (g)`)\nhead(penguins_raw_pivot_wider)\n#> # A tibble: 6 √ó 4\n#>   `Sample Number` `Adelie Penguin (Pygoscelis adeliae)` `Gentoo penguin (Pygoscelis papua)` `Chinstrap penguin (Pygosceli‚Ä¶`\n#>             <dbl>                                 <dbl>                               <dbl>                           <dbl>\n#> 1               1                                  3750                                4500                            3500\n#> 2               2                                  3800                                5700                            3900\n#> 3               3                                  3250                                4450                            3650\n#> 4               4                                    NA                                5700                            3525\n#> 5               5                                  3450                                5400                            3725\n#> 6               6                                  3650                                4550                            3950\n## Selecionar colunas\npenguins_raw_sel_col <- penguins_raw[, c(2, 3, 10:13)]\nhead(penguins_raw_sel_col)\n#> # A tibble: 6 √ó 6\n#>   `Sample Number` Species                             `Culmen Length (m‚Ä¶` `Culmen Depth ‚Ä¶` `Flipper Lengt‚Ä¶` `Body Mass (g)`\n#>             <dbl> <chr>                                             <dbl>            <dbl>            <dbl>           <dbl>\n#> 1               1 Adelie Penguin (Pygoscelis adeliae)                39.1             18.7              181            3750\n#> 2               2 Adelie Penguin (Pygoscelis adeliae)                39.5             17.4              186            3800\n#> 3               3 Adelie Penguin (Pygoscelis adeliae)                40.3             18                195            3250\n#> 4               4 Adelie Penguin (Pygoscelis adeliae)                NA               NA                 NA              NA\n#> 5               5 Adelie Penguin (Pygoscelis adeliae)                36.7             19.3              193            3450\n#> 6               6 Adelie Penguin (Pygoscelis adeliae)                39.3             20.6              190            3650\n\n## Pivotar para largo\npenguins_raw_pivot_longer <- tidyr::pivot_longer(data = penguins_raw_sel_col, \n                                                 cols = `Culmen Length (mm)`:`Body Mass (g)`,\n                                                 names_to = \"medidas\", \n                                                 values_to = \"valores\")\nhead(penguins_raw_pivot_longer)\n#> # A tibble: 6 √ó 4\n#>   `Sample Number` Species                             medidas             valores\n#>             <dbl> <chr>                               <chr>                 <dbl>\n#> 1               1 Adelie Penguin (Pygoscelis adeliae) Culmen Length (mm)     39.1\n#> 2               1 Adelie Penguin (Pygoscelis adeliae) Culmen Depth (mm)      18.7\n#> 3               1 Adelie Penguin (Pygoscelis adeliae) Flipper Length (mm)   181  \n#> 4               1 Adelie Penguin (Pygoscelis adeliae) Body Mass (g)        3750  \n#> 5               2 Adelie Penguin (Pygoscelis adeliae) Culmen Length (mm)     39.5\n#> 6               2 Adelie Penguin (Pygoscelis adeliae) Culmen Depth (mm)      17.4"},{"path":"cap5.html","id":"dplyr","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8 dplyr","text":"O dplyr √© um pacote que facilita manipula√ß√£o de dados, com uma gram√°tica simples e flex√≠vel (por exemplo, como filtragem, reordenamento, sele√ß√£o, entre outras). Ele foi constru√≠do com o intuito de obter uma forma mais r√°pida e expressiva de manipular dados tabulares. O tibble √© vers√£o de data frame mais conveniente para se usar com pacote dplyr.Todas fun√ß√µes deste pacote s√£o listadas na p√°gina de refer√™ncia pacote.","code":""},{"path":"cap5.html","id":"gram√°tica","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.1 Gram√°tica","text":"Sua gram√°tica simples cont√©m fun√ß√µes verbais para manipula√ß√£o de dados, baseada em:Verbos: mutate(), select(), filter(), arrange(), summarise(), slice(), rename(), etc.Replica√ß√£o: across(), if_any(), if_all(), (), starts_with(), ends_with(), contains(), etc.Agrupamento: group_by() e ungroup()Jun√ß√µes: inner_join(), full_join(), left_join(), right_join(), etc.Combina√ß√µes: bind_rows() e bind_cols()Resumos, contagem e sele√ß√£o: n(), n_distinct(), first(), last(), nth(), etc.Existe uma s√©rie de fun√ß√µes para realizar manipula√ß√£o dos dados, com diversas finalidades: manipula√ß√£o de uma tabela, manipula√ß√£o de duas tabelas, replica√ß√£o, agrupamento, fun√ß√µes de vetores, al√©m de muitas outras fun√ß√µes espec√≠ficas.relocate(): muda ordem das colunasrename(): muda o nome das colunasselect(): seleciona colunas pelo nome ou posi√ß√£opull(): seleciona uma coluna como vetormutate(): adiciona novas colunas ou resultados em colunas existentesarrange(): reordena linhas com base nos valores de colunasfilter(): seleciona linhas com base em valores de colunasslice(): seleciona linhas de diferente formasdistinct(): remove linhas com valores repetidos com base nos valores de colunascount(): conta observa√ß√µes para um grupogroup_by(): agrupa linhas pelos valores das colunassummarise(): resume os dados atrav√©s de fun√ß√µes considerando valores das colunas*_join(): fun√ß√µes que juntam dados de duas tabelas atrav√©s de uma coluna chave","code":""},{"path":"cap5.html","id":"sintaxe","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.2 Sintaxe","text":"fun√ß√µes dplyr podem seguir uma mesma sintaxe: o tibble ser√° sempre o primeiro argumento dessas fun√ß√µes, seguido de um operador pipe (%>%) e pelo nome da fun√ß√£o que ir√° fazer manipula√ß√£o nesses dados. Isso permite o encadeamento de v√°rias opera√ß√µes consecutivas mantendo estrutura dado original e acrescentando mudan√ßas num encadeamento l√≥gico.Sendo assim, fun√ß√µes verbais n√£o precisam modificar necessariamente o tibble original, sendo que opera√ß√µes de manipula√ß√µes podem e devem ser atribu√≠das um novo objeto.Al√©m de data.frames e tibbles, manipula√ß√£o pelo formato dplyr torna o trabalho com outros formatos de classes e dados acess√≠veis e eficientes como data.table, SQL e Apache Spark, para os quais existem pacotes espec√≠ficos.dtplyr: manipular conjuntos de dados data.tabledbplyr: manipular conjuntos de dados SQLsparklyr: manipular conjuntos de dados Apache Spark","code":"\n## Sintaxe\ntb_dplyr <- tb %>% \n    funcao_verbal1(argumento1, argumento2, ...) %>% \n    funcao_verbal2(argumento1, argumento2, ...) %>% \n    funcao_verbal3(argumento1, argumento2, ...)"},{"path":"cap5.html","id":"palmerpenguins-1","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.3 palmerpenguins","text":"Para nossos exemplos, vamos utilizar novamente os dados de pinguins palmerpenguins. Esses dados est√£o dispon√≠veis pacote palmerpenguins. Vamos utilizar principalmente o conjunto de dados penguins, que √© vers√£o simplificada dos dados brutos penguins_raw.","code":"\n## Carregar o pacote palmerpenguins\nlibrary(palmerpenguins)"},{"path":"cap5.html","id":"relocate","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.4 relocate()","text":"Primeiramente, vamos reordenar colunas com fun√ß√£o dplyr::relocate(), onde simplesmente listamos colunas que queremos mudar de posi√ß√£o e para onde elas devem ir. Para esse √∫ltimo passo h√° dois argumentos: .que indica coluna onde coluna realocada deve se mover antes, e o argumento .indicando onde deve se mover depois. Ambos podem ser informados com os nomes ou posi√ß√µes dessas colunas com n√∫meros.","code":"\n## Reordenar colunas - nome\npenguins_relocate_col <- penguins %>% \n    dplyr::relocate(sex, year, .after = island)\nhead(penguins_relocate_col)\n#> # A tibble: 6 √ó 8\n#>   species island    sex     year bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n#>   <fct>   <fct>     <fct>  <int>          <dbl>         <dbl>             <int>       <int>\n#> 1 Adelie  Torgersen male    2007           39.1          18.7               181        3750\n#> 2 Adelie  Torgersen female  2007           39.5          17.4               186        3800\n#> 3 Adelie  Torgersen female  2007           40.3          18                 195        3250\n#> 4 Adelie  Torgersen <NA>    2007           NA            NA                  NA          NA\n#> 5 Adelie  Torgersen female  2007           36.7          19.3               193        3450\n#> 6 Adelie  Torgersen male    2007           39.3          20.6               190        3650\n\n## Reordenar colunas - posi√ß√£o\npenguins_relocate_ncol <- penguins %>% \n    dplyr::relocate(sex, year, .after = 2)\nhead(penguins_relocate_ncol)\n#> # A tibble: 6 √ó 8\n#>   species island    sex     year bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n#>   <fct>   <fct>     <fct>  <int>          <dbl>         <dbl>             <int>       <int>\n#> 1 Adelie  Torgersen male    2007           39.1          18.7               181        3750\n#> 2 Adelie  Torgersen female  2007           39.5          17.4               186        3800\n#> 3 Adelie  Torgersen female  2007           40.3          18                 195        3250\n#> 4 Adelie  Torgersen <NA>    2007           NA            NA                  NA          NA\n#> 5 Adelie  Torgersen female  2007           36.7          19.3               193        3450\n#> 6 Adelie  Torgersen male    2007           39.3          20.6               190        3650"},{"path":"cap5.html","id":"rename","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.5 rename()","text":"Podemos renomear colunas facilmente com fun√ß√£o dplyr::rename(), onde primeiramente informamos o nome que queremos que coluna tenha, seguido operador = e coluna nosso dado (‚Äúnova_coluna = antiga_coluna‚Äù). Tamb√©m podemos utilizar fun√ß√£o dplyr::rename_with(), que faz mudan√ßa nome em m√∫ltiplas colunas, que pode depender ou n√£o de resultados booleanos.","code":"\n## Renomear as colunas\npenguins_rename <- penguins %>% \n    dplyr::rename(bill_length = bill_length_mm,\n                  bill_depth = bill_depth_mm,\n                  flipper_length = flipper_length_mm,\n                  body_mass = body_mass_g)\nhead(penguins_rename)\n#> # A tibble: 6 √ó 8\n#>   species island    bill_length bill_depth flipper_length body_mass sex     year\n#>   <fct>   <fct>           <dbl>      <dbl>          <int>     <int> <fct>  <int>\n#> 1 Adelie  Torgersen        39.1       18.7            181      3750 male    2007\n#> 2 Adelie  Torgersen        39.5       17.4            186      3800 female  2007\n#> 3 Adelie  Torgersen        40.3       18              195      3250 female  2007\n#> 4 Adelie  Torgersen        NA         NA               NA        NA <NA>    2007\n#> 5 Adelie  Torgersen        36.7       19.3            193      3450 female  2007\n#> 6 Adelie  Torgersen        39.3       20.6            190      3650 male    2007\n\n## mudar o nome de todas as colunas\npenguins_rename_with <- penguins %>% \n    dplyr::rename_with(toupper)\nhead(penguins_rename_with)\n#> # A tibble: 6 √ó 8\n#>   SPECIES ISLAND    BILL_LENGTH_MM BILL_DEPTH_MM FLIPPER_LENGTH_MM BODY_MASS_G SEX     YEAR\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n#> 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 4 Adelie  Torgersen           NA            NA                  NA          NA <NA>    2007\n#> 5 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n#> 6 Adelie  Torgersen           39.3          20.6               190        3650 male    2007"},{"path":"cap5.html","id":"select","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.6 select()","text":"Outra opera√ß√£o bastante usual dentro da manipula√ß√£o de dados tabulares √© sele√ß√£o de colunas. Podemos fazer essa opera√ß√£o com fun√ß√£o dplyr::select(), que seleciona colunas pelo nome ou pela sua posi√ß√£o. Aqui h√° uma s√©rie de possibilidades de sele√ß√£o de colunas, desde utilizar operadores como : para selecionar intervalos de colunas, ! para tomar o complemento (todas menos listadas), al√©m de fun√ß√µes como dplyr::starts_with(), dplyr::ends_with(), dplyr::contains() para procurar colunas com um padr√£o de texto nome da coluna.","code":"\n## Selecionar colunas por posi√ß√£o\npenguins_select_position <- penguins %>% \n    dplyr::select(3:6)\nhead(penguins_select_position)\n#> # A tibble: 6 √ó 4\n#>   bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n#>            <dbl>         <dbl>             <int>       <int>\n#> 1           39.1          18.7               181        3750\n#> 2           39.5          17.4               186        3800\n#> 3           40.3          18                 195        3250\n#> 4           NA            NA                  NA          NA\n#> 5           36.7          19.3               193        3450\n#> 6           39.3          20.6               190        3650\n\n## Selecionar colunas por nomes\npenguins_select_names <- penguins %>% \n    dplyr::select(bill_length_mm:body_mass_g)\nhead(penguins_select_names)\n#> # A tibble: 6 √ó 4\n#>   bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n#>            <dbl>         <dbl>             <int>       <int>\n#> 1           39.1          18.7               181        3750\n#> 2           39.5          17.4               186        3800\n#> 3           40.3          18                 195        3250\n#> 4           NA            NA                  NA          NA\n#> 5           36.7          19.3               193        3450\n#> 6           39.3          20.6               190        3650\n\n## Selecionar colunas por padr√£o\npenguins_select_contains <- penguins %>% \n    dplyr::select(contains(\"_mm\"))\nhead(penguins_select_contains)\n#> # A tibble: 6 √ó 3\n#>   bill_length_mm bill_depth_mm flipper_length_mm\n#>            <dbl>         <dbl>             <int>\n#> 1           39.1          18.7               181\n#> 2           39.5          17.4               186\n#> 3           40.3          18                 195\n#> 4           NA            NA                  NA\n#> 5           36.7          19.3               193\n#> 6           39.3          20.6               190"},{"path":"cap5.html","id":"pull","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.7 pull()","text":"Quando usamos fun√ß√£o dplyr::select(), mesmo que para apenas uma coluna, o retorno da fun√ß√£o √© sempre um tibble. Caso precisemos que essa coluna se torne um vetor dentro encadeamento dos pipes, usamos fun√ß√£o dplyr::pull(), que extrai uma √∫nica coluna como vetor.","code":"\n## Coluna como vetor\npenguins_select_pull <- penguins %>% \n    dplyr::pull(bill_length_mm)\nhead(penguins_select_pull, 15)\n#>  [1] 39.1 39.5 40.3   NA 36.7 39.3 38.9 39.2 34.1 42.0 37.8 37.8 41.1 38.6 34.6"},{"path":"cap5.html","id":"mutate","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.8 mutate()","text":"Uma das opera√ß√µes mais √∫teis dentre opera√ß√µes para colunas √© adicionar ou atualizar os valores de colunas. Para essa opera√ß√£o, usaremos fun√ß√£o dplyr::mutate(). Podemos ainda usar os argumentos .e .para indicar onde nova coluna deve ficar, al√©m par√¢metro .keep com diversas possibilidades de manter colunas depois de usar fun√ß√£o dplyr::mutate(). Por fim, √© fundamental destacar o uso das fun√ß√µes de replica√ß√£o: dplyr::across(), dplyr::if_any() e dplyr::if_all(), para os quais fun√ß√£o far√° altera√ß√µes em m√∫ltiplas colunas de uma vez, dependendo de resultados booleanos.","code":"\n## Adicionar colunas\npenguins_mutate <- penguins %>% \n    dplyr::mutate(body_mass_kg = body_mass_g/1e3, .before = sex)\nhead(penguins_mutate)\n#> # A tibble: 6 √ó 9\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g body_mass_kg sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>        <dbl> <fct>  <int>\n#> 1 Adelie  Torgersen           39.1          18.7               181        3750         3.75 male    2007\n#> 2 Adelie  Torgersen           39.5          17.4               186        3800         3.8  female  2007\n#> 3 Adelie  Torgersen           40.3          18                 195        3250         3.25 female  2007\n#> 4 Adelie  Torgersen           NA            NA                  NA          NA        NA    <NA>    2007\n#> 5 Adelie  Torgersen           36.7          19.3               193        3450         3.45 female  2007\n#> 6 Adelie  Torgersen           39.3          20.6               190        3650         3.65 male    2007\n\n## Modificar v√°rias colunas\npenguins_mutate_across <- penguins %>% \n    dplyr::mutate(across(where(is.factor), as.character))\nhead(penguins_mutate_across)\n#> # A tibble: 6 √ó 8\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <chr>   <chr>              <dbl>         <dbl>             <int>       <int> <chr>  <int>\n#> 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n#> 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 4 Adelie  Torgersen           NA            NA                  NA          NA <NA>    2007\n#> 5 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n#> 6 Adelie  Torgersen           39.3          20.6               190        3650 male    2007"},{"path":"cap5.html","id":"arrange","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.9 arrange()","text":"Al√©m de opera√ß√µes em colunas, podemos fazer opera√ß√µes em linhas. Vamos come√ßar com reordena√ß√£o das linhas com base nos valores das colunas. Para essa opera√ß√£o, usamos fun√ß√£o dplyr::arrange(). Podemos reordenar por uma ou mais colunas de forma crescente ou decrescente usando fun√ß√£o desc() ou o operador - antes da coluna de interesse. Da mesma forma que na fun√ß√£o dplyr::mutate(), podemos usar fun√ß√µes de replica√ß√£o para ordenar linhas para v√°rias colunas de uma vez, dependendo de resultados booleanos.","code":"\n## Reordenar linhas - crescente\npenguins_arrange <- penguins %>% \n    dplyr::arrange(body_mass_g)\nhead(penguins_arrange)\n#> # A tibble: 6 √ó 8\n#>   species   island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>     <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Chinstrap Dream               46.9          16.6               192        2700 female  2008\n#> 2 Adelie    Biscoe              36.5          16.6               181        2850 female  2008\n#> 3 Adelie    Biscoe              36.4          17.1               184        2850 female  2008\n#> 4 Adelie    Biscoe              34.5          18.1               187        2900 female  2008\n#> 5 Adelie    Dream               33.1          16.1               178        2900 female  2008\n#> 6 Adelie    Torgersen           38.6          17                 188        2900 female  2009\n\n## Reordenar linhas - decrescente\npenguins_arrange_desc <- penguins %>% \n    dplyr::arrange(desc(body_mass_g))\nhead(penguins_arrange_desc)\n#> # A tibble: 6 √ó 8\n#>   species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex    year\n#>   <fct>   <fct>           <dbl>         <dbl>             <int>       <int> <fct> <int>\n#> 1 Gentoo  Biscoe           49.2          15.2               221        6300 male   2007\n#> 2 Gentoo  Biscoe           59.6          17                 230        6050 male   2007\n#> 3 Gentoo  Biscoe           51.1          16.3               220        6000 male   2008\n#> 4 Gentoo  Biscoe           48.8          16.2               222        6000 male   2009\n#> 5 Gentoo  Biscoe           45.2          16.4               223        5950 male   2008\n#> 6 Gentoo  Biscoe           49.8          15.9               229        5950 male   2009\n\n## Reordenar linhas - decrescente\npenguins_arrange_desc_m <- penguins %>% \n    dplyr::arrange(-body_mass_g)\nhead(penguins_arrange_desc_m)\n#> # A tibble: 6 √ó 8\n#>   species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex    year\n#>   <fct>   <fct>           <dbl>         <dbl>             <int>       <int> <fct> <int>\n#> 1 Gentoo  Biscoe           49.2          15.2               221        6300 male   2007\n#> 2 Gentoo  Biscoe           59.6          17                 230        6050 male   2007\n#> 3 Gentoo  Biscoe           51.1          16.3               220        6000 male   2008\n#> 4 Gentoo  Biscoe           48.8          16.2               222        6000 male   2009\n#> 5 Gentoo  Biscoe           45.2          16.4               223        5950 male   2008\n#> 6 Gentoo  Biscoe           49.8          15.9               229        5950 male   2009\n\n## Reordenar linhas - multiplas colunas\npenguins_arrange_across <- penguins %>% \n    dplyr::arrange(across(where(is.numeric)))\nhead(penguins_arrange_across)\n#> # A tibble: 6 √ó 8\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Dream               32.1          15.5               188        3050 female  2009\n#> 2 Adelie  Dream               33.1          16.1               178        2900 female  2008\n#> 3 Adelie  Torgersen           33.5          19                 190        3600 female  2008\n#> 4 Adelie  Dream               34            17.1               185        3400 female  2008\n#> 5 Adelie  Torgersen           34.1          18.1               193        3475 <NA>    2007\n#> 6 Adelie  Torgersen           34.4          18.4               184        3325 female  2007"},{"path":"cap5.html","id":"filter","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.10 filter()","text":"Uma das principais e mais usuais opera√ß√µes que podemos realizar em linhas √© sele√ß√£o de linhas atrav√©s filtro por valores de uma ou mais colunas, utilizando fun√ß√£o dplyr::filter(). Para realizar os filtros utilizaremos grande parte dos operadores relacionais e l√≥gicos que listamos na Tabela 4.1 Cap√≠tulo 4, especialmente os l√≥gicos para combina√ß√µes de filtros em mais de uma coluna. Al√©m desses operadores, podemos utilizar fun√ß√£o .na() para filtros em elementos faltantes, e fun√ß√µes dplyr::() e dplyr::near() para filtros entre valores, e para valores pr√≥ximos com certa toler√¢ncia, respectivamente. Por fim, podemos usar fun√ß√µes de replica√ß√£o para filtro das linhas para mais de uma coluna, dependendo de resultados booleanos.","code":"\n## Filtrar linhas\npenguins_filter <- penguins %>% \n    dplyr::filter(species == \"Adelie\")\nhead(penguins_filter)\n#> # A tibble: 6 √ó 8\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n#> 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 4 Adelie  Torgersen           NA            NA                  NA          NA <NA>    2007\n#> 5 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n#> 6 Adelie  Torgersen           39.3          20.6               190        3650 male    2007\n\n## Filtrar linhas\npenguins_filter_two <- penguins %>% \n    dplyr::filter(species == \"Adelie\" & sex == \"female\")\nhead(penguins_filter_two)\n#> # A tibble: 6 √ó 8\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 2 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 3 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n#> 4 Adelie  Torgersen           38.9          17.8               181        3625 female  2007\n#> 5 Adelie  Torgersen           41.1          17.6               182        3200 female  2007\n#> 6 Adelie  Torgersen           36.6          17.8               185        3700 female  2007\n\n## Filtrar linhas\npenguins_filter_in <- penguins %>% \n    dplyr::filter(species %in% c(\"Adelie\", \"Gentoo\"),\n                  sex == \"female\")\nhead(penguins_filter_in)\n#> # A tibble: 6 √ó 8\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 2 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 3 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n#> 4 Adelie  Torgersen           38.9          17.8               181        3625 female  2007\n#> 5 Adelie  Torgersen           41.1          17.6               182        3200 female  2007\n#> 6 Adelie  Torgersen           36.6          17.8               185        3700 female  2007\n\n## Filtrar linhas - NA\npenguins_filter_na <- penguins %>% \n    dplyr::filter(!is.na(sex) == TRUE)\nhead(penguins_filter_na)\n#> # A tibble: 6 √ó 8\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n#> 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n#> 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007\n#> 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007\n\n## Filtrar linhas - intervalos\npenguins_filter_between <- penguins %>% \n    dplyr::filter(between(body_mass_g, 3000, 4000))\nhead(penguins_filter_between)\n#> # A tibble: 6 √ó 8\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n#> 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n#> 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007\n#> 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007\n\n## Filtrar linhas por v√°rias colunas\npenguins_filter_if <- penguins %>% \n    dplyr::filter(if_all(where(is.integer), ~ . > 200))\nhead(penguins_filter_if)\n#> # A tibble: 6 √ó 8\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Dream               35.7          18                 202        3550 female  2008\n#> 2 Adelie  Dream               41.1          18.1               205        4300 male    2008\n#> 3 Adelie  Dream               40.8          18.9               208        4300 male    2008\n#> 4 Adelie  Biscoe              41            20                 203        4725 male    2009\n#> 5 Adelie  Torgersen           41.4          18.5               202        3875 male    2009\n#> 6 Adelie  Torgersen           44.1          18                 210        4000 male    2009"},{"path":"cap5.html","id":"slice","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.11 slice()","text":"Al√©m da sele√ß√£o de linhas por filtros, podemos fazer sele√ß√£o das linhas por intervalos, indicando quais linhas desejamos, usando fun√ß√£o dplyr::slice(), e informando o argumento n para o n√∫mero da linha ou intervalo das linhas. Essa fun√ß√£o possui varia√ß√µes sufixo muito interessantes: dplyr::slice_head() e dplyr::slice_tail() seleciona primeiras e √∫ltimas linhas, dplyr::slice_min() e dplyr::slice_max() seleciona linhas com os maiores e menores valores de uma coluna, e dplyr::slice_sample() seleciona linhas aleatoriamente.","code":"\n## Seleciona linhas\npenguins_slice <- penguins %>% \n    dplyr::slice(n = c(1, 3, 300:n()))\nhead(penguins_slice)\n#> # A tibble: 6 √ó 8\n#>   species   island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>     <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie    Torgersen           39.1          18.7               181        3750 male    2007\n#> 2 Adelie    Torgersen           40.3          18                 195        3250 female  2007\n#> 3 Chinstrap Dream               50.6          19.4               193        3800 male    2007\n#> 4 Chinstrap Dream               46.7          17.9               195        3300 female  2007\n#> 5 Chinstrap Dream               52            19                 197        4150 male    2007\n#> 6 Chinstrap Dream               50.5          18.4               200        3400 female  2008\n\n## Seleciona linhas - head\npenguins_slice_head <- penguins %>% \n    dplyr::slice_head(n = 5)\nhead(penguins_slice_head)\n#> # A tibble: 5 √ó 8\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n#> 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 4 Adelie  Torgersen           NA            NA                  NA          NA <NA>    2007\n#> 5 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n\n## Seleciona linhas - max\npenguins_slice_max <- penguins %>% \n    dplyr::slice_max(body_mass_g, n = 5)\nhead(penguins_slice_max)\n#> # A tibble: 6 √ó 8\n#>   species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex    year\n#>   <fct>   <fct>           <dbl>         <dbl>             <int>       <int> <fct> <int>\n#> 1 Gentoo  Biscoe           49.2          15.2               221        6300 male   2007\n#> 2 Gentoo  Biscoe           59.6          17                 230        6050 male   2007\n#> 3 Gentoo  Biscoe           51.1          16.3               220        6000 male   2008\n#> 4 Gentoo  Biscoe           48.8          16.2               222        6000 male   2009\n#> 5 Gentoo  Biscoe           45.2          16.4               223        5950 male   2008\n#> 6 Gentoo  Biscoe           49.8          15.9               229        5950 male   2009\n\n## Seleciona linhas - sample\npenguins_slice_sample <- penguins %>% \n    dplyr::slice_sample(n = 30)\nhead(penguins_slice_sample)\n#> # A tibble: 6 √ó 8\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Biscoe              41.3          21.1               195        4400 male    2008\n#> 2 Gentoo  Biscoe              44.5          15.7               217        4875 <NA>    2009\n#> 3 Adelie  Torgersen           41.4          18.5               202        3875 male    2009\n#> 4 Adelie  Biscoe              37.6          17                 185        3600 female  2008\n#> 5 Adelie  Dream               36            17.9               190        3450 female  2007\n#> 6 Adelie  Biscoe              35.7          16.9               185        3150 female  2008"},{"path":"cap5.html","id":"distinct","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.12 distinct()","text":"√∫ltima opera√ß√£o que apresentaremos para linhas √© retirada de linhas com valores repetidos com base nos valores de uma ou mais colunas, utilizando fun√ß√£o dplyr::distinct(). Essa fun√ß√£o por padr√£o retorna apenas (s) coluna(s) utilizada(s) para retirar linhas com valores repetidos, sendo necess√°rio acrescentar o argumento .keep_all = TRUE para retornar todas colunas. Por fim, podemos usar fun√ß√µes de replica√ß√£o para retirar linhas com valores repetidos para mais de uma coluna, dependendo de resultados booleanos.","code":"\n## Retirar linhas com valores repetidos\npenguins_distinct <- penguins %>% \n    dplyr::distinct(body_mass_g)\nhead(penguins_distinct)\n#> # A tibble: 6 √ó 1\n#>   body_mass_g\n#>         <int>\n#> 1        3750\n#> 2        3800\n#> 3        3250\n#> 4          NA\n#> 5        3450\n#> 6        3650\n\n## Retirar linhas com valores repetidos - manter as outras colunas\npenguins_distinct_keep_all <- penguins %>% \n    dplyr::distinct(body_mass_g, .keep_all = TRUE)\nhead(penguins_distinct_keep_all)\n#> # A tibble: 6 √ó 8\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n#> 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 4 Adelie  Torgersen           NA            NA                  NA          NA <NA>    2007\n#> 5 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n#> 6 Adelie  Torgersen           39.3          20.6               190        3650 male    2007\n\n## Retirar linhas com valores repetidos para v√°rias colunas\npenguins_distinct_keep_all_across <- penguins %>% \n    dplyr::distinct(across(where(is.integer)), .keep_all = TRUE)\nhead(penguins_distinct_keep_all_across)\n#> # A tibble: 6 √ó 8\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n#> 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 4 Adelie  Torgersen           NA            NA                  NA          NA <NA>    2007\n#> 5 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n#> 6 Adelie  Torgersen           39.3          20.6               190        3650 male    2007"},{"path":"cap5.html","id":"count","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.13 count()","text":"Agora entraremos assunto de resumo das observa√ß√µes. Podemos fazer contagens resumos dos nossos dados, utilizando para isso fun√ß√£o dplyr::count(). Essa fun√ß√£o contar√° valores de uma ou mais colunas, geralmente para vari√°veis categ√≥ricas, semelhante √† fun√ß√£o Base R table(), mas num contexto tidyverse.","code":"\n## Contagens de valores para uma coluna\npenguins_count <- penguins %>% \n    dplyr::count(species)\npenguins_count\n#> # A tibble: 3 √ó 2\n#>   species       n\n#>   <fct>     <int>\n#> 1 Adelie      152\n#> 2 Chinstrap    68\n#> 3 Gentoo      124\n\n## Contagens de valores para mais de uma coluna\npenguins_count_two <- penguins %>% \n    dplyr::count(species, island)\npenguins_count_two\n#> # A tibble: 5 √ó 3\n#>   species   island        n\n#>   <fct>     <fct>     <int>\n#> 1 Adelie    Biscoe       44\n#> 2 Adelie    Dream        56\n#> 3 Adelie    Torgersen    52\n#> 4 Chinstrap Dream        68\n#> 5 Gentoo    Biscoe      124"},{"path":"cap5.html","id":"group_by","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.14 group_by()","text":"Uma grande parte das opera√ß√µes feitas nos dados s√£o realizadas em grupos definidos por valores de colunas com dados categ√≥ricas. fun√ß√£o dplyr::group_by() transforma um tibble em um tibble grouped, onde opera√ß√µes s√£o realizadas ‚Äúpor grupo.‚Äù Essa fun√ß√£o √© utilizada geralmente junto com fun√ß√£o dplyr::summarise(), que veremos logo em seguida. O agrupamento n√£o altera apar√™ncia dos dados (al√©m de informar como est√£o agrupados). fun√ß√£o dplyr::ungroup() remove o agrupamento. Podemos ainda usar fun√ß√µes de replica√ß√£o para fazer os agrupamentos para mais de uma coluna, dependendo de resultados booleanos.","code":"\n## Agrupamento\npenguins_group_by <- penguins %>% \n    dplyr::group_by(species)\nhead(penguins_group_by)\n#> # A tibble: 6 √ó 8\n#> # Groups:   species [1]\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n#> 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 4 Adelie  Torgersen           NA            NA                  NA          NA <NA>    2007\n#> 5 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n#> 6 Adelie  Torgersen           39.3          20.6               190        3650 male    2007\n\n## Agrupamento de v√°rias colunas\npenguins_group_by_across <- penguins %>% \n    dplyr::group_by(across(where(is.factor)))\nhead(penguins_group_by_across)\n#> # A tibble: 6 √ó 8\n#> # Groups:   species, island, sex [3]\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n#> 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 4 Adelie  Torgersen           NA            NA                  NA          NA <NA>    2007\n#> 5 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n#> 6 Adelie  Torgersen           39.3          20.6               190        3650 male    2007"},{"path":"cap5.html","id":"summarise","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.15 summarise()","text":"Como dissemos, muitas vezes queremos resumir nossos dados, principalmente para ter uma no√ß√£o geral das vari√°veis (colunas) ou mesmo come√ßar an√°lise explorat√≥ria resumindo vari√°veis cont√≠nuas por grupos de vari√°veis categ√≥ricas. Dessa forma, ao utilizar fun√ß√£o dplyr::summarise() teremos um novo tibble com os dados resumidos, que √© agrega√ß√£o ou resumo dos dados atrav√©s de fun√ß√µes. Da mesma forma que outras fun√ß√µes, podemos usar fun√ß√µes de replica√ß√£o para resumir valores para mais de uma coluna, dependendo de resultados booleanos.","code":"\n## Resumo\npenguins_summarise <- penguins %>% \n    dplyr::group_by(species) %>% \n    dplyr::summarize(body_mass_g_mean = mean(body_mass_g, na.rm = TRUE),\n                     body_mass_g_sd = sd(body_mass_g, na.rm = TRUE))\npenguins_summarise\n#> # A tibble: 3 √ó 3\n#>   species   body_mass_g_mean body_mass_g_sd\n#>   <fct>                <dbl>          <dbl>\n#> 1 Adelie               3701.           459.\n#> 2 Chinstrap            3733.           384.\n#> 3 Gentoo               5076.           504.\n\n## Resumo para v√°rias colunas\npenguins_summarise_across <- penguins %>% \n    dplyr::group_by(species) %>% \n    dplyr::summarize(across(where(is.numeric), ~ mean(.x, na.rm = TRUE)))\npenguins_summarise_across\n#> # A tibble: 3 √ó 6\n#>   species   bill_length_mm bill_depth_mm flipper_length_mm body_mass_g  year\n#>   <fct>              <dbl>         <dbl>             <dbl>       <dbl> <dbl>\n#> 1 Adelie              38.8          18.3              190.       3701. 2008.\n#> 2 Chinstrap           48.8          18.4              196.       3733. 2008.\n#> 3 Gentoo              47.5          15.0              217.       5076. 2008."},{"path":"cap5.html","id":"bind_rows-e-bind_cols","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.16 bind_rows() e bind_cols()","text":"Muitas vezes teremos de combinar duas ou mais tabelas de dados. Podemos utilizar fun√ß√µes Base R rbind() e cbind(), como vimos Cap√≠tulo 4. Entretanto, pode ser interessante avan√ßar para fun√ß√µes dplyr::bind_rows() e dplyr::bind_cols() formato tidyverse. ideia √© muito semelhante: primeira fun√ß√£o combina dados por linhas e segunda por colunas. Entretanto, h√° algumas vantagens uso dessas fun√ß√µes, como identifica√ß√£o das linhas pelo argumento .id para primeira fun√ß√£o, e confer√™ncia nome das colunas pelo argumento .name_repair para segunda fun√ß√£o.","code":"\n## Selecionar as linhas para dois tibbles\npenguins_01 <- dplyr::slice(penguins, 1:5)\npenguins_02 <- dplyr::slice(penguins, 51:55)\n\n## Combinar as linhas\npenguins_bind_rows <- dplyr::bind_rows(penguins_01, penguins_02, .id = \"id\")\nhead(penguins_bind_rows)\n#> # A tibble: 6 √ó 9\n#>   id    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n#>   <chr> <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n#> 1 1     Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n#> 2 1     Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n#> 3 1     Adelie  Torgersen           40.3          18                 195        3250 female  2007\n#> 4 1     Adelie  Torgersen           NA            NA                  NA          NA <NA>    2007\n#> 5 1     Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n#> 6 2     Adelie  Biscoe              39.6          17.7               186        3500 female  2008\n\n## Combinar as colunas\npenguins_bind_cols <- dplyr::bind_cols(penguins_01, penguins_02, .name_repair = \"unique\")\nhead(penguins_bind_cols)\n#> # A tibble: 5 √ó 16\n#>   species...1 island...2 bill_length_mm...3 bill_depth_mm...4 flipper_length_‚Ä¶ body_mass_g...6 sex...7 year...8 species...9\n#>   <fct>       <fct>                   <dbl>             <dbl>            <int>           <int> <fct>      <int> <fct>      \n#> 1 Adelie      Torgersen                39.1              18.7              181            3750 male        2007 Adelie     \n#> 2 Adelie      Torgersen                39.5              17.4              186            3800 female      2007 Adelie     \n#> 3 Adelie      Torgersen                40.3              18                195            3250 female      2007 Adelie     \n#> 4 Adelie      Torgersen                NA                NA                 NA              NA <NA>        2007 Adelie     \n#> 5 Adelie      Torgersen                36.7              19.3              193            3450 female      2007 Adelie     \n#> # ‚Ä¶ with 7 more variables: island...10 <fct>, bill_length_mm...11 <dbl>, bill_depth_mm...12 <dbl>,\n#> #   flipper_length_mm...13 <int>, body_mass_g...14 <int>, sex...15 <fct>, year...16 <int>"},{"path":"cap5.html","id":"join","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.17 *_join()","text":"Finalmente, veremos o √∫ltimo conjunto de fun√ß√µes pacote dplyr, jun√ß√£o de tabelas. Nessa opera√ß√£o, fazemos combina√ß√£o de pares de conjunto de dados tabulares por uma ou mais colunas chaves. H√° dois tipos de jun√ß√µes: jun√ß√£o de modifica√ß√£o e jun√ß√£o de filtragem. jun√ß√£o de modifica√ß√£o primeiro combina observa√ß√µes por suas chaves e, em seguida, copia vari√°veis (colunas) de uma tabela para outra. √â fundamental destacar import√¢ncia da coluna chave, que √© indicada pelo argumento . Essa coluna deve conter elementos que sejam comuns √†s duas tabelas para que haja combina√ß√£o dos elementos.Existem quatro tipos de jun√ß√µes de modifica√ß√µes, que s√£o realizadas pelas fun√ß√µes: dplyr::inner_join(), dplyr::left_join(), dplyr::full_join() e dplyr::right_join(), e que podem ser representadas na Figura 5.3.\nFigura 5.3: Diferentes tipos de joins, representados com um diagrama de Venn. Adaptado de Wickham & Grolemund (2017).\nConsiderando nomenclatura de duas tabelas de dados por x e y, temos:inner_join(x, y): mant√©m apenas observa√ß√µes em x e em yleft_join(x, y): mant√©m todas observa√ß√µes em xright_join(x, y): mant√©m todas observa√ß√µes em yfull_join(x, y): mant√©m todas observa√ß√µes em x e em yAqui, vamos demostrar apenas fun√ß√£o dplyr::left_join(), combinando um tibble de coordenadas geogr√°ficas das ilhas com o conjunto de dados penguins.J√° o segundo tipo de jun√ß√£o, jun√ß√£o de filtragem combina observa√ß√µes da mesma maneira que jun√ß√µes de modifica√ß√£o, mas afetam observa√ß√µes (linhas), n√£o vari√°veis (colunas). Existem dois tipos.semi_join(x, y): mant√©m todas observa√ß√µes em x que t√™m uma correspond√™ncia em yanti_join(x, y): elimina todas observa√ß√µes em x que t√™m uma correspond√™ncia em yDe forma geral, semi-joins s√£o √∫teis para corresponder tabelas de resumo filtradas de volta √†s linhas originais, removendo linhas que n√£o estavam antes join. J√° anti-joins s√£o √∫teis para diagnosticar incompatibilidades de jun√ß√£o, por exemplo, ao verificar os elementos que n√£o combinam entre duas tabelas de dados.","code":"\n## Adicionar uma coluna chave de ids\npenguin_islands <- tibble(\n    island = c(\"Torgersen\", \"Biscoe\", \"Dream\", \"Alpha\"),\n    longitude = c(-64.083333, -63.775636, -64.233333, -63),\n    latitude = c(-64.766667, -64.818569, -64.733333, -64.316667))\n\n## Jun√ß√£o - left\npenguins_left_join <- dplyr::left_join(penguins, penguin_islands, by = \"island\")\nhead(penguins_left_join)\n#> # A tibble: 6 √ó 10\n#>   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year longitude latitude\n#>   <fct>   <chr>              <dbl>         <dbl>             <int>       <int> <fct>  <int>     <dbl>    <dbl>\n#> 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007     -64.1    -64.8\n#> 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007     -64.1    -64.8\n#> 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007     -64.1    -64.8\n#> 4 Adelie  Torgersen           NA            NA                  NA          NA <NA>    2007     -64.1    -64.8\n#> 5 Adelie  Torgersen           36.7          19.3               193        3450 female  2007     -64.1    -64.8\n#> 6 Adelie  Torgersen           39.3          20.6               190        3650 male    2007     -64.1    -64.8"},{"path":"cap5.html","id":"opera√ß√µes-de-conjuntos-e-compara√ß√£o-de-dados","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.8.18 Opera√ß√µes de conjuntos e compara√ß√£o de dados","text":"Temos ainda opera√ß√µes de conjuntos e compara√ß√£o de dados.union(x, y): retorna todas linhas que aparecem em x, y ou mais dos conjuntos de dadosinteresect(x, y): retorna apenas linhas que aparecem em x e em ysetdiff(x, y): retorna linhas que aparecem x, mas n√£o em ysetequal(x, y): retorna se x e y s√£o iguais e quais suas diferen√ßasPara se aprofundar tema, recomendamos leitura Cap√≠tulo 13 Relational data de Wickham & Grolemund (2017).","code":""},{"path":"cap5.html","id":"stringr","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.9 stringr","text":"O pacote stringr fornece um conjunto de fun√ß√µes para manipula√ß√£o de caracteres ou strings. O pacote concentra-se nas fun√ß√µes de manipula√ß√£o mais importantes e comumente usadas. Para fun√ß√µes mais espec√≠ficas, recomenda-se usar o pacote stringi, que fornece um conjunto mais abrangente de fun√ß√µes. fun√ß√µes stringr podem ser agrupadas em algumas opera√ß√µes para tarefas espec√≠ficas como ) correspond√™ncia de padr√µes, ii)retirar e acrescentar espa√ßos em branco, iii) mudar mai√∫sculas e min√∫sculas, al√©m de muitas outras opera√ß√µes com caracteres.Todas fun√ß√µes deste pacote s√£o listadas na p√°gina de refer√™ncia pacote.Demonstraremos algumas fun√ß√µes para algumas opera√ß√µes mais comuns, utilizando um vetor de um elemento, com o string ‚Äúpenguins.‚ÄùPodemos explorar o comprimento de strings com fun√ß√£o stringr::str_length().Extrair um string por sua posi√ß√£o usando fun√ß√£o stringr::str_sub() ou por um padr√£o com stringr::str_extract().Substituir strings por outros strings com stringr::str_replace().Separar strings por um padr√£o com fun√ß√£o stringr::str_split().Inserir espa√ßos em brancos pela esquerda, direita ou ambos com fun√ß√£o stringr::str_pad().Tamb√©m podemos remover espa√ßos em branco da esquerda, direita ou ambos, utilizando stringr::str_trim().Podemos tamb√©m alterar min√∫sculas e mai√∫sculas em diferentes posi√ß√µes string, com v√°rias fun√ß√µes.Podemos ainda ordenar os elementos de um vetor por ordem alfab√©tica de forma crescente ou decrescente, usando stringr::str_sort().Podemos ainda utilizar essas fun√ß√µes em complemento com o pacote dplyr, para alterar os strings de colunas ou nome das colunas.Para se aprofundar tema, recomendamos leitura Cap√≠tulo 14 Strings de Wickham & Grolemund (2017).","code":"\n## Comprimento\nstringr::str_length(string = \"penguins\")\n#> [1] 8\n## Extrair pela posi√ß√£o\nstringr::str_sub(string = \"penguins\", end = 3)\n#> [1] \"pen\"\n\n## Extrair por padr√£o\nstringr::str_extract(string = \"penguins\", pattern = \"p\")\n#> [1] \"p\"\n## Substituir\nstringr::str_replace(string = \"penguins\", pattern = \"i\", replacement = \"y\")\n#> [1] \"penguyns\"\n## Separar\nstringr::str_split(string = \"p-e-n-g-u-i-n-s\", pattern = \"-\", simplify = TRUE)\n#>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]\n#> [1,] \"p\"  \"e\"  \"n\"  \"g\"  \"u\"  \"i\"  \"n\"  \"s\"\n## Inserir espacos em branco\nstringr::str_pad(string = \"penguins\", width = 10, side = \"left\")\n#> [1] \"  penguins\"\nstringr::str_pad(string = \"penguins\", width = 10, side = \"right\")\n#> [1] \"penguins  \"\nstringr::str_pad(string = \"penguins\", width = 10, side = \"both\")\n#> [1] \" penguins \"\n## Remover espacos em branco\nstringr::str_trim(string = \" penguins \", side = \"left\")\n#> [1] \"penguins \"\nstringr::str_trim(string = \" penguins \", side = \"right\")\n#> [1] \" penguins\"\nstringr::str_trim(string = \" penguins \", side = \"both\")\n#> [1] \"penguins\"\n## Alterar min√∫sculas e mai√∫sculas\nstringr::str_to_lower(string = \"Penguins\")\n#> [1] \"penguins\"\nstringr::str_to_upper(string = \"penguins\")\n#> [1] \"PENGUINS\"\nstringr::str_to_sentence(string = \"penGuins\")\n#> [1] \"Penguins\"\nstringr::str_to_title(string = \"penGuins\")\n#> [1] \"Penguins\"\n## Ordenar\nstringr::str_sort(x = letters)\n#>  [1] \"a\" \"b\" \"c\" \"d\" \"e\" \"f\" \"g\" \"h\" \"i\" \"j\" \"k\" \"l\" \"m\" \"n\" \"o\" \"p\" \"q\" \"r\" \"s\" \"t\" \"u\" \"v\" \"w\" \"x\" \"y\" \"z\"\nstringr::str_sort(x = letters, dec = TRUE)\n#>  [1] \"z\" \"y\" \"x\" \"w\" \"v\" \"u\" \"t\" \"s\" \"r\" \"q\" \"p\" \"o\" \"n\" \"m\" \"l\" \"k\" \"j\" \"i\" \"h\" \"g\" \"f\" \"e\" \"d\" \"c\" \"b\" \"a\"\n## Alterar valores das colunas\npenguins_stringr_valores <- penguins %>% \n    dplyr::mutate(species = stringr::str_to_lower(species))\n\n## Alterar nome das colunas\npenguins_stringr_nomes <- penguins %>% \n    dplyr::rename_with(stringr::str_to_title)"},{"path":"cap5.html","id":"forcats","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.10 forcats","text":"O pacote forcats fornece um conjunto de ferramentas √∫teis para facilitar manipula√ß√£o de fatores. Como dito Cap√≠tulo 4, usamos fatores geralmente quando temos dados categ√≥ricos, que s√£o vari√°veis que possuem um conjunto de valores fixos e conhecidos. fun√ß√µes s√£o utilizadas principalmente para: ) mudar ordem dos n√≠veis, ii) mudar os valores dos n√≠veis, iii) adicionar e remover n√≠veis, iv) combinar m√∫ltiplos n√≠veis, al√©m de outras opera√ß√µes.Todas fun√ß√µes deste pacote s√£o listadas na p√°gina de refer√™ncia pacote.Vamos utilizar ainda os dados penguins e penguins_raw para exemplificar o uso pacote forcats.Primeiramente, vamos converter dados de string para fator, utilizando fun√ß√£o forcats::as_factor().Podemos facilmente mudar o nome dos n√≠veis utilizando fun√ß√£o forcats::fct_recode().Para inverter os n√≠veis, usamos fun√ß√£o forcats::fct_rev().Uma opera√ß√£o muito comum com fatores √© mudar ordem dos n√≠veis. Quando precisamos especificar ordem dos n√≠veis, podemos fazer essa opera√ß√£o manualmente com fun√ß√£o forcats::fct_relevel().Como vimos, reordena√ß√£o dos n√≠veis pode ser feita manualmente. Mas existem outras formas autom√°ticas de reordena√ß√£o seguindo algumas regras, para quais existem fun√ß√µes espec√≠ficas.forcats::fct_inorder(): pela ordem em que aparecem pela primeira vezforcats::fct_infreq(): por n√∫mero de observa√ß√µes com cada n√≠vel (decrescente, .e., o maior primeiro)forcats::fct_inseq(): pelo valor num√©rico n√≠velPor fim, podemos fazer agrega√ß√£o de n√≠veis raros em um n√≠vel utilizando fun√ß√£o forcats::fct_lump().Podemos ainda utilizar essas fun√ß√µes em complemento com o pacote dplyr para fazer manipula√ß√µes de fatores nas colunas de tibbles.Para se aprofundar tema, recomendamos leitura Cap√≠tulo 15 Factors de Wickham & Grolemund (2017).","code":"\n## Carregar o pacote palmerpenguins\nlibrary(palmerpenguins)\n## String\nforcats::as_factor(penguins_raw$Species) %>% head()\n#> [1] Adelie Penguin (Pygoscelis adeliae) Adelie Penguin (Pygoscelis adeliae) Adelie Penguin (Pygoscelis adeliae)\n#> [4] Adelie Penguin (Pygoscelis adeliae) Adelie Penguin (Pygoscelis adeliae) Adelie Penguin (Pygoscelis adeliae)\n#> 3 Levels: Adelie Penguin (Pygoscelis adeliae) ... Chinstrap penguin (Pygoscelis antarctica)\n## Mudar o nome dos n√≠veis\nforcats::fct_recode(penguins$species, a = \"Adelie\", c = \"Chinstrap\", g = \"Gentoo\") %>% head()\n#> [1] a a a a a a\n#> Levels: a c g\n## Inverter os n√≠veis\nforcats::fct_rev(penguins$species) %>% head()\n#> [1] Adelie Adelie Adelie Adelie Adelie Adelie\n#> Levels: Gentoo Chinstrap Adelie\n## Especificar a ordem dos n√≠veis\nforcats::fct_relevel(penguins$species, \"Chinstrap\", \"Gentoo\", \"Adelie\") %>% head()\n#> [1] Adelie Adelie Adelie Adelie Adelie Adelie\n#> Levels: Chinstrap Gentoo Adelie\n## N√≠veis pela ordem em que aparecem\nforcats::fct_inorder(penguins$species) %>% head()\n#> [1] Adelie Adelie Adelie Adelie Adelie Adelie\n#> Levels: Adelie Gentoo Chinstrap\n\n## Ordem (decrescente) de frequ√™ncia\nforcats::fct_infreq(penguins$species) %>% head()\n#> [1] Adelie Adelie Adelie Adelie Adelie Adelie\n#> Levels: Adelie Gentoo Chinstrap\n## Agrega√ß√£o de n√≠veis raros em um n√≠vel\nforcats::fct_lump(penguins$species) %>% head()\n#> [1] Adelie Adelie Adelie Adelie Adelie Adelie\n#> Levels: Adelie Gentoo Other\n## Transformar v√°rias colunas em fator\npenguins_raw_multi_factor <- penguins_raw %>% \n    dplyr::mutate(across(where(is.character), forcats::as_factor))"},{"path":"cap5.html","id":"lubridate","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.11 lubridate","text":"O pacote lubridate fornece um conjunto de fun√ß√µes para manipula√ß√£o de dados de data e hor√°rio. Dessa forma, esse pacote facilita manipula√ß√£o dessa classe de dado R, pois geralmente esses dados n√£o s√£o intuitivos e mudam dependendo tipo de objeto de data e hor√°rio. Al√©m disso, os m√©todos que usam datas e hor√°rios devem levar em considera√ß√£o fusos hor√°rios, anos bissextos, hor√°rios de ver√£o, al√©m de outras particularidades. Existem diversas fun√ß√µes nesse pacote, sendo mesmas focadas em: ) transforma√ß√µes de data/hor√°rio, ii) componentes, iii) arredondamentos, iv) dura√ß√µes, v) per√≠odos, vi) intervalos, al√©m de muitas outras fun√ß√µes espec√≠ficas.Todas fun√ß√µes deste pacote s√£o listadas na p√°gina de refer√™ncia pacote.Apesar de estar inserido escopo tidyverse, este pacote n√£o √© carregado com os demais, requisitando seu carregamento solo.Existem tr√™s tipos de dados data/hor√°rio:Data: tempo em dias, meses e anos <date>Hor√°rio: tempo dentro de um dia <time>Data-hor√°rio: tempo em um instante (data mais tempo) <dttm>Para trabalhar exclusivamente com hor√°rios, podemos utilizar o pacote hms.√â fundamental tamb√©m destacar que algumas letras ter√£o um significado temporal, sendo abrevia√ß√µes de diferentes per√≠odos em ingl√™s: year (ano), month (m√™s), weak (semana), day (dia), hour (hora), minute (minuto), e second (segundo).Para acessar informa√ß√£o da data e hor√°rios atuais podemos utilizar fun√ß√µes lubridate::today() e lubridate::now().Al√©m dessas informa√ß√µes instant√¢neas, existem tr√™s maneiras de criar um dado de data/hor√°rio.De um stringDe componentes individuais de data e hor√°rioDe um objeto de data/hor√°rio existenteOs dados de data/hor√°rio geralmente est√£o formato de strings. Podemos transformar os dados especificando ordem dos seus componentes, ou seja, ordem em que ano, m√™s e dia aparecem string, usando letras y (ano), m (m√™s) e d (dia) na mesma ordem, por exemplo, lubridate::dmy().Essas fun√ß√µes tamb√©m aceitam n√∫meros sem aspas, al√©m de serem muito vers√°teis e funcionarem em outros diversos formatos.Al√©m da data, podemos especificar hor√°rios atrelados essas datas. Para criar uma data com hor√°rio adicionamos um underscore (_) e h (hora), m (minuto) e s (segundo) ao nome da fun√ß√£o, al√©m argumento tz para especificar o fuso hor√°rio (tema tratado mais adiante nessa se√ß√£o).Podemos ainda ter componentes individuais de data/hor√°rio em m√∫ltiplas colunas. Para realizar essa transforma√ß√£o, podemos usar fun√ß√µes lubridate::make_date() e lubridate::make_datetime().Por fim, podemo criar datas modificando entre data/hor√°rio e data, utilizando fun√ß√µes lubridate::as_datetime() e lubridate::as_date().Uma vez que entendemos como podemos criar dados de data/hor√°rio, podemos explorar fun√ß√µes para acessar e definir componentes individuais. Para essa tarefa existe uma grande quantidade de fun√ß√µes para acessar de partes espec√≠ficas de datas e hor√°rios.year(): acessa o anomonth(): acessa o m√™smonth(): acessa o diayday(): acessa o dia anomday(): acessa o dia m√™swday(): acessa o dia da semanahour(): acessa horasminute(): acessa os minutossecond(): acessa os segundosAl√©m de acessar componentes de datas e hor√°rios, podemos usar essas fun√ß√µes para fazer inclus√£o de informa√ß√µes de datas e hor√°rios.Mais convenientemente, podemos utilizar fun√ß√£o update() para alterar v√°rios valores de uma vez.Muitas vezes precisamos fazer opera√ß√µes com datas, como aritm√©tica: adi√ß√£o, subtra√ß√£o, multiplica√ß√£o e divis√£o. Para tanto, √© preciso entender tr√™s classes importantes que representam intervalos de tempo.Dura√ß√µes: representam um n√∫mero exato de segundosPer√≠odos: representam unidades humanas como semanas e mesesIntervalos: representam um ponto inicial e finalQuando fazemos uma subtra√ß√£o de datas, criamos um objeto da classe difftime. Essa classe pode ser um pouco complicada de trabalhar, ent√£o dentro lubridate usamos fun√ß√µes que convertem essa classe em dura√ß√£o, da classe Duration. dura√ß√µes sempre registram o intervalo de tempo em segundos, com alguma unidade de tempo maior entre par√™nteses. H√° uma s√©rie de fun√ß√µes para tratar dessa classe.duration(): cria data em dura√ß√£oas.duration(): converte datas em dura√ß√£odyears(): dura√ß√£o de anosdmonths(): dura√ß√£o de mesesdweeks(): dura√ß√£o de semanasddays(): dura√ß√£o de diasdhours(): dura√ß√£o de horasdminutes(): dura√ß√£o de minutosdseconds(): dura√ß√£o de segundosPodemos ainda utilizar dura√ß√µes para fazer opera√ß√µes aritm√©ticas com datas como adi√ß√£o, subtra√ß√£o e multiplica√ß√£o.Al√©m das dura√ß√µes, podemos usar per√≠odos, que s√£o extens√µes de tempo n√£o fixados em segundos como dura√ß√µes, mas flex√≠veis, com o tempo em dias, semanas, meses ou anos, permitindo uma interpreta√ß√£o mais intuitiva das datas. Novamente, h√° uma s√©rie de fun√ß√µes para realizar essas opera√ß√µes.period(): cria data em per√≠odoas.period(): converte datas em per√≠odoseconds(): per√≠odo em segundosminutes(): per√≠odo em minutoshours(): per√≠odo em horasdays(): per√≠odo em diasweeks(): per√≠odo em semanasmonths(): per√≠odo em mesesyears(): per√≠odo em anosAl√©m disso, podemos fazer opera√ß√µes com os per√≠odos, somando e subtraindo.Por fim, intervalos s√£o per√≠odos de tempo limitados por duas datas, possuindo uma dura√ß√£o com um ponto de partida, que o faz preciso para determinar uma dura√ß√£o. Intervalos s√£o objetos da classe Interval. Da mesma forma que para dura√ß√£o e per√≠odos, h√° uma s√©rie de fun√ß√µes para realizar essas opera√ß√µes.interval(): cria data em intervalo%--%: cria data em intervaloas.interval(): converte datas em intervaloint_start(): acessa ou atribui data inicial de um intervaloint_end(): acessa ou atribui data final de um intervaloint_length(): comprimento de um intervalo em segundosint_flip(): inverte ordem da data de in√≠cio e da data de t√©rmino em um intervaloint_shift(): desloca datas de in√≠cio e t√©rmino de um intervaloint_aligns(): testa se dois intervalos compartilham um ponto finalint_standardize(): garante que todos os intervalos sejam positivosint_diff(): retorna os intervalos que ocorrem entre os elementos de data/hor√°rioint_overlaps(): testa se dois intervalos se sobrep√µem%within%: testa se o primeiro intervalo est√° contido segundoUma opera√ß√£o de destaque √© verificar sobreposi√ß√£o entre dois intervalos.Podemos ainda calcular quantos per√≠odos existem dentro de um intervalo, utilizando opera√ß√µes de / e %/%.Ainda podemos fazer transforma√ß√µes dos dados para per√≠odos e ter todas unidades de data e tempo que o intervalo compreende.Por fim, fusos hor√°rios tendem ser um fator complicador quando precisamos analisar informa√ß√µes instant√¢neas de tempo (hor√°rio) de outras partes planeta, ou mesmo fazer convers√µes dos hor√°rios. lubridate h√° fun√ß√µes para ajudar nesse sentido. Para isso, podemos utilizar fun√ß√£o lubridate::with_tz() e argumento tzone informar o fuso hor√°rio para transforma√ß√£o hor√°rio.Podemos descobrir o fuso hor√°rio que o R est√° considerando com fun√ß√£o Sys.timezone().R h√° uma listagem dos nomes dos fusos hor√°rios que podemos utilizar argumento tzone para diferentes fusos hor√°rios.Podemos nos perguntar que horas s√£o em outra parte globo ou fazer convers√µes facilmente lubridate.Para se aprofundar tema, recomendamos leitura Cap√≠tulo 16 Dates times de Wickham & Grolemund (2017).","code":"\n## Carregar\nlibrary(lubridate)\n## Extrair a data nesse instante\nlubridate::today()\n#> [1] \"2022-02-17\"\n\n## Extrair a data e tempo nesse instante\nlubridate::now()\n#> [1] \"2022-02-17 23:38:34 -03\"\n## Strings e n√∫meros para datas\nlubridate::dmy(\"03-03-2021\")\n#> [1] \"2021-03-03\"\n## Strings e n√∫meros para datas\nlubridate::dmy(\"03-Mar-2021\")\nlubridate::dmy(03032021)\nlubridate::dmy(\"03032021\")\nlubridate::dmy(\"03/03/2021\")\nlubridate::dmy(\"03.03.2021\")\n## Especificar hor√°rios e fuso hor√°rio\nlubridate::dmy_h(\"03-03-2021 13\")\n#> [1] \"2021-03-03 13:00:00 UTC\"\nlubridate::dmy_hm(\"03-03-2021 13:32\")\n#> [1] \"2021-03-03 13:32:00 UTC\"\nlubridate::dmy_hms(\"03-03-2021 13:32:01\")\n#> [1] \"2021-03-03 13:32:01 UTC\"\nlubridate::dmy_hms(\"03-03-2021 13:32:01\", tz = \"America/Sao_Paulo\")\n#> [1] \"2021-03-03 13:32:01 -03\"\n## Dados com componentes individuais\ndados <- tibble::tibble(\n    ano = c(2021, 2021, 2021),\n    mes = c(1, 2, 3),\n    dia = c(12, 20, 31),\n    hora = c(2, 14, 18), \n    minuto = c(2, 44, 55))\n\n## Data de componentes individuais\ndados %>% \n    dplyr::mutate(data = lubridate::make_datetime(ano, mes, dia, hora, minuto))\n#> # A tibble: 3 √ó 6\n#>     ano   mes   dia  hora minuto data               \n#>   <dbl> <dbl> <dbl> <dbl>  <dbl> <dttm>             \n#> 1  2021     1    12     2      2 2021-01-12 02:02:00\n#> 2  2021     2    20    14     44 2021-02-20 14:44:00\n#> 3  2021     3    31    18     55 2021-03-31 18:55:00\n## Data para data-hor√°rio\nlubridate::as_datetime(today())\n#> [1] \"2022-02-17 UTC\"\n\n## Data-hor√°rio para data\nlubridate::as_date(now())\n#> [1] \"2022-02-17\"\n## Extrair\nlubridate::year(now())\n#> [1] 2022\nlubridate::month(now())\n#> [1] 2\nlubridate::month(now(), label = TRUE)\n#> [1] Feb\n#> Levels: Jan < Feb < Mar < Apr < May < Jun < Jul < Aug < Sep < Oct < Nov < Dec\nlubridate::day(now())\n#> [1] 17\nlubridate::wday(now())\n#> [1] 5\nlubridate::wday(now(), label = TRUE)\n#> [1] Thu\n#> Levels: Sun < Mon < Tue < Wed < Thu < Fri < Sat\nlubridate::second(now())\n#> [1] 34.79854\n## Data\ndata <- dmy_hms(\"04-03-2021 01:04:56\")\n\n## Incluir\nlubridate::year(data) <- 2020\nlubridate::month(data) <- 01\nlubridate::hour(data) <- 13\n## Incluir v√°rios valores\nupdate(data, year = 2020, month = 1, mday = 1, hour = 1)\n#> [1] \"2020-01-01 01:04:56 UTC\"\n## Subtra√ß√£o de datas\ntempo_estudando_r <- lubridate::today() - lubridate::dmy(\"30-11-2011\")\n\n## Convers√£o para dura√ß√£o\ntempo_estudando_r_dur <- lubridate::as.duration(tempo_estudando_r)\n\n## Criando dura√ß√µes\nlubridate::duration(90, \"seconds\")\n#> [1] \"90s (~1.5 minutes)\"\nlubridate::duration(1.5, \"minutes\")\n#> [1] \"90s (~1.5 minutes)\"\nlubridate::duration(1, \"days\")\n#> [1] \"86400s (~1 days)\"\n\n## Transforma√ß√£o da dura√ß√£o\nlubridate::dseconds(100)\n#> [1] \"100s (~1.67 minutes)\"\nlubridate::dminutes(100)\n#> [1] \"6000s (~1.67 hours)\"\nlubridate::dhours(100)\n#> [1] \"360000s (~4.17 days)\"\nlubridate::ddays(100)\n#> [1] \"8640000s (~14.29 weeks)\"\nlubridate::dweeks(100)\n#> [1] \"60480000s (~1.92 years)\"\nlubridate::dyears(100)\n#> [1] \"3155760000s (~100 years)\"\n## Somando dura√ß√µes a datas\nlubridate::today() + lubridate::ddays(1)\n#> [1] \"2022-02-18\"\n\n## Subtraindo dura√ß√µes de datas\nlubridate::today() - lubridate::dyears(1)\n#> [1] \"2021-02-16 18:00:00 UTC\"\n\n## Multiplicando dura√ß√µes\n2 * dyears(2)\n#> [1] \"126230400s (~4 years)\"\n## Criando per√≠odos\nperiod(c(90, 5), c(\"second\", \"minute\"))\n#> [1] \"5M 90S\"\nperiod(c(3, 1, 2, 13, 1), c(\"second\", \"minute\", \"hour\", \"day\", \"week\"))\n#> [1] \"20d 2H 1M 3S\"\n\n## Transforma√ß√£o de per√≠odos\nlubridate::seconds(100)\n#> [1] \"100S\"\nlubridate::minutes(100)\n#> [1] \"100M 0S\"\nlubridate::hours(100)\n#> [1] \"100H 0M 0S\"\nlubridate::days(100)\n#> [1] \"100d 0H 0M 0S\"\nlubridate::weeks(100)\n#> [1] \"700d 0H 0M 0S\"\nlubridate::years(100)\n#> [1] \"100y 0m 0d 0H 0M 0S\"\n## Somando datas\nlubridate::today() + lubridate::weeks(10)\n#> [1] \"2022-04-28\"\n\n## Subtraindo datas\nlubridate::today() - lubridate::weeks(10)\n#> [1] \"2021-12-09\"\n\n## Criando datas recorrentes\nlubridate::today() + lubridate::weeks(0:10)\n#>  [1] \"2022-02-17\" \"2022-02-24\" \"2022-03-03\" \"2022-03-10\" \"2022-03-17\" \"2022-03-24\" \"2022-03-31\" \"2022-04-07\" \"2022-04-14\"\n#> [10] \"2022-04-21\" \"2022-04-28\"\n## Criando duas datas - in√≠cio de estudos do R e nascimento do meu filho\nr_inicio <- lubridate::dmy(\"30-11-2011\")\nfilho_nascimento <- lubridate::dmy(\"26-09-2013\")\nr_hoje <- lubridate::today()\n\n## Criando intervalos - interval\nr_intervalo <- lubridate::interval(r_inicio, r_hoje)\n\n## Criando intervalos - interval %--%\nfilho_intervalo <- filho_nascimento %--% lubridate::today()\n\n## Opera√ß√µes com intervalos\nlubridate::int_start(r_intervalo)\n#> [1] \"2011-11-30 UTC\"\nlubridate::int_end(r_intervalo)\n#> [1] \"2022-02-17 UTC\"\nlubridate::int_length(r_intervalo)\n#> [1] 322444800\nlubridate::int_flip(r_intervalo)\n#> [1] 2022-02-17 UTC--2011-11-30 UTC\nlubridate::int_shift(r_intervalo, duration(days = 30))\n#> [1] 2011-12-30 UTC--2022-03-19 UTC\n## Verificar sobreposi√ß√£o - int_overlaps\nlubridate::int_overlaps(r_intervalo, filho_intervalo)\n#> [1] TRUE\n\n## Verificar se intervalo est√° contido\nr_intervalo %within% filho_intervalo\n#> [1] FALSE\nfilho_intervalo %within% r_intervalo\n#> [1] TRUE\n## Per√≠odos dentro de um intervalo - anos\nr_intervalo / lubridate::years()\n#> [1] 10.21644\nr_intervalo %/% lubridate::years()\n#> [1] 10\n\n## Per√≠odos dentro de um intervalo - dias e semandas\nfilho_intervalo / lubridate::days()\n#> [1] 3066\nfilho_intervalo / lubridate::weeks()\n#> [1] 438\n## Tempo total estudando R\nlubridate::as.period(r_intervalo)\n#> [1] \"10y 2m 18d 0H 0M 0S\"\n\n## Idade do meu filho\nlubridate::as.period(filho_intervalo)\n#> [1] \"8y 4m 22d 0H 0M 0S\"\n## Fuso hor√°rio no R\nSys.timezone()\n#> [1] \"America/Sao_Paulo\"\n## Verificar os fuso hor√°rios\nlength(OlsonNames())\n#> [1] 595\nhead(OlsonNames())\n#> [1] \"Africa/Abidjan\"     \"Africa/Accra\"       \"Africa/Addis_Ababa\" \"Africa/Algiers\"     \"Africa/Asmara\"     \n#> [6] \"Africa/Asmera\"\n## Que horas s√£o em...\nlubridate::with_tz(lubridate::now(), tzone = \"America/Sao_Paulo\")\n#> [1] \"2022-02-17 23:38:35 -03\"\nlubridate::with_tz(lubridate::now(), tzone = \"GMT\")\n#> [1] \"2022-02-18 02:38:35 GMT\"\nlubridate::with_tz(lubridate::now(), tzone = \"Europe/Berlin\")\n#> [1] \"2022-02-18 03:38:35 CET\"\n\n## Altera o fuso sem mudar a hora\nlubridate::force_tz(lubridate::now(), tzone = \"GMT\")\n#> [1] \"2022-02-17 23:38:35 GMT\""},{"path":"cap5.html","id":"purrr","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.12 purrr","text":"O pacote purrr implementa Programa√ß√£o Funcional R, fornecendo um conjunto completo e consistente de ferramentas para trabalhar com fun√ß√µes e vetores. programa√ß√£o funcional √© um assunto bastante extenso, sendo mais conhecido R pela fam√≠lia de fun√ß√µes purrr::map(), que permite substituir muitos loops por um c√≥digo mais sucinto e f√°cil de ler. N√£o focaremos aqui nas outras fun√ß√µes, pois esse √© um assunto extremamente extenso.Todas fun√ß√µes deste pacote s√£o listadas na p√°gina de refer√™ncia pacote.Um loop pode ser entendido como uma itera√ß√£o: um bloco de c√≥digos √© repetido mudando um contador de uma lista de possibilidades. Vamos exemplificar com uma itera√ß√£o bem simples, onde imprimiremos console os valores de 1 10, utilizando fun√ß√£o (), um contador em um vetor de dez n√∫meros 1:10 que ser√° iterado, bloco de c√≥digos definido entre {}, usando fun√ß√£o print() para imprimir os valores.ideia √© bastante simples: fun√ß√£o () vai atribuir o primeiro valor da lista ao contador , esse contador ser√° utilizado em todo o bloco de c√≥digos. Quando o bloco terminar, o segundo valor √© atribu√≠do ao contador e entra bloco de c√≥digos, repetindo esse processo at√© que todos os elementos da lista tenham sido atribu√≠dos ao contador.Com essa ideia em mente, programa√ß√£o funcional faz mesma opera√ß√£o utilizando fun√ß√£o purrr::map(). O mesmo loop ficaria dessa forma.Nessa estrutura, temos:map(.x, .f).x: um vetor, lista ou data frame.f: uma fun√ß√£oNum outro exemplo, aplicaremos fun√ß√£o sum() para somar os valores de v√°rios elementos de uma lista.H√° diferente tipos de retornos da fam√≠lia purrr::map().map(): retorna uma listamap_chr(): retorna um vetor de stringsmap_dbl(): retorna um vetor num√©rico (double)map_int(): retorna um vetor num√©rico (integer)map_lgl(): retorna um vetor l√≥gicomap_dfr(): retorna um data frame (por linhas)map_dfc(): retorna um data frame (por colunas)Essas funcionalidades j√° eram conhecidas Base R pelas fun√ß√µes da fam√≠lia apply(): apply(), lapply(), sapply(), vapply(), mapply(), rapply() e tapply(). Essas fun√ß√µes formam base de combina√ß√µes mais complexas e ajudam realizar opera√ß√µes com poucas linhas de c√≥digo, para diferentes retornos.Temos ainda duas variantes da fun√ß√£o map(): purrr::map2() e purrr::pmap(), para duas ou mais listas, respectivamente. Como vimos para primeira fun√ß√£o, existem v√°rias varia√ß√µes sufixo para modificar o retorno da fun√ß√£o.Essas fun√ß√µes podem ser usadas em conjunto para implementar rotinas de manipula√ß√£o e an√°lise de dados com poucas linhas de c√≥digo, mas que n√£o exploraremos em sua completude aqui. Listamos dois exemplos simples.Para se aprofundar tema, recomendamos leitura Cap√≠tulo 21 Iteration de Wickham & Grolemund (2017).","code":"\n## Loop for\nfor(i in 1:10){\n    print(i)\n}\n#> [1] 1\n#> [1] 2\n#> [1] 3\n#> [1] 4\n#> [1] 5\n#> [1] 6\n#> [1] 7\n#> [1] 8\n#> [1] 9\n#> [1] 10\n## Loop for com map\npurrr::map(.x = 1:10, .f = print)\n#> [1] 1\n#> [1] 2\n#> [1] 3\n#> [1] 4\n#> [1] 5\n#> [1] 6\n#> [1] 7\n#> [1] 8\n#> [1] 9\n#> [1] 10\n#> [[1]]\n#> [1] 1\n#> \n#> [[2]]\n#> [1] 2\n#> \n#> [[3]]\n#> [1] 3\n#> \n#> [[4]]\n#> [1] 4\n#> \n#> [[5]]\n#> [1] 5\n#> \n#> [[6]]\n#> [1] 6\n#> \n#> [[7]]\n#> [1] 7\n#> \n#> [[8]]\n#> [1] 8\n#> \n#> [[9]]\n#> [1] 9\n#> \n#> [[10]]\n#> [1] 10\n## Fun√ß√£o map\nx <- list(1:5, c(4, 5, 7), c(1, 1, 1), c(2, 2, 2, 2, 2))\npurrr::map(x, sum)\n#> [[1]]\n#> [1] 15\n#> \n#> [[2]]\n#> [1] 16\n#> \n#> [[3]]\n#> [1] 3\n#> \n#> [[4]]\n#> [1] 10\n## Varia√ß√µes da fun√ß√£o map\npurrr::map_dbl(x, sum)\n#> [1] 15 16  3 10\npurrr::map_chr(x, paste, collapse = \" \")\n#> [1] \"1 2 3 4 5\" \"4 5 7\"     \"1 1 1\"     \"2 2 2 2 2\"\n## Listas\nx <- list(3, 5, 0, 1)\ny <- list(3, 5, 0, 1)\nz <- list(3, 5, 0, 1)\n\n## Fun√ß√£o map2\npurrr::map2_dbl(x, y, prod)\n#> [1]  9 25  0  1\n\n## Fun√ß√£o pmap\npurrr::pmap_dbl(list(x, y, z), prod)\n#> [1]  27 125   0   1\n## Resumo dos dados\npenguins %>% \n    dplyr::select(where(is.numeric)) %>% \n    tidyr::drop_na() %>% \n    purrr::map_dbl(mean)\n#>    bill_length_mm     bill_depth_mm flipper_length_mm       body_mass_g              year \n#>          43.92193          17.15117         200.91520        4201.75439        2008.02924\n## An√°lise dos dados\npenguins %>%\n    dplyr::group_split(island, species) %>% \n    purrr::map(~ lm(bill_depth_mm ~ bill_length_mm, data = .x)) %>% \n    purrr::map(summary) %>% \n    purrr::map(\"r.squared\")\n#> [[1]]\n#> [1] 0.2192052\n#> \n#> [[2]]\n#> [1] 0.4139429\n#> \n#> [[3]]\n#> [1] 0.2579242\n#> \n#> [[4]]\n#> [1] 0.4271096\n#> \n#> [[5]]\n#> [1] 0.06198376"},{"path":"cap5.html","id":"para-se-aprofundar-1","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.13 Para se aprofundar","text":"Listamos seguir livros que recomendamos para seguir com sua aprendizagem em R e tidyverse.","code":""},{"path":"cap5.html","id":"livros-1","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.13.1 Livros","text":"Recomendamos aos interessados os livros: ) Oliveira e colaboradores (2018) Ci√™ncia de dados com R, ii) Grolemund (2018) Essentials Data Science: Knowledge Discovery Using R,iii) Holmes e Huber (2019) Modern Statistics Modern Biology, iv) Ismay e Kim (2020) Statistical Inference via Data Science: ModernDive R Tidyverse, v) Wickham e Grolemund (2017) R Data Science: Import, Tidy, Transform, Visualize, Model Data, vi) Zumel e Mount (2014) Practical Data Science R Paperback, vii) Irizarry (2017) Introduction Data Science: Data Analysis Prediction Algorithms R, e viii) Irizarry (2019) Introduction Data Science.","code":""},{"path":"cap5.html","id":"links-1","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.13.2 Links","text":"Ci√™ncia de Dados em RtidyverseSTHDA - Statistical tools high-throughput data analysisEstat√≠stica √© com R! - tidyverseTidyverse Skills Data Science R","code":""},{"path":"cap5.html","id":"links-2","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.13.3 Links","text":"Para acesso na internet, indicamos os seguintes tutoriais:[Getting Started Tidyverse] (https://www.datacamp.com/community/tutorials/tidyverse-tutorial-r)Tidyverse BasicsManipulando Dados com dplyr e tidyr","code":""},{"path":"cap5.html","id":"exerc√≠cios-1","chapter":"Cap√≠tulo 5 Tidyverse","heading":"5.14 Exerc√≠cios","text":"5.1\nReescreva opera√ß√µes abaixo utilizando pipes %>%.log10(cumsum(1:100))sum(sqrt(abs(rnorm(100))))sum(sort(sample(1:10, 10000, rep = TRUE)))5.2\nUse fun√ß√£o download.file() e unzip() para baixar e extrair o arquivo data paper de m√©dios e grandes mam√≠feros: ATLANTIC MAMMALS. Em seguida, importe para o R, usando fun√ß√£o readr::read_csv().5.3\nUse fun√ß√£o tibble::glimpse() para ter uma no√ß√£o geral dos dados importados item anterior.5.4\nCompare os dados de penguins (palmerpenguins::penguins_raw e palmerpenguins::penguins). Monte uma s√©rie de fun√ß√µes dos pacotes tidyr e dplyr para limpar os dados e fazer com que o primeiro dado seja igual ao segundo.5.5\nUsando os dados de penguins (palmerpenguins::penguins), calcule correla√ß√£o de Pearson entre comprimento e profundidade bico para cada esp√©cie e para todas esp√©cies. Compare os √≠ndices de correla√ß√£o para exemplificar o Paradoxo de Simpson.5.6\nOficialmente pandemia de COVID-19 come√ßou Brasil com o primeiro caso dia 26 de fevereiro de 2020. Calcule quantos anos, meses e dias se passou desde ent√£o. Calcule tamb√©m quanto tempo se passou at√© voc√™ ser vacinado.Solu√ß√µes dos exerc√≠cios.","code":""},{"path":"cap6.html","id":"cap6","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"Cap√≠tulo 6 Visualiza√ß√£o de dados","text":"","code":""},{"path":"cap6.html","id":"pr√©-requisitos-do-cap√≠tulo-2","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"Pr√©-requisitos do cap√≠tulo","text":"Pacotes que ser√£o utilizados nesse cap√≠tulo.","code":"\n## Pacotes\nlibrary(tidyverse)\nlibrary(palmerpenguins)\nlibrary(datasauRus)\nlibrary(gridExtra)\n\n## Dados\npenguins <- palmerpenguins::penguins\n\n## Edi√ß√£o dos nomes das colunas para portugu√™s \nnames(penguins)\n#> [1] \"species\"           \"island\"            \"bill_length_mm\"    \"bill_depth_mm\"     \"flipper_length_mm\" \"body_mass_g\"      \n#> [7] \"sex\"               \"year\"\ncolnames(penguins) <- c(\"especies\", \"ilha\", \"comprimento_bico\", \"profundidade_bico\", \"comprimento_nadadeira\", \"massa_corporal\", \"sexo\", \"ano\")"},{"path":"cap6.html","id":"contextualiza√ß√£o-2","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.1 Contextualiza√ß√£o","text":"visualiza√ß√£o de dados atrav√©s de gr√°ficos frequentemente √© melhor forma de apresentar e interpretar informa√ß√µes contidas em seus estudos, fazendo uma s√≠ntese para melhor entendimento de padr√µes. Geralmente, os gr√°ficos s√£o necess√°rios em quase todas an√°lises estat√≠sticas, al√©m de enriquecer argumenta√ß√£o e discuss√£o de hip√≥teses levantadas para publica√ß√µes, trabalhos de consultoria, TCCs, disserta√ß√µes, teses, entre outros.Existem v√°rios tipos de gr√°ficos para representar os padr√µes em seus dados para diferentes finalidades. Esses diferentes tipos de gr√°ficos podem at√© mesmo ser usados para representar o mesmo tipo de dado. Nesta se√ß√£o, focaremos nos gr√°ficos mais simples para representar uma ou duas vari√°veis (.e., gr√°ficos bidimensionais). Dependendo tipo de vari√°vel (categ√≥rica ou cont√≠nua ‚Äì veja os tipos de vari√°veis na Figura 2.2 Cap√≠tulo 2), os gr√°ficos mais indicados para representar os dados mudam. De forma simplificada, os gr√°ficos s√£o representa√ß√µes dos nossos dados tabulares, de modo que os eixos representam colunas e fei√ß√µes (pontos, linhas, barras, caixas, etc.) representam linhas.Comumente nos gr√°ficos s√£o representados uma ou duas colunas, quando muito tr√™s, em gr√°ficos de tr√™s dimens√µes. Para mais colunas, partimos para dados agregados que podem ser vistos Cap√≠tulo 9 de an√°lises multivariadas. Al√©m disso, utiliza√ß√£o de mais de duas colunas pode estar relacionado com outras partes est√©ticas (e.g.¬†aes() pacote ggplot2) gr√°fico como cor, forma ou tamanho de pontos, linhas ou outras fei√ß√µes.Dessa forma, dedicamos esse cap√≠tulo inteiramente apresentar os principais conceitos, como gram√°tica de gr√°ficos, e uma apresenta√ß√£o geral que pode funcionar como ‚Äúum guia de bolso‚Äù de gr√°ficos, uma vez que apresentamos os principais tipos de gr√°ficos para an√°lises ecol√≥gicas e estat√≠sticas. Al√©m disso, √∫ltimo t√≥pico focamos na finaliza√ß√£o (ajustes finos) de gr√°ficos para publica√ß√µes. Este cap√≠tulo fornece base conceitual necess√°ria para entender visualiza√ß√£o gr√°fica de dados apresentada ao longo livro.Existe uma ampla gama de pacotes para fazer gr√°ficos R, sendo esse um ponto muito forte dessa linguagem. Al√©m disso, essa grande disponibilidade de pacotes e fun√ß√µes permitem visualiza√ß√£o dos mais diferentes tipos de dados, o que torna linguagem R detentora de alta praticidade, uma vez que maior parte dos pacotes possui uma sintaxe relativamente simples para apresenta√ß√£o de gr√°ficos excelentes e de √≥tima qualidade. Mais adiante Cap√≠tulo 15, ampliamos discuss√£o da visualiza√ß√£o gr√°fica com ferramentas para visualiza√ß√£o de dados geoespaciais R.Este cap√≠tulo foi organizado em quatro partes: ) principais pacotes, ii) gram√°tica dos gr√°ficos, iii) tipos de gr√°ficos (um guia de bolso para visualiza√ß√£o de v√°rios gr√°ficos R), e iv) edi√ß√£o de gr√°ficos com alta qualidade para publica√ß√£o. Apesar de apresentarmos diferentes pacotes com grande potencial para visualiza√ß√£o gr√°fica, focaremos neste cap√≠tulo pacote ggplot2, talvez o pacote mais comum e com maior gama de possibilidades de cria√ß√£o de excelentes gr√°ficos. üìù Importante \nNeste cap√≠tulo, vamos ensinar gradativamente os comandos para construir gr√°ficos e como editar suas diferentes camadas. Por este motivo, o leitor n√£o ver√° uma padroniza√ß√£o nos temas dos gr√°ficos (fonte, cor, fundo painel, etc.), uma vez que os gr√°ficos sem edi√ß√£o (padr√£o ggplot2) possuem temas pr√©-definidos. Desse modo, para fazer um gr√°fico com maior qualidade (chamamos aqui de vers√£o ‚Äúcom ajustes finos‚Äù) ser√° necess√°rio adicionar comandos extras que s√£o exatamente o foco deste cap√≠tulo. Em alguns comandos b√°sicos o leitor vai perceber que devido aos dados utilizados, os eixos v√£o possuir palavras em ingl√™s misturadas com palavras em portugu√™s. Optamos por n√£o traduzir esses nomes para preservar o padr√£o que ser√° visualizado nos primeiros comandos que cada leitor ir√° fazer em seu computador.Usaremos os dados dispon√≠veis pacote palmerpenguins para exemplificar fun√ß√µes ggplot2, descrito Cap√≠tulo 5.","code":""},{"path":"cap6.html","id":"principais-pacotes","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.2 Principais pacotes","text":"seguir, apresentamos uma listagem dos principais pacotes para visualiza√ß√£o de dados R, al√©m das principais fun√ß√µes desses pacotes.graphics: √© o pacote padr√£o (default) R para produzir gr√°fios simples, por√©m √∫til para visualiza√ß√µes r√°pidas de quase todos classes de objetos. Possui fun√ß√µes como: plot(), hist(), barplot(), boxplot(), abline(), points(), lines() e polygon(). Destacamos que fun√ß√£o plot() pode estar presente em diversos pacotesgraphics: √© o pacote padr√£o (default) R para produzir gr√°fios simples, por√©m √∫til para visualiza√ß√µes r√°pidas de quase todos classes de objetos. Possui fun√ß√µes como: plot(), hist(), barplot(), boxplot(), abline(), points(), lines() e polygon(). Destacamos que fun√ß√£o plot() pode estar presente em diversos pacotesggplot2: pacote integrado ao tidyverse (Cap√≠tulo 5), possui uma sintaxe pr√≥pria baseada na gram√°tica de gr√°ficos por camadas (layers), necessitando de fun√ß√µes espec√≠ficas para objetos de classes diferentes, demandando geralmente mais tempo para constru√ß√£o dos c√≥digos. Possui fun√ß√µes como ggplot(), aes(), geom_*(), facet_*(), stats_*(), coord_*() e theme_*(), que s√£o conectadas pelo operador +ggplot2: pacote integrado ao tidyverse (Cap√≠tulo 5), possui uma sintaxe pr√≥pria baseada na gram√°tica de gr√°ficos por camadas (layers), necessitando de fun√ß√µes espec√≠ficas para objetos de classes diferentes, demandando geralmente mais tempo para constru√ß√£o dos c√≥digos. Possui fun√ß√µes como ggplot(), aes(), geom_*(), facet_*(), stats_*(), coord_*() e theme_*(), que s√£o conectadas pelo operador +ggplot2 extentions: conjunto de pacotes que adicionam diversas expans√µes ao pacote ggplot2. Exemplos: gganimate, GGally, patchwork e esquisseggplot2 extentions: conjunto de pacotes que adicionam diversas expans√µes ao pacote ggplot2. Exemplos: gganimate, GGally, patchwork e esquissevisdat: cria visualiza√ß√µes preliminares de dados explorat√≥rios de um conjunto de dados inteiro para identificar problemas ou recursos inesperados usando ‚Äòggplot2.‚Äô Possui diversas fun√ß√µes espec√≠ficas: vis_dat() para vis√£o geral dos dados, vis_miss() para vis√£o de dados faltantes (NA) e vis_compare() para visualizar diferen√ßa entre dadosvisdat: cria visualiza√ß√µes preliminares de dados explorat√≥rios de um conjunto de dados inteiro para identificar problemas ou recursos inesperados usando ‚Äòggplot2.‚Äô Possui diversas fun√ß√µes espec√≠ficas: vis_dat() para vis√£o geral dos dados, vis_miss() para vis√£o de dados faltantes (NA) e vis_compare() para visualizar diferen√ßa entre dadosggpubr: pacote que fornece fun√ß√µes simplificadas para criar e personalizar gr√°ficos para publica√ß√£o, baseados ggplot2. Possui fun√ß√µes espec√≠ficas: gghistogram(), ggdensity(), ggboxplot(), ggviolin(), ggbarplot() e ggscatter()ggpubr: pacote que fornece fun√ß√µes simplificadas para criar e personalizar gr√°ficos para publica√ß√£o, baseados ggplot2. Possui fun√ß√µes espec√≠ficas: gghistogram(), ggdensity(), ggboxplot(), ggviolin(), ggbarplot() e ggscatter()lattice: pacote para visualiza√ß√£o de dados inspirado nos gr√°ficos treli√ßa (ingl√™s Trellis, geralmente para dados com muitas vari√°veis que geram uma matriz retangular de gr√°ficos). Tamb√©m possui fun√ß√µes espec√≠ficas: xyplot(), histogram(), densityplot(), barchart(), bwplot() e dotplot(). O pacote latticeExtra disponibiliza algumas possibilidade mais para esse pacotelattice: pacote para visualiza√ß√£o de dados inspirado nos gr√°ficos treli√ßa (ingl√™s Trellis, geralmente para dados com muitas vari√°veis que geram uma matriz retangular de gr√°ficos). Tamb√©m possui fun√ß√µes espec√≠ficas: xyplot(), histogram(), densityplot(), barchart(), bwplot() e dotplot(). O pacote latticeExtra disponibiliza algumas possibilidade mais para esse pacoteplotly: pacote para criar gr√°ficos interativos da web por meio da biblioteca gr√°fica de JavaScript de c√≥digo aberto plotly.js. Tamb√©m possui fun√ß√µes espec√≠ficas: plot_ly(), add_histogram(), add_bars(), add_boxplot(), add_markers(), add_paths(), add_lines() e add_polygons()plotly: pacote para criar gr√°ficos interativos da web por meio da biblioteca gr√°fica de JavaScript de c√≥digo aberto plotly.js. Tamb√©m possui fun√ß√µes espec√≠ficas: plot_ly(), add_histogram(), add_bars(), add_boxplot(), add_markers(), add_paths(), add_lines() e add_polygons()","code":""},{"path":"cap6.html","id":"gr√°matica-dos-gr√°ficos","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.3 Gr√°matica dos gr√°ficos","text":"O livro Grammar Graphics (Wilkinson Wills 2005) utiliza uma analogia da lingu√≠stica para criar uma ‚Äúgram√°tica‚Äù para visualiza√ß√£o gr√°fica. Segundo ele, l√≠ngua se torna expressiva pelo fato da gram√°tica criar um sistema de regras que tornam declara√ß√µes com significado conhecido. De maneira semelhante, ideia da gram√°tica dos gr√°ficos cria regras para representa√ß√£o gr√°fica dos dados partir de atributos est√©ticos (ingl√™s aesthetic) como cor, forma e tamanho que definem geometria dos objetos, como pontos, linhas e barras (Wickham 2016). Al√©m disso, esta gram√°tica reconhece que tais elementos podem ser organizados em camadas, tal como constru√≠mos um mapa com diferentes camadas como eleva√ß√£o, hidrografia, rodovias, limites pol√≠ticos, etc.Inspirado pela gram√°tica dos gr√°ficos proposta por Wilkinson & Wills (2005), Hadley Wickham cria o pacote ggplot2, onde ‚Äúgg‚Äù representa contra√ß√£o de Grammar Graphics (Wickham 2016). camadas nesta gram√°tica (layered-grammar) s√£o organizadas da seguinte forma:Camada 1 - dados ggplot(): s√£o informa√ß√µes formato data.frame que ser√£o usadas nas diferentes camadas nas fun√ß√µes aes(), geom_*(), stat_*(), facet_*() e scale_*()Camada 2 - mapeamento aes(): atributos est√©ticos, determina que colunas data.frame ser√£o usadas para representa√ß√µes geom√©tricas, assim como tamanho, forma, cor, preenchimento e transpar√™nciaCamada 3 - defini√ß√£o da geometria geom_*(): define o tipo de gr√°fico, como pontos, boxplots, violino, linhas, pol√≠gonos, entre outrosCamada 4 - transforma√ß√µes estat√≠sticas stat_*(): modificam, quando necess√°rio, os dados que ser√£o inclu√≠dos gr√°fico, al√©m de produzir estat√≠sticas como regress√µesCamada 5 - sistema de coordenadas coords_*(): descreve como coordenadas dos dados s√£o mapeadas para o plano gr√°ficoCamada 6 - facetas facets_*(): especifica como visualiza√ß√£o dos elementos aes() s√£o divididos em diferentes ‚Äújanelas gr√°ficas‚ÄùCamada 7 - escala scale_*(): permite o controle das caracter√≠sticas visuais (cor, forma e tamanho) dos elementos declarados em aes()Camada 8 - temas theme*(): controla apar√™ncia visual dos elementos gr√°fico, como fontes, cores e legendaEstruturalmente podemos observar estrutura da Figura 6.1.\nFigura 6.1: Esquema gr√°fico ilustrando camadas que definem strutura de organiza√ß√£o aditiva da gram√°tica dos gr√°ficos (ggplot2). exemplo, partir de uma banco de dados, o mapeamento de quais colunas representam o eixo Y e X e de um atributo gr√°fico (pontos) √© poss√≠vel construir um gr√°fico de dispers√£o que ilustra rela√ß√£o quantitativa entre vari√°vel Y e X.\nEm resumo, o mapeamento gr√°fico ggplot2 segue seguinte estrutura (Wickham Grolemund 2017):","code":"ggplot(data = <DATA>) + \n    <GEOM_FUNCTION>(\n        mapping = aes(<MAPPINGS>),\n        stat = <STAT>, \n        position = <POSITION>\n        ) +\n    <COORDINATE_FUNCTION> +\n    <FACET_FUNCTION> +\n    <SCALE_FUNCTION> +\n    <THEME_FUNCTION>"},{"path":"cap6.html","id":"tipos-de-gr√°ficos","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.4 Tipos de gr√°ficos","text":"Nesta se√ß√£o, listamos os principais tipos de gr√°ficos e fazemos uma descri√ß√£o de quantas colunas e o tipo de vari√°vel que eles representam.Histograma (histogram): distribui√ß√£o de frequ√™ncia de uma coluna para dados cont√≠nuos (cores diferentes podem representar esp√©cies, popula√ß√µes ou grupos distintos)Gr√°fico de densidade (density plot): distribui√ß√£o da densidade de uma coluna para dados cont√≠nuos (assim como histograma, cores diferentes podem ser utilizadas para representar esp√©cies, popula√ß√µes ou grupos distintos)Gr√°fico de dispers√£o (scatter plot) e gr√°fico de linha: rela√ß√£o entre valores de duas colunas para dados cont√≠nuos (X e Y)Diagrama de pontos (dot plot): distribui√ß√£o da quantidade de valores agrupados de uma coluna para dados cont√≠nuosGr√°fico de setores (pie chart e donut chart): representa√ß√£o da quantidade de valores de uma coluna para dados categ√≥ricos, geralmente em propor√ß√£o ou porcentagemGr√°fico de barras (bar plot): representa√ß√£o da quantidade de valores de uma ou mais colunas para dados categ√≥ricosGr√°fico de caixa (box plot e violin plot): distribui√ß√£o de valores cont√≠nuos de uma coluna (Y) para dois ou mais fatores categ√≥ricos de outra coluna (X) formato de caixas e tamb√©m formato de ‚Äúviolinos‚Äù (considerando varia√ß√£o e distribui√ß√£o)Gr√°fico pareado (pairs plot): rela√ß√£o entre valores de duas colunas para dados cont√≠nuos (X e Y), para colunas par parPara facilitar compreens√£o das regras da gram√°tica dos dados, cada tipo de gr√°fico segue mesma estrutura de organiza√ß√£o, que respeita camadas de informa√ß√£o descritas na se√ß√£o anterior. Podemos perceber, portanto, que algumas camadas n√£o s√£o necess√°rias dependendo tipo de gr√°fico ou conjunto de dados que pretendemos analisar.Nos exemplos seguir, vers√£o padr√£o se refere √† representa√ß√£o determinada default das fun√ß√µes pacote ggplot2. Desse modo, somente informamos vari√°veis que ser√£o utilizadas dentro de cada camada e forma geom√©trica (.e., tipo de gr√°fico) desejada. Por√©m, para cada tipo gr√°fico apresentamos fun√ß√µes e argumentos para ajustes finos e personalizados.","code":""},{"path":"cap6.html","id":"histograma-histogram","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.4.1 Histograma (histogram)","text":"O histograma √© um gr√°fico extremamente popular, sendo bastante √∫til para visualizar distribui√ß√£o de vari√°veis cont√≠nuas. √â bem prov√°vel que voc√™ j√° tenha visto um histograma quando aprendeu pela primeira vez famosa distribui√ß√£o normal (Figura 6.2).\nFigura 6.2: Histograma de uma distribui√ß√£o normal com 10000 observa√ß√µes.\nNeste histograma √© poss√≠vel entender que maioria dos valores objeto dist_normal est√£o pr√≥ximos ao valor da m√©dia, .e., zero. Em Ecologia, os histogramas s√£o utilizados para visualizar, por exemplo, varia√ß√£o morfol√≥gica entre esp√©cies (subesp√©cies, g√™nero, fam√≠lias, etc.), varia√ß√£o de par√¢metros populacionais entre diferentes esp√©cies ou dentro da mesma esp√©cie em diferentes localidades.Vers√£o padr√£oVamos utilizar o conjunto de dados palmerpenguins para construir um histograma da distribui√ß√£o da vari√°vel flipper_length_mm com fun√ß√£o geom_hitogram(). Esta fun√ß√£o utiliza uma vari√°vel cont√≠nua eixo X e frequ√™ncia de cada categoria de intervalo de valores eixo Y. O gr√°fico seguir representa frequ√™ncia de uma vari√°vel (neste caso, medida de todos os pinguins, independente da esp√©cie) (Figura 6.3).\nFigura 6.3: Histograma da vari√°vel comprimento_nadadeira.\nDefinindo o n√∫mero de classesVamos utilizar o argumento bins para definir em quantas classes vari√°vel x deve ser dividida (Figura 6.4).\nFigura 6.4: Histograma da vari√°vel comprimento_nadadeira para diferentes classes de divis√£o.\nComparando m√∫ltiplas categoriasSe quisermos comparar distribui√ß√£o de uma vari√°vel cont√≠nua entre diferentes categorias, podemos utilizar o argumento fill para colorir o gr√°fico. exemplo abaixo, utilizamos cores diferentes para ilustrar distribui√ß√£o da vari√°vel X (x = flipper_length_mm) entre esp√©cies diferentes (fill = species) (Figura 6.5).\nFigura 6.5: Histograma da vari√°vel comprimento_nadadeira para diferentes esp√©cies com e sem sobreposi√ß√£o.\nAjustes finos (vers√£o personalizada)\nFigura 6.6: Histograma da vari√°vel comprimento_nadadeira com ajustes finos.\nPrincipais camadas utilizadas na fun√ß√£o geom_histogram()aes()Eixo X (x): vari√°vel cont√≠nua (comprimento_nadadeira)Preenchimento (fill): vari√°vel categ√≥rica (especies) que define cores tendo como base o n√∫mero de n√≠veis dentro desta categoriageom()geom_histogram(): para que vari√°vel cont√≠nua seja plotada como histogramaTranspar√™ncia das linhas e preenchimentos (alpha): 0.5 (varia de 0, transpar√™ncia m√°xima, 1, sem transpar√™ncia)Posi√ß√£o das barras: o argumento position define se barras devem ser inseridas de maneira sobreposta (position = \"identity\") ou n√£o (position = \"dodge\")scale()scale_fill_manual(): para definir manualmente corestheme()theme_bw(): para selecionar o tema com fundo brancolabs(): para personalizar os t√≠tulos dos eixos X e Y, e da legenda","code":"\n## Dados\ndist_normal <- data.frame(x = rnorm(10000, mean = 0, sd = 1))\n\n## Histograma de uma vari√°vel cont√≠nua\nggplot(data = dist_normal, aes(x = x)) +\n    geom_histogram()\n## Histograma da coluna flipper_length_mm\nggplot(data = penguins, aes(x = comprimento_nadadeira)) +\n    geom_histogram()\n## Histograma com 10 classes\nggplot(data = penguins, aes(x = comprimento_nadadeira)) +\n    geom_histogram(bins = 10) +\n    labs(title = \"10 classes\")\n\n## Histograma com 30 classes\nggplot(data = penguins, aes(x = comprimento_nadadeira)) +\n    geom_histogram(bins = 30) +\n    labs(title = \"30 classes\")\n## Histograma com cores para diferentes categorias com sobreposi√ß√£o\nggplot(data = penguins, aes(x = comprimento_nadadeira, fill = especies)) +\n    geom_histogram(alpha = .4) +\n    labs(title = \"Com sobreposi√ßao\")\n\n## Histograma com cores para diferentes categorias sem sobreposi√ß√£o\nggplot(data = penguins, aes(x = comprimento_nadadeira, fill = especies)) +\n    geom_histogram(position = \"dodge\") +\n    labs(title = \"Sem sobreposi√ßao\")\n## Histograma exemplo\nggplot(data = penguins, aes(x = comprimento_nadadeira, fill = especies)) +\n    geom_histogram(alpha = .4, position = \"identity\") +\n    scale_fill_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    theme_bw(base_size = 14) +\n    labs(x = \"Comprimento da nadadeira (mm)\", \n         y = \"Frequ√™ncia absoluta\", fill = \"Esp√©cies\")"},{"path":"cap6.html","id":"gr√°fico-de-densidade-density-plot","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.4.2 Gr√°fico de densidade (density plot)","text":"Nesta se√ß√£o aprenderemos criar um gr√°fico de densidade R utilizando o ggplot2. Assim como o histograma, o gr√°fico de densidade √© utilizado para visualizar distribui√ß√£o de uma vari√°vel cont√≠nua em intervalos. Esse gr√°fico √© uma varia√ß√£o histograma que utiliza Kernel Smoother e, al√©m de ser muito √∫til para visualizar distribui√ß√µes, pode ser usado para testar v√°rias hip√≥teses ecol√≥gicas, como descrito Cap√≠tulo 14.Vers√£o padr√£oVamos utilizar o conjunto de dados palmerpenguins para plotar distribui√ß√£o da vari√°vel flipper_length_mm em um gr√°fico de densidade. Utilizaremos fun√ß√£o geom_density() para plotar uma vari√°vel eixo X (Figura 6.7).\nFigura 6.7: Gr√°fico de densidade da vari√°vel comprimento_nadadeira.\nAl√©m da vers√£o de densidade em linha, √© poss√≠vel utilizar o argumento fill para definir cor de preenchimento gr√°fico e o argumento alpha para definir transpar√™ncia preenchimento. Utilizamos ainda o argumento color para definir cor da linha (Figura 6.8).\nFigura 6.8: Gr√°fico de densidade da vari√°vel comprimento_nadadeira com cor e preenchimento.\nComparando m√∫ltiplas categoriasEm algumas situa√ß√µes queremos comparar distribui√ß√£o de uma vari√°vel cont√≠nua entre diferentes categorias. Dessa forma, podemos utilizar o argumento fill para colorir o gr√°fico. exemplo abaixo, utilizamos cores diferentes para ilustrar distribui√ß√£o da vari√°vel x entre esp√©cies diferentes (fill = species) (Figura 6.9).\nFigura 6.9: Gr√°fico de densidade da vari√°vel comprimento_nadadeira para diferentes esp√©cies com e sem transpar√™ncia.\nAjustes finos (vers√£o personalizada)\nFigura 6.10: Gr√°fico de densidade da vari√°vel comprimento_nadadeira com ajustes finos.\nPrincipais camadas utilizadas na fun√ß√£o geom_density()aes()Eixo X (x): vari√°vel cont√≠nua (comprimento_nadadeira)Preenchimento (fill): vari√°vel categ√≥rica (especies) que define cores tendo como base o n√∫mero de n√≠veis dentro desta categoriageom()geom_density(): para que vari√°vel cont√≠nua seja plotada como densidadeTranspar√™ncia das linhas e preenchimentos (alpha): 0.5 (varia de 0, transpar√™ncia m√°xima, 1, sem transpar√™ncia)scale()scale_fill_manual(): para definir manualmente cores de prefer√™ncia usu√°rioscale_x_continuous() e scale_y_continuous(): determinam os limites (valores m√≠nimos e m√°ximos) para os dois eixos e, al√©m disso, os intervalos entre os valores (breaks)theme()theme_bw(): para selecionar o tema com fundo brancolabs(): para personalizar os t√≠tulos dos eixos X e Y, e da legenda","code":"\n## Gr√°fico de densidade\nggplot(data = penguins, aes(x = comprimento_nadadeira)) +\n    geom_density()\n## Argumento fill\nggplot(data = penguins, aes(x = comprimento_nadadeira)) +\n    geom_density(fill = \"cyan4\")\n\n## Argumento fill, color e alpha\nggplot(data = penguins, aes(x = comprimento_nadadeira)) +\n    geom_density(fill = \"cyan4\", color = \"black\", alpha = .4)\n## O argumento fill preenche cada n√≠vel da coluna \"especies\" (sem transpar√™ncia: alpha = 1)\nggplot(data = penguins, aes(x = comprimento_nadadeira, fill = especies)) +\n    geom_density() +\n    scale_fill_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    labs(title = \"Sem transpar√™ncia\")\n\n## Gr√°fico de densidade com cores para diferentes categorias com sobreposi√ß√£o\nggplot(data = penguins, aes(x = comprimento_nadadeira, fill = especies)) +\n    geom_density(alpha = .4) +\n    scale_fill_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    labs(title = \"Com transpar√™ncia\")\n## Gr√°fico de densidade exemplo\nggplot(data = penguins, aes(x = comprimento_nadadeira, fill = especies)) +\n    geom_density(alpha = .4) +\n    scale_fill_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    scale_x_continuous(breaks = seq(from = 160, to = 240, by = 10), limits = c(160, 240)) +\n    scale_y_continuous(breaks = seq(from = 0, to = .07, by = .01)) +\n    theme_bw(base_size = 14) +\n    labs(x = \"Comprimento da nadadeira (mm)\", y = \"Densidade\", fill = \"Esp√©cies\")"},{"path":"cap6.html","id":"diagrama-de-pontos-dot-plot","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.4.3 Diagrama de pontos (dot plot)","text":"Uma alternativa ao histograma e ao gr√°fico de densidade √© o diagrama de pontos (Dot plot, apesar de ser relativamente menos usado em Ecologia.Vers√£o padr√£oVamos utilizar o conjunto de dados palmerpenguins para visualizar distribui√ß√£o da vari√°vel flipper_length_mm com o diagrama de pontos com fun√ß√£o geom_dotplot() (Figura 6.11).\nFigura 6.11: Diagrama de pontos da vari√°vel comprimento_nadadeira.\nComparando m√∫ltiplas categoriasAssim como nas fun√ß√µes geom_histogram() e geom_density(), √© poss√≠vel comparar categorias na fun√ß√£o geom_dotplot() utilizando o argumento fill, bem como os argumentos color, alpha e dotsize (Figura 6.12).\nFigura 6.12: Diagrama de pontos da vari√°vel comprimento_nadadeira para diferentes esp√©cies com e sem transpar√™ncia.\nAjustes finos (vers√£o personalizada)\nFigura 6.13: Diagrama de pontos da vari√°vel comprimento_nadadeira com ajustes finos.\n üìù Importante \nUma das limita√ß√µes diagrama de pontos √© que sobreposi√ß√£o dos pontos pode n√£o permitir visualiza√ß√£o apropriada desses valores sobrepostos entre diferentes grupos quando comparados.Principais camadas utilizadas na fun√ß√£o geom_dotplot()aes():Eixo X (x): vari√°vel cont√≠nua (comprimento_nadadeira)Preenchimento (fill): vari√°vel categ√≥rica (especies) que define cores tendo como base o n√∫mero de n√≠veis dentro desta categoriageom():geom_dotplot(): para que vari√°vel cont√≠nua seja plotada como diagrama de pontosTranspar√™ncia dos pontos (alpha): 0.5 (varia de 0, transpar√™ncia m√°xima, 1, sem transpar√™ncia)Cor da borda ponto (color): valor padr√£o (se n√£o especificado) √© blackTamanho dos pontos (dotsize): valor padr√£o (se n√£o especificado) √© 1Posi√ß√£o dos pontos: o argumento position define se os pontos devem ser inseridos de maneira sobreposta (position = \"identity\") ou n√£o (position = \"dodge\")scale():scale_fill_manual() para definir manualmente cores de prefer√™ncia usu√°rioscale_x_continuous() e scale_y_continuous() determinam os limites (valor m√≠nimo e m√°ximo) para os dois eixos e, al√©m disso, os intervalos entre os valores (breaks)theme():theme_bw()para selecionar o tema com fundo brancolabs() para personalizar os t√≠tulos dos eixos X e Y, e da legenda","code":"\n## Gr√°fico de pontos\nggplot(data = penguins, aes(x = comprimento_nadadeira)) +\n    geom_dotplot(dotsize = .6)\n## O argumento fill preenche cada n√≠vel da coluna \"species\" (sem transpar√™ncia: alpha = 1)\nggplot(data = penguins, aes(x = comprimento_nadadeira, fill = especies)) +\n    geom_dotplot(dotsize = .9)\n\n## Diagrama de pontos com cores para diferentes categorias com sobreposi√ß√£o\nggplot(data = penguins, aes(x = comprimento_nadadeira, fill = especies)) +\n    geom_dotplot(dotsize = .7, color = \"black\", alpha = .4)\n## Diagrama de pontos exemplo\nggplot(data = penguins, aes(x = comprimento_nadadeira, fill = especies)) +\n    geom_dotplot(color = \"black\", alpha = .7, position = \"dodge\") +\n    scale_fill_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    scale_x_continuous(breaks = seq(from = 170, to = 240, by = 10), limits = c(170, 240)) +\n    scale_y_continuous(breaks = seq(from = 0, to = 1.4, by = .2), limits = c(0, 1.4)) +\n    theme_bw(base_size = 14) +\n    labs(x = \"Comprimento da nadadeira (mm)\", y = \"Frequ√™ncia\", fill = \"Esp√©cies\")"},{"path":"cap6.html","id":"gr√°fico-de-barras-bar-plot","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.4.4 Gr√°fico de barras (bar plot)","text":"O gr√°fico de barras √© um dos gr√°ficos mais usados em artigos e livros de Ecologia, uma vez que permite comparar valores absolutos ou m√©dios (combinados com alguma medida de varia√ß√£o, como desvio padr√£o) de uma vari√°vel cont√≠nua entre diferentes n√≠veis de uma vari√°vel categ√≥rica.Vers√£o padr√£oO gr√°fico de barras utiliza ret√¢ngulos para representar uma vari√°vel cont√≠nua ou contagem de uma vari√°vel categ√≥rica, sendo que o comprimento dos ret√¢ngulos √© proporcional ao valor que ele representa. Por exemplo, √© poss√≠vel comparar qual quantidade de indiv√≠duos medidos para cada esp√©cie de pinguim (Figura 6.14).\nFigura 6.14: Gr√°fico de barras indicando quantidade de indiv√≠duos medidos de cada esp√©cie de pinguim.\nAl√©m disso, √© poss√≠vel alterar cores (color) e preenchimento (fill) das barras, bem como sua transpar√™ncia (alpha) e largura (width), como demonstrado nos pr√≥ximos quatro gr√°ficos (Figura 6.15).\nFigura 6.15: Gr√°ficos de barras indicando quantidade de indiv√≠duos medidos de cada esp√©cie de pinguim, modificando cor, preenchimento, transpar√™ncia e largura das barras.\nOutra possibilidade para representa√ß√£o gr√°fico de barras √© inverter dire√ß√£o das barras com fun√ß√£o coord_flip() (Figura 6.16).\nFigura 6.16: Gr√°ficos de barras indicando quantidade de indiv√≠duos medidos de cada esp√©cie de pinguim, invertendo dire√ß√£o das barras.\n√â poss√≠vel utilizar vari√°veis categ√≥ricas para definir cores e preenchimento e ilustrar, por exemplo, tratamentos ou esp√©cies diferentes com os argumentos fill e color (Figura 6.17).\nFigura 6.17: Gr√°fico de barras indicando quantidade de indiv√≠duos medidos de cada esp√©cie de pinguim, para diferentes esp√©cies.\nAdicionando medidas de varia√ß√£oEm algumas compara√ß√µes, utilizar somente os valores absolutos pode n√£o ser visualiza√ß√£o mais apropriada, como, por exemplo, em desenhos de ANOVA (Cap√≠tulo 7). Desse modo, ao inv√©s valor m√°ximo da barra representar o valor absoluto (e.g., n√∫mero de indiv√≠duos de uma esp√©cie), ele vai representar o valor m√©dio. Al√©m disso, linhas adicionais (chamadas barras de erro) v√£o representar alguma medida de varia√ß√£o como desvio padr√£o, erro padr√£o, intervalo de confian√ßa, entre outros (Figura 6.18)\nFigura 6.18: Gr√°fico de barras indicando os valores m√©dios e o desvio padr√£o da vari√°vel flipper_length_mm para cada esp√©cie de pinguim.\nAjustes finos (vers√£o personalizada)\nFigura 6.19: Gr√°fico de barras indicando quantidade de indiv√≠duos medidos de cada esp√©cie de pinguim, com ajustes finos.\n","code":"\n## N√∫mero de indiv√≠duos coletados\npenguins_count <- penguins %>%\n    dplyr::count(especies)\npenguins_count\n#> # A tibble: 3 √ó 2\n#>   especies      n\n#>   <fct>     <int>\n#> 1 Adelie      152\n#> 2 Chinstrap    68\n#> 3 Gentoo      124\n\n## Gr√°fico de barras\nggplot(data = penguins_count, aes(x = especies, y = n)) + \n    geom_bar(stat = \"identity\")\n## Modificando o preenchimento\nggplot(data = penguins_count, aes(x = especies, y = n)) + \n    geom_bar(stat = \"identity\", fill = \"cyan4\")\n\n## Modificando a cor e o preenchimento\nggplot(data = penguins_count, aes(x = especies, y = n)) + \n    geom_bar(stat = \"identity\", color = \"cyan4\", fill = \"white\")\n\n## Modificando a largura da barra = .75\nggplot(data = penguins_count, aes(x = especies, y = n)) +\n    geom_bar(stat = \"identity\", width = .75) +\n    labs(title = \"Largura = .75\")\n\n## Modificando a largura da barra = .25\nggplot(data = penguins_count, aes(x = especies, y = n)) +\n    geom_bar(stat = \"identity\", width = .25) +\n    labs(title = \"Largura = .25\") \n## Barras vertical\nggplot(data = penguins_count, aes(x = especies, y = n)) +\n    geom_bar(stat = \"identity\", width = .6)\n\n## Barras horizontal\nggplot(data = penguins_count, aes(x = especies, y = n)) +\n    geom_bar(stat = \"identity\", width = .6) + \n    coord_flip()\n## Gr√°fico de barras com preenchimento colorido\nggplot(data = penguins_count, aes(x = especies, y = n, fill = especies)) +\n    geom_bar(stat = \"identity\")\n## Calcular o desvio padr√£o por esp√©cie\npenguins_media <- penguins %>% \n    dplyr::group_by(especies) %>% \n    dplyr::summarise(media = mean(comprimento_nadadeira, na.rm = TRUE),\n                     desvio = sd(comprimento_nadadeira, na.rm = TRUE))\n\n## Gr√°fico de barras com desvio padr√£o\nggplot(data = penguins_media, aes(x = especies, y = media, fill = especies)) +\n    geom_bar(stat = \"identity\", alpha = .4) +\n    geom_errorbar(aes(ymin = media-desvio, ymax = media+desvio), width = .1) + \n    geom_point()\n## Gr√°fico de barra exemplo\nggplot(data = penguins_count, aes(x = especies, y = n, fill = especies)) +\n    geom_bar(stat = \"identity\") +\n    geom_label(aes(label = n), fill = \"white\") +\n    scale_fill_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw(base_size = 14) +\n    labs(x = \"Esp√©cies\", y = \"N√∫mero de indiv√≠duos\", fill = \"Esp√©cies\")"},{"path":"cap6.html","id":"gr√°fico-de-setores-pie-chart-e-donut-chart","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.4.5 Gr√°fico de setores (pie chart e donut chart)","text":"Al√©m gr√°fico de barras, o gr√°fico de setores representa uma alternativa para comparar propor√ß√£o entre categorias. Tais gr√°ficos podem ser representados como pie charts ou donut charts, como demonstrado abaixo. exemplo abaixo, utilizamos mesma compara√ß√£o realizada item acima. Por√©m, os valores de contagem (n√∫mero de indiv√≠duos por esp√©cie) devem ser transformados previamente em propor√ß√£o.Gr√°fico de setores (pie chart)Gr√°fico de setores tipo pie (Figura 6.20).\nFigura 6.20: Gr√°fico de setores indicando propor√ß√£o de indiv√≠duos medidos de cada esp√©cie de pinguim.\nGr√°fico de setores (donut chart)Gr√°fico de setores tipo donuts (Figura 6.21).\nFigura 6.21: Gr√°fico de setores tipo donuts indicando propor√ß√£o de indiv√≠duos medidos de cada esp√©cie de pinguim.\nComparando gr√°ficos de setores com gr√°fico de barrasO mesmo conjunto de dados pode ser visualizado de diferentes formas. N√£o diferente, compara√ß√£o da propor√ß√£o de ocorr√™ncias de diferentes categorias pode ser feita de v√°rias maneiras. Abaixo, apresentamos compara√ß√£o da propor√ß√£o de indiv√≠duos por cada uma das tr√™s esp√©cies dos dados penguins (Figura 6.22).\nFigura 6.22: Compara√ß√£o da propor√ß√£o de indiv√≠duos por cada uma das tr√™s esp√©cies dos dados feita atrav√©s de gr√°fico de barras, setores tipo pie e setores tipo donuts.\nPrincipais camadas utilizadas gr√°fico de barras e de setores: geom_bar()aes()Eixo X (x): vari√°vel categ√≥rica (species)Eixo Y (y): vari√°vel cont√≠nua (comprimento_nadadeira)Preenchimento (fill): vari√°vel categ√≥rica (especies) define cor preenchimento e os n√≠veis dentro desta categoria determinam o n√∫mero de cores que devem ser indicadas scale_fill_manual()geom()geom_bar(): para que vari√°veis categ√≥ricas sejam plotadas como gr√°ficos de barra ou setoresTranspar√™ncia das barras (alpha): 0.5 (varia de 0, transpar√™ncia m√°xima, 1, sem transpar√™ncia)stat: √© necess√°rio usar o argumento identity quando os valores eixo Y s√£o adicionados pelo usu√°riogeom_label(): forma geom√©trica que adiciona r√≥tulo dos valores absolutos das barras por categoria (species)geom_errorbar(): ymine ymax delimitam os valores m√≠nimos e m√°ximos, respectivamente, das barras de erro. Tais valores s√£o representados pelo valor da m√©dia menos (caso ymin) ou mais (caso ymax) o valor intervalo de confian√ßa, desvio ou erro padr√£ocoordcoord_polar(): sistema de coordenadas para gerar barras circulares sobrepostas (stacked) que s√£o usadas nos gr√°ficos de setores (pie chart e donut chart)o argumento start = 0 indica o local de in√≠cio gr√°fico que, neste caso, come√ßa na ‚Äúhora‚Äù 0 em um ‚Äúrel√≥gio‚Äù de 12 horasscale()scale_fill_manual(): para definir manualmente cores de prefer√™ncia usu√°riotheme()theme_bw(): para selecionar o tema com fundo brancolabs(): para personalizar os t√≠tulos dos eixos X e Y, e da legenda.","code":"\n## C√°lculo da propor√ß√£o - pie\npenguins_prop <- penguins %>%\n    dplyr::count(especies) %>% \n    dplyr::mutate(prop = round(n/sum(n), 4)*100)\n\n## Gr√°fico de setores\nggplot(data = penguins_prop, aes(x = \"\", y = prop, fill = especies)) + \n    geom_bar(stat = \"identity\", color = \"white\") +\n    geom_text(aes(label = paste0(prop, \"%\")), color = \"white\", \n              position = position_stack(vjust = .5), size = 6) +\n    scale_fill_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    coord_polar(\"y\", start = 0) +\n    theme_void() +\n    labs(fill = \"Esp√©cies\")\n## Gr√°fico de setores - donut\nggplot(data = penguins_prop, aes(x = 2, y = prop, fill = especies)) +\n    geom_bar(stat = \"identity\") +\n    geom_text(aes(label = paste0(prop, \"%\")), color = \"white\",\n              position = position_stack(vjust = .5), size = 4) +\n    scale_fill_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    xlim(0, 2.5) +\n    coord_polar(theta = \"y\", start = 0) +\n    theme_void() +\n    theme(legend.position = c(.5, .5),\n          legend.title = element_text(size = 20),\n          legend.text = element_text(size = 15)) +\n    labs(fill = \"Esp√©cies\")\n## Gr√°fico de barras - vertical  \ng_bar_v <- ggplot(data = penguins_prop, aes(x = especies, y = prop, fill = especies)) +\n    geom_bar(stat = \"identity\") +\n    geom_label(aes(label = prop), fill = \"white\") +\n    scale_fill_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw() +\n    theme(legend.position = \"none\") +\n    labs(title = \"Gr√°fico de Barras (Vertical)\", x = \"Esp√©cies\", \n         y = \"N√∫mero de indiv√≠duos\", fill = \"Esp√©cies\")\n\n## Gr√°fico de barras - horizontal  \ng_bar_h <- ggplot(data = penguins_prop, aes(x = especies, y = prop, fill = especies)) +\n    geom_bar(stat = \"identity\") +\n    geom_label(aes(label = prop), fill = \"white\") +\n    scale_fill_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    coord_flip() +\n    theme_bw() +\n    theme(legend.position = \"none\") +\n    labs(title = \"Gr√°fico de Barras (Horizonal)\", x = \"Esp√©cies\", \n         y = \"N√∫mero de indiv√≠duos\", fill = \"Esp√©cies\")\n\n## Gr√°fico de setores - pie\ng_pie <- ggplot(data = penguins_prop, aes(x = \"\", y = prop, fill = especies)) + \n    geom_bar(stat = \"identity\", color = \"white\") +\n    geom_text(aes(label = paste0(prop, \"%\")), color = \"white\", \n              position = position_stack(vjust = .5), size = 3) +\n    scale_fill_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    coord_polar(\"y\", start = 0) +\n    theme_void() +\n    labs(title = \"Pie chart\", fill = \"Esp√©cies\")\n\n## Gr√°fico de setores - donut\ng_donut <- ggplot(data = penguins_prop, aes(x = 2, y = prop, fill = especies)) +\n    geom_bar(stat = \"identity\") +\n    geom_text(aes(label = paste0(prop, \"%\")), color = \"white\",\n              position = position_stack(vjust = .5), size = 2) +\n    scale_fill_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    coord_polar(theta = \"y\", start = 0) +\n    xlim(0, 2.5) +\n    theme_void() +\n    theme(legend.position = \"none\") +\n    labs(title = \"Donut chart\", fill = \"Esp√©cies\")\n\n## Combina√ß√£o dos gr√°figos\ngrid.arrange(g_bar_v, g_bar_h, g_pie, g_donut, nrow = 2)"},{"path":"cap6.html","id":"gr√°fico-de-caixa-boxplot","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.4.6 Gr√°fico de caixa (boxplot)","text":"O gr√°fico de caixa, tamb√©m conhecido como boxplot, e amplamente utilizado nos artigos e livros de Ecologia, √© uma visualiza√ß√£o gr√°fica que sintetiza informa√ß√µes importantes de dados cont√≠nuos como mediana e varia√ß√£o (Figura 6.23) para diferentes n√≠veis de uma vari√°vel categ√≥rica.\nFigura 6.23: Estrutura e elementos boxplot.\nVers√£o padr√£oVamos plotar uma vari√°vel cont√≠nua (comprimento_nadadeira) eixo y em fun√ß√£o de uma vari√°vel categ√≥rica eixo x (especies). defini√ß√£o de qual coluna bando de dados √© x e qual √© y √© feita dentro na fun√ß√£o aes() (Figura 6.24).\nFigura 6.24: Gr√°fico de caixa para vari√°vel comprimento_nadadeira para cada esp√©cie de pinguim.\n√â poss√≠vel destacar, se houver, os pontos referentes aos outliers (valores discrepantes) com o argumento outlier.color. Caso tenha interesse, √© poss√≠vel tamb√©m remover os outliers gr√°fico (Figura 6.25).\nFigura 6.25: Gr√°fico de caixa para vari√°vel comprimento_nadadeira para cada esp√©cie de penguim, destacando e removendo os outliers.\nOutra op√ß√£o para os gr√°ficos tipo boxplot √© utilizar o argumento notch = TRUE para produzir diagramas de caixa entalhados (notched). Estes diagramas s√£o √∫teis para inferir de forma aproximada se exite diferen√ßa significativa entre medias dos grupos (Figura 6.26).\nFigura 6.26: Gr√°fico de caixa para vari√°vel comprimento_nadadeira para cada esp√©cie de penguim, com entalhamentos.\nComparando m√∫ltiplas categoriasNo exemplo abaixo, utilizamos cores diferentes para ilustrar esp√©cies diferentes atrav√©s argumento fill = species (Figura 6.27).\nFigura 6.27: Gr√°fico de caixa para vari√°vel comprimento_nadadeira para cada esp√©cie de pinguim, com preenchimentos diferentes.\nCombinando boxplot com pontos (jitter)Podemos ainda acrescentar pontos para mostrar distribui√ß√£o dos dados, fazendo uma ‚Äúagita√ß√£o‚Äù (jitter) dos pontos sobre caixas (Figura 6.28).\nFigura 6.28: Gr√°fico de caixa para vari√°vel flipper_length_mm para cada esp√©cie de penguim, com distribui√ß√£o dos dados.\nGr√°fico de violino (violin plot) como alternativa ao boxplotAl√©m das caixas boxplot, podemos utilizar o formato de ‚Äúviolino‚Äù (gr√°fico de violino) para representar varia√ß√£o dos dados cont√≠nuos para categorias. informa√ß√£o adicional ao boxplot que o gr√°fico de violino permite visualizar √© densidade e distribui√ß√£o dos pontos, assim como apresentamos acima gr√°fico de densidades geom_density(). diferen√ßa √© que densidade √© espelhada e, desse modo, podemos visualizar os intervalores dos dados com maior ou menor concentra√ß√£o de valores (Figura 6.29).\nFigura 6.29: Gr√°fico de violino para vari√°vel comprimento_nadadeira para cada esp√©cie de penguim, com distribui√ß√£o dos dados.\n√â poss√≠vel tamb√©m combinar boxplot e gr√°fico de violino em um √∫nico gr√°fico (Figura 6.30).\nFigura 6.30: Gr√°fico de caixa e de violino para vari√°vel comprimento_nadadeira para cada esp√©cie de penguim.\nAjustes finos (vers√£o personalizada)\nFigura 6.31: Gr√°fico de caixa, violino, e caixa e violino para vari√°vel comprimento_nadadeira para cada esp√©cie de penguim, com ajustes finos.\nPrincipais camadas utilizadas geom_boxplot()e geom_violin()aes()Eixo X (x): vari√°vel categ√≥rica (especies)Eixo Y (y): vari√°vel cont√≠nua (comprimento_nadadeira)Preenchimento (fill): vari√°vel categ√≥rica (especies) define cor preenchimento e os n√≠veis dentro desta categoria determinam o n√∫mero de cores que devem ser indicadas scale_fill_manual().geom():geom_boxplot(): para que vari√°veis cont√≠nuas e categ√≥ricas sejam plotadas como gr√°ficos de caixas ou violinoswidth: largura das barras ou dos pontos(valor padr√£o: width = 1)fill: pode definir uma cor padr√£o (caso n√£o tenha utilizado o fill dentro argumento aes()) como fill = \"gray\"notch: para utilizar caixa entalhada o argumento deve ser notch = TRUE, escolha padr√£o da fun√ß√£o geom_boxplot() √© notch = FALSEgeom_violin(): assim como nas outras formas geom√©tricas, √© poss√≠vel controlar largura, cor, preenchimento e transpar√™ncias dos violinosgeom_jitter(): esta fun√ß√£o basicamente ‚Äúagita‚Äù aleatoriamente os pontos para evitar sobreposi√ß√£o de valores id√™nticos. Esta fun√ß√£o produz mesma representa√ß√£o se usar fun√ß√£o geom_point(position = \"jitter\")scale()scale_fill_manual(): para definir manualmente cores de prefer√™ncia usu√°riotheme()theme_bw(): para selecionar o tema com fundo brancolabs(): para personalizar os t√≠tulos dos eixos X e Y, e da legenda","code":"\n## Gr√°fico de caixas das coluna comprimento_nadadeira e esp√©cies\nggplot(data = penguins, aes(y = comprimento_nadadeira, x = especies)) +\n    geom_boxplot()\n## Destaque dos outliers\nggplot(data = penguins, aes(y = comprimento_nadadeira, x = especies)) +\n    geom_boxplot(outlier.color = \"red\") +\n    labs(title = \"Outliers vermelhos\")\n\n## Remo√ß√£o dos outliers\nggplot(data = penguins, aes(y = comprimento_nadadeira, x = especies)) +\n    geom_boxplot(outlier.shape = NA) +\n    labs(title = \"Outliers removidos\")\n## Gr√°fico com caixa entalhadas\nggplot(data = penguins, aes(y = comprimento_nadadeira, x = especies)) +\n    geom_boxplot(notch = TRUE) +\n    labs(title = \"Caixas entalhadas\")\n## Modificando o preenchimento\nggplot(data = penguins, \n       aes(y = comprimento_nadadeira, x = especies, fill = especies)) +\n    geom_boxplot()\n## Boxplot com jitters\nggplot(data = penguins, aes(y = comprimento_nadadeira, \n                            x = especies, \n                            fill = especies)) +\n    geom_boxplot() +\n    geom_jitter(size = .5)\n## Gr√°fico de violino\nggplot(data = penguins, aes(y = comprimento_nadadeira, x = especies, fill = especies)) +\n    geom_violin() +\n    geom_jitter(size = .5)\n## Combinando o gr√°fico de violino com o de caixas\nggplot(data = penguins, aes(y = comprimento_nadadeira, x = especies, fill = especies)) +\n    geom_violin() +\n    geom_boxplot(width = .1, fill = \"gray\")\n## Gr√°fico de caixas exemplo\nggplot(data = penguins, aes(x = especies, y = comprimento_nadadeira, fill = especies)) +\n    geom_boxplot(width = .5, show.legend = FALSE) +\n    scale_fill_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw(base_size = 14) +\n    labs(title = \"Boxplot sem pontos\", x = \"Esp√©cies\", y = \"Comprimento da nadadeira (mm)\")\n\n## Gr√°fico de violino exemplo\nggplot(data = penguins, aes(x = especies, y = comprimento_nadadeira, fill = especies)) +\n    geom_violin(width = .5, show.legend = FALSE) +\n    geom_jitter(alpha = .4, show.legend = FALSE, \n                position = position_jitter(width = .15, seed = 0)) +\n    scale_fill_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw(base_size = 14) +\n    labs(title = \"Gr√°fico de violino com jitter\", x = \"Esp√©cies\", y = \"Comprimento da nadadeira (mm)\")\n\n## Gr√°fico de caixas e violino exemplo\nggplot(data = penguins, aes(x = especies, y = comprimento_nadadeira, fill = especies)) +\n    geom_violin(width = .5, show.legend = FALSE) +\n    geom_boxplot(width = .3, fill = \"gray\", show.legend = FALSE) +\n    scale_fill_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw(base_size = 14) +\n    labs(title = \"Gr√°fico de violino com boxplot\", x = \"Esp√©cies\", y = \"Comprimento da nadadeira (mm)\")"},{"path":"cap6.html","id":"gr√°fico-de-dispers√£o-scatter-plot","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.4.7 Gr√°fico de dispers√£o (scatter plot)","text":"O gr√°fico de dispers√£o (em ingl√™s, scatter plot) √© famoso na Ecologia por ser visualiza√ß√£o preferida para representar rela√ß√£o entre √°rea e riqueza de esp√©cies. Neste gr√°fico, os eixos X e Y s√£o representados por vari√°veis cont√≠nuas. Em especial, os gr√°ficos de dispers√£o s√£o usados para representar os resultados testados por an√°lises estat√≠sticas como regress√£o linear, ANCOVA, mantel, PCA, PCoA, nMDS entre outros (para mais detalhes, consultar os Cap√≠tulos 7, 8 e 9).Vers√£o padr√£oVamos utilizar o conjunto de dados palmerpenguins para construir um gr√°fico de dispers√£o relacionando vari√°veis comprimento_bico e comprimento_nadadeira com fun√ß√£o geom_point(). Esta fun√ß√£o utiliza vari√°vel cont√≠nuas eixo X e Y. O gr√°fico mostra os pares ordenados das medidas das duas vari√°veis (Figura 6.32).\nFigura 6.32: Gr√°fico de dispers√£o relacionando vari√°veis comprimento_bico e comprimento_nadadeira.\nDefinindo cor, tamanho, forma e preenchimento dos pontosDa mesma forma que para os outros gr√°ficos, podemos alterar cor, tamanho, forma e preenchimento dos pontos (Figura 6.33).\nFigura 6.33: Gr√°fico de dispers√£o relacionando vari√°veis comprimento_bico e comprimento_nadadeira para cada esp√©cie de penguim, com altera√ß√µes na cor, tamanho e preenchimento dos pontos.\nforma dos pontos permite dois controles importantes: forma em si (s√≠mbolos como c√≠rculo, quadrado, etc.) e possibilidade de preenchimento da forma. figura seguir discrimina esses s√≠mbolos e o valor que deve ser utilizado para desenhar forma preferida. √â importante notar que os s√≠mbolos 21 25 possuem dois argumentos: () cor (que, na verdade, √© cor da borda s√≠mbolo) e (ii) cor que define o preenchimento s√≠mbolo. O tipo de s√≠mbolo √© definido pelo argumento shape (Figura 6.34).\nFigura 6.34: Tipos de s√≠mbolos dispon√≠veis para representar pontos.\nAssim, √© poss√≠vel controlar cores, formas e preenchimento combinado os argumentos shape, fille color com fun√ß√£o scale_manual(). √â importante notar que para os s√≠mbolos entre 15 e 20 s√≥ podemos controlar o argumento cor, enquanto os s√≠mbolos entre 21 e 25 podemos controlar cor e o preenchimento (Figura 6.35).\nFigura 6.35: Gr√°fico de dispers√£o relacionando vari√°veis comprimento_bico e comprimento_nadadeira para cada esp√©cie de penguim, com altera√ß√µes formato.\nDefinindo linhas de ajusteQuando usamos modelos estat√≠sticos como, por exemplo, lm(), glm(), gam(), entre outros (veja mais nos Cap√≠tulos 7 e 8), podemos utilizar os valores preditos para demonstrar rela√ß√£o entre vari√°veis X e Y. ggplot2, fun√ß√£o geom_smooth() faz esse ajuste com certa simplicidade (Figura 6.36).\nFigura 6.36: Gr√°fico de dispers√£o relacionando vari√°veis comprimento_bico e comprimento_nadadeira para cada esp√©cie de penguim, com linhas de ajustes estat√≠sticos.\nAjustes finos (vers√£o personalizada)\nFigura 6.37: Gr√°fico de dispers√£o relacionando vari√°veis bill_length_mm e flipper_length_mm para cada esp√©cie de penguim, com ajustes finos.\nAl√©m disso, podemos relacionar dados n√£o t√£o usuais. Recomendamos leitura artigo de Matejka & Fitzmaurice (2017) que apresenta armadilhas t√≠picas que dados podem gerar quando evitamos de visualiz√°-los previamente (Figura 6.38).\nFigura 6.38: Gr√°fico de dispers√£o relacionando vari√°veis x e y formando um dinossauro.\n","code":"\n## Gr√°fico de dispers√£o das coluna flipper_length_mm e bill_length_mm\nggplot(data = penguins, aes(x = comprimento_bico, y = comprimento_nadadeira)) +\n    geom_point()\n## Cor e tamanho dos pontos \nggplot(data = penguins, aes(x = comprimento_bico, y = comprimento_nadadeira)) +\n    geom_point(color = \"cyan4\", size = 4) + \n    labs(title = \"Sem transpar√™ncia\")\n\n## Cor, tamanho dos pontos e transpar√™ncia\nggplot(data = penguins, aes(x = comprimento_bico, y = comprimento_nadadeira)) +\n    geom_point(color = \"cyan4\", size = 4, alpha = .4) +\n    labs(title = \"Com transpar√™ncia\")\n## Formato e tamanho\nggplot(data = penguins, aes(x = comprimento_bico, y = comprimento_nadadeira)) +\n    geom_point(shape = 1, size = 4)\n\n## Formato e tamanho para esp√©cies\nggplot(data = penguins, aes(x = comprimento_bico, y = comprimento_nadadeira, color = especies)) +\n    geom_point(shape = 19, size = 4)\n\n## Formato e tamanho e cor\nggplot(data = penguins, aes(x = comprimento_bico, y = comprimento_nadadeira, fill = especies)) +\n    geom_point(shape = 21, size = 4, color = \"black\")\n## Linha de ajuste\nggplot(data = penguins, aes(x = comprimento_bico, y = comprimento_nadadeira)) +\n    geom_point(shape = 20, size = 4, color = \"black\") +\n    geom_smooth(method = lm)\n## Gr√°fico de dispers√£o exemplo\nggplot(data = penguins, aes(x = comprimento_bico, y = comprimento_nadadeira,\n                            color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .7) +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    scale_shape_manual(values = c(19, 15, 17)) +\n    scale_color_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw(base_size = 16) +\n    labs(x = \"Comprimento do bico (mm)\", y = \"Comprimento da nadadeira (mm)\", \n         color = \"Esp√©cies\", shape = \"Esp√©cies\")\n## Gr√°fico do dinossauro\ndatasaurus_dozen %>% \n    dplyr::filter(dataset == \"dino\") %>% \n    ggplot() +\n    aes(x = x, y = y) +\n    geom_point(colour = \"black\", fill = \"black\", \n               size = 4, alpha = .7, shape = 21) +\n    theme_bw() +\n    theme(axis.title = element_text(size = 24),\n          axis.text.x = element_text(size = 20),\n          axis.text.y = element_text(size = 20))"},{"path":"cap6.html","id":"visualiza√ß√£o-de-m√∫ltiplos-gr√°ficos-pareados","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.4.8 Visualiza√ß√£o de m√∫ltiplos gr√°ficos pareados","text":"Muitas vezes precisamos plotar rela√ß√£o de mais de uma vari√°vel, e muitas vezes essas vari√°veis s√£o de mais de um tipo (cont√≠nua, categ√≥rica, etc.). O gr√°fico mais indicado nesses casos √© o gr√°fico pareado (Emerson et al. 2013) que nos auxilia √† ter uma vis√£o geral conjunto de dados e de suas interrela√ß√µes. Esse gr√°fico tamb√©m √© chamado de pairs plot ou correlograma.Gr√°fico pareado com vari√°veis cont√≠nuasA fun√ß√£o ggpairs()pacote GGally permite criar m√∫ltiplos gr√°ficos pareados comparando vari√°veis cont√≠nuas seu conjunto de dados. Al√©m de demonstrar gr√°ficos de dispers√£o de cada par de vari√°veis, ela apresenta gr√°ficos de densidade de cada vari√°vel individualmente e, al√©m disso, os valores de correla√ß√£o entre os pares analisados com ou sem uma potencial vari√°vel categ√≥rica (neste caso, species) (Figura 6.39).\nFigura 6.39: Gr√°fico pareado relacionando v√°rias vari√°veis cont√≠nuas para esp√©cies de penguins.\nGr√°fico pareado com v√°rios tipos de vari√°veisComo alternativa, fun√ß√£o ggpairs() permite tamb√©m incluir vari√°veis categ√≥ricas nas compara√ß√µes. Neste caso, ela reconhece o tipo de gr√°fico (boxplot, dispers√£o, etc.) partir dos modos das vari√°veis (Figura 6.40).\nFigura 6.40: Gr√°fico pareado relacionando v√°rias vari√°veis cont√≠nuas e categ√≥ricas para esp√©cies de penguins.\n","code":"\n## Gr√°fico pareado com vari√°veis cont√≠nuas\npenguins %>%\n    dplyr::select(massa_corporal, comprimento_bico, profundidade_bico, comprimento_nadadeira) %>%\n    GGally::ggpairs(aes(color = penguins$especies)) +\n    scale_colour_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    scale_fill_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw()\n## Gr√°fico pareado com vari√°veis cont√≠nuas e categ√≥ricas\npenguins %>%\n    dplyr::select(especies, sexo, massa_corporal, comprimento_bico, profundidade_bico, comprimento_nadadeira) %>%\n    GGally::ggpairs(aes(color = especies)) +\n    scale_colour_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    scale_fill_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw()"},{"path":"cap6.html","id":"erros-comuns-dos-usu√°rios-do-ggplot2-e-como-evit√°-los","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.4.9 Erros comuns dos usu√°rios do ggplot2 e como evit√°-los","text":"Abaixo, apresentamos uma lista n√£o exaustiva dos erros mais comuns que cometemos (e vimos muitos usu√°rios cometerem) ao fazer gr√°ficos ggplot2.Utilizar ajuste manual nas fun√ß√µes scale_shape_manual(), scale_color_manual() ou scale_fill_manual() sem indicar argumento aes() vari√°veis que devem definir cada um desses elementos gr√°ficosUtilizar ajuste manual nas fun√ß√µes scale_shape_manual(), scale_color_manual() ou scale_fill_manual() sem indicar argumento aes() vari√°veis que devem definir cada um desses elementos gr√°ficosUtilizar ajuste manual na fun√ß√£o scale_size_manual() indicando uma vari√°vel categ√≥rica em vez de num√©ricaUtilizar ajuste manual na fun√ß√£o scale_size_manual() indicando uma vari√°vel categ√≥rica em vez de num√©ricaN√∫mero de cores indicadas como valores scale_fill_manual() ou scale_color_manual(): ao definir cores de maneira personalizada (ou seja, n√£o usando o padr√£o da fun√ß√£o) √© muito comum utilizarmos o n√∫mero de cores usados por algum tutorial ou livro. Com frequ√™ncia, o exemplo seguido e seus dados n√£o possuem o mesmo n√∫mero de cores dos nossos dados. Deste modo, voc√™ pode usar c√≥digos R para ajudar quantificar o n√∫mero de cores necess√°rias. Por exemplo, para os dados penguins, o c√≥digo seguir indica o n√∫mero de cores necess√°rias: length(levels(penguins\\$species)). Assim, ser√° necess√°rio indicar tr√™s cores diferentes dentro da fun√ß√£o scale_*().N√∫mero de cores indicadas como valores scale_fill_manual() ou scale_color_manual(): ao definir cores de maneira personalizada (ou seja, n√£o usando o padr√£o da fun√ß√£o) √© muito comum utilizarmos o n√∫mero de cores usados por algum tutorial ou livro. Com frequ√™ncia, o exemplo seguido e seus dados n√£o possuem o mesmo n√∫mero de cores dos nossos dados. Deste modo, voc√™ pode usar c√≥digos R para ajudar quantificar o n√∫mero de cores necess√°rias. Por exemplo, para os dados penguins, o c√≥digo seguir indica o n√∫mero de cores necess√°rias: length(levels(penguins\\$species)). Assim, ser√° necess√°rio indicar tr√™s cores diferentes dentro da fun√ß√£o scale_*().Fun√ß√£o geom_smooth(): como falado, fun√ß√£o geom_smooth() √© muito √∫til (e simples) para gerar linhas de ajuste (best fit) t√≠picas de modelos lineares e n√£o lineares. Por√©m, fique alerta ao usar, por exemplo, geom_smooth(method = lm), o modelo linear utilizado para testar sua predi√ß√£o foi o lm(). Se tiver utilizado glm()ou gam() o ajuste deve ser produzido partir desses modelos.Fun√ß√£o geom_smooth(): como falado, fun√ß√£o geom_smooth() √© muito √∫til (e simples) para gerar linhas de ajuste (best fit) t√≠picas de modelos lineares e n√£o lineares. Por√©m, fique alerta ao usar, por exemplo, geom_smooth(method = lm), o modelo linear utilizado para testar sua predi√ß√£o foi o lm(). Se tiver utilizado glm()ou gam() o ajuste deve ser produzido partir desses modelos.Uso incorreto modo das vari√°veis: neste caso, o usu√°rio utilizar uma vari√°vel num√©rica (por exemplo, 1, 2 e 3) como vari√°vel categ√≥rica. Neste caso, √© preciso transformar vari√°vel num√©rica em vari√°vel categ√≥ricas (antes de fazer o ggplot2 ou dentro aes()).Uso incorreto modo das vari√°veis: neste caso, o usu√°rio utilizar uma vari√°vel num√©rica (por exemplo, 1, 2 e 3) como vari√°vel categ√≥rica. Neste caso, √© preciso transformar vari√°vel num√©rica em vari√°vel categ√≥ricas (antes de fazer o ggplot2 ou dentro aes()).Veja exemplos (Figura 6.41).\nFigura 6.41: Gr√°ficos mostrando erros comuns na cria√ß√£o de gr√°ficos pacote ggplot2.\n","code":"\n## Figura incorreta, sem a transforma√ß√£o da vari√°vel ano\npenguins %>%\n    ggplot(aes(x = ano, y = comprimento_bico)) +\n    geom_boxplot() + \n    theme_bw() +\n    labs(title = \"Figura incorreta\")\n\n## Figura correta, com transforma√ß√£o interna da vari√°vel ano\npenguins %>%\n    ggplot(aes(x = factor(ano), y = comprimento_bico)) +\n    geom_boxplot() + \n    theme_bw() +\n    labs(title = \"Figura correta com transforma√ß√£o interna\")\n\n## Figura correta, com transforma√ß√£o pr√©via da vari√°vel ano\npenguins %>%\n    mutate(ano_f = as.factor(ano)) %>% \n    ggplot(aes(x = ano_f, y = comprimento_bico)) +\n    geom_boxplot() + \n    theme_bw() +\n    labs(title = \"Figura correta com transforma√ß√£o pr√©via\")"},{"path":"cap6.html","id":"finaliza√ß√£o-de-gr√°ficos-para-publica√ß√£o","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.5 Finaliza√ß√£o de gr√°ficos para publica√ß√£o","text":"","code":""},{"path":"cap6.html","id":"posi√ß√£o-cores-e-fonte-da-legenda","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.5.1 Posi√ß√£o, cores e fonte da legenda","text":"√â poss√≠vel controlar posi√ß√£o, cores e fonte da legenda em diversos locais com alguns argumentos dentro da fun√ß√£o theme():legend.position: controla posi√ß√£o na √°rea gr√°fico: top, right, bottom, left ou none. Al√©m disso, √© poss√≠vel inserir legenda internamento gr√°fico indicando posi√ß√µes nos eixos X e Ylegend.position: controla posi√ß√£o na √°rea gr√°fico: top, right, bottom, left ou none. Al√©m disso, √© poss√≠vel inserir legenda internamento gr√°fico indicando posi√ß√µes nos eixos X e Ylegend.box: determina caracter√≠sticas ret√¢ngulo onde legenda √© inserida: legend.box.background (combinado com element_rect()) e legend.box.margin (combinado com margin())legend.box: determina caracter√≠sticas ret√¢ngulo onde legenda √© inserida: legend.box.background (combinado com element_rect()) e legend.box.margin (combinado com margin())legend.text: controla cor e tamanho da legenda (duas informa√ß√µes devem ser inseridas dentro da fun√ß√£o element_text())legend.text: controla cor e tamanho da legenda (duas informa√ß√µes devem ser inseridas dentro da fun√ß√£o element_text())legend.title: personaliza cor e tamanho da legenda tamb√©m dentro da fun√ß√£o element_text()legend.title: personaliza cor e tamanho da legenda tamb√©m dentro da fun√ß√£o element_text()Vejamos alguns exemplos (Figura 6.42).\nFigura 6.42: Gr√°ficos mostrando finaliza√ß√£o de gr√°ficos para publica√ß√£o em rela√ß√£o √† posi√ß√£o, cores e fonte da legenda pacote ggplot2.\n","code":"\n## Legenda acima\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .7) +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    scale_shape_manual(values = c(19, 15, 17)) +\n    scale_color_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw(base_size = 14) +\n    theme(legend.position = \"top\") +\n    labs(title = \"Legenda acima do gr√°fico\", x = \"Comprimento do bico (mm)\", \n         y = \"Profundidade do bico (mm)\", color = \"Esp√©cies\", shape = \"Esp√©cies\")\n\n## Leganda abaixo\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .7) +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    scale_shape_manual(values = c(19, 15, 17)) +\n    scale_color_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw(base_size = 14) +\n    theme(legend.position = \"bottom\") +\n    labs(title = \"Legenda abaixo do gr√°fico\", x = \"Comprimento do bico (mm)\", \n         y = \"Profundidade do bico (mm)\", color = \"Esp√©cies\", shape = \"Esp√©cies\")\n\n## Sem legenda\nggplot(data = penguins, \n       aes(x = comprimento_bico,  y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .7) +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    scale_shape_manual(values = c(19, 15, 17)) +\n    scale_color_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw(base_size = 14) +\n    theme(legend.position = \"none\") +\n    labs(title = \"Sem legenda\", x = \"Comprimento do bico (mm)\", \n         y = \"Profundidade do bico (mm)\", color = \"Esp√©cies\", shape = \"Esp√©cies\")\n\n## Legenda personalizada\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .7) +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    scale_shape_manual(values = c(19, 15, 17)) +\n    scale_color_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw(base_size = 14) +\n    theme(legend.position = \"right\",\n          legend.text = element_text(size = 14, colour = \"red\"),\n          legend.title = element_text(face = \"bold\"),\n          legend.box.background = element_rect(color=\"red\", size=2),\n          legend.margin = margin(6, 6, 6, 6)) +\n    labs(title = \"Legenda personalizada\", x = \"Comprimento do bico (mm)\", \n         y = \"Profundidade do bico (mm)\", color = \"Esp√©cies\", shape = \"Esp√©cies\")\n\n## Legenda interna\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .7) +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    scale_shape_manual(values = c(19, 15, 17)) +\n    scale_color_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw(base_size = 16) +\n    theme(legend.position = c(.2, .8),\n          legend.title = element_blank(),\n          legend.key =  element_blank(),\n          legend.background = element_blank(),\n          legend.text = element_text(size = 12, face = \"bold\")) +\n    labs(title = \"Legenda interna\", x = \"Comprimento do bico (mm)\", \n         y = \"Profundidade do bico (mm)\", color = \"Esp√©cies\", shape = \"Esp√©cies\")"},{"path":"cap6.html","id":"elementos-gr√°ficos-eixo-fonte-gride","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.5.2 Elementos gr√°ficos: eixo, fonte, gride","text":"O gr√°fico padronizado (sem edi√ß√£o extra) geralmente n√£o traz elementos m√≠nimos para publica√ß√£o em revistas, livros ou peri√≥dicos. Al√©m controle da posi√ß√£o, cor e tamanho da legenda, √© fundamental personalizar os seguintes elementos: eixo, fonte e gride.EixosVaria√ß√£o: define limites m√≠nimos e m√°ximos para os eixos X (xlim()) e Y (ylim())Intervalo: define o valor intervalo entre os n√∫meros dos eixos X e YVejamos mais alguns exemplos (Figura 6.43).\nFigura 6.43: Gr√°ficos mostrando finaliza√ß√£o de gr√°ficos para publica√ß√£o em rela√ß√£o aos elementos gr√°ficos de eixo, fonte, gride pacote ggplot2.\nFonte dos eixos X e YTipoTamanhoCorFace (it√°lico, negrito, etc.)√ÇnguloVejamos outros exemplos com mudan√ßas nos eixos (Figura 6.44).\nFigura 6.44: Gr√°ficos mostrando finaliza√ß√£o de gr√°ficos para publica√ß√£o em rela√ß√£o aos eixos pacote ggplot2.\nGrideLinhas de grade principais (panel.grid.major)Linhas de grade secund√°rias (panel.grid.minor)Borda gr√°fico (panel.border)Vejamos outros exemplos com mudan√ßas ao gride (Figura 6.45).\nFigura 6.45: Gr√°ficos mostrando finaliza√ß√£o de gr√°ficos para publica√ß√£o em rela√ß√£o ao gride pacote ggplot2.\n","code":"\n## Nome dos eixos\nggplot(data = penguins,  \n       aes(x = comprimento_bico, y = comprimento_nadadeira, \n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .4) +\n    ylim(170, 230) +\n    xlim(30, 60) +\n    labs(title = \"Nome dos eixos\", x = \"Eixo X\", y = \"Eixo Y\")\n\n## Intervalo dos eixos\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .4) +\n    scale_x_continuous(limits = c(30, 60), breaks = seq(30, 60, 2)) +\n    labs(title = \"Intervalo dos eixos\", x = \"Eixo X\", y = \"Eixo Y\")\n## Cor e fonte dos eixos\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .4) +\n    theme(axis.title.x = element_text(face = \"bold\", size = 20, colour = \"cyan4\"),\n          axis.text.x = element_text(size = 14),\n          axis.title.y = element_text(face = \"bold\", size = 20, colour = \"cyan4\"),\n          axis.text.y = element_text(size = 14)) +\n    labs(title = \"Cor e fonte dos eixos\", x = \"Eixo X\", y = \"Eixo Y\")\n\n## Intervalo e √¢ngulos do texto dos eixos\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .4) +\n    scale_x_continuous(limits = c(20, 60), breaks = seq(20, 60, 2)) +\n    theme(axis.title.x = element_text(face = \"bold\", size = 20, colour = \"cyan4\"),\n          axis.text.x = element_text(size = 14, angle = 45),\n          axis.title.y = element_text(face = \"bold\", size = 20, colour = \"cyan4\"),\n          axis.text.y = element_text(size = 14)) +\n    labs(title = \"Intervalo e √¢ngulos do texto dos eixos\", x = \"Eixo X\", y = \"Eixo Y\")\n## Linhas de grade principais\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .4) +\n    scale_x_continuous(limits = c(30, 60), breaks = seq(30, 60, 5)) +\n    theme(axis.title.x = element_text(face = \"bold\", size = 16),\n          axis.text.x = element_text(size = 12),\n          axis.title.y = element_text(face = \"bold\", size = 16),\n          axis.text.y = element_text(size = 12),\n          panel.grid.minor = element_blank()) +\n    labs(title = \"Linhas de grade principais\", x = \"Eixo X\", y = \"Eixo Y\")\n\n## Retirar linhas de grade\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .4) +\n    scale_x_continuous(limits = c(30, 60), breaks = seq(30, 60, 5)) +\n    theme(axis.title.x = element_text(face = \"bold\", size = 16),\n          axis.text.x = element_text(size = 12),\n          axis.title.y = element_text(face = \"bold\", size = 16),\n          axis.text.y = element_text(size = 12),\n          panel.grid.minor = element_blank(),\n          panel.grid.major = element_blank()) +\n    labs(title = \"Retirar linhas de grade\", x = \"Eixo X\", y = \"Eixo Y\")\n\n## Borda do gr√°fico\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = 0.5) +\n    scale_x_continuous(limits = c(30, 60), breaks = seq(30, 60, 5)) +\n    theme(axis.title.x = element_text(face = \"bold\", size = 16),\n          axis.text.x = element_text(size = 12),\n          axis.title.y = element_text(face = \"bold\", size = 16),\n          axis.text.y = element_text(size = 12),\n          panel.grid.minor = element_blank(),\n          panel.grid.major = element_blank(),\n          panel.border = element_rect(size = 2, colour = \"black\", fill = NA)) +\n    labs(title = \"Borda do gr√°fico\", x = \"Eixo X\", y = \"Eixo Y\")\n\n## Borda do gr√°fico\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .4) +\n    scale_x_continuous(limits = c(30, 60), breaks = seq(30, 60, 5)) +\n    theme(axis.title.x = element_text(face = \"bold\", size = 16),\n          axis.text.x = element_text(size = 12),\n          axis.title.y = element_text(face = \"bold\", size = 16),\n          axis.text.y = element_text(size = 12),\n          panel.grid.minor = element_blank(),\n          panel.grid.major = element_blank(),\n          axis.line = element_line(size = 1)) +\n    labs(title = \"Borda do gr√°fico\", x = \"Eixo X\", y = \"Eixo Y\")"},{"path":"cap6.html","id":"temas-personalizados-ggtheme","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.5.3 Temas personalizados ggtheme()","text":"Existem v√°rios temas criados dentro universo ggtheme() que podem facilitar escolha de um modelo com √≥tima qualidade para publica√ß√£o. Abaixo, demonstramos os modelos mais utilizados (Figura 6.46).\nFigura 6.46: Gr√°ficos mostrando finaliza√ß√£o de gr√°ficos para publica√ß√£o em rela√ß√£o ao ggtheme() pacote ggplot2.\n","code":"\n## theme_gray\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .7) +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    scale_shape_manual(values = c(19, 15, 17)) +\n    scale_color_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_gray(base_size = 16) +\n    labs(title = \"theme_gray()\", x = \"Comprimento do bico (mm)\", \n         y = \"Profundidade do bico (mm)\", color = \"Esp√©cies\", shape = \"Esp√©cies\") \n## theme_bw()\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .7) +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    scale_shape_manual(values = c(19, 15, 17)) +\n    scale_color_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_bw(base_size = 16) +\n    labs(title = \"theme_bw()\", x = \"Comprimento do bico (mm)\",\n         y = \"Profundidade do bico (mm)\", color = \"Esp√©cies\", shape = \"Esp√©cies\") \n## theme_classic()\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .7) +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    scale_shape_manual(values = c(19, 15, 17)) +\n    scale_color_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme_classic(base_size = 16) +\n    labs(title = \"theme_classic()\", x = \"Comprimento do bico (mm)\", \n         y = \"Profundidade do bico (mm)\", color = \"Esp√©cies\", shape = \"Esp√©cies\")"},{"path":"cap6.html","id":"criando-seu-pr√≥prio-theme_custom","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.5.4 Criando seu pr√≥prio theme_custom()","text":"Por fim, √© poss√≠vel criar um tema personalizado como uma fun√ß√£o. Assim, o usu√°rio pode controlar todos os elementos gr√°ficos em um √∫nico c√≥digo. O maior benef√≠cio de personalizar uma fun√ß√£o √© que n√£o ser√° necess√°rio fazer os ajustes finos em todos os gr√°ficos que tiver construindo, o que pode representar grande economia de tempo e linhas de c√≥digo (Figura 6.47).\nFigura 6.47: Gr√°ficos mostrando finaliza√ß√£o de gr√°ficos para publica√ß√£o em rela√ß√£o √† cria√ß√£o de um tema usando o theme_custom() pacote ggplot2.\n","code":"\n## Criar uma fun√ß√£o com os ajustes finos\ntema_personalizado <- function(){\n    \n    # Defina uma fonte\n    font <- \"Times\" # Digite names(pdfFonts()) no console do R para ver a lista de fontes dispon√≠veis\n    \n    theme(\n        \n        # Defina elementos do gride\n        panel.grid.major = element_line(colour = \"#d3d3d3\"),  \n        panel.grid.minor = element_blank(),\n        axis.ticks = element_blank(), \n        panel.border = element_rect(colour = \"black\", fill = NA, size = .5),\n        \n        # Defina elementos textuais\n        # T√≠tulo\n        plot.title = element_text(             \n            family = font,            # Fonte\n            size = 20,                # Tamanho da fonte\n            face = 'bold',            # Tipo de fonte\n            hjust = 0,                # Alinhamento horizontal\n            vjust = 2),               # Alinhamento vertical\n        \n        # Subt√≠tulo\n        plot.subtitle = element_text(          \n            family = font,            # Fonte\n            size = 14),               # Tamanho da fonte\n        \n        # R√∫brica\n        plot.caption = element_text(           \n            family = font,            # Fonte\n            size = 10,                # Tamanho da fonte\n            hjust = 1),               # Alinhamento horizontal\n        \n        # T√≠tulo dos eixos\n        axis.title = element_text(             \n            family = font,            # Fonte\n            size = 14),               # Tamanho da fonte\n        \n        # Texto dos eixos\n        axis.text = element_text(              \n            family = font,            # Fonte\n            size = 14)              # Tamanho da fonte\n        \n    )}\n\n## Gr√°fico usando a fun√ß√£o de tema criada\nggplot(data = penguins, \n       aes(x = comprimento_bico, y = comprimento_nadadeira,\n           color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .7) +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    scale_shape_manual(values = c(19, 15, 17)) +\n    scale_color_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    tema_personalizado() +\n    labs(title = \"Tema personalizado\", x = \"Comprimento do bico (mm)\", \n         y = \"Profundidade do bico (mm)\", color = \"Esp√©cies\", \n         shape = \"Esp√©cies\", caption = \"Fonte = palmerpinguins\")"},{"path":"cap6.html","id":"exportando-dados-com-alta-qualidade-com-a-fun√ß√£o-ggsave","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.5.5 Exportando dados com alta qualidade com a fun√ß√£o ggsave()","text":"O √∫ltimo passo para construir gr√°ficos com qualidade de publica√ß√£o √© exportar em um formato espec√≠fico, como .png, .pdf ou .svg (entre outros). fun√ß√£o ggsave() n√£o s√≥ permite que voc√™ tenha o controle sobre o formato, mas tamb√©m sobre qualidade e tamanho desejados com os seguintes argumentos:width: largura gr√°ficoheight: altura gr√°ficounits: unidade de medida (cm, mm) gr√°fico para definir largura e tamanhodpi: resolu√ß√£o ou qualidade da imagem, medida em pontos por polegada (dots per inch) (padr√£o = 300)Vejamos um √∫ltimo exemplo (Figura 6.48).\nFigura 6.48: Gr√°fico criado para exporta√ß√£o pacote ggplot2.\nPodemos exportar esse gr√°fico de diferentes formas.","code":"\n## Gr√°fico\ng1 <- ggplot(data = penguins, \n             aes(x = comprimento_bico, y = comprimento_nadadeira,\n                 color = especies, shape = especies)) +\n    geom_point(size = 4, alpha = .7) +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    scale_shape_manual(values = c(19, 15, 17)) +\n    scale_color_manual(values = c(\"darkorange\", \"purple\", \"cyan4\")) +\n    theme(legend.position = c(.1, .1),\n          legend.title = element_blank(),\n          legend.key =  element_blank(),\n          legend.background = element_blank()) +\n    tema_personalizado() +\n    labs(x = \"Comprimento do bico (mm)\", y = \"Profundidade do bico (mm)\", \n         color = \"Esp√©cies\", shape = \"Esp√©cies\")\ng1\n## Exportar no formato PDF\nggsave(filename = \"g1.pdf\", \n       plot = g1, \n       width = 15, \n       height = 15, \n       dpi =300,\n       units = \"cm\")\n\n## Exportar no formato PNG\nggsave(filename = \"g1.png\", \n       plot = g1, \n       width = 15, \n       height = 15, \n       dpi =300,\n       units = \"cm\")\n\n## Exportar no formato SVG\nggsave(filename = \"g1.svg\", \n       plot = g1, \n       width = 15, \n       height = 15, \n       dpi =300,\n       units = \"cm\")"},{"path":"cap6.html","id":"para-se-aprofundar-2","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.6 Para se aprofundar","text":"Listamos seguir livros e links que recomendamos para seguir com sua aprendizagem em R e gr√°ficos.","code":""},{"path":"cap6.html","id":"livros-2","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.6.1 Livros","text":"Recomendamos aos interessados os livros: ) Chang (2018) R Graphics Cookbook, ii) Healy (2018) Data Visualization: practical introduction, iii) Rahlf (2019) Data Visualisation R: 111 Examples, iv) Sievert (2020) Interactive web-based data visualization R, plotly, shiny, v) Wickham (2016) ggplot2: elegant graphics data analysis, vi) Wilke (2019) Fundamentals Data Visualization, vii) Wilkinson e colaboradores (2005) Grammar Graphics.","code":""},{"path":"cap6.html","id":"links-3","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.6.2 Links","text":"Existem centenas de ferramentas online para aprender visualiza√ß√£o de dados e ggplot2. Tais ferramentas s√£o bastante variadas, incluindo desde escolha de tipos de gr√°ficos √† sele√ß√£o de cores. Dentre elas, indicamos os seguintes links em ingl√™s:Visualiza√ß√£o\n- Data Visualization R - Rob Kabacoff\n- Data Visualisation Catalogue\n- R Graph Gallery\n- Data Viz\n- Data Viz Project\n- QuickChart\n- Chart.js\n- drawdata.xyzSele√ß√£o de cores (paletas)\n- Color Brewer: color advice\n- Wes Anderson Palletes\n- Choosing colors data visualization","code":""},{"path":"cap6.html","id":"exerc√≠cios-2","chapter":"Cap√≠tulo 6 Visualiza√ß√£o de dados","heading":"6.7 Exerc√≠cios","text":"6.1\nUtilizando o banco de dados penguins compare o comprimento bico entre diferentes esp√©cies de penguins. Utilize um gr√°fico de caixa (boxplot) para ilustrar varia√ß√£o intraespec√≠fica e poss√≠veis outliers nos dados. Para melhorar o seu gr√°fico, lembre-se de nomear os dois eixos corretamente, definir um tema e posicionar legenda.6.2\nUtilizando o banco de dados penguins fa√ßa um histograma com distribui√ß√£o da massa corporal para cada uma das esp√©cies. Utilize uma cor de preenchimento para cada esp√©cie.6.3\nUtilizando o banco de dados penguins, fa√ßa tr√™s gr√°ficos com o mesmo eixo Y e eixo X. Coloque o comprimento das nadadeiras eixo Y e esp√©cies de pinguins eixo X. primeiro gr√°fico, utilize o geom_jitter() para plotar os dados brutos. segundo gr√°fico, utilize o geom_violin() para mostrar distribui√ß√£o de densidade dos dados. terceiro gr√°fico, utilize o geom_boxplot() para destacar mediana e os quartis.6.4\nSe voc√™ conseguiu resolver o exerc√≠cio 6.3, agora d√™ um passo mais e compare os tr√™s gr√°ficos lado lado utilizando fun√ß√£o grid.arrange(). Lembre-se de colocar um t√≠tulo informativo em cada um dos gr√°ficos antes de junt√°-los em uma prancha √∫nica. Ao comparar os tr√™s tipos de gr√°ficos, qual voc√™ considera mais informativo? Experimente combinar mais de um ‚Äúgeom‚Äù (camadas) e produzir gr√°ficos ainda mais interessantes.6.5\nUtilize o conjunto de dados ecodados::anova_dois_fatores para construir um gr√°fico de barras com m√©dia e o erro padr√£o Tempo (Tempo para eliminar droga corpo) eixo Y em fun√ß√£o da vari√°vel Pessoas (XX, ou XY) e Idade (jovem ou idoso). Antes de fazer o gr√°fico leia com aten√ß√£o descri√ß√£o mesmo atrav√©s comando ?ecodados::anova_dois_fatores. Uma dica, utilize fill dentro aes() para representar um dos fatores (ex. Pessoas). O outro fator voc√™ pode representar eixo X. Veja se consegue, se n√£o conseguir pode olhar cola com solu√ß√£o para aprender como √© feito. Outra dica, pesquise sobre fun√ß√£o stat_summary() ela ir√° te ajudar calcular m√©dia e o erro padr√£o dentro comando que gera o gr√°fico.6.6\nUtilize o banco de dados penguins para criar um gr√°fico de dispers√£o entre o tamanho da nadadeira (eixo Y) e massa corporal (eixo X). Utilize o argumento fill para ilustrar com cores diferen√ßas entre os sexos e utilize fun√ß√£o facte_grid() para criar um gr√°fico separado para cada esp√©cie de pinguim. Se voc√™ n√£o conhece essa fun√ß√£o, d√™ uma olhada help ?facet_grid(). Voc√™ tamb√©m pode utilizar fun√ß√£o drop_na() para excluir os dados faltantes da coluna sexo.Solu√ß√µes dos exerc√≠cios.","code":""},{"path":"cap7.html","id":"cap7","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"Cap√≠tulo 7 Modelos lineares","text":"","code":""},{"path":"cap7.html","id":"pr√©-requisitos-do-cap√≠tulo-3","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"Pr√©-requisitos do cap√≠tulo","text":"Pacotes e dados que ser√£o utilizados neste cap√≠tulo. üìù Importante \nEstat√≠sticas frequentistas como que ser√£o abordadas neste cap√≠tulo s√£o baseadas em testes estat√≠sticos (e.g., F, t, ùõò2, etc.), que s√£o resultados n√∫mericos teste e possuem um valor de probabilidade (valor de P) associado com este teste (Gotelli Ellison 2012). O valor de P mede probabilidade que os valores observados ou mais extremos seriam encontrados caso hip√≥tese nula seja verdadeira (veja Cap√≠tulo 2). Ao longo livro usaremos o crit√©rio convencional de rejeitar hip√≥tese nula quando P < 0.05. Contudo, sugerimos leitura destes artigos (White et al. 2014; Barber Ogle 2014; K. P. Burnham Anderson 2014; Murtaugh 2014; Halsey 2019; Muff et al. 2021) que discutem limita√ß√µes e problemas associados ao valor de P.","code":"\n## Pacotes\nlibrary(ecodados)\nlibrary(car)\nlibrary(ggpubr)\nlibrary(ggforce)\nlibrary(lsmeans)\nlibrary(lmtest)\nlibrary(sjPlot)\nlibrary(nlme)\nlibrary(ape)\nlibrary(fields)\nlibrary(tidyverse)\nlibrary(vegan)\nlibrary(rdist)\n\n## Dados\nCRC_PN_macho <- ecodados::teste_t_var_igual\nCRC_LP_femea <- ecodados::teste_t_var_diferente\nPareado <- ecodados::teste_t_pareado\ncorrelacao_arbustos <- ecodados::correlacao\ndados_regressao <- ecodados::regressoes\ndados_regressao_mul <- ecodados::regressoes\ndados_anova_simples <- ecodados::anova_simples\ndados_dois_fatores <- ecodados::anova_dois_fatores\ndados_dois_fatores_interacao <- ecodados::anova_dois_fatores\ndados_dois_fatores_interacao2 <- ecodados::anova_dois_fatores_interacao2\ndados_bloco <- ecodados::anova_bloco\ndados_ancova <- ecodados::ancova\ndata(\"mite\")\ndata(\"mite.xy\")\ncoords <- mite.xy\ncolnames(coords) <- c(\"long\", \"lat\")\ndata(\"mite.env\")"},{"path":"cap7.html","id":"teste-t-de-student-para-duas-amostras-independentes","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.1 Teste T (de Student) para duas amostras independentes","text":"Uma das perguntas mais comuns em estat√≠stica √© saber se h√° diferen√ßa entre m√©dias de dois grupos ou tratamentos. Para responder esta pergunta, William Sealy Gosset, qu√≠mico da cervejaria Guinness, desenvolveu em 1908 o Teste T que √© uma est√°tistica que segue uma distribui√ß√£o t de Student para rejeitar ou n√£o uma hip√≥tese nula de m√©dias iguais entre dois grupos.\\[t = \\frac{(\\bar{X}_1 - \\bar{X}_2)}{\\sqrt{\\frac{2S^2_p}{n}}}\\]Onde:\\(\\bar{X}\\)1 - \\(\\bar{X}\\)2 = diferen√ßa entre m√©dias de duas amostrasS2p = desvio padr√£o das amostrasn = tamanho das amostrasPremissas Teste tAs amostras devem ser independentesAs unidades amostrais s√£o selecionadas aleatoriamenteDistribui√ß√£o normal (gaussiana) dos res√≠duos.Homogeneidade da vari√¢ncia. üìù Importante Zar (2010) indica que o Teste T √© robusto mesmo com moderada viola√ß√£o da normalidade, principalmente se o tamanho amostral alto.Zar (2010) indica que o Teste T √© robusto mesmo com moderada viola√ß√£o da normalidade, principalmente se o tamanho amostral alto.Caso vari√¢ncias n√£o sejam homog√™neas, isso deve ser informado na linha de comando, pois o denominador da f√≥rmula acima ser√° corrigido.Caso vari√¢ncias n√£o sejam homog√™neas, isso deve ser informado na linha de comando, pois o denominador da f√≥rmula acima ser√° corrigido.Avalia√ß√£o das premissasUma das maneiras de avaliarmos premissas de normalidade e homogeneidade da vari√¢ncia relacionadas √†s an√°lises teste T, ANOVA e regress√µes lineares simples e m√∫ltiplas √© o uso da inspe√ß√£o gr√°fica da distribui√ß√£o dos res√≠duos (Figura 7.1) (. F. Zuur, Ieno, Elphick 2010).homegeneidade da vari√¢ncia utiliza um gr√°fico dos res√≠duos (eixo X) pelos valores preditos da vari√°vel resposta (eixo Y) (Figura 7.1A). distribui√ß√£o dos res√≠duos ser√° homog√™nea se n√£o observarmos nenhum padr√£o na distribui√ß√£o dos pontos (.e.¬†forma em V, U ou funil).homegeneidade da vari√¢ncia utiliza um gr√°fico dos res√≠duos (eixo X) pelos valores preditos da vari√°vel resposta (eixo Y) (Figura 7.1A). distribui√ß√£o dos res√≠duos ser√° homog√™nea se n√£o observarmos nenhum padr√£o na distribui√ß√£o dos pontos (.e.¬†forma em V, U ou funil).normalidade dos res√≠duos utiliza um gr√°fico de quantis-quantis (QQ-plots). distribui√ß√£o dos res√≠duos ser√° normal se os pontos estiverem pr√≥ximos √† reta (Figura 7.1B).normalidade dos res√≠duos utiliza um gr√°fico de quantis-quantis (QQ-plots). distribui√ß√£o dos res√≠duos ser√° normal se os pontos estiverem pr√≥ximos √† reta (Figura 7.1B).\nFigura 7.1: Inspe√ß√£o gr√°fica da homogeneidade da vari√¢ncia () e normalidade dos res√≠duos (B). Os s√≠mbolos verdes indicam que os gr√°ficos em que os res√≠duos apresentam distribui√ß√£o homog√™nea e normal, enquanto os s√≠mbolos vermelhos indicam os gr√°ficos em que os res√≠duos violam premissas teste.\nExemplo pr√°tico 1 - Teste T para duas amostras com vari√¢ncias iguaisExplica√ß√£o dos dadosNeste exemplo, avaliaremos o comprimento rostro-cloacal (CRC em mil√≠metros) de machos de Physalaemus nattereri (Anura:Leptodactylidae) amostrados em diferentes esta√ß√µes ano com armadilhas de intercepta√ß√£o e queda na Regi√£o Noroeste Estado de S√£o Paulo (da Silva Rossa-Feres 2010).PerguntaO CRC dos machos de P. nattereri √© maior na esta√ß√£o chuvosa que na esta√ß√£o seca?Predi√ß√µesO CRC dos machos ser√° maior na esta√ß√£o chuvosa porque h√° uma vantangem seletiva para os indiv√≠duos maiores durante atividade reprodutivaVari√°veisVari√°veis resposta e preditorasVari√°veis resposta e preditorasData frame com os indiv√≠duos (unidade amostral) nas linhas e CRC (mm - vari√°vel resposta cont√≠nua) e esta√ß√£o (vari√°vel preditora categ√≥rica) como colunasData frame com os indiv√≠duos (unidade amostral) nas linhas e CRC (mm - vari√°vel resposta cont√≠nua) e esta√ß√£o (vari√°vel preditora categ√≥rica) como colunasChecklistVerificar se o seu data frame est√° com unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunasAn√°liseVamos olhar os dados usando fun√ß√£o head().Vamos verificar normalidade dos res√≠duos usando o QQ-plot (Figura 7.2).\nFigura 7.2: Normalidade dos res√≠duos usando o QQ-plot.\nOs pontos est√£o pr√≥ximos √† reta, indicando que distribui√ß√£o dos res√≠duos √© normal (7.1).Outra possibilidade √© usar os testes de Shapiro-Wilk e Levene para verificar normalidade e homogeneidade da vari√¢ncia, respectivamente. üìù Importante \nHip√≥tese Nula (H0) destes testes √© que distribui√ß√£o √© normal ou homog√™nea:Valor de p < 0.05 significa que os dados n√£o apresentam distribui√ß√£o normal ou homog√™neaValor de p > 0.05 significa que os dados apresentam distribui√ß√£o normal ou homog√™neaTeste de Shapiro-Wilk para normalidade dos res√≠duos.Teste de Levene para homogeneidade de vari√¢ncia dos res√≠duos.Percebam que distribui√ß√£o dos res√≠duos foi normal e homog√™nea na inspe√ß√£o gr√°fica, assim como nos testes de Shapiro e Levene, respectivamente. Agora podemos realizar an√°lise sabendo que os dados seguem premissas requeridas pelo Teste T.Vamos para os c√≥digos da an√°lise Teste T para amostragens indenpendentes e vari√¢ncias iguais.Quatro valores devem ser apresentados ao leitores: ) estat√≠stica teste - representada por t = 4,15, ii) valor de signific√¢ncia - representado por p-value = 0,0001, iii) graus de liberdade - representado por df = 49, e iv) diferen√ßa entre m√©dias. Veja abaixo como descrever os resultados seu trabalho.Visualizar os resultados em gr√°fico (Figura 7.3).\nFigura 7.3: Boxplot da an√°lise Teste T para duas amostras com vari√¢ncias iguais.\nInterpreta√ß√£o dos resultadosNeste exemplo, rejeitamos hip√≥tese nula de que m√©dias CRC dos machos entre esta√ß√µes seca e chuvosa s√£o iguais. Os resultados mostram que os machos de P. nattereri coletados na esta√ß√£o chuvosa foram em m√©dia 0,43 mm maiores que os machos coletados na esta√ß√£o seca (t49 = 4,15, P < 0,001).Exemplo pr√°tico 2 - Teste T para duas amostras independentes com vari√¢ncias diferentesExplica√ß√£o dos dadosNeste exemplo, avaliaremos o comprimento rostro-cloacal (CRC - mil√≠metros) de f√™meas de Leptodactylus podicipinus amostradas em diferentes esta√ß√µes ano com armadilhas de intercepta√ß√£o e queda na Regi√£o Noroeste Estado de S√£o Paulo (da Silva Rossa-Feres 2010). üìù Importante \nOs dados foram alterados em rela√ß√£o publica√ß√£o original para se enquadrarem exemplo de amostras com vari√¢ncias diferentes.PerguntaO CRC das f√™meas de L. podicipinus √© maior na esta√ß√£o chuvosa que na esta√ß√£o seca?Predi√ß√µesO CRC das f√™meas ser√° maior na esta√ß√£o chuvosa porque h√° uma vantangem seletiva para os indiv√≠duos maiores durante atividade reprodutivaVari√°veisVari√°veis resposta e preditorasVari√°veis resposta e preditorasData frame com os indiv√≠duos (unidade amostral) nas linhas e CRC (mm - vari√°vel resposta cont√≠nua) e esta√ß√£o (vari√°vel preditora categ√≥rica) como colunasData frame com os indiv√≠duos (unidade amostral) nas linhas e CRC (mm - vari√°vel resposta cont√≠nua) e esta√ß√£o (vari√°vel preditora categ√≥rica) como colunasChecklistVerificar se o seu data frame est√° com unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunasAn√°liseOlhar os dados usando fun√ß√£o head().Vamos avaliar premissas teste. Comen√ßando com o teste de normalidade (Figura 7.4).\nFigura 7.4: Normalidade dos res√≠duos usando o QQ-plot.\nOs res√≠duos apresentam distribui√ß√£o normal. Vamos testar tamb√©m com o Shapiro-Wilk para normalidade dos res√≠duos.Agora vamos avaliar homogeneidade da vari√¢ncia.Os res√≠duos n√£o apresentam homogeneidade da vari√¢ncia. Portanto, vamos realizar o Teste T com vari√¢ncias diferentes. Para isso, use o argumento var.equal = FALSE.Neste exemplo, n√£o rejeitamos hip√≥tese nula e consideramos que m√©dias CRC das f√™meas entre esta√ß√µes seca e chuvosa s√£o iguais (t6,49 = 1,76, P = 0,12).Vamos visualizar os resultados em um gr√°fico (Figura 7.5).\nFigura 7.5: Boxplot da an√°lise Teste T para duas amostras independentes com vari√¢ncias diferentes.\nInterpreta√ß√£o dos resultadosOs resultados mostram que f√™meas de L. podicipinus coletadas na esta√ß√£o chuvosa n√£o s√£o maiores que f√™meas coletadas na esta√ß√£o seca, apesar de possuirem maior vari√¢ncia, o que pode ser biologicamente interessante.","code":"\n## Cabe√ßalho dos dados\nhead(CRC_PN_macho) \n#>    CRC Estacao\n#> 1 3.82 Chuvosa\n#> 2 3.57 Chuvosa\n#> 3 3.67 Chuvosa\n#> 4 3.72 Chuvosa\n#> 5 3.75 Chuvosa\n#> 6 3.83 Chuvosa\n## Teste de normalidade\nresiduos <- lm(CRC ~ Estacao, data = CRC_PN_macho)\nqqPlot(residuos)\n#> [1] 22 26\n## Teste de Shapiro-Wilk\nresiduos_modelo <- residuals(residuos)\nshapiro.test(residuos_modelo)\n#> \n#>  Shapiro-Wilk normality test\n#> \n#> data:  residuos_modelo\n#> W = 0.98307, p-value = 0.6746\n## Teste de homogeneidade de vari√¢ncia\nleveneTest(CRC ~ as.factor(Estacao), data = CRC_PN_macho)\n#> Levene's Test for Homogeneity of Variance (center = median)\n#>       Df F value Pr(>F)\n#> group  1  1.1677 0.2852\n#>       49\n## An√°lise Teste T \nt.test(CRC ~ Estacao, data = CRC_PN_macho, var.equal = TRUE)\n#> \n#>  Two Sample t-test\n#> \n#> data:  CRC by Estacao\n#> t = 4.1524, df = 49, p-value = 0.000131\n#> alternative hypothesis: true difference in means between group Chuvosa and group Seca is not equal to 0\n#> 95 percent confidence interval:\n#>  0.2242132 0.6447619\n#> sample estimates:\n#> mean in group Chuvosa    mean in group Seca \n#>              3.695357              3.260870\n## Gr√°fico\nggplot(data = CRC_PN_macho, aes(x = Estacao, y = CRC, color = Estacao)) + \n    labs(x = \"Esta√ß√µes\", \n         y = expression(paste(\"CRC (mm) - \", italic(\"P. nattereri\")))) +\n    geom_boxplot(fill = c(\"darkorange\", \"cyan4\"), color = \"black\", \n                 outlier.shape = NA) +\n    geom_jitter(shape = 16, position = position_jitter(0.1), \n                cex = 5, alpha = 0.7) +\n    scale_color_manual(values = c(\"black\", \"black\")) +\n    tema_livro() +\n    theme(legend.position = \"none\")\n## Cabe√ßalho dos dados\nhead(CRC_LP_femea) \n#>    CRC Estacao\n#> 1 2.72 Chuvosa\n#> 2 2.10 Chuvosa\n#> 3 3.42 Chuvosa\n#> 4 1.50 Chuvosa\n#> 5 3.90 Chuvosa\n#> 6 4.00 Chuvosa\n## Teste de normalidade usando QQ-plot\nresiduos_LP <- lm(CRC ~ Estacao, data = CRC_LP_femea)\nqqPlot(residuos_LP)\n#> [1] 4 6\n## Teste de Shapiro-Wilk\nresiduos_modelo_LP <- residuals(residuos_LP)\nshapiro.test(residuos_modelo_LP)\n#> \n#>  Shapiro-Wilk normality test\n#> \n#> data:  residuos_modelo_LP\n#> W = 0.96272, p-value = 0.8219\n## Teste de homogeneidade da vari√¢ncia\nleveneTest(CRC ~ as.factor(Estacao), data = CRC_LP_femea)\n#> Levene's Test for Homogeneity of Variance (center = median)\n#>       Df F value  Pr(>F)  \n#> group  1  9.8527 0.01053 *\n#>       10                  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Teste T\nt.test(CRC ~ Estacao, data = CRC_LP_femea, var.equal = FALSE)\n#> \n#>  Welch Two Sample t-test\n#> \n#> data:  CRC by Estacao\n#> t = -1.7633, df = 6.4998, p-value = 0.1245\n#> alternative hypothesis: true difference in means between group Chuvosa and group Seca is not equal to 0\n#> 95 percent confidence interval:\n#>  -1.5489301  0.2375016\n#> sample estimates:\n#> mean in group Chuvosa    mean in group Seca \n#>              2.834286              3.490000\n## Gr√°fico\nggplot(data = CRC_LP_femea, aes(x = Estacao, y = CRC, color = Estacao)) + \n    geom_boxplot(fill = c(\"darkorange\", \"cyan4\"), width = 0.5, \n                 color = \"black\", outlier.shape = NA, alpha = 0.7) +\n    geom_jitter(shape = 20, position = position_jitter(0.2), color = \"black\", cex = 5) +\n    scale_color_manual(values = c(\"darkorange\", \"cyan4\")) +\n    labs(x = \"Esta√ß√µes\", \n         y = expression(paste(\"CRC (mm) - \", italic(\"L. podicipinus\"))), size = 15) +\n    tema_livro() +\n    theme(legend.position = \"none\")"},{"path":"cap7.html","id":"teste-t-para-amostras-pareadas","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.2 Teste T para amostras pareadas","text":"O Teste T Pareado √© uma estat√≠stica que usa dados medidos duas vezes na mesma unidade amostral, resultando em pares de observa√ß√µes para cada amostra (amostras pareadas). Ele determina se diferen√ßa da m√©dia entre duas observa√ß√µes √© zero.\\[t = \\frac{\\bar{d}}{S_{\\bar{d}}}\\]Onde:\n- \\(\\bar{d}\\) = m√©dia da diferen√ßa das medidas pareadas. Observe que o teste n√£o usa medidas originais, e sim, diferen√ßa para cada par\n- S\\(\\bar{d}\\) = erro padr√£o da diferen√ßa das medidas pareadasPremissas Teste t para amostras pareadasAs unidades amostrais s√£o selecionadas aleatoriamenteAs observa√ß√µes n√£o s√£o independentesDistribui√ß√£o normal (gaussiana) dos valores da diferen√ßa para cada parExemplo pr√°tico 1 - Teste T para amostras pareadasExplica√ß√£o dos dadosNeste exemplo, avaliaremos diferen√ßa na riqueza de esp√©cies de artr√≥podes registradas em 27 localidades. Todas localidades foram amostradas duas vezes. primeira amostragem foi realizada na localidade antes da perturba√ß√£o e segunda amostragem foi realizada ap√≥s localidade ter sofrido uma queimada. Portanto, existe uma depend√™ncia temporal, uma vez que amostramos mesma localidade antes e depois da queimada.PerguntaA riqueza de esp√©cies de artr√≥podes √© prejudicada pelas queimadas?Predi√ß√µesA riqueza de esp√©cies de artr√≥podes ser√° maior antes da queimada devido extin√ß√£o local das esp√©ciesVari√°veisVari√°veis resposta e preditorasVari√°veis resposta e preditorasdata frame com localidades nas linhas e riqueza de esp√©cies (vari√°vel resposta cont√≠nua) e estado (Pre-queimada ou P√≥s-queimada - vari√°vel preditora categ√≥rica) da localidade nas colunasdata frame com localidades nas linhas e riqueza de esp√©cies (vari√°vel resposta cont√≠nua) e estado (Pre-queimada ou P√≥s-queimada - vari√°vel preditora categ√≥rica) da localidade nas colunasChecklistVerificar se o seu data frame est√° com unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunasAn√°liseOlhando os dados com fun√ß√£o head().C√°lculo Teste T com amostras pareadas.Neste exemplo, rejeitamos hip√≥tese nula de que riqueza de esp√©cies de artr√≥podes √© igual antes e depois da queimada (t26 = 7,57, P < 0,001).Podemos visualizar os resultados em gr√°fico (Figura 7.6).\nFigura 7.6: Boxplot da an√°lise Teste T para duas amostras pareadas.\nInterpreta√ß√£o dos resultadosOs resultados mostram que localidades ap√≥s queimadas apresentam em m√©dia 44,5 esp√©cies de artr√≥podes menos que antes das queimadas.","code":"\n## Cabe√ßalho dos dados\nhead(Pareado) \n#>   Areas Riqueza       Estado\n#> 1     1      92 Pre-Queimada\n#> 2     2      74 Pre-Queimada\n#> 3     3      96 Pre-Queimada\n#> 4     4      89 Pre-Queimada\n#> 5     5      76 Pre-Queimada\n#> 6     6      80 Pre-Queimada\n## An√°lise Teste T Pareado\n\nt.test(Riqueza ~ Estado, paired = TRUE, data = Pareado)\n#> \n#>  Paired t-test\n#> \n#> data:  Riqueza by Estado\n#> t = -7.5788, df = 26, p-value = 4.803e-08\n#> alternative hypothesis: true difference in means is not equal to 0\n#> 95 percent confidence interval:\n#>  -56.63994 -32.47117\n#> sample estimates:\n#> mean of the differences \n#>               -44.55556\n## Gr√°fico\nggpaired(Pareado, x = \"Estado\", y = \"Riqueza\",\n         color = \"Estado\", line.color = \"gray\", line.size = 0.8, \n         palette = c(\"darkorange\", \"cyan4\"), width = 0.5, \n         point.size = 4, xlab = \"Estado das localidades\", \n         ylab = \"Riqueza de Esp√©cies\") +\n    expand_limits(y = c(0, 150)) +\n    tema_livro() "},{"path":"cap7.html","id":"correla√ß√£o-de-pearson","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.3 Correla√ß√£o de Pearson","text":"√â um teste que mede for√ßa relativa da rela√ß√£o linear entre duas vari√°veis cont√≠nuas (X e Y). Importante ressaltar que an√°lise de correla√ß√£o n√£o assume que vari√°vel X influencie vari√°vel Y, ou que exista uma rela√ß√£o de causa e efeito entre elas (Zar 2010). an√°lise √© definida em termos da vari√¢ncia de X, vari√¢ncia de Y, e covari√¢ncia de X e Y (.e.¬†como elas variam juntas).\\[r = \\frac{\\sum{XY} - \\frac{\\sum{X} \\sum{Y}}{n}}{\\sqrt{\\left(\\sum{X^2} - \\frac{\\sum{X}^2}{n}\\right)\\left(\\sum{Y^2} - \\frac{\\sum{Y}^2}{n}\\right)}}\\]Onde:r = coeficiente de correla√ß√£o que indica for√ßa da rela√ß√£o linear entre duas vari√°veis. Seu limite de valores est√° entre -1 \\(\\leq\\) r \\(\\le\\) 1. correla√ß√£o positiva indica que o aumento valor de uma das vari√°veis √© acompanhado pelo aumento valor da outra vari√°vel. correla√ß√£o negativa indica que o aumento valor de uma das vari√°veis √© acompanhado pela diminui√ß√£o valor da outra vari√°vel. Se r √© igual zero, n√£o existe correla√ß√£o entre vari√°veis (Figura 7.7).\nFigura 7.7: Exemplo de correla√ß√µes negativa (), positiva (B) e nula (C) e vari√°veis que n√£o apresentam rela√ß√µes lineares entre si (D-E).\nPremissas da Correla√ß√£o de PersonAs amostras devem ser independentes e pareadas (.e.¬†duas vari√°veis devem ser medidas na mesma unidade amostral)unidades amostrais s√£o selecionadas aleatoriamenteA rela√ß√£o entre vari√°veis tem que ser linearExemplo pr√°tico 1 - Correla√ß√£o de PearsonExplica√ß√£o dos dadosNeste exemplo, avaliaremos correla√ß√£o entre altura tronco e o tamanho da raiz medidos em 35 indiv√≠duos de uma esp√©cie vegetal arbustiva.PerguntaExiste correla√ß√£o entre altura tronco e o tamanho da raiz dos arbustos?Predi√ß√µesA altura tronco √© positivamente correlacionada com o tamanho da raizVari√°veisVari√°veisdata frame com os indiv√≠duos (unidade amostral) nas linhas e altura tronco e tamanho da raiz (duas vari√°veis tem que ser cont√≠nuas) como colunasChecklistVerificar se o seu data frame est√° com unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunasAn√°liseVamos olhar os dados com fun√ß√£o head().C√°lculo Teste da Correla√ß√£o de Pearson. Para outros testes de correla√ß√£o como Kendall ou Spearman √© s√≥ alterar o argumento method e inserir o teste desejado.Neste exemplo, rejeitamos hip√≥tese nula de que vari√°veis n√£o s√£o correlacionadas (r = 0.89, P < 0,001).Podemos visualizar os resultados em gr√°fico (Figura 7.8).\nFigura 7.8: Gr√°fico mostrando rela√ß√£o entre vari√°veis e uma linha de tend√™ncia dos dados.\n üìù Importante \nlinha de tend√™ncia tracejada gr√°fico √© apenas para ilustrar rela√ß√£o positiva entre vari√°veis. Ela n√£o √© gerada pela an√°lise de correla√ß√£o.Interpreta√ß√£o dos resultadosOs resultados mostram que o aumento na altura dos arbutos √© acompanhado pelo aumento tamanho da raiz.","code":"\n## Cabe√ßalho dos dados\nhead(correlacao_arbustos) \n#>   Tamanho_raiz Tamanho_tronco\n#> 1    10.177049       19.54383\n#> 2     6.622634       17.13558\n#> 3     7.773629       19.50681\n#> 4    11.055257       21.57085\n#> 5     4.487274       13.22763\n#> 6    11.190216       21.62902\n## Correla√ß√£o de Pearson\ncor.test(correlacao_arbustos$Tamanho_raiz, correlacao_arbustos$Tamanho_tronco, method = \"pearson\")\n#> \n#>  Pearson's product-moment correlation\n#> \n#> data:  correlacao_arbustos$Tamanho_raiz and correlacao_arbustos$Tamanho_tronco\n#> t = 11.49, df = 33, p-value = 4.474e-13\n#> alternative hypothesis: true correlation is not equal to 0\n#> 95 percent confidence interval:\n#>  0.7995083 0.9457816\n#> sample estimates:\n#>       cor \n#> 0.8944449\n\n## Alternativamente\ncor.test(~ Tamanho_tronco + Tamanho_raiz, data = correlacao_arbustos, method = \"pearson\")\n#> \n#>  Pearson's product-moment correlation\n#> \n#> data:  Tamanho_tronco and Tamanho_raiz\n#> t = 11.49, df = 33, p-value = 4.474e-13\n#> alternative hypothesis: true correlation is not equal to 0\n#> 95 percent confidence interval:\n#>  0.7995083 0.9457816\n#> sample estimates:\n#>       cor \n#> 0.8944449\n## Gr√°fico\nggplot(data = correlacao_arbustos, aes(x = Tamanho_raiz, y = Tamanho_tronco)) + \n    labs(x = \"Tamanho da raiz (m)\", y = \"Altura do tronco (m)\") +\n    geom_point(size = 4, shape = 21, fill = \"darkorange\", alpha = 0.7) +\n    geom_text(x = 14, y = 14, label = \"r = 0.89, P < 0.001\", \n              color = \"black\", size = 5) +\n    geom_smooth(method = lm, se = FALSE, color = \"black\", linetype = \"dashed\") +\n    tema_livro() +\n    theme(legend.position = \"none\")"},{"path":"cap7.html","id":"regress√£o-linear-simples","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.4 Regress√£o Linear Simples","text":"regress√£o linear simples √© usada para analisar rela√ß√£o entre uma vari√°vel preditora (plotada eixo-X) e uma vari√°vel resposta (plotada eixo-Y). duas vari√°veis devem ser cont√≠nuas. Diferente das correla√ß√µes, regress√£o assume uma rela√ß√£o de causa e efeito entre vari√°veis. O valor da vari√°vel preditora (X) causa, direta ou indiretamente, o valor da vari√°vel resposta (Y). Assim, Y √© uma fun√ß√£o linear de X:\\[Y = \\beta_0 + \\beta_{1}X_i + \\epsilon_i\\]Onde:\\(\\beta_0\\) = intercepto (intercept) que representa o valor da fun√ß√£o quando X = 0\\(\\beta_{1}\\) = inclina√ß√£o (slope) que mede mudan√ßa na vari√°vel Y para cada mudan√ßa de unidade da vari√°vel X\\(\\epsilon_{1}\\) = erro aleat√≥rio referente √† vari√°vel Y que n√£o pode ser explicado pela vari√°vel XPremissas da Regress√£o Linear SimplesAs amostras devem ser independentesAs unidades amostrais s√£o selecionadas aleatoriamenteDistribui√ß√£o normal (gaussiana) dos res√≠duosHomogeneidade da vari√¢ncia dos res√≠duosExemplo pr√°tico 1 - Regress√£o Linear SimplesExplica√ß√£o dos dadosNeste exemplo, avaliaremos rela√ß√£o entre o gradiente de temperatura m√©dia anual (¬∞C) e o tamanho m√©dio comprimento rostro-cloacal (CRC em mm) de popula√ß√µes de Dendropsophus minutus (Anura:Hylidae) amostradas em 109 localidades Brasil (Boaratti Da Silva 2015).PerguntaA temperatura afeta o tamanho CRC de popula√ß√µes de Dendropsophus minutus?Predi√ß√µesO CRC das popula√ß√µes ser√£o menores em localidades mais quentes que em localidades mais frias de acordo com Hip√≥tese Balan√ßo de Calor (Olalla-T√°rraga Rodr√≠guez 2007)Vari√°veisVari√°veis resposta e preditoras\nData frame com popula√ß√µes (unidade amostral) nas linhas e CRC (vari√°vel resposta) m√©dio (mm) e temperatura m√©dia anual (vari√°vel preditora) como colunas\nVari√°veis resposta e preditorasData frame com popula√ß√µes (unidade amostral) nas linhas e CRC (vari√°vel resposta) m√©dio (mm) e temperatura m√©dia anual (vari√°vel preditora) como colunasChecklistVerificar se o seu data frame est√° com unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunasAn√°liseOlhando os dados com fun√ß√£o head().Vamos calcular regress√£o linear simples.Antes de vermos os resultados, vamos verificar normalidade e homogeneidade das vari√¢ncias (Figura 7.9).\nFigura 7.9: Gr√°ficos mostrando premissas da regress√£o linear simples.\nOs gr√°ficos Residuals vs Fitted, Scale-Location, e Residual vs Leverage est√£o relacionados com homogeneidade da vari√¢ncia. Nestes gr√°ficos, esperamos ver os pontos dispersos espa√ßo sem padr√µes com formatos em U ou funil. Neste caso, vemos que linhas vermelhas (que indicam tend√™ncia dos dados) est√£o praticamente retas, seguindo linha pontilhada, sugerindo que n√£o exista heterogeneidade de vari√¢ncia dos res√≠duos. O gr√°fico Residual vs Leverage, identifica os valores extremos que estejam mais de uma unidade da dist√¢ncia de Cook (linha pontilhada vermelha). Quando muito discrepantes, esses valores podem influenciar os resultados dos testes estat√≠sticos. Tamb√©m n√£o temos problemas com esse pressuposto modelo aqui. O gr√°fico Normal Q-Q (quantile-quantile plot) mede desvios da normalidade. Neste caso, esperamos que os pontos sigam uma linha reta (.e.¬†fiquem muito pr√≥ximos da linha pontilhada) e n√£o apresentem padr√µes com formatos de S ou arco. Podemos observar que tanto normalidade como homogeneidade res√≠duos est√£o dentro dos padr√µes esperados.Vamos ver os resultados da regress√£o simples usando fun√ß√µes anova() e summary(). fun√ß√£o anova() retorna uma tabela contendo o grau de liberdade (df), soma dos quadrados, valor de F e o valor de P.fun√ß√£o summary() retorna uma tabela contendo o valor intercepto, inclina√ß√£o da reta (slope) e o coeficiente de determina√ß√£o (R2) que indica propor√ß√£o da varia√ß√£o na vari√°vel Y que pode ser atribu√≠da √† varia√ß√£o na vari√°vel X. Percebam que parte final dos resultados apresentados summary() s√£o os mesmo apresentados pela fun√ß√£o anova().Vamos visualizar os resultados em gr√°fico (Figura 7.10).\nFigura 7.10: Gr√°fico mostrando rela√ß√£o entre vari√°veis e modelo linear simples, representado pela linha cont√≠nua.\nInterpreta√ß√£o dos resultadosNeste exemplo, rejeitamos hip√≥tese nula de que n√£o existe rela√ß√£o entre o tamanho CRC das popula√ß√µes de D. minutus e temperatura da localidade onde elas ocorrem (F1,107 = 38,92, P < 0,001). Os resultados mostram que o tamanho CRC das popula√ß√µes tem uma rela√ß√£o positiva com temperatura das localidades. Assim, popula√ß√µes de D. minutus em localidades mais quentes apresentam maior CRC que popula√ß√µes em localidades mais frias. Podemos tamb√©m usar os coeficientes da regress√£o para entender como mudan√ßa na vari√°vel preditora (temperatura) afeta o tamanho corporal m√©dio dos anuros. Neste caso, ao usar o comando coef(modelo_regressao), obtemos os valores 16,23 e 0,27, respectivamente os valores intercepto (Œ≤0) e da temperatura (Œ≤1). O valor de 0,27 indica que mudan√ßa de uma unidade na vari√°vel preditora (neste caso, graus), aumenta em 0,27 unidades (neste caso, cent√≠metros) da vari√°vel dependente. Por exemplo, o modelo indica que o tamanho m√©dio dos indiv√≠duos em locais com temperatura de 16¬∫ C √© de 20,55 cm, ao passo que em locais com 26¬∫ C o tamanho aumenta para 23,25 cm, o que representa um ganho de 13%.","code":"\n## Cabe√ßalho dos dados\nhead(dados_regressao) \n#>      Municipio      CRC Temperatura Precipitacao\n#> 1     Acorizal 22.98816    24.13000       1228.2\n#> 2  Alpinopolis 22.91788    20.09417       1487.6\n#> 3 Alto_Paraiso 21.97629    21.86167       1812.4\n#> 4    Americana 23.32453    20.28333       1266.2\n#> 5      Apiacas 22.83651    25.47333       2154.0\n#> 6  Arianopolis 20.86989    20.12167       1269.2\n## regress√£o simples\nmodelo_regressao <- lm(CRC ~ Temperatura, data = dados_regressao)\n## Verificar as premissas do teste\npar(mfrow = c(2, 2), oma = c(0, 0, 2, 0))\nplot(modelo_regressao)\ndev.off() # volta a configura√ß√£o dos gr√°ficos para o formato padr√£o \n#> null device \n#>           1\n## Resultados usando a fun√ß√£o anova\nanova(modelo_regressao)\n#> Analysis of Variance Table\n#> \n#> Response: CRC\n#>              Df  Sum Sq Mean Sq F value    Pr(>F)    \n#> Temperatura   1  80.931  80.931   38.92 9.011e-09 ***\n#> Residuals   107 222.500   2.079                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Resultados usando a fun√ß√£o summary\nsummary(modelo_regressao)\n#> \n#> Call:\n#> lm(formula = CRC ~ Temperatura, data = dados_regressao)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -3.4535 -0.7784  0.0888  0.9168  3.1868 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept) 16.23467    0.91368  17.768  < 2e-16 ***\n#> Temperatura  0.26905    0.04313   6.239 9.01e-09 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 1.442 on 107 degrees of freedom\n#> Multiple R-squared:  0.2667, Adjusted R-squared:  0.2599 \n#> F-statistic: 38.92 on 1 and 107 DF,  p-value: 9.011e-09\n## Gr√°fico\nggplot(data = dados_regressao, aes(x = Temperatura, y = CRC)) + \n    labs(x = \"Temperatura m√©dia anual (¬∞C)\", \n         y = \"Comprimento rostro-cloacal (mm)\") +\n    geom_point(size = 4, shape = 21, fill = \"darkorange\", alpha = 0.7) +\n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    tema_livro() +\n    theme(legend.position = \"none\")"},{"path":"cap7.html","id":"regress√£o-linear-m√∫ltipla","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.5 Regress√£o Linear M√∫ltipla","text":"regress√£o linear m√∫ltipla √© uma extens√£o da regress√£o linear simples. Ela √© usada quando queremos determinar o valor da vari√°vel resposta (Y) com base nos valores de duas ou mais vari√°veis preditoras (X1, X2, Xn).\\[Y = \\beta_0 + \\beta_{1}X_1 + \\beta_{n}X_n + \\epsilon_i\\]Onde:\\(\\beta_0\\) = intercepto (intercept) que representa o valor da fun√ß√£o quando X = 0\\(\\beta_{n}\\) = inclina√ß√£o (slope) que mede mudan√ßa na vari√°vel Y para cada mudan√ßa de unidade das vari√°veis Xn\\(\\epsilon_{1}\\) = erro aleat√≥rio referente vari√°vel Y que n√£o pode ser explicado pelas vari√°veis preditorasPremissas da Regress√£o Linear M√∫ltiplaAs amostras devem ser independentesAs unidades amostrais s√£o selecionadas aleatoriamenteDistribui√ß√£o normal (gaussiana) dos res√≠duosHomogeneidade da vari√¢ncia dos res√≠duosExemplo pr√°tico 1 - Regress√£o Linear M√∫ltiplaExplica√ß√£o dos dadosUtilizaremos o mesmo exemplo da regress√£o linear simples. Contudo, al√©m gradiente de temperatura m√©dia anual (¬∞C), incluiremos o gradiente de precipita√ß√£o anual (mm) como outra vari√°vel preditora tamanho m√©dio comprimento rostro-cloacal (CRC em mm) de popula√ß√µes de Dendropsophus minutus (Anura:Hylidae) amostradas em 109 localidades Brasil (Boaratti Da Silva 2015).PerguntaO tamanho CRC das popula√ß√µes de D. minutus √© influ√™nciado pela temperatura e precipita√ß√£o das localidades onde os indiv√≠duos ocorrem?Predi√ß√µesO CRC das popula√ß√µes ser√£o menores em localidades com clima quente e chuvoso que em localidades com clima frio e secoVari√°veisVari√°veis resposta e preditorasVari√°veis resposta e preditorasdata frame com popula√ß√µes (unidade amostral) nas linhas e CRC (vari√°vel resposta) m√©dio (mm) e temperatura e precipita√ß√£o (vari√°veis preditoras) como colunasdata frame com popula√ß√µes (unidade amostral) nas linhas e CRC (vari√°vel resposta) m√©dio (mm) e temperatura e precipita√ß√£o (vari√°veis preditoras) como colunasChecklistVerificar se o seu data frame est√° com unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunasAn√°liseOlhando os dados usando fun√ß√£o head().C√≥digos para ajustar o modelo de regress√£o m√∫ltipla. üìù Importante \nMulticolinearidade ocorre quando vari√°veis preditoras s√£o correlacionadas. Essa correla√ß√£o √© um problema porque vari√°veis preditoras deveriam ser independentes. Al√©m disso, multicolinearidade aumentam o erro padr√£o associado aos coeficientes produzindo resultados menos confi√°veis. O Fator de Infla√ß√£o da Vari√¢ncia (VIF) √© um teste que quantifica quanto erro padr√£o dos coeficientes estimados est√£o inflados devido √† multicolinearidade. Na regress√£o m√∫ltipla, cada vari√°vel preditora tem um valor de VIF. Alguns autores consideram valores de VIF acima de 10 como fortemente correlacionadas, outros mais conservadores consideram o valor de 5, 3 ou at√© mesmo 2. Mais detalhes em . F. Zuur, Ieno, Elphick (2010) e Dormann et al. (2013).Vamos analisar se vari√°veis apresentam multicolinearidade.Os valores s√£o menores que 3, indicando que n√£o h√° multicolinearidade.Agora vamos verificar premissas de normalidade e homogeneidade das vari√¢ncias (Figura 7.11).\nFigura 7.11: Gr√°ficos mostrando premissas da regress√£o linear m√∫ltipla.\nOs res√≠duos apresentam distribui√ß√£o normal e vari√¢ncias homog√™neas.Podemos ver os resultados da an√°lise.Percebam que temperatura tem uma rela√ß√£o significativa e positiva com o tamanho CRC das popula√ß√µes (P < 0.001), enquanto precipita√ß√£o n√£o apresenta rela√ß√£o com o CRC (P = 0.27). Neste caso, √© interessante saber se um modelo mais simples (e.g.¬†contendo apenas temperatura) explicaria distribui√ß√£o t√£o bem ou melhor que este modelo mais complexo considerando duas vari√°veis (temperatura e precipita√ß√£o).Para isso, podemos utilizar Likelihood-ratio test (LRT) para comparar os modelos. LRT compara dois modelos aninhados, testando se os par√¢metros modelo mais complexo diferem significativamente modelo mais simples. Em outras palavras, ele testa se h√° necessidade de se incluir uma vari√°vel extra modelo para explicar os dados. üìù Importante \nHip√≥tese Nula (H0) teste Likelihood-ratio test (LRT) √© de que o modelo mais simples √© o melhor.Valor de p < 0.05 rejeita hip√≥tese nula e o modelo mais complexo √© o melhorValor de p > 0.05 n√£o rejeita hip√≥tese nula e o modelo mais simples √© o melhorInterpreta√ß√£o dos resultadosNeste exemplo, precipita√ß√£o n√£o est√° associada com varia√ß√£o tamanho CRC das popula√ß√µes de D. minutus. Por outro lado, temperatura explicou 26% da varia√ß√£o tamanho CRC das popula√ß√µes.","code":"\n## Cabe√ßalho dos dados\nhead(dados_regressao_mul) \n#>      Municipio      CRC Temperatura Precipitacao\n#> 1     Acorizal 22.98816    24.13000       1228.2\n#> 2  Alpinopolis 22.91788    20.09417       1487.6\n#> 3 Alto_Paraiso 21.97629    21.86167       1812.4\n#> 4    Americana 23.32453    20.28333       1266.2\n#> 5      Apiacas 22.83651    25.47333       2154.0\n#> 6  Arianopolis 20.86989    20.12167       1269.2\n## Regress√£o m√∫ltipla\nmodelo_regressao_mul <- lm(CRC ~ Temperatura + Precipitacao,\n                           data = dados_regressao_mul)\n# Multicolinearidade\nvif(modelo_regressao_mul)\n#>  Temperatura Precipitacao \n#>     1.041265     1.041265\n## Normalidade e homogeneidade das vari√¢ncias\nplot_grid(plot_model(modelo_regressao_mul , type = \"diag\"))\n## regress√£o m√∫ltipla\nsummary(modelo_regressao_mul)\n#> \n#> Call:\n#> lm(formula = CRC ~ Temperatura + Precipitacao, data = dados_regressao_mul)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -3.4351 -0.8026  0.0140  0.9420  3.4300 \n#> \n#> Coefficients:\n#>                Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  16.7162571  1.0108674  16.537  < 2e-16 ***\n#> Temperatura   0.2787445  0.0439601   6.341 5.71e-09 ***\n#> Precipitacao -0.0004270  0.0003852  -1.108     0.27    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 1.44 on 106 degrees of freedom\n#> Multiple R-squared:  0.2751, Adjusted R-squared:  0.2614 \n#> F-statistic: 20.12 on 2 and 106 DF,  p-value: 3.927e-08\n## Criando os modelos aninhados\nmodelo_regressao_mul <- lm(CRC ~ Temperatura + Precipitacao, \n                           data = dados_regressao_mul)\nmodelo_regressao <- lm(CRC ~ Temperatura, data = dados_regressao_mul)\n\n## Likelihood-ratio test (LRT)\nlrtest(modelo_regressao_mul, modelo_regressao)\n#> Likelihood ratio test\n#> \n#> Model 1: CRC ~ Temperatura + Precipitacao\n#> Model 2: CRC ~ Temperatura\n#>   #Df  LogLik Df  Chisq Pr(>Chisq)\n#> 1   4 -192.93                     \n#> 2   3 -193.55 -1 1.2558     0.2624\n## Comparando com o modelo somente com o intercepto\n# Criando um modelo sem vari√°veis, s√≥ o intercepto.\nmodelo_intercepto <- lm(CRC ~ 1, data = dados_regressao_mul)\nlrtest(modelo_regressao, modelo_intercepto)\n#> Likelihood ratio test\n#> \n#> Model 1: CRC ~ Temperatura\n#> Model 2: CRC ~ 1\n#>   #Df  LogLik Df  Chisq Pr(>Chisq)    \n#> 1   3 -193.55                         \n#> 2   2 -210.46 -1 33.815  6.061e-09 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"cap7.html","id":"an√°lises-de-vari√¢ncia-anova","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.6 An√°lises de Vari√¢ncia (ANOVA)","text":"ANOVA refere-se uma variedade de delineamentos experimentais nos quais vari√°vel preditora √© categ√≥rica e vari√°vel resposta √© cont√≠nua (Gotelli Ellison 2012). Exemplos desses delineamentos experimentais s√£o: ANOVA de um fator, ANOVA de dois fatores, ANOVA em blocos aleatorizados, ANOVA de medidas repetidas e ANOVA split-splot. De forma geral, ANOVA √© um teste estat√≠stico usado para comparar m√©dia entre grupos amostrados independentemente. Para isso, o teste leva em conta, al√©m das m√©dias dos grupos, varia√ß√£o dos dados dentro e entre os grupos. Neste cap√≠tulo, iremos demonstrar os c√≥digos para alguns dos principais delineamentos experimentais.Premissas da ANOVAAs amostras devem ser independentesAs unidades amostrais s√£o selecionadas aleatoriamenteDistribui√ß√£o normal (gaussiana) dos res√≠duosHomogeneidade da vari√¢ncia üìù Importante \nANOVA de medidas repetidas e ANOVA split-plot s√£o an√°lises com desenhos experimentais que apresentam depend√™ncia entre amostras, mas controlam esse deped√™ncia nas suas formula√ß√µes matem√°ticas.","code":""},{"path":"cap7.html","id":"anova-de-um-fator","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.6.1 ANOVA de um fator","text":"Este teste considera delineamentos experimentais com apenas um fator (ou tratamento) que pode ser composto por tr√™s ou mais grupos (ou n√≠veis).Exemplo pr√°tico 1 - Anova de um fatorExplica√ß√£o dos dadosNeste exemplo hipot√©tico, avaliaremos se o adubo X-2020 disponibilizado recentemente mercado melhora o crescimento dos indiv√≠duos de Coffea arabica como divulgado pela empresa respons√°vel pela venda produto. Para isso, foi realizado um experimento com indiv√≠duos de C. arabica cultivados em tr√™s grupos: ) grupo controle onde os indiv√≠duos n√£o receberam aduba√ß√£o, ii) grupo onde os indiv√≠duos receberam adi√ß√£o adubo tradicional mais utilizado pelos produtores de C. arabica, e iii) grupo onde os indiv√≠duos receberam adi√ß√£o adubo X-2020.PerguntaO crescimento dos indiv√≠duos de C. arabica √© melhorado pela adi√ß√£o adubo X-2020?Predi√ß√µesO crescimento dos indiv√≠duos de C. arabica ser√° maior grupo que recebeu o adubo X-2020Vari√°veisVari√°veis resposta e preditoras\nData frame com plantas (unidade amostral) nas linhas e o crescimento dos indiv√≠duos de C. arabica (vari√°vel resposta) e os tratamentos (vari√°vel preditora) nas colunas\nVari√°veis resposta e preditorasData frame com plantas (unidade amostral) nas linhas e o crescimento dos indiv√≠duos de C. arabica (vari√°vel resposta) e os tratamentos (vari√°vel preditora) nas colunasChecklistVerificar se o seu data frame est√° com unidades amostrais nas linhas e vari√°vel preditora e resposta nas colunasAn√°liseOlhando os dados e criando o modelo para Anova de um fator.Vamos verificar normalidade dos res√≠duos e homogeneidade da vari√¢ncia usando os testes de Shapiro-Wilk e Bartlett, respectivamente.Os res√≠duos apresentam distribui√ß√£o normal e homogeneidade de vari√¢ncia.Vamos ver os resultados da an√°lise.Percebam que o resultado da ANOVA (Pr(>F) < 0.001) indica que devemos rejeitar hip√≥tese nula que n√£o h√° diferen√ßa entre m√©dias dos grupos. Contudo, os resultados n√£o mostram quais s√£o os grupos que apresentam diferen√ßas. Para isso, temos que realizar testes de compara√ß√µes m√∫ltiplas post-hoc para detectar os grupos que apresentam diferen√ßas significativas entre m√©dias. üìù Importante \nOs testes post-hoc s√≥ devem ser utilizados quando rejeitamos hip√≥tese nula (P < 0.05) teste da ANOVA.Visualizar os resultados em gr√°fico (Figura 7.12).\nFigura 7.12: Gr√°fico de caixa mostrando o resultado da ANOVA de um fator.\nInterpreta√ß√£o dos resultadosNeste exemplo, os indiv√≠duos de C. arabica que receberam aduba√ß√£o (tradicional e X-2020) apresentaram maior crescimento que os indiv√≠duos que n√£o receberam aduba√ß√£o. Contudo, diferente que foi divulgado pela empresa, o adubo X-2020 n√£o apresentou melhor desempenho que o adubo tradicional j√° utilizado pelos produtores.","code":"\n## Cabe√ßalho dos dados\nhead(dados_anova_simples) \n#>   Crescimento Tratamento\n#> 1       7.190   Controle\n#> 2       6.758   Controle\n#> 3       6.101   Controle\n#> 4       4.758   Controle\n#> 5       6.542   Controle\n#> 6       7.667   Controle\n\n## An√°lise ANOVA de um fator\nModelo_anova <- aov(Crescimento ~ Tratamento, data = dados_anova_simples) \n## Normalidade \nshapiro.test(residuals(Modelo_anova))\n#> \n#>  Shapiro-Wilk normality test\n#> \n#> data:  residuals(Modelo_anova)\n#> W = 0.94676, p-value = 0.08266\n\n## Homogeneidade da vari√¢ncia\nbartlett.test(Crescimento ~ Tratamento, data = dados_anova_simples)\n#> \n#>  Bartlett test of homogeneity of variances\n#> \n#> data:  Crescimento by Tratamento\n#> Bartlett's K-squared = 0.61835, df = 2, p-value = 0.7341\n## Resultados da anova\nanova(Modelo_anova)\n#> Analysis of Variance Table\n#> \n#> Response: Crescimento\n#>            Df Sum Sq Mean Sq F value    Pr(>F)    \n#> Tratamento  2 340.32 170.160  77.989 3.124e-13 ***\n#> Residuals  33  72.00   2.182                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Diferen√ßas entre os tratamentos\n# Teste de Tuckey's honest significant difference\nTukeyHSD(Modelo_anova)\n#>   Tukey multiple comparisons of means\n#>     95% family-wise confidence level\n#> \n#> Fit: aov(formula = Crescimento ~ Tratamento, data = dados_anova_simples)\n#> \n#> $Tratamento\n#>                                       diff       lwr       upr     p adj\n#> Adubo_X-2020-Adubo_Tradicional  0.04991667 -1.429784  1.529617 0.9962299\n#> Controle-Adubo_Tradicional     -6.49716667 -7.976867 -5.017466 0.0000000\n#> Controle-Adubo_X-2020          -6.54708333 -8.026784 -5.067383 0.0000000\n## Reorganizando a ordem que os grupos ir√£o aparecer no gr√°fico\ndados_anova_simples$Tratamento <- factor(dados_anova_simples$Tratamento,\n                                         levels = c(\"Controle\", \"Adubo_Tradicional\", \"Adubo_X-2020\"))\n\n## Gr√°fico\nggplot(data = dados_anova_simples, \n       aes(x = Tratamento, y = Crescimento, color = Tratamento)) + \n    geom_boxplot(fill = c(\"darkorange\", \"darkorchid\", \"cyan4\"), \n                 color = \"black\", show.legend = FALSE, alpha = 0.4) +\n    geom_jitter(shape = 16, position = position_jitter(0.1), \n                cex = 4, alpha = 0.7) +\n    scale_color_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    scale_y_continuous(limits = c(0, 20), breaks = c(0, 5, 10, 15, 20)) +\n    geom_text(x = 1, y = 12, label = \"ab\", color = \"black\", size = 5) +\n    geom_text(x = 2, y = 17, label = \"a\", color = \"black\", size = 5) +\n    geom_text(x = 3, y = 17, label = \"b\", color = \"black\", size = 5) +\n    scale_x_discrete(labels = c(\"Sem adubo\", \"Tradicional\", \"X-2020\")) +\n    labs(x = \"Aduba√ß√£o\", y = \"Crescimento Coffea arabica (cm)\", size = 20) +\n    tema_livro() +\n    theme(legend.position = \"none\") "},{"path":"cap7.html","id":"anova-com-dois-fatores-ou-anova-fatorial","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.6.2 ANOVA com dois fatores ou ANOVA fatorial","text":"Este teste considera delineamentos amostrais com dois fatores (ou tratamentos) que podem ser compostos por dois ou mais grupos (ou n√≠veis). Esta an√°lise tem uma vantagem, pois permite avaliar o efeito da intera√ß√£o entre os fatores na vari√°vel resposta. Quando intera√ß√£o est√° presente, o impacto de um fator depende n√≠vel (ou grupo) outro fator.Exemplo pr√°tico 1 - ANOVA com dois fatoresExplica√ß√£o dos dadosNeste exemplo hipot√©tico, avaliaremos se o tempo que o corpo leva para eliminar uma droga utilizada em exames de resson√¢ncia magn√©tica est√° relacionado com o sistema XY de determina√ß√£o sexo e/ou com idade dos pacientes. Para isso, foi realizado um experimento com 40 pacientes distribu√≠dos da seguinte maneira: ) 10 indiv√≠duos XX - jovens, ii) 10 indiv√≠duos XX - idosas, iii) 10 indiv√≠duos XY - jovens, e iv) 10 indiv√≠duos XY - idosos.PerguntaO tempo de elimina√ß√£o da droga √© dependente sistema XY de determina√ß√£o sexo e idade dos pacientes?Predi√ß√µesO tempo de elimina√ß√£o da droga vai ser mais r√°pido nas pacientes XX e jovensVari√°veisVari√°veis resposta e preditorasVari√°veis resposta e preditorasdata frame com os pacientes (unidade amostral) nas linhas e o tempo de elimina√ß√£o da droga (vari√°vel resposta) e os tratamentos sexo e idade dos pacientes (vari√°veis preditoras) nas colunasdata frame com os pacientes (unidade amostral) nas linhas e o tempo de elimina√ß√£o da droga (vari√°vel resposta) e os tratamentos sexo e idade dos pacientes (vari√°veis preditoras) nas colunasChecklistVerificar se o seu data frame est√° com unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunasAn√°liseVerificando os dados usando fun√ß√£o head().C√≥digos para realizar ANOVA com dois fatores.Percebam que intera√ß√£o n√£o apresenta um efeito significativo (P > 0.05). Assim, iremos retirar intera√ß√£o e verificar, usando Likelihood-ratio test, se o modelo mais simples √© melhor.Analisando o resultado teste (P > 0.05), intera√ß√£o n√£o √© importante. Ent√£o podemos seguir com o modelo mais simples. Vamos verficiar normalidade e homogeneidade da vari√¢ncia (Figura 7.13).\nFigura 7.13: Gr√°ficos mostrando premissas da ANOVA fatorial.\nDois pontos est√£o fugindo da reta e chamam aten√ß√£o sobre normalidade da distribui√ß√£o dos res√≠duos. homogeneidade da vari√¢ncia est√° adequada. Por enquanto, vamos seguir an√°lise, mas veja o Cap√≠tulo 8 para entender como lidar com modelos que os res√≠duos n√£o apresentam distribui√ß√£o normal.Percebam que o resultado da ANOVA (Pr(>F) < 0.001) indica que devemos rejeitar hip√≥tese nula de que n√£o h√° diferen√ßa entre m√©dias dos sistema XY e idade dos pacientes. Neste caso, n√£o precisamos realizar testes de compara√ß√µes m√∫ltiplas post-hoc porque os fatores apresentam apenas dois n√≠veis. Contudo, se seu delineamento experimental um dos fatores apresentar tr√™s ou mais n√≠veis, voc√™ dever√° utilizar os testes de compara√ß√µes post-hoc para determinar diferen√ßas entre os grupos.Vamos visualizar os resultados em gr√°fico (Figura 7.14).\nFigura 7.14: Gr√°fico de caixa mostrando o resultado da ANOVA fatorial.\nInterpreta√ß√£o dos resultadosNeste exemplo, o sistema XY de determina√ß√£o sexo e idade dos pacientes t√™m um efeito tempo de elimina√ß√£o da droga organismo. Os pacientes XX e jovens apresentaram elimina√ß√£o mais r√°pida da droga que pacientes XY e idosos.Exemplo pr√°tico 2 - ANOVA com dois fatores com efeito da intera√ß√£oExplica√ß√£o dos dadosNeste exemplo, novamente hipot√©tico, usaremos os mesmos dados exemplo anterior. Entretanto, alteramos os dados para que agora intera√ß√£o seja significativa.Percebam que intera√ß√£o √© significativa (P < 0.05), mas idade n√£o √© significativa. Nossa interpreta√ß√£o precisa ser baseada na intera√ß√£o entre os fatores. Vamos visualizar os resultados em gr√°fico (Figura 7.15).\nFigura 7.15: Gr√°fico de caixa mostrando o resultado da ANOVA fatorial com intera√ß√£o.\nInterpreta√ß√£o dos resultadosPercebam que linhas se cruzam. Esse √© um exemplo cl√°ssico de intera√ß√£o. Novamente, para saber resposta fator idade (jovem ou idoso), voc√™ precisa saber com qual pessoa (XX ou XY) ele est√° associado. Jovens s√£o mais r√°pidos para eliminarem droga em pessoas XX, enquanto os idosos s√£o mais r√°pidos para eliminarem droga nas pessoas XY.","code":"\n## Cabe√ßalho dos dados\nhead(dados_dois_fatores) \n#>    Tempo Pessoas Idade\n#> 1 18.952      XX Jovem\n#> 2 16.513      XX Jovem\n#> 3 17.981      XX Jovem\n#> 4 21.371      XX Jovem\n#> 5 14.470      XX Jovem\n#> 6 19.130      XX Jovem\n## An√°lise Anova de dois fatores \n# A intera√ß√£o entre os fatores √© representada por *\nModelo1 <- aov(Tempo ~ Pessoas * Idade, data = dados_dois_fatores) \n\n# Olhando os resultados\nanova(Modelo1)\n#> Analysis of Variance Table\n#> \n#> Response: Tempo\n#>               Df  Sum Sq Mean Sq  F value    Pr(>F)    \n#> Pessoas        1  716.72  716.72 178.8538  1.56e-15 ***\n#> Idade          1 1663.73 1663.73 415.1724 < 2.2e-16 ***\n#> Pessoas:Idade  1    4.77    4.77   1.1903    0.2825    \n#> Residuals     36  144.26    4.01                       \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n# Criando modelo sem intera√ß√£o.\nModelo2 <- aov(Tempo ~ Pessoas + Idade, data = dados_dois_fatores) \n\n## LRT\nlrtest(Modelo1, Modelo2)\n#> Likelihood ratio test\n#> \n#> Model 1: Tempo ~ Pessoas * Idade\n#> Model 2: Tempo ~ Pessoas + Idade\n#>   #Df  LogLik Df  Chisq Pr(>Chisq)\n#> 1   5 -82.413                     \n#> 2   4 -83.063 -1 1.3012      0.254\n# Verificando as premissas do teste.\nplot_grid(plot_model(Modelo2, type = \"diag\"))\n# Resultados do modelo\nanova(Modelo2)\n#> Analysis of Variance Table\n#> \n#> Response: Tempo\n#>           Df  Sum Sq Mean Sq F value    Pr(>F)    \n#> Pessoas    1  716.72  716.72  177.94 1.041e-15 ***\n#> Idade      1 1663.73 1663.73  413.05 < 2.2e-16 ***\n#> Residuals 37  149.03    4.03                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Gr√°fico\nggplot(data = dados_dois_fatores_interacao, \n       aes(y = Tempo, x = Pessoas, color = Idade)) + \n    geom_boxplot() +\n    stat_summary(fun = mean, geom =\"point\", aes(group = Idade, x = Pessoas),\n                 color = \"black\",\n                 position = position_dodge(0.7), size  = 4) +\n    geom_link(aes(x = 0.8, y = 31, xend = 1.8, yend = 40), color = \"darkorange\", \n              lwd  = 1.3, linetype = 2) + \n    geom_link(aes(x = 1.2, y = 19, xend = 2.2, yend = 26.5), \n              color = \"cyan4\", lwd  = 1.3, linetype = 2) + \n    labs(x = \"Sistema XY de determina√ß√£o do sexo\", \n         y = \"Tempo (horas) para eliminar a droga\") +\n    scale_color_manual(values = c(\"darkorange\", \"cyan4\", \"darkorange\", \"cyan4\")) +\n    scale_y_continuous(limits = c(10, 50), breaks = c(10, 20, 30, 40, 50)) +\n    tema_livro()  \n## Olhando os dados\nhead(dados_dois_fatores_interacao2)\n#>    Tempo Pessoas Idade\n#> 1 18.952      XX Jovem\n#> 2 16.513      XX Jovem\n#> 3 17.981      XX Jovem\n#> 4 21.371      XX Jovem\n#> 5 14.470      XX Jovem\n#> 6 19.130      XX Jovem\n\n## An√°lise anova de dois fatores \nModelo_interacao2 <- aov(Tempo ~ Pessoas * Idade, \n                         data = dados_dois_fatores_interacao2)\n\n## Olhando os resultados\nanova(Modelo_interacao2)\n#> Analysis of Variance Table\n#> \n#> Response: Tempo\n#>               Df  Sum Sq Mean Sq  F value    Pr(>F)    \n#> Pessoas        1  716.72  716.72 178.8538  1.56e-15 ***\n#> Idade          1    4.77    4.77   1.1903    0.2825    \n#> Pessoas:Idade  1 1663.73 1663.73 415.1724 < 2.2e-16 ***\n#> Residuals     36  144.26    4.01                       \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Gr√°fico\nggplot(data = dados_dois_fatores_interacao2, \n       aes(y = Tempo, x = Pessoas, color = Idade)) + \n    geom_boxplot() +\n    stat_summary(fun = mean, geom =\"point\", aes(group = Idade, x = Pessoas), \n                 color = \"black\", position = position_dodge(0.7), size  = 4) +\n    geom_link(aes(x = 0.8, y = 31, xend = 1.8, yend = 27), color = \"darkorange\", \n              lwd  = 1.3, linetype = 2) + \n    geom_link(aes(x = 1.2, y = 19, xend = 2.2, yend = 41), color = \"cyan4\", \n              lwd  = 1.3, linetype = 2) + \n    labs(x = \"Sistema XY de determina√ß√£o do sexo\", \n         y = \"Tempo (horas) para eliminar a droga\") +\n    scale_color_manual(values = c(\"darkorange\", \"cyan4\", \"darkorange\", \"cyan4\")) +\n    scale_y_continuous(limits = c(10, 50), breaks = c(10, 20, 30, 40, 50)) +\n    tema_livro() "},{"path":"cap7.html","id":"anova-em-blocos-aleatorizados","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.6.3 ANOVA em blocos aleatorizados","text":"delineamento experimental com blocos aleatorizados, cada fator √© agrupado em blocos, com r√©plicas de cada n√≠vel fator representado em cada bloco (Gotelli Ellison 2012). O bloco √© uma √°rea ou per√≠odo de tempo dentro qual condi√ß√µes ambientais s√£o relativamente homog√™neas. O objetivo uso dos blocos √© controlar fontes de varia√ß√µes indesejadas na vari√°vel dependente que n√£o s√£o de interesse pesquisador. Desta maneira, podemos retirar dos res√≠duos os efeitos das varia√ß√µes indesejadas que n√£o s√£o nosso interesse, e testar com maior poder estat√≠stico os efeitos dos tratamentos de interesse. Importante, os blocos devem ser arranjados de forma que condi√ß√µes ambientais sejam mais similares dentro dos blocos que entre os blocos.Exemplo pr√°tico 1 - ANOVA em blocos aleatorizadosExplica√ß√£o dos dadosNeste exemplo, avaliaremos riqueza de esp√©cies de anuros amostradas em po√ßas artificiais instaladas diferentes dist√¢ncias de seis fragmentos florestais sudeste Brasil (da Silva et al. 2012). Os fragmentos florestais apresentam diferen√ßas entre si que n√£o s√£o interesse pesquisador. Por isso, eles foram inclu√≠dos como blocos nas an√°lises. po√ßas artificiais foram instaladas em todos os fragmentos florestais com base seguinte delineamento experimental (da Silva et al. 2012): ) quatro po√ßas interior fragmento 100 m de dist√¢ncia da borda fragmento; ii) quatro po√ßas interior fragmento 50 m de dist√¢ncia da borda fragmento; iii) quatro po√ßas na borda fragmento; iv) quatro po√ßas na matriz de pastagem 50 m de dist√¢ncia da borda fragmento; e v) quatro po√ßas na matriz de pastagem 100 m de dist√¢ncia da borda fragmento. Percebam que todos os tratamentos foram instalados em todos os blocos. üìù Importante \nOs valores da riqueza de esp√©cies foram alterados em rela√ß√£o publica√ß√£o original (da Silva et al. 2012) para deixar o exemplo mais did√°tico.PerguntaA dist√¢ncia da po√ßa artifical ao fragmento florestal influencia riqueza de esp√©cies anuros?Predi√ß√µesPo√ßas na borda fragmento florestal apresentar√£o maior riqueza de esp√©cies que po√ßas distantes da bordaVari√°veisVari√°veis resposta e preditoras\nData frame com po√ßas (unidade amostral) nas linhas e riqueza de esp√©cies (vari√°vel reposta), dist√¢ncia dos fragmentos florestais (vari√°vel preditora categ√≥rica) e fragmentos florestais (blocos) nas colunas\nVari√°veis resposta e preditorasData frame com po√ßas (unidade amostral) nas linhas e riqueza de esp√©cies (vari√°vel reposta), dist√¢ncia dos fragmentos florestais (vari√°vel preditora categ√≥rica) e fragmentos florestais (blocos) nas colunasChecklistVerificar se o seu data frame est√° com unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunasAn√°liseOlhando os dados usando fun√ß√£o head().An√°lise da ANOVA em blocos.Lembre-se que nos delineamentos experimentais em bloco, o pesquisador n√£o est√° interessado efeito bloco, mas sim em controlar varia√ß√£o associada ele.O que n√£o pode acontecer √© ignorar o efeito bloco que √© incorporado pelos res√≠duos quando n√£o informado modelo. Veja abaixo forma errada de analisar delineamento experimental com blocos.O resultado da ANOVA (Pr(>F) < 0.001) indica que devemos rejeitar hip√≥tese nula que n√£o h√° diferen√ßa entre m√©dias dos grupos. Contudo, os resultados n√£o mostram quais s√£o os grupos que apresentam diferen√ßas. Para isso, temos que realizar testes de compara√ß√µes m√∫ltiplas post-hoc para detectar os grupos que apresentam diferen√ßas significativas entre m√©dias.Visualizar os resultados em gr√°fico (Figura 7.16).\nFigura 7.16: Gr√°fico de caixa mostrando o resultado da ANOVA de blocos aleatorizados.\nInterpreta√ß√£o dos resultadosNeste exemplo, rejeitamos hip√≥tese nula de que dist√¢ncia das po√ßas artificiais at√© bordas dos fragmentos florestais n√£o influ√™ncia riqueza de esp√©cies de anuros. po√ßas artificiais instaladas nas bordas dos fragmentos florestais apresentaram maior riqueza de esp√©cies que po√ßas distantes.","code":"\n## Cabe√ßalho dos dados\nhead(dados_bloco) \n#>   Riqueza Blocos    Pocas\n#> 1      90      A  Int-50m\n#> 2      95      A Int-100m\n#> 3     107      A    Borda\n#> 4      92      A  Mat-50m\n#> 5      89      A Mat-100m\n#> 6      92      B  Int-50m\n## An√°lise Anova em blocos aleatorizados\nmodel_bloco <- aov(Riqueza ~ Pocas + Error(Blocos), data = dados_bloco)\nsummary(model_bloco)\n#> \n#> Error: Blocos\n#>           Df Sum Sq Mean Sq F value Pr(>F)\n#> Residuals  5   1089   217.8               \n#> \n#> Error: Within\n#>           Df Sum Sq Mean Sq F value Pr(>F)  \n#> Pocas      4   1504   376.1   2.907 0.0478 *\n#> Residuals 20   2588   129.4                 \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Forma errada de an√°lisar Anova em blocos\nmodelo_errado <- aov(Riqueza ~ Pocas, data = dados_bloco)\nanova(modelo_errado)\n#> Analysis of Variance Table\n#> \n#> Response: Riqueza\n#>           Df Sum Sq Mean Sq F value  Pr(>F)  \n#> Pocas      4 1504.5  376.12  2.5576 0.06359 .\n#> Residuals 25 3676.5  147.06                  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Teste de Tuckey's honest significant difference\npairs(lsmeans(model_bloco, \"Pocas\"), adjust = \"tukey\")\n#>  contrast                estimate   SE df t.ratio p.value\n#>  Borda - (Int-100m)        16.000 6.57 20   2.436  0.1463\n#>  Borda - (Int-50m)         19.833 6.57 20   3.020  0.0472\n#>  Borda - (Mat-100m)        15.833 6.57 20   2.411  0.1531\n#>  Borda - (Mat-50m)          8.167 6.57 20   1.244  0.7269\n#>  (Int-100m) - (Int-50m)     3.833 6.57 20   0.584  0.9760\n#>  (Int-100m) - (Mat-100m)   -0.167 6.57 20  -0.025  1.0000\n#>  (Int-100m) - (Mat-50m)    -7.833 6.57 20  -1.193  0.7553\n#>  (Int-50m) - (Mat-100m)    -4.000 6.57 20  -0.609  0.9720\n#>  (Int-50m) - (Mat-50m)    -11.667 6.57 20  -1.777  0.4135\n#>  (Mat-100m) - (Mat-50m)    -7.667 6.57 20  -1.167  0.7692\n#> \n#> P value adjustment: tukey method for comparing a family of 5 estimates\n# Reordenando a ordem que os grupos ir√£o aparecer no gr√°fico.\ndados_bloco$Pocas <- factor(dados_bloco$Pocas, \n                            levels = c(\"Int-100m\", \"Int-50m\", \"Borda\", \"Mat-50m\", \"Mat-100m\"))\n\n## Gr√°fico\nggplot(data = dados_bloco, aes(x = Pocas, y = Riqueza)) + \n    labs(x = \"Po√ßas artificiais\", y = \"Riqueza de esp√©cies de anuros\") +\n    geom_boxplot(color = \"black\", show.legend = FALSE, alpha = 0.4) +\n    geom_jitter(shape = 16, position = position_jitter(0.1), cex = 4, alpha = 0.7) +\n    scale_x_discrete(labels = c(\"-100m\",\"-50m\",\"Borda\", \"50m\", \"100m\")) +\n    tema_livro() +\n    theme(legend.position = \"none\") "},{"path":"cap7.html","id":"an√°lise-de-covari√¢ncia-ancova","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.6.4 An√°lise de covari√¢ncia (ANCOVA)","text":"ANCOVA pode ser compreendida como uma extens√£o da ANOVA com adi√ß√£o de uma vari√°vel cont√≠nua (covari√°vel) medida em todas unidades amostrais (Gotelli Ellison 2012). ideia √© que covari√°vel tamb√©m afete os valores da vari√°vel resposta. N√£o incluir covari√°vel ir√° fazer com que varia√ß√£o n√£o explicada pelo modelo concentre-se nos res√≠duos. Incluindo covari√°vel, o tamanho res√≠duo √© menor e o teste para avaliar diferen√ßas nos tratamentos, que √© o interesse pesquisador, ter√° mais poder estat√≠stico.Exemplo pr√°tico 1 - ANCOVAExplica√ß√£o dos dadosNeste exemplo hipot√©tico, avaliaremos o efeito da herbivoria na biomassa dos frutos de uma esp√©cie de √°rvore na Mata Atl√¢ntica. O delineamento experimental permitiu que alguns indiv√≠duos sofressem herbivoria e outros n√£o. Os pesquisadores tamb√©m mediram o tamanho da raiz dos ind√≠viduos para inseri-la como uma covari√°vel modelo.PerguntaA herbivoria diminiu biomassa dos frutos?Predi√ß√µesOs indiv√≠duos que sofreram herbivoria ir√£o produzir frutos com menor biomassa que os indiv√≠duos sem herbivoriaVari√°veisVari√°veis resposta e preditorasVari√°veis resposta e preditorasdata frame com indiv√≠duos da esp√©cie de planta (unidade amostral) nas linhas e biomassa dos frutos (vari√°vel resposta), herbivoria (vari√°vel preditora categ√≥rica) e tamanho da raiz (covari√°vel cont√≠nua) nas colunasdata frame com indiv√≠duos da esp√©cie de planta (unidade amostral) nas linhas e biomassa dos frutos (vari√°vel resposta), herbivoria (vari√°vel preditora categ√≥rica) e tamanho da raiz (covari√°vel cont√≠nua) nas colunasChecklistVerificar se o seu data frame est√° com unidades amostrais nas linhas e vari√°veis preditoras e respostas nas colunasAn√°liseOlhando os dados usando fun√ß√£o head().C√≥digos para o c√°lculo da ANCOVA (Figura 7.17).\nFigura 7.17: Gr√°ficos de diagn√≥stico dos res√≠duos da ANCOVA.\npremissas da ANCOVA est√£o adequadas. Vamos olhar os resultados modelo.Percebam que o resultado da ANCOVA (Pr(>F) < 0.001) indica que tanto herbivoria como o tamanho da raiz (covari√°vel) t√™m efeitos significativos na biomassa dos frutos. Contudo, intera√ß√£o entre vari√°veis n√£o foi signigicativa. Vamos usar o Likelihood-ratio test (LRT) para ver se podemos seguir com um modelo mais simples (sem intera√ß√£o).intera√ß√£o n√£o √© importante, pois P > 0.05. Seguiremos com o modelo mais simples.Vamos fazer visualizar os resultados em gr√°fico (Figura 7.18).\nFigura 7.18: Gr√°fico de caixa mostrando o resultado da ANCOVA.\nInterpreta√ß√£o dos resultadosNeste exemplo, o tamanho da raiz (covari√°vel) tem uma rela√ß√£o positiva com biomassa dos frutos. Quanto maior o tamanho da raiz, maior biomassa dos frutos. Usando ANCOVA e controlando o efeito da covari√°vel, percebemos que herbivoria tamb√©m afeta biomassa dos frutos. Os indiv√≠duos com o mesmo tamanho de raiz que n√£o sofreram herbivoria produziram frutos com maior biomassa que os indiv√≠duos com herbivoria.","code":"\n## Cabe√ßalho dos dados\nhead(dados_ancova) \n#>    Raiz Biomassa Herbivoria\n#> 1 6.225    59.77   Sem_herb\n#> 2 6.487    60.98   Sem_herb\n#> 3 4.919    14.73   Sem_herb\n#> 4 5.130    19.28   Sem_herb\n#> 5 5.417    34.25   Sem_herb\n#> 6 5.359    35.53   Sem_herb\n## Gr√°fico\n## Ancova\nmodelo_ancova <- lm(Biomassa ~ Herbivoria * Raiz, data = dados_ancova)\n\n# Verificando as premissas da Ancova\nplot_grid(plot_model(modelo_ancova, type = \"diag\"))\n## Resultados do modelo\nanova(modelo_ancova)\n#> Analysis of Variance Table\n#> \n#> Response: Biomassa\n#>                 Df  Sum Sq Mean Sq F value    Pr(>F)    \n#> Herbivoria       1  1941.9  1941.9  35.101 8.764e-07 ***\n#> Raiz             1 17434.1 17434.1 315.124 < 2.2e-16 ***\n#> Herbivoria:Raiz  1   136.7   136.7   2.471    0.1247    \n#> Residuals       36  1991.7    55.3                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Criando modelo sem intera√ß√£o\nmodelo_ancova2 <- lm(Biomassa ~ Herbivoria + Raiz, data = dados_ancova)\n\n## Likelihood-ratio test\nlrtest(modelo_ancova, modelo_ancova2)\n#> Likelihood ratio test\n#> \n#> Model 1: Biomassa ~ Herbivoria * Raiz\n#> Model 2: Biomassa ~ Herbivoria + Raiz\n#>   #Df  LogLik Df  Chisq Pr(>Chisq)\n#> 1   5 -134.91                     \n#> 2   4 -136.24 -1 2.6554     0.1032\n## Gr√°fico\nggplot(data = dados_ancova, aes(x = Raiz, y = Biomassa, fill = Herbivoria)) + \n    labs(x = \"Tamanho da raiz (cm)\", y = \"Biomassa dos frutos (g)\") +\n    geom_point(size = 4, shape = 21, alpha = 0.7) +\n    scale_colour_manual(values = c(\"darkorange\", \"cyan4\")) +\n    scale_fill_manual(values = c(\"darkorange\", \"cyan4\"),\n                      labels = c(\"Com herbivoria\", \"Sem herbivoria\")) +\n    geom_smooth(aes(color = Herbivoria), method = \"lm\", show.legend = FALSE) +\n    tema_livro()"},{"path":"cap7.html","id":"generalized-least-squares-gls","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.7 Generalized Least Squares (GLS)","text":"Em seu artigo cl√°ssico publicado em 1993, Pierre Legendre se pergunta se autocorrela√ß√£o espacial √© um problema ou um novo paradigma (Legendre 1993). Segundo o autor, estudar estruturas espaciais √© tanto uma necessidade, quanto um desafio para pesquisadores da ecologia e conserva√ß√£o que lidam com dados espacialmente distribu√≠dos. Uma vez que todas vari√°veis tipicamente utilizadas em estudos de biodiversidade (popula√ß√µes, condi√ß√µes clim√°ticas, diversidade) possuem algum tipo de estrutura espacial, √© fundamental compreender os motivos de como incluir esta informa√ß√£o nos modelos anal√≠ticos. De fato, Primeira Lei da Geografia postula que ‚Äútodas coisas est√£o relacionadas com todas outras, por√©m coisas pr√≥ximas est√£o mais relacionadas que coisas distantes.‚Äù Como resultado, os valores observados em uma localidade (e.g., composi√ß√£o de esp√©cies) ser√£o mais afetados pelo conjunto de esp√©cies que ocorre nas localidades vizinhas e, desse modo, alguns pontos de coleta podem n√£o ser estatisticamente independentes. Como vimos anteriormente, um dos pressupostos dos modelos lineares √© independ√™ncia das unidades amostrais. Assim, presen√ßa de autocorrela√ß√£o espacial nos res√≠duos viola este pressuposto e, consequentemente, aumenta taxa de Erro Tipo (rejeitar hip√≥tese nula quando ela √© verdadeira) nos modelos. Uma das solu√ß√µes para incorporar depend√™ncia espacial dos res√≠duos √© usar o m√©todo de M√≠nimos Quadrados Generalizados (Generalized Least Squares - GLS). Diferente dos modelos apresentados anteriormente, este m√©todo ajusta explicitamente modelos heterosced√°sticos e com res√≠duos correlacionados (Pinheiro Bates 2000). Para representar estrutura espacial (e, assim, depend√™ncia entre observa√ß√µes) √© necess√°rio incluir vari√°veis espaciais (geralmente coordenadas geogr√°ficas, .e., vetores bimensionais: sensu Pinheiro Bates (2000)) argumento corStruct na fun√ß√£o gls() pacote nlme. Este modelo basicamente assume que estrutura de covari√¢ncia √© uma fun√ß√£o da dist√¢ncia entre localidades (Littell et al. 2006). √â importante ressaltar, todavia, que existem diferentes fun√ß√µes de covari√¢ncia que s√£o discutidas detalhadamente em Littell et al. (2006). Aqui, iremos nos\nconcentrar nas seguintes fun√ß√µes.Esf√©rica: corSpher(form=\\~lat+long)Exponencial: corExp(form=\\~lat+long)Gaussiana: corGaus(form=\\~lat+long)Linear: corLin(form=\\~lat+long)Raz√£o quadr√°tica: corRatio(form=\\~lat+long)Exemplo pr√°ticoExplica√ß√£o dos dadosNeste exemplo, utilizamos os dados de riqueza de esp√©cies de √°caros (Oribatidae) em 70 amostras de musgo (g√™nero Sphagnum) (Borcard, Legendre, Drapeau 1992). Para cada amostra, al√©m da riqueza de √°caros, os autores registraram quantidade de √°gua substrato e coordenadas geogr√°ficas. Os dados completos est√£o dispon√≠veis pacote vegan.Modelo linear sem incorporar estrutura espacialVamos inicialmente ajustar um modelo sem incorporar estrutura espacial (Figura 7.19).\nFigura 7.19: Gr√°ficos mostrando premissas da regress√£o linear simples.\nAcessando informa√ß√£o espacial com o GLSComo dito, dependendo da estrutura espacial de suas vari√°veis (dependentes, independentes, covari√°veis), o pressuposto de independ√™ncia dos res√≠duos pode ser afetado e, desse modo, o modelo linear convencional ter√° maior chance de Erro Tipo . Abaixo, iremos comparar um modelo GLS sem incorporar estrutura espacial (o que √© exatamente igual ao modelo criado acima Modelo Linear) com diferentes modelos que utilizam explicitamente res√≠duos correlacionados.Uma maneira de identificar se os res√≠duos modelo linear apresentam estrutura espacial √© fazendo uma figura chamada variograma. O variograma possui tr√™s par√¢metros: ) nugget , ii) range e iii) sill (Fortin Dale 2005). O nugget √© utilizado para quantificar variabilidade observada nos valores menores (ou seja, em pequenas dist√¢ncias). O range, por sua vez, √© usado para identificar dist√¢ncia m√°xima em que autocorrela√ß√£o espacial est√° presente (Figura 7.20, pontos laranjas). Deste modo, os valores posicionados partir range (Figura 7.20, pontos verdes) representam pontos n√£o correlacionados (Fortin Dale 2005). posi√ß√£o limiar que representa claramente ‚Äúpausa‚Äù crescimento da curva (range) indica os pontos n√£o correlacionados e representa o sill (Figura 7.20). exemplo da Figura 7.20, o sill √© constante. Por√©m, √© poss√≠vel que os valores de sill n√£o sejam constantes (Chiles Delfiner 1999). Um exemplo √© o ‚Äúefeito buraco‚Äù que √© caracterizado por um ou mais picos (ou vales) variograma que correspondem ao n√∫mero de valores negativos na covari√¢ncia. Esses valores sugerem que valores altos podem estar rodeados de valores baixos (Chiles Delfiner 1999). Por√©m, os detalhamentos desses comportamentos vai al√©m escopo deste livro.\nFigura 7.20: Variograma representando semi-vari√¢ncia y(h) em fun√ß√£o intervalor espacial h. Cada ponto representa dist√¢ncia entre localidades e linha varia√ß√£o te√≥rica fun√ß√£o de covari√¢ncia esf√©rica (veja abaixo). Adaptado de Fortin Dale (2005).\nAbaixo, podemos analisar o variograma para os res√≠duos modelo GLS ajustado (Figura 7.21).\nFigura 7.21: Variograma para os res√≠duos modelo GLS ajustado.\nO primeiro passo √© utilizar diferentes variogramas te√≥ricos para identificar o melhor modelo que representa estrutura espacial dos seus dados.Agora, depois de ajustar o modelo GLS com os diferentes variogramas √© necess√°rio comparar os modelos para escolher o mais ‚Äúprov√°vel,‚Äù utilizando sele√ß√£o de modelos pelo Crit√©rio de Sele√ß√£o de Akaike (AIC) (Chiles Delfiner 1999; K. . Burnham Anderson 2002; Fortin Dale 2005) (Figura 7.22). AIC √© um m√©todo estat√≠stico que compara os modelos criados na sua pesquisa e seleciona o melhor entre eles. Diferente LRT que compara apenas modelos aninhados, o AIC compara modelos com diferentes combina√ß√µes de vari√°veis preditoras. Uma vez que f√≥rmula AIC penaliza par√¢metros extras modelo, se dois modelos explicam igualmente varia√ß√£o dos dados, o modelo com menos par√¢metros ter√° o menor valor de AIC e ser√° selecionado como o melhor modelo. üìù Importante \nO valor de AIC por si s√≥ n√£o tem significado. Ele precisa ser comparado com outro modelo. Contudo, um modelo s√≥ ser√° considerado superior outro quando diferen√ßa entre os seus valores de AIC (.e, delta) forem maiores que 2. (K. . Burnham Anderson 2002)\nFigura 7.22: Gr√°fico dos res√≠duos em rela√ß√£o aos dodos ajustados modelo GLS Ratio.\nO variograma ajustado pelo modelo raz√£o quadr√°tica (ratio_model) demonstra que o range n√£o √© crescente (indicando correla√ß√£o espacial entre localidades pr√≥ximas) e, desse modo, sugere que √© mais apropriado usar o modelo GLS que um modelo linear desconsiderando estrutura espacial (Figura 7.23).\nFigura 7.23: Variogramas para os res√≠duos modelo GLS Normal e Ratio.\nInterpreta√ß√£o dos resultadosDessa forma, O valor mais apropriado da estat√≠stica t √© de -4.33 (ratio_model) ao inv√©s de -7.78 (no_spat_gls). Neste caso, decis√£o (quantidade de √°gua afetando riqueza de √°caros) n√£o foi afetada (P < 0.05 nos dois modelos), somente estat√≠stica teste.","code":"\n## Calcular a riqueza de esp√©cies em cada comunidade\nriqueza <- specnumber(mite) \n\n## Selecionar a vari√°vel ambiental - quantidade de √°gua no substrato\nagua <- mite.env[,2]\n\n## Criar um data.frame com riqueza, quantidade de √°gua no substrato e coordenadas geogr√°ficas\nmite_dat <- data.frame(riqueza, agua, coords)\n## Modelo\nlinear_model <- lm(riqueza ~ agua, mite_dat) \n\n## Res√≠duos\npar(mfrow = c(2, 2)) \nplot(linear_model, which = 1:4)\n\n## Resultados do modelo\nres_lm <- summary(linear_model)\n\n## Coeficiente de determina√ß√£o e coeficientes\nres_lm$adj.r.squared\n#> [1] 0.4632024\nres_lm$coefficients\n#>               Estimate  Std. Error  t value     Pr(>|t|)\n#> (Intercept) 24.3040255 1.249094710 19.45731 1.687907e-29\n#> agua        -0.0223793 0.002876239 -7.78075 5.481035e-11\n## Modelo gls sem estrutura espacial\nno_spat_gls <- gls(riqueza ~ agua, mite_dat, method = \"REML\")\n## Variograma\nvariog_mod1 <- nlme::Variogram(no_spat_gls, form = ~lat+long, \n                               resType = \"normalized\") \n\n## Gr√°fico\nplot(variog_mod1)\n\n## √çndice I de Moran\n\n## Primeiro precisamos calcular uma matriz de dist√¢ncias geogr√°ficas entre as comunidades\ndat_dist <- pdist(coords) # matriz de dist√¢ncia\n\nMoran.I(x = mite_dat$riqueza, w = dat_dist)\n#> $observed\n#> [1] -0.2398147\n#> \n#> $expected\n#> [1] -0.01449275\n#> \n#> $sd\n#> [1] 0.009971923\n#> \n#> $p.value\n#> [1] 4.783614e-113\n## Covari√¢ncia esf√©rica\nespher_model <- gls(riqueza ~ agua, mite_dat, \n                    corSpher(form = ~lat+long, nugget = TRUE))\n\n## Covari√¢ncia exponencial\nexpon_model <- gls(riqueza ~ agua, mite_dat, \n                   corExp(form = ~lat+long, nugget = TRUE))\n\n## Covari√¢ncia Gaussiana\ngauss_model <- gls(riqueza ~ agua, mite_dat, \n                   corGaus(form = ~lat+long, nugget = TRUE))\n\n## Covari√¢ncia linear\ncor_linear_model <- gls(riqueza ~ agua, mite_dat, \n                        corLin(form = ~lat+long, nugget = TRUE))\n\n## Covari√¢ncia raz√£o quadr√°tica\nratio_model <- gls(riqueza ~ agua, mite_dat, \n                   corRatio(form = ~lat+long, nugget = TRUE))\n## Sele√ß√£o de modelos\naic_fit <- AIC(no_spat_gls, espher_model, expon_model, gauss_model, cor_linear_model, ratio_model)\naic_fit %>% arrange(AIC)\n#>   df      AIC\n#> 1  5 373.1186\n#> 2  5 373.2439\n#> 3  3 383.8616\n#> 4  5 387.8616\n#> 5  5 387.8616\n#> 6  5 387.8616\n\n## Gr√°fico\nplot(residuals(ratio_model, type = \"normalized\") ~ fitted(ratio_model))\n## Varigrama\nratio_variog <- Variogram(ratio_model, form = ~lat+long, resType = \"normalized\")\n\n## Resumo dos modelos\nsummary(ratio_model)$tTable \n#>                  Value   Std.Error   t-value      p-value\n#> (Intercept) 22.1612850 2.444329887  9.066405 2.561826e-13\n#> agua        -0.0151894 0.003505891 -4.332536 4.976757e-05\nsummary(no_spat_gls)$tTable\n#>                  Value   Std.Error  t-value      p-value\n#> (Intercept) 24.3040255 1.249094710 19.45731 1.687907e-29\n#> agua        -0.0223793 0.002876239 -7.78075 5.481035e-11\n\n## Gr√°ficos\nplot(ratio_variog, main = \"Variograma como Modelo Ratio\")\nplot(variog_mod1, main = \"Variograma Modelo Normal\")"},{"path":"cap7.html","id":"para-se-aprofundar-3","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.8 Para se aprofundar","text":"Recomendamos aos interessados os livros: ) Zar (2010) Biostatiscal analysis, ii) Gotelli & Ellison (2012) primer ecological statistics, iii) Quinn & Keough (2002) Experimental design data analysis biologists, iv) Zuur e colabodores (2007) Analysing Ecological Data e v) Touchon (2021) Applied statistics R: practical guide life sciences.","code":""},{"path":"cap7.html","id":"exerc√≠cios-3","chapter":"Cap√≠tulo 7 Modelos lineares","heading":"7.9 Exerc√≠cios","text":"7.1\nAvalie se os indiv√≠duos machos de uma esp√©cie de aranha s√£o maiores que f√™meas. Qual sua interpreta√ß√£o sobre o dimorfismo sexual nesta esp√©cie? Fa√ßa um gr√°fico boxplot usando tamb√©m fun√ß√£o geom_jitter(). Use os dados Cap7_exercicio1 dispon√≠vel pacote ecodados.7.2\nAvalie se o n√∫mero de polinizadores visitando uma determinada esp√©cie de planta √© dependente da presen√ßa ou aus√™ncia de predadores. mesma planta, em tempos diferentes, foi utilizada como unidade amostral para os tratamentos com e sem predadores. Qual sua interpreta√ß√£o sobre os resultados? Fa√ßa um gr√°fico boxplot ligando os resultados da mesma planta com e sem presen√ßa predador. Use os dados Cap7_exercicio2 dispon√≠vel pacote ecodados.7.3\nAvalie se existe correla√ß√£o entre o n√∫mero de filhotes nos ninhos de uma esp√©cie de ave com o tamanho fragmento florestal. Qual sua interpreta√ß√£o dos resultados? Fa√ßa um gr√°fico mostrando rela√ß√£o entre vari√°veis. Use os dados Cap7_exercicio3 dispon√≠vel pacote ecodados.7.4\nAvalie se rela√ß√£o entre o tamanho da √°rea de diferentes ilhas e riqueza de esp√©cies de lagartos. Qual sua interpreta√ß√£o dos resultados? Fa√ßa um gr√°fico mostrando rela√ß√£o predita pelo modelo. Use os dados Cap7_exercicio4 dispon√≠vel pacote ecodados.7.5\nAvalie se existe rela√ß√£o entre abund√¢ncia de uma esp√©cie de roedor com o tamanho da √°rea dos fragmentos florestais e/ou altitude. Fa√ßa uma regress√£o m√∫ltipla. Em seguida, crie diferentes modelos e selecione o mais parcimonioso com base valores teste de Likelihood-ratio test (LRT) e Akaike information criterion (AIC). Qual sua interpreta√ß√£o? Use os dados Cap7_exercicio5 dispon√≠vel pacote ecodados.7.6\nAvalie se o local que machos territoriais ocupam (pasto, cana, floresta) influ√™ncia peso dos indiv√≠duos. Qual sua interpreta√ß√£o dos resultados? Fa√ßa um gr√°fico com os resultados. Use os dados Cap7_exercicio6 dispon√≠vel pacote ecodados.7.7\nAvalie se abund√¢ncia de formigas est√° relacionada com o fato das dom√°cias estarem abertas ou fechadas e com idade das dom√°cias. Verifique intera√ß√£o entre os fatores. Qual sua interpreta√ß√£o dos resultados? Fa√ßa um gr√°fico com os resultados. Use os dados Cap7_exercicio7 dispon√≠vel pacote ecodados.7.8\nAvalie se o n√∫mero de parasitas est√° relacionado com o tamanho corporal de f√™meas de uma esp√©cie de ave. Al√©m disso, use idade das aves como uma co-vari√°vel explicando o n√∫mero de parasitas. Qual sua interpreta√ß√£o dos resultados? Fa√ßa um gr√°fico com os resultados. Use os dados Cap7_exercicio8 dispon√≠vel pacote ecodados.7.9\nAvalie se presen√ßa ou aus√™ncia de predadores afeta riqueza de macroinvertebrados em 10 lagos. Os tratamentos dos predadores foram realizados nos mesmos lagos. Qual sua interpreta√ß√£o dos resultados? Fa√ßa um gr√°fico com os resultados.Use os dados Cap7_exercicio9 dispon√≠vel pacote ecodados.7.10\nAvalie se precipita√ß√£o anual afeta riqueza de esp√©cies de anuros em 44 localidades na Mata Atl√¢ntica. Use coordenadas geogr√°ficas para controlar o efeito da autocorrela√ß√£o espacial. Qual sua interpreta√ß√£o dos resultados das an√°lises com e sem levar em considera√ß√£o autocorrela√ß√£o espacial? Use os dados anuros_ambientais dispon√≠vel pacote ecodados.Solu√ß√µes dos exerc√≠cios.","code":""},{"path":"cap8.html","id":"cap8","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"Cap√≠tulo 8 Modelos Lineares Generalizados","text":"","code":""},{"path":"cap8.html","id":"pr√©-requisitos-do-cap√≠tulo-4","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"Pr√©-requisitos do cap√≠tulo","text":"Pacotes e dados que ser√£o utilizados nesse cap√≠tulo.","code":"\nlibrary(ecodados)\nlibrary(visdat)\nlibrary(tidyverse)\nlibrary(lattice)\nlibrary(RVAideMemoire)\nlibrary(DHARMa)\nlibrary(performance)\nlibrary(MuMIn)\nlibrary(piecewiseSEM)\nlibrary(MASS)\nlibrary(ggExtra)\nlibrary(Rmisc)\nlibrary(emmeans) \nlibrary(sjPlot)\nlibrary(bbmle)\nlibrary(glmmTMB)\nlibrary(ordinal)\nlibrary(car)\nlibrary(ecolottery)\nlibrary(naniar)\nlibrary(vcd)\nlibrary(generalhoslem)\n\n## Dados\nlagartos <- ecodados::lagartos\nparasitas <- ecodados::parasitas\nfish <- ecodados::fish\nfragmentos <- ecodados::fragmentos\nuv_cells <- ecodados::uv_cells"},{"path":"cap8.html","id":"introdu√ß√£o-2","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.1 Introdu√ß√£o","text":"Cap√≠tulo 7, descrevemos sobre os modelos lineares (tamb√©m chamados de Modelos Lineares Gerais) que podem ser descritos pelo mesmo modelo matem√°tico de uma equa√ß√£o da reta tipo::\\[Y = \\beta_0 + \\beta_{1}X_i + \\epsilon_i\\]Nesse tipo de estrutura, o que difere uma regress√£o linear de uma an√°lise de vari√¢ncia √© natureza elemento xi, vari√°vel cont√≠nua para regress√£o lineare e vari√°vel categ√≥rica caso da ANOVA (que √© codificada numa matriz design para desenhos mais complexos). Nesse sentido, o que todos esses m√©todos t√™m em comum √© vari√°vel resposta Y que √© um vetor num√©rico cont√≠nuo. Outro elemento em comum desses m√©todos √© distribui√ß√£o de frequ√™ncia erro. Se quiser mais detalhes como sobre modelos lineares podem ser escritos na forma de matrizes, consulte introdu√ß√£o de (Fox, Negrete-Yankelevich, Sosa 2015). Todos os modelos lineares assumem que distribui√ß√£o erro seja Gaussiana (ou Normal). Isso de certa forma limita o tipo de dado que pode ser usado como vari√°vel resposta por estas an√°lises. Por exemplo, dados de contagem (e.g., riqueza e/ou abund√¢ncia de esp√©cies), frequ√™ncia (e.g., frequ√™ncia de ocorr√™ncia, porcentagem de cobertura vegetal), incid√™ncia (e.g., presen√ßa ou aus√™ncia de uma esp√©cie) ou propor√ß√£o (e.g., n√∫meros de animais infectados cada 1000 animais) n√£o s√£o adequados para serem utilizados como vari√°veis resposta em modelos lineares. Uma pr√°tica comum quando nossos dados n√£o s√£o Normais √© transformar por logar√≠tmo ou raiz quadrada. entanto, para dados de contagem isso n√£o √© recomendado - veja O‚ÄôHara & Kotze (2010), Ives (2015) e Warton (2018) para mais detalhes.Nestes casos, devemos recorrer um conjunto de modelos chamados Modelos Lineares Generalizados (GLM). Nestes modelos, o usu√°rio especifica distribui√ß√£o de frequ√™ncia que deseja utilizar para modelar vari√°vel resposta. Esta distribui√ß√£o de frequ√™ncia deve pertencer √† fam√≠lia exponencial, que inclui distribui√ß√£o de Poisson, Gaussiana, binomial, binomial negativa, Gamma, Bernoulli e Beta. Ainda √© poss√≠vel utilizar Cumulative Link Models para modelar dados ordinais (fatores cuja ordem dos elementos importa, tais como muito baixo, baixo, alto e muito alto). Abaixo vamos ver um pouco sobre como um GLM funciona e exemplos com cada uma destas distribui√ß√µes.","code":""},{"path":"cap8.html","id":"como-um-glm-funciona","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.2 Como um GLM funciona?","text":"Diferentemente modelo linear, um GLM estima os par√¢metros por meio de M√°xima Verossimilhan√ßa (ML) ao inv√©s dos M√≠nimos Quadrados Comuns, tamb√©m chamados de M√≠nimos Quadrados Ordin√°rios (OLS).Portanto, um GLM relaciona distribui√ß√£o da vari√°vel resposta aos preditores lineares por meio de uma fun√ß√£o de liga√ß√£o. Por exemplo, caso da distribui√ß√£o de Poisson, usa-se uma liga√ß√£o logar√≠tmica (tamb√©m chamada de log link) que garante que o valores ajustados s√£o sempre n√£o negativos. Portanto, um GLM √© composto por esses tr√™s componentes: ) fun√ß√£o de distribui√ß√£o, ii) preditor linear e iii) fun√ß√£o de liga√ß√£o. fun√ß√£o de distribui√ß√£o √© uma hip√≥tese sobre distribui√ß√£o da vari√°vel resposta Yi. Isso tamb√©m define m√©dia e vari√¢ncia de Yi. J√° fun√ß√£o de liga√ß√£o define rela√ß√£o entre o valor m√©dio de Yi e da parte sistem√°tica. Esta √© tamb√©m chamada de liga√ß√£o entre m√©dia e parte sistem√°tica modelo. Existem tr√™s tipos de fun√ß√£o de liga√ß√£o:Identity link, que √© definido por g(¬µ) = Œº, e modela m√©dia ou valor esperado de Y. Usado em modelos lineares padr√£oIdentity link, que √© definido por g(¬µ) = Œº, e modela m√©dia ou valor esperado de Y. Usado em modelos lineares padr√£oLog link, que √© g(Œº) = log(Œº), e modela o log da m√©dia. √â usado para dados de contagem (que n√£o podem assumir valores negativos) em modelos log-linearLog link, que √© g(Œº) = log(Œº), e modela o log da m√©dia. √â usado para dados de contagem (que n√£o podem assumir valores negativos) em modelos log-linearLogit link, que √© g(Œº) = log[Œº/(1-Œº)], e √© usado para dados bin√°rios e regress√£o log√≠sticaLogit link, que √© g(Œº) = log[Œº/(1-Œº)], e √© usado para dados bin√°rios e regress√£o log√≠sticaLogo, um modelo linear pode ser visto como um caso particular de um GLM em que utiliza distribui√ß√£o Gaussiana, com identity link.","code":""},{"path":"cap8.html","id":"como-escolher-a-distribui√ß√£o-correta-para-seus-dados","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.3 Como escolher a distribui√ß√£o correta para seus dados?","text":"","code":""},{"path":"cap8.html","id":"para-dados-cont√≠nuos","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.3.1 Para dados cont√≠nuos","text":"Se Y √© uma vari√°vel cont√≠nua, sua distribui√ß√£o de probabilidade deve ser normal. Nesses casos distribui√ß√µes recomendadas s√£o Gaussiana (Normal) ou Gamma. Para essas distribui√ß√µes, o par√¢metro de dispers√£o √© estimado separadamente da m√©dia e √© √†s vezes, chamado de nuisance parameter. Uma particularidade da distribui√ß√£o Gamma √© que ela s√≥ aceita valores cont√≠nuos positivos.","code":""},{"path":"cap8.html","id":"para-dados-de-contagem","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.3.2 Para dados de contagem","text":"Se Y √© bin√°rio (e.g., vivo ou morto), distribui√ß√£o de probabilidade deve ser binomial.Se Y √© uma contagem (e.g., abund√¢ncia ou riqueza de esp√©cies), ent√£o distribui√ß√£o de probabilidade deve ser Poisson ou binomial negativa. Existem tamb√©m corre√ß√µes dessas distribui√ß√µes quando apresentam sobredispers√£o (overdispersion), tais como quasi-Poisson ou quasi-Negative binomial. Falaremos delas momento certo.Para distribui√ß√µes tais como binomial e Poisson, vari√¢ncia deve ser igual √† media e o par√¢metro de dispers√£o √© sempre 1. Na maioria dos dados ecol√≥gicos esse pressuposto n√£o √© cumprido, veremos estrat√©gias para lidar com isso logo √† frente.fun√ß√µes Ord_plot() e goodfit() pacote vcd podem auxiliar na escolha da distribui√ß√£o para dados de contagem.","code":""},{"path":"cap8.html","id":"dados-de-contagem-a-distribui√ß√£o-de-poisson","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.4 Dados de contagem: a distribui√ß√£o de Poisson","text":"Para casos em que estamos interessados em quantificar uma vari√°vel discreta, ou seja, uma vari√°vel positiva, representada sempre por n√∫meros inteiros, contendo um n√∫mero finito de possibilidades, devemos utilizar distribui√ß√£o de Poisson. Esta distribui√ß√£o √© peculiar por ser descrita apenas por um par√¢metro livre (\\(\\lambda\\)). Isso quer dizer que tanto m√©dia quanto vari√¢ncia dos dados s√£o descritos por um √∫nico par√¢metro, o que implica em dizer que m√©dia e vari√¢ncia t√™m de ser iguais.Vamos ver um exemplo com dados reais.Exemplo 1Explica√ß√£o dos dadosNeste exemplo, iremos utilizar dados de riqueza de anf√≠bios anuros coletados em 40 po√ßas, a√ßudes e brejos ao redor de fragmentos florestais Noroeste Paulista (Prado Rossa-Feres 2014). Os autores mediram seis vari√°veis em escala local e outras tr√™s em escala de paisagem.PerguntaA dist√¢ncia linear para o corpo d‚Äô√°gua mais pr√≥ximo influencia abund√¢ncia total de esp√©cies de anuros?Predi√ß√µesCorpos d‚Äô√°gua mais conectados permitem que indiv√≠duos dispersem entre eles com maior facilidade, suportando melhor din√¢micas de metapopula√ß√µes. Portanto, espero que po√ßas que estejam mais conectadas entre si tenham maior riqueza total de anuros.Vari√°veisVari√°vel reposta: riqueza de anuros em 40 po√ßasVari√°vel preditora: dist√¢ncia da po√ßa focal para mais pr√≥xima na escala da paisagemChecklistVerificar se o seu data frame est√° com unidades amostrais nas linhas (neste caso po√ßas) e vari√°veis nas colunasAntes de come√ßar com an√°lise, vamos primeiro explorar os dados.Percebam que o data frame cont√©m 40 colunas. Neste conjunto de dados vari√°veis preditoras j√° est√£o padronizadas com m√©dia 0 e desvio padr√£o 1. vari√°veis com ‚Äú2‚Äù indicam vari√°veis quadr√°ticas (podem ser usadas para se testar rela√ß√µes n√£o lineares). Tamb√©m temos riqueza observada e estimada (Riqueza_HB) e coordenadas geogr√°ficas (X e Y). Vamos agora explorar os dados e ver como √© rela√ß√£o entre riqueza e dist√¢ncia para po√ßa mais pr√≥xima. Sempre √© recomendado visualizar os dados antes de efetivamente os modelar para se ter uma id√©ia da rela√ß√£o entre vari√°veis (Figura 8.1).\nFigura 8.1: Gr√°fico pareado para explorar vari√°veis.\nAqui vemos que h√° de fato uma rela√ß√£o linear positiva entre duas vari√°veis.partir de agora vamos sempre usar uma mesma estrutura para realizar nossos exerc√≠cios de modelagem:Primeiro vamos especificar o modeloDepois realizar diagnosePor √∫ltimo realizar infer√™ncia partir nosso modeloModelagemO primeiro argumento da fun√ß√£o glm() √© uma f√≥rmula, em que na parte esquerda temos vari√°vel resposta seguida s√≠mbolo ~ (l√™-se: modelado em fun√ß√£o de) seguido pelas vari√°veis preditoras. Aqui podemos usar uma ou mais vari√°veis e testar o seu efeito aditivo (usando o sinal de +) ou intera√ß√£o entre elas (usando o sinal de *). Um bom resumo sobre como especificar o seu modelo pode ser encontrada aqui neste blog. Aqui optamos por um modelo bem simples modelando riqueza de anf√≠bios apenas em fun√ß√£o da dist√¢ncia para o fragmento mais pr√≥ximo.Assim como modelos lineares que vimos Cap√≠tulo 7, GLMs com distribui√ß√£o de Poisson requerem que se realizem testes de pressupostos de normalidade e homogeneidade de vari√¢ncia dos res√≠duos, assim como sobredispers√£o e infla√ß√£o de zeros.Diagnose b√°sica dos res√≠duos modeloIremos realizar tr√™s diagnoses b√°sicas dos GLMs, avaliando diferentes aspectos modelo:Homogeneidade da vari√¢ncia e normalidade dos res√≠duosSobredispers√£o (Overdispersion)Infla√ß√£o de zeros (Zero-inflation)Vamos come√ßar avaliando homogeneidade da vari√¢ncia e normalidade dos res√≠duos (Figura 8.2).\nFigura 8.2: Diagnose b√°sica dos res√≠duos modelo GLM Poisson.\nVemos que linhas vermelhas (que indicam tend√™ncia dos dados) est√£o praticamente retas seguindo linha pontilhada, sugerindo que existe homogeneidade de vari√¢ncia dos res√≠duos. Vemos tamb√©m que nos quatro plots alguns dados, 1, 7 e 30 (referem-se √†s linhas data frame) aparecem identificados, pois apresentam ligeiro desvio da normalidade e est√£o distantes da m√©dia. entanto, n√£o √© algo para nos preocuparmos, pois n√£o s√£o valores muito extremos. Portanto, diagnose b√°sica indicou que o modelo com Poisson parece ser adequado para modelar estes dados, ao menos em termos de homogeneidade de vari√¢ncia.Diagnose avan√ßada dos res√≠duos modeloAlguns pacotes permitem calcular outros aspectos modelo que facilitam diagnose, ou seja, se podemos de fato confiar nos par√¢metros estimados por eles, incluindo valores de signific√¢ncia. Um pressuposto importante dos modelos de contagem (incluindo Poisson) √© sobredispers√£o (overdispersion).Vejamos como o pacote DHARMa funciona (Figura 8.3).\nFigura 8.3: Diagnose avan√ßada dos res√≠duos modelo GLM Poisson.\nO plot claramente indica que h√° problema com overdispersion, mas n√£o em termos de desvios de normalidade (KS test) ou outlier, j√° que apenas o primeiro foi significativo (aparece em vermelho).Detectando e lidando com overdispersionO que √© sobredispers√£o (overdispersion)? Ela ocorre quando vari√¢ncia observada √© muito maior que aquela predita pelo modelo. Para modelos que utilizam distribui√ß√£o de Poisson, isso ocorre quando vari√¢ncia aumenta com m√©dia. Lembre-se de que esta distribui√ß√£o tem apenas um √∫nico par√¢metro para descrever tanto m√©dia quanto vari√¢ncia (\\(\\lambda\\)). Portanto, vari√¢ncia tem de ser igual √† m√©dia. entanto, se vari√¢ncia nos dados observados muito maior que m√©dia, dizemos que h√° sobredispers√£o nos dados.Existem duas formas de diagnosticar overdispersion que est√£o implementadas na maioria dos pacotes. Aqui vamos demonstr√°-las usando fun√ß√µes check_overdispersion() e testDispersion() dispon√≠veis nos pacotes performance e DHARMa, respectivamente.fun√ß√£o testDispersion() DHARMa utiliza um m√©todo de aleatoriza√ß√£o dos res√≠duos para determinar se h√° overdispersion nos dados, cuja vantagem √© que aborda diretamente varia√ß√£o nos dados, ao inv√©s de medir o ajuste modelo em si, com outros testes (Figura 8.4).\nFigura 8.4: Teste de overdispersion pacote DHARMa.\nAqui temos um gr√°fico e o resultado novamente teste de overdispersion (que j√° aparecia gr√°fico anterior) mostrando que de fato h√° overdispersion: perceba que o valor de P √© significativo. O gr√°fico nos mostra em cinza distribui√ß√£o dos res√≠duos aleatorizados e linha vermelha o valor observado da estat√≠stica. J√° que linha est√° bem √† direita da distribui√ß√£o, isso indica overdispersion, se estivese √† esquerda seria o caso de underdispersion.Agora vamos utilizar fun√ß√£o check_overdisperion() que utiliza uma distribui√ß√£o qui-quadradado e o valor de dispersion ratio para testar presen√ßa de overdispersion modelo. Esse teste tamb√©m pode ser feito com fun√ß√£o acima ao se especificar o argumento type=\"PearsonChisq\".Quando este resultado √© significativo, como vimos na √∫ltima linha acima, isso indica que h√° overdispersion.Usando fun√ß√£o summary() podemos ter um resumo e descri√ß√£o dos par√¢metros modelo.Na parte de baixo output da fun√ß√£o summary() tamb√©m podemos calcular o dispersion parameter dividindo o residual deviance pelos graus de liberdade dos res√≠duos. Esta √© outra maneira f√°cil e r√°pida de detectar overdispersion. Neste exemplo, temos que Dispersion parameter = 1.8119903. Quando esse valor √© pr√≥ximo de 1, isso sugere que n√£o h√° overdispersion. entanto, se ele maior que 1.5, isso sugere que o modelo sofre de overdispersion e que devemos usar outra distribui√ß√£o, tal como distribui√ß√£o binomial negativa, por exemplo.Al√©m disso, uma outra forma de diagnosticar o modelo √© calcular os res√≠duos de Pearson (res√≠duos normalizados), que √© basicamente raiz quadrada da vari√¢ncia da vari√°vel resposta.Infla√ß√£o de zerosQualquer das formas mostradas acima de diagnosticar overdispersion pode ser usada na maioria das vezes, com exce√ß√£o de dados com muitos zeros (pouca vari√¢ncia). Por isso, devemos tamb√©m testar se o nosso modelo sofre de infla√ß√£o de zeros. Vejamos como isso funciona usando fun√ß√µes check_zeroinflation() pacote performanace e testZeroInflation() pacote DHARMa (Figura 8.5).\nFigura 8.5: Teste de infla√ß√£o de zeros pacote DHARMa.\nTanto fun√ß√£o DHARMa quanto performance conseguiram detectar que o modelo tem problemas com overdispersion, mas isso n√£o √© causado pelo excesso de zeros. Como j√° dissemos acima, caso da distribui√ß√£o Poisson, tanto m√©dia quanto vari√¢ncia s√£o modeladas pelo mesmo par√¢metro (\\(\\lambda\\)). Isso faz com que esta distribui√ß√£o n√£o seja muito √∫til para modelar dados de contagem em que haja muita vari√¢ncia em torno da m√©dia. Esse infelizmente √© o caso da grande maioria dos dados ecol√≥gicos.Por estes motivos, n√£o podemos fazer infer√™ncia com este modelo porque os par√¢metros estimados n√£o s√£o confi√°veis. Mas vejamos como seria feita essa infer√™ncia caso este modelo fosse adequado.Infer√™nciaAqui iremos apresentar v√°rias fun√ß√µes para calcular o coeficiente de determina√ß√£o (R2). caso de GLM(M)s, n√£o h√° um consenso sobre como se calcula este coeficiente, havendo v√°rias propostas que utilizam maneiras diferentes de estimar homogeneidade de vari√¢ncia e covari√¢ncia entre observa√ß√µes dos res√≠duos, veja (Nakagawa, Johnson, Schielzeth 2017) e (Ives 2015) para maiores detalhes, assim como o help das respectivas fun√ß√µes.Podemos ver que os valores de R2 s√£o bem baixos (em torno de 4 - 5%), independente m√©todo que usamos pra calcul√°-lo.Plot modelo preditoVamos realizar visualiza√ß√£o ajusto modelo Poisson (Figura 8.6).\nFigura 8.6: Gr√°fico GLM Poisson.\nInterpreta√ß√£o dos resultadosAqui vemos que h√° uma leve tend√™ncia na rela√ß√£o positiva entre dist√¢ncia para o fragmento mais pr√≥ximo e riqueza de anf√≠bios observada. entanto, h√° uma grande dispers√£o nos dados ao redor da reta modelo, fazendo com que rela√ß√£o n√£o seja de fato significativa e tenhamos um R2 bem baixo. Caso pud√©ssemos confiar nos par√¢metros deste modelo, poder√≠amos dizer que existe uma leve tend√™ncia um aumento da riqueza observada de anf√≠bios anuros √† medida que aumenta dist√¢ncia da po√ßa para o fragmento mais pr√≥ximo.","code":"\n## Explorar os dados\nglimpse(fragmentos)\n#> Rows: 40\n#> Columns: 40\n#> $ locality    <chr> \"MAC\", \"MAC\", \"MAC\", \"MAC\", \"MAC\", \"MAC\", \"NOV\", \"NOV\", \"NOV\", \"NOV\", \"PIN\", \"PIN\", \"PIN\", \"PIN\", \"PI‚Ä¶\n#> $ site        <chr> \"MacAc1\", \"MacAc2\", \"MacAc3\", \"MacAc4\", \"MacAc5\", \"MacBr1\", \"NovBr1\", \"NovBr2\", \"NovRe2\", \"NovRe3\", \"‚Ä¶\n#> $ Riqueza_obs <int> 3, 11, 10, 10, 3, 9, 2, 8, 9, 8, 6, 4, 8, 8, 6, 17, 15, 13, 8, 10, 12, 14, 14, 12, 8, 4, 10, 7, 13, 1‚Ä¶\n#> $ Riqueza_HB  <int> 6, 13, 12, 13, 6, 12, 5, 11, 12, 11, 8, 7, 10, 11, 9, 18, 17, 15, 11, 13, 14, 16, 16, 13, 11, 7, 13, ‚Ä¶\n#> $ Bsc         <int> 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0,‚Ä¶\n#> $ Dne         <int> 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0,‚Ä¶\n#> $ Dnm         <int> 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1,‚Ä¶\n#> $ Dnn         <int> 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1,‚Ä¶\n#> $ Dns         <int> 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1,‚Ä¶\n#> $ Hal         <int> 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1,‚Ä¶\n#> $ Hra         <int> 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1,‚Ä¶\n#> $ Lfu         <int> 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1,‚Ä¶\n#> $ Lla         <int> 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,‚Ä¶\n#> $ Lpo         <int> 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1,‚Ä¶\n#> $ Eun         <int> 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0,‚Ä¶\n#> $ Pce         <int> 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0,‚Ä¶\n#> $ Pcu         <int> 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,‚Ä¶\n#> $ Pfa1        <int> 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0,‚Ä¶\n#> $ Ppa         <int> 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1,‚Ä¶\n#> $ Sfm         <int> 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1,‚Ä¶\n#> $ Sfv         <int> 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1,‚Ä¶\n#> $ Ebi         <int> 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1,‚Ä¶\n#> $ Esp         <int> 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1,‚Ä¶\n#> $ hydrop      <dbl> -2.553590, 0.573255, 0.573255, 0.573255, -2.553590, 0.573255, 0.573255, 0.573255, 0.573255, 0.573255,‚Ä¶\n#> $ hydrop2     <dbl> -2.235730, 0.606300, 0.606300, 0.606300, -2.235730, 0.606300, 0.606300, 0.606300, 0.606300, 0.606300,‚Ä¶\n#> $ vegcov      <dbl> -1.461851, -1.145775, -0.987737, 0.908718, -1.461851, 1.382832, 1.382832, 1.698908, -0.829699, 0.1185‚Ä¶\n#> $ nveg        <dbl> -1.965130, -0.158114, -1.061622, -0.158114, -1.965130, -0.158114, 0.745394, 1.648902, 0.745394, 1.648‚Ä¶\n#> $ fish        <dbl> -1.508310, 0.646419, -1.508310, 0.646419, -1.508310, -1.508310, 0.646419, 0.646419, 0.646419, 0.64641‚Ä¶\n#> $ area        <dbl> -2.418270, 0.147353, -0.564022, -0.348279, -2.315159, -0.601947, 1.556190, -0.255774, 0.875432, 1.295‚Ä¶\n#> $ area2       <dbl> -1.884470, 0.019560, -0.699829, -0.497176, -1.844802, -0.734057, 1.877820, -0.406145, 0.907959, 1.490‚Ä¶\n#> $ depth       <dbl> -1.232668, 0.821168, -0.704539, 0.821168, -1.306019, -1.306019, -0.645858, -0.205750, 1.554680, 1.554‚Ä¶\n#> $ forcov      <dbl> -0.604596, -0.020849, -0.013816, -0.171663, 0.203364, 0.203364, 0.562496, -0.157193, -0.793258, -0.39‚Ä¶\n#> $ forcov2     <dbl> -0.672774, -0.152952, -0.146124, -0.296136, 0.071358, 0.071358, 0.459151, -0.282666, -0.820946, -0.49‚Ä¶\n#> $ forcov10    <dbl> -6.045965, -0.208489, -0.138159, -1.716633, 2.033643, 2.033643, 5.624958, -1.571928, -7.932582, -3.97‚Ä¶\n#> $ dfrag       <dbl> 0.410084, -0.097045, -1.242271, -1.242271, -0.471888, -1.242271, 1.307931, 1.557264, 0.479895, 0.9667‚Ä¶\n#> $ dfrag2      <dbl> 0.166782, -0.381401, -1.059858, -1.059858, -0.688845, -1.059858, 1.510271, 1.967926, 0.254153, 0.9436‚Ä¶\n#> $ dwater      <dbl> 1.198175, 0.970207, -0.121245, -0.087507, 0.162610, -0.121245, -0.087507, -1.355308, 0.113584, -0.193‚Ä¶\n#> $ dwater2     <dbl> 1.166645, 0.864035, -0.299232, -0.270350, -0.042156, -0.299232, -0.270350, -1.045428, -0.088840, -0.3‚Ä¶\n#> $ X           <dbl> -49.9376, -49.9353, -49.9348, -49.9334, -49.9270, -49.9271, -49.2742, -49.3303, -49.3084, -49.3179, -‚Ä¶\n#> $ Y           <dbl> -20.7408, -20.7410, -20.7419, -20.7462, -20.7453, -20.7451, -21.5187, -21.5282, -21.5024, -21.5148, -‚Ä¶\n## Gr√°fico\nggplot(fragmentos, aes(dfrag, Riqueza_obs)) +\n    geom_point(size = 4, alpha = 0.7) +\n    geom_smooth(method = \"lm\") +\n     labs(x = \"Dist√¢ncia para o fragmento mais pr√≥ximo\", \n         y = \"Riqueza observada\") +\n    tema_livro()\n## Modelo\nmod_pois <- glm(Riqueza_obs ~ dfrag, family = poisson(link = \"log\"), data = fragmentos)\n## Diagnose b√°sica\npar(mfrow = c(2, 2))\nplot(mod_pois) \n## Diagnose avan√ßada\nsimulationOutput <- simulateResiduals(fittedModel = mod_pois, plot = TRUE)\n## Overdispersion\npar(mfrow = c(1, 1))\ntestDispersion(mod_pois) # modelo tem overdispersion\n#> \n#>  DHARMa nonparametric dispersion test via sd of residuals fitted vs. simulated\n#> \n#> data:  simulationOutput\n#> dispersion = 1.6489, p-value < 2.2e-16\n#> alternative hypothesis: two.sided\n## Testar a presen√ßa de overdispersion\ncheck_overdispersion(mod_pois) # modelo tem overdispersion\n#> # Overdispersion test\n#> \n#>        dispersion ratio =  1.657\n#>   Pearson's Chi-Squared = 62.951\n#>                 p-value =  0.007\n## Resumo do modelo\nsummary(mod_pois)\n#> \n#> Call:\n#> glm(formula = Riqueza_obs ~ dfrag, family = poisson(link = \"log\"), \n#>     data = fragmentos)\n#> \n#> Deviance Residuals: \n#>     Min       1Q   Median       3Q      Max  \n#> -3.3467  -0.9110   0.0942   0.8336   2.2773  \n#> \n#> Coefficients:\n#>             Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept)   2.3051     0.0500  46.101   <2e-16 ***\n#> dfrag         0.0718     0.0507   1.416    0.157    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for poisson family taken to be 1)\n#> \n#>     Null deviance: 70.868  on 39  degrees of freedom\n#> Residual deviance: 68.856  on 38  degrees of freedom\n#> AIC: 235.29\n#> \n#> Number of Fisher Scoring iterations: 4\n\n## Dispersion parameter\ndeviance(mod_pois) / df.residual(mod_pois)\n#> [1] 1.81199\n## Infla√ß√£o de zeros - performanace\ncheck_zeroinflation(mod_pois) # para diagnosticar se o modelo sofre de zero inflation\n#> Model has no observed zeros in the response variable.\n#> NULL\n\n## Infla√ß√£o de zeros - DHARMa\ntestZeroInflation(mod_pois) # para testar se existe zero inflation\n#> \n#>  DHARMa zero-inflation test via comparison to expected zeros with simulation under H0 = fitted model\n#> \n#> data:  simulationOutput\n#> ratioObsSim = NaN, p-value = 1\n#> alternative hypothesis: two.sided\n## Coeficientes estimados pelo modelo\nsummary(mod_pois)\n#> \n#> Call:\n#> glm(formula = Riqueza_obs ~ dfrag, family = poisson(link = \"log\"), \n#>     data = fragmentos)\n#> \n#> Deviance Residuals: \n#>     Min       1Q   Median       3Q      Max  \n#> -3.3467  -0.9110   0.0942   0.8336   2.2773  \n#> \n#> Coefficients:\n#>             Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept)   2.3051     0.0500  46.101   <2e-16 ***\n#> dfrag         0.0718     0.0507   1.416    0.157    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for poisson family taken to be 1)\n#> \n#>     Null deviance: 70.868  on 39  degrees of freedom\n#> Residual deviance: 68.856  on 38  degrees of freedom\n#> AIC: 235.29\n#> \n#> Number of Fisher Scoring iterations: 4\n\n## Calculando o R2 do modelo\nr.squaredGLMM(mod_pois)\n#>                  R2m        R2c\n#> delta     0.04925800 0.04925800\n#> lognormal 0.05154558 0.05154558\n#> trigamma  0.04696308 0.04696308\nrsquared(mod_pois)\n#>      Response  family link     method  R.squared\n#> 1 Riqueza_obs poisson  log nagelkerke 0.04919844\nr2(mod_pois)\n#> # R2 for Generalized Linear Regression\n#>   Nagelkerke's R2: 0.059\na1 <- ggplot(fragmentos, aes(dfrag, Riqueza_obs)) +\n    geom_point(cex = 4,alpha = 0.7) +\n    geom_smooth(method = \"glm\", formula = y~x, \n                method.args = list(family = \"poisson\"), se = TRUE) +\n    labs(x = \"Dist√¢ncia para o fragmento mais pr√≥ximo\", \n         y = \"Riqueza observada\") +\n    tema_livro()\n\nggMarginal(a1, fill = \"red\")"},{"path":"cap8.html","id":"o-que-causa-a-overdispersion","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.4.1 O que causa a overdispersion?","text":"Existem dois conjuntos de causas: aparente ou real.causas aparentes s√£o geradas pela m√° especifica√ß√£o modelo, tais como:n√£o inclus√£o de covari√°veis ou intera√ß√µes modelopresen√ßa de outliers na vari√°vel respostaefeitos n√£o lineares da covari√°vel (X2, X3‚Ä¶)escolha errada da fun√ß√£o de liga√ß√£o (link function)causas reais incluem:vari√¢ncia maior que m√©diamuitos zerosagrega√ß√£o de observa√ß√µescorrela√ß√£o entre observa√ß√µes (n√£o independ√™ncia)","code":""},{"path":"cap8.html","id":"o-que-fazer-se-seu-modelo-tiver-overdispersion","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.4.2 O que fazer se seu modelo tiver overdispersion?","text":"Depois de tentar corrigir poss√≠veis m√°s especifica√ß√µes, como listadas acima, existem duas alternativas:usar outra distribui√ß√£o, tal como binomial negativa, caso o dispersion parameter seja maior que 15 ou 20Usar um modelo com corre√ß√£o de erro da sobredispers√£o, caso 1.5 < dispersion > 15Geralmente, dados de contagem em estudos ecol√≥gicos n√£o seguem uma distribui√ß√£o Poisson, pois h√° muita dispers√£o (vari√¢ncia) nos dados. Logo, o pressuposto da distribui√ß√£o Poisson, .e., de que m√©dia e vari√¢ncia s√£o descritas por um mesmo par√¢metro (\\(\\lambda\\)) √© quebrado.Como vimos, overdispersion √© um problema comum ao analisar dados ecol√≥gicos e deve necessariamente ser diagnosticado modelo. Uma maneira de lidar com esse tipo de problema √© utilizar uma outra distribui√ß√£o diferente da Poisson. binomial negativa pode ser entendida como uma mistura da distibui√ß√£o Poisson e Gamma, ou seja, ela aceita dados de contagem que sejam positivos, mas sem zero. grande vantagem desta distribui√ß√£o √© que, diferentemente da Poisson, ela tem um par√¢metro para modelar m√©dia (\\(\\lambda\\)) e outro para modelar vari√¢ncia (k). Logo, ela permite modelar dados em que m√©dia √© diferente da vari√¢ncia. Vejamos um exemplo.Aqui vamos continuar com estes dados para ver como o modelo se comporta com essa nova distribui√ß√£o especificada. Para isso vamos utilizar fun√ß√£o glm.nb pacote MASS.ModelagemDiagnose res√≠duosAssim como fizemos com o modelo com Poisson, vamos agora diagnosticar os res√≠duos (Figura 8.7).\nFigura 8.7: Diagnose b√°sica dos res√≠duos modelo GLM binomial Negativo.\nCompare estes gr√°ficos (Figura 8.7) com os modelo anterior com distribui√ß√£o Poisson (Figura 8.2). Eles s√£o praticamente id√™nticos, ou seja, o modelo com Poisson j√° tinha homogeneidade de vari√¢ncia e n√£o tinha problemas com normalidade dos res√≠duos. Agora vejamos se o problema com overdispersion foi resolvido (Figura 8.8).\nFigura 8.8: Diagnose avan√ßada dos res√≠duos modelo GLM binomial Negativo.\nNa diagnose modelo pelo DHARMa, vemos que bastou mudar distribui√ß√£o de probabilidade que o problema de overdispersion foi resolvido (nenhum teste foi significativo quadro da esquerda). Como j√° sab√≠amos, n√£o h√° problemas com homogeneidade de vari√¢ncia (plot da direita mostrando tend√™ncia entre o predito e res√≠duos pra cada quantil), nem de outliers. O dispersion parameter √© mais pr√≥ximo de 1 que modelo com Poisson. Agora sim podemos levar em conta o R2.Infer√™nciaMas esse valor parece ser um pouco menor que anteriormente. Perceba que aqui utilizamos somente uma das fun√ß√µes apresentadas anteriormente, j√° que se trata de um modelo GLM com binomial negativa, calculamos o R2 pelo m√©todo de Nagelkerke.Usando fun√ß√£o summary() podemos ter um resumo e descri√ß√£o dos par√¢metros modelo.Interpreta√ß√£o dos resultadosAqui vemos que interpreta√ß√£o resultado em termos de valor de P n√£o mudou, ou seja, dist√¢ncia para o fragmento mais pr√≥ximo n√£o foi significativo. Mas vejam que o coeficiente (slope) mudou um pouco, antes era 0.0718 (SE=0.0507) e com binomial negativa passa ser 0.07248 (SE=0.06571).Plot modelo preditoVamos realizar visualiza√ß√£o ajusto modelo binomial Negativo (Figura 8.9).\nFigura 8.9: Gr√°fico GLM binomial Negativo.\nAqui vemos que reta predita pelo modelo √© muito similar ao que tivemos com o modelo Poisson. entanto, agora que sabemos que este modelo com binomial negativa foi corretamente especificado e podemos confiar nos par√¢metros estimados.","code":"\n## Ajuste do modelo\nmod_nb <- glm.nb(Riqueza_obs ~ dfrag, data = fragmentos)\n## Diagnose\npar(mfrow = c(2, 2))\nplot(mod_nb)\npar(mfrow = c(1, 1))\n(chat <- deviance(mod_nb) / df.residual(mod_nb)) # DISPERSION PARAMETER\n#> [1] 1.126184\n## Diagnose avan√ßada\nsimulationOutput <- simulateResiduals(fittedModel = mod_nb, plot = TRUE)\n## Coeficiente de determina√ß√£o\nrsquared(mod_nb)\n#>      Response                     family link     method  R.squared\n#> 1 Riqueza_obs Negative Binomial(14.7068)  log nagelkerke 0.02935674\n## Coeficientes estimados pelo modelo\nsummary(mod_nb)\n#> \n#> Call:\n#> glm.nb(formula = Riqueza_obs ~ dfrag, data = fragmentos, init.theta = 14.70679964, \n#>     link = log)\n#> \n#> Deviance Residuals: \n#>     Min       1Q   Median       3Q      Max  \n#> -2.7569  -0.7068   0.0694   0.6194   1.6546  \n#> \n#> Coefficients:\n#>             Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept)  2.30504    0.06481  35.567   <2e-16 ***\n#> dfrag        0.07248    0.06571   1.103     0.27    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for Negative Binomial(14.7068) family taken to be 1)\n#> \n#>     Null deviance: 44.002  on 39  degrees of freedom\n#> Residual deviance: 42.795  on 38  degrees of freedom\n#> AIC: 231.68\n#> \n#> Number of Fisher Scoring iterations: 1\n#> \n#> \n#>               Theta:  14.71 \n#>           Std. Err.:  8.62 \n#> \n#>  2 x log-likelihood:  -225.68\n## Gr√°fico\nggplot(fragmentos, aes(dfrag, Riqueza_obs)) +\n    geom_point(size = 4, alpha = 0.7) +\n    geom_smooth(method = \"glm.nb\", formula = y~x, se = TRUE) +\n    labs(x = \"Dist√¢ncia para o fragmento mais pr√≥ximo\", \n         y = \"Riqueza observada\") +\n    tema_livro()"},{"path":"cap8.html","id":"dados-de-contagem-modelos-quasi-likelihood","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.5 Dados de contagem: modelos quasi-likelihood","text":"Como dissemos acima, uma outra alternativa para ajustar modelos GLM dados de contagem s√£o os chamados ‚Äúquasi-likelihood,‚Äù tais como quasi-Poisson e quasi-binomial. Dependendo valor dispersion parameter, pode ser √∫til escolher este tipo de modelo. entanto, eles v√™m com uma desvantagem: n√£o √© poss√≠vel calcular o valor de Akaike Information Criterion (AIC) porque estes modelos n√£o retornam um valor de likelihood (verosimilhan√ßa). Este par√¢metro √© comumente utilizado em abordagens estat√≠sticas de teoria da informa√ß√£o para selecionar o melhor modelo que se ajusta aos dados. Neste caso, precisamos utilizar outras fun√ß√µes dispon√≠veis nos pacotes MuMIn, AICcmodavg e bbmle para calcular o QAIC. Para mais detalhes sobre esses modelos, veja o vignette sobre o assunto pacote bbmle.An√°liseAqui vamos apenas exemplificar como um modelo com distribui√ß√£o quasi-poisson pode ser especificado.Diagnose dos res√≠duosA fun√ß√£o resid n√£o leva em conta sobredispers√£o e temos de calcular manualmente o par√¢metro de dispers√£o e inclui-lo plot. Portanto, n√£o podemos realizar diagnose de modelos quasi-Poisson apenas com fun√ß√£o plot como faz√≠amos at√© ent√£o. Ent√£o, calculamos primeiramente os res√≠duos de Pearson e depois dividindo-o pela raiz quadrada par√¢metro de dispers√£o (Figura 8.10).\nFigura 8.10: Diagnose dos res√≠duos modelo GLM Quasi-Poisson.\nAqui vemos que n√£o existe um padr√£o claro nos res√≠duos, muito similar ao que t√≠nhamos anteriormente. Devido √†s limita√ß√µes de distribui√ß√µes ‚Äúquasi‚Äù e dado que j√° temos um modelo adequado com binomial negativa, sugerimos interpretar apenas o modelo anterior com binomial negativa.","code":"\n## Modelo\nmod_quasipois <- glm(Riqueza_obs ~ dfrag, family = quasipoisson(link = \"log\"), data = fragmentos)\n## Diagnose dos res√≠duos\nEP <- resid(mod_quasipois, type = \"pearson\")\nED <- resid(mod_quasipois, type = \"deviance\")\nmu <- predict(mod_quasipois, type = \"response\")\nE <- fragmentos$Riqueza_obs - mu\nEP2 <- E / sqrt(1.65662 * mu) # dispersion parameter da quasipoisson\nop <- par(mfrow = c(2, 2))\nplot(x = mu, y = E, main = \"Response residuals\")\nplot(x = mu, y = EP, main = \"Pearson residuals\")\nplot(x = mu, y = EP2, main = \"Pearson residuals scaled\")\nplot(x = mu, y = ED, main = \"Deviance residuals\")\npar(op)\npar(mfrow = c(1, 1))"},{"path":"cap8.html","id":"dados-de-contagem-a-distribui√ß√£o-binomial","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.6 Dados de contagem: a distribui√ß√£o binomial","text":"Quando temos dados de propor√ß√£o (e.g., n√∫mero de doentes por 1000 habitantes) ou incid√™ncia (.e., presen√ßa ou aus√™ncia), distribui√ß√£o mais adequada para modelar os dados √© distribui√ß√£o binomial. entanto, temos que especificar o modelo de acordo com o tipo dos dados argumento formula. Vejamos dois exemplos.","code":""},{"path":"cap8.html","id":"an√°lise-com-dados-de-propor√ß√£o","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.6.1 An√°lise com dados de propor√ß√£o","text":"Neste exemplo, vamos ver como podemos modelar propor√ß√£o de c√©lulas sangu√≠neas em fun√ß√£o tipo de tratamento.Explica√ß√£o dos dadosEste conjunto de dados foi coletado por (Franco-Belussi, De Oliveira, Sk√∂ld 2018). Os autores utilizaram um desenho experimental t√≠pico de uma 2x5 ANOVA fatorial (ou two-way ANOVA) em que temos dois tratamentos (fatores): pigmenta√ß√£o girino com dois n√≠veis (Yes e ) e Tempo de exposi√ß√£o com cinco n√≠veis (controle sem UV, 6 h, 12 h, 18 h e 24 h de exposi√ß√£o √† UV).PerguntaA melanina proteje girinos contra os efeitos da radia√ß√£o ultravioleta?Predi√ß√µesComo melanina participa sistema imune inato, ela desempenharia um papel na resposta organismo √† radia√ß√£o UV, auxiliando c√©lulas imunes combater os seus efeitos delet√©rios.Vari√°veisVari√°vel resposta: Contagem diferencial de eosin√≥filosdata frame com 10 girinos em cada tratamento, totalizando 50 girinosVamos explorar os dados para tentar entender como s√£o rela√ß√µes (Figura 8.11).\nFigura 8.11: Gr√°fico para explorar rela√ß√µes entre vari√°veis.\nAqui vemos que quantidade de eosin√≥filos √© muito maior nos girinos sem pigmenta√ß√£o (‚Äúalbinos‚Äù). J√° que estes animais n√£o t√™m pigmenta√ß√£o mel√¢nica, c√©lulas brancas sangue s√£o √∫nica ferramenta de combate aos efeitos delet√©rios da UV.ModelagemAqui vamos usar o cbind argumento formula para dizer que queremos modelar contagem de eosin√≥filos em rela√ß√£o ao n√∫mero total de c√©lulas, ou seja, sua propor√ß√£o. Aqui temos contagem n√∫mero de eusin√≥filos (um tipo de c√©lula da s√©rie branca sangue) em l√¢minas histol√≥gicas de girinos da r√£-touro (Lithobates catesbeianus) num total de 1000 c√©lulas.Diagnose b√°sica dos res√≠duos modeloVamos fazer diagnose b√°sica dos res√≠duos modelo (Figura 8.12).\nFigura 8.12: Diagnose b√°sica dos res√≠duos modelo GLM binomial.\nParece que os res√≠duos n√£o sofrem de heterogeneidade de vari√¢ncia (linha vermelha est√° reta), mas parece haver um pequeno desvio da normalidade (veja pontos 19, 29 e 32 destacados plot de quantis e de outliers). Vejamos o que o DHARMa nos diz (Figura 8.13).\nFigura 8.13: Diagnose avan√ßada dos res√≠duos modelo GLM binomial.\nAqui j√° n√£o resta d√∫vidas de que os res√≠duos deste modelo sofrem tanto com heterogeneidade de vari√¢ncia, quanto overdispersion e problemas com outliers. Provavelmente o problema com outliers ocorreu por conta pequeno tamanho amostral.Infer√™nciaSabemos que o modelo n√£o parece ser adequado para os dados, mas vamos interpret√°-lo mesmo assim para que possamos entender sa√≠da da fun√ß√£o summary() e os contrastes entre os n√≠veis dos fatores.Aqui temos tanto tabela com os resultados por n√≠veis dos fatores (summary()), quanto tabela com Deviance que mostra os fatores e suas intera√ß√µes (anova()). Vemos que nenhum fator foi significativo. Caso houvesse algum fator significativo, poder√≠amos testar signific√¢ncia de cada n√≠vel dos fatores usando contrastes, desta forma.Aqui temos o valor de cada combina√ß√£o de n√≠veis dos fatores, com seu respectivo valor de contraste e o valor de P. Vemos que para girinos sem pigmenta√ß√£o, apenas tr√™s contrastes foram significativos.Plot modelo preditoVamos realizar visualiza√ß√£o ajusto modelo binomial (Figura 8.14).\nFigura 8.14: Gr√°fico GLM binomial.\nUsando o geom_violin(), podemos perceber que existe uma dispers√£o maior nos tratamentos que utilizaram girinos sem pigmenta√ß√£o que nos tratamentos com girinos pigmentados.","code":"\n## Dados\nhead(uv_cells)\n#>     UV Pigmentation Total_Cell Lymphocyte Neutrophil Basophil Monocyte Eosinophil\n#> 1 1.CT          Yes        100         80         18        0        0          2\n#> 2 1.CT          Yes        100         74         17        6        0          3\n#> 3 1.CT          Yes        100         78         22        0        0          0\n#> 4 1.CT          Yes        100         87         13        0        0          0\n#> 5 1.CT          Yes        100         74         21        1        0          4\n#> 6 2.6h          Yes        100         95          4        0        0          1\n\n## Traduzir nomes das colunas e n√≠veis de pigmenta√ß√£o \ncolnames(uv_cells) <- c(\"UV\", \"Pigmentacao\", \"n_celulas\", \"linfocito\", \"neutrofilo\", \"basofilo\", \"monocito\", \"eosinofilo\")\nuv_cells$Pigmentacao[uv_cells$Pigmentacao==\"Yes\"] <- \"sim\"\nuv_cells$Pigmentacao[uv_cells$Pigmentacao==\"No\"] <- \"nao\"\n## Gr√°fico\n\n# Calcular m√©dia e intervalo de confian√ßa\neosinofilo <- summarySE(uv_cells, \n                        measurevar = \"eosinofilo\",\n                        groupvars = c(\"UV\", \"Pigmentacao\"))\n\n# Definir posi√ß√£o de linhas e pontos no gr√°fico\npd <- position_dodge(0.1)\n\neosinofilo %>% \n  ggplot(aes(x = UV, y = eosinofilo, colour = Pigmentacao,\n             group = Pigmentacao, fill = Pigmentacao)) +\n  geom_errorbar(aes(ymin=eosinofilo-se, ymax=eosinofilo +se), \n                width=.1, size = 1.1, position=pd) +\n  geom_line(position=pd, size = 1.1) +\n  geom_point(pch = 21, colour = \"black\", position=pd, size=3.5) +\n  scale_colour_manual(values = c(\"darkorange\", \"cyan4\")) +\n  scale_fill_manual(values = c(\"darkorange\", \"cyan4\")) +\n  labs(x = \"UV\", y = \"Eosin√≥filo\", fill=\"Pigmenta√ß√£o\", colour=\"Pigmenta√ß√£o\")+\n  tema_livro()\n## Modelo\nmod1 <- glm(cbind(eosinofilo, n_celulas) ~ UV * Pigmentacao, family = binomial, data = uv_cells)\n## Diagnose dos res√≠duos\npar(mfrow = c(2, 2))\nplot(mod1)\npar(mfrow = c(1, 1))\n## Diagnose avan√ßada\nsimulationBion <- simulateResiduals(fittedModel = mod1, plot = TRUE)\nbinned_residuals(mod1)\n#> Warning: Probably bad model fit. Only about 29% of the residuals are inside the error bounds.\n## Coeficientes estimados pelo modelo\nsummary(mod1)\n#> \n#> Call:\n#> glm(formula = cbind(eosinofilo, n_celulas) ~ UV * Pigmentacao, \n#>     family = binomial, data = uv_cells)\n#> \n#> Deviance Residuals: \n#>     Min       1Q   Median       3Q      Max  \n#> -5.4165  -2.5266  -1.0148   0.8068   8.8233  \n#> \n#> Coefficients:\n#>                        Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept)            -1.84516    0.12107 -15.241  < 2e-16 ***\n#> UV2.6h                 -0.17979    0.17835  -1.008   0.3134    \n#> UV3.12h                 0.38414    0.15899   2.416   0.0157 *  \n#> UV4.18h                -0.49825    0.19363  -2.573   0.0101 *  \n#> UV5.24h                -0.39916    0.18848  -2.118   0.0342 *  \n#> Pigmentacaosim         -2.17222    0.35745  -6.077 1.22e-09 ***\n#> UV2.6h:Pigmentacaosim  -0.07152    0.53831  -0.133   0.8943    \n#> UV3.12h:Pigmentacaosim -0.38414    0.50150  -0.766   0.4437    \n#> UV4.18h:Pigmentacaosim  1.13424    0.45981   2.467   0.0136 *  \n#> UV5.24h:Pigmentacaosim  0.68684    0.48370   1.420   0.1556    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 737.36  on 49  degrees of freedom\n#> Residual deviance: 460.85  on 40  degrees of freedom\n#> AIC: 610.35\n#> \n#> Number of Fisher Scoring iterations: 5\nanova(mod1)\n#> Analysis of Deviance Table\n#> \n#> Model: binomial, link: logit\n#> \n#> Response: cbind(eosinofilo, n_celulas)\n#> \n#> Terms added sequentially (first to last)\n#> \n#> \n#>                Df Deviance Resid. Df Resid. Dev\n#> NULL                              49     737.36\n#> UV              4   26.034        45     711.32\n#> Pigmentacao     1  235.682        44     475.64\n#> UV:Pigmentacao  4   14.789        40     460.85\n## Par√¢metros\npairs(emmeans(mod1, ~ UV|Pigmentacao))\n#> Pigmentacao = nao:\n#>  contrast      estimate    SE  df z.ratio p.value\n#>  1.CT - 2.6h     0.1798 0.178 Inf   1.008  0.8518\n#>  1.CT - 3.12h   -0.3841 0.159 Inf  -2.416  0.1109\n#>  1.CT - 4.18h    0.4982 0.194 Inf   2.573  0.0753\n#>  1.CT - 5.24h    0.3992 0.188 Inf   2.118  0.2124\n#>  2.6h - 3.12h   -0.5639 0.167 Inf  -3.384  0.0064\n#>  2.6h - 4.18h    0.3185 0.200 Inf   1.593  0.5021\n#>  2.6h - 5.24h    0.2194 0.195 Inf   1.125  0.7933\n#>  3.12h - 4.18h   0.8824 0.183 Inf   4.824  <.0001\n#>  3.12h - 5.24h   0.7833 0.177 Inf   4.414  0.0001\n#>  4.18h - 5.24h  -0.0991 0.209 Inf  -0.474  0.9897\n#> \n#> Pigmentacao = sim:\n#>  contrast      estimate    SE  df z.ratio p.value\n#>  1.CT - 2.6h     0.2513 0.508 Inf   0.495  0.9879\n#>  1.CT - 3.12h    0.0000 0.476 Inf   0.000  1.0000\n#>  1.CT - 4.18h   -0.6360 0.417 Inf  -1.525  0.5461\n#>  1.CT - 5.24h   -0.2877 0.445 Inf  -0.646  0.9675\n#>  2.6h - 3.12h   -0.2513 0.508 Inf  -0.495  0.9879\n#>  2.6h - 4.18h   -0.8873 0.454 Inf  -1.957  0.2876\n#>  2.6h - 5.24h   -0.5390 0.480 Inf  -1.123  0.7942\n#>  3.12h - 4.18h  -0.6360 0.417 Inf  -1.525  0.5461\n#>  3.12h - 5.24h  -0.2877 0.445 Inf  -0.646  0.9675\n#>  4.18h - 5.24h   0.3483 0.382 Inf   0.911  0.8928\n#> \n#> Results are given on the log odds ratio (not the response) scale. \n#> P value adjustment: tukey method for comparing a family of 5 estimates\nggplot(uv_cells, aes(UV, eosinofilo)) +\n    geom_violin(aes(color = Pigmentacao)) +\n    geom_jitter(shape = 16, position = position_jitter(0.1), cex = 4, alpha = 0.7) +\n    scale_colour_manual(values = c(\"darkorange\", \"cyan4\")) +\n    tema_livro()"},{"path":"cap8.html","id":"an√°lise-com-dados-de-incid√™ncia","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.7 An√°lise com dados de incid√™ncia","text":"Uma outra aplica√ß√£o da distribui√ß√£o binomial √© quando temos dados de incid√™ncia, ou seja, presen√ßa ou aus√™ncia, de alguma vari√°vel. Por exemplo, presen√ßa ou aus√™ncia de uma esp√©cie ou indiv√≠duo num local. Neste caso formula √© diferente e o modelo √© similar uma regress√£o log√≠stica, vejamos.Aqui vamos utilizar os dados sobre autotomia da cauda de lagartos da esp√©cie Coleodactylus meridionalis observados em fragmentos florestais da Mata Atl√¢ntica estado de Pernambuco (C. N. Oliveira et al. 2020).PerguntaA probabilidade de lagartos da esp√©cie Coleodactylus meridionalis perderem (autotomizarem) cauda aumenta com o tamanho corpo e de acordo com o sexo dos lagarto?Predi√ß√µesQuanto maior o lagarto, maior probabilidade de autotomia da cauda e que esta resposta poderia tamb√©m diferir entre sexos devido ao dimorfismo sexual.Vari√°veisVari√°vel resposta: Presen√ßa ou aus√™ncia de cauda autotomizada em lagartos encontrados por busca ativaExplora√ß√£o dos dadosEste conjunto de dados possui muitas entradas faltantes (codificadas como NA). Primeiro vamos visualizar o conjunto de dados e depois precisamos remover linhas que cont√™m dados faltantes. Aqui podemos usar fun√ß√£o interna ggplot2::remove_missing() para remover linhas cujas vari√°veis informadas argumento estejam faltando, vejamos (Figura 8.15).\nFigura 8.15: Gr√°ficos para explorar os dados faltantes.\nAgora, seguindo o que j√° estamos acostumados fazer, vamos vizualisar os dados com nossa hip√≥tese (Figura 8.16).\nFigura 8.16: Gr√°fico para explorar rela√ß√µes entre vari√°veis.\nModelagemAqui vamos construir dois modelos com mesma distribui√ß√£o binomial, mas com dois link function: logit e probit. fun√ß√£o logit possui caudas um pouco mais achatadas, isto √©, curva probit se aproxima dos eixos mais rapidamente que logit. Geralmente n√£o h√° muita diferen√ßa entre elas. Como n√£o temos nenhuma expectativa de qual dos dois link function √© o melhor, podemos fazer uma sele√ß√£o de modelos.Existe pouca diferen√ßa entre o modelo probit e logit. Como o modelo logit √© mais simples vamos interpret√°-lo apenas.Diagnose dos res√≠duos modeloVamos fazer diagnose dos res√≠duos modelo (Figura 8.17).\nFigura 8.17: Diagnose avan√ßada dos res√≠duos modelo GLM binomial de incid√™ncia.\nInfer√™nciaPara modelos com par√¢metro de dispers√£o conhecida (e.g., binomial e Poisson), o chi-quadrado √© estat√≠stica mais apropriada.Interpreta√ß√£o dos resultadosA interpreta√ß√£o dos resultados √© que o tamanho de corpo (SVL) afeta negativamente probabilidade da cauda estar intacta, .e., com o aumento tamanho, probabilidade da cauda permanecer intacta diminui. intera√ß√£o n√£o foi significativa, ent√£o o efeito √© independente sexo dos lagartos.","code":"\n\n## Traduzir nomes das colunas e n√≠veis de pigmenta√ß√£o \nhead(lagartos)\n#>   Numero    Sex   SVL Intact_tail_length Autotomized_tail_length Tail_state\n#> 1      2   Male 20.70                 NA                   12.88          0\n#> 2      3   Male 21.10                 NA                   13.07          0\n#> 3      6 Female 23.72                 NA                   17.56          0\n#> 4      9   Male 18.84              17.38                      NA          1\n#> 5     21   Male 22.20                 NA                   16.50          0\n#> 6     22   <NA> 20.59                 NA                   12.46          0\ncolnames(lagartos) <- c(\"numero\", \"sexo\", \"SVL\", \"comprimento_cauda\", \"cauda_autotomizada\", \"estado_cauda\")\n\n\n## Dados faltantes\nvis_dat(lagartos)\nvis_miss(lagartos, cluster = TRUE) # 22.9% dos dados est√£o faltando\ndados_semNA <- remove_missing(lagartos, vars = \"sexo\") # excluindo linhas com dados faltantes para a vari√°vel Sex\nvis_miss(dados_semNA)\ndim(dados_semNA) # verificar as dimens√µes da tabela depois que os dados tiverem sido exclu√≠dos\n#> [1] 139   6\n## Gr√°fico\nggplot(dados_semNA, aes(SVL, estado_cauda)) +\n    geom_point(aes(shape = sexo, colour = sexo), size = 4, alpha = 0.4) +\n    geom_smooth(method = \"glm\", method.args = list(family = \"binomial\")) +\n    labs(y = \"Estado da Cauda\", x = \"Comprimento Rostro-Cloacal (mm)\", shape = \"Sexo\", colour = \"Sexo\") +\n    tema_livro()\n## Modelos\nmod_log <- glm(estado_cauda ~ SVL * sexo, data = dados_semNA, family = binomial(link = \"logit\"))\nmod_pro <- glm(estado_cauda ~ SVL * sexo, data = dados_semNA, family = binomial(link = \"probit\"))\n\n# Sele√ß√£o de modelos\nAICctab(mod_log, mod_pro, nobs = 139)\n#>         dAICc df\n#> mod_pro 0.0   4 \n#> mod_log 0.1   4\n## Diagn√≥se avan√ßada\nsimulationBion <- simulateResiduals(fittedModel = mod_log, plot = T)\nbinned_residuals(mod_log)\n#> Warning: About 92% of the residuals are inside the error bounds (~95% or higher would be good).\n## Coeficientes estimados pelo modelo\nsummary(mod_log)\n#> \n#> Call:\n#> glm(formula = estado_cauda ~ SVL * sexo, family = binomial(link = \"logit\"), \n#>     data = dados_semNA)\n#> \n#> Deviance Residuals: \n#>     Min       1Q   Median       3Q      Max  \n#> -1.5694  -1.0449  -0.8196   1.2181   1.6310  \n#> \n#> Coefficients:\n#>              Estimate Std. Error z value Pr(>|z|)  \n#> (Intercept)    5.5834     2.5909   2.155   0.0312 *\n#> SVL           -0.2678     0.1178  -2.274   0.0230 *\n#> sexoMale       0.6977     4.4055   0.158   0.8742  \n#> SVL:sexoMale  -0.0442     0.2085  -0.212   0.8321  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 191.07  on 138  degrees of freedom\n#> Residual deviance: 181.38  on 135  degrees of freedom\n#> AIC: 189.38\n#> \n#> Number of Fisher Scoring iterations: 4\nanova(mod_log, test = \"Chisq\" )\n#> Analysis of Deviance Table\n#> \n#> Model: binomial, link: logit\n#> \n#> Response: estado_cauda\n#> \n#> Terms added sequentially (first to last)\n#> \n#> \n#>          Df Deviance Resid. Df Resid. Dev Pr(>Chi)   \n#> NULL                       138     191.07            \n#> SVL       1   9.2563       137     181.82 0.002347 **\n#> sexo      1   0.3920       136     181.43 0.531262   \n#> SVL:sexo  1   0.0454       135     181.38 0.831292   \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"cap8.html","id":"dados-de-contagem-com-excesso-de-zeros","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.8 Dados de contagem com excesso de zeros","text":"Quando se analisa abund√¢ncia ou riqueza de esp√©cies √© comum que tenhamos dados com muitos zeros. Esse fen√¥meno pode ser causado por v√°rios processos ecol√≥gicos, tais como locais fora nicho da esp√©cie, falha na detec√ß√£o, amostras feitas fora habitat ou em locais onde n√£o se espera encontrar esp√©cie (Blasco‚ÄêMoreno et al. 2019). Esse tipo de dado √© problem√°tico porque rompe com os pressupostos da distribui√ß√£o Poisson e binomial negativa, podendo inclusive ser uma das causas da overdispersion.Nesses casos, temos de ajustar modelos que levam em conta esse excesso de zeros nos dados. Esses modelos s√£o chamados de zero-inflated e hurdle models (tamb√©m chamados de zero-altered models), dependendo de como o processo que causou os zeros √© modelado.Hurdle models (ou zero-altered models) modelam os dados dividindo-os em dois subconjuntos: um qual reduzimos os dados √† presen√ßa-aus√™ncia, ou seja, todos os dados maiores que 1 s√£o transformados em 1 e usamos, por exemplo, uma distribui√ß√£o binomial; e uma outra parte que s√≥ considera os valores positivos sem zero, utilizando uma Poisson ou binomial negativa truncadas. Ao fazer isso, distribui√ß√£o truncada assume que os zeros s√£o gerados tanto por processos ecol√≥gicos, quanto erros de amostragem (ou seja, √© imposs√≠vel distinguir entre essas duas fontes). Portanto, esses zeros s√£o exclu√≠dos da distribui√ß√£o com dados de contagem. Por exemplo, se uma distribui√ß√£o binomial negativa usada para modelar parte quantitativa, chamamos o modelo de Zero-altered Negative binomial. interpreta√ß√£o dos modelos deve ser feita de forma conjunta.Modelos com zero inflados funcionam de maneira similar, mas permitem que distribui√ß√£o Poisson contenha zeros, ou seja, n√£o √© utilizada uma distribui√ß√£o truncada. Ao fazer isso, esta distribui√ß√£o de Poisson pressup√µe que os zeros foram gerados por um processo ecol√≥gico real, tal como, aus√™ncia de habitat adequado.Para ilustrar como podemos lidar com conjuntos de dados complexos, vamos utilizar os dados parasita Raillietiella mottae infectando duas esp√©cies de lagartos que ocorrem Nordeste Brasileiro (Lima et al. 2018). Ao todo, 63 indiv√≠duos de Hemidactylus agrius e 132 de Phyllopezus pollicaris foram amostrados.PerguntaQuais atributos de hist√≥ria de vida dos lagartos s√£o relacionados com o volume (load) de infec√ß√£o, tais como tamanho e sexo?Predi√ß√µesQuanto maior o lagarto, maior o n√∫mero de parasitas encontrados, esta resposta poderia tamb√©m diferir entre sexos devido ao dimorfismo sexual.Vari√°veisVari√°vel resposta: n√∫mero parasita Raillietiella mottae, que √© um crust√°ceo parasita, infectando o aparelho respirat√≥rio e intestinal de lagartos.Vamos explorar os dados (Figura 8.18).\nFigura 8.18: Gr√°fico para explorar rela√ß√µes entre vari√°veis.\nOs gr√°fico acima mostram contagem parasita Raillietiella mottae nos dois sexos (F e M para f√™mea e macho) nas duas esp√©cies de lagartos (Hemidactylus agrius e Phyllopezus pollicaris), tanto na forma de uma distribui√ß√£o de densidade, quanto de gr√°fico de dispers√£o. Aqui podemos ver que de fato existe um excesso de zeros principalmente em P. pollicaris.Quando nos deparamos com dados complexos assim, estrat√©gia √© sempre come√ßar com um modelo simples e depois adicionar mais par√¢metros. Portanto, vamos iniciar com um modelo Poisson, mesmo sabendo que ele muito provavelmente n√£o ser√° adequado para modelar estes dados.ModelagemAjuste modelo Poisson.DiagnoseAqui vamos utilizar fun√ß√µes pacote performance novamente (Figura ??) para o GLM Poisson.diagnose n√£o s√≥ nos disse que o modelo possui overdispersion, como tamb√©m de zero-inflation, como j√° esper√°vamos. Vejamos ent√£o como melhorar o nosso modelo para lidar com esses dois problemas. Especificamente, vamos utilizar um modelo Hurdle com binomial negativa truncada (ou seja, desconsiderando os zeros), e um outro modelo zero-inflated usando uma distribui√ß√£o binomial negativa.\nAqui vamos utilizar o pacote glmmTMB.DiagnoseVamos fazer diagnose desses tr√™s modelos ajustados anteriormente.Aqui vemos que o modelo zero-altered (Hurdle Model) conseguiu predizer exatamente quantidade de zeros observada, fazendo com que o modelo seja suficiente para usarmos com esses dados.Mas quando comparamos o AICc entre modelos, os modelos zero-inflated (tanto Poisson, quanto binomial negativa) que tem menos par√¢metros, s√£o ranqueados ligeiramente melhor que o modelo binomial negativa zero-altered (ou hurdle). N√£o podemos distinguir entre os dois modelos com zero-inflated porque o dAICc < 2, ou seja, o ajuste deles aos dados s√£o praticamente iguais. Vejam que diferen√ßa de Akaike Weights entre os dois primeiros modelos e o hurdle √© bastante substancial (0.34 e 0.52). Al√©m disso, vemos que os modelos que levam em conta o excesso de zeros se ajustam bem melhor aos dados que o modelo simples com distribui√ß√£o Poisson.\nVamos ver como os modelos se saem em rela√ß√£o aos outros pressupostos (Figura 8.19).\nFigura 8.19: Diagnose avan√ßada dos res√≠duos modelo GLM Hurdle e zero-inflated binomial negativa.\nOs gr√°ficos de diagnose DHARMa s√£o outra evid√™ncia de que tanto o modelo hurdle quanto o zero-inflated Poisson s√£o adequados para os dados, em termos de homogeneidade de vari√¢ncia, outliers e overdispersion.Interpreta√ß√£o dos resultadosApesar de n√£o ter um ajuste t√£o bom aos dados, o modelo hurdle prediz melhor quantidade de zeros. Portanto, vamos interpretar os coeficientes apenas deste modelo.Para maiores detalhes na interpreta√ß√£o deste tipo de modelo, sugerimos fortemente consultar p.¬†382-3 de Brooks et al. (2017). Para fatores com mais de um n√≠vel, o summary() mostra os resultados usando contraste, para isto toma como refer√™ncia um dos n√≠veis fator (o primeiro em ordem alfab√©tica) e o compara com os outros. Note que na parte com excesso de zeros, o contraste √© positivo para Esp√©cie. Ou seja, o P. pollicaris tem maior chance de ter aus√™ncia de parasitas que H. agrius. O contraste para esp√©cie continua sendo positivo na parte condicional modelo, mas o valor par√¢metro n√£o √© t√£o alto. Isso quer dizer que P. pollicaris tem abund√¢ncia de parasitas em m√©dia ligeiramente maior que H. agrius. Vemos que intera√ß√£o √© significativa entre sexo e esp√©cie na parte modelo com excesso de zeros, mas apenas marginalmente significativa na parte condicional. Portanto, influ√™ncia sexo na incid√™ncia, mas n√£o na abund√¢ncia parasita depende conjuntamente da esp√©cie. entanto, o CRC s√≥ passa ser significativo na parte de excesso de zeros, ou seja, quando modelamos apenas incid√™ncia (presen√ßa-aus√™ncia) parasita. Portanto, o CRC determina se o lagarto vai ou n√£o ser infectado, mas n√£o o quanto vai receber de parasitas. J√° tanto o sexo quanto esp√©cie foram significativas em ambas partes modelo, ou seja, esses fatores n√£o influenciam diferentemente infec√ß√£o e quantidade de parasitas.\nAgora vejamos como podemos plotar predi√ß√µes deste modelo (Figura 8.20).\nFigura 8.20: Gr√°fico GLM Hurdle.\n","code":"\n## Cabe√ßalho dos dados\nhead(parasitas)\n#>                     Especie Sexo CRC Raillietiella_mottae\n#> W124 Phyllopezus_pollicaris    F  61                    3\n#> W125 Phyllopezus_pollicaris    F  56                    0\n#> W127 Phyllopezus_pollicaris    M  61                    0\n#> W128 Phyllopezus_pollicaris    M  48                    0\n#> W129 Phyllopezus_pollicaris    F  40                    0\n#> W130 Phyllopezus_pollicaris    M  62                    0\n## Gr√°ficos\nggplot(parasitas, aes(Raillietiella_mottae, fill = Especie)) +\n    geom_density(alpha = 0.4) +\n    facet_grid(Especie ~ Sexo) +\n    scale_fill_manual(values = c(\"darkorange\", \"cyan4\")) +\n    tema_livro() +\n    theme(legend.position = \"none\")\n\nggplot(parasitas, aes(CRC, Raillietiella_mottae, fill = Especie)) +\n    geom_point(size = 4, alpha = 0.4, shape = 21) +\n    facet_grid(Sexo ~ Especie) +\n    scale_fill_manual(values = c(\"darkorange\", \"cyan4\")) +\n    theme(legend.position = \"none\") +\n    labs(x = \"Comprimento Rostro-Cloacal\", y = expression(italic(\"Raillietiella mottae\")))+\n    tema_livro()\n## Modelo\npois_plain <- glm(Raillietiella_mottae ~ CRC + Sexo * Especie, data = parasitas, family = \"poisson\")\n## Diagnose avan√ßada\ncheck_zeroinflation(pois_plain) # para diagnosticar se o modelo sofre de zero inflation\n#> # Check for zero-inflation\n#> \n#>    Observed zeros: 156\n#>   Predicted zeros: 140\n#>             Ratio: 0.90\ncheck_overdispersion(pois_plain)\n#> # Overdispersion test\n#> \n#>        dispersion ratio =   1.932\n#>   Pearson's Chi-Squared = 367.133\n#>                 p-value = < 0.001\n## Modelos\nhur_NB <- glmmTMB(Raillietiella_mottae ~ CRC + Sexo * Especie, zi = ~., data = parasitas, family = truncated_nbinom2) # Hurdle model\n\nziNB_mod2 <- glmmTMB(Raillietiella_mottae ~ CRC + Sexo * Especie, zi = ~., data = parasitas, family = nbinom2) # zero-inflated Poisson\n\nziP_mod2 <- glmmTMB(Raillietiella_mottae ~ CRC + Sexo * Especie, zi = ~., data = parasitas, family = poisson) # zero-inflated Negative binomial\n## Diagnose de infla√ß√£o de zeros\ncheck_zeroinflation(hur_NB) # prediz melhor os zeros\n#> # Check for zero-inflation\n#> \n#>    Observed zeros: 156\n#>   Predicted zeros: 157\n#>             Ratio: 1.01\ncheck_zeroinflation(ziP_mod2)\n#> # Check for zero-inflation\n#> \n#>    Observed zeros: 156\n#>   Predicted zeros: 140\n#>             Ratio: 0.90\ncheck_zeroinflation(ziNB_mod2)\n#> # Check for zero-inflation\n#> \n#>    Observed zeros: 156\n#>   Predicted zeros: 142\n#>             Ratio: 0.91\n## Sele√ß√£o de modelos\nICtab(pois_plain, hur_NB, ziP_mod2, ziNB_mod2, type = c(\"AICc\"), weights = TRUE)\n#>            dAICc df weight\n#> ziP_mod2    0.0  10 0.62  \n#> ziNB_mod2   1.6  11 0.28  \n#> hur_NB      3.6  11 0.10  \n#> pois_plain 44.6  5  <0.001\n## Diagnoses\nsimulationOutput <- simulateResiduals(fittedModel = hur_NB, plot = T)\nsimulationOutput <- simulateResiduals(fittedModel = ziP_mod2, plot = T)\nsimulationOutput <- simulateResiduals(fittedModel = ziNB_mod2, plot = T) # tem um outlier nos res√≠duos (asterisco vermelho)\n## Coeficientes estimados pelo modelo\nsummary(hur_NB)\n#>  Family: truncated_nbinom2  ( log )\n#> Formula:          Raillietiella_mottae ~ CRC + Sexo * Especie\n#> Zero inflation:                        ~.\n#> Data: parasitas\n#> \n#>      AIC      BIC   logLik deviance df.resid \n#>    277.8    313.8   -127.9    255.8      184 \n#> \n#> \n#> Dispersion parameter for truncated_nbinom2 family (): 4.64 \n#> \n#> Conditional model:\n#>                                     Estimate Std. Error z value Pr(>|z|)  \n#> (Intercept)                          3.03428    2.36511   1.283   0.1995  \n#> CRC                                 -0.05041    0.04861  -1.037   0.2997  \n#> SexoM                               -1.49505    0.71440  -2.093   0.0364 *\n#> EspeciePhyllopezus_pollicaris        0.68945    1.09380   0.630   0.5285  \n#> SexoM:EspeciePhyllopezus_pollicaris  1.75281    0.94217   1.860   0.0628 .\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Zero-inflation model:\n#>                                     Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept)                           7.6283     1.8529   4.117 3.84e-05 ***\n#> CRC                                  -0.1291     0.0369  -3.499 0.000468 ***\n#> SexoM                                -1.0893     0.5867  -1.856 0.063386 .  \n#> EspeciePhyllopezus_pollicaris         2.2701     0.9140   2.484 0.013003 *  \n#> SexoM:EspeciePhyllopezus_pollicaris   2.2002     0.8192   2.686 0.007239 ** \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Gr√°fico\nparasitas$phat <- predict(hur_NB, type = \"response\")\nparasitas <- parasitas[with(parasitas, order(Sexo, Especie)), ]\n\nggplot(parasitas, aes(x = CRC, y = phat, colour = Especie,\n                      shape = Sexo, linetype = Sexo)) +\n    geom_point(aes(y = Raillietiella_mottae), size = 4, \n               alpha = .7, position = position_jitter(h = .2)) +\n    geom_line(size = 1) +\n    scale_fill_manual(values = c(\"darkorange\", \"cyan4\")) +\n    scale_colour_manual(values = c(\"darkorange\", \"cyan4\")) +\n       labs(x = \"Comprimento Rostro-Cloacal\", \n         y = expression(paste(\"Abund√¢ncia de \", italic(\"Raillietiella mottae\")))) +\n    tema_livro()"},{"path":"cap8.html","id":"dados-ordinais-os-modelos-cumulative-link","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.9 Dados ordinais: os modelos cumulative link","text":"Uma outra maneira de codificarmos os dados √© utilizando categorias ordenadas, tais como ranques. Exemplos incluem escala de Likert, scores e intervalos (e.g., de idade).Para este exemplo, iremos utilizar um outro conjunto de dados artigo de (Franco-Belussi, De Oliveira, Sk√∂ld 2018) que manipulou vitro concentra√ß√£o horm√¥nio noradrenalina nos olhos de peixes esgana-gato (Gasterosteus aculeatus) e avaliaram express√£o de v√°rias cores conferidas por tipos de c√©lulas (cromat√≥foros). Aqui vamos usar os dados efeito da noradrenalina na cor vermelha em machos.\nNeste experimento, os autores realizaram medidas repetidas mesmo animal ao longo tempo (que √© um dos fatores deste experimento). Portanto, para n√£o incorrer risco de pseudor√©plicas dever√≠amos incluir esta informa√ß√£o modelo. maneira mais simples de faz√™-lo √© criar um modelo de efeito misto em que ter√≠amos uma parte fixa (o que de fato estamos interessados em testar) e outra aleat√≥ria (vari√°veis que precisamos controlar). Portanto, Animal ser√° inclu√≠do como um um fator aleat√≥rio, tendo um intercepto estimado separadamente para cada animal modelo. N√£o iremos entrar em detalhes sobre modelos de efeito misto porque necessitar√≠amos de um outro cap√≠tulo para isso, dada complexidade assunto. entanto, recomendamos aos leitores dois artigos intr√≥dut√≥rios muito bons - Harisson (2018) e Bolker et al. (2009).PerguntaA noradrenalina causa uma diminui√ß√£o da colora√ß√£o vermelha, via agrega√ß√£o dos pigmentos?Predi√ß√µesA presen√ßa de noradrenalina causa agrega√ß√£o dos pigmentos, permitindo que os horm√¥nios reprodutivos atuem.Vari√°veisVari√°vel resposta: escala de intensidade de cor. Para mais detalhes veja o artigo original (Franco-Belussi, De Oliveira, Sk√∂ld 2018).Esses dados, entanto, t√™m de ser codificados como um fator ordenado antes de entrarmos com eles modelo.Repare que classe objeto muda e temos agora que Red √© um Ordered factor.ModelagemVamos ajustar um modelo cumulative link, utilizando fun√ß√£o clmm() pacote ordinal.DiagnoseInfelizmente, o pacote ordinal n√£o fornece m√©todos para lidar com modelos mistos, como o nosso. Ent√£o, montamos um modelo fixo apenas para entrar nas duas fun√ß√µes de diagnose. Essas duas fun√ß√µes scale_test() e nominal_test() testam qualidade ajuste (goodness--fit) modelo, similar aos likelihood-ratio test, s√≥ que para dados ordinais.Parece que n√£o h√° problemas com o efeito de escala dado ordinal, mas diagnose sugere que possa haver evid√™ncia de rompimento pressuposto de probabilidades proporcionais em rela√ß√£o ao tratamento. Esse √© um pressuposto importante de modelos ordinais, os quais assumem que os efeitos de qualquer uma das vari√°veis explicativas s√£o consistentes (proporcionais) ao longo de diferentes thresholds (que s√£o quebras entre cada par de categorias da vari√°vel resposta ordinal).Isto provavelmente se deve ao baixo tamanho amostral. Por quest√£o de brevidade vamos apenas ignorar este aspecto e interpretar o resultado modelo mesmo assim. Mas se o seu modelo apresentar este problema, solu√ß√£o deve ser realizar regress√µes log√≠sticas separadamente.Infer√™nciaVamos analisar os par√¢metros modelo.Aqui vemos que tanto o tratamento, quanto o tempo de exposi√ß√£o foram significativos.Interpreta√ß√£o dos resultadosVamos analisar predi√ß√£o modelo (Figura 8.21).\nFigura 8.21: Gr√°fico modelo cumulative link.\nNeste gr√°fico vemos que o grupo tratado com o horm√¥nio come√ßa com um √≠ndice de eritr√≥foro ligeiramente maior que o controle, mas logo tem uma brusca redu√ß√£o com uma hora de exposi√ß√£o, passando ter √≠ndice 2, demonstrando que houve uma mudan√ßa de cor induzida pela dispers√£o dos cromat√≥foros. J√° controle, o √≠ndice n√£o muda em rela√ß√£o ao tempo de exposi√ß√£o. Logo, podemos ver que h√° uma intera√ß√£o entre os fatores devido esta queda √≠ndice grupo tratado e aus√™ncia de efeito controle.","code":"\n## Importar os dados\ncores <- read.csv2(\"https://ndownloader.figshare.com/files/10250700\", header = TRUE)\nhead(cores)\n#>   Animal Treatment Time Sex Black Red\n#> 1      1        CT   0h   M     5   5\n#> 2      1        CT   1h   M     5   5\n#> 3      1        CT   2h   M     5   5\n#> 4      1        CT   3h   M     5   5\n#> 5      2        CT   0h   M     5   4\n#> 6      2        CT   1h   M     5   4\n\n## Tradu√ß√£o dos nomes das colunas\ncolnames(cores) <- c(\"animal\", \"tratamento\", \"tempo\", \"sexo\", \"preto\", \"vermelho\")\n\n## Filtrando dados - macho vermelho\nmacho_verm <- filter(cores, sexo == \"M\")\nhead(macho_verm)\n#>   animal tratamento tempo sexo preto vermelho\n#> 1      1         CT    0h    M     5        5\n#> 2      1         CT    1h    M     5        5\n#> 3      1         CT    2h    M     5        5\n#> 4      1         CT    3h    M     5        5\n#> 5      2         CT    0h    M     5        4\n#> 6      2         CT    1h    M     5        4\n## Fator\nmacho_verm$animal <- factor(macho_verm$animal)\nmacho_verm$vermelho_ord <- factor(macho_verm$vermelho, \n                      levels = c(\"1\", \"2\", \"3\", \"4\", \"5\"), \n                      ordered = TRUE)\nstr(macho_verm)\n#> 'data.frame':    40 obs. of  7 variables:\n#>  $ animal      : Factor w/ 5 levels \"1\",\"2\",\"3\",\"4\",..: 1 1 1 1 2 2 2 2 3 3 ...\n#>  $ tratamento  : chr  \"CT\" \"CT\" \"CT\" \"CT\" ...\n#>  $ tempo       : chr  \"0h\" \"1h\" \"2h\" \"3h\" ...\n#>  $ sexo        : chr  \"M\" \"M\" \"M\" \"M\" ...\n#>  $ preto       : int  5 5 5 5 5 5 5 5 4 4 ...\n#>  $ vermelho    : int  5 5 5 5 4 4 4 4 4 4 ...\n#>  $ vermelho_ord: Ord.factor w/ 5 levels \"1\"<\"2\"<\"3\"<\"4\"<..: 5 5 5 5 4 4 4 4 4 4 ...\n## Modelo\nmod3 <- clmm(vermelho_ord ~ tratamento + tempo + (1|animal), data = macho_verm, threshold = \"equidistant\")\n## Diagnose\nassumption3 <- clm(vermelho_ord ~ tratamento + tempo, data = macho_verm, threshold = \"equidistant\")\n\nscale_test(assumption3)\n#> Tests of scale effects\n#> \n#> formula: vermelho_ord ~ tratamento + tempo\n#>            Df  logLik    AIC      LRT Pr(>Chi)\n#> <none>        -24.301 60.602                  \n#> tratamento  1 -24.293 62.586 0.015248   0.9017\n#> tempo\nnominal_test(assumption3)\n#> Tests of nominal effects\n#> \n#> formula: vermelho_ord ~ tratamento + tempo\n#>            Df  logLik    AIC    LRT Pr(>Chi)   \n#> <none>        -24.301 60.602                   \n#> tratamento  1 -19.749 53.499 9.1031 0.002552 **\n#> tempo       3 -22.803 63.606 2.9953 0.392356   \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Coeficientes estimados pelo modelo\nsummary(mod3)\n#> Cumulative Link Mixed Model fitted with the Laplace approximation\n#> \n#> formula: vermelho_ord ~ tratamento + tempo + (1 | animal)\n#> data:    macho_verm\n#> \n#>  link  threshold   nobs logLik AIC   niter    max.grad cond.H \n#>  logit equidistant 40   -22.89 59.77 226(681) 1.04e-05 4.1e+01\n#> \n#> Random effects:\n#>  Groups Name        Variance Std.Dev.\n#>  animal (Intercept) 1.438    1.199   \n#> Number of groups:  animal 5 \n#> \n#> Coefficients:\n#>                  Estimate Std. Error z value Pr(>|z|)    \n#> tratamentoNA10uM   -4.602      1.228  -3.748 0.000178 ***\n#> tempo1h            -3.602      1.377  -2.616 0.008894 ** \n#> tempo2h            -3.602      1.377  -2.616 0.008894 ** \n#> tempo3h            -3.602      1.377  -2.616 0.008894 ** \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Threshold coefficients:\n#>             Estimate Std. Error z value\n#> threshold.1   -6.198      1.722   -3.60\n#> spacing        4.978      1.254    3.97\nanova(assumption3)\n#> Type I Analysis of Deviance Table with Wald chi-square tests\n#> \n#>            Df   Chisq Pr(>Chisq)    \n#> tratamento  1 15.3616  8.877e-05 ***\n#> tempo       3  9.1992    0.02676 *  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\npairs(emmeans(mod3, ~ tratamento|tempo, adjust = \"tukey\"))\n#> tempo = 0h:\n#>  contrast    estimate   SE  df z.ratio p.value\n#>  CT - NA10uM      4.6 1.23 Inf   3.748  0.0002\n#> \n#> tempo = 1h:\n#>  contrast    estimate   SE  df z.ratio p.value\n#>  CT - NA10uM      4.6 1.23 Inf   3.748  0.0002\n#> \n#> tempo = 2h:\n#>  contrast    estimate   SE  df z.ratio p.value\n#>  CT - NA10uM      4.6 1.23 Inf   3.748  0.0002\n#> \n#> tempo = 3h:\n#>  contrast    estimate   SE  df z.ratio p.value\n#>  CT - NA10uM      4.6 1.23 Inf   3.748  0.0002\n## Gr√°fico\n\n# Calcular m√©dia e erro padr√£o\nmacho_verm_res <- summarySE(macho_verm, \n                        measurevar = \"vermelho\",\n                        groupvars = c(\"tempo\", \"tratamento\"))\n\n# Definir posi√ß√£o de linhas e pontos no gr√°fico\npd <- position_dodge(0.1)\n\nmacho_verm_res %>% \n  ggplot(aes(x = tempo, y = vermelho, colour = tratamento,\n             group = tratamento, fill = tratamento)) +\n  geom_errorbar(aes(ymin=vermelho-se, ymax=vermelho +se), \n                width=.1, size = 1.1, position=pd) +\n  geom_line(position=pd, size = 1.1) +\n  geom_point(pch = 21, colour = \"black\", position=pd, size=3.5) +\n  scale_colour_manual(values = c(\"darkorange\", \"cyan4\")) +\n  scale_fill_manual(values = c(\"darkorange\", \"cyan4\")) +\n  xlab(\"Tempo de exposi√ß√£o (horas)\") +\n  ylab(\"√çndice de eritr√≥foros\") +\n  tema_livro()"},{"path":"cap8.html","id":"dados-cont√≠nuos-distribui√ß√£o-beta","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.10 Dados cont√≠nuos: distribui√ß√£o beta","text":"Aqui vamos utilizar como exemplo os dados artigo de (2018). Os pesquisadores fizeram um experimento vivo com peixes esgana-gato (Gasterosteus aculeatus) para testar como colora√ß√£o dos animais respondem ao f√°rmaco ioimbina (YOH), que bloqueia colora√ß√£o t√≠pica que os machos exibem na √©poca de acasalamento, e o tempo de exposi√ß√£o ao mesmo (al√©m de um controle), num desenho de ANOVA fatorial. Como medidas foram feitas repetidamente mesmo animal, iremos incluir o Animal como um fator aleat√≥rio modelo.Esses dados cont√™m vari√°veis resposta medidas experimento: quantidade de vermelho e preto. Al√©m dos fatores manipulados: Tratamento (controle e presen√ßa de YOH) e tempo de exposi√ß√£o.PerguntaA YOH aumenta colora√ß√£o escura olho e mand√≠bula dos peixes via dispers√£o dos pigmentos?Predi√ß√µesA YOH promover√° um escurecimento corpo animal, j√° que ela inibe a√ß√£o NorAdrenalia (NA).Vari√°veisVari√°vel resposta: intensidade de colora√ß√£o escura em peixes machos. Esses dados s√£o expressos em termos de porcentagem e variam continuamente de 0 100%. Para facilitar modelagem e nos adequarmos √† maneira com que fun√ß√£o requer os dados, vamos simplesmente dividir por 100 para que os dados variem entre 0 e 1Para modelar os dados vamos utilizar fun√ß√£o glmmTMB. Antes disso, vamos analisar graficamente os dados (Figura 8.22). Vamos usar apenas os dados dos machos para este exemplo.\nFigura 8.22: Gr√°fico para explorar distribui√ß√£o da vari√°vel resposta.\nhistograma podemos ver que os dados de fato variam continuamente intervalo entre 0 e 1, tendo uma distribui√ß√£o notadamente bimodal.ModelagemVamos ajustar um GLM Beta.DiagnoseAqui utilizaremos o mesmo pacote DHARMa para realizar diagnose modelo\n(Figura 8.23).\nFigura 8.23: Diagnose avan√ßada dos res√≠duos modelo GLM Beta.\nPodemos ver que o modelo n√£o sofre de heterogeneidade de dispers√£o, overdispersion, nem problemas com outlier.Interpreta√ß√£o dos resultadosAgora que podemos interpretar sa√≠da modelo ajustado com confian√ßa, vamos obter tabela de anova em que teremos os testes de cada fator modelo.Aqui vemos que intera√ß√£o √© significativa. Portanto, temos de interpretar os n√≠veis fator da combina√ß√£o, fazemos isso pacote emmeans colocando barra |.Agora podemos perceber que diferen√ßa entre o controle e o tratado s√≥ passa ser significativa depois de 1 h de exposi√ß√£o.Isso fica mais evidente quando plotamos os dados (Figura 8.24).\nFigura 8.24: Gr√°fico modelo GLM beta.\n","code":"\nhead(fish)\n#>   Animal Treatment Time Sex Darkness Redness\n#> 1      1        CT   0h   M    56.42  131.17\n#> 2      1        CT   1h   M    49.53  133.30\n#> 3      1        CT   2h   M    54.94  132.69\n#> 4      1        CT   3h   M    42.19  135.37\n#> 5      2        CT   0h   M    58.93  133.35\n#> 6      2        CT   1h   M    52.45  133.65\n\n## Tradu√ß√£o dos nomes das colunas\ncolnames(fish) <- c(\"animal\", \"tratamento\", \"tempo\", \"sexo\", \"preto\", \"vermelho\")\n## Filtrando os dados\nfish$animal <- factor(fish$animal)\nfish$sexo <- factor(fish$sexo)\nmacho_preto <- dplyr::filter(fish, sexo == \"M\")\n\n## Gr√°fico\nggplot(macho_preto, aes(preto/100)) +\n    geom_density(colour = \"cyan4\", fill = \"cyan4\", alpha = 0.4) +\n    theme(legend.position = \"none\") +\n    labs(x = \"√çndice de escurid√£o do corpo\")+\n    tema_livro()\n## Modelo\nmod2 <- glmmTMB(preto/100 ~ tratamento * tempo + (1|animal), family = beta_family, data = macho_preto)\n## Diagn√≥se\nsimulationOutput <- simulateResiduals(fittedModel = mod2, plot = TRUE)\n## Coeficientes estimados pelo modelo\nAnova(mod2)\n#> Analysis of Deviance Table (Type II Wald chisquare tests)\n#> \n#> Response: preto/100\n#>                    Chisq Df Pr(>Chisq)    \n#> tratamento       105.546  1  < 2.2e-16 ***\n#> tempo             40.719  3  7.499e-09 ***\n#> tratamento:tempo  49.262  3  1.147e-10 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## n√≠veis do fator da combina√ß√£o\npairs(emmeans(mod2, ~ tratamento|tempo))\n#> tempo = 0h:\n#>  contrast estimate    SE df t.ratio p.value\n#>  CT - YOH   0.0283 0.160 30   0.177  0.8609\n#> \n#> tempo = 1h:\n#>  contrast estimate    SE df t.ratio p.value\n#>  CT - YOH  -1.3068 0.181 30  -7.210  <.0001\n#> \n#> tempo = 2h:\n#>  contrast estimate    SE df t.ratio p.value\n#>  CT - YOH  -1.2286 0.182 30  -6.763  <.0001\n#> \n#> tempo = 3h:\n#>  contrast estimate    SE df t.ratio p.value\n#>  CT - YOH  -1.4025 0.185 30  -7.582  <.0001\n#> \n#> Results are given on the log odds ratio (not the response) scale.\n## Gr√°fico\nescuridao <- summarySE(macho_preto, \n                        measurevar = \"preto\",\n                        groupvars = c(\"tempo\", \"tratamento\"))\n\n# Definir posi√ß√£o de linhas e pontos no gr√°fico\npd <- position_dodge(0.1)\n\nescuridao %>% \n  ggplot(aes(x = tempo, y = preto, colour = tratamento,\n             group = tratamento, fill = tratamento)) +\n  geom_errorbar(aes(ymin=preto-se, ymax=preto +se), \n                width=.1, size = 1.1, position=pd) +\n  geom_line(position=pd, size = 1.1) +\n  geom_point(pch = 21, colour = \"black\", position=pd, size=3.5) +\n  scale_colour_manual(values = c(\"darkorange\", \"cyan4\")) +\n  scale_fill_manual(values = c(\"darkorange\", \"cyan4\")) +\n  xlab(\"Tempo de experimento (horas)\") +\n  ylab(\"√çndice de escurid√£o do corpo\") +\n  tema_livro()"},{"path":"cap8.html","id":"para-se-aprofundar-4","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.11 Para se aprofundar","text":"Neste cap√≠tulo apenas fizemos uma breve introdu√ß√£o aos modelos lineares generalizados. Para conhecer um pouco mais fundo todos os detalhes, recomendamos consulta dos livros ‚ÄúMixed effects models extensions ecology R‚Äù de Zurr et al. (2009) e ‚ÄúMixed-Effects Models S S-PLUS‚Äù de Pinheiro et al. (Pinheiro Bates 2000) que s√£o refer√™ncias cl√°ssicas sobre GLM com aplica√ß√µes em Ecologia. Para dados ordinais, sugerimos os livros ‚ÄúAnalysis ordinal categorical data‚Äù de Agresti (2010) e ‚ÄúCategorical Data Analysis,‚Äù mesmo autor, Agresti (2012).","code":""},{"path":"cap8.html","id":"exerc√≠cios-4","chapter":"Cap√≠tulo 8 Modelos Lineares Generalizados","heading":"8.12 Exerc√≠cios","text":"8.1\nBaixe estes dados que foram coletados numa pesquisa de opini√£o sobre uso de v√≠deo games por 91 estudantes de gradua√ß√£o outono de 1994. Utilizando estes dados, constra um modelo: 1) Predizer frequ√™ncia com que uma pessoa joga v√≠deo game em fun√ß√£o da idade; 2) Predizer nota estudante em fun√ß√£o tempo que jogou na semana antes da entrevista. Dica: esses s√£o dados ordinais!8.2\nUma pesquisadora interessada em entender o efeito de diferentes usos de solo sobre abund√¢ncia de morcegos em paisagens agroecol√≥gicas desenvolveu uma simula√ß√£o para gerar dados parecidos com o que ir√° coletar em breve campo. Ela utilizou uma abordagem que simula abund√¢ncia de uma esp√©cie sob deriva ecol√≥gica segundo Teoria Neutra da Biodiversidade. simula√ß√£o gerou os seguintes dados:Al√©m disso, pesquisadora tamb√©m simulou dados que representam porcentagem solo destinado √† agricultura:Agora com esses dados ela pode ter uma id√©ia que esperar quando pra campo. Ajude pesquisadora construir um modelo linear generalizado que seja adequado para modelar abund√¢ncia desta esp√©cie de morcego em fun√ß√£o da porcentagem de agricultura. Lembre-se de que ela vai precisar diagnosticar o modelo antes de utiliz√°-lo para fazer uma infer√™ncia. Por fim, interprete os resultados e sugira uma poss√≠vel interpreta√ß√£o para pesquisadora.Solu√ß√µes dos exerc√≠cios.","code":"\nset.seed(42)\nJ <- 5000 # n√∫mero de indiv√≠duos na comunidade local\ntheta <- 50 #n√∫mero fundamental da biodiversidade\nm <- 0.05 #taxa de dispers√£o\ncomm1a <- coalesc(J, m, theta) #simula√ß√£o\nabund1a <- abund(comm1a) #extra√ß√£o de dados de abund√¢ncia local\n\nhead(abund1a$com) #dados da comunidade local\n#>   sp  ab  relab\n#> 1  1 161 0.0322\n#> 2  2  93 0.0186\n#> 3  3 185 0.0370\n#> 4  4  86 0.0172\n#> 5  5  35 0.0070\n#> 6  6  69 0.0138\n\n#histograma da abund√¢ncia\nggplot(abund1a$com, aes(ab))+\n  geom_density(aes(col=\"red\", fill=\"red\"))+\n  theme(legend.position = \"non\")\nporc_solo <- rbeta(length(abund1a$com$ab), 10, 90) #simula√ß√£o uso do solo para agricultura\nhist(porc_solo)\n\ndados_finais <- data.frame(abund=abund1a$com$ab, solo=porc_solo)\nhead(dados_finais)\n#>   abund       solo\n#> 1   161 0.11063484\n#> 2    93 0.11498853\n#> 3   185 0.05718937\n#> 4    86 0.06134667\n#> 5    35 0.18910965\n#> 6    69 0.12660113\n\nggplot(dados_finais, aes(solo, abund))+\n  geom_point()"},{"path":"cap9.html","id":"cap9","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"Cap√≠tulo 9 An√°lises Multidimensionais","text":"","code":""},{"path":"cap9.html","id":"pr√©-requisitos-do-cap√≠tulo-5","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"Pr√©-requisitos do cap√≠tulo","text":"Pacotes e dados que ser√£o utilizados neste cap√≠tulo.","code":"\n## Pacotes \nlibrary(ade4)\nlibrary(ecodados)\nlibrary(tidyverse)\nlibrary(vegan) \nlibrary(pvclust)\nlibrary(BiodiversityR)\nlibrary(labdsv)\nlibrary(ggplot2)\nlibrary(gridExtra)\nlibrary(ape)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(FD)\nlibrary(palmerpenguins)\nlibrary(GGally)\nlibrary(fields)\nlibrary(ade4)\nlibrary(ggord)\nlibrary(udunits2)\nlibrary(adespatial)\nlibrary(spdep)\nlibrary(mvabund)\nlibrary(reshape)\n\n## Dados\nsp_compos        <- ecodados::bocaina\nspecies          <- ecodados::com_birds\nenv              <- ecodados::env_birds\nxy               <- ecodados::birds.xy\nbocaina.env      <- ecodados::bocaina.env\nbocaina.xy       <- ecodados::bocaina.xy\nanuros_permanova <- ecodados::anuros_permanova\nmacroinv         <- ecodados::macroinv\nfish_comm        <- ecodados::fish_comm\ndata(mite)\ndata(doubs)\ndata(mite.env)\n\n## Traduzir nomes para portugu√™s \ncolnames(penguins) <- c(\"especies\", \"ilha\", \"comprimento_bico\", \"profundidade_bico\", \"comprimento_nadadeira\", \"massa_corporal\", \"sexo\", \"ano\")"},{"path":"cap9.html","id":"aspectos-te√≥ricos","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.1 Aspectos te√≥ricos","text":"An√°lises multivariadas avaliam hip√≥teses cuja vari√°vel resposta √© definida por m√∫ltiplas vari√°veis ao mesmo tempo, comumente expressa na forma de uma matriz quadrada ou de dist√¢ncia (dissimilaridade).Em geral, an√°lises multivariadas t√™m tr√™s principais utilidades: ) reduzir dimensionalidade dos dados e encontrar principal dire√ß√£o de varia√ß√£o dos mesmos, ii) testar rela√ß√µes entre matrizes, ou ainda, iii) encontrar diferen√ßas entre grupos. An√°lises multivariadas podem ser utilizadas como an√°lises explorat√≥rias e/ou para descrever padr√µes em estudos ecol√≥gicos. entanto, mesmo quando se deseja apenas explorar o conjunto de dados para encontrar poss√≠veis padr√µes, necessidade de se ter hip√≥teses, ou ao menos expectativas priori, n√£o pode ser ignorada. Antes de entrar de cabe√ßa nas an√°lises multivariadas, tamb√©m sugerimos fortemente o estudo de m√©todos de amostragem e como fazer boas perguntas (Cap√≠tulo 2).An√°lises multivariadas podem ser divididas, grosseiramente, em dois tipos: agrupamento e ordena√ß√£o. An√°lises de agrupamento, em geral, tentam agrupar objetos (observa√ß√µes) ou descritores em grupos de maneira que objetos mesmo grupo sejam mais semelhantes entre si que objetos de outros grupos (Legendre Legendre 2012). Por exemplo, os objetos podem ser localidades como ‚Äúparcelas,‚Äù ‚Äúriachos‚Äù ou ‚Äúflorestas,‚Äù enquanto os descritores s√£o difentes vari√°veis coletadas para esses objetos (e.g., esp√©cies, vari√°veis ambientais). an√°lise de ordena√ß√£o, por sua vez, √© uma opera√ß√£o pela qual os objetos (ou descritores) s√£o posicionados num espa√ßo que cont√©m menos dimens√µes que o conjunto de dados original; posi√ß√£o dos objetos ou descritores em rela√ß√£o aos outros tamb√©m pode ser usada para agrup√°-los.","code":""},{"path":"cap9.html","id":"coeficientes-de-associa√ß√£o","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.1.1 Coeficientes de associa√ß√£o","text":"Assim chamados genericamente, os coeficientes de associa√ß√£o medem o qu√£o parecidos objetos ou descritores s√£o entre si. Objetos est√£o nas linhas da matriz, enquanto descritores est√£o nas colunas. Geralmente objetos s√£o nossas unidades amostrais, enquanto os descritores s√£o vari√°veis. Quando analisamos rela√ß√£o entre objetos fazemos uma an√°lise modo Q, ao passo que o modo R √© quando analisamos rela√ß√£o entre descritores. Coeficientes de associa√ß√£o modo Q s√£o medidas de (dis)similaridade ou dist√¢ncia, enquanto para o modo R utilizamos covari√¢ncia ou correla√ß√£o. Como j√° tratamos neste livro sobre covari√¢ncia e correla√ß√£o (ver Cap√≠tulo 7), neste t√≥pico vamos falar sobre √≠ndices de dist√¢ncia e similaridade. Mas qual defini√ß√£o destas duas quantitades?Similaridade s√£o m√°ximas (S=1) quando dois objetos s√£o id√™nticosDist√¢ncias s√£o o contr√°rio da similaridade (D=1-S) e n√£o t√™m limites superiores (dependem da unidade de medida)Existem ao menos 26 √≠ndices de similaridade que podem ser agrupados de acordo com o tipo de dado (qualitativos ou quantitativos) ou maneira com que lidam com duplos zeros (sim√©tricos ou assim√©tricos) (Legendre Legendre 2012). seu lado, dist√¢ncias s√≥ se aplicam dados quantitativos e t√™m como caracter√≠sticas serem m√©tricas, semi-m√©tricas ou n√£o-m√©tricas. Vejamos agora os principais √≠ndices de similaridade e dist√¢ncia de cada tipo.","code":""},{"path":"cap9.html","id":"m√©tricas-de-dist√¢ncia","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.1.2 M√©tricas de dist√¢ncia","text":"O principal coeficiente de dist√¢ncia usado em ecologia √© dist√¢ncia euclidiana. Al√©m disso, temos ainda Canberra (varia√ß√£o da Dist√¢ncia Euclidiana), Mahalanobis (calcula dist√¢ncia entre dois pontos num espa√ßo n√£o ortogonal, levando em considera√ß√£o covari√¢ncia entre descritores), Manhattan (varia√ß√£o da Dist√¢ncia Euclidiana), Chord (elimina diferen√ßas entre abund√¢ncia total de esp√©cies), ùúí2 (d√° peso maior para esp√©cies raras), Hellinger (n√£o d√° peso para esp√©cies raras). Essas dist√¢ncias s√£o recomendadas nos casos em que vari√°veis de estudo forem cont√≠nuas, como por exemplo, vari√°veis morfom√©tricas ou descritores ambientais.Uma caracter√≠stica comum de conjuntos de dados ecol√≥gicos s√£o os v√°rios zeros encontrados em matrizes de composi√ß√£o. Eles surgem porque n√£o encontramos nenhum indiv√≠duo de uma determinada esp√©cie num local, seja porque aquele local n√£o tem condi√ß√µes ambientais adequadas ela, falha na detectabilidade, ou din√¢micas demogr√°ficas estoc√°sticas de coloniza√ß√£o-extin√ß√£o (Blasco‚ÄêMoreno et al. 2019). Logo, quando dois locais compartilham aus√™ncia de esp√©cies, n√£o √© poss√≠vel atribuir uma √∫nica raz√£o da dupla aus√™ncia. Como essas medidas de dist√¢ncia apresentadas acima assumem que os dados s√£o quantitativos e n√£o de contagem, elas n√£o s√£o adequadas para lidar com dados de abund√¢ncia ou incid√™ncia de esp√©cies, porque atribuem um grau de parec√™n√ßa pares de locais que compartilham zeros (Legendre Legendre 2012). Por esse motivo, precisamos de coeficientes que desconsiderem os duplos zeros. Eles s√£o chamados de assim√©tricos.Coeficientes assim√©tricos bin√°rios para objetosEsses coeficientes (ou √≠ndices) s√£o apropriados para dados de incid√™ncia de esp√©cies (presen√ßa-aus√™ncia) e desconsideram duplas aus√™ncias. Os √≠ndices deste tipo mais comuns utilizados em ecologia s√£o Jaccard, S√∏rensen e Ochiai.O coeficiente de Jaccard √© dado por:\\[\\beta_j = /(+b+c)\\]\nondea = n√∫mero de esp√©cies compartilhadasb = n√∫mero de esp√©cies exclusivas da comunidade 1c = n√∫mero de esp√©cies exclusivas da comunidade 2A diferen√ßa entre os √≠ndices de Jaccard e S√∏rensen √© que o √≠ndice de S√∏rensen d√° peso dobrado para duplas presen√ßas. Por conta dessas caracter√≠sticas, estes √≠ndices s√£o adequados para quantificar diversidade beta (M. J. Anderson et al. 2011; Legendre De C√°ceres 2013). Esses √≠ndices variam entre 0 (nenhuma esp√©cie √© compartilhada entre o par de locais) 1 (todas esp√©cies s√£o compartilhadas entre o par de locais).O coeficiente de S√∏rensen √© dado por:\\[\\beta_s = 2a/(2a+b+c)\\]\nondea = n√∫mero de esp√©cies compartilhadasb = n√∫mero de esp√©cies exclusivas da comunidade 1c = n√∫mero de esp√©cies exclusivas da comunidade 2Coeficientes bin√°rios para descritores (R mode)Se o objetivo calcular similaridade entre descritores bin√°rios (e.g., presen√ßa ou aus√™ncia de caracter√≠sticas ambientais) de pares de locais, geralmente o coeficiente recomendado √© o de Sokal & Michener. Este √≠ndice est√° implementado na fun√ß√£o dist.binary() pacote ade4.Coeficientes quantitativos para objetosEstes s√£o os coeficientes utilizados para dados de contagem (e.g., abund√¢ncia) e quantitativos (e.g., frequ√™ncia, biomassa, porcentagem de cobertura). Diferentemente das dist√¢ncias, estes coeficientes s√£o assim√©tricos, ou seja, n√£o consideram duplas aus√™ncias, e portanto, s√£o adequados para analisar dados de composi√ß√£o de esp√©cies. Al√©m disso, uma outra caracter√≠stica deles √© serem semi-m√©tricos. Os √≠ndices mais comuns deste tipo s√£o Bray-Curtis (conhecido como percentage difference, em ingl√™s), Chord, log-Chord, Hellinger, chi-quadrado e Morisita-Horn.Todos os √≠ndices discutidos at√© aqui est√£o implementados nas fun√ß√µes ade4::dist.ktab(), adespatial::dist.ldc() e vegan::vegdist().Coeficientes para descritores (R mode) que incluem mistura de tipos de dados√â comum em an√°lises de diversidade funcional que tenhamos um conjunto de atributos (traits) de esp√©cies que s√£o formados por v√°rios tipos de dados: quantitativos (e.g., tamanho de corpo), bin√°rios (presen√ßa/aus√™ncia de uma dada caracter√≠stica), fuzzy (um atributo multiestado codificado em v√°rias colunas), ordinais e circulares (e.g., distribui√ß√£o de uma fenofase ao longo de um ano). O √≠ndice que lida com todos esses dados √© o Gower. vers√£o extendida √≠ndice de Gower pode ser encontrada na fun√ß√£o ade4::dist.ktab().O cap√≠tulo 7 de Legendre & Legendre (2012) fornece uma chave dicot√¥mica para escolha √≠ndice mais adequado.Padroniza√ß√µes e transforma√ß√µes√â comum coletarmos m√∫ltiplas vari√°veis ambientais cujas unidades sejam diferentes. Por exemplo, temperatura (¬∫C), dist√¢ncia da margem (m), √°rea (m2), etc. Para diminuir taxa de Erro Tipo das an√°lises (rejeitar hip√≥tese nula quando ela √© verdadeira), √© recomendado que padronizemos os dados utilizando distribui√ß√£o Z, assim todas vari√°veis passam ter m√©dia 0 e desvio padr√£o 1. Essa opera√ß√£o garante que todas vari√°veis tenham o mesmo peso nas an√°lises que avaliam o padr√£o dos objetos considerando os m√∫ltiplos descritores. Essa padroniza√ß√£o pode ser implementada na fun√ß√£o vegan::decostand().Outro problema comum de matrizes de dados de composi√ß√£o de esp√©cies √© o alto n√∫mero de zeros, enquanto outras esp√©cies podem ter altas abund√¢ncias. Isso gera problemas em ordena√ß√µes. Para diminuir essa discrep√¢ncia, podemos transformar os dados, por exemplo, utilizando dist√¢ncia de Hellinger ou Chord. Para dados cont√≠nuos pode ser que transforma√ß√£o log ou raiz quadrada ajude quando h√° valores muito discrepantes (leverages) que podem influenciar em demasiado rela√ß√£o entre objetos ou descritores. Isso pode ser feito na fun√ß√£o vegan::decostand().","code":""},{"path":"cap9.html","id":"an√°lises-de-agrupamento","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.2 An√°lises de agrupamento","text":"O objetivo da an√°lise de agrupamento √© agrupar objetos admitindo que haja um grau de similaridade entre eles. Esta an√°lise pode ser utilizada ainda para classificar uma popula√ß√£o em grupos homog√™neos de acordo com uma caracter√≠stica de interesse. grosso modo, uma an√°lise de agrupamento tenta resumir uma grande quantidade de dados e apresent√°-la de maneira f√°cil de visualizar e entender (em geral, na forma de um dendrograma). entanto, os resultados da an√°lise podem n√£o refletir necessariamente toda informa√ß√£o originalmente contida na matriz de dados. Para avaliar o qu√£o bem uma an√°lise de agrupamento representa os dados originais existe uma m√©trica ‚Äî o coeficiente de correla√ß√£o cofen√©tico ‚Äî o qual discutiremos em detalhes mais adiante.Antes de considerar algum m√©todo de agrupamento, pense porque voc√™ esperaria que houvesse uma descontinuidade nos dados; ou ainda, considere se existe algum ganho pr√°tico em dividir uma nuvem de objetos cont√≠nuos em grupos. O padr√£o apresentado pelo dendograma depende protocolo utilizado (m√©todo de agrupamento e √≠ndice de dissimilaridade); os grupos formados dependem n√≠vel de corte escolhido.matriz deve conter os objetos serem agrupados (e.g., esp√©cies) nas linhas e vari√°veis (e.g., locais de coleta ou medidas morfol√≥gicas) nas colunas. escolha m√©todo de agrupamento √© cr√≠tico para escolha de um coeficiente de associa√ß√£o. √â importante compreender propriedades dos m√©todos de agrupamento para interpretar corretamente estrutura ecol√≥gica que eles evidenciam (Legendre Legendre 2012). De acordo com classifica√ß√£o de Sneath & Sokal (1973), existem cinco tipos de m√©todos: ) sequenciais ou simult√¢neos, ii) aglomerativo ou divisivo, iii) monot√©ticos ou polit√©ticos, iv) hier√°rquico ou n√£o hier√°rquicos e v) probabil√≠stico. Sugerimos leitura artigo citado anteriormente para aprofundar seus conhecimentos sobre os diferentes m√©todos.","code":""},{"path":"cap9.html","id":"agrupamento-hier√°rquico","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.2.1 Agrupamento hier√°rquico","text":"M√©todos hier√°rquicos podem ser divididos naqueles que consideram o centr√≥ide ou m√©dia aritm√©tica entre os grupos. O principal m√©todo hier√°rquico que utiliza m√©dia aritm√©tica √© o UPGMA (Agrupamento pelas m√©dias aritm√©ticas n√£o ponderadas), e o principal m√©todo que utiliza centr√≥ides √© Dist√¢ncia m√≠nima de Ward.O UPGMA funciona da seguinte forma: maior similaridade (ou menor dist√¢ncia) identifica os pr√≥ximos agrupamentos serem formados. Ap√≥s esse evento, o m√©todo calcula m√©dia aritm√©tica das similaridades ou dist√¢ncias entre um objeto e cada um dos membros grupo ou, caso de um grupo previamente formado, entre todos os membros dos dois grupos. Todos os objetos recebem pesos iguais c√°lculo.O m√©todo de Ward √© baseado crit√©rio de quadrados m√≠nimos (OLS), o mesmo utilizado para ajustar um modelo linear (Cap√≠tulo 7). O objetivo √© definir os grupos de maneira que soma de quadrados (.e.¬†similar ao erro quadrado da ANOVA) dentro dos grupos seja minimizada (Borcard, Gillet, Legendre 2018).entanto, para interpretar os resultados precisamos antes definir um n√≠vel de corte, que vai nos dizer quantos grupos existem. H√° v√°rios m√©todos para definir grupos, desde os heur√≠sticos aos que utilizam reamostragem (bootstrap). Se quisermos interpretar este dendrograma, podemos, por exemplo, estabelecer um n√≠vel de corte de 50% de dist√¢ncia (ou seja, grupos cujos objetos tenham ao menos 50% de similaridade entre si).ChecklistVerifique se n√£o h√° espa√ßo nos nomes das colunas e linhasVerifique se n√£o h√° espa√ßo nos nomes das colunas e linhasSe os dados forem de abund√¢ncia, recomenda-se realizar transforma√ß√£o de Hellinger (Legendre Gallagher 2001). Esta transforma√ß√£o √© necess√°ria porque matriz de comunidades (em especial, com presen√ßa de muitas esp√©cies raras) pode causar distor√ß√µes nos m√©todos de ordena√ß√£o baseados em dist√¢ncia Euclidiana (Legendre Gallagher 2001)Se os dados forem de abund√¢ncia, recomenda-se realizar transforma√ß√£o de Hellinger (Legendre Gallagher 2001). Esta transforma√ß√£o √© necess√°ria porque matriz de comunidades (em especial, com presen√ßa de muitas esp√©cies raras) pode causar distor√ß√µes nos m√©todos de ordena√ß√£o baseados em dist√¢ncia Euclidiana (Legendre Gallagher 2001)Se matriz original contiver muitos valores discrepantes (e.g., uma esp√©cie muito mais ou muito menos abundante que outras) √© necess√°rio transformar os dados usando log1p(). entanto, deve-se fazer ou transforma√ß√£o de Hellinger ou log e nunca duas ao mesmo tempoSe matriz original contiver muitos valores discrepantes (e.g., uma esp√©cie muito mais ou muito menos abundante que outras) √© necess√°rio transformar os dados usando log1p(). entanto, deve-se fazer ou transforma√ß√£o de Hellinger ou log e nunca duas ao mesmo tempoSe vari√°veis forem medidas tomadas em diferentes escalas (metros, graus celsius etc.), √© necess√°rio padronizar cada vari√°vel para ter m√©dia 0 e desvio padr√£o 1. Isso pode ser feito utulizando fun√ß√£o decostand() pacote veganSe vari√°veis forem medidas tomadas em diferentes escalas (metros, graus celsius etc.), √© necess√°rio padronizar cada vari√°vel para ter m√©dia 0 e desvio padr√£o 1. Isso pode ser feito utulizando fun√ß√£o decostand() pacote veganExemplo 1Neste exemplo, vamos utilizar um conjunto de dados que cont√©m girinos de esp√©cies de anuros coletados em 14 po√ßas com diferentes coberturas de dossel (Provete et al. 2014).PerguntaExistem grupos de esp√©cies de anf√≠bios anuros com padr√µes de ocorr√™ncia similar ao longo das po√ßas?Predi√ß√µesIremos encontrar ao menos dois grupos de esp√©cies: aquelas que ocorrem em po√ßas dentro de floresta (.e., maior cobertura de dossel) vesus aquelas que ocorrem em po√ßas de √°reas abertas (menor cobertura de dossel)Vari√°veisVari√°veis preditoras: matriz de dados cont√©m abund√¢ncia das esp√©cies nas linhas e locais (po√ßas) nas colunasAn√°lisesPara come√ßar, vamos primeiro importar os dados e depois calcular matriz de dist√¢ncia que seja adequada para o tipo de dado que temos (abund√¢ncia de esp√©cies - dados de contagem) (Figura 9.1).\nFigura 9.1: Dendrograma mostrando uma an√°lise de agrupamento de anuros.\nAssessando qualidade dendrogramaPrecisamos verificar se o agrupamento reduziu dimensionalidade da matiz de forma eficiente, de maneira n√£o distorcer informa√ß√£o. Fazemos isso calculando o Coeficiente de Correla√ß√£o Cofen√©tica.Um coeficiente de correla√ß√£o cofen√©tica > .7 indica uma boa representa√ß√£o. Portanto, o nosso resultado de 0.9455221 √© alto, garantindo que o dendrograma √© adequado (Figura 9.2). Note que testar ‚Äúsignific√¢ncia‚Äù deste coeficiente n√£o √© adequado, j√° que seria algo tautol√≥gico (circular). Claro que definir o que seria um valor ‚Äúalto‚Äù ou ‚Äúbaixo‚Äù da correla√ß√£o √© um pouco arbritr√°rio, mas pode-se usar como ‚Äúregra polegar.‚Äù\nFigura 9.2: Dendrograma mostrando uma an√°lise de agrupamento de anuros com uma linha de corte formando cinco grupos.\nNesse caso teremos forma√ß√£o de cinco grupos, representados pelos n√≥s que est√£o abaixo da linha de corte. Portanto, o resultado n√£o suporta nossa hip√≥tese priori que predizia forma√ß√£o de apenas dois grupos de esp√©cies.Exemplo 2No exemplo anterior, vimos que √© dif√≠cil interpretar os grupos baseado num n√≠vel de corte. seguir, vamos utilizar o pacote pvclust que . Uma desvantagem deste m√©todo √© que ele somente aceita √≠ndices de similaridade da fun√ß√£o dist(), que possui apenas dist√¢ncia Euclidiana, Manhattan e Canberra. Uma maneira de contornarmos essa limita√ß√£o √© utilizar transforma√ß√µes dos dados dispon√≠veis na fun√ß√£o disttransform() pacote BiodiversityR ou fun√ß√£o decostand() pacote vegan. Tamb√©m √© poss√≠vel utilizar transforma√ß√£o de Box-Cox para dados multivariados, dispon√≠vel material suplementar de Legendre & Borcard (2018). Esta transforma√ß√£o √© geralmente utilizada para tornar distribui√ß√£o dos dados mais sim√©trica (menos enviesada para valores extremos: reduzir o skewness dos dados).An√°lisesVamos utilizar o mesmo conjunto de dados Exemplo 1 para responder √† mesma pergunta. Aqui vamos utilizar dist√¢ncia de Chord (que √© indicada para dados de composi√ß√£o de esp√©cies) para calcular matriz de dist√¢ncia. Se transformarmos uma matriz usando transforma√ß√£o Chord e depois calcularmos dist√¢ncia Euclidiana, isso equivale √† calcular diretamente dist√¢ncia de Chord (Figura 9.3).\nFigura 9.3: Dendrograma mostrando uma an√°lise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando dist√¢ncia de Chord.\n√â poss√≠vel notar que existe um √∫nico grupo com BS > 95%. Agora vamos tentar usar dist√¢ncia de Hellinger, que √© recomendada (junto com dist√¢ncia de Chord) para transformar dados de composi√ß√£o de esp√©cies (Legendre Gallagher 2001) (Figura 9.4).\nFigura 9.4: Dendrograma mostrando uma an√°lise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando dist√¢ncia de Hellinger.\nInterpreta√ß√£o dos resultadosNotem que se mudarmos o coeficiente de associa√ß√£o, o resultado tamb√©m muda. Agora temos um grupo mais, composto por Dendropsophus minutus e Scinax duartei que n√£o apareciam antes. Isso se deve ao fato de que dist√¢ncia de Hellinger d√° menos peso para esp√©cies raras que Chord.Neste sentido, os dados n√£o suportam nossa hip√≥tese inicial da forma√ß√£o de dois grupos, independentemente coeficiente de associa√ß√£o utilizado e c√°lculo automatico n√≠vel de corte baseado na reamostragem.","code":"\n## Composi√ß√£o de esp√©cies (seis primeiras localidades)\nhead(sp_compos)\n#>         BP4  PP4 PP3  AP1 AP2 PP1 PP2 BP9  PT1 PT2 PT3 BP2 PT5\n#> Aper      0    3   0    0   2   0   0   0    0   0   0 181   0\n#> Bahe    859   14  14    0  87 312 624 641    0   0   0  14   0\n#> Rict   1772 1517 207  573 796   0   0   0    0   0   0   0   0\n#> Cleuco    0    0   0    0   0   0   0   0    0  29 369   0  84\n#> Dmic      0    0   6   60   4   0   0   0 2758 319  25   0 329\n#> Dmin      0   84 344 1045  90   0   0   0    8   0   0   0   0\n\n## Matriz de similaridade com o coeficiente de Morisita-Horn\ndistBocaina <- vegdist(x = sp_compos, method = \"horn\")\n\n## Agrupamento com a fun√ß√£o hclust e o m√©todo UPGMA\ndendro <- hclust(d = distBocaina, method = \"average\")\n\n## Visualizar os resultados\nplot(dendro, main = \"Dendrograma\", \n     ylab = \"Similaridade (√≠ndice de Horn)\",\n     xlab=\"\", sub=\"\")\n## Coeficiente de correla√ß√£o cofen√©tica\ncofresult <- cophenetic(dendro)\ncor(cofresult, distBocaina)\n#> [1] 0.9455221\n## Gr√°fico\nplot(dendro, main = \"Dendrograma\", \n     ylab = \"Similaridade (√≠ndice de Horn)\",\n     xlab=\"\", sub=\"\")\nk <- 4\nn <- ncol(sp_compos)\nMidPoint <- (dendro$height[n-k] + dendro$height[n-k+1]) / 2\nabline(h = MidPoint, lty=2)\n## Dados\nhead(t(sp_compos))\n#>     Aper Bahe Rict Cleuco Dmic Dmin Hpoly Lfur Pbar Polf Pmelano Sduar Shay Sobt Ssqual Bokerm\n#> BP4    0  859 1772      0    0    0    61    3  387    0       0     0    0    0      0      0\n#> PP4    3   14 1517      0    0   84   275    0  187    0       0  1150    6    0      0      1\n#> PP3    0   14  207      0    6  344   388    0    0    0       0   428    0    0      0      0\n#> AP1    0    0  573      0   60 1045  1054    0    0    0       0   476   92   13      0      0\n#> AP2    2   87  796      0    4   90  3002    0    0    2       0     7    0    5      0      0\n#> PP1    0  312    0      0    0    0   329    0    0    0       0     0    0    0      0      0\n\n## Passo 1: transformar para dist√¢ncia de Chord\nbocaina_transf <- disttransform(t(sp_compos), \"chord\")\n\n## Passo 2: realizar pvclust com m√©todo average e dist√¢ncia euclidiana\nanalise <- pvclust(bocaina_transf, method.hclust = \"average\", method.dist = \"euclidean\", quiet = TRUE) \n## Passo 3: dendrograma\nplot(analise, hang=-1, main = \"Dendrograma com valores de P\", \n     ylab = \"Dist√¢ncia Euclideana\",\n     xlab=\"\", sub=\"\")\npvrect(analise)\n## Passo 1: transformar dados com Hellinger\nbocaina_transf2 <- disttransform(t(bocaina), \"hellinger\")\n\n## Passo 2: realizar pvclust com m√©todo average e dist√¢ncia euclidiana\nanalise2 <- pvclust(bocaina_transf2, method.hclust=\"average\", method.dist=\"euclidean\", quiet = TRUE) \n\n## Passo 3: dendrograma\nplot(analise2, hang=-1, main = \"Dendrograma com valores de P\", \n     ylab = \"Dist√¢ncia Euclideana\",\n     xlab=\"\", sub=\"\")\nk <- 4\nn <- ncol(sp_compos)\nMidPoint <- (dendro$height[n-k] + dendro$height[n-k+1]) / 2\nabline(h = MidPoint, lty=2)\npvrect(analise2)"},{"path":"cap9.html","id":"agrupamento-n√£o-hier√°rquico-k-means","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.2.2 Agrupamento n√£o-hier√°rquico (K-means)","text":"Ao contr√°rio dendrograma, o K-means √© um agrupamento n√£o-hier√°rquico e, desse modo, n√£o √© otimizado para busca grupos menores aninhados em grupos maiores. Resumidamente, podemos calcular o K-means partir de uma matriz quadrada ou de dist√¢ncia. Essa t√©cnica procura particionar os objetos em k grupos de maneira minimizar soma de quadrados entre grupos e maximiz√°-la dentro dos grupos. Um crit√©rio similar ao de uma ANOVA (Cap√≠tulo 7). Um diferencial K-means em rela√ß√£o aos agrupamentos hier√°rquicos √© que o usu√°rio pode escolher antecipadamente o n√∫mero de grupos que deseja formar.Exemplo 1Para este exemplo, iremos utilizar um conjunto de dados dispon√≠vel pacote ade4 que cont√©m dados de 27 esp√©cies de peixes coletados em 30 pontos ao longo Rio Doubs, na fronteira entre Fran√ßa e Su√≠√ßa.PerguntaQual √© o n√∫mero de grupos que melhor sumariza o padr√£o de ocorr√™ncia de esp√©cies de peixes ao longo de um riacho? üìù Importante \nNeste caso, estamos realizando uma an√°lise explorat√≥ria e n√£o temos uma predi√ß√£o.Vari√°veisVari√°veis resposta: composi√ß√£o de esp√©cies de peixesChecklistVamos normalizar os dados de abund√¢ncia antes de entrar na an√°lise propriamente, j√° que existem muitos zeros na matrizAn√°lisesVamos iniciar selecionando e padronizando os dados.O argumento centers na fun√ß√£o kmeans() indica o n√∫mero de grupos que se quer formar. Neste exemplo, estamos utilizando centers = 4.O objeto que fornece o resultado cont√©m: ) o tamanho (n√∫mero de objetos) em cada um dos 4 grupos, ii) o centroide de cada grupo e o pertencimento de cada esp√©cie cada grupo, e iii) o quanto da Soma de Quadrados dos dados √© explicada por esta conforma√ß√£o de grupos.entanto, n√£o √© poss√≠vel saber priori qual o n√∫mero ‚Äúideal‚Äù de grupos. Para descobrir isso, repetimos o k-means com uma s√©rie de valores de K. Isso pode ser feito na fun√ß√£o cascadeKM().Tanto calinski quando ssi s√£o bons crit√©rios para encontrar o n√∫mero ideal de grupos. Quanto maior o valor de ssi, melhor (veja ?cascadeKM() mais detalhes). Os valores de ssi √© o crit√©rio utilizado pelo algor√≠timo para achar o agrupamento √≥timo dos objetos (Figura 9.5).\nFigura 9.5: Gr√°ficos mostrando os resultados da an√°lise de K-Means.\nInterpreta√ß√£o dos resultadosDiferentemente da nossa predi√ß√£o inicial, o resultado da an√°lise mostra que o n√∫mero ideal de grupos para explicar vari√¢ncia padr√£o de ocorr√™ncia de esp√©cies √© 3. Notem que o SSI m√°ximo √© alcan√ßado neste n√∫mero de grupos 0.1685126 (tamb√©m indicado pela bola vermelha plot).","code":"\n## Mostrar somente seis primeiras esp√©cies de seis localidades\nhead(doubs$fish)[,1:6]\n#>   Cogo Satr Phph Neba Thth Teso\n#> 1    0    3    0    0    0    0\n#> 2    0    5    4    3    0    0\n#> 3    0    5    5    5    0    0\n#> 4    0    4    5    5    0    0\n#> 5    0    2    3    2    0    0\n#> 6    0    3    4    5    0    0\n\n## Verificar se existem localidades sem nenhuma ocorr√™ncia\nrowSums(doubs$fish)\n#>  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \n#>  3 12 16 21 34 21 16  0 14 14 11 18 19 28 33 40 44 42 46 56 62 72  4 15 11 43 63 70 87 89\n\n## Retirar a linha 8 (rio sem nenhuma ocorr√™ncia de peixe)\nspe <- doubs$fish[-8,]\n\n## Fun√ß√£o do pacote vegan para normalizar os dados\nspe.norm <- decostand(x = spe, method = \"normalize\") \n## K-Means\nspe.kmeans <- kmeans(x = spe.norm, centers = 4, nstart = 100)\nspe.kmeans\n#> K-means clustering with 4 clusters of sizes 8, 12, 6, 3\n#> \n#> Cluster means:\n#>         Cogo        Satr       Phph       Neba        Thth        Teso       Chna       Chto       Lele      Lece\n#> 1 0.00000000 0.006691097 0.02506109 0.06987391 0.006691097 0.006691097 0.10687104 0.09377516 0.14194394 0.2011411\n#> 2 0.10380209 0.542300691 0.50086515 0.43325916 0.114024105 0.075651573 0.00000000 0.00000000 0.06983991 0.1237394\n#> 3 0.06167791 0.122088022 0.26993915 0.35942538 0.032664966 0.135403325 0.06212775 0.21568957 0.25887226 0.2722562\n#> 4 0.00000000 0.000000000 0.00000000 0.00000000 0.000000000 0.000000000 0.05205792 0.00000000 0.07647191 0.3166705\n#>         Baba      Spbi       Gogo       Eslu       Pefl      Rham       Legi       Scer       Cyca       Titi       Abbr\n#> 1 0.24327992 0.1326062 0.28386032 0.20630360 0.16920496 0.2214275 0.19066542 0.13171275 0.16019126 0.26230024 0.19561641\n#> 2 0.02385019 0.0000000 0.05670453 0.04722294 0.02949244 0.0000000 0.00000000 0.00000000 0.00000000 0.03833408 0.00000000\n#> 3 0.15647062 0.1574388 0.16822286 0.12276089 0.17261621 0.0793181 0.06190283 0.04516042 0.06190283 0.14539027 0.01473139\n#> 4 0.00000000 0.0000000 0.20500174 0.07647191 0.00000000 0.0000000 0.05205792 0.07647191 0.00000000 0.00000000 0.00000000\n#>        Icme       Acce       Ruru       Blbj      Alal       Anan\n#> 1 0.1331835 0.26713081 0.32103755 0.22883055 0.3326939 0.18873077\n#> 2 0.0000000 0.00000000 0.01049901 0.00000000 0.0000000 0.00000000\n#> 3 0.0000000 0.03192175 0.32201597 0.01473139 0.1095241 0.04739636\n#> 4 0.0000000 0.18058775 0.31667052 0.05205792 0.7618709 0.00000000\n#> \n#> Clustering vector:\n#>  1  2  3  4  5  6  7  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \n#>  2  2  2  2  3  2  2  3  2  2  2  2  2  2  3  3  3  3  1  1  1  4  4  4  1  1  1  1  1 \n#> \n#> Within cluster sum of squares by cluster:\n#> [1] 0.4696535 2.5101386 1.7361453 0.3560423\n#>  (between_SS / total_SS =  66.7 %)\n#> \n#> Available components:\n#> \n#> [1] \"cluster\"      \"centers\"      \"totss\"        \"withinss\"     \"tot.withinss\" \"betweenss\"    \"size\"         \"iter\"        \n#> [9] \"ifault\"\n## Repetindo o K-Means\nspe.KM.cascade <- cascadeKM(spe.norm, inf.gr = 2, sup.gr = 10, iter = 100, criterion = \"ssi\") \n## Resumo dos resultados\nspe.KM.cascade$results\n#>      2 groups  3 groups  4 groups  5 groups   6 groups  7 groups  8 groups  9 groups 10 groups\n#> SSE 8.2149405 6.4768108 5.0719796 4.3015573 3.58561200 2.9523667 2.4840549 2.0521888 1.7599292\n#> ssi 0.1312111 0.1685126 0.1409061 0.1299662 0.08693436 0.1481826 0.1267918 0.1134307 0.1226392\n\n## Gr√°fico\nplot(spe.KM.cascade, sortg = TRUE)"},{"path":"cap9.html","id":"esp√©cies-indicadoras","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.2.3 Esp√©cies indicadoras","text":"Uma pergunta normalmente feita por ec√≥logos √©: qual esp√©cie pode ser indicadora de uma determinada condi√ß√£o ambiental (e.g., polui√ß√£o)?O √≠ndice IndVal mede dois aspectos das esp√©cies: fidelidade e especificidade. Uma alta fidelidade significa que esp√©cies ocorrem em todos os locais grupo, e uma alta especificidade significa que esp√©cies ocorrem somente naquele grupo. Uma boa esp√©cie indicadora √© aquela na qual todos os indiv√≠duos ocorrem em todas amostras referentes um grupo espec√≠fico. especificidade √© dada pela divis√£o da abund√¢ncia m√©dia da esp√©cie grupo pela somat√≥rio das abund√¢ncias m√©dias dos grupos. Fidelidade √© igual ao n√∫mero de lugares grupo onde esp√©cie est√° presente dividido pelo n√∫mero total de lugares grupo (DufreÃÇne Legendre 1997).Esp√©cies raras podem receber o mesmo valor de IndVal das esp√©cies indicadoras, por√©m s√£o chamadas de indicadoras assim√©tricas, uma vez que contribuem com especificidade habitat, mas n√£o servem para predizer grupos. Ao contr√°rio, esp√©cies indicadoras s√£o verdadeiros indicadores sim√©tricos e podem ser usadas para predizer grupos.an√°lise procede da seguinte forma:Uma matriz de dist√¢ncia √© constru√≠da e unidades amostrais s√£o classificadas com alguma an√°lise de agrupamento, hier√°rquico ou n√£oUma matriz de dist√¢ncia √© constru√≠da e unidades amostrais s√£o classificadas com alguma an√°lise de agrupamento, hier√°rquico ou n√£oA vari√°vel ambiental para qual se deseja classificar os grupos √© inseridaA vari√°vel ambiental para qual se deseja classificar os grupos √© inseridaAs esp√©cies indicadoreas de cada grupo s√£o formadas atrav√©s c√°lculo da especificidade e fidelidade, obtendo-se o valor de IndVal para cada esp√©cieAs esp√©cies indicadoreas de cada grupo s√£o formadas atrav√©s c√°lculo da especificidade e fidelidade, obtendo-se o valor de IndVal para cada esp√©ciePor fim, o conjunto de dados originais √© comparado para ver se an√°lise faz sentidoPor fim, o conjunto de dados originais √© comparado para ver se an√°lise faz sentidoO c√°lculo da signific√¢ncia √≠ndice de IndVal √© feito por aleatoriza√ß√£o de Monte Carlo. Os m√©todos de Monte Carlo utilizam n√∫meros aleat√≥rios de dados reais para simular certos padr√µes esperados na aus√™ncia de um processo ecol√≥gico espec√≠fico (Legendre Legendre 2012). Assim, o valor √≠ndice √© aleatorizado 999 vezes (ou o n√∫mero de vezes que voc√™ optar) dentro dos tratamentos e o valor de P √© dado pelo n√∫mero de vezes em que o √≠ndice observado foi igual ou maior que os valores aleatorizados. Portanto, o IndVal fornece um conjunto de esp√©cies que s√£o indicadoras de um grupo de locais (e.g., muito polu√≠dos), que por sua vez precisam ser definidos utilizando alguma t√©cnica de agrupamento, como que vimos anteriormente.Exemplo 1Para este exemplo, vamos usar o mesmo conjunto de dados utilizado acima com abund√¢ncia de 16 esp√©cies de girinos coletados em 14 po√ßas com diferentes graus de cobertura de dossel na Serra da Bocaina (Provete et al. 2014).PerguntaPodemos utilizar esp√©cies de girinos como indicadoras da fitofisionomia?Predi√ß√µesEsp√©cies terrestres ser√£o indicadoras de √°rea aberta, enquanto esp√©cies arbor√≠colas ser√£o indicadoras de √°reas florestaisVari√°veisVari√°veis resposta: mesma matriz j√° utilizada contendo abund√¢ncia de girinos ao longo de po√ßas na Serra da BocainaAn√°lisesO IndVal est√° dispon√≠vel tanto pacote indicspecies, quando labdsv. Para este exemplo, iremos usar o labdsv. Primeiro, vamos agrupar unidades amostrais (po√ßas) que informa os grupos de fitofisionomias onde po√ßas se localizam e para os quais deseja-se encontrar esp√©cies indicadoras.Para apresentar uma tabela dos resultados para todas esp√©cies temos de processar os dados.Interpreta√ß√£o dos resultadosNo resultado apresentado, podemos ver que temos duas esp√©cies indicadoras da fitofisionimia 1: Rhinella icterica (Rict) e Scinax duartei (Sduar). Nenhuma esp√©cie foi indicadora dos outros grupos neste exemplo.","code":"\n## Dados\nhead(bocaina)\n#>         BP4  PP4 PP3  AP1 AP2 PP1 PP2 BP9  PT1 PT2 PT3 BP2 PT5\n#> Aper      0    3   0    0   2   0   0   0    0   0   0 181   0\n#> Bahe    859   14  14    0  87 312 624 641    0   0   0  14   0\n#> Rict   1772 1517 207  573 796   0   0   0    0   0   0   0   0\n#> Cleuco    0    0   0    0   0   0   0   0    0  29 369   0  84\n#> Dmic      0    0   6   60   4   0   0   0 2758 319  25   0 329\n#> Dmin      0   84 344 1045  90   0   0   0    8   0   0   0   0\nfitofis <- c(rep(1, 4), rep(2, 4), rep(3, 4), rep(4, 4), rep(5, 4))\n\n## An√°lise de esp√©cies indicadoras\nres_indval <- indval(t(sp_compos), fitofis)\n\n# A fun√ß√£o summary s√≥ exibe o resultado para as esp√©cies indicadoras\nsummary(res_indval)\n#>       cluster indicator_value probability\n#> Rict        1          0.8364       0.011\n#> Sduar       1          0.7475       0.034\n#> Bahe        2          0.6487       0.048\n#> \n#> Sum of probabilities                 =  7.984 \n#> \n#> Sum of Indicator Values              =  7.3 \n#> \n#> Sum of Significant Indicator Values  =  2.23 \n#> \n#> Number of Significant Indicators     =  3 \n#> \n#> Significant Indicator Distribution\n#> \n#> 1 2 \n#> 2 1\n## Resultados\nres_indval$maxcls # classe de maior valor indicador/esp√©cie \n#>    Aper    Bahe    Rict  Cleuco    Dmic    Dmin   Hpoly    Lfur    Pbar    Polf Pmelano   Sduar    Shay    Sobt  Ssqual \n#>       3       2       1       3       3       1       2       3       1       3       2       1       3       2       3 \n#>  Bokerm \n#>       2\nres_indval$indcls # valor indicador (indval)\n#>      Aper      Bahe      Rict    Cleuco      Dmic      Dmin     Hpoly      Lfur      Pbar      Polf   Pmelano     Sduar \n#> 0.2432796 0.6487329 0.8363823 0.4128631 0.6645244 0.7032145 0.6208711 0.2279412 0.2813725 0.2437500 0.2500000 0.7474527 \n#>      Shay      Sobt    Ssqual    Bokerm \n#> 0.4930269 0.2222222 0.2500000 0.4583333\nres_indval$pval # signific√¢ncia do indval\n#>    Aper    Bahe    Rict  Cleuco    Dmic    Dmin   Hpoly    Lfur    Pbar    Polf Pmelano   Sduar    Shay    Sobt  Ssqual \n#>   1.000   0.048   0.011   0.385   0.195   0.101   0.259   1.000   0.624   1.000   1.000   0.034   0.416   0.683   1.000 \n#>  Bokerm \n#>   0.228\ntab_indval <- cbind.data.frame(maxcls = res_indval$maxcls,\n                               ind.value = res_indval$indcls,\n                               P = res_indval$pval)\ntab_indval\n#>         maxcls ind.value     P\n#> Aper         3 0.2432796 1.000\n#> Bahe         2 0.6487329 0.048\n#> Rict         1 0.8363823 0.011\n#> Cleuco       3 0.4128631 0.385\n#> Dmic         3 0.6645244 0.195\n#> Dmin         1 0.7032145 0.101\n#> Hpoly        2 0.6208711 0.259\n#> Lfur         3 0.2279412 1.000\n#> Pbar         1 0.2813725 0.624\n#> Polf         3 0.2437500 1.000\n#> Pmelano      2 0.2500000 1.000\n#> Sduar        1 0.7474527 0.034\n#> Shay         3 0.4930269 0.416\n#> Sobt         2 0.2222222 0.683\n#> Ssqual       3 0.2500000 1.000\n#> Bokerm       2 0.4583333 0.228\n\n## Esp√©cies\ntab_indval[tab_indval$P < 0.05, ]\n#>       maxcls ind.value     P\n#> Bahe       2 0.6487329 0.048\n#> Rict       1 0.8363823 0.011\n#> Sduar      1 0.7474527 0.034"},{"path":"cap9.html","id":"an√°lises-de-ordena√ß√£o","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.3 An√°lises de Ordena√ß√£o","text":"an√°lises de ordena√ß√£o representam um conjunto de m√©todos e t√©cnicas multivariadas que organizam objetos (e.g., localidades, indiv√≠duos) em alguma ordem considerando o conjunto de descritores que podem estar mais ou menos relacionados entre si. Se os descritores estiverem bem relacionados, eles s√£o redundantes e organizam os objetos de forma similar. Esse fen√¥meno √© observado, por exemplo, quando queremos organizar um conjunto de unidades amostrais baseado em vari√°veis que indicam um mesmo processo: ver o padr√£o de similaridade geral de lagos usando v√°rias vari√°veis relacionada com produtividade sistema: clorofila-, concentra√ß√£o de f√≥sforo, nitrog√™nio, entre outros. Por exemplo, tais m√©todos permitem identificar se existem grupo de esp√©cies que ocorrem exclusivamente em um determinado h√°bitat. Ao buscar esta ordem, t√©cnicas de ordena√ß√£o possuem tr√™s principais utilidades: ) reduzir dimensionalidade e revelar padr√µes, ii) separar vari√°veis mais e menos importantes em combina√ß√µes complexas e iii) separar rela√ß√µes mais e menos fortes ao comparar vari√°veis preditoras e dependentes.Em geral, os m√©todos s√£o divid√≠dos em ordena√ß√µes irrestritas (ou an√°lise de gradiente indireto) e restritas (ou an√°lise de gradiente direto). ordena√ß√µes irrestritas organizam os objetos (e.g., esp√©cies) de acordo com sua estrutura de covari√¢ncia (ou correla√ß√£o), o que demonstra que proximidade (ou dist√¢ncia) dentro espa√ßo multidimensional representa semelhan√ßa (ou diferen√ßa) dos objetos. Por outro lado, ordena√ß√µes restritras posicionam os objetos (e.g., esp√©cies) de acordo com sua rela√ß√£o linear com outras vari√°veis coletadas nas mesmas unidades amostraits (e.g., temperatura e precipita√ß√£o). Ao passo que ordena√ß√µes irrestritas dependem somente de uma matriz (e.g., esp√©cies por localidades), ordena√ß√µes restritas utilizam m√≠nimo duas matrizes (e.g., esp√©cies por localidades e vari√°veis clim√°ticas por localidade). Desse modo, fica claro esta diferen√ßa entre os dados utilizados que an√°lises irrestritas s√£o mais explorat√≥rias, enquanto an√°lises restritas s√£o ideais para testar hip√≥teses com dados multidimensionais. tabela seguir apresenta principais an√°lises utilizadas em ecologia.","code":""},{"path":"cap9.html","id":"ordena√ß√£o-irrestrira","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.4 Ordena√ß√£o irrestrira","text":"Ordena√ß√µes irrestritas, ou an√°lise de gradiente indireto ou ainda an√°lises de fator, s√£o um conjunto de m√©todos multivariados que lidam com uma √∫nica matriz quadrada. Esta matriz pode ou n√£o ter pesos nas linhas ou colunas. Geralmente, o objetivo deste tipo de an√°lise √© resumir informa√ß√£o contida na matriz de maneira gr√°fica, por meio de um diagrama de ordena√ß√£o. Quanto maior e mais complexa matriz, mais eficiente √© este tipo de an√°lise. Os tipos de an√°lise ir√£o diferir de acordo com o tipo de dado contido nesta matriz, se cont√≠nuo ou contagem, etc. De maneira geral, essas ordena√ß√µes irrestritas calculam combina√ß√µes lineares, cuja formula√ß√£o ir√° diferir ligeiramente entre os m√©todos. Da mesma forma, essas combina√ß√µes lineares ir√£o preservar um tipo de dist√¢ncia. Por exemplo, An√°lise de Componentes Principais preserva dist√¢ncia Euclidiana, enquanto An√°lise de Correspond√™ncia preserva dist√¢ncia de chi-quadrado.","code":""},{"path":"cap9.html","id":"an√°lise-de-componentes-principais-pca","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.4.1 An√°lise de Componentes Principais (PCA)","text":"An√°lise de Componentes Principais (Principal Component Analysis - PCA) √© uma das ordena√ß√µes mais utilizadas em diversas √°reas conhecimento. Em Ecologia, ela se popularizou por facilitar visualiza√ß√£o de dados complexos como de distribui√ß√£o de esp√©cies em diferentes localidades e de potenciais vari√°veis explicativas. Ao mesmo tempo que ganhou tamanha popularidade, PCA tem sido empregada de maneira incorreta, uma vez que muitos estudos utilizam visualiza√ß√£o gr√°fica da ordena√ß√£o (o biplot) para intepretar ‚Äúrela√ß√µes‚Äù entre vari√°veis preditoras (ambientais) e dependentes (esp√©cies). Por√©m, como informado anteriormente, ordena√ß√µes irrestritas utilizam estrutura de covari√¢ncia dos objetos para organizar suas rela√ß√µes de similaridade.Antes de explicar an√°lise, imagine que vamos usar uma matriz com cinco esp√©cies de aranhas que foram encontradas em oito cidades diferentes. quantidade de indiv√≠duos de cada esp√©cie coletada em cada cidade ser√° o valor de preenchimento desta matriz. Sendo assim, matriz possui oito objetos (cidades, representando unidades amostrais) e cinco descritores (esp√©cies), como na Tabela 9.1.\nTabela 9.1: Matriz com cinco esp√©cies de aranhas que foram encontradas em oito cidades diferentes.\nO primeiro passo da PCA √© obter uma matriz centralizada, onde cada valor √© subtra√≠do da m√©dia da coluna que aquele valor pertence. Esta centraliza√ß√£o pode ser calculada com fun√ß√£o scale().O segundo passo √© calcular uma matriz de covari√¢ncia (ou matriz de dispers√£o) e, partir desta matriz, obter os autovalores e autovetores. Os autovalores representam porcentagem de explica√ß√£o de cada eixo e podem ser calculados dividindo soma autovalor de cada eixo pela soma de todos os autovalores. exemplo que apresentamos, os dois primeiros eixos representam 47,20% e 35,01% de toda varia√ß√£o, respectivamente. Os autovetores, por sua vez, representam os valores que multiplicam vari√°veis originais e, desse modo, indicam dire√ß√£o desses valores. Por fim, os componentes principais (Matriz F) s√£o obtidos multiplicando os autovetores com os valores da matriz centralizada.Agora, √© poss√≠vel visualizar rela√ß√£o entre cidades e similaridade na esp√©cies de aranhas que vivem em cada uma delas (Figura 9.6).\nFigura 9.6: Biplot da PCA ordenando cidades pela composi√ß√£o das esp√©cies de aranhas.\nChecklistVerifique se todas vari√°veis utilizadas s√£o cont√≠nuas. Caso contr√°rio, considere utilizar PCoA (veja mais pr√≥ximo t√≥pico)Verifique se todas vari√°veis utilizadas s√£o cont√≠nuas. Caso contr√°rio, considere utilizar PCoA (veja mais pr√≥ximo t√≥pico)Apesar exemplo acima ter apresentado ocorr√™ncia de esp√©cies de aranhas em diferentes cidades, √© fundamental saber que utilizar PCA com esses dados pode ser problem√°tico. Assim, tenha cuidado em usar dados de composi√ß√£o de esp√©cies, especialmente abund√¢ncia, com PCA, uma vez que ‚Äòduplos zeros‚Äô podem gerar distor√ß√µes na ordena√ß√£o (Legendre Legendre 2012). Como alternativa, √© poss√≠vel utilizar PCA com dados padronizados com o m√©todo de Hellinger (Legendre Gallagher 2001).Apesar exemplo acima ter apresentado ocorr√™ncia de esp√©cies de aranhas em diferentes cidades, √© fundamental saber que utilizar PCA com esses dados pode ser problem√°tico. Assim, tenha cuidado em usar dados de composi√ß√£o de esp√©cies, especialmente abund√¢ncia, com PCA, uma vez que ‚Äòduplos zeros‚Äô podem gerar distor√ß√µes na ordena√ß√£o (Legendre Legendre 2012). Como alternativa, √© poss√≠vel utilizar PCA com dados padronizados com o m√©todo de Hellinger (Legendre Gallagher 2001).Exemplo 1Neste exemplo vamos utilizar um conjunto de dados morfol√≥gicos de pinguins arquip√©lago Palmer (Pen√≠nsula Ant√°rtica) dispon√≠veis pacote ‚Äòpalmerpenguins.‚Äô Os dados representam medidas comprimento e largura bico (mm), comprimento da nadadeira (mm) e massa corporal (gramas) de tr√™s esp√©cies: Ad√©lie, Chinstrap e Gentoo. Como descrito acima, PCA deve ser utilizada para explora√ß√£o de dados ou para testes posteriori (e.g., Regress√£o de Componentes Principais - PCR, t√≥pico explorado mais frente nesse cap√≠tulo). Neste exemplo, iremos usar estrutura de perguntas e predi√ß√µes para manter proposta livro.PerguntaExiste diferen√ßas nas caracter√≠sticas morfol√≥gicas das esp√©cies de pinguins arquip√©lago Palmer?Predi√ß√µesPinguins com dieta diferente possuem diferentes caracter√≠sticas morfol√≥gicasVari√°veisPreditora: esp√©cie (categ√≥rica com tr√™s n√≠veis)Dependentes: vari√°veis morfol√≥gicas (cont√≠nua)An√°lisesAntes de come√ßar, √© necess√°rio remover dados ausentes (se houver) e editar nomes das vari√°veis (ponto importante para determinar como devem aparecer gr√°fico).Agora sim, os dados est√£o prontos para fazer PCA. Um argumento √© essencial na an√°lise, o scale.unit. Se voc√™ utilizar dentro deste argumento o sele√ß√£o TRUE, fun√ß√£o padroniza automaticamente vari√°veis para terem m√©dia 0 e vari√¢ncia 1. Esta padroniza√ß√£o √© essencial quando vari√°veis est√£o em escalas muito diferentes. exemplo selecionado, temos vari√°veis como comprimento bico (em mil√≠metros) e massa corporal (em gramas).Apesar da simplicidade c√≥digo para executar PCA, o objeto resultante da an√°lise possui diversas informa√ß√µes que s√£o essenciais para sua plena interpreta√ß√£o. Dentre elas, se destacam os autovalores, escores e cargas (loadings). Os autovalores representam porcentagem de explica√ß√£o de cada eixo. Os escores representam coordenadas (posi√ß√µes espa√ßo multidimensional) representando os objetos (geralmente localidades ou indiv√≠duos) e descritores (geralmente esp√©cies ou vari√°veis ambientais e espaciais). Os loadings, por sua vez, representam combina√ß√£o linear entre os escores (nova posi√ß√£o valor descritor espa√ßo ordenado) e os valores originais dos descritores (Figura 9.7).\nFigura 9.7: Scree plot mostrando porcentagem de contribui√ß√£o de cada eixo para ordena√ß√£o dos dados de penguins.\nO pacote FactoMineR criou uma fun√ß√£o (dimdesc()) que seleciona melhores vari√°veis (aquelas mais explicativas) para cada eixo atrav√©s de uma an√°lise fatorial. exemplo com pinguins, o primeiro eixo (objeto pca.p$eig) explica ~69% da varia√ß√£o morfol√≥gica. fun√ß√£o dimdesc() mostra que quatro vari√°veis morfol√≥gicas est√£o fortemente associadas com o eixo 1. Por√©m, enquanto comprimento da nadadeira, massa corporal e comprimento bico est√£o positivamente associados com o eixo 1 (correla√ß√£o positiva), largura bico tem rela√ß√£o negativa. O eixo 2, por sua vez, explica ~20% da varia√ß√£o, sendo relacionado somente com largura e comprimento bico.Agora podemos utilizar o famoso biplot para representar compara√ß√£o morfol√≥gica dos pinguins dentro e entre esp√©cies (Figura 9.8).\nFigura 9.8: Biplot da PCA ordenando os dados morfol√≥gicos de penguins.\n","code":"\n## Dados\naranhas <- data.frame(\n    sp1 = c(5, 7, 2, 0, 0, 0, 0, 0),\n    sp2 = c(0, 6, 3, 4, 0, 0, 0, 0),\n    sp3 = c(0, 0, 0, 9, 12, 3, 0, 0),\n    sp4 = c(0, 0, 0, 0, 4, 10, 8, 0),\n    sp5 = c(0, 0, 0, 0, 0, 6, 9, 12),\n    row.names = paste0(\"cidade\", 1:8))\n\n## Centraliza√ß√£o\naranha.cent <- as.data.frame(base::scale(aranhas, center = TRUE, scale=FALSE))\n## Matriz de covai√¢ncia\nmatriz_cov <- cov(aranha.cent)\n\n## Autovalores e autovetores\neigen_aranhas <- eigen(matriz_cov)\nautovalores <- eigen_aranhas$values\nautovetores <- as.data.frame(eigen_aranhas$vectors)\nautovalores # eigenvalue\n#> [1] 36.733031 27.243824  9.443805  2.962749  1.438020\ncolnames(autovetores) <- paste(\"PC\", 1:5, sep=\"\")\nrownames(autovetores) <- colnames(aranhas)\nautovetores\n#>            PC1         PC2         PC3         PC4        PC5\n#> sp1 -0.2144766  0.38855265  0.29239380 -0.02330706  0.8467522\n#> sp2 -0.2442026  0.17463316  0.01756743  0.94587037 -0.1220204\n#> sp3 -0.3558368 -0.80222917 -0.27591770  0.10991178  0.3762942\n#> sp4  0.4159852 -0.41786654  0.78820962  0.17374202  0.0297183\n#> sp5  0.7711688  0.01860152 -0.46560957  0.25003826  0.3544591\n\n## Componentes principais\nmatriz_F <- as.data.frame(as.matrix(aranha.cent) %*% as.matrix(autovetores))\nmatriz_F\n#>               PC1        PC2        PC3        PC4        PC5\n#> cidade1 -2.979363  4.4720575  1.1533417 -3.2641923  0.5433206\n#> cidade2 -4.873532  6.2969618  1.8435339  2.3644158  1.5047024\n#> cidade3 -3.068541  3.8302991  0.3288626 -0.3566600 -2.3629973\n#> cidade4 -6.086322 -3.9922356 -2.7216169  1.6250305 -0.7918743\n#> cidade5 -4.513082 -8.7689219 -0.4668012 -1.1337476  0.9439633\n#> cidade6  5.812374 -3.9444494  3.9520584  0.4197281 -0.1376205\n#> cidade7  8.361421 -0.6462243  1.8065636  0.4926235 -0.2625625\n#> cidade8  7.347046  2.7525126 -5.8959421 -0.1471979  0.5630683\n\n## Porcentagem de explica√ß√£o de cada eixo\n100 * (autovalores/sum(autovalores))\n#> [1] 47.201691 35.008126 12.135225  3.807112  1.847846\n## Gr√°fico\nggplot(matriz_F, aes(x = PC1, y = PC2, label = rownames(matriz_F))) +\n    geom_label() + \n    geom_hline(yintercept = 0, linetype=2) +\n    geom_vline(xintercept = 0, linetype=2) +\n    tema_livro()\n## Verificar se existem NAs nos dados\nsum(is.na(penguins))\n#> [1] 19\n\n## Remover dados ausentes (NA), quando houver\npenguins <- na.omit(penguins)\n\n## Manter somentes dados cont√≠nuos que pretende aplicar a PCA\npenguins_trait <- penguins[, 3:6]\n## Compare com este c√≥digo a vari√¢ncia das vari√°veis\npenguins_trait %>% \n    dplyr::summarise(across(where(is.numeric), \n                            ~var(.x, na.rm = TRUE)))\n#> # A tibble: 1 √ó 4\n#>   comprimento_bico profundidade_bico comprimento_nadadeira massa_corporal\n#>              <dbl>             <dbl>                 <dbl>          <dbl>\n#> 1             29.9              3.88                  196.        648372.\n\n## Agora, veja o mesmo c√°lculo se fizer a padroniza√ß√£o (scale.unit da fun√ß√£o PCA)\npenguins_pad <- decostand(x = penguins_trait, method = \"standardize\")\npenguins_pad %>% \n    dplyr::summarise(across(where(is.numeric), \n                            ~var(.x, na.rm = TRUE)))\n#>   comprimento_bico profundidade_bico comprimento_nadadeira massa_corporal\n#> 1                1                 1                     1              1\n\n## PCA\npca.p <- PCA(X = penguins_trait, scale.unit = TRUE, graph = FALSE)\n## Autovalores: porcentagem de explica√ß√£o para usar no gr√°fico\npca.p$eig \n#>        eigenvalue percentage of variance cumulative percentage of variance\n#> comp 1  2.7453557              68.633893                          68.63389\n#> comp 2  0.7781172              19.452929                          88.08682\n#> comp 3  0.3686425               9.216063                          97.30289\n#> comp 4  0.1078846               2.697115                         100.00000\n\n## Visualiza√ß√£o da porcentagem de explica√ß√£o de cada eixo\n# nota: √© necess√°rio ficar atento ao valor m√°ximo do eixo 1 da an√°lise para determinar o valor do ylim (neste caso, colocamos que o eixo varia de 0 a 70).\nfviz_screeplot(pca.p, addlabels = TRUE, ylim = c(0, 70), main = \"\", \n               xlab = \"Dimens√µes\",\n               ylab = \"Porcentagem de vari√¢ncia explicada\") \n## Outros valores importantes\nvar_env <- get_pca_var(pca.p)\n\n## Escores (posi√ß√£o) das vari√°veis em cada eixo\nvar_env$coord \n#>                            Dim.1      Dim.2      Dim.3       Dim.4\n#> comprimento_bico       0.7518288 0.52943763 -0.3900969 -0.04768208\n#> profundidade_bico     -0.6611860 0.70230869  0.2585287  0.05252186\n#> comprimento_nadadeira  0.9557480 0.00510580  0.1433474  0.25684871\n#> massa_corporal         0.9107624 0.06744932  0.3592789 -0.19204478\n\n## Contribui√ß√£o (%) das vari√°veis para cada eixo\nvar_env$contrib \n#>                          Dim.1        Dim.2     Dim.3     Dim.4\n#> comprimento_bico      20.58919 36.023392267 41.279994  2.107420\n#> profundidade_bico     15.92387 63.388588337 18.130600  2.556942\n#> comprimento_nadadeira 33.27271  0.003350291  5.574092 61.149849\n#> massa_corporal        30.21423  0.584669105 35.015313 34.185789\n\n## Loadings - correla√ß√£o das vari√°veis com os eixos\nvar_env$cor \n#>                            Dim.1      Dim.2      Dim.3       Dim.4\n#> comprimento_bico       0.7518288 0.52943763 -0.3900969 -0.04768208\n#> profundidade_bico     -0.6611860 0.70230869  0.2585287  0.05252186\n#> comprimento_nadadeira  0.9557480 0.00510580  0.1433474  0.25684871\n#> massa_corporal         0.9107624 0.06744932  0.3592789 -0.19204478\n\n## Qualidade da representa√ß√£o da vari√°vel. Esse valor √© obtido multiplicado var_env$coord por var_env$coord\nvar_env$cos2\n#>                           Dim.1        Dim.2      Dim.3       Dim.4\n#> comprimento_bico      0.5652466 2.803042e-01 0.15217561 0.002273581\n#> profundidade_bico     0.4371669 4.932375e-01 0.06683710 0.002758546\n#> comprimento_nadadeira 0.9134542 2.606919e-05 0.02054847 0.065971260\n#> massa_corporal        0.8294881 4.549411e-03 0.12908133 0.036881196\n\n## Escores (posi√ß√£o) das localidades (\"site scores\") em cada eixo \nind_env <- get_pca_ind(pca.p)\n## Vari√°veis mais importantes para o Eixo 1\ndimdesc(pca.p)$Dim.1 \n#> $quanti\n#>                       correlation       p.value\n#> comprimento_nadadeira   0.9557480 5.962756e-178\n#> massa_corporal          0.9107624 3.447018e-129\n#> comprimento_bico        0.7518288  7.830597e-62\n#> profundidade_bico      -0.6611860  3.217695e-43\n#> \n#> attr(,\"class\")\n#> [1] \"condes\" \"list\"\n\n## Vari√°veis mais importantes para o Eixo 2\ndimdesc(pca.p)$Dim.2 \n#> $quanti\n#>                   correlation      p.value\n#> profundidade_bico   0.7023087 8.689230e-51\n#> comprimento_bico    0.5294376 1.873918e-25\n#> \n#> attr(,\"class\")\n#> [1] \"condes\" \"list\"\nfviz_pca_biplot(X = pca.p, \n                geom.ind = \"point\", \n                fill.ind = penguins$especies, \n                col.ind = \"black\",\n                alpha.ind = 0.7,\n                pointshape = 21, \n                pointsize = 4,\n                palette = c(\"darkorange\", \"darkorchid\", \"cyan4\"),\n                col.var = \"black\",\n                invisible = \"quali\",\n                title = NULL) +\n    labs(x = \"PC1 (68.63%)\", y = \"PC2 (19.45%)\") + \n    xlim(c(-3, 4)) +\n    ylim(c(-3, 3)) +\n    tema_livro()"},{"path":"cap9.html","id":"an√°lises-de-coordenadas-principais-pcoa","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.4.2 An√°lises de Coordenadas Principais (PCoA)","text":"Diferentemente da PCA, An√°lises de Coordenadas Principais (Principal Coordinate Analysis - PCoA) √© uma an√°lise de ordena√ß√£o irrestrita que aceita dados de diferentes tipos, como cont√≠nuos, categ√≥ricos, ordinais, bin√°rios, entre outros. Assim, PCoA √© aplicada para casos em que dist√¢ncia euclidiana n√£o √© aplicada (como na PCA). Desse modo, o primeiro passo da an√°lise √© calcular uma matriz de similaridade ou de dist√¢ncia (discutido acima). Depois, os passos para obter autovalores e autovetores s√£o bastante parecidos com PCA. Da mesma forma, os eixos da PCoA e os valores ou posi√ß√µes dos objetos nesses eixos representam rela√ß√£o de semelhan√ßa (ou diferen√ßa) baseada nos descritores desses objetos. diferen√ßa, neste caso, √© que PCoA representa um espa√ßo n√£o-euclidiano, que ir√° ser afetado pela escolha m√©todo de similaridade.utiliza√ß√µes mais comuns da PCoA s√£o ordena√ß√£o: ) da matriz de composi√ß√£o de esp√©cies usando dist√¢ncia apropriada (Jaccard, Sorensen, Bray-Curtis), ii) da matriz de vari√°veis ambientais com mistos (cont√≠nuos, categ√≥ricos, circulares, etc.), e iii) da matriz filogen√©tica (m√©todo PVR Diniz-Filho, de Sant‚ÄôAna, Bini 1998). Abaixo, exemplificamos ordena√ß√£o da matriz de composi√ß√£o de esp√©cies.ChecklistCompare dimens√µes das matrizes utilizadas para PCoA. Com bastante frequ√™ncia, tentativa de combinar dados categ√≥ricos (algum descritor dos objetos) com os valores obtidos com PCoA gera erros para plotar figura ou para executar an√°lise. Verifique, ent√£o, se linhas s√£o mesmas (nome das localidades ou indiv√≠duos e quantidade)Compare dimens√µes das matrizes utilizadas para PCoA. Com bastante frequ√™ncia, tentativa de combinar dados categ√≥ricos (algum descritor dos objetos) com os valores obtidos com PCoA gera erros para plotar figura ou para executar an√°lise. Verifique, ent√£o, se linhas s√£o mesmas (nome das localidades ou indiv√≠duos e quantidade)√â fundamental conhecer o tipo de dados que est√° usando para selecionar medida de dist√¢ncia apropriada. Essa escolha vai afetar qualidade da ordena√ß√£o e sua habilidade para interpretar rela√ß√£o de semelhan√ßa entre os objetos comparados√â fundamental conhecer o tipo de dados que est√° usando para selecionar medida de dist√¢ncia apropriada. Essa escolha vai afetar qualidade da ordena√ß√£o e sua habilidade para interpretar rela√ß√£o de semelhan√ßa entre os objetos comparadosDiferente da PCA, PCoA aceita dados ausentes se medida de dist√¢ncia escolhida tamb√©m n√£o tiver esta limita√ß√£o. Por exemplo, dist√¢ncia de Gower produz matrizes de similaridade mesmo com dados ausentes em determinados objetosDiferente da PCA, PCoA aceita dados ausentes se medida de dist√¢ncia escolhida tamb√©m n√£o tiver esta limita√ß√£o. Por exemplo, dist√¢ncia de Gower produz matrizes de similaridade mesmo com dados ausentes em determinados objetosEm alguns casos, autovalores negativos s√£o produzidos na ordena√ß√£o com PCoA. Veja principais causas desses valores em Legendre & Legendre (2012). Apesar deste problema, os autovalores mais importantes (eixos iniciais) n√£o s√£o afetados e, deste modo, qualidade da representa√ß√£o dos objetos espa√ßo multidimensional n√£o √© afetada. Alguns autores sugerem utilizar corre√ß√µes m√©todos de corre√ß√£o, como Lingoes ou Cailliez (Legendre Legendre 2012).Em alguns casos, autovalores negativos s√£o produzidos na ordena√ß√£o com PCoA. Veja principais causas desses valores em Legendre & Legendre (2012). Apesar deste problema, os autovalores mais importantes (eixos iniciais) n√£o s√£o afetados e, deste modo, qualidade da representa√ß√£o dos objetos espa√ßo multidimensional n√£o √© afetada. Alguns autores sugerem utilizar corre√ß√µes m√©todos de corre√ß√£o, como Lingoes ou Cailliez (Legendre Legendre 2012).Exemplo 1Neste exemplo, vamos utilizar composi√ß√£o de √°caros Oribatidae em 70 manchas de musgo coletados por Borcard et al. (1992).PerguntaA composi√ß√£o de esp√©cies de √°caros muda entre diferentes topografias?Predi√ß√µesIremos encontrar ao menos dois grupos de esp√©cies: aquelas que ocorrem em po√ßas dentro de floresta versus aquelas que ocorrem em po√ßas de √°reas abertasVari√°veisPreditora: topografia (categ√≥rica com dois n√≠veis)Dependentes: composi√ß√£o de esp√©cies de √°caroAn√°lisesVamos primeramente padronizar dos dados, calcular uma matriz de dist√¢ncia com m√©todo Bray-Curtis e depois calcular PCoA.Assim como na PCA, porcentagem de explica√ß√£o dos eixos √© uma das informa√ß√µes mais importantes pois descrevem efetividade da redu√ß√£o da dimensionalidade dos dados.Para visualizar os resultados da PCoA, vamos exportar os escores dos eixos para usar pacote ggplot2 (Figura 9.9).\nFigura 9.9: Biplot da PCoA ordenando esp√©cies de √°caros entre diferentes topografias.\nLimita√ß√µes importantes das ordena√ß√µes irrestritasCom frequ√™ncia, pesquisadores utilizam an√°lises como PCA e PCoA para ‚Äútestar‚Äù diferen√ßas na composi√ß√£o de esp√©cies entre determinados fatores relevantes (altitude, clima, etc.). Por√©m, como falado acima, an√°lises de ordena√ß√£o irrestritas n√£o s√£o utilizadas para testar qualquer hip√≥tese. Ao inv√©s disso, essas an√°lises representam uma poderosa ferramente para explorar padr√µes em vari√°veis dependentes ou independentes para ajudar na interpreta√ß√£o ou mesmo para testar hip√≥teses em an√°lises combinadas com ordena√ß√µes restritas.","code":"\n## Padroniza√ß√£o dos dados com Hellinger\nmite.hel <- decostand(x = mite, method = \"hellinger\") \n\n## C√°lculo da matriz de dist√¢ncia com m√©todo Bray-Curtis\nsps.dis <- vegdist(x = mite.hel, method = \"bray\") \n\n## PCoA\npcoa.sps <- pcoa(D = sps.dis, correction = \"cailliez\")\n## Porcentagem de explica√ß√£o do Eixo 1\n100 * (pcoa.sps$values[, 1]/pcoa.sps$trace)[1]\n#> [1] 49.10564\n\n## Porcentagem de explica√ß√£o dos Eixo 2\n100 * (pcoa.sps$values[, 1]/pcoa.sps$trace)[2]\n#> [1] 14.30308\n\n## Porcentagem de explica√ß√£o acumulada dos dois primeiros eixos \nsum(100 * (pcoa.sps$values[, 1]/pcoa.sps$trace)[1:2])\n#> [1] 63.40872\n\n## Selecionar os dois primeiros eixos\neixos <- pcoa.sps$vectors[, 1:2]\n\n## Juntar com algum dado categ√≥rico de interesse para fazer a figura\npcoa.dat <- data.frame(topografia = mite.env$Topo, eixos)\n## Escores dos dois primeiros eixos\neixos <- pcoa.sps$vectors[, 1:2] \n\n## Combinar dados dos escores com um dado categ√≥rico de interesse para nossa pergunta\npcoa.dat <- data.frame(topografia = mite.env$Topo, eixos)\n\n### Gr√°fico biplot da PCoA\nggplot(pcoa.dat, aes(x = Axis.1, y = Axis.2, fill = topografia, \n                     color = topografia, shape = topografia)) +\n    geom_point(size = 4, alpha = 0.7) + \n    scale_shape_manual(values = c(21, 22)) + \n    scale_color_manual(values = c(\"black\", \"black\")) + \n    scale_fill_manual(values = c(\"darkorange\", \"cyan4\")) + \n    labs(x = \"PCO 1 (49.11%)\", y = \"PCO 2 (14.30%)\") + \n    geom_hline(yintercept = 0, linetype = 2) + \n    geom_vline(xintercept = 0, linetype = 2) +\n    tema_livro()"},{"path":"cap9.html","id":"regress√£o-de-componentes-principais-pcr","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.4.3 Regress√£o de Componentes Principais (PCR)","text":"Uma maneira de testar hip√≥teses utilizando ordena√ß√µes irrestritas √© utilizando os resultados da ordena√ß√£o (escores) como vari√°veis preditoras ou dependentes como, por exemplo, em modelos lineares (e.g., regress√£o m√∫ltipla Cap√≠tulo 7). O primeiro passo √© utilizar uma ordena√ß√£o, como PCA, para gerar os ‚Äúnovos‚Äù dados que ser√£o usados na an√°lise. utiliza√ß√£o desses novos dados (que representam coordenadas principais ou escores da PCA) vai depender da pergunta em quest√£o. Por exemplo, pode ser que esses valores representem gradientes clim√°ticos e, por este motivo, ser√£o utilizados como vari√°veis preditoras em um modelo linear (e.g., regress√£o m√∫ltipla). Por outro lado, esses valores podem representar o espa√ßo morfol√≥gicos de esp√©cies de peixes e, como consequ√™ncia, ser√£o utilizados como vari√°veis dependentes para entender o efeito da presen√ßa de predador sobre morfologia. √â importante ressaltar que existem algumas limita√ß√µes importantes na PCR como, por exemplo, coordenadas principais (escores da PCA) utilizadas como vari√°veis preditoras podem n√£o representam, biologicamente, mais importantes para explicar varia√ß√£o na vari√°vel resposta (Hadi Ling 1998).ChecklistCompare dimens√µes das matrizes utilizadas para PCR. Com bastante frequ√™ncia, tentativa de combinar dados categ√≥ricos (algum descritor dos objetos) com os valores obtidos com PCoA gera erros para plotar figura ou para executar an√°lise. Verifique, ent√£o, se linhas s√£o mesmas (nome das localidades ou indiv√≠duos e quantidade)Compare dimens√µes das matrizes utilizadas para PCR. Com bastante frequ√™ncia, tentativa de combinar dados categ√≥ricos (algum descritor dos objetos) com os valores obtidos com PCoA gera erros para plotar figura ou para executar an√°lise. Verifique, ent√£o, se linhas s√£o mesmas (nome das localidades ou indiv√≠duos e quantidade)Estudos recentes t√™m criticado utiliza√ß√£o de PCR para testar hip√≥teses ecol√≥gicas pelo fato dos escores n√£o representarem, necessariamente, varia√ß√£o total das vari√°veis originais, bem como rela√ß√£o entre vari√°vel preditora e dependenteEstudos recentes t√™m criticado utiliza√ß√£o de PCR para testar hip√≥teses ecol√≥gicas pelo fato dos escores n√£o representarem, necessariamente, varia√ß√£o total das vari√°veis originais, bem como rela√ß√£o entre vari√°vel preditora e dependenteExemplo 1Neste exemplo, vamos utilizar composi√ß√£o de esp√©cies de aves em 23 regi√µes dos alpes franceses. Os dados ambientais (env) representam vari√°veis clim√°ticas (temperatura e chuva) e altitude.PerguntaGradientes clim√°ticos afetam riqueza de aves?Predi√ß√µesO aumento da umidade e redu√ß√£o da temperatura aumentam o n√∫mero de esp√©cies de avesVari√°veisPreditora: temperatura e chuva (cont√≠nuas) e altitude (categ√≥rica com tr√™s n√≠veis)Dependentes: riqueza de esp√©cies de avesO objeto env.pca$eig demonstra que os tr√™s primeiros eixos explicam 94.54% da varia√ß√£o total dos dados clim√°ticos. O intuito da PCR √© reduzir dimensionalidade, ou seja, o n√∫mero de vari√°veis preditoras ou depedentes para facilitar interpreta√ß√£o e garantir que vari√°veis n√£o sejam correlacionadas. O pr√≥ximo passo ent√£o √© obter os valores dos escores que representam os valores convertidos para serem usados em uma determinada an√°lise, como regress√£o m√∫ltipla.Agora que os dados foram combinados em uma √∫nico data frame, podemos utilizar os c√≥digos apresentados Cap√≠tulo 7 para testar nossa hip√≥tese (Figura 9.10).\nFigura 9.10: Diagn√≥sticos dos modelo PCR para aves.\nComo percebemos, Dim.1 foi o √∫nico gradiente ambiental que afetou riqueza de esp√©cies. Para interpretar esta dimens√£o (e outras importantes), podemos usar fun√ß√£o dimdesc() para verificar vari√°veis mais importantes. Neste caso, os valores mais extremos de correla√ß√£o (maior que 0.8) indicam que temperatura m√™s de janeiro e julho bem como chuva m√™s de julho foram vari√°veis mais importantes para determinar o gradiente ambiental expresso na dimens√£o 1. Assim, podemos fazer um gr√°fico para representar rela√ß√£o entre Eixo 1 (gradiente chuva-temperatura) e riqueza de esp√©cies de aves. Valores negativos eixo 1 (Gradiente ambiental - PC1) representam localidades com mais chuva, ao passo que valores positivos indicam localidades com temperaturas maiores (Figura 9.11).\nFigura 9.11: Modelo linear representando rela√ß√£o entre Eixo 1 (gradiente chuva-temperatura) e riqueza de esp√©cies de aves.\nExemplo 2√â poss√≠vel que os dados utilizados em seu estudo sejam mistos, ou seja, incluem tanto vari√°veis categ√≥ricas quanto cont√≠nuas. Como falado acima, nesses casos an√°lise indicada √© PCoA. Assim como na PCA, podemos extrair os escores da PCoA para utilizar em an√°lises univariadas e multivariadas.PerguntaVari√°veis clim√°ticas, vegetacionais e topogr√°ficas afetam riqueza de √°caros?Predi√ß√µesA densidade da vegeta√ß√£o e disponibilidade de √°gua aumentam riqueza de esp√©cies de √°carosVari√°veisPreditoras: densidade de substrado e disponibilidade de √°gua (cont√≠nuas), tipo de substrado (categ√≥rica com 7 n√≠veis), densidade arbusto (ordinal com 3 n√≠veis), e topografia (categ√≥rica com 2 n√≠veis)Dependentes: riqueza de esp√©cies de √°carosO primeiro passo ent√£o √© utilizar um m√©todo de dist√¢ncia apropriado para o seu conjunto de dados. Em nosso exemplo, utilizaremos dist√¢ncia de Gower, que √© usada para dados mistos (veja Cap√≠tulo 14).O pr√≥ximo passo √© exportar os escores para an√°lises posteriori (Figura 9.12).\nFigura 9.12: Diagn√≥sticos dos modelo PCR para √°caros.\nFinalmente, ap√≥s interpretar os resultados modelo, podemos fazer figura com vari√°veis (eixos) importantes (Figura 9.13).\nFigura 9.13: Modelo linear representando rela√ß√£o entre Eixo 1 e Eixo 2 e riqueza de esp√©cies de √°caros.\n","code":"\n## Dados\nenv_cont <- env[,-8]\nenv.pca <- PCA(env_cont, scale.unit = TRUE, graph = FALSE)\nvar_env <- get_pca_var(env.pca) \n\n## Contribui√ß√£o (%) das vari√°veis para cada eixo\nvar_env$contrib \n#>             Dim.1      Dim.2      Dim.3      Dim.4       Dim.5\n#> mini.jan 10.93489 22.2975487 16.1607726  7.6025527  0.01782438\n#> maxi.jan 20.18065  3.2890767  2.1814486  4.2756350 41.05646526\n#> mini.jul 11.87396 21.1379132  0.3428843  0.7750666 44.70209396\n#> maxi.jul 18.47244  0.9159957 56.5369988  9.4368661  2.59283074\n#> rain.jan  9.95206 21.5387403  6.5737927 53.7375738  4.44283706\n#> rain.jul 16.14997 11.2368132  7.2608047 19.6972097  0.71454880\n#> rain.tot 12.43603 19.5839121 10.9432983  4.4750959  6.47339980\n\n## Loadings - correla√ß√£o das vari√°veis com os eixos\nvar_env$cor \n#>               Dim.1     Dim.2       Dim.3       Dim.4        Dim.5\n#> mini.jan  0.6830371 0.6766524 -0.21924927  0.12298817 -0.004517369\n#> maxi.jan  0.9279073 0.2598807 -0.08055260  0.09223249  0.216804944\n#> mini.jul  0.7117620 0.6588220  0.03193603 -0.03926930 -0.226225907\n#> maxi.jul  0.8877675 0.1371462  0.41008461 -0.13702428  0.054483561\n#> rain.jan -0.6516187 0.6650391 -0.13983474 -0.32698110  0.071319550\n#> rain.jul -0.8300858 0.4803509  0.14696011  0.19796389 -0.028601865\n#> rain.tot -0.7284135 0.6341424  0.18041856  0.09435932  0.086088397\nind_env <- get_pca_ind(env.pca)\nenv.pca$eig \n#>        eigenvalue percentage of variance cumulative percentage of variance\n#> comp 1 4.26652359             60.9503370                          60.95034\n#> comp 2 2.05340251             29.3343216                          90.28466\n#> comp 3 0.29745014              4.2492878                          94.53395\n#> comp 4 0.19896067              2.8422953                          97.37624\n#> comp 5 0.11448717              1.6355310                          99.01177\n#> comp 6 0.04312874              0.6161248                          99.62790\n#> comp 7 0.02604718              0.3721025                         100.00000\n## Passo 1: obter os primeiros eixos \npred.env <- ind_env$coord[, 1:3] \n\n## Passo 2: calcular a riqueza de esp√©cies\nriqueza <- specnumber(species)\n\n## Passo 3: combinar os dois valores em um √∫nico data.frame\ndat <- data.frame(pred.env, riqueza) \n## Regress√£o m√∫ltipla\nmod1 <- lm(riqueza ~ Dim.1 + Dim.2 + Dim.3, data = dat)\npar(mfrow = c(2, 2))\nplot(mod1) # verificar pressupostos dos modelos lineares\nsummary(mod1) # resultados do  teste\n#> \n#> Call:\n#> lm(formula = riqueza ~ Dim.1 + Dim.2 + Dim.3, data = dat)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -3.4008 -1.1729  0.4356  1.2072  2.4571 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept) 13.30435    0.37639  35.347  < 2e-16 ***\n#> Dim.1        0.68591    0.18222   3.764  0.00131 ** \n#> Dim.2       -0.09961    0.26267  -0.379  0.70874    \n#> Dim.3       -0.21708    0.69014  -0.315  0.75654    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 1.805 on 19 degrees of freedom\n#> Multiple R-squared:  0.4313, Adjusted R-squared:  0.3415 \n#> F-statistic: 4.804 on 3 and 19 DF,  p-value: 0.01179\ndimdesc(env.pca)$Dim.1 \n#> $quanti\n#>          correlation      p.value\n#> maxi.jan   0.9279073 1.846790e-10\n#> maxi.jul   0.8877675 1.607390e-08\n#> mini.jul   0.7117620 1.396338e-04\n#> mini.jan   0.6830371 3.282701e-04\n#> rain.jan  -0.6516187 7.559358e-04\n#> rain.tot  -0.7284135 8.112903e-05\n#> rain.jul  -0.8300858 9.588034e-07\n#> \n#> attr(,\"class\")\n#> [1] \"condes\" \"list\"\nggplot(dat, aes(x = Dim.1, y = riqueza)) + \n    geom_smooth(method = lm, fill = \"#525252\", color = \"black\") + \n    geom_point(size = 4, shape = 21, alpha = 0.7, color = \"#1a1a1a\", fill = \"cyan4\") +\n    labs(x = \"Gradiente ambiental (PC1)\", y = \"Riqueza de aves\") + \n    tema_livro()\n## Matriz de dist√¢ncia\nenv.dist <- gowdis(mite.env)\n\n## PCoA\nenv.mite.pco <- pcoa(env.dist, correction = \"cailliez\")\n\n## Porcentagem de explica√ß√£o do Eixo 1\n100 * (env.mite.pco$values[, 1]/env.mite.pco$trace)[1]\n#> [1] 61.49635\n\n## Porcentagem de explica√ß√£o dos Eixo 2\n100 * (env.mite.pco$values[, 1]/env.mite.pco$trace)[2]\n#> [1] 32.15486\n## Selecionar os dois primeiros eixos\npred.scores.mite <- env.mite.pco$vectors[, 1:2] \n\n## Juntar com os dados da √°rea para fazer a figura \nmite.riqueza <- specnumber(mite)\npred.vars <- data.frame(riqueza = mite.riqueza, pred.scores.mite)\n\n### Regress√£o m√∫ltipla \nmod.mite <- lm(riqueza ~ Axis.1 + Axis.2, data = pred.vars)\npar(mfrow = c(2, 2))\nplot(mod.mite)\nsummary(mod.mite)\n#> \n#> Call:\n#> lm(formula = riqueza ~ Axis.1 + Axis.2, data = pred.vars)\n#> \n#> Residuals:\n#>      Min       1Q   Median       3Q      Max \n#> -10.6874  -2.3960  -0.1378   2.5032   8.6873 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  15.1143     0.4523  33.415  < 2e-16 ***\n#> Axis.1      -11.4303     2.0013  -5.711  2.8e-07 ***\n#> Axis.2        5.6832     2.7677   2.053   0.0439 *  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 3.784 on 67 degrees of freedom\n#> Multiple R-squared:  0.3548, Adjusted R-squared:  0.3355 \n#> F-statistic: 18.42 on 2 and 67 DF,  p-value: 4.225e-07\ng_acari_axi1 <- ggplot(pred.vars, aes(x = Axis.1, y = riqueza)) + \n    geom_smooth(method = lm, fill = \"#525252\", color = \"black\") + \n    geom_point(size = 4, shape = 21, alpha = 0.7, color = \"#1a1a1a\", fill=\"cyan4\") + \n    labs(x = \"Gradiente ambiental (PC1)\", y = \"Riqueza de √°caros\") + \n    tema_livro()\n\ng_acari_axi2 <- ggplot(pred.vars, aes(x = Axis.2, y = riqueza)) + \n    geom_smooth(method = lm, fill = \"#525252\", color = \"black\") + \n    geom_point(size = 4, shape = 21, alpha = 0.7, color = \"#1a1a1a\", fill = \"darkorange\") + \n    labs(x = \"Gradiente ambiental (PC2)\", y = \"Riqueza de √°caros\") + \n    tema_livro()\n\n## Fun√ß√£o para combinar os dois plots em uma √∫nica janela\ngrid.arrange(g_acari_axi1, g_acari_axi2, nrow = 1)"},{"path":"cap9.html","id":"ordena√ß√£o-restrita","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.5 Ordena√ß√£o restrita","text":"ordena√ß√£o restrita ou an√°lise de gradiente direto, organiza os objetos de acordo com suas rela√ß√µes com outras vari√°veis (preditoras) coletadas nas mesmas unidades amostrais. O exemplo mais comum na ecologia √© de investigar rela√ß√£o entre diversas vari√°veis ambientais (matriz X) coletadas em n localidades e abund√¢ncia (ou presen√ßa aus√™ncia) de y esp√©cies coletadas nas mesmas localidades (matrix Y). Com frequ√™ncia, outras dados s√£o utilizados como coordenadas geogr√°ficas das unidades amostrais (matriz W), os atributos funcionais das esp√©cies coletadas (matriz T) e rela√ß√£o filogen√©tica dessas esp√©cies (matriz P). Diversos m√©todos s√£o utilizados para combinar duas ou mais matrizes, mas neste cap√≠tulo iremos apresentar An√°lise de Redund√¢ncia (RDA), An√°lise de Redund√¢ncia parcial (RDAp) e m√©todos espaciais para incluir matriz W nas an√°lises de gradiente direto.","code":""},{"path":"cap9.html","id":"an√°lise-de-redund√¢ncia-rda","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.5.1 An√°lise de Redund√¢ncia (RDA)","text":"RDA √© uma an√°lise semelhante √† regress√£o m√∫ltipla (Cap√≠tulo 7), mas que usa dados multivariados como vari√°vel dependente. duas matrizes comuns, matriz X (n unidades amostraits e m vari√°veis) e matriz Y (n unidades amostrais e p descritores - geralmente, esp√©cies). O primeiro passo da RDA √© centralizar (assim como na PCA, exemplo acima) matrizes X e Y. Ap√≥s centraliza√ß√£o, realiza-se regress√µes lineares entre X e Y para obter os valores preditos de Y (ou seja, os valores de Y que representa√ß√£o uma combina√ß√£o linear com X). O passo seguinte √© realizar uma PCA dos valores preditos de Y. Este √∫ltimo procedimento gera os autovalores, autovetores e os eixos can√¥nicos que correspondem √†s coordenadas dos objetos (unidades amostrais), vari√°veis preditoras e das vari√°veis resposta. diferen√ßa da ordena√ß√£o valor de Y predito e da ordena√ß√£o somente de Y (como na PCA implementada acima) √© que segunda mostra posi√ß√£o prevista pela rela√ß√£o linear entre X e Y. Logo, essa √© exatamente o motivo da ordena√ß√£o ser conhecida como restrita, pois varia√ß√£o em Y √© restrita (linearmente) pela varia√ß√£o de X. Assim como na regress√£o m√∫ltipla, estat√≠stica da RDA √© representada pelo valor de R2 e F. O valor de R2 indica for√ßa da rela√ß√£o linear entre X e Y e o valor F representa o teste global de signific√¢ncia. Al√©m disso, √© poss√≠vel testar signific√¢ncia de cada um dos eixos da ordena√ß√£o (e presen√ßa de pelo menos um eixo significativo √© pr√©-requisito para que exista rela√ß√£o linear entre X e Y) e de cada uma das vari√°veis preditoras da matriz X.ChecklistVari√°veis preditoras: importante verificar se: ) estrutura de correla√ß√£o das vari√°veis ambientais, e ii) presen√ßa de autocorrela√ß√£o espacialVari√°veis preditoras: importante verificar se: ) estrutura de correla√ß√£o das vari√°veis ambientais, e ii) presen√ßa de autocorrela√ß√£o espacialComposi√ß√£o de esp√©cies como matriz Y: fundamental observar se os valores utilizados representam abund√¢ncia ou presen√ßa-aus√™ncia e qual necessidade de padroniza√ß√£o (e.g., Hellinger)Composi√ß√£o de esp√©cies como matriz Y: fundamental observar se os valores utilizados representam abund√¢ncia ou presen√ßa-aus√™ncia e qual necessidade de padroniza√ß√£o (e.g., Hellinger)Assim como em modelos de regress√£o linear simples e m√∫ltipla, os valores de R2 ajustado devem ser selecionados ao inv√©s valor de R2Assim como em modelos de regress√£o linear simples e m√∫ltipla, os valores de R2 ajustado devem ser selecionados ao inv√©s valor de R2Exemplo 1Esp√©cies de aves que ocorrem em localidades com diferentes altitudes.PerguntaO clima e altitude modificam composi√ß√£o de esp√©cies de aves?Predi√ß√µesDiferen√ßas clim√°ticas (temperatura e chuva) e altitudinais alteram composi√ß√£o de esp√©cies de avesVari√°veisPreditoras: Temperatura e precipita√ß√£o (cont√≠nuas) e altitude (categ√≥rica com tr√™s n√≠veis)Dependente: composi√ß√£o de esp√©cies de avesAn√°lisesDepois de selecionar um subconjunto dos dados com o m√©todo Forward Selection e padroniz√°-los (m√©dia 0 e desvio padr√£o 1), o modelo da RDA √© constru√≠do como modelos lineares (Figura 9.14). Ordena√ß√£o Multi-Escala (MSO) tamb√©m √© ajustada para analisar autocorrela√ß√£o espacial.\nFigura 9.14: Ordena√ß√£o multi-escala (MSO) para entender os resultados da ordena√ß√£o em rela√ß√£o √† dist√¢ncia geogr√°fica.\nDa mesma forma que nas ordena√ß√µes irrestritas, podemos fazer um gr√°fico para visualizar ordena√ß√µes, mas agora esse gr√°fico √© denominado ‚Äútriplot,‚Äù pois possui os dados das duas ordena√ß√µes (Figura 9.15).\nFigura 9.15: Triplot da RDA.\nInterpreta√ß√£o dos resultadosOs objetos res.axis, res.var e r_quadr mostram, respectivamente, ) dimens√µes (RDA1, RDA2, etc.) que possuem varia√ß√£o na composi√ß√£o de esp√©cies, ii) vari√°veis preditoras que explicam esta varia√ß√£o, e iii) o valor R2 ajustado. Neste exemplo, podemos observar que somente dimens√£o 1 (RDA1) representa uma varia√ß√£o significativa da composi√ß√£o de esp√©cies (P = 0,001). vari√°veis rain.jul, maxi.jul e altitude foram todas preditoras importantes da composi√ß√£o de esp√©cies, mas rain.jul se destacada com maior valor de F. Al√©m disso, o valor R2 ajustado de 0.381 indica forte contribui√ß√£o dessas vari√°veis preditoras. Por√©m, uma das limita√ß√µes desta an√°lise √© n√£o considerar que tanto esp√©cies quanto vari√°veis preditoras podem estar estruturadas espacialmente. Como resultado, os res√≠duos da an√°lises podem apresentar autocorrela√ß√£o espacial que, por sua vez, aumenta o Erro Tipo (Legendre Legendre 2012). figura obtida com o c√≥digo msoplot(bird.rda) demonstra que existe autocorrela√ß√£o espacial em algumas dist√¢ncias da an√°lise. Veja abaixo algumas alternativas para res√≠duos com autocorrela√ß√£o espacial.","code":"\n## Passo 1: transforma√ß√£o de hellinger da matriz de esp√©cies\n# caso tenha dados de abund√¢ncia.\nspecies.hel <- decostand(x = species, method = \"hellinger\")\n\n## Passo 2: selecionar vari√°veis importantes\n# Para isso, √© necess√°rio remover a vari√°vel categ√≥rica.\nenv.contin <- env[, -8]\n\n## Evite usar vari√°veis muito correlacionadas\nsel.vars <- forward.sel(species.hel, env.contin)\n#> Testing variable 1\n#> Testing variable 2\n#> Testing variable 3\n#> Procedure stopped (alpha criteria): pvalue for variable 3 is 0.212000 (> 0.050000)\nsel.vars$variables\n#> [1] \"rain.jul\" \"maxi.jul\"\nenv.sel <- env[,sel.vars$variables]\n\n## Passo 3: padronizar matriz ambiental (somente vari√°veis cont√≠nuas)\nenv.pad <- decostand(x = env.sel, method = \"standardize\")\n\n## Matriz final com vari√°veis preditoras\nenv.pad.cat <- data.frame(env.pad, altitude = env$altitude)\n## RDA com dados selecionados e padronizados\nrda.bird <- rda(species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)\n\n## Para interpretar, √© necess√°rio saber a signific√¢ncia dos eixos para representar a rela√ß√£o entre as vari√°veis preditoras e a composi√ß√£o de esp√©cies\nres.axis <- anova.cca(rda.bird, by = \"axis\") \nres.axis\n#> Permutation test for rda under reduced model\n#> Forward tests for axes\n#> Permutation: free\n#> Number of permutations: 999\n#> \n#> Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)\n#>          Df Variance       F Pr(>F)    \n#> RDA1      1 0.045759 12.0225  0.001 ***\n#> RDA2      1 0.009992  2.6252  0.061 .  \n#> RDA3      1 0.007518  1.9752  0.136    \n#> RDA4      1 0.003582  0.9410  0.470    \n#> Residual 18 0.068510                   \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n## Em seguida, √© poss√≠vel identificar quais s√£o as vari√°veis que contribuem ou que mais contribuem para a varia√ß√£o na composi√ß√£o de esp√©cies \nres.var <- anova.cca(rda.bird, by = \"term\") ## Qual vari√°vel?\nres.var\n#> Permutation test for rda under reduced model\n#> Terms added sequentially (first to last)\n#> Permutation: free\n#> Number of permutations: 999\n#> \n#> Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)\n#>          Df Variance      F Pr(>F)    \n#> rain.jul  1 0.036514 9.5936  0.001 ***\n#> maxi.jul  1 0.011264 2.9596  0.016 *  \n#> altitude  2 0.019071 2.5053  0.011 *  \n#> Residual 18 0.068510                  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n## Al√©m disso, √© poss√≠vel obter o valor do R2 do modelo\nr_quadr <- RsquareAdj(rda.bird)\nr_quadr\n#> $r.squared\n#> [1] 0.4938685\n#> \n#> $adj.r.squared\n#> [1] 0.3813949\n\n## Ordena√ß√£o multi-escala (MSO) para entender os resultados da ordena√ß√£o em rela√ß√£o √† dist√¢ncia geogr√°fica\nbird.rda <- mso(rda.bird, xy, grain = 1, permutations = 99)\nmsoplot(bird.rda)\n#> Error variance of regression model underestimated by -2.7 percent\n## Triplot da RDA\nggord(rda.bird, ptslab = TRUE, size = 1, addsize = 3, repel = TRUE) +\n    geom_hline(yintercept = 0, linetype = 2) +\n    geom_vline(xintercept = 0, linetype = 2) + \n    tema_livro()"},{"path":"cap9.html","id":"an√°lise-de-redund√¢ncia-parcial-rdap","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.5.2 An√°lise de Redund√¢ncia parcial (RDAp)","text":"Um dos problemas da abordagem anterior √© que tanto composi√ß√£o de esp√©cies como vari√°veis ambientais est√£o estruturadas espacialmente. Talvez mais importantes, para que os valores de probabilidade da RDA sejam interpretados corretamente (e para evitar Erro Tipo ), os res√≠duos modelo n√£o devem estar correlacionados espacialmente, como demonstrado com an√°lise MSO. Uma alternativa √© incluir matriz de dados espaciais (matrix W) como valor condicional dentro da RDA. Esta an√°lise √© conhecida como RDA parcial.Por√©m, obten√ß√£o dos dados espaciais da matriz W √© mais complexo que simplesmente incluir dados de localiza√ß√£o geogr√°fica (latitude e longitude), como feito em alguns modelos lineares (e.g., Generalized Least Squares - GLS Cap√≠tulos 7 e 10). Existem diversas ferramentas que descrevem e incorporam o componente espacial em m√©todos mulitidimensionais, mas os Mapas de Autovetores de Moran (MEM) s√£o certamente os mais utilizados (Dray et al. 2012). an√°lise MEM consiste na ordena√ß√£o (PCoA) de uma matriz truncada obtida atrav√©s da localiza√ß√£o geogr√°fica das localidades utilizando dist√¢ncia euclidiana, matriz de conectividade e matriz espacial ponderada. Os autovalores obtidos MEM s√£o id√™nticos aos coeficientes de correla√ß√£o espacial de Moran . Um procedimento chave desta an√°lise √© defini√ß√£o de um limiar de trucamento (ingl√™s truncate threshold). Este limiar √© calculado partir de uma ‚Äú√°rvore de espa√ßo m√≠nimo‚Äù (Minimum Spanning Tree - MST) que conecta todos os pontos de coleta. Na pr√°tica, os valores menores que o limiar definido pela MST indicam que os pontos com aqueles valores est√£o conectados e, assim possuem correla√ß√£o positiva. Outro ponto importante desta an√°lise √© obten√ß√£o da matriz espacial ponderada (Spatial Weighting Matrix - SWM). sele√ß√£o da matriz SWM √© parte essencial c√°lculo dos MEM e n√£o deve ser feita arbitratiamente (Bauman, Drouet, Fortin, et al. 2018). Por este motivo, an√°lise recebe este nome (Legendre Legendre 2012). Finalmente, o m√©todo produz autovetores que representam preditores espaciais que podem ser utilizados na RDA parcial (e em outras an√°lises). √â importante ressaltar que o crit√©rio de sele√ß√£o n√∫mero de autovetores √© bastante debatido na literatura e, para isso, sugerimos leitura dos seguintes artigos: Bauman, Drouet, Dray, et al. (2018).Ent√£o, o primeiro passo para realizar uma RDA parcial √© de gerar os autovetores espaciais (MEMs).Depois de gerar os valores dos autovetores espaciais (MEM), √© poss√≠vel executar RDA parcial utilizando esses valores argumento Conditional.Se voc√™ comparar os resultados objeto res.p.var (RDA parcial) com res.var (RDA simples) √© poss√≠vel perceber como estrutura espacial nos res√≠duos aumenta probabilidade de cometer Erro Tipo . O modelo da RDA parcial mostra que n√£o existem qualquer efeito direto das vari√°veis ambientais sobre composi√ß√£o de esp√©cies (conclus√£o com RDA simples). Na verdade, tanto composi√ß√£o de esp√©cies quanto vari√°veis clim√°ticas est√£o fortemente estruturadas espa√ßo, como demonstramos seguir.Como resultado, √© poss√≠vel que varia√ß√£o ambiental espacialmente estruturada √© o principal efeito sobre composi√ß√£o de esp√©cies. Uma maneira de visualizar contribui√ß√£o relativa de diferentes matrizes (ambiental e espacial, por exemplo) √© utilizar o m√©todo de parti√ß√£o de vari√¢ncia. O resultado deste modelo indica que, de fato, n√£o existe efeito direto das vari√°veis ambientais e sim componente representado pela autocorrela√ß√£o espacial dessas vari√°veis (Figura 9.16).\nFigura 9.16: Diagrama de Venn mostrando parti√ß√£o de vari√¢ncia da RDA.\n","code":"\n## Dados\n# Matriz padronizada de composi√ß√£o de esp√©cies. \nhead(species.hel)[, 1:6] \n#>     Fauvette_orphee Fauvette_des_jardins Fauvette_a_tete_noire Fauvette_babillarde Fauvette_grisette Fauvette_pitchou\n#> S01               0            0.3651484             0.3651484           0.2581989         0.2581989                0\n#> S02               0            0.3333333             0.3333333           0.2357023         0.2357023                0\n#> S03               0            0.3162278             0.3162278           0.3162278         0.2236068                0\n#> S04               0            0.4200840             0.3429972           0.2425356         0.0000000                0\n#> S05               0            0.3872983             0.3162278           0.2236068         0.3162278                0\n#> S06               0            0.3779645             0.3779645           0.2672612         0.0000000                0\n\n## Latitude e longitude\nhead(xy)\n#>       x   y\n#> S01 156 252\n#> S02 141 217\n#> S03 171 233\n#> S04 178 215\n#> S05 123 189\n#> S06 154 195\n\n## dados ambientais padronizados e altitude\nhead(env.pad.cat)\n#>     rain.jul   maxi.jul      altitude\n#> S01 1.333646  0.1462557    Montanhoso\n#> S02 1.468827 -0.6848206 Intermedi√°rio\n#> S03 1.505694 -0.2099199    Montanhoso\n#> S04 1.296778 -2.0699476    Montanhoso\n#> S05 1.075572 -0.3682201         Plano\n#> S06 1.100151 -0.6056705 Intermedi√°rio\n\n## Passo 1: Gerar um arquivo LIST W: list bin√°ria de vizinhan√ßa\nmat_knn <- knearneigh(as.matrix(xy), k = 2, longlat = FALSE)\nmat_nb <- knn2nb(mat_knn, sym = TRUE)\nmat_listw <- nb2listw(mat_nb, style = \"W\")\nmat_listw\n#> Characteristics of weights list object:\n#> Neighbour list object:\n#> Number of regions: 23 \n#> Number of nonzero links: 58 \n#> Percentage nonzero weights: 10.96408 \n#> Average number of links: 2.521739 \n#> \n#> Weights style: W \n#> Weights constants summary:\n#>    n  nn S0       S1       S2\n#> W 23 529 23 18.84444 96.01111\n\n## Passo 2: Listar os m√©todos \"candidatos\" para obter a matriz SWM\nMEM_mat <- scores.listw(mat_listw, MEM.autocor = \"positive\")\ncandidates <- listw.candidates(xy, nb = c(\"gab\", \"mst\", \"dnear\"), \n                               weights = c(\"binary\", \"flin\"))\n\n## Passo 3: Selecionar a melhor matriz SWM e executar o MEM\nW_sel_mat <- listw.select(species.hel, candidates, MEM.autocor = \"positive\",\n                          p.adjust = TRUE, method = \"FWD\")\n#> Procedure stopped (alpha criteria): pvalue for variable 5 is 0.112000 (> 0.050000)\n#> Procedure stopped (alpha criteria): pvalue for variable 3 is 0.059000 (> 0.050000)\n#> Procedure stopped (alpha criteria): pvalue for variable 3 is 0.060000 (> 0.050000)\n#> Procedure stopped (alpha criteria): pvalue for variable 4 is 0.157000 (> 0.050000)\n\n## Passo 4: Matriz dos preditores espaciais escolhidos (MEMs)\nspatial.pred <- as.data.frame(W_sel_mat$best$MEM.select)\n\n## √â necess√°rio atribuir os nomes das linhas\nrownames(spatial.pred) <- rownames(xy) \n## Combinar vari√°veis ambientais e espaciais em um √∫nico data.frame\npred.vars <- data.frame(env.pad.cat, spatial.pred)\n\n## RDA parcial\nrda.p <- rda(species.hel ~\n                 rain.jul + maxi.jul + altitude + # Preditores ambientais\n                 Condition(MEM1 + MEM2 + MEM4 + MEM5), # Preditores espaciais\n             data = pred.vars)\n\n## Interpreta√ß√£o\n# Para interpretar, √© necess√°rio saber a signific√¢ncia dos eixos para representar a rela√ß√£o entre as vari√°veis preditoras e a composi√ß√£o de esp√©cies.\nres.p.axis <- anova.cca(rda.p, by = \"axis\") \nres.p.axis\n#> Permutation test for rda under reduced model\n#> Forward tests for axes\n#> Permutation: free\n#> Number of permutations: 999\n#> \n#> Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude + Condition(MEM1 + MEM2 + MEM4 + MEM5), data = pred.vars)\n#>          Df Variance      F Pr(>F)\n#> RDA1      1 0.008471 2.1376  0.316\n#> RDA2      1 0.004830 1.2189  0.779\n#> RDA3      1 0.003240 0.8176  0.890\n#> RDA4      1 0.001891 0.4773  0.895\n#> Residual 14 0.055477\n\n## Contribui√ß√£o\n# Em seguida, √© poss√≠vel identificar quais s√£o as vari√°veis que contribuem ou que mais contribuem para a varia√ß√£o na composi√ß√£o de esp√©cies.\nres.p.var <- anova.cca(rda.p, by = \"term\") ## Qual vari√°vel?\nres.p.var\n#> Permutation test for rda under reduced model\n#> Terms added sequentially (first to last)\n#> Permutation: free\n#> Number of permutations: 999\n#> \n#> Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude + Condition(MEM1 + MEM2 + MEM4 + MEM5), data = pred.vars)\n#>          Df Variance      F Pr(>F)\n#> rain.jul  1 0.004406 1.1119  0.349\n#> maxi.jul  1 0.004446 1.1220  0.338\n#> altitude  2 0.009579 1.2087  0.241\n#> Residual 14 0.055477\nRsquareAdj(rda.p)\n#> $r.squared\n#> [1] 0.1361661\n#> \n#> $adj.r.squared\n#> [1] 0.02330319\n## Padr√£o espacial na composi√ß√£o de esp√©cies\npca.comp <- dudi.pca(species.hel, scale = FALSE, scannf = FALSE)\nmoran.comp <- moran.mc(pca.comp$li[, 1], mat_listw, 999)\n\n## Padr√£o espacial das vari√°veis ambientais\nenv$altitude <- as.factor(env$altitude)\nca.env <- dudi.hillsmith(env, scannf = FALSE)\nmoran.env <- moran.mc(ca.env$li[, 1], mat_listw, 999)\n\n## Estrutura espacial na composi√ß√£o de esp√©cies?\nmoran.comp\n#> \n#>  Monte-Carlo simulation of Moran I\n#> \n#> data:  pca.comp$li[, 1] \n#> weights: mat_listw  \n#> number of simulations + 1: 1000 \n#> \n#> statistic = 0.62815, observed rank = 1000, p-value = 0.001\n#> alternative hypothesis: greater\n\n## Estrutura espacial na varia√ß√£o ambiental?\nmoran.env\n#> \n#>  Monte-Carlo simulation of Moran I\n#> \n#> data:  ca.env$li[, 1] \n#> weights: mat_listw  \n#> number of simulations + 1: 1000 \n#> \n#> statistic = 0.72714, observed rank = 1000, p-value = 0.001\n#> alternative hypothesis: greater\n## Triplot da RDA\n# Parti√ß√£o de vari√¢ncia.\npv.birds <- varpart(species.hel, env.pad.cat, spatial.pred)\nplot(pv.birds, cutoff = -Inf)\nmtext(\"Diagrama de Venn: parti√ß√£o de vari√¢ncia\")"},{"path":"cap9.html","id":"an√°lise-de-redund√¢ncia-baseada-em-dist√¢ncia-db-rda","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.5.3 An√°lise de Redund√¢ncia baseada em dist√¢ncia (db-RDA)","text":"Acima, apresentamos an√°lise RDA que permite comparar, por exemplo, se vari√°veis ambientais determinam varia√ß√£o na composi√ß√£o de esp√©cies. RDA utiliza os dados brutos de composi√ß√£o de esp√©cies e √© baseada em uma PCA (.e., requer dist√¢ncia euclidiana). Por√©m, em algumas situa√ß√µes √© necess√°rio utilizar outras medidas de dist√¢ncia tais como Bray-Curtis ou Gower. Esta analise √© bastante √∫til tamb√©m quando matriz resposta j√° √© uma matriz de dist√¢ncia, tais como que s√£o geradas por decomposi√ß√£o da diversidade beta. Neste caso, Legendre & Anderson (1999) propuseram an√°lise db-RDA (RDA baseada em dist√¢ncia). O primeiro passo da an√°lise √© gerar uma matriz de dist√¢ncia partir da matriz bruta (e.g., composi√ß√£o de esp√©cies). Depois, t√©cnica executa uma PCoA (corrigindo potenciais autovetores com autovalores negativos; ver discuss√£o acima) para comparar com os termos modelo (matriz X, como na RDA).\nPara exemplificar como esta an√°lise pode ser implementada R, vamos usar o mesmo exemplo demontrado na an√°lise RDA (ver acima). Por√©m, vamos fazer um ajuste sutil na pergunta ‚Äúo clima e altitude modificam dissimilaridade (diversidade beta) de esp√©cies de aves?‚Äù Veja que neste caso, estamos perguntando diretamente sobre uma medida de diversidade beta, que ser√° calculada com o m√©todo Bray-Curtis. vari√°veis preditoras ser√£o mesmas obtidas exemplo da RDA: env.pad.cat.An√°liseInterpreta√ß√£o dos resultadosAssim como apresentado na RDA, os resultados obtidos em db.res.var sugerem que vari√°veis rain.jul, maxi.jul e altitude afetam diversidade beta de aves. O valor R2 ajustado (0.495) sugere forte rela√ß√£o entre o gradiente ambiental e diversidade beta. compara√ß√£o entre o valor db_r_quadr e r_quadr indica que db-RDA teve melhor ajuste para comparar o mesmo conjunto de dados.","code":"\n## Passo 1: transforma√ß√£o de hellinger da matriz de esp√©cies\n# caso tenha dados de abund√¢ncia.\nspecies.hel <- decostand(species, \"hellinger\")\n\n## Passo 2: gerar matriz de dist√¢ncia (Diversidade beta: Bray-Curtis)\ndbeta <- vegdist(species.hel, \"bray\")\n\n## Passo 2: dbRDA \ndbrda.bird <- capscale (dbeta~rain.jul+maxi.jul+altitude, data=env.pad.cat)\n\n# Para interpretar, √© necess√°rio saber a signific√¢ncia dos eixos para representar a rela√ß√£o entre as vari√°veis preditoras e a composi√ß√£o de esp√©cies\ndb.res.axis <- anova.cca(dbrda.bird, by = \"axis\") \ndb.res.axis\n#> Permutation test for capscale under reduced model\n#> Forward tests for axes\n#> Permutation: free\n#> Number of permutations: 999\n#> \n#> Model: capscale(formula = dbeta ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)\n#>          Df SumOfSqs       F Pr(>F)    \n#> CAP1      1 0.274186 16.9355  0.001 ***\n#> CAP2      1 0.044965  2.7773  0.110    \n#> CAP3      1 0.018141  1.1205  0.656    \n#> CAP4      1 0.009500  0.5868  0.788    \n#> Residual 18 0.291420                   \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Em seguida, √© poss√≠vel identificar quais s√£o as vari√°veis que contribuem ou que mais contribuem para a varia√ß√£o na composi√ß√£o de esp√©cies \ndb.res.var <- anova.cca(rda.bird, by = \"term\") ## Qual vari√°vel?\ndb.res.var\n#> Permutation test for rda under reduced model\n#> Terms added sequentially (first to last)\n#> Permutation: free\n#> Number of permutations: 999\n#> \n#> Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)\n#>          Df Variance      F Pr(>F)    \n#> rain.jul  1 0.036514 9.5936  0.001 ***\n#> maxi.jul  1 0.011264 2.9596  0.015 *  \n#> altitude  2 0.019071 2.5053  0.011 *  \n#> Residual 18 0.068510                  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Al√©m disso, √© poss√≠vel obter o valor do R2 do modelo\ndb_r_quadr <- RsquareAdj(dbrda.bird)\ndb_r_quadr\n#> $r.squared\n#> [1] 0.6116758\n#> \n#> $adj.r.squared\n#> [1] 0.5253816"},{"path":"cap9.html","id":"permanova","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.6 PERMANOVA","text":"PERMANOVA √© uma sigla, em ingl√™s, de Permutational Multivariate Analysis Variance, an√°lise proposta por Marti Anderson (M. J. Anderson 2001). PERMANOVA √© usada para testar hip√≥teses multivariadas que comparam abund√¢ncia de diferentes esp√©cies em resposta diferentes tratamentos ou gradientes ambientais. Essa an√°lise foi desenvolvida como forma de solucionar algumas limita√ß√µes da tradicional ANOVA multivariada (MANOVA). Em especial, o pressuposto da MANOVA de distribui√ß√£o normal multivariada √© raramente encontrado em dados ecol√≥gicos.O primeiro passo da PERMANOVA √© selecionar uma medida de dist√¢ncia apropriada aos dados e, al√©m disso, verificar necessidade de padroniza√ß√£o ou transforma√ß√£o dos dados. Em seguida, dist√¢ncias s√£o comparadas entre os grupos de interesse (por exemplo, tratamento versus controle) usando estat√≠stica F de maneira muito parecida com uma ANOVA (Cap√≠tulo 7), chamada de pseudo-F:\\[F_pseudo = (SSa / SSr)*[(N-g) / (g-1)]\\]Nessa equa√ß√£oSSa representa soma dos quadrados entre gruposSSr soma de quadrados dentro grupo (residual)N o n√∫mero de unidades amostraisg os grupos (ou n√≠veis da vari√°vel categ√≥rica)Esta f√≥rmula pseudo-F √© espec√≠fica para desenho experimental com um fator. Outros desenhos mais complexos s√£o apresetandos em Anderson M. J. Anderson (2017). O c√°lculo valor de probilidade √© realizado por m√©todos de permuta√ß√£o que s√£o discutidos em Anderson & Ter Braak (2003).Exemplo 1Esp√©cies de aves que ocorrem em localidades com diferentes altitudes.PerguntaO clima e altitude modificam composi√ß√£o de esp√©cies de aves?Predi√ß√µesDiferen√ßas clim√°ticas (temperatura e chuva) e altitudinais alteram composi√ß√£o de esp√©cies de avesVari√°veisPreditoras: Temperatura e chuva (cont√≠nuas) e altitude (categ√≥rica com tr√™s n√≠veis)Dependente: composi√ß√£o de esp√©cies de avesPara reduzir o n√∫mero de vari√°veis modelo, voc√™ pode considerar duas abordangens. primeira, e mais importante delas, √© manter somente vari√°veis preditoras que voc√™ tenha raz√£o biol√≥gica para mant√™-la e, al√©m disso, que esteja relacionada com suas hip√≥teses. Assim, uma vez que voc√™ j√° removeu vari√°veis que n√£o possuem relev√¢ncia biol√≥gica, voc√™ deve usar diferentes m√©todos para remover vari√°veis muito correlacionadas (forward selection, Variance Inflation Factor (VIF), entre outros). Neste exemplo, vamos simplesmente fazer uma correla√ß√£o m√∫ltipla e remover vari√°veis com correla√ß√£o maior que 0.9 ou -0.9. fun√ß√£o ggpairs() mostra um gr√°fico bem did√°tico para representar rela√ß√£o entre todas vari√°veis e o valor (r) desta correla√ß√£o (mais em Cap√≠tulo 7) (Figura 9.17).\nFigura 9.17: Correlograma mostrando correla√ß√£o entre vari√°veis.\nAp√≥s selecionar vari√°veis modelo, vamos executar PERMANOVA e entender principais etapas para interpretar corretamente o teste. fun√ß√£o adonis() pacote vegan √© uma boa op√ß√£o. Por√©m, √© importante referir o programa PRIMER e PERMANOVA+ como √≥tima op√ß√£o para implementar PERMANOVA e ter maior controle em desenhos complexos (M. J. Anderson, Gorley, Clarke 2008). Assim como nos modelos lineares apresentados Cap√≠tulo 7, os argumento seguem o mesmo formato, com vari√°vel dependente separada por um ‚Äú~‚Äù das vari√°veis preditoras. Por√©m, alguns autores demonstraram que PERMANOVA (assim como Mantel e ANOSIM) n√£o pode identificar se diferen√ßas significativas teste (usando estat√≠stica pseudo-F) se devem diferen√ßas posi√ß√£o, na dispers√£o ou ambos. Ou seja, ao comparar grupos n√£o √© poss√≠vel identificar se existe mudan√ßas de composi√ß√£o (posi√ß√£o) ou varia√ß√£o da composi√ß√£o de esp√©cies dentro de um grupo (dispers√£o) √© maior que varia√ß√£o dentro outro grupo (M. J. Anderson Walsh 2013). Para solucionar este problema, √© poss√≠vel combinar PERMANOVA com an√°lise PERMDISP (ou BETADISPER, como chamado pacote vegan implementado atrav√©s da fun√ß√£o betadisper()). Esta an√°lise permite comparar se existe heterogeneidade nas vari√¢ncias entre grupos. Deste modo, com presen√ßa de heterogeneidade de vari√¢ncias (valor BETADISPER significativo), √© poss√≠vel saber que diferen√ßas entre os grupos ocorre principalmente por diferen√ßas na dispers√£o e n√£o, necessariamente, de posi√ß√£o. Mais detalhes sobre relev√¢ncia de combinar essas duas an√°lises est√£o dispon√≠veis em Anderson & Walsh (2013).Em nosso exemplo, temperatura, precipita√ß√£o e altitude afetaram varia√ß√£o na composi√ß√£o de esp√©cies. Por√©m, para identificar se diferen√ßas de composi√ß√£o entre os n√≠veis da vari√°vel altitude, √© necess√°rio interpretar os resultados da an√°lise BETADISPER. O c√≥digo permutest(betad.aves) mostra que o valor de probabilidade da an√°lise foi de 0.253, ou seja, hip√≥tese nula de que vari√¢ncia entre grupos √© homog√™nea √© aceita. Assim, n√£o existe diferen√ßas na dispers√£o entre grupos, sugerindo que diferen√ßa encontrada na PERMANOVA (objeto perm.aves) se deve, em parte, √† mudan√ßa na composi√ß√£o de esp√©cies de aves entre diferentes altitudes (R2 = 0.135). Al√©m disso, precipita√ß√£o (R2 = 0.183) e temperatura (R2 = 0.127) foram fatores importantes na varia√ß√£o da composi√ß√£o de esp√©cies.Como falado anteriormente, an√°lises de ordena√ß√£o irrestritas (PCA, PCoA, nMDS) s√£o utilizadas para explorar dados. Uma maneira poderosa de us√°-las √© combinando com an√°lises que testam hip√≥teses, como PERMANOVA e RDA. literatura ecol√≥gica tem usado An√°lise de Escalonamento n√£o-M√©trico (non-Metric Multidimensional Scaling - nMDS) combinado com an√°lises multidimensionais de vari√¢ncia (como PERMANOVA) para visualiza√ß√£o da similaridade na composi√ß√£o de esp√©cies dentro e entre grupos. seguir, implementamos o nMDS na matriz de composi√ß√£o de esp√©cies de √°caros (Figura 9.18).\nFigura 9.18: Biplot mostrando o resultado nMDS.\n","code":"\n## Composi√ß√£o de esp√©cies padronizar com m√©todo de Hellinger\nspecies.hel <- decostand(x = species, method = \"hellinger\")\n\n## Matriz de dist√¢ncia com m√©todo Bray-Curtis\nsps.dis <- vegdist(x = species.hel, method = \"bray\")\n## Verifica correla√ß√£o entre as vari√°veis\nggpairs(env) +\n    tema_livro()\n\n## Ap√≥s verificar a estrutura de correla√ß√£o, vamos manter somente tr√™s vari√°veis\nenv2 <- env[, c(\"mini.jan\", \"rain.tot\", \"altitude\")]\n## PERMANOVA\nperm.aves <- adonis2(sps.dis ~ mini.jan + rain.tot + altitude, data = env2)\nperm.aves ### Diferen√ßas entre os tratamentos?\n#> Permutation test for adonis under reduced model\n#> Terms added sequentially (first to last)\n#> Permutation: free\n#> Number of permutations: 999\n#> \n#> adonis2(formula = sps.dis ~ mini.jan + rain.tot + altitude, data = env2)\n#>          Df SumOfSqs      R2      F Pr(>F)    \n#> mini.jan  1  0.09069 0.15997 6.3307  0.001 ***\n#> rain.tot  1  0.12910 0.22771 9.0118  0.001 ***\n#> altitude  2  0.08929 0.15749 3.1163  0.011 *  \n#> Residual 18  0.25787 0.45483                  \n#> Total    22  0.56695 1.00000                  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n## BETADISPER\nbetad.aves <- betadisper(sps.dis, env2$altitude)\npermutest(betad.aves)\n#> \n#> Permutation test for homogeneity of multivariate dispersions\n#> Permutation: free\n#> Number of permutations: 999\n#> \n#> Response: Distances\n#>           Df    Sum Sq   Mean Sq      F N.Perm Pr(>F)\n#> Groups     2 0.0042643 0.0021322 1.4672    999  0.265\n#> Residuals 20 0.0290636 0.0014532\n## Matriz de dist√¢ncia representando a varia√ß√£o na composi√ß√£o de esp√©cies (m√©todo Bray-Curtis)\nas.matrix(sps.dis)[1:6, 1:6]\n#>           S01        S02        S03       S04       S05       S06\n#> S01 0.0000000 0.15133734 0.16720405 0.2559122 0.2559882 0.2588892\n#> S02 0.1513373 0.00000000 0.04114702 0.1190172 0.1289682 0.1391056\n#> S03 0.1672040 0.04114702 0.00000000 0.1420233 0.1358127 0.1410867\n#> S04 0.2559122 0.11901720 0.14202325 0.0000000 0.1140283 0.1199803\n#> S05 0.2559882 0.12896823 0.13581271 0.1140283 0.0000000 0.2129054\n#> S06 0.2588892 0.13910558 0.14108668 0.1199803 0.2129054 0.0000000\n\n## √â preciso calcular uma primeira \"melhor\" solu√ß√£o do nMDS\nsol1 <- metaMDS(sps.dis)\n#> Run 0 stress 0.1344042 \n#> Run 1 stress 0.3825954 \n#> Run 2 stress 0.1272417 \n#> ... New best solution\n#> ... Procrustes: rmse 0.07890815  max resid 0.3526073 \n#> Run 3 stress 0.1344042 \n#> Run 4 stress 0.1338432 \n#> Run 5 stress 0.1626783 \n#> Run 6 stress 0.1336481 \n#> Run 7 stress 0.1272417 \n#> ... Procrustes: rmse 6.723274e-06  max resid 1.889203e-05 \n#> ... Similar to previous best\n#> Run 8 stress 0.1338432 \n#> Run 9 stress 0.1378506 \n#> Run 10 stress 0.1272418 \n#> ... Procrustes: rmse 0.0001085155  max resid 0.0004162969 \n#> ... Similar to previous best\n#> Run 11 stress 0.1272418 \n#> ... Procrustes: rmse 4.197901e-05  max resid 0.000160606 \n#> ... Similar to previous best\n#> Run 12 stress 0.1378506 \n#> Run 13 stress 0.1272418 \n#> ... Procrustes: rmse 5.310796e-05  max resid 0.0001988503 \n#> ... Similar to previous best\n#> Run 14 stress 0.1580523 \n#> Run 15 stress 0.1344042 \n#> Run 16 stress 0.1272418 \n#> ... Procrustes: rmse 2.586759e-05  max resid 9.827497e-05 \n#> ... Similar to previous best\n#> Run 17 stress 0.1584787 \n#> Run 18 stress 0.1344042 \n#> Run 19 stress 0.1344042 \n#> Run 20 stress 0.1344042 \n#> *** Solution reached\n\n## Melhor solu√ß√£o\n# Depois, executar a mesma fun√ß√£o, mas utilizando uma \"melhor solu√ß√£o inicial\" para evitar resultdos sub√≥timos no nMDS .\nnmds.beta <- metaMDS(sps.dis, previous.best = sol1)\n#> Starting from 2-dimensional configuration\n#> Run 0 stress 0.1272417 \n#> Run 1 stress 0.1272418 \n#> ... Procrustes: rmse 2.188819e-05  max resid 7.340362e-05 \n#> ... Similar to previous best\n#> Run 2 stress 0.1338432 \n#> Run 3 stress 0.1584788 \n#> Run 4 stress 0.1344043 \n#> Run 5 stress 0.1338433 \n#> Run 6 stress 0.1336481 \n#> Run 7 stress 0.1344042 \n#> Run 8 stress 0.1338432 \n#> Run 9 stress 0.1272418 \n#> ... Procrustes: rmse 2.708248e-05  max resid 0.0001008894 \n#> ... Similar to previous best\n#> Run 10 stress 0.1336481 \n#> Run 11 stress 0.1344042 \n#> Run 12 stress 0.3798204 \n#> Run 13 stress 0.1336481 \n#> Run 14 stress 0.1336481 \n#> Run 15 stress 0.1344042 \n#> Run 16 stress 0.1336481 \n#> Run 17 stress 0.1338432 \n#> Run 18 stress 0.1272418 \n#> ... Procrustes: rmse 2.303898e-05  max resid 8.758403e-05 \n#> ... Similar to previous best\n#> Run 19 stress 0.1344042 \n#> Run 20 stress 0.1378506 \n#> *** Solution reached\n\n## Stress\n# O stress √© o valor mais importante para interpretar a qualidade da ordena√ß√£o.\nnmds.beta$stress # valor ideal entre 0 e 0.2\n#> [1] 0.1272417\n\n## Exportar os valores para fazer gr√°fico \ndat.graf <- data.frame(vegan::scores(nmds.beta), altitude = env2$altitude)\n\n## Definir os grupos (\"HULL\") para serem categorizados no gr√°fico \ngrp.mon <- dat.graf[dat.graf$altitude == \"Montanhoso\", ][chull(dat.graf[dat.graf$altitude == \"Montanhoso\", c(\"NMDS1\", \"NMDS2\")]), ]\n\ngrp.int <- dat.graf[dat.graf$altitude == \"Intermedi√°rio\", ][chull(dat.graf[dat.graf$altitude == \"Intermedi√°rio\", c(\"NMDS1\", \"NMDS2\")]), ]\n\ngrp.pla <- dat.graf[dat.graf$altitude == \"Plano\", ][chull(dat.graf[dat.graf$altitude == \"Plano\", c(\"NMDS1\", \"NMDS2\")]), ]\n\n## Combinar dados dos grupos para cada Convex Hull\nhull.data <- rbind(grp.mon, grp.int, grp.pla) \nhead(hull.data)\n#>           NMDS1       NMDS2      altitude\n#> S04 -0.10578586 -0.10682766    Montanhoso\n#> S01 -0.25332406  0.04199004    Montanhoso\n#> S11 -0.12504415  0.14477005    Montanhoso\n#> S15  0.09166059  0.09857114    Montanhoso\n#> S18  0.01968127 -0.12417579 Intermedi√°rio\n#> S06 -0.16053825 -0.08924030 Intermedi√°rio\n\n## Gr√°fico\nggplot(dat.graf, aes(x = NMDS1, y = NMDS2, color = altitude, shape = altitude)) + \n    geom_point(size = 4, alpha = 0.7) + \n    geom_polygon(data = hull.data, aes(fill = altitude, group = altitude), alpha = 0.3) + \n    scale_color_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    scale_fill_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    labs(x = \"NMDS1\", y = \"NMDS2\") + \n    tema_livro()"},{"path":"cap9.html","id":"mantel-e-mantel-parcial","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.7 Mantel e Mantel parcial","text":"O teste de Mantel se aplica quando temos duas ou mais matrizes de dist√¢ncia (triangulares). Em estudos ecol√≥gicos, essas matrizes normalmente descrevem dados de dist√¢ncia ou (dis)similaridade na composi√ß√£o de esp√©cies, dist√¢ncia geogr√°fica, e similaridade ambiental. Mas este teste tamb√©m √© amplamente aplicado na √°rea de gen√©tica de paisagem para testar hip√≥teses sobre como composi√ß√£o gen√©tica de uma popula√ß√£o varia em fun√ß√£o ambiente e/ou espa√ßo geogr√°fico (Legendre Fortin 2010). O teste nada mais √© que uma generaliza√ß√£o coeficiente de correla√ß√£o de Pearson (Cap√≠tulo 7) para lidar com matrizes de dist√¢ncia. Como essas matrizes descrevem rela√ß√£o entre v√°rios pares de locais, temos repeti√ß√£o mesmo local em outros pares. Neste caso √© preciso um procedimento semelhante ao de corre√ß√£o para m√∫ltiplos testes.J√° o Mantel parcial pretende testar correla√ß√£o entre duas matrizes controlando para o efeito de uma terceira. Por exemplo, testar associa√ß√£o entre dissimilaridade na composi√ß√£o de esp√©cies e dissimilaridade ambiental, controlando para dist√¢ncia geogr√°fica entre os locais. Isso nos permite levar em conta poss√≠vel autocorrela√ß√£o espacial nas vari√°veis ambientais, ou seja, estar√≠amos testando de fato o efeito da dissimilaridade ambiental ‚Äúpura‚Äù na dissimilaridae na composi√ß√£o de esp√©cies, evitando o efeito espa√ßo em si. Portanto, note que sempre estamos raciocinando em termos de (dis)similaridade e n√£o dos dados brutos em si, seja composi√ß√£o de esp√©cies ou vari√°veis ambientais. √â importante ter isto em mente na hora de interpretar os resultados.Exemplo 1Neste exemplo, vamos utilizar um conjunto de dados que cont√©m girinos de esp√©cies de anf√≠bios anuros coletados em 14 po√ßas d‚Äô√°gua e os respectivos dados de vari√°veis ambientais destas mesmas po√ßas (Provete et al. 2014).PerguntaExiste correla√ß√£o entre dissimilaridade na composi√ß√£o de esp√©cies de girinos e dissimilaridade ambiental?Predi√ß√µesAssumindo que processos baseados nicho sejam predominantes, quanto mais diferentes po√ßas forem maior ser√° diferen√ßa na composi√ß√£o de esp√©ciesVari√°veisVari√°veis: matriz de dist√¢ncia (Bray-Curtis) da composi√ß√£o das esp√©cies e outra matriz de dist√¢ncia (Euclideana) das vari√°veis ambientaisAn√°lisesAqui vamos utilizar al√©m conjunto de dados bocaina j√° conhecido, outras duas matrizes dispon√≠veis pacote ecodados: bocaina.xy e bocaina.env, que cont√™m coordenadas geogr√°ficas e vari√°veis ambientais das po√ßas, respectivamente.Vamos agora fazer os gr√°ficos relacionando matrizes de similaridade dos dados (Figura 9.19).\nFigura 9.19: Rela√ß√£o das matrizes de (dis)similaridade dos dados.\nInterpreta√ß√£o dos resultadosOs resultados mostraram que existe uma rela√ß√£o positiva, embora fraca, entre dissimilaridade ambiental e dissimilaridade na composi√ß√£o de esp√©cies. Este resultado est√° de acordo com nossa hip√≥tese inicial. entanto, vimos tamb√©m que existe uma rela√ß√£o positiva e significativa entre dist√¢ncia em linha reta entre po√ßas e dissimilaridade ambiental. Logo, para de fato testar rela√ß√£o entre o ambiente e composi√ß√£o de esp√©cies temos de levar em conta o espa√ßo.Para isto temos de realizar um teste de Mantel Parcial.Agora sim, vimos que rela√ß√£o entre ambiente e esp√©cies se mant√©m, mas que for√ßa dessa rela√ß√£o diminuiu bastante (veja o valor de r) quando controlamos o espa√ßo.","code":"\n## Dados\nhead(bocaina.env)\n#>       pH  tur   DO  temp veg  dep canopy conduc hydro area\n#> PP3 7.07 0.66 2.26 18.93  30 0.35   30.3 0.0100   per  139\n#> PP4 6.85 0.33 2.78 20.53   0 0.33   32.1 0.0100   per  223\n#> AP1 6.64 0.40 4.09 15.26   5 3.50   42.0 0.0105   per  681\n#> AP2 6.13 0.80 3.47 15.40  70 2.50   82.0 0.0300   per  187\n#> PP1 5.80 0.75 3.22 16.75  70 0.70   91.4 0.0100   per   83\n#> PP2 5.32 4.00 2.10 15.90  95 0.27   75.3 0.0100   per  108\nhead(bocaina.xy)\n#>         Long      Lat\n#> PT5 -44.6239 -22.7243\n#> PP3 -44.6340 -22.7228\n#> PP4 -44.6334 -22.7228\n#> BP4 -44.6212 -22.7262\n#> BP2 -44.6155 -22.7289\n#> PT1 -44.6170 -22.7350\n\n## Matriz de dist√¢ncia geogr√°fica\nDist.km <- as.dist(rdist.earth(bocaina.xy, miles=F)) # matriz de dist√¢ncia geogr√°fica (geod√©sica) considerando a curvatura da Terra\n\n## Padroniza√ß√µes\ncomp.bo.pad <- decostand(t(bocaina), \"hellinger\")\nenv.bocaina <- decostand(bocaina.env[,-9], \"standardize\")\n\n## Similaridades\nsimil.bocaina <- vegdist(comp.bo.pad, \"bray\")\nsimil.env <- vegdist(env.bocaina, \"euclidian\")\n## Mantel\n# Espa√ßo vs. ambiente\nmantel(Dist.km, simil.env) \n#> \n#> Mantel statistic based on Pearson's product-moment correlation \n#> \n#> Call:\n#> mantel(xdis = Dist.km, ydis = simil.env) \n#> \n#> Mantel statistic r: 0.4848 \n#>       Significance: 0.005 \n#> \n#> Upper quantiles of permutations (null model):\n#>   90%   95% 97.5%   99% \n#> 0.250 0.330 0.393 0.447 \n#> Permutation: free\n#> Number of permutations: 999\n\n# Espa√ßo vs. composi√ß√£o\nmantel(Dist.km, simil.bocaina) \n#> \n#> Mantel statistic based on Pearson's product-moment correlation \n#> \n#> Call:\n#> mantel(xdis = Dist.km, ydis = simil.bocaina) \n#> \n#> Mantel statistic r: 0.3745 \n#>       Significance: 0.007 \n#> \n#> Upper quantiles of permutations (null model):\n#>   90%   95% 97.5%   99% \n#> 0.149 0.215 0.279 0.335 \n#> Permutation: free\n#> Number of permutations: 999\n\n# Ambiente vs. composi√ß√£o\nmantel(simil.env, simil.bocaina) \n#> \n#> Mantel statistic based on Pearson's product-moment correlation \n#> \n#> Call:\n#> mantel(xdis = simil.env, ydis = simil.bocaina) \n#> \n#> Mantel statistic r: 0.2898 \n#>       Significance: 0.02 \n#> \n#> Upper quantiles of permutations (null model):\n#>   90%   95% 97.5%   99% \n#> 0.171 0.227 0.266 0.322 \n#> Permutation: free\n#> Number of permutations: 999\n## Dados\nmatrix.bocaina.env <- data.frame(x = melt(as.matrix(simil.bocaina))$value, \n                                 y = melt(as.matrix(simil.env))$value)\n\nmatrix.dist.env <- data.frame(x = melt(as.matrix(Dist.km))$value, \n                              y = melt(as.matrix(simil.env))$value)\n\nmatrix.dist.bocaina <- data.frame(x = melt(as.matrix(log(Dist.km)))$value, \n                              y = melt(as.matrix(log(1-simil.bocaina)))$value)\n\n## Gr√°ficos\nggplot(matrix.bocaina.env, aes(x, y)) +\n    geom_point() +\n    labs(x = \"Similaridade Bocaina\", \n         y = \"Similaridade Ambiental\") +\n    tema_livro()\n\nggplot(matrix.dist.env , aes(x, y)) +\n    geom_point() +\n    labs(x = \"Dist√¢ncia geogr√°fica (km)\", \n         y = \"Similaridade Ambiental\") +\n    tema_livro()\n\nggplot(matrix.dist.bocaina , aes(x, y)) +\n    geom_point() +\n    labs(x = \"Dist√¢ncia geogr√°fica (km)\", \n         y = \"Similaridade (Bray-Curtis)\") +\n    tema_livro()\n## Mantel Parcial\nmantel.partial(simil.bocaina, simil.env, Dist.km) #comp. vs. ambiente controlando o espa√ßo\n#> \n#> Partial Mantel statistic based on Pearson's product-moment correlation \n#> \n#> Call:\n#> mantel.partial(xdis = simil.bocaina, ydis = simil.env, zdis = Dist.km) \n#> \n#> Mantel statistic r: 0.1334 \n#>       Significance: 0.123 \n#> \n#> Upper quantiles of permutations (null model):\n#>   90%   95% 97.5%   99% \n#> 0.148 0.200 0.229 0.278 \n#> Permutation: free\n#> Number of permutations: 999"},{"path":"cap9.html","id":"mantel-espacial-com-modelo-nulo-restrito-considerando-autocorrela√ß√£o-espacial","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.8 Mantel espacial com modelo nulo restrito considerando autocorrela√ß√£o espacial","text":"Embora seja um tipo de an√°lise bastante popular, o Mantel e sua vers√£o parcial parecem n√£o ser muito adequadas para lidar com autocorrela√ß√£o espacial. Os autores dos artigos abaixo sugerem inclusive que esse tipo de an√°lise n√£o √© adequado para testar maioria das hip√≥teses em Ecologia, incluindo diversidade beta. Esse √© um tema bastante discutido na literatura e n√£o vamos nos alongar muito sobre isso, mas referimos o() leitor() para os seguintes artigos chave: Legendre et al.¬†2015 (2015), Legendre & Fortin 2010 (2010), e Legendre (2000).entanto, Crabot et al. (2019) propuseram uma modifica√ß√£o teste que leva em conta autocorrela√ß√£o espacial ao gerar o modelo nulo usado para o teste de hip√≥tese. √â utilizado um procedimento chamado Moran Spectral Randomization porque preserva autocorrela√ß√£o global medida por meio de Moran global. grande vantagem √© que este teste utiliza toda flexibilidade dos Moran Eigenvector Maps (MEMs), que √© apresentado na parte de RDA, permitindo analisar rela√ß√µes entre matrizes em m√∫ltiplas escalas espaciais. Vejamos como o teste funciona.Primeiro precisamos construir um objeto com duas matrizes que desejamos testar, nosso caso composi√ß√£o de esp√©cies e espa√ßo. Depois precisamos construir explicitamente nossa hip√≥tese de rela√ß√£o espacial entre os locais por meio de uma rede de vizinhan√ßa. Esta rede √© uma estrutura que nos dir√° como (e eventualmente com qual intensidade) se h√° rela√ß√£o entre os locais. Aqui, entende-se que nos referimos √† probabilidade de fluxo de indiv√≠duos entre os locais.Note que at√© aqui n√£o h√° nada de novo, apenas utilizamos uma fun√ß√£o diferente para realizar o teste de Mantel, agora pacote ade4 ao inv√©s vegan. Agora temos de construir nossa rede de vizinhan√ßa. Optamos neste exemplo por uma rede bastante simples, que √© Minimum Spanning Tree. Essa √© rede espacial m√≠nima que mant√©m todos os pontos ligados entre si (Figura 9.20).\nFigura 9.20: Rede de vizinhan√ßa com Minimum Spanning Tree\ngr√°fico, podemos ver ‚Äúcara‚Äù da rede. Cada ponto representa um local (po√ßa) e linhas representam liga√ß√£o hip√≥tetica entre eles, plotamos espa√ßo geogr√°fico, ou seja, o Norte aponta pra cima. Agora temos apenas que converter o formato nb para listw e finalmente entrar com esses objetos na fun√ß√£o que realizar√° an√°lise.Interpreta√ß√£o dos resultadosVamos comparar com o Mantel comum.Note que o valor da estat√≠stica teste, ou seja, o r de Mantel √© exatamente o mesmo. entanto, o valor de P que indicava que o teste havia sido significativo anteriormente mudou e passou ser n√£o significativo. Isso ocorreu porque, embora maneira de calcular estat√≠stica teste seja mesma, forma de construir distribui√ß√£o nula, partir da qual ser√° calculado o valor de P mudou drasticamente, resultando num teste n√£o significativo.","code":"\n## Mantel\ncompos_espac <- mantel.randtest(sqrt(simil.bocaina), Dist.km)\ncompos_espac\n#> Monte-Carlo test\n#> Call: mantel.randtest(m1 = sqrt(simil.bocaina), m2 = Dist.km)\n#> \n#> Observation: 0.3738076 \n#> \n#> Based on 999 replicates\n#> Simulated p-value: 0.005 \n#> Alternative hypothesis: greater \n#> \n#>     Std.Obs Expectation    Variance \n#> 3.265589171 0.002421976 0.012933827\n## Minimum Spanning Tree\nnb.boc <- mst.nb(Dist.km) # calcula uma Minimum Spanning Tree\nplot(nb.boc, bocaina.xy)\n## Convers√£o\nlw <- nb2listw(nb.boc)\n\n## Mantel espacial\nmsr(compos_espac, lw, method = \"pair\")\n#> Monte-Carlo test\n#> Call: msr.mantelrtest(x = compos_espac, listwORorthobasis = lw, method = \"pair\")\n#> \n#> Observation: 0.3738076 \n#> \n#> Based on 999 replicates\n#> Simulated p-value: 0.127 \n#> Alternative hypothesis: greater \n#> \n#>     Std.Obs Expectation    Variance \n#>  1.21335033  0.17433665  0.02702631\n## Mantel comum\ncompos_espac\n#> Monte-Carlo test\n#> Call: mantel.randtest(m1 = sqrt(simil.bocaina), m2 = Dist.km)\n#> \n#> Observation: 0.3738076 \n#> \n#> Based on 999 replicates\n#> Simulated p-value: 0.005 \n#> Alternative hypothesis: greater \n#> \n#>     Std.Obs Expectation    Variance \n#> 3.265589171 0.002421976 0.012933827"},{"path":"cap9.html","id":"procrustes-e-protest","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.9 PROCRUSTES e PROTEST","text":"Uma alternativa ao Mantel para comparar o grau de associa√ß√£o entre conjuntos multidimensionais de dados (e.g., matriz de esp√©cies e matriz ambiental) √© an√°lise conhecida como Procrustes (Gower 1971; Jackson 1995). Esta an√°lise compara duas matrizes (objetos nas linhas e vari√°veis nas colunas) minimizando soma dos desvios quadrados entre os valores atrav√©s das seguintes t√©cnicas: transla√ß√£o, escalonamento e rota√ß√£o. √â importante notar que os objetos devem ser os mesmos e, desse modo, o n√∫mero de linhas √© obrigatoriamente igual, ao passo que o n√∫mero de colunas pode variar. posi√ß√£o objeto Xi (= 1, ‚Ä¶n) √© comparada com o objeto Yi da matriz correspondente, movimentando os pontos via transla√ß√£o, reflex√£o, rota√ß√£o e dilata√ß√£o. Assim, os objetos da matriz X resultam na matrix X‚Äô que √© representada pelo melhor ajuste (menor valor residual da soma dos quadrados: estat√≠stica m12) entre matriz X e Y. estat√≠stica m12 mede, ent√£o, o grau de concord√¢ncia entre duas matrizes. Os valores de m12 variam de 1 (sem concord√¢ncia) 0 (m√°xima concord√¢ncia) (Peres-Neto Jackson 2001; Lisboa et al. 2014). Para testar signific√¢ncia valor observado de m12, Jackson (1995) sugeriu um teste de aleatoriza√ß√£o chamado PROTEST.possibilidades de aplica√ß√£o Procrustes para ecologia s√£o diversas. Dentre elas, se destacam : ) morfometria geom√©trica e ii) ecologia de comunidades (concord√¢ncia de comunidades). Uma caracter√≠stica interessante Procrustes √© possibilidade de usar matriz bruta (e.g., vari√°veis ambientais) ou matriz de dist√¢ncia, o que amplia possibilidades anal√≠ticas. Para compara√ß√µes com matrizes brutas, an√°lises de ordena√ß√£o irrestrita (PCA, CA) devem ser realizadas antes Procrustes. Por outro lado, para compara√ß√µes com matrizes de dist√¢ncia (e.g., Euclidiana, Jaccard, Bray-Curtis), an√°lises como PCoA e nMDS devem preceder √† an√°lise de Procrustes (veja Figura 4 em Peres-Neto Jackson 2001). Nos dois casos, ordena√ß√£o √© importante para gerar matrizes com mesma dimensionalidade o que, por sua vez, permite comparar matrizes com n√∫mero de colunas diferentes.Exemplo 1Neste exemplo, vamos utilizar dois conjuntos de dados simulados de peixes e macroinvertebrados aqu√°ticos coletados em riachos. Neste exemplo hipot√©tico, existe uma rede de 12 riachos com diferentes graus de polui√ß√£o. Em cada riacho, foi produzida uma lista de esp√©cies de peixes e de macroinvertebrados (com dados de abund√¢ncia).PerguntaExiste concord√¢ncia na distribui√ß√£o na composi√ß√£o de esp√©cies de peixes e macroinvertebrados?Predi√ß√µesAssumindo que alguns poluentes, tais como metais pesados, podem atuar como filtro ambiental e limitar ocorr√™ncia de determinados organismos aqu√°ticos, espera-se encontrar alta concord√¢ncia entre duas matrizes (peixes e macroinvertebrados). Ou seja, comunidade tanto de peixes quanto de macroinvertebrados responder√£o de forma similar ao gradiente ambientalVari√°veisVari√°veis: composi√ß√£o das esp√©cies de peixes e macroinverebrados aqu√°ticosAn√°lisesNo exemplo escolhido, duas matrizes representam composi√ß√£o de esp√©cies em diferentes riachos. Desse modo, o ideal √© transformar esta matriz bruta em matriz de dist√¢ncia com o m√©todo Bray-Curtis (vegdist()). O pr√≥ximo passo, ent√£o, √© realizar uma An√°lise de Coordenadas Principais (PCoA) (veja abaixo) para gerar duas matrizes de ordena√ß√£o que ser√£o comparadas com fun√ß√£o procrustes(). Por fim, utilizamos fun√ß√£o protest() para testar signific√¢ncia da concord√¢ncia entre matrizes (Figura 9.21).\nFigura 9.21: Biplot mostrando o resultado da an√°lise de PROCRUSTES.\nInterpreta√ß√£o dos resultadosA fun√ß√£o protest() apresenta dois resultados importantes: ) estat√≠stica m12 e ii) o valor de signific√¢ncia (p). exemplo, o valor de m12 √© igual 0.6185 e o valor de p √© 0,019. Desse modo, podemos concluir que existe concord√¢ncia entre composi√ß√£o de esp√©cies de peixes e macroinvertebrados aqu√°ticos, sugerindo que o n√≠vel de polui√ß√£o pode gerar padr√µes previs√≠veis de distribui√ß√£o de diferentes organismos aqu√°ticos. figura produzida pelo c√≥digo plot(concord) mostra um gr√°fico t√≠pico Procrustes, onde base da seta representa matriz X e ponta da seta matriz alvo (Y) ap√≥s rota√ß√£o para comparar o grau de concord√¢ncia entre X e Y. Cada ponto representa um objeto (linha) das matrizes X e Y. Quanto menor o tamanho das setas, mais concordantes s√£o observa√ß√µes em cada objeto.","code":"\n## Dados\nhead(fish_comm)\n#>       sp1 sp2 sp3 sp4 sp5 sp6 sp7 sp8 sp9 sp10 sp11 sp12 sp13 sp14 sp15 sp16 sp17 sp18 sp19 sp20 sp21 sp22 sp23 sp24\n#> site1   0   0   0   1   1   0   4   0   0    0    1    0    1    1    0    5    0    0    0    0    0    1    0    3\n#> site2   0   0   0   1   0   1   5   0   2    1    1    2    1    0    0    1    0    0    0    0    0    0    1    0\n#> site3   0   1   0   4   0   0   0   1   5    0    5    0    0    5    0    1    0    1    0    0    2    0    0    0\n#> site4   0   5   0   1   0   1   0   0   2    0    0    0    0    2    1    0    0    0    0    1    1    0    0    2\n#> site5   0   2   0   0   0   0   0   0   0    0    4    0    0    1    0    4    0    0    0    1    5    0    5    0\n#> site6   0   2   1   0   0   0   0   1   1    0    0    2    0    2    0    0    0    0    0    0    0    0    4    0\nhead(macroinv)\n#>       sp1 sp2 sp3 sp4 sp5 sp6 sp7 sp8 sp9 sp10 sp11 sp12 sp13 sp14 sp15 sp16 sp17 sp18 sp19 sp20 sp21 sp22 sp23 sp24 sp25\n#> site1   0   1   1   0   0   0   0   0   0    1    2    0    0    0    0    1    1    0    4    0    0    0    1    0    0\n#> site2   0   2   1   0   0   0   0   1   1    0    0    2    0    1    1    0    0    0    0    0    0    1    2    0    1\n#> site3   0   0   0   1   0   1   5   0   2    1    1    2    0    4    0    1    0    0    1    0    0    0    0    1    0\n#> site4   0   1   0   4   0   0   0   1   5    0    5    0    0    5    0    1    0    1    0    0    2    0    0    0    0\n#> site5   0   2   0   0   0   0   0   0   0    0    4    0    0    2    1    0    0    0    0    1    1    0    0    2    0\n#> site6   1   0   0   1   0   0   0   0   0    0    1    0    0    2    0    0    0    0    0    0    0    0    4    0    0\n#>       sp26 sp27 sp28 sp29 sp30 sp31 sp32 sp33 sp34 sp35 sp36\n#> site1    1    0    4    0    0    0    1    5    0    5    0\n#> site2    0    1    1    0    0    1    0    0    1    0    0\n#> site3    2    1    0    0    0    0    1    1    0    0    2\n#> site4    2    1    0    0    0    0    0    0    5    1    0\n#> site5    5    0    1    0    1    0    0    2    0    0    0\n#> site6    2    0    0    0    0    0    0    0    0    4    0\n\n## Fixar a amostragem\nset.seed(1001) \n\n## Matrizes de dist√¢ncia de PCoA \nd_macro <- vegdist(macroinv, \"bray\")\npcoa_macro <- cmdscale(d_macro)\n\nd_fish <- vegdist(fish_comm, \"bray\")\npcoa_fish <- cmdscale(d_fish)\n\n## PROCRUSTES\nconcord <- procrustes(pcoa_macro, pcoa_fish)\nprotest(pcoa_macro, pcoa_fish)\n#> \n#> Call:\n#> protest(X = pcoa_macro, Y = pcoa_fish) \n#> \n#> Procrustes Sum of Squares (m12 squared):        0.6185 \n#> Correlation in a symmetric Procrustes rotation: 0.6176 \n#> Significance:  0.019 \n#> \n#> Permutation: free\n#> Number of permutations: 999\n\n## Gr√°fico\nplot(concord, main = \"\", \n     xlab = \"Dimens√£o 1\",\n     ylab = \"Dimens√£o 2\")"},{"path":"cap9.html","id":"m√©todos-multivariados-baseados-em-modelos","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.10 M√©todos multivariados baseados em modelos","text":"Mais recentemente, alguns autores t√™m proposto m√©todos multivariados baseados em modelos. Estes m√©todos t√™m se diversificado hoje em dia e existem pacotes que realizam praticamente todas an√°lises que vimos acima, com diferen√ßa que utilizam distribui√ß√µes de probabilidade dado um modelo (e.g., Poisson) ao inv√©s de coeficientes de dissimilaridades. Vamos exemplificar o uso de um desses m√©todos, mas n√£o vamos fazer uma revis√£o extensiva. Caso o() leitor() deseje conhecer mais, recomendamos consultar principalmente os pacotes gllvm, ecoCopula e Hmsc.Um dos primeiros m√©todos foi proposto em 2012 pelo grupo de David Warton (Warton, Wright, Wang 2012), implementado pacote mvabund. Anteriormente neste mesmo ano foi publicado um artigo pelo mesmo grupo (Wang et al. 2012) em que os autores demonstraram que m√©todos baseados em dissimilaridade, especialmente PERMANOVA, n√£o conseguem modelar adequadamente dados multivariados de contagem (e.g., abund√¢ncia) por n√£o levarem em conta rela√ß√£o monot√¥nica entre m√©dia e vari√¢ncia. Vejamos o que isso quer dizer utilizando os dados artigo de da Silva et al. (2017) (Figura 9.22).\nFigura 9.22: Gr√°fico mostrando m√©dia-vari√¢ncia para dados de abund√¢ncia multivariada.\nEste conjunto de dados cont√©m abund√¢ncias de anf√≠bios coletados num conjunto de cidades interior de S√£o Paulo e tamb√©m sua presen√ßa em museus. Aqui, vemos que h√° uma clara rela√ß√£o monot√¥nica entre m√©dia e vari√¢ncia da abund√¢ncia das esp√©cies na matriz. Ou seja, √† medida que esp√©cies aumentam sua m√©dia de abund√¢ncia, elas tamb√©m aumentam quase que proporcionalmente sua vari√¢ncia. Esta √© uma propriedade bastante comum de dados multivariados de contagem, mas que n√£o √© muito bem modelada por m√©todos baseados em dissimilaridade, j√° que nesse caso apenas esp√©cies mais abundantes t√™m de fato um peso na an√°lise.proposta implementada pacote mvabund √© baseada em Modelos Lineares Generalizados (GLMs) que voc√™ j√° conhece Cap√≠tulo 8. Ou seja, este m√©todo permite que sejam modeladas abund√¢ncias das esp√©cies num contexto multivariado utilizando explicitamente distribui√ß√µes de probabilidade, tais como aquelas que utilizamos (e.g., Poisson, Binomial negativa, etc.). Isso faz com que demos peso semelhante √†s esp√©cies. Vejamos um exemplo de como o modelo √© ajustado e como √© feito teste de hip√≥tese.Exemplo 1A principal pergunta artigo citado acima foi testar se composi√ß√£o de esp√©cies que obtemos em campo e de cole√ß√£o cient√≠ficas √© diferente. Isso tem implica√ß√µes para levantamentos de fauna, j√° que podemos complementar um tipo de dado com outro ou saber se eles s√£o redundantes. Aqui, grupos √© apenas um fator que indica se aquela linha da matriz apresenta dados obtidos em campo ou cole√ß√£o. Vamos testar hip√≥tese nula de que n√£o h√° diferen√ßa na composi√ß√£o entre duas fontes de dados ajustando um modelo com Binomial negativa (Figura 9.23).\nFigura 9.23: Gr√°fico mostrando abund√¢ncias para os dois grupos.\nO gr√°fico mostrando os dados possui log da abund√¢ncia das esp√©cies e o fator (campo vs.¬†cole√ß√£o). Com essa an√°lise explorat√≥ria de dados j√° podemos identificar se h√° diferen√ßa ou n√£o na abund√¢ncia das esp√©cies em cada local. Vemos que algumas esp√©cies s√£o bem mais abundantes campo que em cole√ß√µes, tais como Leptodactylus mystacinus e Rhinella ornata.Uma grande vantagem desse tipo de m√©todo baseado em modelos √© que, assim como um GLM t√≠pico, tamb√©m podemos realizar diagnose dos res√≠duos utilizando plots de res√≠duos versus predito. Vejamos como isso funciona (Figura 9.24).\nFigura 9.24: Diagnose dos res√≠duos modelo ajustado.\nAqui vemos que os dados se distribuem de maneira mais ou menos homog√™nea e sem um padr√£o claro ao redor zero. Isso indica que distribui√ß√£o Binomial negativa foi adequada para modelar estes dados. E agora sim podemos interpretar os resultados com mais seguran√ßa.Interpreta√ß√£o dos resultadosAqui vemos que h√° sim uma diferen√ßa significativa na abund√¢ncia relativa das esp√©cies entre o campo e cole√ß√£o. Mas at√© ent√£o estamos levando em conta toda matriz numa abordagem multivariada. entanto, n√£o sabemos qual() esp√©cie(s) s√£o respons√°veis por este padr√£o. Para investigar isso, podemos realizar uma An√°lise de Deviance separada para cada esp√©cie, isso √© o que linha abaixo faz.Aqui vemos que algumas esp√©cies j√° identificadas plot explorat√≥rio de fato s√£o importantes para determinar o padr√£o, tais como: Leptodactylus mystacinus, Physalaemus nattereri e Rhinella ornata. Essas foram esp√©cies cuja Deviance foi significativa.","code":"\n## Dados com seis primeiras localidades e esp√©cies\nhead(anuros_permanova)[1:6]\n#>                   Chiasmocleis_albopunctata Dendropsophus_elianae Dendropsophus_jimi Dendropsophus_nanus\n#> Araras                                    6                     0                  0                   0\n#> Artur Nogueira                            0                     0                  0                   0\n#> Conchal                                   0                     0                  0                   0\n#> Engenheiro Coelho                         1                     0                  0                   0\n#> Jaguari\\xfana                             8                     0                  0                   0\n#> Limeira                                   0                    11                 15                   0\n#>                   Dendropsophus_minutus Dendropsophus_sanborni\n#> Araras                                1                      0\n#> Artur Nogueira                        6                      0\n#> Conchal                               0                      0\n#> Engenheiro Coelho                     2                      0\n#> Jaguari\\xfana                         0                      0\n#> Limeira                              15                      0\nanuros_abund <- as.data.frame(anuros_permanova[,-28])#retirando a coluna que cont√©m o fator e deixando apenas dados de abund√¢ncia\ngrupos <- factor(anuros_permanova[,28])#incluindo apenas o fator a ser testado no modelo\n\n## M√©dia-vari√¢ncia\nabund_tr <- mvabund(anuros_abund) # criando um objeto da classe mvabund com os dados de abund√¢ncia\nmeanvar.plot(abund_tr)\n## Gr√°fico\nplot(abund_tr ~ grupos, cex.axis = 0.8, cex = 0.8)\n#> \n#>  PIPING TO 2nd MVFACTOR\n\n## Modelo\nmodelo1 <- manyglm(abund_tr ~ grupos, family = \"negative.binomial\")\n## Diagnose\nplot(modelo1)\n## Resultados\nsummary(modelo1)\n#> \n#> Test statistics:\n#>               wald value Pr(>wald)    \n#> (Intercept)       18.947     0.001 ***\n#> gruposCOLECAO      4.727     0.004 ** \n#> --- \n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n#> \n#> Test statistic:  4.727, p-value: 0.004 \n#> Arguments:\n#>  Test statistics calculated assuming response assumed to be uncorrelated \n#>  P-value calculated using 999 resampling iterations via pit.trap resampling (to account for correlation in testing).\n## ANOVA\nanova(modelo1, p.uni = \"adjusted\")\n#> Time elapsed: 0 hr 0 min 6 sec\n#> Analysis of Deviance Table\n#> \n#> Model: abund_tr ~ grupos\n#> \n#> Multivariate test:\n#>             Res.Df Df.diff   Dev Pr(>Dev)   \n#> (Intercept)      8                          \n#> grupos           7       1 94.08     0.01 **\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Univariate Tests:\n#>             Chiasmocleis_albopunctata          Dendropsophus_elianae          Dendropsophus_jimi         \n#>                                   Dev Pr(>Dev)                   Dev Pr(>Dev)                Dev Pr(>Dev)\n#> (Intercept)                                                                                              \n#> grupos                          3.308    0.467                 0.394    0.836               0.23    0.836\n#>             Dendropsophus_nanus          Dendropsophus_minutus          Dendropsophus_sanborni         \n#>                             Dev Pr(>Dev)                   Dev Pr(>Dev)                    Dev Pr(>Dev)\n#> (Intercept)                                                                                            \n#> grupos                    2.197    0.707                 4.752    0.309                  2.197    0.707\n#>             Elachistocleis_cesari          Hypsiboas_albopunctatus          Hypsiboas_faber          Hypsiboas_lundii\n#>                               Dev Pr(>Dev)                     Dev Pr(>Dev)             Dev Pr(>Dev)              Dev\n#> (Intercept)                                                                                                          \n#> grupos                      2.012    0.762                   2.069    0.762           0.913    0.822            0.915\n#>                      Hypsiboas_prasinus          Itapotihyla_langsdorffii          Leptodactylus_fuscus         \n#>             Pr(>Dev)                Dev Pr(>Dev)                      Dev Pr(>Dev)                  Dev Pr(>Dev)\n#> (Intercept)                                                                                                     \n#> grupos         0.822              0.913    0.822                    0.911    0.836                4.652    0.309\n#>             Leptodactylus_latrans          Leptodactylus_mystaceus          Leptodactylus_mystacinus         \n#>                               Dev Pr(>Dev)                     Dev Pr(>Dev)                      Dev Pr(>Dev)\n#> (Intercept)                                                                                                  \n#> grupos                      0.811    0.836                   1.869    0.783                    9.772    0.045\n#>             Physalaemus_centralis          Physalaemus_cuvieri          Physalaemus_marmoratus         \n#>                               Dev Pr(>Dev)                 Dev Pr(>Dev)                    Dev Pr(>Dev)\n#> (Intercept)                                                                                            \n#> grupos                      2.639    0.670               8.221    0.062                  1.622    0.783\n#>             Physalaemus_nattereri          Pseudis_paradoxa          Rhinella_ornata          Rhinella_schneideri         \n#>                               Dev Pr(>Dev)              Dev Pr(>Dev)             Dev Pr(>Dev)                 Dev Pr(>Dev)\n#> (Intercept)                                                                                                               \n#> grupos                     17.131    0.014             2.67    0.540          11.961    0.027               3.363    0.467\n#>             Scinax_fuscomarginatus          Scinax_fuscovarius          Scinax_similis          Trachycephalus_typhonius\n#>                                Dev Pr(>Dev)                Dev Pr(>Dev)            Dev Pr(>Dev)                      Dev\n#> (Intercept)                                                                                                             \n#> grupos                        2.64    0.622              1.655    0.783          2.646    0.622                    1.622\n#>                     \n#>             Pr(>Dev)\n#> (Intercept)         \n#> grupos         0.783\n#> Arguments:\n#>  Test statistics calculated assuming uncorrelated response (for faster computation) \n#> P-value calculated using 999 iterations via PIT-trap resampling."},{"path":"cap9.html","id":"para-se-aprofundar-5","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.11 Para se aprofundar","text":"","code":""},{"path":"cap9.html","id":"livros-3","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.11.1 Livros","text":"Listamos seguir livros e artigos com material que recomendamos para seguir com sua aprendizagem em an√°lises multivariadas em R: ) Legendre & Legendre (2012) Numerical Ecology, ii) Borcard e colaboradores (2018) Numerical Ecology R, iii) Thioulouse e colaboradores (2018) Multivariate Analysis Ecological Data ade4, iv) Ovaskainen & Abrego (2020) Joint Species Distribution Modelling, v) James & McCulloch (1990) Multivariate Analysis Ecology Systematics: Panacea Pandora‚Äôs Box? e vi) Dunstan e colaboradores (2011) Model based grouping species across environmental gradients.","code":""},{"path":"cap9.html","id":"links-4","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.11.2 Links","text":"Existem alguns tutoriais online bem interessantes, mas todos em ingl√™s. Veja lista abaixo:An√°lises de ordena√ß√£o - 1An√°lises de ordena√ß√£o - 2Classifica√ß√£o num√©rica - agrupamento e kmeans","code":""},{"path":"cap9.html","id":"exerc√≠cios-5","chapter":"Cap√≠tulo 9 An√°lises Multidimensionais","heading":"9.12 Exerc√≠cios","text":"9.1\nUtilize os dados ‚Äúmite‚Äù pacote vegan para testar o efeito de vari√°veis ambientais sobre composi√ß√£o de esp√©cies de √°caros utilizando seguintes an√°lises: RDA, RDAp (combinada com MEM), dbRDA e PERMANOVA. Ap√≥s realizar cinco an√°lises, responda √†s seguintes perguntas?. Quais s√£o vari√°veis ambientais (mite.env) mais importantes para composi√ß√£o de √°caros em cada uma das an√°lises?\nB. Os vetores espaciais obtidos com an√°lise MEM explicam varia√ß√£o na composi√ß√£o de esp√©cies? Eles s√£o mais ou menos importantes que vari√°veis ambientais?\nC. Discuta diferen√ßas de interpreta√ß√£o entre RDA, RDAp, dbRDA e PERMANOVA.Dados necess√°rios:9.2\nEfetue uma an√°lise de agrupamento pela fun√ß√£o hclust(). Lembre-se de dar nome ao objeto para poder plotar o dendrograma depois. Utilize ajuda para encontrar como entrar com os argumentos da fun√ß√£o.utilizando o m√©todo UPGMA e o √≠ndice de Bray-Curtis.Fa√ßa agora o dendrograma com outro √≠ndice de dissimilaridade e compare os resultados. S√£o diferentes? que eles influenciar√≠am interpreta√ß√£o resultado?9.3\nNa perspectiva de metacomunidades (Leibold et al., 2004), dispers√£o dos organismos tem um papel proeminente para entender como esp√©cies est√£o distribu√≠das na natureza. Com o objetivo de testar se dispers√£o influencia composi√ß√£o de esp√©cies de clad√≥ceros e cop√©podos, e portanto estrutura da metacomunidade, um pesquisador selecionou dois conjuntos de lagos: em um deles todos os lagos s√£o isolados e outro os lagos s√£o conectados.Importe o conjunto de dados lagos pacote ecodados e responda pergunta se o fato de os lagos estarem conectados ou n√£o influencia composi√ß√£o de esp√©cies desses microcrust√°ceos. Utilize m√©todos baseados em modelos que voc√™ aprendeu ao longo cap√≠tulo para modelar abund√¢ncia multivariada.Importe o conjunto de dados lagos pacote ecodados e responda pergunta se o fato de os lagos estarem conectados ou n√£o influencia composi√ß√£o de esp√©cies desses microcrust√°ceos. Utilize m√©todos baseados em modelos que voc√™ aprendeu ao longo cap√≠tulo para modelar abund√¢ncia multivariada.Fa√ßa um plot mostrando abund√¢ncia relativa das esp√©cies com maior abund√¢ncia e veja se elas s√£o diferentes entre os tipos lagos. Combine este resultado com o item anterior para interpretar o resultado final.Fa√ßa um plot mostrando abund√¢ncia relativa das esp√©cies com maior abund√¢ncia e veja se elas s√£o diferentes entre os tipos lagos. Combine este resultado com o item anterior para interpretar o resultado final.9.4\nCarregue o pacote MASS para utilizar os dados crabs. Este conjunto traz medidas morfol√≥gicas de dois morfo-tipos da esp√©cie de carangueijo Leptograpsus variegatus coletada em Fremantle, Austr√°lia. Calcule uma PCA e veja se existe uma semelhan√ßa morfol√≥gica entre os dois morfo-tipos. Lembre-se de dar nome\nao objeto e use fun√ß√£o biplot() para plotar o resultado teste. Dica: proje√ß√£o de um objeto perpendicular √† seta descritor fornece posi√ß√£o aproximada objeto ao longo desse descritor. dist√¢ncia dos objetos espa√ßo cartesiano reflete dist√¢ncia euclidiana entre eles.Solu√ß√µes dos exerc√≠cios.","code":"\ndata(mite)\ndata(mite.env)\ndata(mite.xy)"},{"path":"cap10.html","id":"cap10","chapter":"Cap√≠tulo 10 Rarefa√ß√£o","heading":"Cap√≠tulo 10 Rarefa√ß√£o","text":"","code":""},{"path":"cap10.html","id":"pr√©-requisitos-do-cap√≠tulo-6","chapter":"Cap√≠tulo 10 Rarefa√ß√£o","heading":"Pr√©-requisitos do cap√≠tulo","text":"Pacotes e dados que ser√£o utilizados nesse cap√≠tulo.","code":"\n## Pacotes\nlibrary(iNEXT)\nlibrary(ecodados)\nlibrary(ggplot2)\nlibrary(vegan)\nlibrary(nlme)\nlibrary(dplyr)\nlibrary(piecewiseSEM)\n\n## Dados\ndata(\"mite\")\ndata(\"mite.xy\")\ncoord <- mite.xy\ncolnames(coord) <- c(\"long\", \"lat\")\ndata(\"mite.env\")\nagua <- mite.env[, 2]\ndados_rarefacao <- ecodados::rarefacao_morcegos\nrarefacao_repteis <- ecodados::rarefacao_repteis\nrarefacao_anuros <- ecodados::rarefacao_anuros\ndados_amostras <- ecodados::morcegos_rarefacao_amostras"},{"path":"cap10.html","id":"aspectos-te√≥ricos-1","chapter":"Cap√≠tulo 10 Rarefa√ß√£o","heading":"10.1 Aspectos te√≥ricos","text":"Uma das grandes dificuldades na compara√ß√£o da riqueza de esp√©cies (n√∫mero de esp√©cies) entre comunidades √© decorrente da diferen√ßa esfor√ßo amostral (e.g.¬†diferen√ßa n√∫mero de indiv√≠duos, discrep√¢ncia na quantidade de unidades amostrais ou √°rea amostrada) que inevitavelmente influenciar√° n√∫mero de esp√©cies observadas (Gotelli Ellison 2012; Roswell, Dushoff, Winfree 2021). O m√©todo de rarefa√ß√£o nos permite comparar o n√∫mero de esp√©cies entre comunidades quando o tamanho da amostra (e.g.¬†n√∫mero de unidades amostrais), o esfor√ßo amostral (e.g.¬†tempo de amostragem) ou n√∫mero de indiv√≠duos n√£o s√£o iguais. rarefa√ß√£o calcula o n√∫mero esperado de esp√©cies em cada comunidade tendo como base comparativa um valor em que todas amostras atinjam um tamanho padr√£o. Gotelli & Colwell (2001) descrevem dois tipos de curvas de rarefa√ß√£o: ) baseada em indiv√≠duos (individual-based) - compara√ß√µes s√£o feitas considerando abund√¢ncia da comunidade padronizada pelo menor n√∫mero de indiv√≠duos, e ii) baseada na amostra (sampled-based) - compara√ß√µes s√£o padronizadas pela comunidade com menor n√∫mero de amostragens.O m√©todo foi formulado considerando seguinte pergunta: Se considerarmos n indiv√≠duos ou amostras (n < N) para cada comunidade, quantas esp√©cies registrar√≠amos nas comunidades considerando o mesmo n√∫mero de indiv√≠duos ou amostras? Gotelli & Colwell (2001) descrevem este m√©todo e discutem em detalhes restri√ß√µes sobre seu uso na ecologia.amostras serem comparadas devem ser consistentes ponto de vista taxon√¥mico, ou seja, todos os indiv√≠duos devem pertencer ao mesmo grupo taxon√¥micoAs compara√ß√µes devem ser realizadas somente entre amostras com mesmas t√©cnicas de coleta. Por exemplo, n√£o √© recomendado comparar amostras onde riqueza de esp√©cies de anuros de uma amostra foi estimada utilizando armadilhas de intercepta√ß√£o e queda e outra foi estimada por vocaliza√ß√µes em s√≠tios de reprodu√ß√£oOs tipos de h√°bitat onde amostras s√£o obtidas devem ser semelhantes√â um m√©todo para estimar riqueza de esp√©cies em uma amostra menor ‚Äì n√£o pode ser usado para extrapolar riqueza para amostras maiores üìù Importante \nEsta √∫ltima restri√ß√£o foi superada por Colwell et al. (2012) e Chao & Jost (2012), que desenvolveram uma nova abordagem onde os dados podem ser interpolados (rarefeito) para amostras menores e extrapolados para amostras maiores. Al√©m disso, Chao & Jost (2012) prop√µem curva de rarefa√ß√£o coverage-based que padroniza amostras pela cobertura ou totalidade (completeness) da amostra ao inv√©s tamanho. rarefa√ß√µes tradicionais apresentam limita√ß√µes matem√°ticas que s√£o superadas por essa nova abordagem (Chao Jost 2012).","code":""},{"path":"cap10.html","id":"curva-de-rarefa√ß√£o-baseada-no-indiv√≠duo-individual-based","chapter":"Cap√≠tulo 10 Rarefa√ß√£o","heading":"10.2 Curva de rarefa√ß√£o baseada no indiv√≠duo (individual-based)","text":"Exemplo pr√°tico 1 - MorcegosExplica√ß√£o dos dadosUsaremos os dados de esp√©cies de morcegos amostradas em tr√™s fragmentos florestais (Breviglieri 2008): ) Mata Ciliar C√≥rrego Talhadinho com 12 hectares, ii) Mata Ciliar C√≥rrego dos Tenentes com 10 hectares, e iii) Fazenda Experimental de Pindorama com 128 hectares.PerguntaA riqueza de esp√©cies de morcegos √© maior na Fazenda Experimental que nos fragmentos florestais menores?Predi√ß√µesO n√∫mero de esp√©cies ser√° maior em fragmentos florestais maioresVari√°veisVari√°veis resposta e preditorasVari√°veis resposta e preditorasMatriz ou data frame com abund√¢ncias das esp√©cies de morcegos (vari√°vel resposta) registradas nos tr√™s fragmentos florestais (vari√°vel preditora)Matriz ou data frame com abund√¢ncias das esp√©cies de morcegos (vari√°vel resposta) registradas nos tr√™s fragmentos florestais (vari√°vel preditora)ChecklistVerificar se sua matriz ou data frame est√£o com esp√©cies nas linhas e os fragmentos florestais nas colunasAn√°liseVamos olhar os dados usando fun√ß√£o head().Usaremos fun√ß√µes pacote iNEXT (iNterpolation e EXTrapolation) para o c√°lculo da rarefa√ß√£o (Hsieh, Ma, Chao 2016). Esta fun√ß√£o permite estimar riqueza de esp√©cies utilizando fam√≠lia Hill-numbers (Hill 1973; explica√ß√£o dos conceitos da fam√≠lia Hill-numbers est√° detalhada Cap√≠tulo 12. O argumento q refere-se fam√≠lia Hill-numbers onde: 0 = riqueza de esp√©cies, 1 = diversidade de Shannon e 2 = diversidade de Simpson. exemplo abaixo, utilizamos somente q = 0.Vamos visualizar os resultados (Figura 10.1).\nFigura 10.1: Curvas de rarefa√ß√£o baseada nos indiv√≠duos de morcegos.\nInterpreta√ß√£o dos resultadosForam registrados 166 indiv√≠duos na MC_Tenentes, 413 na MC_Talhadinho e 223 na FF_Experimental. Lembrando, voc√™ n√£o pode comparar riqueza de esp√©cies observada diretamente: 15 esp√©cies na MC_Tenentes, 19 esp√©cies na MC_Talhadinho, e 17 esp√©cies FF_Experimental. compara√ß√£o da riqueza de esp√©cies entre comunidades deve ser feita com base na riqueza de esp√©cies rarefeita, que √© calculada com base n√∫mero de indiv√≠duos da comunidade com menor abund√¢ncia (166 indiv√≠duos - linha preta tracejada). Olhando o gr√°fico √© poss√≠vel perceber que riqueza de esp√©cies de morcegos rarefeita n√£o √© diferente entre os tr√™s fragmentos florestais quando corrigimos o problema da diferen√ßa na abund√¢ncia pela rarefa√ß√£o. interpreta√ß√£o √© feita com base intervalo de confian√ßa de 95%. curvas ser√£o diferentes quando os intervalos de confian√ßa n√£o se sobreporem (Chao et al. 2014). Percebam que esta abordagem, al√©m da interpola√ß√£o (rarefa√ß√£o), tamb√©m realiza extrapola√ß√µes que podem ser usadas para estimar o n√∫mero de esp√©cies caso o esfor√ßo de coleta fosse maior. Este √© o assunto Cap√≠tulo 11.Exemplo pr√°tico 2 - Anuros e R√©pteisExplica√ß√£o dos dadosNeste exemplo, iremos comparar o n√∫mero de esp√©cies de anuros e r√©pteis (serpentes e lagartos) usando informa√ß√µes dos indiv√≠duos depositados em cole√ß√µes cient√≠ficas e coletas de campo (da Silva et al. 2017).PerguntaA riqueza de esp√©cies estimada para uma mesma regi√£o √© maior usando informa√ß√µes de cole√ß√µes cient√≠ficas que informa√ß√µes de coletas de campo?Predi√ß√µesO n√∫mero de esp√©cies ser√° maior em cole√ß√µes cient√≠ficas devido ao maior esfor√ßo amostral (.e.¬†maior varia√ß√£o temporal para depositar os indiv√≠duos e maior n√∫mero de pessoas contribuindo com coletas espor√°dicas)Vari√°veisVari√°veis resposta e preditorasVari√°veis resposta e preditorasMatriz ou data frame com abund√¢ncias das esp√©cies de anuros e r√©pteis (vari√°vel resposta) registradas em cole√ß√µes cient√≠ficas e coletas de campo (vari√°vel preditora)Matriz ou data frame com abund√¢ncias das esp√©cies de anuros e r√©pteis (vari√°vel resposta) registradas em cole√ß√µes cient√≠ficas e coletas de campo (vari√°vel preditora)ChecklistVerificar se sua matriz ou data frame est√£o com esp√©cies nas linhas e fonte dos dados nas colunasAn√°liseOlhando os dados dos r√©pteis.An√°lise usando o pacote iNEXT (Figura 10.2).\nFigura 10.2: Curvas de rarefa√ß√£o baseada nos indiv√≠duos de r√©pteis.\nInterpreta√ß√£o dos resultadosForam registradas oito esp√©cies de r√©pteis nas coletas de campo (48 indiv√≠duos) e 28 esp√©cies nas cole√ß√µes cient√≠ficas (77 indiv√≠duos). Com base na rarefa√ß√£o, conclu√≠mos que riqueza de esp√©cies de r√©pteis obtida nas cole√ß√µes cient√≠ficas (20,5) √© 2,9 vezes maior que obtida em coletas de campo (7,05).Olhando os dados dos anuros.An√°lise e visualiza√ß√£o gr√°fico (Figura 10.3).\nFigura 10.3: Curvas de rarefa√ß√£o baseada nos indiv√≠duos de anuros.\nInterpreta√ß√£o dos resultados - anurosForam registradas 21 esp√©cies de anuros nas coletas de campo (675 indiv√≠duos) e 12 esp√©cies nas cole√ß√µes cient√≠ficas (37 indiv√≠duos). Com base na rarefa√ß√£o, conclu√≠mos que n√£o h√° diferen√ßa entre riqueza de esp√©cies de anuros obtida em coletas de campo e cole√ß√µes cient√≠ficas.","code":"\n## Cabe√ßalho dos dados\nhead(dados_rarefacao)\n#>                       MC_Tenentes MC_Talhadinho FF_Experimental\n#> Chrotopterus_auritus            0             1               1\n#> Phyllostomus_hastatus           0             1               0\n#> Phyllostomus_discolor           0             2               2\n#> Artibeus_lituratus             17            26              26\n#> Artibeus_obscurus               1             4               6\n#> Artibeus_planirostris          34            72              52\n\n## N√∫mero de indiv√≠duos por local\ncolSums(dados_rarefacao)\n#>     MC_Tenentes   MC_Talhadinho FF_Experimental \n#>             166             413             223\n## Rarefa√ß√£o\n# Datatype refere-se ao tipo de dados que voc√™ vai analisar (e.g. abund√¢ncia, incid√™ncia).\n# Endpoint refere-se ao valor m√°ximo que voc√™ determina para a extrapola√ß√£o.\nresultados_morcegos <- iNEXT(dados_rarefacao, q = 0, \n                             datatype = \"abundance\", endpoint = 800)\n## Gr√°fico\n# type define o tipo de curva de rarefa√ß√£o\n# 1 = curva de rarefa√ß√£o baseada no indiv√≠duo ou amostra\n# 2 = curva de representatividade da amostra\n# 3 = curva de rarefa√ß√£o baseada na representatividade (coverage-based)\n\nggiNEXT(resultados_morcegos, type = 1) +\n    geom_vline(xintercept = 166, lty = 2) +\n    scale_linetype_discrete(labels = c(\"Interpolado\", \"Extrapolado\")) +\n    scale_colour_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    scale_fill_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    labs(x = \"N√∫mero de indiv√≠duos\", y = \" Riqueza de esp√©cies\") +\n    tema_livro()\n## Cabe√ßalho\nhead(rarefacao_repteis)\n#>                         Coleta.Campo Colecoes.Cientificas\n#> Ameiva_ameiva                      1                    0\n#> Amphisbaena_mertensii              1                    0\n#> Apostolepis_dimidiata              0                    1\n#> Bothrops__itapetiningae            0                    2\n#> Bothrops__pauloensis               0                    1\n#> Bothrops_alternatus                0                    1\n## An√°lise\nresultados_repteis <- iNEXT(rarefacao_repteis, q = 0,\n                            datatype = \"abundance\", \n                            endpoint = 200)\n\n## Visualizar os resultados\nggiNEXT(resultados_repteis, type = 1) +\n    geom_vline(xintercept = 48, lty = 2) +\n    scale_linetype_discrete(labels = c(\"Interpolado\", \"Extrapolado\")) +\n    scale_colour_manual(values = c(\"darkorange\", \"cyan4\")) +\n    scale_fill_manual(values = c(\"darkorange\", \"cyan4\")) +\n    labs(x = \"N√∫mero de indiv√≠duos\", y = \" Riqueza de esp√©cies\") +\n    tema_livro()\n## Cabe√ßalho\nhead(rarefacao_anuros)\n#>                           Coleta.Campo Colecoes.Cientificas\n#> Chiasmocleis_albopunctata           15                    0\n#> Dendropsophus_elianae               11                    1\n#> Dendropsophus_jimi                  15                    2\n#> Dendropsophus_nanus                  0                    1\n#> Dendropsophus_minutus               24                    0\n#> Dendropsophus_sanborni               0                    1\n## An√°lise\nresultados_anuros <- iNEXT(rarefacao_anuros, q = 0, \n                           datatype = \"abundance\", endpoint = 800)\n\n## Visualizar os resultados\nggiNEXT(resultados_anuros, type = 1) + \n    geom_vline(xintercept = 37, lty = 2) +\n    scale_linetype_discrete(labels = c(\"Interpolado\", \"Extrapolado\")) +\n    scale_colour_manual(values = c(\"darkorange\", \"cyan4\")) +\n    scale_fill_manual(values = c(\"darkorange\", \"cyan4\")) +\n    labs(x = \"N√∫mero de indiv√≠duos\", y = \" Riqueza de esp√©cies\") +\n    tema_livro()"},{"path":"cap10.html","id":"curva-de-rarefa√ß√£o-baseada-em-amostras-sample-based","chapter":"Cap√≠tulo 10 Rarefa√ß√£o","heading":"10.3 Curva de rarefa√ß√£o baseada em amostras (sample-based)","text":"Exemplo pr√°tico 3 - MorcegosExplica√ß√£o dos dadosUsaremos os mesmos dados de esp√©cies de morcegos amostradas em tr√™s fragmentos florestais (Breviglieri 2008). Contudo, ao inv√©s de padronizarmos riqueza de esp√©cies pela abund√¢ncia, iremos padronizar pelo n√∫mero de amostras.Vari√°veisVari√°veis resposta e preditorasVari√°veis resposta e preditorasLista de vetores. Cada vetor deve conter como primeira informa√ß√£o o n√∫mero total de amostras (vari√°vel preditora), seguido da frequ√™ncia de ocorr√™ncia das esp√©cies (.e.¬†n√∫mero de amostras em que cada esp√©cie foi registrada - vari√°vel resposta)Lista de vetores. Cada vetor deve conter como primeira informa√ß√£o o n√∫mero total de amostras (vari√°vel preditora), seguido da frequ√™ncia de ocorr√™ncia das esp√©cies (.e.¬†n√∫mero de amostras em que cada esp√©cie foi registrada - vari√°vel resposta)ChecklistVerificar se sua lista est√° com o n√∫mero total de amostras e frequ√™ncia de ocorr√™ncia das esp√©ciesAn√°liseVamos olhar os dados.Vamos criar uma lista com amostragens de cada comunidade e os c√≥digos da an√°lise.Visualizar os resultados (Figura 10.4).\nFigura 10.4: Curvas de rarefa√ß√£o baseada em amostras de morcegos.\nInterpreta√ß√£o dos resultadosOlhando o gr√°fico √© poss√≠vel perceber que riqueza de esp√©cies de morcegos rarefeita n√£o √© diferente entre os tr√™s fragmentos florestais, quando corrigimos o problema da diferen√ßa n√∫mero de amostras.","code":"\n## Cabe√ßalho\nhead(dados_amostras)\n#>          MC_Tenentes MC_Talhadinho FF_Experimental\n#> amostras          12            20              12\n#> sp1               12            20              12\n#> sp2               12            19              10\n#> sp3               10            15               8\n#> sp4                8            10               8\n#> sp5                6             7               7\n## Dados\n# Usamos [,] para excluir os NAs. Lembrando que valores antes da \n# v√≠rgula representam as linhas e os posteriores representam as colunas.\nlista_rarefacao <- list(Tenentes = dados_amostras[1:18, 1],\n                        Talhadinho = dados_amostras[, 2],\n                        Experimental = dados_amostras[1:16, 3])\n\n## An√°lise\nres_rarefacao_amostras <- iNEXT(lista_rarefacao, q = 0, \n                                datatype = \"incidence_freq\")\n## Gr√°fico\nggiNEXT(res_rarefacao_amostras , type = 1, color.var = \"site\") + \n    geom_vline(xintercept = 12, lty = 2) +\n    scale_linetype_discrete(name = \"M√©todo\", labels = c(\"Interpolado\", \"Extrapolado\")) +\n    scale_colour_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    scale_fill_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    labs(x = \"N√∫mero de amostras\", y = \" Riqueza de esp√©cies\") +\n    tema_livro()"},{"path":"cap10.html","id":"curva-de-rarefa√ß√£o-coverage-based","chapter":"Cap√≠tulo 10 Rarefa√ß√£o","heading":"10.4 Curva de rarefa√ß√£o coverage-based","text":"Exemplo pr√°tico 4 - MorcegosExplica√ß√£o dos dadosNeste exemplo, usaremos os mesmos dados de esp√©cies de morcegos amostradas em tr√™s fragmentos florestais (Breviglieri 2008).An√°liseOs c√≥digos para realiza√ß√£o da rarefa√ß√£o coverage-based s√£o id√™nticos aos utilizados para o c√°lculo das curvas de rarefa√ß√µes baseadas nas abund√¢ncias e amostras. Portanto, n√£o repetiremos linhas de c√≥digo aqui e utilizaremos os resultados j√° calculados para visualiza√ß√£o dos gr√°ficos. Para isso, digitamos type = 3 que representa curva de rarefa√ß√£o coverage-based (Figura 10.5).\nFigura 10.5: Curvas de rarefa√ß√£o baseada coverage-based de morcegos.\nInterpreta√ß√£o dos resultadosCoverage √© uma medida que determina propor√ß√£o de amostras (sampled-based) ou n√∫mero de indiv√≠duos (abundance-based) da comunidade que representa esp√©cies presentes na amostra. Um valor de coverage = 0,85 representa riqueza estimada com base em 85% das amostragens ou da abund√¢ncia da comunidade. nosso exemplo, os valores de coverage foram acima de 0,93, indicando que precisamos de praticamente todas amostras para estimar riqueza observada em cada comunidade. Comparando comunidades considerando o mesmo valor de coverage 0,937 na comunidade Tenentes, identificamos que riqueza de esp√©cies de morcegos estimada na comunidade Experimental √© menor que estimada para comunidade de Talhadinho (n√£o h√° sobreposi√ß√£o intervalo de confian√ßa). Percebam que usando curva de rarefa√ß√£o coverage-based, interpreta√ß√£o dos resultados foi diferente das observadas usando curvas baseadas nos indiv√≠duos ou amostras. Veja Chao & Jost (2012) e Roswell et al. (2021) para explica√ß√µes mais detalhadas sobre esta metodologia.Exemplo pr√°tico 5 - Generalized Least Squares (GLS)Explica√ß√£o dos dadosNeste exemplo, iremos refazer o exerc√≠cio Cap√≠tulo 7 onde usamos Generalized Least Squares (GLS) para testar rela√ß√£o da riqueza de √°caros com quantidade de √°gua substrato. Contudo, ao inv√©s de considerar riqueza de esp√©cies de √°caros observada como vari√°vel resposta, iremos utilizar riqueza rarefeita para controlar o efeito da amostragem (.e.¬†diferentes abund√¢ncias entre comunidades). Os dados que usaremos est√£o dispon√≠veis pacote vegan e representam composi√ß√£o de esp√©cies de √°caros amostradas em 70 amostras.PerguntaA riqueza rarefeita de esp√©cies de √°caros √© maior em comunidades localizadas em √°reas com substratos secos?Predi√ß√µesO n√∫mero de esp√©cies rarefeita ser√° maior em substratos secos, uma vez que limita√ß√µes fisiol√≥gicas impostas pela umidade limitam ocorr√™ncia de v√°rias esp√©cies de √°carosVari√°veisVari√°veis resposta e preditorasVari√°veis resposta e preditorasMatriz ou data frame com abund√¢ncias das esp√©cies de √°caros (vari√°vel resposta) registradas em 70 comunidades (vari√°vel preditora)Matriz ou data frame com abund√¢ncias das esp√©cies de √°caros (vari√°vel resposta) registradas em 70 comunidades (vari√°vel preditora)ChecklistVerificar se sua matriz ou data frame est√£o com esp√©cies nas linhas e comunidades nas colunasAn√°liseVamos calcular riqueza rarefeita com base na comunidade com menor abund√¢ncia.Vamos calcular riqueza rarefeita de esp√©cies para todas comunidades considerando menor abund√¢ncia.Para padronizar e facilitar extra√ß√£o dos resultados, definimos os argumentos knots (.e.¬†representa o intervalo igualmente espa√ßado que fun√ß√£o ir√° utilizar para determinar riqueza estimada) e endpoint (.e.¬†o valor final de amostras ou abund√¢ncia extrapolados) com o valor de abund√¢ncia = 8.Lembrando, estamos interessados valor rarefeito considerando abund√¢ncia de 8 indiv√≠duos. Esta informa√ß√£o est√° armazenada na linha 8 e na coluna 4 dos data frames salvos objeto resultados_rarefa√ß√£o$iNextEst. Assim, para obtermos o valor rarefeito de interesse, vamos criar um loop para facilitar extra√ß√£o da riqueza rarefeita para 70 comunidades.Vamos juntar esses resultados com os dados geogr√°ficos e ambientais.Agora, seguindo os passos descritos Cap√≠tulo 7, vamos identificar o melhor modelo que representa estrutura espacial dos dados da riqueza rarefeita.Agora vamos usar sele√ß√£o de modelo por AIC para selecionar o modelo mais ‚Äúprov√°vel‚Äù explicando distribui√ß√£o da riqueza rarefeita das esp√©cies de √°caros (Figura 10.6).\nFigura 10.6: Visualiza√ß√£o dos res√≠duos modelo selecionado.\nPercebam que os pontos est√£o dispersos gr√°fico e n√£o apresentam padr√µes que indiquem heterogeneidade de vari√¢ncia (Figura 10.7).\nFigura 10.7: Gr√°fico modelo GLS selecionado.\nInterpreta√ß√£o dos resultadosA concentra√ß√£o de √°gua substrato explica 29,9% da varia√ß√£o na riqueza rarefeita das esp√©cies de √°caros. Como predito, riqueza de esp√©cies de √°caros foi maior em comunidades localizadas em √°reas com substratos secos que em √°reas com substratos √∫midos (t = -4.71, df = 68, P < 0.01).","code":"\n## Gr√°fico\n# Visualizar os resultados da rarefa√ß√£o *coverage-based*. \nggiNEXT(res_rarefacao_amostras, type = 3, color.var = \"site\") + \n    geom_vline(xintercept = 0.937, lty = 2) +\n    scale_linetype_discrete(labels = c(\"Interpolado\", \"Extrapolado\")) +\n    scale_colour_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    scale_fill_manual(values = c(\"darkorange\", \"darkorchid\", \"cyan4\")) +\n    labs(x = \"Representatividade nas amostras\", y = \"Riqueza de esp√©cies\") +\n    tema_livro()\n## Menos abund√¢ncia\n# Os dados est√£o com as comunidades nas colunas e as esp√©cies nas linhas. \n# Para as an√°lises teremos que transpor a planilha.\ncomposicao_acaros <- t(mite)\n\n# Verificar qual √© a menor abund√¢ncia registrada nas comunidades. \nabun_min <- min(colSums(composicao_acaros))\n## Riqueza rarefeita\nresultados_rarefacao <- iNEXT(composicao_acaros, q = 0, \n                              datatype = \"abundance\", \n                              knots = abun_min,\n                              endpoint = abun_min)\n## Riqueza rarefeita para cada comunidade\nriqueza_rarefeita <- c()\n\nfor (i in 1:70) {\n  resultados_comunidades <- resultados_rarefacao$iNextEst[[i]]\n  subset_res <- resultados_comunidades %>% dplyr::filter(m==abun_min)\n  riqueza_rarefeita[i] <- subset_res$qD\n}\n## Dados finais\n# Agrupando os dados em um data frame final.\ndados_combinado <- data.frame(riqueza_rarefeita, agua, coord)\n## Criando diferentes modelos usando a fun√ß√£o gls\n## Sem estrutura espacial\nno_spat_gls <- gls(riqueza_rarefeita ~ agua, data = dados_combinado, \n                   method = \"REML\")\n\n## Covari√¢ncia esf√©rica \nespher_model <- gls(riqueza_rarefeita ~ agua, data = dados_combinado, \n                    corSpher(form = ~lat + long, nugget = TRUE))\n\n## Covari√¢ncia exponencial \nexpon_model <- gls(riqueza_rarefeita ~ agua, data = dados_combinado, \n                   corExp(form = ~lat + long, nugget = TRUE))\n\n## Covari√¢ncia Gaussiana \ngauss_model <- gls(riqueza_rarefeita ~ agua, data = dados_combinado, \n                   corGaus(form = ~lat + long, nugget = TRUE))\n\n## Covari√¢ncia raz√£o quadr√°tica \nratio_model <- gls(riqueza_rarefeita ~ agua, data = dados_combinado, \n                   corRatio(form = ~lat + long, nugget = TRUE))\n## Sele√ß√£o dos modelos\naic_fit <- AIC(no_spat_gls, espher_model, expon_model, \n               gauss_model, ratio_model)\naic_fit %>% arrange(AIC)\n#>   df      AIC\n#> 1  5 164.5840\n#> 2  5 165.7649\n#> 3  5 165.8698\n#> 4  3 166.7530\n#> 5  5 169.0242\n\n## Visualizando os res√≠duos do modelo selecionado\nplot(gauss_model)\n## Visualizando os resultados\nsummary(gauss_model)$tTable \n#>                    Value    Std.Error   t-value      p-value\n#> (Intercept)  6.086125990 0.2927633293 20.788553 3.550849e-31\n#> agua        -0.003142615 0.0006670097 -4.711498 1.258304e-05\n\n## Calculando o R-squared\nrsquared(gauss_model)\n#>            Response   family     link method R.squared\n#> 1 riqueza_rarefeita gaussian identity   none 0.2991059\n\n## Obtendo os valores preditos pelo modelo\npredito <- predict(gauss_model) \n\n## Plotando os resultados no gr√°fico\nggplot(data = dados_combinado, aes(x= agua, y= riqueza_rarefeita)) + \n    geom_point(size = 4, shape = 21, fill = \"gray\", alpha = 0.7) +\n    geom_line(aes(y = predito), size = 1) +\n    labs(x = \"Concentra√ß√£o de √°gua no substrato\", \n         y = \"Riqueza rarefeita \\ndas esp√©cies de √°caros\") +\n    tema_livro()"},{"path":"cap10.html","id":"para-se-aprofundar-6","chapter":"Cap√≠tulo 10 Rarefa√ß√£o","heading":"10.5 Para se aprofundar","text":"","code":""},{"path":"cap10.html","id":"livros-4","chapter":"Cap√≠tulo 10 Rarefa√ß√£o","heading":"10.5.1 Livros","text":"Recomendamos o livro Biological Diversity Frontiers Measurement Assessment (Magurran McGill 2011)","code":""},{"path":"cap10.html","id":"links-5","chapter":"Cap√≠tulo 10 Rarefa√ß√£o","heading":"10.5.2 Links","text":"Recomendamos tamb√©m que acessem p√°gina EstimateS software e baixem o manual usu√°rio que cont√©m informa√ß√µes detalhadas sobre os √≠ndices de rarefa√ß√£o. Este site foi criado e √© mantido pelo Dr.¬†Robert K. Colwell, um dos maiores especialistas mundo em estimativas da biodiversidadeRecomendamos tamb√©m que acessem p√°gina EstimateS software e baixem o manual usu√°rio que cont√©m informa√ß√µes detalhadas sobre os √≠ndices de rarefa√ß√£o. Este site foi criado e √© mantido pelo Dr.¬†Robert K. Colwell, um dos maiores especialistas mundo em estimativas da biodiversidadeRecomendamos p√°gina pessoal da pesquisadora Anne Chao que √© uma das respons√°veis pelo desenvolvimento da metodologia e pacote iNEXT. Nesta p√°gina, voc√™s ir√£o encontrar exemplos e explica√ß√µes detalhadas sobre an√°lisesRecomendamos p√°gina pessoal da pesquisadora Anne Chao que √© uma das respons√°veis pelo desenvolvimento da metodologia e pacote iNEXT. Nesta p√°gina, voc√™s ir√£o encontrar exemplos e explica√ß√µes detalhadas sobre an√°lises","code":""},{"path":"cap10.html","id":"exerc√≠cios-6","chapter":"Cap√≠tulo 10 Rarefa√ß√£o","heading":"10.6 Exerc√≠cios","text":"10.1\nUsando os dados Cap10_exercicio1 dispon√≠vel pacote ecodados, avalie se diferentes tipos de uso da terra (fragmento florestal, borda de mata, √°rea de pastagem e cana de a√ß√∫car) apresentam diferentes riquezas de esp√©cies? Qual sua interpreta√ß√£o? Fa√ßa um gr√°fico com os resultados.10.2\nO estudo √© o mesmo exerc√≠cio anterior. Contudo, ao inv√©s da rarefa√ß√£o baseada na abund√¢ncia, fa√ßa rarefa√ß√µes baseadas n√∫mero de amostras. Qual sua interpreta√ß√£o considerando os resultados exerc√≠cio 1? Fa√ßa um gr√°fico com os resultados.10.3\nUse os dados dos exerc√≠cios anteriores e calcule rarefa√ß√£o baseada na cobertura de amostragem (coverage-based). Qual sua interpreta√ß√£o considerando os resultados anteriores? Fa√ßa um gr√°fico com os resultados.Solu√ß√µes dos exerc√≠cios.","code":""},{"path":"cap11.html","id":"cap11","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"Cap√≠tulo 11 Estimadores de riqueza","text":"","code":""},{"path":"cap11.html","id":"pr√©-requisitos-do-cap√≠tulo-7","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"Pr√©-requisitos do cap√≠tulo","text":"Pacotes e dados que ser√£o utilizados nesse cap√≠tulo.","code":"\n## Pacotes\nlibrary(iNEXT)\nlibrary(devtools)\nlibrary(ecodados)\nlibrary(ggplot2)\nlibrary(vegan)\nlibrary(nlme)\nlibrary(dplyr)\nlibrary(piecewiseSEM)\n\n## Dados\ndados_coleta <- poca_anuros\ndata(mite)\ndata(mite.xy)\ncoord <- mite.xy\ncolnames(coord) <- c(\"long\", \"lat\") # altera o nome das colunas\ndata(mite.env)\nagua <- mite.env[, 2] # seleciona a vari√°vel de interesse"},{"path":"cap11.html","id":"aspectos-te√≥ricos-2","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.1 Aspectos te√≥ricos","text":"Uma vez que determinar o n√∫mero total de esp√©cies numa √°rea √© praticamente imposs√≠vel, principalmente em regi√µes com alta riqueza de esp√©cies, os estimadores s√£o √∫teis para extrapolar riqueza observada e tentar estimar riqueza total atrav√©s de uma amostra incompleta de uma comunidade biol√≥gica (Walther Moore 2005). Neste cap√≠tulo, ser√£o considerados os estimadores n√£o param√©tricos que usam informa√ß√µes da frequ√™ncia de esp√©cies raras na comunidade (Gotelli Chao 2013). Isto porque tanto os testes param√©tricos que tentam determinar os par√¢metros de uma curva usando o formato da curva de acumula√ß√£o de esp√©cies (e.g.¬†equa√ß√£o log√≠stica, Michaelis-Menten), quanto os testes que usam frequ√™ncia n√∫mero de indiv√≠duos para enquadr√°-las em uma das distribui√ß√µes de abund√¢ncia das esp√©cies (e.g.¬†distribui√ß√µes log-s√©ries, log-normal) n√£o funcionam muito bem com dados emp√≠ricos (Gotelli Chao 2013). Para mais detalhes sobre os testes param√©tricos veja Magurran & McGill (2011) e Colwell & Coddington (1994).Para que estimador de riqueza seja considera bom, ele precisa atender quatro caracter√≠sticas (Chazdon et al. 1998; Hortal, Borges, Gaspar 2006).Independ√™ncia tamanho da amostra (quantidade de esfor√ßo amostral realizado)Insensibilidade diferentes padr√µes de distribui√ß√µes (e.g.¬†agrupado, disperso ou aleat√≥rio)Insensibilidade em rela√ß√£o √† ordem das amostragensInsensibilidade √† heterogeneidade entre amostras usadas entre os estudos","code":""},{"path":"cap11.html","id":"estimadores-baseados-na-abund√¢ncia-das-esp√©cies","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.2 Estimadores baseados na abund√¢ncia das esp√©cies","text":"","code":""},{"path":"cap11.html","id":"chao-1","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.2.1 CHAO 1","text":"Estimador simples n√∫mero absoluto de esp√©cies em uma comunidade. √â baseado n√∫mero de esp√©cies raras dentro de uma amostra (Chao 1984, 1987).\\[Chao_{1} = S_{obs} + \\left(\\frac{n-1}{n}\\right)\\frac{F_1(F_1-1)}{2(F_2+1)}\\]onde:Sobs = n√∫mero de esp√©cies observadas na comunidaden = n√∫mero de amostrasF1 = n√∫mero de esp√©cies observadas com abund√¢ncia de um indiv√≠duo (esp√©cies singleton)F2 = n√∫mero de esp√©cies observadas com abund√¢ncia de dois indiv√≠duos (esp√©cies doubletons)O valor de Chao 1 √© m√°ximo quando todas esp√©cies menos uma s√£o √∫nicas (singleton). Neste caso, riqueza estimada √© aproximadamente o dobro da riqueza observada.Exemplo pr√°ticoExplica√ß√£o dos dadosUsaremos os dados hipot√©ticos de 17 esp√©cies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na regi√£o noroeste estado de S√£o Paulo, Brasil.PerguntaQuantas esp√©cies mais poderiam ser amostradas caso aument√°ssemos o esfor√ßo amostral at√© o infinito?Predi√ß√µesO n√∫mero de esp√©cies estimadas √© similar ao n√∫mero de esp√©cies observadasO n√∫mero de esp√©cies estimadas √© maior que o n√∫mero de esp√©cies observadasVari√°veisVari√°veis resposta e preditoraVari√°veis resposta e preditoradata frame com abund√¢ncias das esp√©cies de anuros (vari√°vel resposta) registradas em 14 dias de amostragens (vari√°vel preditora) em um habitat reprodutivodata frame com abund√¢ncias das esp√©cies de anuros (vari√°vel resposta) registradas em 14 dias de amostragens (vari√°vel preditora) em um habitat reprodutivoChecklistVerificar se sua matriz est√° com esp√©cies nas colunas e amostragens nas linhasVerificar se os dados s√£o de abund√¢ncia e n√£o de incid√™ncia (presen√ßa e aus√™ncia)An√°liseVamos olhar os dados.C√°lculo estimador de riqueza - Chao 1.Percebam que fun√ß√£o retorna: N = n√∫mero de amostragens, Chao = valor m√©dio da estimativa √≠ndice de Chao, 2.5% e 97.5% = intervalo de confian√ßa de 95%, e Std.Dev = desvio padr√£o. Essas dados s√£o obtidos usando permuta√ß√µes, sem reposi√ß√£o, que alteram ordem das amostragens. Neste exemplo, usamos 100 permuta√ß√µes.Vamos visualizar os resultados com intervalo de confian√ßa de 95% (Figura 11.1).\nFigura 11.1: Resultados com intervalo de confian√ßa de 95% para o estimador Chao 1.\nInterpreta√ß√£o dos resultadosCom base n√∫mero de esp√©cies raras (singletons e doubletons), o estimador Chao 1 indicou possibilidade de encontrarmos mais tr√™s esp√©cies, caso o esfor√ßo amostral fosse maior e n√£o estima tend√™ncia de estabiliza√ß√£o da curva em uma ass√≠ntota.","code":"\n## Cabe√ßalho\nhead(poca_anuros)\n#>       Boana_albopunctata Boana_faber Boana_raniceps Dendropsophus_eliane Dendropsophus_melanargyrius Dendropsophus_minutus\n#> Dia_1                  5           0              2                    0                           0                     0\n#> Dia_2                  0           0              0                    0                           0                     2\n#> Dia_3                  0           0              0                    6                           0                     1\n#> Dia_4                  0           0              0                   15                           0                    15\n#> Dia_5                  0           0              0                    2                           1                     8\n#> Dia_6                  1           0              0                    2                           0                     2\n#>       Dendropsophus_nanus Dermatonotus_muelleri Elachistocleis_bicolor Elachistocleis_sp Leptodactylus_chaquensis\n#> Dia_1                   4                     0                      0                 0                        0\n#> Dia_2                   0                     0                      0                 0                        0\n#> Dia_3                   3                     0                      0                 0                        0\n#> Dia_4                  15                     3                      0                 0                        0\n#> Dia_5                   2                    12                      0                 0                       11\n#> Dia_6                   2                     0                      0                 0                        0\n#>       Leptodactylus_fuscus Leptodactylus_labyrinthicus Physalameus_cuvieri Physalaemus_nattereri Rhinella_schneideri\n#> Dia_1                    8                           0                   5                     0                   2\n#> Dia_2                    3                           0                   3                     4                   1\n#> Dia_3                    2                           0                   4                     1                   2\n#> Dia_4                    5                           0                   2                     0                   2\n#> Dia_5                    4                           0                   2                    17                   1\n#> Dia_6                    2                           0                   2                     0                   1\n#>       Scinax_fuscovarius\n#> Dia_1                  0\n#> Dia_2                  0\n#> Dia_3                  0\n#> Dia_4                  0\n#> Dia_5                  0\n#> Dia_6                  0\n## An√°lise\nest_chao1 <- estaccumR(dados_coleta, permutations = 100)\nsummary(est_chao1, display = \"chao\")\n#> $chao\n#>         N      Chao   2.5%    97.5%  Std.Dev\n#> Dia_13  1  7.161667  3.000 12.33333 2.786019\n#> Dia_7   2 10.255429  6.000 18.81250 3.465467\n#> Dia_12  3 11.614500  7.475 19.52500 3.104127\n#> Dia_5   4 13.078167  9.000 20.00000 3.037566\n#> Dia_6   5 14.093333  9.000 22.00000 3.259457\n#> Dia_4   6 14.621667 10.000 22.00000 3.129084\n#> Dia_10  7 15.308333 10.475 22.00000 3.048741\n#> Dia_1   8 16.140000 12.000 22.00000 2.863106\n#> Dia_11  9 16.773333 12.000 22.00000 2.777931\n#> Dia_8  10 17.606667 13.000 22.00000 2.754093\n#> Dia_3  11 18.205000 13.000 22.00000 2.453708\n#> Dia_9  12 18.815000 14.975 22.00000 2.034618\n#> Dia_14 13 19.585000 15.500 22.00000 1.494189\n#> Dia_2  14 20.000000 20.000 20.00000 0.000000\n#> \n#> attr(,\"class\")\n#> [1] \"summary.poolaccum\"\n## Preparando os dados para fazer o gr√°fico\nresultados <- summary(est_chao1, display = c(\"S\", \"chao\"))\nres_chao <- cbind(resultados$chao[, 1:4], resultados$S[, 2:4])\nres_chao <- as.data.frame(res_chao)\ncolnames(res_chao) <- c(\"Amostras\", \"Chao\", \"C_inferior\", \"C_superior\", \n                        \"Riqueza\", \"R_inferior\", \"R_superior\")\n\n## Gr√°fico\nggplot(res_chao, aes(y = Riqueza, x = Amostras)) +\n    geom_point(aes(y = Chao, x = Amostras + 0.1), size = 4, \n               color = \"darkorange\", alpha = 0.7) +\n    geom_point(aes(y = Riqueza, x = Amostras), size = 4, \n               color = \"cyan4\", alpha = 0.7) +\n    geom_point(y = 7.5, x = 9, size = 4, color = \"darkorange\", alpha = 0.7) + \n    geom_point(y = 5.9, x = 9, size = 4, color = \"cyan4\", alpha = 0.7) + \n    geom_label(y = 7.5, x = 12, label = \"Riqueza estimada - Chao 1\") +\n    geom_label(y = 5.9, x = 11.3, label = \"Riqueza observada\") + \n    geom_line(aes(y = Chao, x = Amostras), color = \"darkorange\") +\n    geom_line(aes(y = Riqueza, x = Amostras), color = \"cyan4\") +\n    geom_linerange(aes(ymin = C_inferior, ymax = C_superior,\n                       x = Amostras + 0.1), color = \"darkorange\") +\n    geom_linerange(aes(ymin = R_inferior, ymax = R_superior,\n                       x = Amostras), color = \"cyan4\") +\n    scale_x_continuous(limits = c(1, 15), breaks = seq(1, 15, 1)) +\n    labs (x = \"N√∫mero de amostras\", y = \"Riqueza estimada - Chao 1\") +\n    tema_livro()"},{"path":"cap11.html","id":"ace---abundance-based-coverage-estimator","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.2.2 ACE - Abundance-based Coverage Estimator","text":"Este m√©todo trabalha com abund√¢ncia das esp√©cies raras (.e.¬†abund√¢ncia baixa) (Chao Lee 1992; Chao et al. 2000). Entretanto, diferente estimador anterior, esse m√©todo permite ao pesquisador determinar os limites para os quais uma esp√©cie seja considerada rara. Em geral, s√£o consideradas raras esp√©cies com abund√¢ncia entre 1 e 10 indiv√≠duos. riqueza estimada pode variar conforme se aumente ou diminua o limiar de abund√¢ncia, e infelizmente n√£o existem crit√©rios biol√≥gicos definidos para escolha melhor intervalo.\\[ACE = S_{abund} + \\frac{S_{rare}}{C_{ace}} + \\frac{F_1}{C_{ace}}Y_{ace}^2\\]onde:\\[Y_{ace}^2 = max \\left[\\frac{S_{rare}}{C_{ace}}\\frac{\\sum_{=}^{10}(-1)F1}{(N_{rare})({N_{rare} - 1)}}-1,0\\right]\\]\\[Y_{ace}^2 = max \\left[\\frac{S_{rare}}{C_{ace}}\\frac{\\sum_{=}^{10}(-1)F1}{(N_{rare})({N_{rare} - 1)}}-1,0\\right]\\]\\[C_{ace} = 1 - \\frac{F1}{N_{rare}}\\]\\[C_{ace} = 1 - \\frac{F1}{N_{rare}}\\]\\[N_{rare} = \\sum_{=1}^{10}iF_i\\]\\[N_{rare} = \\sum_{=1}^{10}iF_i\\]Exemplo pr√°ticoExplica√ß√£o dos dadosUsaremos os mesmos dados hipot√©ticos de 17 esp√©cies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na regi√£o Noroeste Estado de S√£o Paulo, Brasil.An√°liseC√°lculo estimador de riqueza - ACE.Visualizar os resultados com intervalo de confian√ßa de 95% (Figura 11.2).\nFigura 11.2: Resultados com intervalo de confian√ßa de 95% para o estimador ACE.\nInterpreta√ß√£o dos resultadosCom base n√∫mero de esp√©cies raras (abund√¢ncia menor que 10 indiv√≠duos - default), o estimador ACE indica possibilidade de encontrarmos mais sete esp√©cies, caso o esfor√ßo amostral fosse maior e n√£o estimou tend√™ncia de estabiliza√ß√£o da curva em uma ass√≠ntota.","code":"\n## An√°lise\nest_ace <- estaccumR(dados_coleta, permutations = 100)\nsummary(est_ace, display = \"ace\")\n#> $ace\n#>         N       ACE      2.5%    97.5%  Std.Dev\n#> Dia_11  1  7.123899  3.545190 13.71429 2.768212\n#> Dia_3   2  9.832864  6.000000 18.42880 2.876526\n#> Dia_2   3 11.395043  7.619618 18.01220 2.668935\n#> Dia_14  4 12.442264  8.000000 17.13587 2.398428\n#> Dia_7   5 13.512461  9.328990 19.24111 2.482220\n#> Dia_8   6 14.249301 10.179603 19.70014 2.608287\n#> Dia_6   7 15.272604 10.712067 21.68808 2.950251\n#> Dia_5   8 16.269161 11.419992 22.61582 3.000033\n#> Dia_12  9 17.584889 12.635634 24.20307 3.149600\n#> Dia_1  10 19.491955 13.410767 25.28994 3.732346\n#> Dia_13 11 21.058884 13.923335 25.72368 3.607014\n#> Dia_9  12 22.452802 15.911357 25.72368 3.249493\n#> Dia_4  13 23.796512 17.676471 25.72368 2.243847\n#> Dia_10 14 24.703704 24.703704 24.70370 0.000000\n#> \n#> attr(,\"class\")\n#> [1] \"summary.poolaccum\"\n## Preparando os dados para fazer o gr√°fico\nresultados_ace <- summary(est_ace, display = c(\"S\", \"ace\"))\nres_ace <- cbind(resultados_ace$ace[, 1:4], resultados_ace$S[, 2:4])\nres_ace <- as.data.frame(res_ace)\ncolnames(res_ace) <- c(\"Amostras\", \"ACE\", \"ACE_inferior\", \"ACE_superior\", \n                       \"Riqueza\", \"R_inferior\", \"R_superior\")\n\n## Gr√°fico\nggplot(res_ace, aes(y = Riqueza, x = Amostras)) +\n    geom_point(aes(y = ACE, x = Amostras + 0.1), size = 4, \n               color = \"darkorange\", alpha = 0.7) +\n    geom_point(aes(y = Riqueza, x = Amostras), size = 4, \n               color = \"cyan4\", alpha = 0.7) +\n    geom_point(y = 7.5, x = 9, size = 4, color = \"darkorange\", alpha = 0.7) + \n    geom_point(y = 5.9, x = 9, size = 4, color = \"cyan4\", alpha = 0.7) + \n    geom_label(y = 7.5, x = 11.7, label = \"Riqueza estimada - ACE\") +\n    geom_label(y = 5.9, x = 11.3, label = \"Riqueza observada\") +\n    geom_line(aes(y = ACE, x = Amostras), color = \"darkorange\") +\n    geom_line(aes(y = Riqueza, x = Amostras), color = \"cyan4\") +\n    geom_linerange(aes(ymin = ACE_inferior, ymax = ACE_superior, \n                       x = Amostras + 0.1), color = \"darkorange\") +\n    geom_linerange(aes(ymin = R_inferior, ymax = R_superior,\n                       x = Amostras), color = \"cyan4\") +\n    scale_x_continuous(limits = c(1, 15), breaks = seq(1, 15, 1)) +\n    labs(x = \"N√∫mero de amostras\", y = \"Riqueza estimada - ACE\") +\n    tema_livro()"},{"path":"cap11.html","id":"estimadores-baseados-na-incid√™ncia-das-esp√©cies","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.3 Estimadores baseados na incid√™ncia das esp√©cies","text":"","code":""},{"path":"cap11.html","id":"chao-2","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.3.1 CHAO 2","text":"De acordo com Anne Chao, o estimador Chao 1 pode ser modificado para uso com dados de presen√ßa/aus√™ncia levando em conta distribui√ß√£o das esp√©cies entre amostras (Chao 1987). Neste caso √© necess√°rio somente conhecer o n√∫mero de esp√©cies encontradas em somente uma amostra e o n√∫mero de esp√©cies encontradas exatamente em duas amostras. Essa varia√ß√£o ficou denominada como Chao 2.\\[Chao_{2} = S_{obs} + \\left(\\frac{m-1}{m}\\right)\\left(\\frac{Q_1(Q_1-1)}{2(Q_2 + 1}\\right)\\]onde:Sobs = o n√∫mero de esp√©cies observada na comunidadem = n√∫mero de amostrasQ1 = n√∫mero de esp√©cies observadas em uma amostra (esp√©cies uniques)Q2 = n√∫mero de esp√©cies observadas em duas amostras (esp√©cies duplicates)O valor de Chao2 √© m√°ximo quando esp√©cies menos uma s√£o √∫nicas (uniques). Neste caso, riqueza estimada √© aproximadamente o dobro da riqueza observada.Colwell & Coddington (1994) encontraram que o valor de Chao 2 mostrou ser o estimador menos enviesado para amostras com tamanho pequeno. üìù Importante \nVoc√™ perceber√° que ao longo cap√≠tulo recomenda√ß√µes sobre qual √© o melhor √≠ndice varia entre estudos (e.g. Palmer 1990; Walther Moore 2005).Exemplo pr√°ticoExplica√ß√£o dos dadosUsaremos novamente os mesmos dados hipot√©ticos de 17 esp√©cies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na regi√£o Noroeste Estado de S√£o Paulo, Brasil.An√°liseC√°lculo estimador de riqueza - Chao 2.Visualizar os resultados com intervalo de confian√ßa de 95% (Figura 11.3).\nFigura 11.3: Resultados com intervalo de confian√ßa de 95% para o estimador Chao 2.\nInterpreta√ß√£o dos resultadosCom base n√∫mero de esp√©cies raras (uniques e duplicates), o estimador Chao 2 encontrou possibilidade de acharmos mais dezesseis esp√©cies, caso o esfor√ßo amostral fosse maior e n√£o estimou tend√™ncia de estabiliza√ß√£o da curva em uma ass√≠ntota.","code":"\n## An√°lise\nest_chao2 <- poolaccum(dados_coleta, permutations = 100)\nsummary(est_chao2, display = \"chao\")\n#> $chao\n#>        N     Chao      2.5%    97.5%  Std.Dev\n#>  [1,]  3 14.31571  9.211111 24.35000 3.909186\n#>  [2,]  4 15.12125  8.796875 26.50000 4.676977\n#>  [3,]  5 17.18113 10.485000 34.12500 5.116710\n#>  [4,]  6 18.40042 11.336806 34.50625 5.802968\n#>  [5,]  7 20.06214 12.142857 34.00000 6.145670\n#>  [6,]  8 21.28187 12.391927 38.11562 6.923969\n#>  [7,]  9 22.60556 12.538889 36.82500 6.845149\n#>  [8,] 10 25.94025 14.327500 42.20000 7.446691\n#>  [9,] 11 27.58773 15.401136 39.27273 6.931535\n#> [10,] 12 29.55229 19.933333 39.45833 6.111500\n#> [11,] 13 31.51769 22.384615 39.61538 4.586452\n#> [12,] 14 33.71429 33.714286 33.71429 0.000000\n#> \n#> attr(,\"class\")\n#> [1] \"summary.poolaccum\"\n## Preparando os dados para fazer o gr√°fico\nresultados_chao2 <- summary(est_chao2, display = c(\"S\", \"chao\"))\nres_chao2 <- cbind(resultados_chao2$chao[, 1:4], resultados_chao2$S[, 2:4])\nres_chao2 <- as.data.frame(res_chao2)\ncolnames(res_chao2) <- c(\"Amostras\", \"Chao2\", \"C_inferior\", \"C_superior\",\n                         \"Riqueza\", \"R_inferior\", \"R_superior\")\n\n## Gr√°fico\nggplot(res_chao2, aes(y = Riqueza, x = Amostras)) +\n    geom_point(aes(y = Chao2, x = Amostras + 0.1), size = 4, \n               color = \"darkorange\", alpha = 0.7) +\n    geom_point(aes(y = Riqueza, x = Amostras), size = 4, \n               color = \"cyan4\", alpha = 0.7) +\n    geom_point(y = 9.8, x = 10, size = 4, color = \"darkorange\", alpha = 0.7) + \n    geom_point(y = 7.7, x = 10, size = 4, color = \"cyan4\", alpha = 0.7) + \n    geom_label(y = 9.8, x = 12.95, label = \"Riqueza estimada - Chao 2\") +\n    geom_label(y = 7.7, x = 12.3, label = \"Riqueza observada\") +\n    geom_line(aes(y = Chao2, x = Amostras), color = \"darkorange\") +\n    geom_line(aes(y = Riqueza, x = Amostras), color = \"cyan4\") +\n    geom_linerange(aes(ymin = C_inferior, ymax = C_superior, \n                       x = Amostras + 0.1), color = \"darkorange\") +\n    geom_linerange(aes(ymin = R_inferior, ymax = R_superior,\n                       x = Amostras), color = \"cyan4\") +\n    scale_x_continuous(limits = c(1, 15), breaks = seq(1, 15, 1)) +\n    labs(x = \"N√∫mero de amostras\", y = \"Riqueza estimada - Chao 2\") +\n    tema_livro()"},{"path":"cap11.html","id":"jackknife-1","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.3.2 JACKKNIFE 1","text":"Este estimador baseia-se n√∫mero de esp√©cies que ocorrem em somente uma amostra (Q1) (K. P. Burnham Overton 1978, 1979).\\[S_{jack1} = S_{obs} + Q_1\\left(\\frac{m - 1}{m}\\right)\\]onde:Sobs = o n√∫mero de esp√©cies observadas na comunidadeQ1 = n√∫mero de esp√©cies observadas em uma amostra (esp√©cies uniques)m = n√∫mero de amostrasJackknife √© um m√©todo de reamostragem (sem repeti√ß√£o) n√£o param√©trico usado para estimar riqueza de esp√©cies e vari√¢ncia associada com estimativa. Para isso, o m√©todo: ) exclui uma amostra e contabiliza o valor da riqueza estimada usando f√≥rmula acima, ii) repete este processo n vezes at√© que todas amostras tenham sido exclu√≠das, e iii) estima m√©dia e vari√¢ncia da riqueza de esp√©cie (Smith van Belle 1984).Palmer (1990) verificou que Jackknife 1 foi o estimador mais preciso e menos enviesado comparado outros m√©todos de extrapola√ß√£o.Exemplo pr√°ticoExplica√ß√£o dos dadosUsaremos os mesmos dados hipot√©ticos de 17 esp√©cies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na regi√£o Noroeste Estado de S√£o Paulo, Brasil.An√°liseC√°lculo estimador de riqueza - Jackknife 1.Visualizar os resultados com 95% intervalo de confian√ßa (Figura 11.4).\nFigura 11.4: Resultados com intervalo de confian√ßa de 95% para o estimador Jackknife 1.\nInterpreta√ß√£o dos resultadosCom base n√∫mero de esp√©cies raras, o estimador Jackknife 1 estimou possibilidade de encontrarmos mais seis esp√©cies, caso o esfor√ßo amostral fosse maior e n√£o estimou tend√™ncia de estabiliza√ß√£o da curva em uma ass√≠ntota.","code":"\n## An√°lise\nest_jack1 <- poolaccum(dados_coleta, permutations = 100)\nsummary(est_jack1, display = \"jack1\")\n#> $jack1\n#>        N Jackknife 1      2.5%    97.5%  Std.Dev\n#>  [1,]  3    13.64667  8.333333 19.17500 2.798035\n#>  [2,]  4    14.75000  9.750000 20.01250 2.788188\n#>  [3,]  5    15.32800  9.800000 20.42000 2.780091\n#>  [4,]  6    16.01500 11.229167 21.96250 2.802425\n#>  [5,]  7    17.07714 12.782143 22.93214 2.575868\n#>  [6,]  8    18.11625 14.165625 23.12500 2.536306\n#>  [7,]  9    18.77778 14.719444 23.22222 2.609373\n#>  [8,] 10    19.56100 14.800000 23.77250 2.586909\n#>  [9,] 11    20.42455 16.727273 23.36364 2.190412\n#> [10,] 12    21.16000 17.185417 23.41667 1.863867\n#> [11,] 13    21.92846 18.692308 23.46154 1.335047\n#> [12,] 14    22.57143 22.571429 22.57143 0.000000\n#> \n#> attr(,\"class\")\n#> [1] \"summary.poolaccum\"\n## Preparando os dados para fazer o gr√°fico\nresultados_jack1 <- summary(est_jack1, display = c(\"S\", \"jack1\"))\nres_jack1 <- cbind(resultados_jack1$jack1[, 1:4], resultados_jack1$S[, 2:4])\nres_jack1 <- as.data.frame(res_jack1)\ncolnames(res_jack1) <- c(\"Amostras\", \"JACK1\", \"JACK1_inferior\", \"JACK1_superior\", \n                         \"Riqueza\", \"R_inferior\", \"R_superior\")\n\n## Gr√°fico\nggplot(res_jack1, aes(y = Riqueza, x = Amostras)) +\n    geom_point(aes(y = JACK1, x = Amostras + 0.1), size = 4, \n               color = \"darkorange\", alpha = 0.7) +\n    geom_point(aes(y = Riqueza, x = Amostras), size = 4, \n               color = \"cyan4\", alpha = 0.7) +\n    geom_point(y = 9.9, x = 9, size = 4, color = \"darkorange\", alpha = 0.7) + \n    geom_point(y = 8.6, x = 9, size = 4, color = \"cyan4\", alpha = 0.7) + \n    geom_label(y = 9.9, x = 12.5, label = \"Riqueza estimada - Jackknife 1\") +\n    geom_label(y = 8.6, x = 11.5, label = \"Riqueza observada\") +\n    geom_line(aes(y = JACK1, x = Amostras), color = \"darkorange\") +\n    geom_line(aes(y = Riqueza, x = Amostras), color = \"cyan4\") +\n    geom_linerange(aes(ymin = JACK1_inferior, ymax = JACK1_superior, \n                       x = Amostras + 0.1), color = \"darkorange\") +\n    geom_linerange(aes(ymin = R_inferior, ymax = R_superior, \n                       x = Amostras), color = \"cyan4\") +\n    scale_x_continuous(limits = c(1, 15), breaks = seq(1, 15, 1)) +\n    labs(x = \"N√∫mero de amostras\", y = \"Riqueza estimada - Jackknife 1\") +\n    tema_livro()"},{"path":"cap11.html","id":"jackknife-2","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.3.3 JACKKNIFE 2","text":"Este m√©todo baseia-se n√∫mero de esp√©cies que ocorrem em apenas uma amostra e n√∫mero de esp√©cies que ocorrem em exatamente duas amostras (K. P. Burnham Overton 1978, 1979; Palmer 1991).\\[S_{jack2} = S_{obs} + \\left[\\frac{Q_1(2m - 3)}{m}-\\frac{Q_2(m - 2)^2}{m(m-1)}\\right]\\]onde:Sobs = o n√∫mero de esp√©cies observadas na comunidadem = n√∫mero de amostrasQ1 = n√∫mero de esp√©cies observadas em uma amostra (esp√©cies uniques)Q2 = n√∫mero de esp√©cies observadas em duas amostras (esp√©cies duplicates)Exemplo pr√°ticoExplica√ß√£o dos dadosUsaremos os mesmos dados hipot√©ricos de 17 esp√©cies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na regi√£o Noroeste Estado de S√£o Paulo, Brasil.An√°liseC√°lculo estimador de riqueza - Jackknife 2.Visualizar os resultados com intervalo de confian√ßa de 95% (Figura 11.5).\nFigura 11.5: Resultados com intervalo de confian√ßa de 95% para o estimador Jackknife 2.\nInterpreta√ß√£o dos resultadosCom base n√∫mero de esp√©cies raras, o estimador Jackknife 2 estimou possibilidade de encontrarmos mais dez esp√©cies, caso o esfor√ßo amostral fosse maior e n√£o estimou tend√™ncia estabiliza√ß√£o da curva em uma ass√≠ntota.","code":"\n## An√°lise\nest_jack2 <- poolaccum(dados_coleta, permutations = 100)\nsummary(est_jack2, display = \"jack2\")\n#> $jack2\n#>        N Jackknife 2      2.5%    97.5%  Std.Dev\n#>  [1,]  3    14.27667  7.904167 21.50000 3.750886\n#>  [2,]  4    15.73500  8.566667 23.77292 4.127584\n#>  [3,]  5    16.36650  9.150000 24.68625 4.262113\n#>  [4,]  6    18.16900 10.631667 27.46667 4.274110\n#>  [5,]  7    19.57786 12.339881 27.21250 3.875295\n#>  [6,]  8    20.78679 14.133929 28.58527 3.778223\n#>  [7,]  9    21.82028 13.972222 27.98611 3.960469\n#>  [8,] 10    22.84444 14.977778 28.18889 3.770196\n#>  [9,] 11    24.04227 17.445455 28.35455 3.123930\n#> [10,] 12    24.99455 20.242424 28.49242 2.618660\n#> [11,] 13    26.09481 21.301282 28.60897 1.953804\n#> [12,] 14    26.92308 26.923077 26.92308 0.000000\n#> \n#> attr(,\"class\")\n#> [1] \"summary.poolaccum\"\n## Preparando os dados para fazer o gr√°fico\nresultados_jack2 <- summary(est_jack2, display = c(\"S\", \"jack2\"))\nres_jack2 <- cbind(resultados_jack2$jack2[, 1:4], resultados_jack2$S[, 2:4])\nres_jack2 <- as.data.frame(res_jack2)\ncolnames(res_jack2) <- c(\"Amostras\", \"JACK2\", \"JACK2_inferior\", \"JACK2_superior\", \n                         \"Riqueza\", \"R_inferior\", \"R_superior\")\n\n## Gr√°fico\nggplot(res_jack2, aes(y = Riqueza, x = Amostras)) +\n    geom_point(aes(y = JACK2, x = Amostras + 0.1), size = 4, \n               color = \"darkorange\", alpha = 0.7) +\n    geom_point(aes(y = Riqueza, x = Amostras), size = 4, \n               color = \"cyan4\", alpha = 0.7) +\n    geom_point(y = 9.9, x = 9, size = 4, color = \"darkorange\", alpha = 0.7) + \n    geom_point(y = 8.2, x = 9, size = 4, color = \"cyan4\", alpha = 0.7) + \n    geom_label(y = 9.9, x = 12.5, label = \"Riqueza estimada - Jackknife 2\") +\n    geom_label(y = 8.2, x = 11.5, label = \"Riqueza observada\") +\n    geom_line(aes(y = JACK2, x = Amostras), color = \"darkorange\") +\n    geom_line(aes(y = Riqueza, x = Amostras), color = \"cyan4\") +\n    geom_linerange(aes(ymin = JACK2_inferior, ymax = JACK2_superior, \n                       x = Amostras + 0.1), color = \"darkorange\") +\n    geom_linerange(aes(ymin = R_inferior, ymax = R_superior, \n                       x = Amostras), color = \"cyan4\") +\n    scale_x_continuous(limits = c(1, 15), breaks = seq(1, 15, 1)) +\n    labs(x = \"N√∫mero de amostras\", y = \"Riqueza estimada - Jackknife 2\") +\n    tema_livro()"},{"path":"cap11.html","id":"bootstrap","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.3.4 BOOTSTRAP","text":"Este m√©todo difere dos demais por utilizar dados de todas esp√©cies coletadas para estimar riqueza total, n√£o se restringindo √†s esp√©cies raras (Smith van Belle 1984). Ele requer somente dados de incid√™ncia. estimativa pelo bootstrap √© calculada somando-se riqueza observada √† soma inverso da propor√ß√£o de amostras em que cada esp√©cie ocorre.\\[S_{boot} = S_{obs} + \\sum_{k=1}^{S_{obs}}(1-P_k)^m\\]onde:Sobs = o n√∫mero de esp√©cies observadas na comunidadem = n√∫mero de amostragensPk = propor√ß√£o n√∫mero de amostras em que cada esp√©cie foi registradaBootstrap √© um m√©todo n√£o param√©trico usado para estimar os par√¢metros de uma popula√ß√£o por reamostragem. premissa √© que reamostragens podem ser entendidas como pseudo-popula√ß√µes, com caracter√≠sticas similares da popula√ß√£o original. Para isso, o m√©todo: ) seleciona ao acaso um conjunto de amostras (nosso exemplo 14 amostras) com reposi√ß√£o, ii) repete este processo n vezes, e iii) estima m√©dia e vari√¢ncia da riqueza de esp√©cie (Smith van Belle 1984).Exemplo pr√°ticoExplica√ß√£o dos dadosUsaremos os mesmos dados hipot√©ricos de 17 esp√©cies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na regi√£o Noroeste Estado de S√£o Paulo, Brasil.An√°liseC√°lculo estimador de riqueza - Bootstrap.Visualizar os resultados com intervalo de confian√ßa de 95% (Figura 11.6).\nFigura 11.6: Resultados com intervalo de confian√ßa de 95% para o estimador Bootstrap.\nInterpreta√ß√£o dos resultadosCom base na frequ√™ncia de ocorr√™ncia das esp√©cies, o estimador bootstrap estimou possibilidade de encontrarmos mais duas esp√©cies, caso o esfor√ßo amostral fosse maior e n√£o estimou tend√™ncia de estabiliza√ß√£o da curva em uma ass√≠ntota.","code":"\n## An√°lise\nest_boot <- poolaccum(dados_coleta, permutations = 100)\nsummary(est_boot, display = \"boot\")\n#> $boot\n#>        N Bootstrap      2.5%    97.5%  Std.Dev\n#>  [1,]  3  11.87407  8.425000 15.51852 2.011130\n#>  [2,]  4  13.14934  9.771387 16.77627 2.001598\n#>  [3,]  5  13.83898 10.822584 17.43899 1.964793\n#>  [4,]  6  14.66163 10.705144 18.37757 1.977243\n#>  [5,]  7  15.47596 11.981076 18.68644 1.879223\n#>  [6,]  8  16.18653 12.599602 19.68927 1.830489\n#>  [7,]  9  16.61378 13.042764 19.61772 1.779771\n#>  [8,] 10  17.19346 13.077245 19.70960 1.788670\n#>  [9,] 11  17.82230 14.315556 19.81162 1.558281\n#> [10,] 12  18.35152 15.374464 19.58721 1.270158\n#> [11,] 13  18.75381 16.570376 19.59107 1.027014\n#> [12,] 14  19.27832 19.278321 19.27832 0.000000\n#> \n#> attr(,\"class\")\n#> [1] \"summary.poolaccum\"\n## Preparando os dados para fazer o gr√°fico\nresultados_boot <- summary(est_boot, display = c(\"S\", \"boot\"))\nres_boot <- cbind(resultados_boot$boot[,1:4], resultados_boot$S[,2:4])\nres_boot <- as.data.frame(res_boot)\ncolnames(res_boot) <- c(\"Amostras\", \"BOOT\", \"BOOT_inferior\", \"BOOT_superior\", \n                        \"Riqueza\", \"R_inferior\", \"R_superior\")\n\n## Gr√°fico\nggplot(res_boot, aes(y = Riqueza, x = Amostras)) +\n    geom_point(aes(y = BOOT, x = Amostras + 0.1), size = 4, \n               color = \"darkorange\", alpha = 0.7) +\n    geom_point(aes(y = Riqueza, x = Amostras), size = 4, \n               color = \"cyan4\", alpha = 0.7) +\n    geom_point(y = 10.4, x = 9, size = 4, color = \"darkorange\", alpha = 0.7) + \n    geom_point(y = 9.3, x = 9, size = 4, color = \"cyan4\", alpha = 0.7) + \n    geom_label(y = 10.4, x = 12.3, label = \"Riqueza estimada - Bootstrap\") +\n    geom_label(y = 9.3, x = 11.5, label = \"Riqueza observada\") +\n    geom_line(aes(y = BOOT, x = Amostras), color = \"darkorange\") +\n    geom_line(aes(y = Riqueza, x = Amostras), color = \"cyan4\") +\n    geom_linerange(aes(ymin = BOOT_inferior, ymax = BOOT_superior, \n                       x = Amostras + 0.1), color = \"darkorange\") +\n    geom_linerange(aes(ymin = R_inferior, ymax = R_superior, \n                       x = Amostras), color = \"cyan4\") +\n    scale_x_continuous(limits = c(1, 15), breaks = seq(1, 15, 1)) +\n    labs(x = \"N√∫mero de amostras\", y = \"Riqueza estimada - Bootstrap\") +\n    tema_livro()"},{"path":"cap11.html","id":"interpola√ß√£o-e-extrapola√ß√£o-baseadas-em-rarefa√ß√£o-usando-amostragens-de-incid√™ncia-ou-abund√¢ncia","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.4 Interpola√ß√£o e extrapola√ß√£o baseadas em rarefa√ß√£o usando amostragens de incid√™ncia ou abund√¢ncia","text":"Este m√©todo utiliza teoria de amostragem (e.g.¬†modelos multinomial, Poisson e Bernoulli) para conectar rarefa√ß√£o (interpola√ß√£o) e predi√ß√£o (extrapola√ß√£o) com base tamanho da amostra (Chao Jost 2012; Colwell et al. 2012). Ele utiliza uma abordagem com bootstrap para calcular o intervalo de confian√ßa de 95%. üìù Importante \nextrapola√ß√£o torna-se altamente incerta quando estendida para o dobro ou mais tamanho da amostragem.Exemplo pr√°tico 1Explica√ß√£o dos dadosUsaremos os mesmos dados hipot√©ticos de 17 esp√©cies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na regi√£o Noroeste Estado de S√£o Paulo, Brasil.An√°liseC√°lculo da extrapola√ß√£o da riqueza com base n√∫mero de indiv√≠duos (Figura 11.7).\nFigura 11.7: Resultados com intervalo de confian√ßa de 95% para extrapola√ß√£o.\nInterpreta√ß√£o dos resultadosVeja que o ponto final da linha cont√≠nua representa 17 esp√©cies de anuros (eixo Y) observadas entre os 304 individuos (eixo X). extrapola√ß√£o m√°xima (600 indiv√≠duos nosso exemplo) estima um aumento de at√© oito esp√©cies (intervalo de confian√ßa) caso amostr√°ssemos mais 296 indiv√≠duos.C√°lculo da extrapola√ß√£o da riqueza com base n√∫mero de amostras (Figura 11.8).\nFigura 11.8: Resultados com intervalo de confian√ßa de 95% para extrapola√ß√£o da riqueza.\nInterpreta√ß√£o dos resultadosVeja que o ponto final da linha cont√≠nua representa 17 esp√©cies de anuros (eixo Y) observadas nos 14 dias de coleta (eixo X - amostras). extrapola√ß√£o m√°xima (28 dias de coleta nosso exemplo) estima um aumento de at√© 12 esp√©cies (intervalo de confian√ßa) caso amostr√°ssemos mais 14 dias.Exemplo pr√°tico 2Explica√ß√£o dos dadosNeste exemplo, iremos refazer o exemplo Cap√≠tulo 7 que usa Generalized Least Squares (GLS) para testar rela√ß√£o da riqueza de √°caros com quantidade de √°gua substrato. Contudo, ao inv√©s de considerar riqueza de esp√©cies de √°caros observada como vari√°vel resposta, iremos utilizar riqueza extrapolada. Os dados que usaremos est√£o dispon√≠veis pacote vegan e representam composi√ß√£o de esp√©cies de √°caros amostradas em 70 comunidades/amostras.PerguntaA riqueza extrapolada de esp√©cies de √°caros √© maior em comunidades localizadas em √°reas com substratos secos?Predi√ß√µesO n√∫mero de esp√©cies extrapolada ser√° maior em substratos secos uma vez que limita√ß√µes fisiol√≥gicas impostas pela umidade limitam ocorr√™ncia de v√°rias esp√©cies de √°carosVari√°veisVari√°veis resposta e preditorasVari√°veis resposta e preditorasmatriz ou data frame com abund√¢ncias das esp√©cies de √°caros (vari√°vel resposta) registradas em 70 comunidades/amostras (vari√°vel preditora)matriz ou data frame com abund√¢ncias das esp√©cies de √°caros (vari√°vel resposta) registradas em 70 comunidades/amostras (vari√°vel preditora)ChecklistVerificar se sua matriz ou data frame est√£o com esp√©cies nas linhas e comunidades nas colunasAn√°liseVamos iniciar calculando riqueza extrapolada com base na comunidade com maior abund√¢ncia.Lembrando, estamos interessados valor rarefeito considerando abund√¢ncia total de 781 indiv√≠duos. Esta informa√ß√£o est√° armazenada na linha 40 e na coluna 4 dos data frames salvos objeto resultados_extrapolacao$iNextEst. Assim, para obtermos o valor rarefeito de interesse, vamos criar um loop para facilitar extra√ß√£o da riqueza rarefeita para 70 comunidades.Agora, seguindo os passos descritos Cap√≠tulo 7, vamos identificar o melhor modelo que representa estrutura espacial dos dados extrapolados.Vamos usar sele√ß√£o de modelos por o AIC para selecionar o modelo mais ‚Äúprov√°vel‚Äù explicando distribui√ß√£o da riqueza extrapolada das esp√©cies de √°caros (Figura 11.9).\nFigura 11.9: Visualiza√ß√£o dos res√≠duos modelo selecionado.\nDe forma geral, distribui√ß√£o dos res√≠duos est√° adequada com apenas dois pontos fugindo da nuvem. Contudo, eles podem influenciar os resultados (Figura 11.10).\nFigura 11.10: Gr√°fico modelo GLS selecionado.\nInterpreta√ß√£o dos resultadosA riqueza extrapolada das esp√©cies de √°caros foi maior em comunidades localizadas em √°reas com substratos secos que em √°reas com substratos √∫midos. Contudo, apesar modelo apresentar um rela√ß√£o significativa entre vari√°veis, concentra√ß√£o de √°gua explica apenas 5,9% da varia√ß√£o da riqueza extrapolada das esp√©cies de √°caros. O padr√£o observado, valor de P < 0.05 e o baixo valor de R2, provavelmente est√° relacionado com duas comunidades com altos valores de riqueza extapolada (e.g.¬†outilers). Refa√ßa an√°lises sem os dois pontos e vejam o padr√£o dos novos resultados.","code":"\n## Preparando os dados para an√°lises considerando a abund√¢ncia\ndados_inext_abu <- colSums(dados_coleta) \nresultados_abundancia <- iNEXT(dados_inext_abu, q = 0, datatype = \"abundance\", \n                               endpoint = 600)\n\n## Gr√°fico\nggiNEXT(resultados_abundancia, type = 1) + \n    scale_linetype_discrete(labels = c(\"Interpolado\", \"Extrapolado\")) +\n    scale_colour_manual(values = \"darkorange\") +\n    scale_fill_manual(values = \"darkorange\") +\n    labs(x = \"N√∫mero de indiv√≠duos\", y = \" Riqueza de esp√©cies\") +\n    tema_livro()\n## Preparando os dados para an√°lises considerando a incid√™ncia\n# Precisa transpor o data frame.\ndados_inext <- as.incfreq(t(dados_coleta)) \nresultados_incidencia <- iNEXT(dados_inext, q = 0, datatype = \"incidence_freq\", \n                               endpoint = 28)\n\n## Gr√°fico\nggiNEXT(resultados_incidencia, type = 1) +\n    scale_linetype_discrete(labels = c(\"Interpolado\", \"Extrapolado\")) +\n    scale_colour_manual(values = \"darkorange\") +\n    scale_fill_manual(values = \"darkorange\") +\n    labs(x = \"N√∫mero de amostras\", y = \" Riqueza de esp√©cies\") +\n    tema_livro()\n## Transposi√ß√£o\n# Os dados est√£o com as comunidades nas colunas e as esp√©cies nas linhas. \n# Para as an√°lises teremos que transpor a planilha.\ncomposicao_acaros <- t(mite)\n\n## Dados\n# A comunidade com maior abund√¢ncia tem 781 indiv√≠duos. \nmax(colSums(composicao_acaros))\n#> [1] 781\n\n# Calcular a riqueza extrapolada de esp√©cies para todas as comunidades \n# considerando a maior abund√¢ncia. \nresultados_extrapolacao <- iNEXT(composicao_acaros, q = 0, \n                                 datatype = \"abundance\", \n                                 endpoint = 781)\n## Dados\n# Criando um data.frame vazio para salvar os dados\nresultados_comunidades_ext <- data.frame()\n\n# Criando um vetor vazio para salvar os resultados\nriqueza_extrapolada <- c()\n\n## Lopp\n# Loop repetindo as an√°lises para as 70 comunidades\n# O objetivo √© extrair a riqueza estimada extrapolada para 781 individuos\nfor (i in 1:70){\n    resultados_comunidades_ext <- data.frame(resultados_extrapolacao$iNextEst[i])\n    riqueza_extrapolada[i] <- resultados_comunidades_ext[40, 4] # 8 abund√¢ncia e 4 riqueza rarefeita\n}\n## Dados\n# Criando data frame com todas as vari√°veis\ndados_combinado_ext <- data.frame(riqueza_extrapolada, agua, coord)\n\n## Modelo gls sem estrutura espacial\nno_spat_gls <- gls(riqueza_extrapolada ~ agua, \n                   data = dados_combinado_ext, \n                   method = \"REML\")\n\n## Covari√¢ncia esf√©rica\nespher_model <- gls(riqueza_extrapolada ~ agua, \n                    data = dados_combinado_ext, \n                    corSpher(form = ~lat + long, nugget = TRUE))\n\n## Covari√¢ncia exponencial\nexpon_model <- gls(riqueza_extrapolada ~ agua, \n                   data = dados_combinado_ext, \n                   corExp(form = ~lat + long, nugget = TRUE))\n\n## Covari√¢ncia Gaussiana\ngauss_model <- gls(riqueza_extrapolada ~ agua,\n                   data = dados_combinado_ext, \n                   corGaus(form = ~lat + long, nugget = TRUE))\n\n## Covari√¢ncia linear\ncor_linear_model <- gls(riqueza_extrapolada ~ agua,\n                        data = dados_combinado_ext,\n                        corLin(form = ~lat + long, nugget = TRUE))\n\n## Covari√¢ncia raz√£o quadr√°tica\nratio_model <- gls(riqueza_extrapolada ~ agua, \n                   data = dados_combinado_ext, \n                   corRatio(form = ~lat + long, nugget = TRUE))\n## Sele√ß√£o dos modelos\naic_fit_ext <- AIC(no_spat_gls, espher_model, \n                   cor_linear_model, expon_model, \n                   gauss_model, ratio_model)\naic_fit_ext %>% arrange(AIC)\n#>   df      AIC\n#> 1  5 467.9349\n#> 2  3 469.3103\n#> 3  5 473.2373\n#> 4  5 473.2815\n#> 5  5 473.3086\n#> 6  5 473.3103\n\n## Visualizando os res√≠duos do modelo com menor valor de AIC (veja Cap√≠tulo 7)\nplot(ratio_model)\n## Visualizando os resultados e calculando pseudo-R-squared.\nsummary(ratio_model)$tTable \n#>                   Value   Std.Error   t-value      p-value\n#> (Intercept) 24.09577588 4.816461582  5.002796 4.227862e-06\n#> agua        -0.01181425 0.006977381 -1.693221 9.499017e-02\nrsquared(ratio_model)\n#>              Response   family     link method  R.squared\n#> 1 riqueza_extrapolada gaussian identity   none 0.05977552\n\n## Gr√°fico\npredito_ext <- predict(ratio_model) \n\nggplot(data = dados_combinado_ext, aes(x= agua, y= riqueza_extrapolada)) + \n    geom_point(size = 4, shape = 21, fill = \"darkorange\", alpha = 0.7) +\n    geom_line(aes(y = predito_ext), size = 1) +\n    labs(x = \"Concentra√ß√£o de √°gua no substrato\", \n         y = \"Riqueza extrapolada \\ndas esp√©cies de √°caros\") +\n    tema_livro()"},{"path":"cap11.html","id":"para-se-aprofundar-7","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.5 Para se aprofundar","text":"","code":""},{"path":"cap11.html","id":"livros-5","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.5.1 Livros","text":"Recomendamos o livro Biological Diversity Frontiers Measurement Assessment (Magurran McGill 2011)","code":""},{"path":"cap11.html","id":"links-6","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.5.2 Links","text":"Recomendamos tamb√©m que acessem p√°gina EstimateS software e baixem o manual usu√°rio que cont√©m informa√ß√µes detalhadas sobre os √≠ndices de rarefa√ß√£o e estimadores de riqueza. Este site foi criado e √© mantido pelo Dr.¬†Robert K. Colwell, um dos maiores especialistas mundo em estimativas da biodiversidadeRecomendamos tamb√©m que acessem p√°gina EstimateS software e baixem o manual usu√°rio que cont√©m informa√ß√µes detalhadas sobre os √≠ndices de rarefa√ß√£o e estimadores de riqueza. Este site foi criado e √© mantido pelo Dr.¬†Robert K. Colwell, um dos maiores especialistas mundo em estimativas da biodiversidadeRecomendamos p√°gina pessoal da pesquisadora Anne Chao que √© uma das respons√°veis pelo desenvolvimento da metodologia e pacote iNEXT. Nesta p√°gina, voc√™s ir√£o encontrar exemplos e explica√ß√µes detalhadas sobre an√°lisesRecomendamos p√°gina pessoal da pesquisadora Anne Chao que √© uma das respons√°veis pelo desenvolvimento da metodologia e pacote iNEXT. Nesta p√°gina, voc√™s ir√£o encontrar exemplos e explica√ß√µes detalhadas sobre an√°lises","code":""},{"path":"cap11.html","id":"exerc√≠cios-7","chapter":"Cap√≠tulo 11 Estimadores de riqueza","heading":"11.6 Exerc√≠cios","text":"11.1\nCarregue os dados - Cap11_exercicio1 - que est√° pacote ecodados. Este conjunto de dados representa abund√¢ncia de 50 esp√©cies de besouros coletados em 30 amostras. Calcule os estimadores de riqueza - Chao1 e ACE - e fa√ßa um gr√°fico contendo riqueza observada e os dois estimadores de riqueza. Qual sua interpreta√ß√£o sobre o esfor√ßo amostral?11.2\nUtilize o mesmo conjunto de dados exerc√≠cio anterior. Calcule os estimadores de riqueza - Jackknife 1 e bootstrap. Fa√ßa um gr√°fico contendo riqueza observada e os dois estimadores de riqueza. Qual sua interpreta√ß√£o sobre o esfor√ßo amostral? Compare com os resultados exerc√≠cio anterior que utilizam estimadores baseados na abund√¢ncia das esp√©cies.11.3\nVamos refazer o exerc√≠cio 10 Cap√≠tulo 7 que usa Generalized Least Squares (GLS) para testar rela√ß√£o da riqueza de anuros em 44 localidades na Mata Atl√¢ntica com precipita√ß√£o anual. Contudo, ao inv√©s de considerar riqueza de esp√©cies de anuros observada como vari√°vel resposta, iremos utilizar riqueza extrapolada. Utilize os dados ‚Äúanuros_composicao‚Äù para estimar riqueza extrapolada e o dados ‚Äúanuros_ambientais‚Äù para acessar os dados de precipita√ß√£o anual e coordenadas geogr√°ficas. Qual sua interpreta√ß√£o dos resultados utilizando riqueza observada e extrapolada?Solu√ß√µes dos exerc√≠cios.","code":""},{"path":"cap12.html","id":"cap12","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"Cap√≠tulo 12 Diversidade Taxon√¥mica","text":"","code":""},{"path":"cap12.html","id":"pr√©-requisitos-do-cap√≠tulo-8","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"Pr√©-requisitos do cap√≠tulo","text":"Pacotes e dados que ser√£o utilizados nesse cap√≠tulo.","code":"\n## Pacotes\nlibrary(devtools)\nlibrary(ecodados)\nlibrary (vegan)\nlibrary(ggplot2)\nlibrary(BiodiversityR)\nlibrary(hillR)\nlibrary(betapart)\n\n## Dados\ncomposicao_especies <- ecodados::composicao_anuros_div_taxonomica\nprecipitacao        <- ecodados::precipitacao_div_taxonomica"},{"path":"cap12.html","id":"aspectos-te√≥ricos-3","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"12.1 Aspectos te√≥ricos","text":"diversidade biol√≥gica √© um conceito multifacetado que pode ser definido e analisado de diferentes maneiras (e.g.¬†diversidade gen√©tica, taxon√¥mica, funcional, filogen√©tica, ecossist√™mica, etc.) (Magurran McGill 2011; Gotelli Chao 2013). Whittaker (1960, 1972) particionou diversidade em tr√™s componentes: ) diversidade alfa que √© caracterizada pela diversidade dentro habitat ou unidade amostral, ii) diversidade beta que √© caracterizada pela varia√ß√£o na diversidade entre habitats ou unidades amostrais, e iii) diversidade gama que √© caracterizada pela combina√ß√£o da diversidade alfa e beta ou definida como diversidade regional englobando todos os habitat ou unidades amostrais. Portanto, n√£o existe um m√©todo que quantifique todos os par√¢metros associados √† diversidade biol√≥gica. Consequentemente, escolha da m√©trica de diversidade depender√°: ) objetivo estudo, e ii) das informa√ß√µes dispon√≠veis para o pesquisador.Neste cap√≠tulo, iremos abordar diversidade taxon√¥mica que ignora rela√ß√£o de parentesco entre esp√©cies (e.g.¬†diversidade filogen√©tica - Cap√≠tulo 13) e diferentes fun√ß√µes que esp√©cies realizam ecossistema (e.g.¬†diversidade funcional - Cap√≠tulo 14). Na diversidade taxon√¥mica, pesquisadores est√£o interessados na riqueza de esp√©cies (e.g.¬†n√∫mero de esp√©cies), na distribui√ß√£o de abund√¢ncia das esp√©cies (e.g.¬†fato que algumas esp√©cies s√£o comuns e outras raras) e/ou diversidade de esp√©cies (e.g.¬†√≠ndices que descrevem rela√ß√£o entre riqueza e distribui√ß√£o da abund√¢ncia relativa das esp√©cies) nas localidades.","code":""},{"path":"cap12.html","id":"diversidade-alfa","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"12.2 Diversidade alfa","text":"","code":""},{"path":"cap12.html","id":"riqueza-de-esp√©cies-ou-n√∫mero-de-esp√©cies","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"12.2.1 Riqueza de esp√©cies ou n√∫mero de esp√©cies","text":"Riqueza de esp√©cies √© uma m√©trica intuitiva e de f√°cil compreens√£o, uma vez que se refere ao n√∫mero de esp√©cies observadas em uma localidade. √â importante ter em mente que riqueza de esp√©cies √© influenciada pelo esfor√ßo amostral e sua estimativa real √© um imenso desafio (Magurran McGill 2011). Compara√ß√µes entre comunidades com diferen√ßas n√∫mero de amostragens ou abund√¢ncia das esp√©cies devem ser realizadas por meio de rarefa√ß√µes (veja Cap√≠tulo 10), enquanto que o n√∫mero de esp√©cies n√£o detectadas pode ser estimado pelos estimadores de riqueza (veja Cap√≠tulo 11). Embora raramente usados como alternativas √† rarefa√ß√£o, existem alguns √≠ndices que calculam riqueza de esp√©cies ponderando abund√¢ncia total (.e.¬†tamanho da amostra) dentro de cada comunidade.Esses √≠ndices s√£o:1. √çndice de Margalef\\[D_{Mg} = \\frac{S-1}{ln (N)}\\]onde:S = o n√∫mero de esp√©cies na comunidadeln = logaritmo naturalN = n√∫mero total de indiv√≠duos na comunidadeDMg n√£o tem um valor m√°ximo e sua interpreta√ß√£o √© comparativa, com valores maiores indicando maior riqueza de esp√©cies2. √çndice de Menhinick\\[D_{Mn} = \\frac{S}{\\sqrt{N}}\\]onde:S = o n√∫mero de esp√©cies na comunidadeN = n√∫mero total de indiv√≠duos na comunidadeDMn n√£o tem um valor m√°ximo e sua interpreta√ß√£o √© comparativa, com valores maiores indicando maior riqueza de esp√©ciesExemplo pr√°tico 1Explica√ß√£o dos dadosNeste exemplo, avaliaremos riqueza de esp√©cies de 10 comunidades. Os dados de ocorr√™ncia das esp√©cies nas comunidades foram simulados para demonstrar propriedades das m√©tricas de diversidade taxon√¥micas. Utilizaremos este conjunto de dados para todos os exemplos deste cap√≠tulo.PerguntaA varia√ß√£o espacial na riqueza de esp√©cies nas comunidades est√° associada com varia√ß√£o na precipita√ß√£o?Predi√ß√µesOs valores de riqueza de esp√©cies ser√£o maiores nas comunidades localizadas em regi√µes que recebem grande volume de precipita√ß√£o que em regi√µes mais secasVari√°veisVari√°veis resposta e preditoras\nData frame com comunidades (unidade amostral) nas linhas e esp√©cies (vari√°vel resposta) nas colunas\nData frame com comunidades (unidade amostral) nas linhas e precipita√ß√£o anual (vari√°vel preditora) na coluna\nVari√°veis resposta e preditorasData frame com comunidades (unidade amostral) nas linhas e esp√©cies (vari√°vel resposta) nas colunasData frame com comunidades (unidade amostral) nas linhas e precipita√ß√£o anual (vari√°vel preditora) na colunaChecklistVerificar se os data frames de composi√ß√£o de esp√©cies e vari√°veis ambientais est√£o com unidades amostrais nas linhas e vari√°veis preditores nas colunasVerificar se os data frames de composi√ß√£o de esp√©cies e vari√°veis ambientais est√£o com unidades amostrais nas linhas e vari√°veis preditores nas colunasVerificar se comunidades nos data frames de composi√ß√£o de esp√©cies e vari√°veis ambientais est√£o distribu√≠dos na mesma sequ√™ncia/ordem nos dois arquivosVerificar se comunidades nos data frames de composi√ß√£o de esp√©cies e vari√°veis ambientais est√£o distribu√≠dos na mesma sequ√™ncia/ordem nos dois arquivosAn√°liseAbaixo, demonstramos os c√≥digos R para determinar riqueza de esp√©cies para cada comunidade partir dos dados de composi√ß√£o de esp√©cies. Os dados est√£o dispon√≠veis pacote ecodados.Vamos ver riqueza de esp√©cies para cada comunidade.Vamos ver abund√¢ncia total de cada comunidade.Calculando o √çndice de Margalef.Calculando o √çndice de Menhinick.Agora vamos analisar rela√ß√£o entre riqueza de esp√©cies e precipita√ß√£o anual.H√° uma rela√ß√£o positiva entre riqueza de esp√©cies e precipita√ß√£o anual (F1,8 = 8,91, P = 0,01).Analisar rela√ß√£o entre o √çndice de Margalef e precipita√ß√£o anual.N√£o h√° uma rela√ß√£o positiva entre o √≠ndice de Margalef e precipita√ß√£o anual (F1,8 = 2,12, P = 0,18).Agora vamos analisar rela√ß√£o entre o √≠ndice de Menhinick e precipita√ß√£o anual.N√£o h√° uma rela√ß√£o positiva entre o √≠ndice de Menhinick e precipita√ß√£o anual (F1,8 = 1,09, P = 0,32).Com base nos resultados, vamos plotar apenas o gr√°fico com os resultados da riqueza de esp√©cies ao longo gradiente de precipita√ß√£o anual (Figura 12.1).\nFigura 12.1: Gr√°fico modelo linear da rela√ß√£o entre riqeuza e precipita√ß√£o.\nInterpreta√ß√£o dos resultadosO n√∫mero de esp√©cies √© maior em comunidades com maior precipita√ß√£o. Contudo, quando ponderamos pela abund√¢ncia (√≠ndices de Margalef ou Menhinick), rela√ß√£o com precipita√ß√£o n√£o √© significativa. üìù Importante \nPercebam que ponderar riqueza de esp√©cies pela abund√¢ncia altera interpreta√ß√£o dos resultados.","code":"\n## Ver os dados das comunidades\nhead(composicao_especies)\n#>       sp1 sp2 sp3 sp4 sp5 sp6 sp7 sp8 sp9 sp10\n#> Com_1  10  10  10  10  10  10  10  10  10   10\n#> Com_2  91   1   1   1   1   1   1   1   1    1\n#> Com_3   1   3   6  25   1   0   0   0   0    0\n#> Com_4   0   0   0   0   0  15  15  18  17   16\n#> Com_5   0   9   0   6   0  11   0   2  12    0\n#> Com_6   3   0   5   0  12   1   0  13  12    0\n## Calculando a riqueza observada de esp√©cies para cada comunidade\nriqueza_sp <- specnumber(composicao_especies)\nriqueza_sp\n#>  Com_1  Com_2  Com_3  Com_4  Com_5  Com_6  Com_7  Com_8  Com_9 Com_10 \n#>     10     10      5      5      5      6      2      4      6      4\n## Calculamos a abund√¢ncia total para cada comunidade\nabundancia <- apply(composicao_especies, 1, sum)\nabundancia\n#>  Com_1  Com_2  Com_3  Com_4  Com_5  Com_6  Com_7  Com_8  Com_9 Com_10 \n#>    100    100     36     81     40     46      4     20     15     11\n## √çndice de Margalef\n# A fun√ß√£o round √© para limitar o resultado para duas casas decimais.\nMargalef <- round((riqueza_sp - 1)/log(abundancia), 2)\nMargalef\n#>  Com_1  Com_2  Com_3  Com_4  Com_5  Com_6  Com_7  Com_8  Com_9 Com_10 \n#>   1.95   1.95   1.12   0.91   1.08   1.31   0.72   1.00   1.85   1.25\n## √çndice de Menhinick\nMenhinick <- round(riqueza_sp/sqrt(abundancia), 2)\nMenhinick\n#>  Com_1  Com_2  Com_3  Com_4  Com_5  Com_6  Com_7  Com_8  Com_9 Com_10 \n#>   1.00   1.00   0.83   0.56   0.79   0.88   1.00   0.89   1.55   1.21\n## Juntando todos os dados em um √∫nico data frame\ndados <- data.frame(precipitacao$prec, riqueza_sp, Margalef, Menhinick)\n\n## Renomenado as colunas\ncolnames(dados) <- c(\"Precipitacao\", \"Riqueza\", \"Margalef\", \"Menhinick\")\n\n## ANOVA\nanova_riq <- lm(Riqueza ~ Precipitacao, data = dados)\nanova(anova_riq)\n#> Analysis of Variance Table\n#> \n#> Response: Riqueza\n#>              Df Sum Sq Mean Sq F value  Pr(>F)  \n#> Precipitacao  1 30.622 30.6224  8.9156 0.01744 *\n#> Residuals     8 27.478  3.4347                  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## ANOVA\nanova_marg <- lm(Margalef ~ Precipitacao, data = dados)\nanova(anova_marg)\n#> Analysis of Variance Table\n#> \n#> Response: Margalef\n#>              Df  Sum Sq Mean Sq F value Pr(>F)\n#> Precipitacao  1 0.37865 0.37865  2.1201 0.1835\n#> Residuals     8 1.42879 0.17860\n## ANOVA\nanova_menh <- lm(Menhinick ~ Precipitacao, data = dados)\nanova(anova_menh)\n#> Analysis of Variance Table\n#> \n#> Response: Menhinick\n#>              Df  Sum Sq  Mean Sq F value Pr(>F)\n#> Precipitacao  1 0.07626 0.076262  1.0992 0.3251\n#> Residuals     8 0.55503 0.069378\n## Gr√°fico\nggplot(data = dados, aes(x= Precipitacao, y= Riqueza)) + \n    labs(x = \"Precipita√ß√£o anual (mm)\", y = \"Riqueza de esp√©cies\") +\n    geom_point(size = 4, shape = 21, fill = \"darkorange\", alpha = 0.7) +\n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    tema_livro()"},{"path":"cap12.html","id":"diversidade-de-esp√©cies","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"12.2.2 Diversidade de esp√©cies","text":"Diferente dos √≠ndices de riqueza de esp√©cies que n√£o levam em considera√ß√£o abund√¢ncia relativa das esp√©cies (.e.¬†todas esp√©cies tem o mesmo peso), os √≠ndices de diversidade avaliam al√©m da riqueza, domin√¢ncia ou raridade das esp√©cies nas comunidades. Assim, quando comparamos duas comunidades com mesma riqueza de esp√©cies, e uma das comunidades √© dominada por uma √∫nica esp√©cie e outra comunidade apresenta esp√©cies com abund√¢ncias parecidas, consideramos segunda comunidade mais diversa. Os √≠ndices de diversidade variam porque eles d√£o pesos diferentes para riqueza e equitabilidade das esp√©cies. Assim, um determinado √≠ndice de diversidade pode indicar que uma comunidade X √© mais diversa que uma comunidade Y, enquanto outro √≠ndice indica o oposto (Melo 2008). Portanto, uma maneira de determinar qual √≠ndice de diversidade usar √© saber se voc√™ quer dar maior peso para riqueza ou equitabilidade das esp√©cies nas comunidades. üìù Importante \nRessaltamos que h√° v√°rias cr√≠ticas em rela√ß√£o ao uso dos √≠ndices de diversidade que s√£o abstratos e dif√≠ceis de se interpretar (Hurlbert 1971). Por exemplo, dizer que o valor X estimado por √≠ndices de diversidade √© alto ou baixo √© irrelevante se n√£o tivermos uma base comparativa (para mais detalhes veja Melo (2008)).Os dois √≠ndices de diversidade mais usados em Ecologia s√£o:1. √çndice de Shannon-WienerQuantifica incerteza associada em predizer identidade de uma esp√©cie dado o n√∫mero de esp√©cies e distribui√ß√£o de abund√¢ncia para cada esp√©cie. Este √≠ndice √© mais sens√≠vel √† mudan√ßas nas esp√©cies raras da comunidade.\\[H' = -\\sum_{=1}^{S}p_i * ln p_i\\]onde:pi = abund√¢ncia relativa de cada esp√©cie, calculada pela propor√ß√£o dos indiv√≠duos de uma esp√©cie pelo n√∫mero total dos indiv√≠duos na comunidadeln = logaritmo natural, mas outras bases logar√≠tmas podem ser utilizadasH‚Äô = n√£o tem um valor m√°ximo e sua interpreta√ß√£o √© comparativa, com valores maiores indicando maior diversidade2. √çndice de SimpsonQuantifica probabilidade de dois indiv√≠duos retirados ao acaso da comunidade pertencerem √† mesma esp√©cie. Este √≠ndice √© na verdade uma medida de domin√¢ncia. Assim como probabilidade dos indiv√≠duos serem da mesma esp√©cie diminui com o aumento da riqueza de esp√©cies, o √≠ndice de Simpson tamb√©m diminui com riqueza.\\[D = \\sum_{=1}^{S}p_i^2\\]onde:Pi = abund√¢ncia relativa de cada esp√©cie, calculada pela propor√ß√£o dos indiv√≠duos de uma esp√©cie pelo n√∫mero total dos indiv√≠duos na comunidadePi = abund√¢ncia relativa de cada esp√©cie, calculada pela propor√ß√£o dos indiv√≠duos de uma esp√©cie pelo n√∫mero total dos indiv√≠duos na comunidadeD = varia de 0 1, com valores pr√≥ximos de 1 indicando menor diversidade enquanto valores pr√≥ximos de 0 indicam maior diversidade. Para evitar confus√£o nas interpreta√ß√µes, normalmente o √≠ndice de Simpson √© expressado como o valor inverso (1 - D) para que os maiores valores representem maior diversidade. Neste caso, o valor inverso √© conhecido na literatura como √≠ndice Gini-Simpson. Para o √≠ndice Gini-Simpson estamos avaliando probabilidade de dois indiv√≠duos retirados ao acaso da comunidade sejam de esp√©cies diferentes.D = varia de 0 1, com valores pr√≥ximos de 1 indicando menor diversidade enquanto valores pr√≥ximos de 0 indicam maior diversidade. Para evitar confus√£o nas interpreta√ß√µes, normalmente o √≠ndice de Simpson √© expressado como o valor inverso (1 - D) para que os maiores valores representem maior diversidade. Neste caso, o valor inverso √© conhecido na literatura como √≠ndice Gini-Simpson. Para o √≠ndice Gini-Simpson estamos avaliando probabilidade de dois indiv√≠duos retirados ao acaso da comunidade sejam de esp√©cies diferentes.Exemplo pr√°tico 2Explica√ß√£o dos dadosUsaremos os mesmos dados simulados exemplo pr√°tico 1.PerguntaA varia√ß√£o espacial na diversidade de esp√©cies das comunidades est√° associado com o gradiente de precipita√ß√£o?Predi√ß√µesOs valores de diversidade de esp√©cies ser√£o maiores nas comunidades localizadas em regi√µes maior volume de precipita√ß√£o que em regi√µes mais secasAn√°liseAbaixo demonstramos os c√≥digos R para determinar diversidade de esp√©cies para cada comunidade partir da planilha de composi√ß√£o de esp√©cies.O argumento index = \"simpson\", calcula o √≠ndice Gini-Simpson (1-D).Interpreta√ß√£o dos resultadosA comunidade 1 foi comunidade que apresentou maior diversidade de esp√©cies (Shannon-Wiener = 2,3 e Gini-Simpson = 0.9), enquanto comunidade 2 foi comunidade que apresentou menor diversidade (Shannon-Wiener = 0,5 e Gini-Simpson = 0,17). Gostar√≠amos de chamar aten√ß√£o para import√¢ncia da distribui√ß√£o da abund√¢ncia relativa das esp√©cies dentro das comunidades. Percebam que tanto comunidade 1 quanto comunidade 2 abrigam o mesmo n√∫mero de esp√©cies (10 esp√©cies) e abund√¢ncia total (100 indiv√≠duos), mas o padr√£o de distribui√ß√£o da abund√¢ncia relativa entre esp√©cies dentro das comunidades s√£o bem discrepantes. Na comunidade 1 esp√©cies apresentam abund√¢ncias semelhantes entre elas (.e.¬†alta equitabilidade), enquanto na comunidade 2 uma esp√©cie √© dominante e outras raras (.e.¬†baixa equitabilidade). Essa diferen√ßa na distribui√ß√£o da abund√¢ncia relativa entre comunidades √© um fator muito importante para os √≠ndices de diversidade.Dentro desta perspectiva, alguns √≠ndices fornecem uma estimativa sobre equitabilidade da distribui√ß√£o da abund√¢ncia nas comunidades. Entre eles, o mais conhecido foi proposto por Pielou (1966).√çndice de Equabilidade (ou Equitabilidade) de Pielou√â uma m√©trica derivada √≠ndice de Shannon-Wiener que descreve o padr√£o de distribui√ß√£o da abund√¢ncia relativa das esp√©cies na comunidade.\\[J = \\frac{H'}{Hmax} = \\frac{H'}{ln (S)}\\]onde:H‚Äô = √≠ndice de Shannon-WienerHmax = todas esp√©cies teriam mesma abund√¢ncia relativaHmax √© calculado aplicando o logaritmo natural (ln) para riqueza de esp√©cies (S)Se todas esp√©cies apresentam mesma abund√¢ncia relativa, ent√£o J = 1. Se uma esp√©cie apresenta forte domin√¢ncia, J aproxima-se de zeroN√£o h√° uma fun√ß√£o R que calcule o √≠ndice de Pielou, mas ele pode facilmente ser calculado usando os valores de diversidade de Shannon-Wiener e o logaritmo da riqueza de esp√©cies de cada comunidade.Agora que temos uma ideia de como riqueza de esp√©cies e distribui√ß√£o da abund√¢ncia relativa s√£o importantes para quantificar os valores dos √≠ndices de diversidade, vamos testar se h√° alguma rela√ß√£o entre os √≠ndices de diversidade e precipita√ß√£o anual nas comunidades.Vamos realizar uma regress√£o simples para verificar rela√ß√£o entre o √≠ndice de Shannon-Wiener e precipita√ß√£o anual nas comunidades.Agora, vamos realizar uma regress√£o simples para verificar rela√ß√£o entre o √≠ndice de Simpson e precipita√ß√£o anual nas comunidades.Por fim, vamos fazer regress√£o simples para verificar rela√ß√£o entre o √≠ndice de Pielou e precipita√ß√£o anual nas comunidades. üìù Importante \nan√°lises acima s√£o apenas ilustrativas. N√£o estamos avaliando premissas de normalidade e homogeneidade da vari√¢ncia dos res√≠duos (veja Cap√≠tulo 7). Al√©m disso, √© importante estar ciente das cr√≠ticas e limita√ß√µes de usar √≠ndices de Shannon e Simpson como nesses exemplos (Lou Jost 2007).Interpreta√ß√£o dos resultadosA varia√ß√£o espacial na diversidade de esp√©cies, obtida atrav√©s dos √≠ndices de Shannon-Wiener e Simpson, e equitabilidade de Pielou n√£o foram associados com varia√ß√£o na precipita√ß√£o anual entre √°reas (P > 0,05).","code":"\n## √çndice de Shannon\n# MARGIN = 1 significa que a fun√ß√£o ir√° calcular o √≠ndice considerando \n# as linhas do data.frame (comunidades).\nshannon_res <- diversity(composicao_especies, index = \"shannon\", MARGIN = 1)\nshannon_res\n#>     Com_1     Com_2     Com_3     Com_4     Com_5     Com_6     Com_7     Com_8     Com_9    Com_10 \n#> 2.3025851 0.5002880 0.9580109 1.6068659 1.4861894 1.5607038 0.6931472 1.1058899 1.7140875 1.2636544\n## √çndice de Simpson\nsimpson_res <- diversity(composicao_especies, index = \"simpson\", MARGIN = 1) \nsimpson_res\n#>     Com_1     Com_2     Com_3     Com_4     Com_5     Com_6     Com_7     Com_8     Com_9    Com_10 \n#> 0.9000000 0.1710000 0.4814815 0.7989636 0.7587500 0.7674858 0.5000000 0.5850000 0.8088889 0.6942149\n## √çndice de Pielou\nPielou <- shannon_res/log(specnumber(composicao_especies))\n## Juntando todos os dados em um √∫nico data frame\ndados_div <- data.frame(precipitacao$prec, shannon_res, \n                        simpson_res, Pielou)\n\n## Renomeando as colunas\ncolnames(dados_div) <- c(\"Precipitacao\", \"Shannon\", \"Simpson\", \"Pielou\")\n## ANOVA\nanova_shan <- lm(Shannon ~ Precipitacao, data = dados_div)\nanova(anova_shan)\n#> Analysis of Variance Table\n#> \n#> Response: Shannon\n#>              Df  Sum Sq Mean Sq F value Pr(>F)\n#> Precipitacao  1 0.10989 0.10989  0.3627 0.5637\n#> Residuals     8 2.42366 0.30296\n## ANOVA\nanova_simp <- lm(Simpson ~ Precipitacao, data = dados_div)\nanova(anova_simp)\n#> Analysis of Variance Table\n#> \n#> Response: Simpson\n#>              Df  Sum Sq  Mean Sq F value Pr(>F)\n#> Precipitacao  1 0.00132 0.001325  0.0252 0.8778\n#> Residuals     8 0.42064 0.052580\n## ANOVA\nanova_piel <- lm(Pielou ~ Precipitacao, data = dados_div)\nanova(anova_piel)\n#> Analysis of Variance Table\n#> \n#> Response: Pielou\n#>              Df  Sum Sq  Mean Sq F value Pr(>F)\n#> Precipitacao  1 0.09080 0.090798  1.5792 0.2443\n#> Residuals     8 0.45997 0.057496"},{"path":"cap12.html","id":"diagramas-de-whittaker-ou-curva-de-domin√¢ncia","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"12.2.3 Diagramas de Whittaker ou Curva de Domin√¢ncia","text":"Embora os √≠ndices de diversidade de esp√©cies englobem os componentes de riqueza e abund√¢ncia relativa das esp√©cies nas suas estimativas, n√£o √© poss√≠vel conhecer o n√∫mero de esp√©cies ou quais s√£o esp√©cies dominantes ou raras dentro das comunidades. Por exemplo, duas comunidades podem ter o mesmo valor de diversidade e ainda assim apresentarem diferen√ßas na riqueza e equitabilidade (Melo 2008). O Diagrama de Whittaker √© um m√©todo que lida com essas quest√µes utilizando informa√ß√µes visuais n√∫mero de esp√©cies e abund√¢ncia relativa de cada esp√©cie nas comunidades. Este m√©todo plota esp√©cies ranqueadas eixo X da mais abundante para menos abundante, enquanto eixo Y abund√¢ncias relativas das esp√©cies s√£o plotadas em escala logar√≠tmica (log10). Este gr√°fico permite ao leitor reconhecer: ) riqueza de esp√©cies observando o eixo X, ii) equitabilidade da abund√¢ncia relativa das esp√©cies pela inclina√ß√£o da reta, e iii) quais s√£o esp√©cies dominantes, intermedi√°rias e raras nas comunidades atrav√©s da observa√ß√£o em rela√ß√£o ao eixo Y. partir destas curvas, v√°rios autores propuseram modelos matem√°ticos para explicar distribui√ß√£o de abund√¢ncia das esp√©cies gerando diferentes modelos te√≥ricos (e.g.¬†s√©rie geom√©trica, broken-stick, log-series e log-normal). Cada modelo possui predi√ß√µes distintas: o modelo geom√©trico prediz distribui√ß√£o de abund√¢ncias desiguais, broken-stick prediz distribui√ß√£o de abund√¢ncias uniformes, enquanto log-normal e log-series s√£o intermedi√°rias com predi√ß√µes distintas sobre propor√ß√µes de esp√©cies raras - alta em log-series, baixa em log-normal (veja McGill et al. (2007) para revis√£o).Para an√°lises explorat√≥rias onde voc√™ tem interesse em visualizar o padr√£o da distribui√ß√£o relativa das esp√©cies por comunidade, fun√ß√£o rankabundance pacote BiodiversityR √© uma op√ß√£o interessante (Figura 12.2).\nFigura 12.2: Diagramas de Whittaker para duas comunidades.\nInterpreta√ß√£o dos resultadosPercebam que olhando os eixos gr√°fico conseguimos determinar que Comunidade 2 (c√≠rculo laranja) abriga 10 esp√©cies total (.e.¬†comprimento eixo X), com esp√©cie sp1 apresentando alta domin√¢ncia e outras esp√©cies apresentando abund√¢ncias muito baixas. Comunidade 3 (c√≠rculo ciano) abriga cinco esp√©cies total, sendo que esp√©cie sp4 apresenta alta domin√¢ncia, duas esp√©cies apresentam abund√¢ncias intermedi√°rias e outras duas abund√¢ncias baixas.","code":"\n## C√°lculo da curva para as comunidades 2 e 3\nrank_com2 <- rankabundance(composicao_especies[2, composicao_especies[2,] > 0])\nrank_com3 <- rankabundance(composicao_especies[3, composicao_especies[3,] > 0])\n\n## Gr√°fico \n# Veja a ajuda da fun√ß√£o rankabundplot para outros exemplos de gr√°ficos.\nrankabunplot(rank_com2, scale = \"logabun\", specnames = c(1), \n             pch = 19, col = \"darkorange\")\nrankabunplot(rank_com3, scale = \"logabun\", specnames = c(1), pch = 19, \n             xlim = c(0,10), addit = TRUE, col = \"cyan4\" , legend = TRUE)\nlegend(5, 40, legend = c(\"Comunidade 2\", \"Comunidade 3\"),\n       col = c(\"darkorange\", \"cyan4\"), lty = 1, cex = 0.8, box.lty = 0)"},{"path":"cap12.html","id":"curvas-de-distribui√ß√£o-de-abund√¢ncias","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"12.2.4 Curvas de distribui√ß√£o de abund√¢ncias","text":"Caso o interesse seja avaliar qual dos modelos te√≥ricos melhor explica distribui√ß√£o das abund√¢ncias das esp√©cies, fun√ß√£o radift() pacote vegan √© melhor op√ß√£o.fun√ß√£o radfit avalia cinco modelos te√≥ricos para determinar qual deles melhor se ajustam aos dados. Os modelos te√≥ricos avaliados na fun√ß√£o s√£o:Null = modelo broken-stickpreemption = s√©rie geom√©tricalog-normalZipfZipf-MandelbrotVoc√™ pode realizar an√°lises separadamente para cada comunidade ou para todas comunidades ao mesmo tempo.Vamos come√ßar avaliando separadamente Comunidade 2.Agora vamos fazer um gr√°fico com predi√ß√µes dos modelos (Figura 12.3).\nFigura 12.3: Teste de cinco Diagramas de Whittaker para Comunidade 2.\nInterpreta√ß√£o dos resultadosOs pontos brancos representam esp√©cies ranqueadas de acordo com abund√¢ncia e linhas representam predi√ß√µes dos modelos mat√©maticos. Com base nos valores de AIC (veja Cap√≠tulo 7), o modelo Zipf √© o melhor modelo que explica distribui√ß√£o da abund√¢ncia relativa das esp√©cies na Comunidade 2.Agora vamos analisar os dados considerando todas comunidades (Figura 12.4).\nFigura 12.4: Testes de cinco Diagramas de Whittaker para todas comunidades.\nInterpreta√ß√£o dos resultadosA Comunidade 1 foi associada com o modelo log-normal, Comunidades 2 e 4 com o modelo Zipf, Comunidade 3 com o modelo s√©rie geom√©trica e outras comunidades com o modelo nulo. Para explorar explica√ß√£o biol√≥gica por tr√°s destes modelos veja os artigos (Wilson 1991; McGill et al. 2007; Magurran McGill 2011). üìù Importante \nliga√ß√£o entre o modelo matem√°tico e explica√ß√£o biol√≥gica precisa ser interpretada com cuidado porque diferentes modelos matem√°ticos podem levar ao mesmo padr√£o de distribui√ß√£o de abund√¢ncia.","code":"\n## Teste das curvas de distribui√ß√£o de abund√¢ncias\ncurvas_dominancia_com2 <- radfit(composicao_especies[2,])\ncurvas_dominancia_com2\n#> \n#> RAD models, family poisson \n#> No. of species 10, total abundance 100\n#> \n#>            par1     par2    par3        Deviance AIC     BIC    \n#> Null                                    175.242  199.592 199.592\n#> Preemption  0.68962                      79.560  105.910 106.213\n#> Lognormal  -0.65366  3.2485              47.350   75.701  76.306\n#> Zipf        0.83829 -3.0254              26.612   54.963  55.568\n#> Mandelbrot  0.83829 -3.0254  1.6448e-07  26.612   56.963  57.871\nplot(curvas_dominancia_com2, \n     ylab = \"Abund√¢ncia\", \n     xlab = \"Ranqueamento das esp√©cies\")\n## Teste das curvas de distribui√ß√£o de abund√¢ncias\ncurvas_dominancia_todas <- radfit(composicao_especies)\ncurvas_dominancia_todas\n#> \n#> Deviance for RAD models:\n#> \n#>                  Com_1       Com_2       Com_3       Com_4       Com_5       Com_6       Com_7       Com_8       Com_9\n#> Null        8.2193e+01  1.7524e+02  8.9085e+00  4.2265e+01  4.9719e+00  4.7099e+00  1.1507e+00  1.8998e+00  2.7703e+00\n#> Preemption  2.2878e+01  7.9560e+01  1.5423e+00  1.4332e+01  3.0438e+00  4.5536e+00  7.7259e-01  1.7847e+00  9.2518e-01\n#> Lognormal   1.7764e-15  4.7350e+01  1.0161e+00  2.9441e-02  1.9303e+00  4.8898e+00 -2.2053e-25  1.4556e+00  2.0626e-01\n#> Zipf       -1.7764e-15  2.6612e+01  2.1659e-01  1.5846e-02  3.6094e+00  8.3245e+00 -2.2073e-25  6.6938e-01  4.7931e-01\n#> Mandelbrot -1.7764e-15  2.6612e+01  2.0926e-01  1.1390e-02  1.8740e+00  4.1131e+00  0.0000e+00  6.6938e-01  2.3634e-01\n#>            Com_10\n#> Null       1.1146\n#> Preemption 0.7428\n#> Lognormal  0.5079\n#> Zipf       0.8730\n#> Mandelbrot 0.4456\n\n# Vamos fazer um gr√°fico para cada comunidade\nplot(curvas_dominancia_todas, log = \"y\")"},{"path":"cap12.html","id":"n√∫meros-de-hill-ou-s√©rie-de-hill","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"12.2.5 N√∫meros de Hill ou S√©rie de Hill","text":"Embora os √≠ndices de Shannon-Wiener e Gini-Simpson sejam amplamente usados em estudos ecol√≥gicos e de conserva√ß√£o, eles sofrem de propriedades matem√°ticas e n√£o representam diversidade propriamente dita (L. Jost 2006). Portanto, quando o objetivo √© avaliar diversidade, os √≠ndices de Shannon-Wiener e Gini-Simpson n√£o deveriam ser utilizados na sua forma padr√£o, mas transformados em n√∫meros efetivos de esp√©cies ou diversidade verdadeira (L. Jost 2006). O n√∫mero efetivo de esp√©cies √© o n√∫mero de esp√©cies igualmente abundantes (.e.¬†todas esp√©cies com mesma abund√¢ncia) necess√°rias para produzir o valor observado para um determinado √≠ndice. Por exemplo, uma comunidade com √≠ndice de Shannon-Wiener estimado de 4,5 teria um n√∫mero efetivo de 90 esp√©cies igualmente abundantes. Jost et al. (2006) usam o seguinte exemplo para explicar o conceito n√∫mero efetivo de esp√©cies - uma comunidade com 16 esp√©cies igualmente abundantes √© duas vezes mais diversa que uma comunidade com 8 esp√©cies igualmente abundantes. Neste caso, diversidade deveria ser proporcional ao n√∫mero de esp√©cies. Contudo, quando aplicamos os √≠ndices de diversidade para estas comunidades com 16 e 8 esp√©cies (cada esp√©cie com 5 indiv√≠duos), o √≠ndice de Shannon-Wiener √© 2,772 e 2,079, respectivamente, e o √≠ndice de Gini-Simpson √© 0,937 e 0,875, respectivamente. Claramente, os valores estimados pelos √≠ndices de diversidade n√£o representam diferen√ßa entre comunidades porque eles carecem de uma particularidade matem√°tica conhecida como propriedade de duplica√ß√£o.O pr√≥ximo exemplo (modificado website de Lou Jost; http://www.loujost.com/), demostra import√¢ncia da transforma√ß√£o dos √≠ndices de diversidade em n√∫meros efetivos de esp√©cies. Imagine que voc√™ foi contratado para avaliar diversidade de peixes em um riacho antes e depois da instala√ß√£o de uma usina hidrel√©trica. Suponha que os valores estimados pelo √≠ndice de Gini-Simpson foi de 0,99 antes da instala√ß√£o e de 0,97 depois da instala√ß√£o. princ√≠pio, voc√™ poderia concluir que diversidade diminuiu somente 2% e que instala√ß√£o da hidrel√©trica n√£o afetou diversidade de peixes riacho. Contudo, transformando os valores √≠ndice de diversidade em n√∫meros efetivos, percebemos que antes da instala√ß√£o diversidade riacho equivale 100 esp√©cies igualmente abundantes, enquanto ap√≥s instala√ß√£o, diversidade equivale 33 esp√©cies igualmente abundantes. Portanto, queda da diversidade foi de 66% e n√£o 2%.Hill (1973) derivou uma equa√ß√£o geral para o c√°lculo n√∫mero efetivo de esp√©cies ou diversidade verdadeira que depende apenas valor de q e da abund√¢ncia relativa das esp√©cies.\\[^qD = (\\sum_{=1}^{S}p_i^q)^{1/(1-q)}\\]Onde:q = √© um par√¢metro conhecido como ordem da diversidade e √© usado para dar peso √†s esp√©cies comuns ou raras. q = 0 n√£o considera frequ√™ncia das esp√©cies e representa riqueza observada de esp√©cies, q = 1 equivale transforma√ß√£o √≠ndice de Shannon-Wiener (.e.¬†exp(H‚Äô)) e atribui pesos √†s esp√©cies com base na propor√ß√£o das suas frequ√™ncias e, q = 2 equivale √† transforma√ß√£o √≠ndice de Gini-Simpson (.e.¬†1/(1-D)) e atribui peso √†s esp√©cies mais comuns. Valores de q <1 favorecem esp√©cies raras, enquanto valores de q > 1 favorecem esp√©cies comuns.q = √© um par√¢metro conhecido como ordem da diversidade e √© usado para dar peso √†s esp√©cies comuns ou raras. q = 0 n√£o considera frequ√™ncia das esp√©cies e representa riqueza observada de esp√©cies, q = 1 equivale transforma√ß√£o √≠ndice de Shannon-Wiener (.e.¬†exp(H‚Äô)) e atribui pesos √†s esp√©cies com base na propor√ß√£o das suas frequ√™ncias e, q = 2 equivale √† transforma√ß√£o √≠ndice de Gini-Simpson (.e.¬†1/(1-D)) e atribui peso √†s esp√©cies mais comuns. Valores de q <1 favorecem esp√©cies raras, enquanto valores de q > 1 favorecem esp√©cies comuns.pi = abund√¢ncia relativa de cada esp√©cie, calculada pela propor√ß√£o dos indiv√≠duos de uma esp√©cie pelo n√∫mero total dos indiv√≠duos na comunidadepi = abund√¢ncia relativa de cada esp√©cie, calculada pela propor√ß√£o dos indiv√≠duos de uma esp√©cie pelo n√∫mero total dos indiv√≠duos na comunidadeVamos calcular o N√∫mero de Hill para comunidades nosso exemplo.Calculando o N√∫mero de Hill com q = 0.Calculando o N√∫mero de Hill com q = 1.Calculando o N√∫mero de Hill com q = 2.Criando um data frame com os tr√™s resultados anteriores.Interpreta√ß√£o dos resultadosComo na comunidade 1 todas esp√©cies s√£o igualmente abundantes, alterar os valores de q n√£o altera o n√∫mero efetivo de esp√©cies que permanece sempre 10. Contudo, na comunidade 2, que apresenta alta domin√¢ncia de uma esp√©cie, alterar os valores de q diminui consideravelmente estimativa da diversidade. vantagem dos N√∫meros de Hill √© que eles s√£o de f√°cil interpreta√ß√£o e compara√ß√£o entre comunidades. Fator ausente para os √≠ndices de diversidade. üìù Importante \nNeste ponto, esperamos que tenha ficado claro que mais que riqueza de esp√©cies, abund√¢ncia relativa das esp√©cies (e.g.¬†comuns ou raras) tem um papel fundamental na estimativa da diversidade de esp√©cies.","code":"\n## N√∫mero de Hill para q = 0\nhill_res_q_0 <- hill_taxa(composicao_especies, q  = 0)\nhill_res_q_0\n#>  Com_1  Com_2  Com_3  Com_4  Com_5  Com_6  Com_7  Com_8  Com_9 Com_10 \n#>     10     10      5      5      5      6      2      4      6      4\n## N√∫mero de Hill para q = 1\nhill_res_q_1 <- hill_taxa(composicao_especies, q  = 1)\nhill_res_q_1\n#>     Com_1     Com_2     Com_3     Com_4     Com_5     Com_6     Com_7     Com_8     Com_9    Com_10 \n#> 10.000000  1.649196  2.606507  4.987156  4.420220  4.762172  2.000000  3.021912  5.551608  3.538328\n## N√∫mero de Hill para q = 2\nhill_res_q_2 <- hill_taxa(composicao_especies, q  = 2)\nhill_res_q_2\n#>     Com_1     Com_2     Com_3     Com_4     Com_5     Com_6     Com_7     Com_8     Com_9    Com_10 \n#> 10.000000  1.206273  1.928571  4.974223  4.145078  4.300813  2.000000  2.409639  5.232558  3.270270\n## Resultados\nres_hill <- data.frame(hill_res_q_0, hill_res_q_1, hill_res_q_2)\ncolnames(res_hill) <- c(\"q=0\", \"q=1\", \"q=2\")\nhead(res_hill)\n#>       q=0       q=1       q=2\n#> Com_1  10 10.000000 10.000000\n#> Com_2  10  1.649196  1.206273\n#> Com_3   5  2.606507  1.928571\n#> Com_4   5  4.987156  4.974223\n#> Com_5   5  4.420220  4.145078\n#> Com_6   6  4.762172  4.300813"},{"path":"cap12.html","id":"diversidade-beta","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"12.3 Diversidade beta","text":"O termo diversidade beta foi proposto por Whittker (1960) e foi definido como raz√£o entre diversidade gama e diversidade alfa (.e.¬†diversidade beta multiplicativa), quantificando n√£o s√≥ rela√ß√£o entre diversidade regional e local, mas tamb√©m o grau de diferencia√ß√£o entre comunidades. Para demonstrar como diversidade beta varia entre comunidades locais dentro de uma regi√£o usaremos explica√ß√£o Baselga (http://webspersoais.usc.es/persoais/andres.baselga/beta.html). Imagine tr√™s comunidades, cada comunidade abrigando mesmas cinco esp√©cies. Neste caso, m√©dia da diversidade alfa = 5, diversidade gama = 5 e raz√£o entre elas (gama/alfa) indica uma diversidade beta = 1. Isso significa que na regi√£o existe apenas uma unidade distinta de composi√ß√£o. Quando composi√ß√£o de esp√©cies das tr√™s comunidades √© completamente diferente (.e.¬†diferencia√ß√£o m√°xima), temos que m√©dia da diversidade alfa = 5, diversidade gama = 15 e raz√£o entre elas indica uma diversidade beta = 3. Neste caso, existem tr√™s unidades distintas dentro da regi√£o. Assim, diversidade beta multiplicativa varia de 1 at√© o n√∫mero de comunidades dentro da regi√£o.maioria dos √≠ndices de (dis)similaridade utilizadas na ecologia (e.g.¬†√≠ndices de Jaccard e S√∏rensen) s√£o √≠ndices que padronizam diversidade beta e geram valores independentes n√∫mero de comunidades. Eles podem ser calculados para dados de incid√™ncia (presen√ßa e aus√™ncia) ou abund√¢ncia (Legendre Legendre 2012) e considerando compara√ß√µes par--par entre comunidades ou compara√ß√£o entre m√∫ltiplas comunidades (.e.¬†multiple-site). Por muito tempo, os valores de (dis)similaridade foram interpretados como sin√¥nimo de substitui√ß√£o de esp√©cies (turnover) entre comunidades. Contudo, √≠ndices de (dis)similaridade como Jaccard e S√∏rensen geram valores de (dis)similaridade para comunidades que n√£o apresentam diferen√ßas na composi√ß√£o de esp√©cies, mas apresentam diferen√ßas na riqueza de esp√©cies (.e.¬†comunidades aninhadas). Pensando nestes fatores, Baselga (2010, 2012) prop√¥s uma abordagem que particiona diversidade beta total (\\(\\beta\\)jac) em dois componentes: o componente resultante da substitui√ß√£o de esp√©cies (turnover - \\(\\beta\\)tur) e o componente resultante aninhamento (nestedness, .e.¬†diferen√ßa na riqueza de esp√©cies - \\(\\beta\\)nes). Vejam (Figura 12.5) onde temos 3 comunidades (X, Y e Z). primeiro exemplo, temos apenas diferen√ßa n√∫mero de esp√©cies entre comunidades. Neste caso, o componente subsitui√ß√£o de esp√©cies (\\(\\beta\\)tur) √© zero porque esp√©cies na comunidade Z s√£o um sub-grupo das esp√©cies nas comunidades X e Y. O mesmo para esp√©cies na comunidade Y que s√£o um sub-grupo das esp√©cies da comunidade X. segundo exemplo, temos o cen√°rio oposto com comunidades abrigando mesma riqueza de esp√©cies e assim, o componente resultante aninhamento (\\(\\beta\\)nes) √© zero, temos um valor m√°ximo para o \\(\\beta\\)tur. Percebam que somando \\(\\beta\\)tur com \\(\\beta\\)nes temos o valor da diversidade beta total (\\(\\beta\\)jac). Baselga (2013) tamb√©m prop√¥s parti√ß√£o da diversidade beta para √≠ndices de dissimilaridade que lidam com dados de abund√¢ncia. Neste caso os componentes da diversidade beta s√£o chamados de varia√ß√£o balanceada na abund√¢ncia (similar ao componente substitui√ß√£o de esp√©cies) e gradiente de abund√¢ncia (similar ao componente aninhamento). Reconhecer estes componentes da diversidade beta √© importante porque eles apresentam padr√µes distintos (substitui√ß√£o de esp√©cies versus perda ordenada de esp√©cies), que provavelmente est√£o sendo gerados por processos ecol√≥gicos diferentes (Baselga 2010, 2012, 2013).\nFigura 12.5: Parti√ß√£o da diversidade beta taxon√¥mica. Os tr√™s cen√°rios apresentados representama diversidade beta explicada somente por substitui√ß√£o, aninhamento e uma combina√ß√£o dos dois.\nAqui, vamos demonstrar alguns exemplos de como calcular parti√ß√£o da diversidade beta para os dados deste cap√≠tulo.Para isso, primeiro vamos transformar nossos dados de abund√¢ncia em presen√ßa e aus√™ncia.Calculando diversidade beta par par usando os dados de presen√ßa e aus√™ncia. üìù Importante \nfun√ß√£o beta.pair() gera tr√™s listas com matrizes triangulares:Diversidade beta total = √≠ndice de S√∏rensen (beta.sor)Componente de substitui√ß√£o = √≠ndice de Simpson (beta.sim)Componente de aninhamento = diferen√ßa na riqueza (beta.sne)Vamos olhar os resultados da diversidade beta total.Vamos montar um data.frame com os resultados üìù Importante \nPercebam que primeira linha e primeira coluna data frame (.e., 0.00) representa dissimilaridade de S√∏rensen entre Com1 e Com2 (compare com os valores da matriz triangular acima). linhas subsequentes representam dissimilaridade da Com1 com todas outras comunidades, depois da Com2 com todas comunidades e assim sucessivamente. Lembrem-se que os componentes, subsitui√ß√£o (Simpson) e aninhamento (beta.sor - beta.sim), s√£o um desdobramento da diversidade beta total (S√∏rensen). Assim, soma da dissimilaridade de Simpson e aninhamento √© igual ao valor de dissimilaridade de S√∏rensen (Baselga 2010, 2012).Vamos calcular dissimilaridade entre precipita√ß√£o anual das comunidades usando o √≠ndice de dist√¢ncia euclidiana. Vejam ajuda da fun√ß√£o vegdist() que calcula 17 √≠ndices diferentes de dissimilaridade.Agora vamos juntar os resultados. üìù Importante \ncomunidades devem estar dispostas na mesma ordem nas duas planilhas (composi√ß√£o de esp√©cies e precipita√ß√£o) para que os resultados representem dissimilaridades par par para mesmas comunidades data frame.Criando data frame.Vamos testar rela√ß√£o entre diferen√ßa na composi√ß√£o de esp√©cies e\nprecipita√ß√£o nas comunidades.Interpreta√ß√£o dos resultadosH√° uma rela√ß√£o positiva entre o componente aninhado da diversidade beta e diferen√ßa na precipita√ß√£o entre comunidades (F1,43 = 6,4, P = 0,01). Contudo, n√£o h√° rela√ß√£o entre diversidade beta total (S√∏rensen) e o componente substitui√ß√£o de esp√©cies (Simpson) com precipita√ß√£o (P > 0,05).Agora vamos fazer um gr√°fico com o componente aninhamento da diversidade\nbeta (Figura 12.6).\nFigura 12.6: Rela√ß√£o entre o componente de aninhamento da diversidade beta e diferen√ßa da precipita√ß√£o.\nInterpreta√ß√£o dos resultadosAs comunidades localizadas em locais com baixa precipita√ß√£o anual apresentam esp√©cies que s√£o um subgrupo das esp√©cies presentes nas comunidades com alta precipita√ß√£o anual.Agora vamos fazer um exemplo considerando os dados de abund√¢ncia das esp√©cies.fun√ß√£o beta.pair.abund() gera tr√™s listas com matrizes triangulares:Diversidade beta total = √≠ndice de Bray-Curtis (beta.bray)Componente varia√ß√£o balanceada (beta.bray.bal)Componente gradiente de abund√¢ncia (beta.bray.gra)An√°lise.Cria um data frame com os resultados.Testar rela√ß√£o da dissimilaridade considerando abund√¢ncia com diferen√ßa na precipita√ß√£o entre comunidades.Interpreta√ß√£o dos resultadosH√° uma rela√ß√£o positiva entre os componentes varia√ß√£o balanceada (F1,43 = 7,07, P = 0,01) e gradiente (F1,43 = 18,7, P < 0,001) de abund√¢ncia da diversidade beta com diferen√ßa na precipita√ß√£o entre comunidades. Contudo, n√£o h√° rela√ß√£o entre diversidade beta total (Bray) com precipita√ß√£o (F1,43 = 0,84, P = 0,36).Vamos fazer um gr√°fico para varia√ß√£o balanceada da diversidade beta (Figura 12.7).\nFigura 12.7: Rela√ß√£o entre o componente varia√ß√£o balanceada da diversidade beta e diferen√ßa da precipita√ß√£o.\nInterpreta√ß√£o dos resultadosOlhando o √≠nicio eixo X onde comunidades apresentam precipita√ß√£o anual similares (.e.¬†baixa diferen√ßa na precipita√ß√£o), o componente varia√ß√£o balanceada indica que h√° uma tend√™ncia das esp√©cies com maiores abund√¢ncias n√£o serem mesmas quando comparamos duas comunidades (.e.¬†maiores valores de dissimilaridade). Por outro lado, quando diferen√ßa na precipita√ß√£o entre duas comunidades √© alta, o componente varia√ß√£o balanceada √© baixo, indicando que mesmas esp√©cies est√£o dominando abund√¢ncia nas comunidades comparadas.Vamos fazer agora um gr√°fico para varia√ß√£o gradiente da diversidade beta (Figura 12.8).\nFigura 12.8: Rela√ß√£o entre o componente varia√ß√£o gradiente da diversidade beta e diferen√ßa da precipita√ß√£o.\nInterpreta√ß√£o dos resultadosOlhando o √≠nicio eixo X onde comunidades apresentam precipita√ß√£o anual similares (.e.¬†baixa diferen√ßa na precipita√ß√£o), o componente gradiente indica que h√° uma tend√™ncia das esp√©cies apresentarem abund√¢ncias parecidas (.e.¬†menor valor de dissimilaridade). Por outro lado, quando diferen√ßa na precipita√ß√£o entre duas comunidades √© alta, o componente gradiente √© alto, indicando que mesmas esp√©cies tem valores discrepantes de abund√¢ncias entre comunidades.","code":"\n## Transformando dados em presencia e aus√™ncia.\ncomposicao_PA <- decostand(composicao_especies, method = \"pa\")\n## Diversidade beta\nresultado_PA <- beta.pair(composicao_PA, index.family = \"sorensen\")\n## Resultados\nresultado_PA$beta.sor\n#>            Com_1     Com_2     Com_3     Com_4     Com_5     Com_6     Com_7     Com_8     Com_9\n#> Com_2  0.0000000                                                                                \n#> Com_3  0.3333333 0.3333333                                                                      \n#> Com_4  0.3333333 0.3333333 1.0000000                                                            \n#> Com_5  0.3333333 0.3333333 0.6000000 0.4000000                                                  \n#> Com_6  0.2500000 0.2500000 0.4545455 0.4545455 0.4545455                                        \n#> Com_7  0.6666667 0.6666667 0.7142857 0.7142857 1.0000000 0.7500000                              \n#> Com_8  0.4285714 0.4285714 0.7777778 0.3333333 0.3333333 0.2000000 1.0000000                    \n#> Com_9  0.2500000 0.2500000 0.4545455 0.4545455 0.2727273 0.5000000 0.7500000 0.4000000          \n#> Com_10 0.4285714 0.4285714 0.3333333 0.7777778 0.5555556 0.4000000 0.6666667 0.7500000 0.6000000\n## Data frame com os resultados\ndata.frame_PA <- data.frame(round(as.numeric(resultado_PA$beta.sor), 2),\n                            round(as.numeric(resultado_PA$beta.sim), 2),\n                            round(as.numeric(resultado_PA$beta.sne), 2))\ncolnames(data.frame_PA) <- c(\"Sorensen\", \"Simpson\", \"Aninhamento\")\nhead(data.frame_PA)\n#>   Sorensen Simpson Aninhamento\n#> 1     0.00       0        0.00\n#> 2     0.33       0        0.33\n#> 3     0.33       0        0.33\n#> 4     0.33       0        0.33\n#> 5     0.25       0        0.25\n#> 6     0.67       0        0.67\n## Dissimilaridade\nprec_dis <- vegdist(precipitacao, method = \"euclidian\")\ndados_prec <- as.numeric(prec_dis) \n## Data frame\ndados_dis <- data.frame(dados_prec, data.frame_PA)\nhead(dados_dis)\n#>   dados_prec Sorensen Simpson Aninhamento\n#> 1         88     0.00       0        0.00\n#> 2        400     0.33       0        0.33\n#> 3       1400     0.33       0        0.33\n#> 4        294     0.33       0        0.33\n#> 5        195     0.25       0        0.25\n#> 6       2270     0.67       0        0.67\n## ANOVA\n# Avaliar a rela√ß√£o entre os valores de diversidade beta total (S√∏rensen) e precipita√ß√£o.\nanova_sore <-lm(Sorensen ~ dados_prec, data = dados_dis)\nanova(anova_sore)\n#> Analysis of Variance Table\n#> \n#> Response: Sorensen\n#>            Df  Sum Sq  Mean Sq F value Pr(>F)\n#> dados_prec  1 0.00188 0.001877  0.0358 0.8508\n#> Residuals  43 2.25264 0.052387\n\n# Avaliar a rela√ß√£o entre os valores do componente substitui√ß√£o (Simpson) e precipita√ß√£o\nanova_simp <-lm(Simpson ~ dados_prec, data = dados_dis)\nanova(anova_simp)\n#> Analysis of Variance Table\n#> \n#> Response: Simpson\n#>            Df Sum Sq  Mean Sq F value Pr(>F)\n#> dados_prec  1 0.1403 0.140342  1.4905 0.2288\n#> Residuals  43 4.0488 0.094157\n\n# Avaliar a rela√ß√£o entre os valores do componente aninhamento e precipita√ß√£o\nanova_anin <-lm(Aninhamento ~ dados_prec, data = dados_dis)\nanova(anova_anin)\n#> Analysis of Variance Table\n#> \n#> Response: Aninhamento\n#>            Df  Sum Sq Mean Sq F value  Pr(>F)  \n#> dados_prec  1 0.17467 0.17467  6.4006 0.01515 *\n#> Residuals  43 1.17349 0.02729                  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Gr√°fico\nggplot(data = dados_dis, aes(x = dados_prec, y = Aninhamento)) + \n    geom_point(size = 4, shape = 21, fill = \"darkorange\") +\n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    labs(x = \"Diferen√ßa precipita√ß√£o (mm)\", \n         y = \"Componente aninhamento da\\n diversidade beta\") +\n    tema_livro()\n## Diversidade beta para abund√¢ncia\nresultado_AB <- beta.pair.abund(composicao_especies, index.family = \"bray\")\n## Data frame\n# Vamos montar um data.frame com os resultados.\ndata.frame_AB <- data.frame(round(as.numeric(resultado_AB$beta.bray), 2),\n                            round(as.numeric(resultado_AB$beta.bray.bal), 2),\n                            round(as.numeric(resultado_AB$beta.bray.gra), 2))\ncolnames(data.frame_AB) <- c(\"Bray\", \"Balanceada\", \"Gradiente\")\nhead(data.frame_AB)\n#>   Bray Balanceada Gradiente\n#> 1 0.81       0.81      0.00\n#> 2 0.69       0.42      0.27\n#> 3 0.45       0.38      0.06\n#> 4 0.47       0.07      0.40\n#> 5 0.47       0.15      0.31\n#> 6 0.92       0.00      0.92\n\n## Agora vamos juntar os resultados com a precipita√ß√£o\ndados_dis_AB <- data.frame(dados_prec, data.frame_AB)\n## ANOVA\n# Avaliar a rela√ß√£o entre os valores de diversidade beta total e precipita√ß√£o\nanova_dis_AB <- lm(Bray ~ dados_prec, data = dados_dis_AB)\nanova(anova_dis_AB)\n#> Analysis of Variance Table\n#> \n#> Response: Bray\n#>            Df  Sum Sq  Mean Sq F value Pr(>F)\n#> dados_prec  1 0.01782 0.017815  0.8441 0.3634\n#> Residuals  43 0.90755 0.021106\n\n# Avaliar a rela√ß√£o entre os valores do componente balanceada e precipita√ß√£o\nanova_balan <- lm(Balanceada ~ dados_prec, data = dados_dis_AB)\nanova(anova_balan)\n#> Analysis of Variance Table\n#> \n#> Response: Balanceada\n#>            Df  Sum Sq Mean Sq F value  Pr(>F)  \n#> dados_prec  1 0.48761 0.48761  7.0742 0.01094 *\n#> Residuals  43 2.96391 0.06893                  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Avaliar a rela√ß√£o entre os valores do componente gradiente e precipita√ß√£o\nanova_grad <- lm(Gradiente ~ dados_prec, data = dados_dis_AB)\nanova(anova_grad)\n#> Analysis of Variance Table\n#> \n#> Response: Gradiente\n#>            Df  Sum Sq Mean Sq F value    Pr(>F)    \n#> dados_prec  1 0.68981 0.68981  18.705 8.903e-05 ***\n#> Residuals  43 1.58575 0.03688                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nggplot(data = dados_dis_AB, aes(x = dados_prec, y = Balanceada)) + \n    geom_point(size = 4, shape = 21, fill = \"darkorange\") +\n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    labs(x = \"Diferen√ßa precipita√ß√£o (mm)\",\n         y = \"Componente varia√ß√£o balanceada\\n da diversidade beta\") +\n    tema_livro() \nggplot(data = dados_dis_AB, aes(x = dados_prec, y = Gradiente)) + \n    geom_point(size = 4, shape = 21, fill = \"darkorange\") +\n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    labs(x = \"Diferen√ßa precipita√ß√£o anual (mm)\", \n         y = \"Componente gradiente de abund√¢ncia\\n da diversidade beta\") +\n    tema_livro()"},{"path":"cap12.html","id":"para-se-aprofundar-8","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"12.4 Para se aprofundar","text":"","code":""},{"path":"cap12.html","id":"livros-6","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"12.4.1 Livros","text":"Recomendamos leitura dos artigos citados cap√≠tulo e os livros de Magurran & McGill (2011) - Biological Diversity Frontiers Measurement Assessment, e Legendre & Legendre (2012) - Numerical Ecology.","code":""},{"path":"cap12.html","id":"links-7","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"12.4.2 Links","text":"Recomendamos p√°gina pessoal pesquisador Lou Jost que apresenta e discute diversas medidas de diversidade taxon√¥mica:Medidas de diversidade e similaridadeMedindo diversidade de uma √∫nica localidadeComparando diversidade entre duas comunidadesN√∫mero efetivo de esp√©cies","code":""},{"path":"cap12.html","id":"exerc√≠cios-8","chapter":"Cap√≠tulo 12 Diversidade Taxon√¥mica","heading":"12.5 Exerc√≠cios","text":"12.1\nCarregue os dados - anuros_composicao - que est√° pacote ecodados. Este conjunto de dados representa abund√¢ncia de 211 esp√©cies de anuros coletados em 44 localidades na Mata Atl√¢ntica. Calcule riqueza de esp√©cies para cada comunidade e os √≠ndices de Margalef, Menhinich, Shannon-Wiener, Gini-Simpson e Equitabilidade de Pielou. Salve todos os resultados em novo data frame. Fa√ßa uma gr√°fico usando o fun√ß√£o ggpairs para ver correla√ß√£o entre m√©tricas. Qual sua interpreta√ß√£o sobre os resultados?12.2\nUsando os resultados anteriores, selecione duas comunidades com os maiores e menores valores de Shannon-Wiener. Em seguida, fa√ßa um Diagrama de Whittaker. Por fim, interprete curvas considerando curvas te√≥ricas (.e., geom√©trica, broken-stick, etc.) descritas nos livros de ecologia.12.3\nUsando os dados - anuros_composicao - calcule parti√ß√£o da diversidade beta considerando os dados de abund√¢ncia e presen√ßa e aus√™ncia. ) Fa√ßa um gr√°fico boxplot com os resultados. Discuta se os resultados usando abund√¢ncia ou presen√ßa e aus√™ncia s√£o congruentes ou discrepantes. b) Calcule dist√¢ncia geogr√°fica (use planilha anuros_ambientais) entre localidaes (use Dist√¢ncia Euclidiana). Em seguida, fa√ßa uma an√°lise de regress√£o para verificar se localidades que est√£o pr√≥ximas apresentam maior similaridade na composi√ß√£o de esp√©cies (use componente turnover - Bsim) que comunidades que est√£o distantes (e.g., Decaimento da similaridade).Solu√ß√µes dos exerc√≠cios.","code":""},{"path":"cap13.html","id":"cap13","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"Cap√≠tulo 13 Diversidade Filogen√©tica","text":"","code":""},{"path":"cap13.html","id":"pr√©-requisitos-do-cap√≠tulo-9","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"Pr√©-requisitos do cap√≠tulo","text":"Pacotes e dados que ser√£o utilizados nesse cap√≠tulo.","code":"\n## Pacotes\nlibrary(devtools)\nlibrary(ecodados)\nlibrary(V.PhyloMaker)\nlibrary(vegan)\nlibrary(ggplot2)\nlibrary(GGally)\nlibrary(ggpubr)\nlibrary(picante)\nlibrary(phytools)\nlibrary(ape)\nlibrary(geiger)\nlibrary(phyloregion)\nlibrary(pez)\nlibrary(reshape2)\nlibrary(betapart)\n\n## Dados\nminha_arvore <- ecodados::filogenia_aves\nespecies_plantas <- ecodados::sp_list\ncomunidade <- ecodados::comm\ncomposicao_especies <- ecodados::composicao_aves_filogenetica\nfilogenia_aves <- ecodados::filogenia_aves\nprecipitacao <- precipitacao_filogenetica"},{"path":"cap13.html","id":"aspectos-te√≥ricos-4","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.1 Aspectos te√≥ricos","text":"diversidade filogen√©tica captura ancestralidade compartilhada entre esp√©cies em termos de quantidade da hist√≥ria evolutiva e o grau de parentesco entre esp√©cies. Pesquisadores t√™m utilizado diferentes m√©tricas de diversidade filogen√©tica em duas linhas de investiga√ß√µes principais: ) incorporar hist√≥ria evolutiva das esp√©cies na sele√ß√£o das √°reas priorit√°rias para conserva√ß√£o visando minimizar perda da diversidade evolutiva (Vane-Wright, Humphries, Williams 1991; Faith 1992; V√©ron et al. 2019), e ii) produzir explica√ß√µes sobre os processos atuando na montagem das comunidades (Webb et al. 2002; Helmus et al. 2007). quantidade de artigos abordando ecologia, macroecologia e conserva√ß√£o com diversidade filogen√©tica cresceram exponencialmente nas √∫ltimas d√©cadas (V√©ron et al. 2019). Seguindo esta tend√™ncia, o n√∫mero de m√©tricas de diversidade filogen√©tica propostas n√£o param de aumentar. Tucker et al. (2017) revisaram 70 m√©tricas de diversidade filogen√©tica e classificaram estas m√©tricas em tr√™s dimens√µes: ) riqueza - representa soma da diferen√ßa filogen√©tica acumulada entre t√°xons, ii) diverg√™ncia - representa o padr√£o de diferen√ßa filogen√©tica entre t√°xons de uma assembleia, e iii) regularidade - representa o grau de varia√ß√£o das diferen√ßas filogen√©ticas entre t√°xons em uma assembleia. Outros autores utilizaram diferentes classifica√ß√µes (Pavoine Bonsall 2011; Vellend et al. 2011; Garamszegi 2014). Neste cap√≠tulo, iremos seguir classifica√ß√£o de Tucker et al. (2017) e mostrar algumas das principais m√©tricas dentro de cada uma dessas dimens√µes. üìù Importante \nAlguns autores recomendam que os pesquisadores n√£o foquem em apenas uma dimens√£o, mas comparem m√©tricas de diferentes dimens√µes (Tucker et al. 2017).","code":""},{"path":"cap13.html","id":"manipula√ß√£o-de-filogenias","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.2 Manipula√ß√£o de filogenias","text":"Nesta se√ß√£o, iremos descrever os c√≥digos em R para carregar, plotar, acessar os dados, e excluir e adicionar esp√©cies em filogenias. Estes s√£o c√≥digos introdut√≥rios e necess√°rios para realizarmos an√°lises de diversidade filogen√©tica. N√£o iremos descrever os comandos necess√°rios para construir uma filogenia. Estamos assumindo que j√° existe uma filogenia dispon√≠vel para os organismos de interesse.Mas antes, vamos entender principais terminologias de uma filogenia e analis√°-las graficamente (Figura 13.1).√Årvore filogen√©tica: s√£o hip√≥teses que representam o rela√ß√£o de parentesco entre esp√©cies (pode ser tamb√©m indiv√≠duos, genes, etc.) com informa√ß√µes sobre quais esp√©cies compartilham um ancestral comum e dist√¢ncia (tempo, gen√©tica, ou diferen√ßas nos caracteres) que separam√Årvore filogen√©tica: s√£o hip√≥teses que representam o rela√ß√£o de parentesco entre esp√©cies (pode ser tamb√©m indiv√≠duos, genes, etc.) com informa√ß√µes sobre quais esp√©cies compartilham um ancestral comum e dist√¢ncia (tempo, gen√©tica, ou diferen√ßas nos caracteres) que separamN√≥: o ponto onde uma linhagem d√° origem duas ou mais linhagens descendentesN√≥: o ponto onde uma linhagem d√° origem duas ou mais linhagens descendentesPolitomia: tr√™s ou mais linhagens descendendo de um √∫nico n√≥Politomia: tr√™s ou mais linhagens descendendo de um √∫nico n√≥Ramo: uma linha orientada ao longo de um eixo terminais-raiz que conecta os n√≥s na filogeniaRamo: uma linha orientada ao longo de um eixo terminais-raiz que conecta os n√≥s na filogeniaTerminal (ingl√™s tip): o final ramo representando uma esp√©cie atual ou extinta (pode tamb√©m representar g√™neros, indiv√≠duos, genes, etc.)Terminal (ingl√™s tip): o final ramo representando uma esp√©cie atual ou extinta (pode tamb√©m representar g√™neros, indiv√≠duos, genes, etc.)Raiz: representa o ancestral comum de todas esp√©cies na filogeniaRaiz: representa o ancestral comum de todas esp√©cies na filogeniaClado: um grupo de esp√©cies aparentadas descendendo de um √∫nico n√≥ na filogeniaClado: um grupo de esp√©cies aparentadas descendendo de um √∫nico n√≥ na filogeniaUltram√©trica: dist√¢ncia de todos os terminais at√© raiz s√£o id√™nticas. Caracter√≠stica requerida pela maioria dos √≠ndices de diversidade filogen√©ticaUltram√©trica: dist√¢ncia de todos os terminais at√© raiz s√£o id√™nticas. Caracter√≠stica requerida pela maioria dos √≠ndices de diversidade filogen√©tica\nFigura 13.1: Ilustra√ß√µes de diferentes √°rvores filogen√©ticas. ) √Årvore enraizada e ultram√©trica indicando raiz da √°rvore, n√≥s, ramos, comprimento ramo, politomias e terminais. B) √Årvore n√£o enraizada que mostra rela√ß√µes entre esp√©cies, mas n√£o define hist√≥ria evolutiva. C) √Årvore n√£o ultram√©trica onde esp√©cies apresentam diferentes dist√¢ncias at√© raiz.\nAgora vamos plotar filogenia para visualizar rela√ß√µes entre 37 esp√©cies de aves end√™micas da Mata Atl√¢ntica. Essa filogenia foi extra√≠da de Jetz et al. (2012). Os dados est√£o dispon√≠veis pacote ecodados (Figura 13.2).\nFigura 13.2: Filogenia de 37 esp√©cies de aves end√™micas da Mata Atl√¢ntica.\nPodemos alterar o formato de apresenta√ß√£o da filogenia usando o argumento type e cor dos ramos usando o argumento edge.color (Figura 13.3).\nFigura 13.3: Filogenia de 37 esp√©cies de aves end√™micas da Mata Atl√¢ntica, com altera√ß√µes de parametros de visualiza√ß√£o.\nPercebam que existem v√°rios argumentos para modificar largura e cor dos ramos, tamanho da fonte, dist√¢ncia entre filogenia e o nomes da esp√©cies e muito mais. Uma sugest√£o √© visitar o blog professor Liam Revell (http://blog.phytools.org/) que √© o criador e mantenedor pacote phytools R.Acessar informa√ß√µes da filogeniaUm das caracter√≠sticas mais interessantes R √© que podemos acessar informa√ß√µes objeto que cont√©m filogenia. Neste caso, o nosso objeto √© filogenia e, muitas vezes, temos interesse nas informa√ß√µes que est√£o inseridas dentro da filogenia. Para sabermos quais s√£o informa√ß√µes que podemos acessar na filogenia, vamos usar fun√ß√£o names().Temos acesso quatro componentes da filogenia: ) ramo (edge), ii) comprimento ramo (edge.length), iii) n√∫mero de n√≥s (Nnode), e iv) nome das esp√©cies (tip.label). Podemos usar o operador $ para acessar estes componentes. Veja abaixo como acessar o nome das 37 esp√©cies de aves na filogenia ou o comprimento de cada um dos ramos da filogenia.Remover esp√©cies da filogeniaNas an√°lises de diversidade filogen√©tica, esp√©cies que estar√£o presentes na filogenia normalmente s√£o aquelas que foram amostradas seu estudo. Contudo, muitas vezes utilizamos filogenias contendo esp√©cies que n√£o est√£o presentes nosso estudo. Neste caso, precisamos excluir essas esp√©cies da filogenia. fun√ß√£o drop.tip() faz essa tarefa.Vejam que agora filogenia tem 35 esp√©cies de aves. duas esp√©cies que selecionamos foram exclu√≠das da filogenia.Adicionar esp√©cies na filogeniaOutra situa√ß√£o bem comum √© quando precisamos inserir esp√©cies que foram amostradas nosso estudo, mas n√£o est√£o presente na filogenia. Para isso, vamos usar fun√ß√£o add.species..genus(). fun√ß√£o force.ultrametric() √© usada para que filogenia continue sendo ultram√©trica (sem essa fun√ß√£o √°rvore perde os comprimentos dos ramos) üìù Importante \nO comprimento ramo que esp√©cie ir√° receber depender√° de onde voc√™ indicar inser√ß√£o da esp√©cie.op√ß√µes s√£o:\n- root: insere esp√©cie ancestral comum mais recente (MRCA) de todas esp√©cies g√™nero (default)\n- random: insere esp√©cie aleatoriamente dentro clado MRCA contendo todos esp√©cies g√™neroAgora vamos inserir v√°rias esp√©cies dentro mesmo g√™nero.Vamos plotar essa nova filogenia (Figura 13.4).\nFigura 13.4: Filogenia de esp√©cies de aves end√™micas da Mata Atl√¢ntica, com adi√ß√£o de esp√©cies.\nVamos fazer outro exemplo usando fun√ß√£o phylo.maker() pacote V.PhyloMaker que adiciona esp√©cies nos g√™neros ou os g√™neros nas fam√≠lias usando uma filog√™nia backbone.Essa fun√ß√£o permite adi√ß√£o dos g√™neros ou esp√©cies considerando tr√™s cen√°rios diferentes:Cen√°rio 1: adiciona g√™neros ou esp√©cies como politomias basais dentro das fam√≠lias ou g√™neros da filogenia respectivamenteCen√°rio 2: adiciona g√™neros e esp√©cies aleatoriamente nas fam√≠lias ou g√™neros da filogenia respectivamenteCen√°rio 3: adiciona g√™neros e esp√©cies nas fam√≠lias ou g√™neros da filogenia respectivamente usando abordagens implementadas Phylomatic e BLADJVamos essa filogenia criada pelo pacote V.PhyloMaker (Figura 13.5).\nFigura 13.5: Filogenia de esp√©cies de plantas criada pelo pacote V.PhyloMaker.\n","code":"\n## Gr√°fico\nplot.phylo (minha_arvore, type = \"phylogram\", show.tip.label = TRUE, \n            show.node.label = TRUE, edge.color = \"black\", edge.width = 1.5, \n            tip.color = \"black\", cex = 0.45, label.offset = 2) \n## Gr√°fico\nplot.phylo (minha_arvore, type = \"fan\", show.tip.label = TRUE, \n            show.node.label = TRUE, edge.color = \"blue\", edge.width = 1.5, \n            tip.color = \"black\", cex = 0.45, label.offset = 2) \n## Nomes\nnames(minha_arvore)\n#> [1] \"edge\"        \"edge.length\" \"Nnode\"       \"tip.label\"\n## Nome das esp√©cies\nminha_arvore$tip.label\n#>  [1] \"Cranioleuca_pallida\"          \"Synallaxis_ruficapilla\"       \"Phacellodomus_ferrugineigula\"\n#>  [4] \"Cinclodes_pabsti\"             \"Conopophaga_melanops\"         \"Herpsilochmus_pileatus\"      \n#>  [7] \"Pyriglena_leucoptera\"         \"Formicivora_serrana\"          \"Chiroxiphia_caudata\"         \n#> [10] \"Neopelma_aurifrons\"           \"Carpornis_cucullata\"          \"Mionectes_rufiventris\"       \n#> [13] \"Phylloscartes_kronei\"         \"Dacnis_nigripes\"              \"Ramphocelus_bresilius\"       \n#> [16] \"Sporophila_frontalis\"         \"Tangara_seledon\"              \"Euphonia_pectoralis\"         \n#> [19] \"Cyanocorax_caeruleus\"         \"Brotogeris_tirica\"            \"Pionopsitta_pileata\"         \n#> [22] \"Pyrrhura_frontalis\"           \"Ramphastos_dicolorus\"         \"Pteroglossus_bailloni\"       \n#> [25] \"Veniliornis_maculifrons\"      \"Melanerpes_flavifrons\"        \"Malacoptila_striata\"         \n#> [28] \"Strix_hylophila\"              \"Pulsatrix_koeniswaldiana\"     \"Megascops_sanctaecatarinae\"  \n#> [31] \"Leucopternis_polionotus\"      \"Buteogallus_lacernulatus\"     \"Thalurania_glaucopis\"        \n#> [34] \"Stephanoxis_lalandi\"          \"Aramides_saracura\"            \"Ortalis_guttata\"             \n#> [37] \"Tinamus_solitarius\"\n\n## Comprimento dos ramos\nminha_arvore$edge.length\n#>  [1]   8.3802647  18.8669712   1.7333865   3.6642170  10.6732942  15.2239228  11.0917270   1.7755983  28.3607791\n#> [10]   2.9678911   1.7546545   8.0910030   8.0910030   9.8456576  12.8135486  41.1743278  25.4606915   0.5546030\n#> [19]  16.9346316  16.9346316  17.4892346  18.4363079   4.6581580  13.5498048  17.3960309  17.3960309  30.9471871\n#> [28]  12.4567724  23.1472214  23.1472214  17.4065182  24.1723764  12.4712971   2.4600303  12.6082491  12.5529673\n#> [37]  12.6146793  15.2153841  27.6866812  51.8590576  50.4721698   1.0975337  28.3691666  28.3691666  29.4667004\n#> [46]   0.4805624   1.9967144   2.7687118  17.0272986  23.4955884  20.5338341  17.3003772  17.3003772  22.2636579\n#> [55]  15.5705534  15.5705534  61.3297997  50.6621138   5.3479249  22.3470597  22.3470597  27.6949846  66.5513507\n#> [64]  14.5744595  14.5744595  67.7448719  15.3776527  15.3776527  85.3364736 104.2034448 112.5837095\n## Remover esp√©cies da filogenia\n# Vamos criar um novo nome para o objeto e excluir as esp√©cies Leucopternis polionotus e Aramides saracura da filogenia\nfilogenia_cortada <- drop.tip(minha_arvore, c(\"Leucopternis_polionotus\", \"Aramides_saracura\"))\nfilogenia_cortada\n#> \n#> Phylogenetic tree with 35 tips and 33 internal nodes.\n#> \n#> Tip labels:\n#>   Cranioleuca_pallida, Synallaxis_ruficapilla, Phacellodomus_ferrugineigula, Cinclodes_pabsti, Conopophaga_melanops, Herpsilochmus_pileatus, ...\n#> \n#> Rooted; includes branch lengths.\n## Adicionar esp√©cies √† filogenia\n# Vamos inserir as esp√©cies Megascops_sp1, Carponis_sp, Strix_sp1, Strix_sp2 e\n# Strix_sp3 na filogenia\nMegascops <- c(\"Megascops_sp1\")\nCarpornis <- c(\"Carpornis_sp1\")\nStrix <- c(\"Strix_sp1\", \"Strix_sp2\", \"Strix_sp3\")\n\n# Inserindo esp√©cies como politomias\nfilogenia_nova <- add.species.to.genus(force.ultrametric(minha_arvore, message = FALSE), Megascops)\nfilogenia_nova <- add.species.to.genus(force.ultrametric(filogenia_nova, message = FALSE), Carpornis)\n## Adicionar v√°rias esp√©cies √† filogenia\n# Para inserir mais de uma esp√©cie dentro do g√™nero, vamos utilizar um loop.  \nfor(i in 1:length(Strix)) \n    filogenia_nova <- add.species.to.genus(force.ultrametric(filogenia_nova, message = FALSE),\n                                           Strix[i], where = \"root\")\n## Gr√°fico\nplot(filogenia_nova, cex = 0.5, no.margin = TRUE)\n## phylo.maker\n# A fun√ß√£o phylo.maker usa uma filogenia default de plantas (i.e. GBOTB.extended).\n# Caso voc√™ queira utilizar outra filogenia, √© s√≥ alterar o argumento tree\nnovas_filogenias <- phylo.maker(especies_plantas,\n                                tree = GBOTB.extended,\n                                scenarios = c(\"S1\",\"S2\",\"S3\"))\n#> [1] \"Note: 2 taxa fail to be binded to the tree,\"\n#> [1] \"Genus7_sp1\" \"Genus8_sp1\"\n## Gr√°fico\npar(mfrow = c(1, 2))\nplot.phylo(novas_filogenias$scenario.1, cex = 0.5, main = \"Cen√°rio 1\")\nplot.phylo(novas_filogenias$scenario.3, cex = 0.5, main = \"Cen√°rio 3\")\ndev.off()\n#> null device \n#>           1"},{"path":"cap13.html","id":"m√©tricas-de-diversidade-alfa-filogen√©tica","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.3 M√©tricas de diversidade alfa filogen√©tica","text":"M√©tricas de diversidade alfa utilizam os dados de incid√™ncia (presen√ßa e aus√™ncia) ou abund√¢ncia das esp√©cies para determinar um valor de diversidade para cada comunidade ou s√≠tio de interesse.Exemplo pr√°tico 1Explica√ß√£o dos dadosAvaliaremos diversidade filogen√©tica de 10 comunidades de aves amostradas ao longo de um gradiente de precipita√ß√£o. Utilizaremos este conjunto de dados para todos os exemplos deste cap√≠tulo.PerguntaA varia√ß√£o na distribui√ß√£o espacial dos valores de diversidade filogen√©tica das comunidades est√° associada com o gradiente de precipita√ß√£o?Predi√ß√µesOs valores de diversidade filogen√©tica ser√£o maiores nas comunidades localizadas em regi√µes com altas precipita√ß√µes que em regi√µes mais secasVari√°veisVari√°veis resposta e preditoras\nData frame com comunidades (unidade amostral) nas linhas e esp√©cies de aves nas colunas (vari√°vel resposta)\nData frame com comunidades (unidade amostral) nas linhas e vari√°vel precipita√ß√£o anual na coluna (vari√°vel preditora)\nArquivo com filogenia das 37 esp√©cies de aves (vari√°vel resposta)\nVari√°veis resposta e preditorasData frame com comunidades (unidade amostral) nas linhas e esp√©cies de aves nas colunas (vari√°vel resposta)Data frame com comunidades (unidade amostral) nas linhas e vari√°vel precipita√ß√£o anual na coluna (vari√°vel preditora)Arquivo com filogenia das 37 esp√©cies de aves (vari√°vel resposta)ChecklistVerificar se os data frames de composi√ß√£o de esp√©cies e vari√°veis ambientais est√£o com unidades amostrais nas linhas e vari√°veis preditoras nas colunasVerificar se os data frames de composi√ß√£o de esp√©cies e vari√°veis ambientais est√£o com unidades amostrais nas linhas e vari√°veis preditoras nas colunasVerificar se comunidades nos data frames de composi√ß√£o de esp√©cies e vari√°veis ambientais est√£o distribu√≠dos na mesma sequ√™ncia/ordem nos dois arquivos.Verificar se comunidades nos data frames de composi√ß√£o de esp√©cies e vari√°veis ambientais est√£o distribu√≠dos na mesma sequ√™ncia/ordem nos dois arquivos.Verificar se o nome das esp√©cies de aves data frame de composi√ß√£o de esp√©cies √© id√™ntico ao nome das esp√©cies na filogenia.Verificar se o nome das esp√©cies de aves data frame de composi√ß√£o de esp√©cies √© id√™ntico ao nome das esp√©cies na filogenia.","code":""},{"path":"cap13.html","id":"riqueza-da-diversidade-alfa-filogen√©tica","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.3.1 Riqueza da diversidade alfa filogen√©tica","text":"m√©tricas de riqueza somam quantidade da diferen√ßa filogen√©tica presente em uma comunidade (Tucker et al. 2017).Phylogenetic diversity (PD)Esta m√©trica √© definida pela soma comprimento dos ramos conectando todas esp√©cies na comunidade. √â m√©trica mais conhecida e usada nos estudos de conserva√ß√£o e comunidade (Faith 1992).Vamos conferir se os nomes das esp√©cies de aves data frame de composi√ß√£o s√£o os mesmos da filogenia. O resultado OK indica que os nomes est√£o corretos. Caso contr√°rio, voc√™ deve verificar e arrumar.Os nomes das esp√©cies que est√£o na planilha s√£o iguais e est√£o na mesma ordem dos nomes das esp√©cies que est√£o na filogenia. Agora podemos continuar an√°lises.Abaixo, demonstramos os c√≥digos R para o c√°lculo de PD para comunidades de aves.comunidade 2 abriga maior diversidade filogen√©tica com composica√ß√£o de esp√©cies contemplando 1293,15 milh√µes de anos (.e.¬†soma comprimento dos ramos ligando todas esp√©cies da comunidade). Por outro lado, comunidade 10 abriga menor diversidade filogen√©tica contemplando 599,69 milh√µes de anos. üìù Importante \nEste √≠ndice √© correlacionado com riqueza de esp√©cies. Discutiremos essa quest√£o na se√ß√£o de modelos nulos.Phylogenetic Species Richness (PSR)Esta m√©trica √© calculada multiplicando riqueza de esp√©cies registrada na comunidade pela Phylogenetic Species Variability (PSV) da comunidade (Helmus et al. 2007). PSR √© diretamente compar√°vel ao n√∫mero de esp√©cies na comunidade, mas inclui o parentesco filogen√©tico entre esp√©cies.Abaixo, demonstramos os c√≥digos R para o c√°lculo PSR utilizando os dados das comunidades de aves.comunidade 2 abriga o maior valor de PSR enquanto comunidade 10 abriga o menor valor. Vejam que PSR √© fortemente correlacionado com n√∫mero de esp√©cies nas comunidades (r = 0.99, p <0.0001). Contudo, existe uma variabilidade residual PSR em rela√ß√£o ao n√∫mero de esp√©cies que afeta o ranqueamento das comunidades quando utilizando PSR ou n√∫mero de esp√©cies. Consequentemente, escolha da m√©trica pode gerar diferentes delineamentos de √°reas priorit√°rias para conserva√ß√£o (Helmus et al. 2007).Phylogenetic Endemism (PE)Esta m√©trica calcula fra√ß√£o dos ramos restritas regi√µes espec√≠ficas. PE identifica √°reas ou comunidades que abrigam componentes restritos da diversidade filogen√©tica. PE √© uma m√©trica proposta para auxiliar estudos de conserva√ß√£o estabelecendo crit√©rios para priorizar regi√µes serem conservadas com base na import√¢ncia evolutiva (.e.¬†partes da filog√™nia com distribui√ß√£o espacial limitada) das esp√©cies que ocorrem nestes locais (Rosauer et al. 2009).Abaixo, demonstramos os c√≥digos R para o c√°lculo PE utilizando os dados das comunidades de aves.O √≠ndice PE considera 10 comunidades como o range espacial m√°ximo. Se todas esp√©cies ocorressem nas 10 comunidades, o valor de PE seria 1, indicando baixo endemismo filogen√©tico. comunidade 2 abriga um conjunto de esp√©cies cujo os ramos com distribui√ß√£o espacial restrita contemplam 272,6 milh√µes de anos. Por outro lado, comunidade 10 abriga um conjunto de esp√©cies cujo os ramos com distribui√ß√£o espacial restrita contemplam 68,5 milh√µes de anos. Assim, comunidades 1, 2 e 4 s√£o √°reas que abrigam os maiores endemismo filogen√©ticos.Species Evolutionary Distinctiveness (ED)Esta m√©trica calcula qual √© fra√ß√£o da √°rvore filogen√©tica que √© atribu√≠da para uma esp√©cie. ED reflete qu√£o evolutivamente isolada uma esp√©cie √© comparada com outras esp√©cies na filogenia (Redding Mooers 2006). ED √© uma m√©trica proposta para auxiliar estudos de conserva√ß√£o estabelecendo crit√©rios para priorizar esp√©cies serem conservadas com base na sua import√¢ncia evolutiva (exclusividade comprimento ramo) que n√£o √© comportilhada com outras esp√©cies. Portanto, apenas informa√ß√µes da filogenia s√£o utilizadas para o c√°lculo de ED.Abaixo, demonstramos os c√≥digos R para o c√°lculo ED utilizando os dados das comunidades de aves.Com base na filogenia estudada, Tinamus solitarius (112,58 milh√µes de anos), Ortalis guttata (108,39 m..) e Aramides saracura (96,86 m..) s√£o esp√©cies com maior distin√ß√£o evolutiva devido elevada fra√ß√£o dos ramos n√£o compartilhado com outras esp√©cies.","code":"\n## Conferir os nomes das esp√©cies\nname.check(filogenia_aves, t(composicao_especies))\n#> [1] \"OK\"\n\n## Colocar os nomes das esp√©cies do data frame na mesma ordem que aparecem na filogenia\ncomposicao_especies_P <- match.phylo.comm(phy = filogenia_aves, comm = composicao_especies)$comm\n## Phylogenetic diversity (PD)\n# Calculando a m√©trica de diversidade filogen√©tica proposta por Faith (1992).\nresultados_PD <- pd(composicao_especies_P, filogenia_aves)\n\n# Mostra o valor de PD e riqueza de esp√©cies para cada comunidade.\nresultados_PD\n#>               PD SR\n#> Com_1  1259.3151 27\n#> Com_2  1293.1521 26\n#> Com_3  1222.3102 25\n#> Com_4  1254.5410 25\n#> Com_5  1021.9670 22\n#> Com_6   856.7810 18\n#> Com_7   930.6452 15\n#> Com_8   678.9394 12\n#> Com_9   673.6288 13\n#> Com_10  599.6924  9\n## Phylogenetic Species Richness (PSR)\n# An√°lise com dados de composi√ß√£o das esp√©cies nas comunidades.\nresultados_PSR <- psr(composicao_especies_P,filogenia_aves)\n\n# Mostra os valores de PSR para cada comunidade.\nresultados_PSR \n#>              PSR SR       vars\n#> Com_1  18.084236 27 0.04537904\n#> Com_2  18.167183 26 0.04881734\n#> Com_3  16.230938 25 0.05205832\n#> Com_4  17.153972 25 0.05205832\n#> Com_5  13.981597 22 0.06060866\n#> Com_6  11.287030 18 0.06933707\n#> Com_7  10.279983 15 0.07398666\n#> Com_8   7.538134 12 0.07721118\n#> Com_9   8.060933 13 0.07627517\n#> Com_10  5.720063  9 0.07948474\n## Phylogenetic Endemism (PE)\n# Transformando data.frame em matriz.\ndados_matriz <- as.matrix(composicao_especies_P)\n\n# An√°lise.\nresultados_PE <- phylo_endemism(dados_matriz, filogenia_aves, \n                                weighted = TRUE)\n\n# Mostra os valores de PE para cada comunidade.\nresultados_PE \n#>     Com_1     Com_2     Com_3     Com_4     Com_5     Com_6     Com_7     Com_8     Com_9    Com_10 \n#> 232.09145 272.60106 210.22647 218.89037 146.99281 135.06423 148.65234  79.22402  77.95458  68.50266\n## Species Evolutionary Distinctiveness (ED)\n# An√°lise.\nresultados_ED <- evol.distinct(filogenia_aves)\n\n# Mostra os valores de ED para cada esp√©cie.\nhead(resultados_ED)\n#>                        Species        w\n#> 1          Cranioleuca_pallida 14.07447\n#> 2       Synallaxis_ruficapilla 14.07447\n#> 3 Phacellodomus_ferrugineigula 20.05793\n#> 4             Cinclodes_pabsti 30.27020\n#> 5         Conopophaga_melanops 47.72685\n#> 6       Herpsilochmus_pileatus 26.40947"},{"path":"cap13.html","id":"diverg√™ncia-da-diversidade-alfa-filogen√©tica","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.3.2 Diverg√™ncia da diversidade alfa filogen√©tica","text":"m√©tricas de diverg√™ncia utilizam m√©dia da distribui√ß√£o das unidades extra√≠das da √°rvore filogen√©tica (Tucker et al. 2017).Mean Pairwise Distance (MPD)Esta m√©trica utiliza matriz de dist√¢ncia filogen√©tica para quantificar dist√¢ncia m√©dia parentesco entre pares de esp√©cies em uma comunidade. Este √≠ndice pode ser calculado considerando dados de incid√™ncia ou considerando dados de abund√¢ncia das esp√©cies. Importante, o MPD √© uma m√©trica que pesa estrutura interna da filogenia (e.g., rela√ß√µes entre esp√©cies de fam√≠lias diferentes) (Webb et al. 2002).Abaixo, demonstramos os c√≥digos R para o c√°lculo MPD utilizando os dados das comunidades de aves.Vamos iniciar com dados de incid√™ncia (presen√ßa e aus√™ncia) das esp√©cies nas comunidades. fun√ß√£o cophenetic() gera uma matriz com dist√¢ncias par par entre esp√©cies. Essas dist√¢ncias s√£o utilizadas para computar dist√¢ncia m√©dia parentesco das esp√©cies dentro das comunidades.comunidade 9 abriga composi√ß√£o de esp√©cies mais aparentada (.e.¬†menor diversidade filogen√©tica) com dist√¢ncia m√©dia entre esp√©cies de 139,62 milh√µes de anos. Por outro lado, comunidade 2 abriga composi√ß√£o de esp√©cies menos aparentada (.e.¬†maior diversidade filogen√©tica) com dist√¢ncia m√©dia de 157,31 milh√µes anos.Vamos refazer an√°lise MPD, mas desta vez, considerando abund√¢ncia das esp√©cies de aves nas comunidades. Para isso, alteramos o argumento abundance.weighted = TRUE.Percebam que pesando o comprimento ramo pela abund√¢ncia das esp√©cies altera-se os valores √≠ndice de diversidade filogen√©tica. Neste caso, comunidade 10 passa ser comunidade que abriga composi√ß√£o de esp√©cies mais aparentada (.e.¬†menor diversidade filogen√©tica) com dist√¢ncia m√©dia entre esp√©cies de 117,88 milh√µes de anos.Mean Nearest Taxon Distance (MNTD)Esta m√©trica utiliza matriz de dist√¢ncia filogen√©tica para quantificar m√©dia dos valores m√≠nimos de parentesco entre pares de esp√©cies em uma comunidade. Ou seja, qual o valor m√©dio da dist√¢ncia para o vizinho mais pr√≥ximo. Este √≠ndice pode ser calculado considerando dados de incid√™ncia (presen√ßa e aus√™ncia) ou considerando dados de abund√¢ncia das esp√©cies. Diferente MPD, o MNTD √© uma m√©trica terminal que pesa rela√ß√µes nas pontas da filogenia (e.g.¬†esp√©cies dentro mesmo g√™nero) (Webb et al. 2002).Abaixo, demonstramos os c√≥digos R para o c√°lculo MNTD utilizando os dados das comunidades de aves.comunidade 9 abriga composi√ß√£o de esp√©cies com dist√¢ncia m√©dia vizinho mais pr√≥ximo de 62,34 milh√µes de anos. Esse resultado indica que esp√©cies terminais s√£o mais aparentada (e.g.¬†esp√©cies mesmo g√™nero) que composi√ß√£o de esp√©cies da comunidade 10 onde dist√¢ncia m√©dia vizinho mais pr√≥ximo √© 112,23 milh√µes de anos (e.g.¬†esp√©cies de g√™neros diferentes).Vamos refazer an√°lise MNTD, mas desta vez, considerando abund√¢ncia das esp√©cies de aves nas comunidades.Como nos resultados MPD, pesar o comprimento ramo pela abund√¢ncia das esp√©cies altera os valores MNTD. Neste caso, ao inv√©s da comunidade 9, comunidade 2 passa ser comunidade que abriga composi√ß√£o de esp√©cies com menor dist√¢ncia m√©dia vizinho mais pr√≥ximo (53,02 milh√µes de anos). üìù Importante \nPerceba que ao determinar an√°lises com base na incid√™ncia ou abund√¢ncia das esp√©cies, voc√™ pode tamb√©m alterar interpreta√ß√£o dos padr√µes encontrados.Phylogenetic Species Variability (PSV)Esta m√©trica estima quantidade relativa dos comprimentos dos ramos n√£o compartilhados entre comunidades. Quando todas esp√©cies em uma amostra n√£o s√£o aparentadas (.e.¬†filogenia em estrela), o valor PSV √© 1 (um), indicando m√°xima variabilidade. Quando esp√©cies tornando-se mais aparentadas, o valor de PSV aproxima-se de 0 (zero), indicando reduzida variabilidade. Os valores esperados de PSV s√£o estatisticamente independentes da riqueza de esp√©cies (Helmus et al. 2007). üìù Importante \nOs valores de PSV s√£o id√™nticos ao MPD quando filogenia √© ultram√©trica.Abaixo, demonstramos os c√≥digos R para o c√°lculo PSV utilizando os dados das comunidades de aves.comunidade 2 abriga o maior variabilidade filogen√©tica (0,69) enquanto comunidade 9 abriga menor variabilidade (0,62). Perceba que os valores de PSV n√£o s√£o correlacionados com n√∫mero de esp√©cies nas comunidades (r = 0,59, p = 0,07).","code":"\n## Mean Pairwise Distance (MPD)\n# An√°lise com dados de incid√™ncia das esp√©cies nas comunidades.\nresultados_MPD_PA <- mpd(composicao_especies_P, cophenetic(filogenia_aves), \n                         abundance.weighted = FALSE)\n\n# Mostra os valores de MPD para cada comunidade.\nresultados_MPD_PA \n#>  [1] 150.7914 157.3158 146.1622 154.5005 143.0727 141.1926 154.3145 141.4292 139.6198 143.0862\n## Mean Pairwise Distance (MPD)\n# An√°lise com dados de abund√¢ncia das esp√©cies nas comunidades.\nresultados_MPD_AB <- mpd(composicao_especies_P, cophenetic(filogenia_aves), \n                         abundance.weighted = TRUE)\n\n# Mostra os valores de MPD para cada comunidade.\nresultados_MPD_AB \n#>  [1] 135.0704 143.3156 129.1940 142.8127 131.4027 128.7733 134.0380 132.6389 133.4041 117.8787\n## Mean Nearest Taxon Distance (MNTD)\n# An√°lise com dados de presen√ßa e aus√™ncia das esp√©cies nas comunidades.\nresultados_MNTD_PA <- mntd(composicao_especies_P, cophenetic(filogenia_aves), \n                           abundance.weighted = FALSE)\n\n# Mostra os valores de MPD para cada comunidade.\nresultados_MNTD_PA \n#>  [1]  63.89727  66.15828  72.96912  67.67170  64.93477  63.72337  93.54980  78.24876  62.34565 112.23127\n# An√°lise com dados de abund√¢ncia das esp√©cies nas comunidades.\nresultados_MNTD_AB <- mntd(composicao_especies_P, cophenetic(filogenia_aves), \n                           abundance.weighted = TRUE)\n\n# Mostra os valores de MPD para cada comunidade.\nresultados_MNTD_AB \n#>  [1]  57.11745  53.02212  70.47864  59.12049  61.23225  60.26180 110.13043  97.35404  82.12099 127.70084\n## Phylogenetic Species Variability (PSV)\n# An√°lise com dados de presen√ßa e aus√™ncia das esp√©cies nas comunidades.\nresultados_PSV <- psv(composicao_especies_P,filogenia_aves)\n\n# Mostra os valores de PSV para cada comunidade.\nresultados_PSV \n#>             PSVs SR         vars\n#> Com_1  0.6697865 27 6.224834e-05\n#> Com_2  0.6987378 26 7.221499e-05\n#> Com_3  0.6492375 25 8.329332e-05\n#> Com_4  0.6861589 25 8.329332e-05\n#> Com_5  0.6355271 22 1.252245e-04\n#> Com_6  0.6270572 18 2.140033e-04\n#> Com_7  0.6853322 15 3.288296e-04\n#> Com_8  0.6281778 12 5.361887e-04\n#> Com_9  0.6200717 13 4.513324e-04\n#> Com_10 0.6355626  9 9.812931e-04"},{"path":"cap13.html","id":"regularidade-da-diversidade-alfa-filogen√©tica","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.3.3 Regularidade da diversidade alfa filogen√©tica","text":"m√©tricas de regularidade caracterizam varia√ß√£o das dist√¢ncias entre esp√©cies em uma comunidade (Tucker et al. 2017).Variance Pairwise Distance (VPD)Esta m√©trica utiliza matriz de dist√¢ncia filogen√©tica para quantificar vari√¢ncia parentesco entre pares de esp√©cies em uma comunidade (Clarke Warwick 2001).Abaixo, demonstramos os c√≥digos R para o c√°lculo VPD utilizando os dados das comunidades de aves.comunidade 2 abriga maior vari√¢ncia na dist√¢ncia filogen√©tica entre pares de esp√©cies dentro da comunidade (1828,19 milh√µes de anos) enquanto comunidade 7 abriga menor vari√¢ncia entre os pares de esp√©cies (825,53 m..).","code":"\n## Variance of Pairwise Distance (VPD)\n# Transformando data frame em matriz.\ndados_matriz <- as.matrix(composicao_especies_P)\n\n# Transformar os dados para o formato requerido pelo pacote pez.\ndados <- comparative.comm(filogenia_aves, dados_matriz)\n\n# An√°lise.\nresultados_VPD <- .vpd(dados, cophenetic(filogenia_aves))\n\n# Mostra os valores de VPD para cada comunidade.\nresultados_VPD \n#>     Com_1    Com_10     Com_2     Com_3     Com_4     Com_5     Com_6     Com_7     Com_8     Com_9 \n#> 1619.4697 1031.8887 1828.1930 1630.4026 1317.9919 1465.1728 1519.6115  825.5349 1278.0076 1508.0495"},{"path":"cap13.html","id":"correla√ß√£o-entre-as-m√©tricas-de-diversidade-alfa-filogen√©tica","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.3.4 Correla√ß√£o entre as m√©tricas de diversidade alfa filogen√©tica","text":"Vamos avaliar correla√ß√£o entre os valores das m√©tricas de diversidade alfa filogen√©tica. Vamos criar um data frame com os resultados das m√©tricas separados para dimens√µes de riqueza e diverg√™ncia. N√£o iremos fazer para regularidade, pois s√≥ apresentamos uma m√©trica de diversidade filogen√©tica nesta dimens√£o (Figura 13.6).\nFigura 13.6: Correla√ß√£o entre m√©tricas de riqueza da diversidade alfa filogen√©tica.\nPercebam que tr√™s m√©tricas apresentam correla√ß√µes pareadas acima de 94%. Isso indica que m√©tricas s√£o redundantes. Portanto, n√£o h√° necessidade de calcular mais de uma m√©trica dentro da dimens√£o da riqueza filogen√©tica. Al√©m disso, tr√™s m√©tricas de diversidade alfa filogen√©tica tamb√©m apresentam alta correla√ß√£o com riqueza de esp√©cies. Veja abaixo na se√ß√£o de modelos nulos como controlar o efeito da riqueza de esp√©cies nas m√©tricas de diversidade filogen√©tica.Vamos avaliar correla√ß√£o entre os valores das m√©tricas de diversidade alfa filog√©netica para dimens√£o diverg√™ncia (Figura 13.7).\nFigura 13.7: Correla√ß√£o entre m√©tricas de diverg√™ncia da diversidade alfa filogen√©tica.\nComo mencionado, m√©tricas MPD e PSV s√£o id√™nticas quando usamos uma filogenia ultram√©trica. Contudo, m√©tricas de diverg√™ncia n√£o apresentam correla√ß√µes t√£o altas como m√©tricas da dimens√£o riqueza, com exce√ß√£o MNTD usando dados de incid√™ncia e abund√¢ncia que foram fortemente correlacionados (r = 0,9). Al√©m disso, estas m√©tricas n√£o s√£o t√£o afetadas pela riqueza de esp√©cies das comunidades como m√©tricas da dimens√£o riqueza.","code":"\n## Data frame\n# Vamos criar um data.frame com os resultados das m√©tricas da dimens√£o riqueza.\nmetricas_riqueza <- data.frame(riqueza = resultados_PD$SR,\n                               PD = resultados_PD$PD,\n                               PSR = resultados_PSR$PSR,\n                               PE = resultados_PE)\n\n## Gr√°fico\n# Gr√°fico mostrando na parte:\n# i) inferior a distribui√ß√£o dos pontos considerando as m√©tricas pareadas\n# ii) superior o valor da correla√ß√£o de pearson\n# iii) diagonal a curva de densidade\nggpairs(metricas_riqueza, upper = list(continuous = wrap(\"cor\", size = 4))) +\n    tema_livro()\n## Data frame\n# Vamos criar um data.frame com os resultados das m√©tricas da dimens√£o diverg√™ncia.\nmetricas_divergencia <- data.frame(riqueza = resultados_PD$SR,\n                                   MPD = resultados_MPD_PA,\n                                   MPD_AB = resultados_MPD_AB,\n                                   MNTD = resultados_MNTD_PA,\n                                   MNTD_AB = resultados_MNTD_AB,\n                                   PSV = resultados_PSV$PSVs)\n\n## Gr√°fico\nggpairs(metricas_divergencia, upper = list(continuous = wrap(\"cor\", size = 4))) +\n    tema_livro()"},{"path":"cap13.html","id":"associa√ß√£o-entre-a-diversidade-alfa-filogen√©tica-e-o-ambiente","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.3.5 Associa√ß√£o entre a diversidade alfa filogen√©tica e o ambiente","text":"Vamos avaliar e plotar rela√ß√£o entre os valores de algumas m√©trica de diversidade alfa filogen√©tica (vari√°vel resposta) e os valores de precipita√ß√£o (vari√°vel preditora) (Figura 13.8).\nFigura 13.8: Rela√ß√£o de algumas m√©trica de diversidade alfa filogen√©tica e valores de precipita√ß√£o.\nO MPD, que avalia rela√ß√µes de parentesco mais internas da filogenia (.e.¬†rela√ß√µes entre esp√©cies de fam√≠lias diferentes) n√£o apresentou associa√ß√£o com o gradiente de precipita√ß√£o. Por outro lado, o MNTD que avalia rela√ß√µes mais terminais da filogenia (.e.¬†esp√©cies dentro mesmo g√™nero) apresentou uma rela√ß√£o negativa com o gradiente de precipita√ß√£o. Interessante que associa√ß√£o s√≥ foi significativa quando pesamos an√°lise pela abund√¢ncia das esp√©cies nas comunidades. Esses resultados demonstram import√¢ncia da sele√ß√£o das m√©tricas de diversidade filogen√©tica e tipos de dados (e.g.¬†incid√™ncia ou abund√¢ncia) utilizados na interpreta√ß√£o dos padr√µes observados na natureza.Vamos ver os gr√°ficos das m√©tricas da dimens√£o riqueza da diversidade alfa filogen√©tica (Figura 13.9).\nFigura 13.9: Rela√ß√£o de algumas m√©trica de diversidade alfa filogen√©tica e valores de precipita√ß√£o.\ntr√™s m√©tricas de diversidade filogen√©tica foram relacionadas com o gradiente de precipita√ß√£o. Esse resultado indica que comunidades localizadas em √°reas com maior precipita√ß√£o anual abrigaram maior diversidade filogen√©tica que comunidades localizadas em √°reas mais secas. Contudo, estas m√©tricas s√£o dependentes da riqueza de esp√©cies nas comunidades. Veja abaixo se√ß√£o de modelos nulos para entender como lidar com essa depend√™ncia.","code":"\n## Dados\n# Vamos inserir os dados de precipita√ß√£o na planilha metrica_divergencia.\nmetricas_divergencia$precipitacao <- precipitacao_filogenetica$prec\n\n## Gr√°ficos\nMPD_PA_plot <- ggplot(metricas_divergencia, aes(precipitacao, MPD)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") + \n    labs(x = \"Precipita√ß√£o (mm)\", \n         y = \"Mean Pairwise Distance\\n (MPD - Aus√™ncia e Presen√ßa)\") +\n    tema_livro()\n\nMPD_AB_plot <- ggplot(metricas_divergencia, aes(precipitacao, MPD_AB)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") + \n    labs(x = \"Precipita√ß√£o (mm)\", \n         y = \"Mean Pairwise Distance\\n (MPD - Abund√¢ncia)\", size = 8) +\n    tema_livro() \n\nMNTD_AP_plot <- ggplot(metricas_divergencia, aes(precipitacao, MNTD)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") + \n    labs(x = \"Precipita√ß√£o (mm)\", \n         y = \"Mean Nearest Taxon Distance\\n (MNTD - Aus√™ncia e Presen√ßa)\", \n         size = 8) +\n    tema_livro() \n\nMNTD_AB_plot <- ggplot(metricas_divergencia, aes(precipitacao, MNTD_AB)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") + \n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    labs(x = \"Precipita√ß√£o (mm)\", \n         y = \"Mean Nearest Taxon Distance\\n (MNTD - Abund√¢ncia)\", \n         size = 8) +\n    tema_livro()\n\nggarrange(MPD_PA_plot, MPD_AB_plot, MNTD_AP_plot, MNTD_AB_plot,\n          ncol = 2, nrow = 2)\n## Dados\n# Vamos inserir os dados de precipita√ß√£o na planilha metrica_riqueza.\nmetricas_riqueza$precipitacao <- precipitacao$prec\n\n## Gr√°ficos\nRiqueza_plot <- ggplot(metricas_riqueza, aes(precipitacao, riqueza)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") +\n    geom_smooth(method = lm, se = FALSE, color = \"black\") + \n    labs(x = \"Precipita√ß√£o (mm)\", y = \"Riqueza de esp√©cies\") +\n    tema_livro() \n\nPD_plot <- ggplot(metricas_riqueza, aes(precipitacao, PD)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") + \n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    labs(x = \"Precipita√ß√£o (mm)\", \n         y = \"Diversidade Filogen√©tica\\n (Faith)\", size = 8) +\n    tema_livro()\n\nPSR_plot <- ggplot(metricas_riqueza, aes(precipitacao, PSR)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\")  +\n    geom_smooth(method = lm, se = FALSE, color = \"black\") + \n    labs(x = \"Precipita√ß√£o (mm)\", \n         y = \"Phylogenetic Species Richness\\n (PSR)\", \n         size = 8) +\n    tema_livro()\n\nPE_plot <- ggplot(metricas_riqueza, aes(precipitacao, PE)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\")  +\n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    labs(x = \"Precipita√ß√£o (mm)\", \n         y = \"Phylogenetic Endemism\\n (PE)\", \n         size = 8) + \n    tema_livro() \n\nggarrange(Riqueza_plot, PD_plot, PSR_plot, PE_plot, ncol = 2, nrow = 2)"},{"path":"cap13.html","id":"m√©tricas-de-diversidade-beta-filogen√©tica","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.4 M√©tricas de diversidade beta filogen√©tica","text":"M√©tricas de diversidade beta filogen√©tica utilizam dados de presen√ßa e aus√™ncia ou abund√¢ncia das esp√©cies para determinar um valor que representa diferen√ßa entre comunidades em rela√ß√£o hist√≥ria evolutiva das linhagens (para detalhes de diversidade beta, consulte o Cap√≠tulo 12).","code":""},{"path":"cap13.html","id":"diverg√™ncia-da-diversidade-beta-filogen√©tica","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.4.1 Diverg√™ncia da diversidade beta filogen√©tica","text":"Community Mean Pairwise Distance (COMDIST)Esta m√©trica √© uma extens√£o MPD. COMDIST calcula m√©dia da dist√¢ncia filogen√©tica entre esp√©cies de duas comunidades (Webb, Ackerly, Kembel 2008). COMDIST pode ser calculada usando dados de incid√™ncia (presen√ßa e aus√™ncia) ou abund√¢ncia das esp√©cies. Esta extens√£o MPD tamb√©m √© conhecida na literatura como Dpw (Swenson 2011, 2014).Abaixo, demonstramos os c√≥digos R para o c√°lculo COMDIST utilizando os dados das comunidades de aves.comunidades 8 e 10 apresentaram menor m√©dia na dist√¢ncia filogen√©tica (130,06 m.. - esp√©cies de linhagens mais pr√≥ximas) entre esp√©cies presente em cada comunidade, enquanto comunidades 2 e 4 apresentaram maior m√©dia na dist√¢ncia filogen√©tica (153.29 m.. - esp√©cies de linhagens mais distintas).Vamos refazer an√°lise COMDIST, mas desta vez, considerando abund√¢ncia das esp√©cies de aves nas comunidades.Como caso MPD, pensar abund√¢ncia das esp√©cies altera o padr√£o de distribui√ß√£o dos valores de COMDIST. Neste caso, ao inv√©s das comunidades 2 e 4, comunidades 2 e 10 apresentam maior m√©dia na dist√¢ncia filogen√©tica (155,85 m..).Community Mean Nearest Taxon Distance (COMDISTNT)Esta m√©trica √© uma extens√£o MNTD. COMDISTNT calcula m√©dia da dist√¢ncia filogen√©tica entre o t√°xon mais pr√≥ximo das esp√©cies de duas comunidades (Webb, Ackerly, Kembel 2008). COMDISTNT pode ser calculada usando dados de incid√™ncia ou abund√¢ncia das esp√©cies. Esta extens√£o MNTD tamb√©m √© conhecida na literatura como Dnn (Swenson 2011).Abaixo, demonstramos os c√≥digos R para o c√°lculo COMDISTNT utilizando os dados das comunidades de aves.comunidades 8 e 9 apresentaram menor m√©dia na dist√¢ncia vizinho mais pr√≥ximo (10,69 m.. - esp√©cies mesmo g√™nero ou g√™neros irm√£os) entre esp√©cies presente em cada comunidade, enquanto comunidades 7 e 10 apresentaram maior m√©dia na dist√¢ncia entre vizinhos (60,24 m.. - esp√©cies de linhagens distintas).Vamos refazer an√°lise COMDISTNT, mas desta vez, considerando abund√¢ncia das esp√©cies de aves nas comunidades.comunidades 8 e 10 apresentaram menor m√©dia na dist√¢ncia vizinho mais pr√≥ximo (5,64 m..) entre esp√©cies presente em cada comunidade, enquanto comunidades 6 e 10 apresentaram maior m√©dia na dist√¢ncia entre vizinhos (82,62 m..).","code":"\n## Community Mean Pairwise Distance (COMDIST)\n# An√°lise com dados de presen√ßa e aus√™ncia das esp√©cies nas comunidades.\nresultados_Comdist_PA <- comdist(composicao_especies_P, \n                                 cophenetic(filogenia_aves), \n                                 abundance.weighted = FALSE)\nresultados_Comdist_PA\n#>           Com_1    Com_2    Com_3    Com_4    Com_5    Com_6    Com_7    Com_8    Com_9\n#> Com_2  150.5242                                                                        \n#> Com_3  144.3300 148.7436                                                               \n#> Com_4  149.4782 153.2992 147.5838                                                      \n#> Com_5  141.8435 146.9829 139.9606 145.8746                                             \n#> Com_6  142.6019 148.3160 140.0376 143.1340 137.9527                                    \n#> Com_7  147.7189 150.2248 147.1703 150.3418 144.1481 145.2975                           \n#> Com_8  141.3083 145.6684 138.5875 145.3897 137.0034 137.7062 144.4818                  \n#> Com_9  141.6018 146.4697 138.3515 144.3480 136.9036 136.3453 144.3257 130.7628         \n#> Com_10 140.8810 145.9333 136.9978 145.1400 136.5394 137.2350 144.3660 130.0691 130.2321\n## Community Mean Pairwise Distance (COMDIST)\n# An√°lise com dados de abund√¢ncia das esp√©cies nas comunidades.\nresultados_Comdist_AB <- comdist(composicao_especies_P, \n                                 cophenetic(filogenia_aves), \n                                 abundance.weighted = TRUE)\n## Community Mean Nearest Taxon Distance (COMDISTNT)\n# An√°lise com dados de presen√ßa e aus√™ncia das esp√©cies nas comunidades.\nresultados_Comdistnt_PA <- comdistnt(composicao_especies_P, \n                                     cophenetic(filogenia_aves), \n                                     abundance.weighted = FALSE)\nresultados_Comdistnt_PA\n#>           Com_1    Com_2    Com_3    Com_4    Com_5    Com_6    Com_7    Com_8    Com_9\n#> Com_2  24.65946                                                                        \n#> Com_3  18.56953 22.22310                                                               \n#> Com_4  26.85806 24.04505 17.87073                                                      \n#> Com_5  13.15074 34.14223 18.82684 25.54000                                             \n#> Com_6  35.43332 49.33726 33.82511 24.59980 28.50505                                    \n#> Com_7  30.37968 29.22411 39.89649 34.06858 29.27588 47.69536                           \n#> Com_8  38.16628 48.17376 38.46830 51.02029 32.52846 50.37593 54.37647                  \n#> Com_9  42.58727 54.09441 41.83792 46.29635 36.35245 46.18264 49.85495 10.69759         \n#> Com_10 45.71452 56.82713 40.39642 60.17935 40.74857 59.63770 60.24556 10.87162 16.12367\n## Community Mean Nearest Taxon Distance (COMDISTNT)\n# An√°lise com dados de abund√¢ncia das esp√©cies nas comunidades.\nresultados_Comdistnt_AB <- comdistnt(composicao_especies_P, \n                                     cophenetic(filogenia_aves), \n                                     abundance.weighted = TRUE)"},{"path":"cap13.html","id":"correla√ß√£o-entre-as-m√©tricas-de-diversidade-beta-filogen√©tica","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.4.2 Correla√ß√£o entre as m√©tricas de diversidade beta filogen√©tica","text":"Vamos avaliar correla√ß√£o entre os valores das m√©tricas da diversidade beta filogen√©tica para dimens√£o diverg√™ncia (Figura 13.10).\nFigura 13.10: Correla√ß√£o entre m√©tricas de diverg√™ncia da diversidade beta filogen√©tica.\nOs valores das m√©tricas de diverg√™ncia filogen√©tica beta apresentam correla√ß√µes mais baixas que m√©tricas da dimens√£o riqueza. Lembrem-se que COMDIST e COMDISTNT d√£o pesos diferentes para rela√ß√µes de parentesco. COMDIST pesa rela√ß√µes mais basais e internas da filogenia, enquanto COMDISTNT pesa rela√ß√µes nas partes terminais da filogenia. Portanto, elas podem trazer informa√ß√µes complementares.","code":"\n## Dados\n# Vamos criar um data frame com os resultados das m√©tricas da dimens√£o diverg√™ncia.\nmetricas_divergencia_beta <- data.frame(\n    COMDIST_PA = as.numeric(resultados_Comdist_PA),\n    COMDIST_AB = as.numeric(resultados_Comdist_AB),\n    COMDISTNT_PA = as.numeric(resultados_Comdistnt_PA),\n    COMDISTNT_AB = as.numeric(resultados_Comdistnt_AB))\n\n## Gr√°fico\nggpairs(metricas_divergencia_beta,\n        upper = list(continuous = wrap(\"cor\", size = 4))) +\n    tema_livro()"},{"path":"cap13.html","id":"associa√ß√£o-entre-a-diverg√™ncia-da-diversidade-beta-filogen√©tica-e-o-ambiente","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.4.3 Associa√ß√£o entre a diverg√™ncia da diversidade beta filogen√©tica e o ambiente","text":"Vamos avaliar e plotar rela√ß√£o entre os valores de algumas m√©tricas de diverg√™ncia da diversidade beta filogen√©tica (vari√°vel resposta) e os valores de precipita√ß√£o (vari√°vel preditora) (Figura 13.11).\nFigura 13.11: Rela√ß√£o de algumas m√©trica de diverg√™ncia diversidade beta filogen√©tica e valores de precipita√ß√£o.\nO COMDIST que avalia rela√ß√µes de parentesco mais internas da filogenia (.e.¬†rela√ß√µes entre esp√©cies de fam√≠lias diferentes) apresentou associa√ß√£o com o gradiente de precipita√ß√£o quando avaliado pesado pela abund√¢ncia das esp√©cies. Por outro lado, o COMDISTNT que avalia rela√ß√µes mais terminais da filogenia (.e.¬†esp√©cies dentro mesmo g√™nero) apresentou uma rela√ß√£o negativa com o gradiente de precipita√ß√£o quando avaliado usando incid√™ncia das esp√©cies.","code":"\n## Dados\n# Precisamos calcular a dissimilaridade par a par da precipita√ß√£o entre as comunidades.\ndis_prec <- vegdist(precipitacao, \"euclidian\")\n\n# Vamos inserir estes dados na planilha metrica_divergencia_beta.\nmetricas_divergencia_beta$dis_prec <- as.numeric(dis_prec)\n\n# Gr√°ficos.\nCOMDIST_PA_plot <- ggplot(metricas_divergencia_beta, \n                          aes(dis_prec, COMDIST_PA)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") +\n    labs(x = \"Diferen√ßa na precipita√ß√£o (mm)\", \n         y = \"COMDIST\\n (Presen√ßa e Aus√™ncia)\") + \n    tema_livro() \n\nCOMDIST_AB_plot <- ggplot(metricas_divergencia_beta, \n                          aes(dis_prec, COMDIST_AB)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") +\n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    labs(x = \"Diferen√ßa na precipita√ß√£o (mm)\", \n         y = \"COMDIST\\n (Abund√¢ncia)\", size = 8) +\n    tema_livro()\n\nCOMDISTNT_PA_plot <- ggplot(metricas_divergencia_beta, \n                            aes(dis_prec, COMDISTNT_PA)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") +\n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    labs(x = \"Diferen√ßa na precipita√ß√£o (mm)\", \n         y = \"COMDISTNT\\n (Aus√™ncia e Presen√ßa)\", \n         size = 8) + \n    tema_livro()\n\nCOMDISTNT_AB_plot <- ggplot(metricas_divergencia_beta, \n                            aes(dis_prec, COMDISTNT_AB)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") +\n    labs(x = \"Diferen√ßa na precipita√ß√£o (mm)\", \n         y = \" COMDISTNT\\n (Abund√¢ncia)\", \n         size = 8) +\n    tema_livro() \n\nggarrange(COMDIST_PA_plot, COMDIST_AB_plot, COMDISTNT_PA_plot, \n          COMDISTNT_AB_plot, ncol = 2, nrow = 2)"},{"path":"cap13.html","id":"riqueza-da-diversidade-beta-filogen√©tica","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.4.4 Riqueza da diversidade beta filogen√©tica","text":"Phylogenetic index beta diversity (Phylosor)Phylosor √© uma m√©trica de similaridade e determina o comprimento total dos ramos da filogenia que √© compartilhado entre pares de comunidades (Bryant et al. 2008).Abaixo, demonstramos os c√≥digos R para o c√°lculo Phylosor utilizando os dados das comunidades de aves.esp√©cies presentes nas comunidades 6 e 10 compartilham menor por√ß√£o comprimento dos ramos da filogenia (53% - menor similaridade entre os pares de comunidades), enquanto esp√©cies presentes nas comunidades 8 e 10 compartilham grande parte dos comprimentos dos ramos da filogenia (91% - maior similaridade entre os pares de comunidades).Unique Fraction metric (UniFrac)UniFrac √© uma m√©trica de dissimilaridade e determina fra√ß√£o √∫nica da filogenia contida em cada uma das duas comunidades (Lozupone Knight 2005).Abaixo, demonstramos os c√≥digos R para o c√°lculo da UniFrac utilizando os dados das comunidades de aves.esp√©cies presentes nas comunidades 6 e 10 apresentam menor dissimilaridade (16,4 % - maior fra√ß√£o √∫nica da filogenia em cada comunidade), enquanto esp√©cies presentes nas comunidades 8 e 10 apresentam maior dissimilaridade (63,36 % - maior compartilhamento de ramos da filogenia entre os pares de comunidades).","code":"\n## Phylogenetic index of beta diversity (Phylosor)\n# An√°lise com dados de presen√ßa e aus√™ncia das esp√©cies nas comunidades.\nresultados_Phylosor <- phylosor(composicao_especies_P, filogenia_aves)\n\n# Mostra uma matriz triangular com a similaridade entre a fra√ß√£o dos ramos \n# compartilahdos entre duas comunidades\nresultados_Phylosor \n#>            Com_1     Com_2     Com_3     Com_4     Com_5     Com_6     Com_7     Com_8     Com_9\n#> Com_2  0.7856828                                                                                \n#> Com_3  0.8052839 0.7794964                                                                      \n#> Com_4  0.7831520 0.8066793 0.8595462                                                            \n#> Com_5  0.8586780 0.6919478 0.8083230 0.7930266                                                  \n#> Com_6  0.6717414 0.5827551 0.6977734 0.7494945 0.7383098                                        \n#> Com_7  0.7414284 0.7325727 0.6836231 0.7289449 0.7384561 0.6425717                              \n#> Com_8  0.6826177 0.6283918 0.6443193 0.6404373 0.7123197 0.5928097 0.6146854                    \n#> Com_9  0.6789983 0.6074676 0.6405220 0.6727656 0.7082867 0.6169977 0.6506880 0.9016007          \n#> Com_10 0.6264594 0.5709671 0.6422800 0.5823317 0.6493935 0.5362575 0.6015983 0.9106658 0.8607104\n## Unique Fraction metric (UniFrac)\n# An√°lise com dados de presen√ßa e aus√™ncia das esp√©cies nas comunidades.\nresultados_UniFrac <- unifrac(composicao_especies_P, filogenia_aves)"},{"path":"cap13.html","id":"correla√ß√£o-entre-phylosor-e-unifrac","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.4.5 Correla√ß√£o entre Phylosor e Unifrac","text":"Vamos calcula correla√ß√£o entre duas m√©tricas de Riqueza da diversidade beta filogen√©tica: Phylosor e Unifrac (Figura 13.12).\nFigura 13.12: Correla√ß√£o entre m√©tricas de riqueza da diversidade beta filogen√©tica.\nOs valores de Phylosor e UniFrac apresenta 99% de correla√ß√£o entre eles. Portanto, essas duas m√©tricas identificam padr√µes id√™nticos e n√£o devem ser utilizadas simultaneamente.","code":"\n## Dados\n# Vamos criar um data.frame com os resultados das m√©tricas separados \n# para as dimens√µes de riqueza e diverg√™ncia.\nmetricas_riqueza_beta <- data.frame(Phylosor = as.numeric(resultados_Phylosor),\n                                    UniFrac = as.numeric(resultados_UniFrac))\n\n## Gr√°fico\nggpairs(metricas_riqueza_beta, upper=list(continuous = wrap(\"cor\", size = 4))) +\n    tema_livro()"},{"path":"cap13.html","id":"associa√ß√£o-entre-a-riqueza-da-diversidade-beta-filogen√©tica-e-o-ambiente","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.4.6 Associa√ß√£o entre a riqueza da diversidade beta filogen√©tica e o ambiente","text":"Vamos avaliar e plotar rela√ß√£o entre os valores de algumas m√©tricas de riqueza da diversidade beta filogen√©tica (vari√°vel resposta) e os valores de precipita√ß√£o (vari√°vel preditora) (Figura 13.13).\nFigura 13.13: Rela√ß√£o de algumas m√©trica de riqeuza diversidade beta filogen√©tica e valores de precipita√ß√£o.\nPhylosor (similaridade) e UniFrac (dissimilaridade) foram relacionadas com o gradiente de precipita√ß√£o. Comunidades com quantidade de precipita√ß√£o parecidas abrigaram linhagens similares enquanto comunidades que recebem quantidade de precipita√ß√£o diferentes abrigam linhagens mais distintas.","code":"\n## Dados\n# Vamos inserir os dados de precipita√ß√£o na planilha metrica_riqueza_beta.\nmetricas_riqueza_beta$dis_prec <- as.numeric(dis_prec)\n\n## Gr√°ficos\n# Phylosor.\nplot_phylosor <- ggplot(metricas_riqueza_beta, aes(dis_prec, Phylosor)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") + \n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    scale_y_continuous(limits = c(0, 1.0)) +\n    labs(x = \"Diferen√ßa na precipita√ß√£o (mm)\", \n         y = \"Phylosor\", size = 8) +\n    tema_livro()\n\n# Unifrag.\nplot_unifrac <- ggplot(metricas_riqueza_beta, aes(dis_prec, UniFrac)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") + \n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    scale_y_continuous(limits = c(0, 1.0)) +\n    labs(x = \"Diferen√ßa na precipita√ß√£o (mm)\", \n         y = \"UniFrac\", size = 8) +\n    tema_livro()\n\nggarrange(plot_phylosor, plot_unifrac, ncol = 2)"},{"path":"cap13.html","id":"parti√ß√£o-da-diversidade-beta-filogen√©tica","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.4.7 Parti√ß√£o da diversidade beta filogen√©tica","text":"m√©tricas, Phylosor e UniFrac, podem ser particionadas em dois componentes (Baselga 2010; Leprieur et al. 2012): ) substitui√ß√£o (ingl√™s turnover) de esp√©cies entre comunidades; e ii) componente de aninhamento (ingl√™s nestedness) que representa perda ou ganho de esp√©cies entre comunidades atribu√≠dos diferen√ßa na riqueza de esp√©cies. parti√ß√£o da diversidade beta nestes componentes permite avaliar diferentes hip√≥teses sobre os processos e mecanismos atuando na montagem de comunidades.Abaixo, demonstramos os c√≥digos R para o c√°lculo da parti√ß√£o da diversidade beta filogen√©tica utilizando os dados das comunidades de aves.Vamos refazer an√°lise para UniFrac.Gr√°fico com os resultados dos componentes substitui√ß√£o e aninhamento da diversidade beta filogen√©tica - Phylosor (Figura 13.14).\nFigura 13.14: Rela√ß√£o dos componentes substitui√ß√£o e aninhamento da diversidade beta filogen√©tica - Phylosor e valores de precipita√ß√£o.\nPercebam que o componente substitui√ß√£o √© maior entre comunidades que apresentam diferen√ßas altas na quantidade de precipita√ß√£o, enquanto o componente aninhamento √© maior entre comunidades que apresentam quantidade similar de precipita√ß√£o.","code":"\n## Parti√ß√£o\n# Temos que transformar os dados para presen√ßa e aus√™ncia das esp√©cies nas comunidades.\ndados_PA <- decostand(composicao_especies_P, \"pa\")\n\n# Parti√ß√£o dos componentes do Phylosor.\nresultados_Phylosor_particao <- phylo.beta.pair(dados_PA,\n                                                filogenia_aves, \n                                                index.family = \"sorensen\")\n# Parti√ß√£o dos componentes do UniFrac.\nresultados_UniFrac_particao <- phylo.beta.pair(dados_PA,\n                                               filogenia_aves, \n                                               index.family = \"jaccard\")\n# Resultado tem tr√™s matrizes: \n# i) dissimilaridade total (phylo.beta.jac); \n# ii) componente substitui√ß√£o de esp√©cies (phylo.beta.jtu); e \n# iii) componente aninhamento (phylo.beta.jne).\n# resultados_UniFrac_particao (para ver os resultados corra este comando)\n## Dados\n# Vamos preparar os dados para o gr√°fico.\nparticao_phylosor <- data.frame(\n    substituicao = as.numeric(resultados_Phylosor_particao$phylo.beta.sim),\n    aninhamento = as.numeric(resultados_Phylosor_particao$phylo.beta.sne),\n    sorensen = as.numeric(resultados_Phylosor_particao$phylo.beta.sor),\n    dis_prec = as.numeric(dis_prec))\n\n## Gr√°ficos\nsorensen_plot <- ggplot(particao_phylosor, \n                        aes(dis_prec, sorensen)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") + \n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    labs(x = \"\", y = \"Sorensen\") +\n    tema_livro()\n\nsubst_plot <- ggplot(particao_phylosor, \n                     aes(dis_prec, substituicao)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") + \n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    labs(x = \"Diferen√ßa na precipita√ß√£o\\n (mm)\", \n         y = \"Componente Substitui√ß√£o\", size = 8) +\n    tema_livro()\n\naninha_plot <- ggplot(particao_phylosor, \n                      aes(dis_prec, aninhamento)) +\n    geom_point(size = 4, shape = 19, col = \"darkorange\") + \n    geom_smooth(method = lm, se = FALSE, color = \"black\") +\n    labs(x = \"\", y = \"Componente aninhamento\", size = 8) +\n    tema_livro()\n\nggarrange(sorensen_plot, subst_plot, aninha_plot, \n          ncol = 3, nrow = 1)"},{"path":"cap13.html","id":"modelos-nulos","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.5 Modelos Nulos","text":"Em muitos casos, os valores de diversidade filogen√©tica s√£o correlacionados com riqueza de esp√©cies nas comunidades. Por exemplo, se um pesquisador relata que duas comunidades apresentam diferentes valores de PD, √© imposs√≠vel saber se esta diferen√ßa √© simplesmente porque elas t√™m diferentes valores de riqueza de esp√©cies ou se h√° algum fator fundamental sobre informa√ß√£o filogen√©tica que √© importante. Outra quest√£o abordada nos estudos de montagem das comunidades √© saber se os valores observados para m√©tricas (e.g.¬†MPD ou MNTD) relacionadas com estrutura filogen√©tica das comunidades seriam diferentes se coloniza√ß√£o das esp√©cies pool regional fosse aleat√≥ria? Os modelos nulos respondem estas perguntas. Contudo, defini√ß√£o pool regional n√£o √© uma tarefa trivial (Lessard et al. 2012; Carstensen et al. 2013).Os modelos nulos s√£o constru√≠dos considerando processos ecol√≥gicos ou evolutivos de interesse. Eles geram padr√µes que s√£o baseados na aleatoriza√ß√£o dos dados ecol√≥gicos ou amostragens aleat√≥rias de uma distribui√ß√£o conhecida ou hip√≥tetica (Gotelli Graves 1996). Neste caso, alguns elementos dos dados (como colunas ou linhas) s√£o mantidos constantes, e outros s√£o permitidos variar aleatoriamente para criar novos padr√µes. O principal motivo para constru√ß√£o de modelos nulos √© produzir um padr√£o que seria esperado na aus√™ncia de um mecanismo ecol√≥gico espec√≠fico (Gotelli Graves 1996). Contudo, ressaltamos que os modelos nulos podem revelar padr√µes n√£o comuns, mas eles n√£o podem determinar os mecanismos respons√°veis por gerar estes padr√µes (Gotelli Graves 1996).Os modelos nulos empregados para contrapor os padr√µes observados pelas m√©tricas de diversidade filogen√©tica utilizam aleatoriza√ß√£o dos dados de duas formas principais: ) aleatorizando o nome das esp√©cies na √°rvore filogen√©tica mantendo estrutura e composi√ß√£o da matriz de co-ocorr√™ncia das esp√©cies e o comprimento dos ramos da √°rvore inalterados; e ii) aleatorizando linhas e/ou colunas da matriz de co-ocorr√™ncia das esp√©cies (Gotelli 2000; Ulrich Gotelli 2010). De forma geral, nas an√°lises de diversidade filogen√©tica aleatoriza√ß√µes s√£o repetidas 999 vezes (pode ser mais ou menos, crit√©rio pesquisador) e calcula-se m√©dia e o desvio padr√£o dos valores gerados pelo modelos. Com estes dados, calcula-se o tamanho efeito padronizado (ingl√™s Standardized Effect Size - SES) utilizando seguinte f√≥rmula:SES = (valor observado - m√©dia dos valores gerados na aleatoriza√ß√£o)/ desvio padr√£o dos valores gerados na aleatoriza√ß√£oOs valores de SES s√£o utilizados para rejeitar ou n√£o hip√≥tese nula de que o padr√£o observado difere esperado ao acaso. Contudo, tenha em mente que defini√ß√£o esquema de aleatoriza√ß√£o dos modelos nulos n√£o √© meramente uma quest√£o t√©cnica (G√∂tzenberger et al. 2012). defini√ß√£o esquema de aleatoriza√ß√£o ir√° determinar quais os mecanismos ecol√≥gicos s√£o permitidos ou exclu√≠dos modelo nulo (G√∂tzenberger et al. 2012). Consequentemente, ele estar√° avaliando diferentes hip√≥teses nulas.Abaixo, demonstramos os c√≥digos R para calcular os modelos nulos para m√©tricas de diversidade filogen√©tica.Nearest Relative Index (NRI) ou Standardized Effect Size MPDEsta m√©trica calcula o tamanho efeito padronizado para m√©trica MPD. Contudo, NRI √© calculado multiplicando os resultados SES por -1. Valores positivos de NRI indicam agrupamento filogen√©tico e valores negativos de NRI indicam dispers√£o filogen√©tica (Webb, Ackerly, Kembel 2008).Veja ajuda desta fun√ß√£o usando ?ses.mpd() para ver todas possibilidades de modelos nulos dispon√≠veis.Somente comunidades 5 e 6 apresentaram valores de p < 0.05 indicando que os resultados observados de MPD s√£o menores que o esperado ao acaso (.e.¬†valores simulados). Neste caso, composi√ß√£o de esp√©cies presentes nessas duas comunidades apresenta agrupamento filogen√©tico. Por outro lado, os valores de MPD observados para outras comunidades s√£o similares aos valores obtidos para comunidades simuladas com redistribui√ß√£o dos nomes das esp√©cies na filogenia.Nearest Taxon Index (NTI) ou Standardized Effect Size MNTDEsta m√©trica calcula o tamanho efeito padronizado para m√©trica MNTD. Contudo, NTI √© calculado multiplicando os resultados SES por -1. Valores positivos de NTI indicam agrupamento filogen√©tico e valores negativos de NTI indicam dispers√£o filogen√©tica (Webb, Ackerly, Kembel 2008).Somente comunidade 9 apresentou valor de p < 0.05 indicando que o resultado observado de MNTD foi menor que o esperado ao acaso (.e.¬†valores simulados). Neste caso, composi√ß√£o de esp√©cies presente nessa comunidade apresenta agrupamento filogen√©tico. Por outro lado, os valores de MNTD observados para outras comunidades s√£o similares aos valores obtidos para comunidades simuladas com redistribui√ß√£o dos nomes das esp√©cies na filogenia.Standardized Effect Size PDEsta m√©trica calcula o tamanho efeito padronizado para m√©trica PD (Webb, Ackerly, Kembel 2008).Nenhuma comunidade apresentou valor de p < 0.05. Neste caso, os valores observados de PD s√£o similares aos valores obtidos para comunidades simuladas com redistribui√ß√£o dos nomes das esp√©cies na filogenia.Standardized effect size PhylosorN√£o h√° pacotes que calculam o SES para m√©trica Phylosor. Assim, iremos usar fun√ß√£o phylosor.rnd() para criar modelos nulos para o Physolor, e em seguida, iremos usar uma fun√ß√£o criada por Pedro Braga & Katherine H√©bert (dispon√≠vel em https://pedrohbraga.github.io/CommunityPhylogenetics-Workshop/CommunityPhylogenetics-Workshop.html) para calcular os valores de SES e os valores de P.Nenhum valor de similaridade entre pares comunidade apresentou valor de p < 0.05. Neste caso, os valores de Phylosor observados s√£o similares aos valores obtidos para comunidades simuladas com redistribui√ß√£o dos nomes das esp√©cies na filogenia.","code":"\n## NRI ou SES_MPD\nresultados_SES_MPD <- ses.mpd(composicao_especies_P, cophenetic(filogenia_aves),\n                              null.model = \"taxa.labels\", \n                              abundance.weighted = FALSE,\n                              runs = 999) \n\n# Mostra a riqueza de esp√©ices, MPD observado, m√©dia e desvio padr√£o dos \n# valores de MPD das aleatoriza√ß√µes, SES e o valor de p.\nhead(resultados_SES_MPD)\n#>       ntaxa  mpd.obs mpd.rand.mean mpd.rand.sd mpd.obs.rank  mpd.obs.z mpd.obs.p runs\n#> Com_1    27 150.7914      153.9953    3.891718          215 -0.8232597     0.215  999\n#> Com_2    26 157.3158      153.5833    4.367399          770  0.8546215     0.770  999\n#> Com_3    25 146.1622      153.9931    4.476428           52 -1.7493791     0.052  999\n#> Com_4    25 154.5005      153.5113    4.720348          551  0.2095591     0.551  999\n#> Com_5    22 143.0727      153.7490    5.294432           24 -2.0165115     0.024  999\n#> Com_6    18 141.1926      153.9709    6.951990           34 -1.8380846     0.034  999\n## NTI ou SES_MNTD\nresultados_SES_MNTD <- ses.mntd(composicao_especies_P, cophenetic(filogenia_aves),\n                                null.model = \"taxa.labels\", \n                                abundance.weighted = FALSE,\n                                runs = 999) \n\n# Mostra a riqueza de esp√©ices,MNTD observado, m√©dia e desvio padr√£o dos \n# valores de MNTD das aleatoriza√ß√µes, SES e o valor de p.\nhead(resultados_SES_MNTD)\n#>       ntaxa mntd.obs mntd.rand.mean mntd.rand.sd mntd.obs.rank  mntd.obs.z mntd.obs.p runs\n#> Com_1    27 63.89727       63.30504     6.864478           518  0.08627467      0.518  999\n#> Com_2    26 66.15828       64.81499     7.217753           575  0.18610860      0.575  999\n#> Com_3    25 72.96912       65.76333     7.754651           811  0.92922217      0.811  999\n#> Com_4    25 67.67170       65.70886     7.752673           600  0.25318258      0.600  999\n#> Com_5    22 64.93477       69.46545     9.133114           305 -0.49607138      0.305  999\n#> Com_6    18 63.72337       76.12099    11.819687           162 -1.04889562      0.162  999\n## SES_PD\nresultados_SES_PD <- ses.pd(composicao_especies_P, filogenia_aves,\n                            null.model = \"independentswap\", \n                            runs = 999) \n\n# Mostra a riqueza de esp√©ices,MNTD observado, m√©dia e desvio padr√£o dos \n# valores de PD das aleatoriza√ß√µes, SES e o valor de p.\nhead(resultados_SES_PD) \n#>       ntaxa   pd.obs pd.rand.mean pd.rand.sd pd.obs.rank   pd.obs.z pd.obs.p runs\n#> Com_1    27 1259.315     1272.480   66.74674         429 -0.1972372    0.429  999\n#> Com_2    26 1293.152     1238.690   68.04238         799  0.8004172    0.799  999\n#> Com_3    25 1222.310     1201.471   65.51971         624  0.3180526    0.624  999\n#> Com_4    25 1254.541     1205.879   68.34858         750  0.7119674    0.750  999\n#> Com_5    22 1021.967     1096.024   67.73466         129 -1.0933409    0.129  999\n#> Com_6    18  856.781      950.239   64.54864          76 -1.4478696    0.076  999\n## Standardized effect size do Phylosor\n# Modelo nulo que rearranja o nome das esp√©cies na filogenia. \nmodelos_nulo <- phylosor.rnd(composicao_especies_P, filogenia_aves, \n                             null.model = \"taxa.labels\", runs = 9)\n\n# Fun√ß√£o para calcular o SES eo valor de P.\nses.physo <- function(obs, nulo_phylosor){\n    nulo_phylosor <- t(as.data.frame(lapply\n                                     (nulo_phylosor, as.vector)))\n    physo.obs <- as.numeric(obs)\n    physo.mean <- apply(nulo_phylosor, MARGIN = 2, \n                        FUN = mean, na.rm = TRUE)\n    physo.sd <- apply(nulo_phylosor, MARGIN = 2, \n                      FUN = sd, na.rm = TRUE)\n    physo.ses <- (physo.obs - physo.mean)/physo.sd\n    physo.obs.rank <- apply(X = rbind(physo.obs, \n                                      nulo_phylosor), MARGIN = 2, \n                            FUN = rank)[1, ]\n    physo.obs.rank <- ifelse(is.na(physo.mean), NA, \n                             physo.obs.rank)\n    data.frame(physo.obs, physo.mean, physo.sd, \n               physo.obs.rank, physo.ses, \n               physo.obs.p = physo.obs.rank/\n                   (dim(nulo_phylosor)[1] + 1))\n}\n\n## Resultados\nresultados <- ses.physo (resultados_Phylosor, modelos_nulo)\nhead(resultados)\n#>   physo.obs physo.mean   physo.sd physo.obs.rank  physo.ses physo.obs.p\n#> 1 0.7856828  0.7915561 0.04011508              6 -0.1464099         0.6\n#> 2 0.8052839  0.8813422 0.03356047              1 -2.2663056         0.1\n#> 3 0.7831520  0.8174306 0.04545519              2 -0.7541175         0.2\n#> 4 0.8586780  0.8687616 0.03659588              5 -0.2755416         0.5\n#> 5 0.6717414  0.7460991 0.02806215              1 -2.6497526         0.1\n#> 6 0.7414284  0.6904007 0.04842748              9  1.0536941         0.9"},{"path":"cap13.html","id":"para-se-aprofundar-9","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.6 Para se aprofundar","text":"","code":""},{"path":"cap13.html","id":"livros-7","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.6.1 Livros","text":"Recomendamos aos interessados os livros: ) Swenson (2014) Functional Phylogenetic Ecology R; ii) Paradis (2012) Analysis Phylogenetics Evolution R; iii) Cadotte & Davies (2016) Phylogenies Ecology, iv) Gotelli & Graves (1996) Null Models Ecology; e v) Magurran & McGill (2011) Biological Diversity Frontiers Measurement Assessment.","code":""},{"path":"cap13.html","id":"links-8","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.6.2 Links","text":"O blog Ferramentas filogen√©ticas para biologia comparada pesquisador Liam Revell √© uma ferramenta excelente para obter informa√ß√µes e aplica√ß√µes das an√°lises filogen√©ticas diretamente R.","code":""},{"path":"cap13.html","id":"exerc√≠cios-9","chapter":"Cap√≠tulo 13 Diversidade Filogen√©tica","heading":"13.7 Exerc√≠cios","text":"13.1\nCarregue os dados - anuros_composicao (.e., 211 esp√©cies de anuros coletados em 44 localidades na Mata Atl√¢ntica), anuros_ambientais (.e., vari√°veis clim√°ticas, topogr√°ficas e coordenadas geogr√°ficas) e filogenia_anuros (filogenia das 211 esp√©cies) - que est√£o pacote ecodados. Use fun√ß√£o varpart() pacote vegan para testar import√¢ncia relativa dos efeitos da precipita√ß√£o anual, range altitudinal e temperatura anual na distribui√ß√£o espacial da diversidade filogen√©tica (PD) e Endemismo filogen√©tico (PE). Calcule o SES para verificar se os resultados da diversidade filogen√©tica (PD) diferem esperado ao acaso devido ao n√∫mero de esp√©cies em cada comunidade. Qual sua interpreta√ß√£o sobre os resultados?13.2\nCarregue os dados - anuros_composicao (.e., 211 esp√©cies de anuros coletados em 44 localidades na Mata Atl√¢ntica), anuros_ambientais (.e., vari√°veis clim√°ticas, topogr√°ficas e coordenadas geogr√°ficas) e filogenia_anuros (filogenia das 211 esp√©cies) - que est√£o pacote ecodados. Use fun√ß√£o varpart() pacote vegan para testar import√¢ncia relativa dos efeitos da precipita√ß√£o anual, range altitudinal e temperatura anual na distribui√ß√£o espacial NRI e NTI. Qual sua interpreta√ß√£o sobre os resultados?13.3\nCarregue os dados - anuros_composicao (.e., 211 esp√©cies de anuros coletados em 44 localidades na Mata Atl√¢ntica), anuros_ambientais (.e., vari√°veis clim√°ticas, topogr√°ficas e coordenadas geogr√°ficas) e filogenia_anuros (filogenia das 211 esp√©cies) - que est√£o pacote ecodados. Use fun√ß√£o varpart() pacote vegan para testar import√¢ncia relativa dos efeitos da precipita√ß√£o anual, range altitudinal e dist√¢ncia geogr√°fica na distribui√ß√£o espacial dos diferentes componentes da diversidade beta filogen√©tica (Phylosor). Qual sua interpreta√ß√£o sobre os resultados?Solu√ß√µes dos exerc√≠cios.","code":""},{"path":"cap14.html","id":"cap14","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"Cap√≠tulo 14 Diversidade Funcional","text":"","code":""},{"path":"cap14.html","id":"pr√©-requisitos-do-cap√≠tulo-10","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"Pr√©-requisitos do cap√≠tulo","text":"Pacotes, dados e fun√ß√µes que ser√£o utilizados nesse cap√≠tulo.","code":"\n## Pacotes \nlibrary(FD)\nlibrary(ade4)\nlibrary(ecodados)\nlibrary(gridExtra)\nlibrary(ggplot2)\nlibrary(ggrepel)\nlibrary(tidyverse)\nlibrary(picante)\nlibrary(vegan)\nlibrary(SYNCSA)\nlibrary(GGally)\nlibrary(FD)\nlibrary(betapart)\nlibrary(nlme)\nlibrary(ape)\nlibrary(TPD)\nlibrary(cati)\nlibrary(kableExtra)\n\n## Dados e fun√ß√µes\ncomun_fren_dat <- ecodados::fundiv_frenette2012a_comu\nambie_fren_dat <- ecodados::fundiv_frenette2012a_amb\ntrait_fren_dat <- ecodados::fundiv_frenette2012a_trait\ntrait_dat      <- ecodados::fundiv_barbaro2009a_trait\ncomun_dat      <- ecodados::fundiv_barbaro2009a_comu\nambie_dat      <- ecodados::fundiv_barbaro2009a_amb\ntrait_baselga  <- ecodados::trait_baselga\ncomm_baselga   <- ecodados::comm_baselga\nanuros_comm    <- ecodados::anuros_comm\ntraits         <- ecodados::traits\nenv            <- ecodados::env\n# ecodados::wITV # funtion: wITV"},{"path":"cap14.html","id":"aspectos-te√≥ricos-5","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.1 Aspectos te√≥ricos","text":"At√© d√©cada de 1990, teoria ecol√≥gica investigava basicamente quais processos determinavam abund√¢ncia e riqueza de esp√©cies espa√ßo e tempo. d√©cadas de 1980 e 1990 foram marcadas por intensos debates sobre regras de montagem de comunidades e como intera√ß√µes e filtros ambientais determinavam coexist√™ncia de esp√©cies (Strong et al. 1984). Por√©m, d√©cada de 2000 foi marcada pelo uso mais expl√≠cito da caracter√≠sticas das esp√©cies como uma vari√°vel fundamental tanto para explicar como distribui√ß√£o dos organismos seria afetada pelo ambiente, quanto para entender como tais esp√©cies afetariam o ecossistema (Dƒ±ÃÅaz Cabido 2001; McGill et al. 2006). O primeiro estudo que utilizou o termo Diversidade Funcional foi publicado por Williams (1967), que comparou esp√©cies de na√∫plios filogen√©ticamente relacionadas e demonstrou que elas possuem alta plasticidade funcional que favorecem ampla varia√ß√£o de comportamentos e, desse modo, permitem que sejam esp√©cies generalistas em ambientes em contante mudan√ßa. unidade b√°sica desses estudos, o atributo funcional (ingl√™s ‚Äúfunctional trait‚Äù), √© definido como uma propriedade mensur√°vel dos organismos (geralmente em n√≠vel individual) que represente caracter√≠sticas morfol√≥gicas, fisiol√≥gicas ou fenol√≥gicas que afetam aptid√£o alterando aspectos crescimento, reprodu√ß√£o e sobreviv√™ncia (Violle et al. 2007). Mais especificamente, o atributo funcional pode ser divido em atributo efeito (.e., atributos organismo que afetam condi√ß√µes ambientais ou propriedades ecossistema) e resposta (.e., atributos organismo que variam em resposta condi√ß√µes ambientais) (Violle et al. 2007).Dessa forma, medidas de diversidade passaram ser representadas n√£o somente por diferen√ßas n√∫mero e na quantidade de esp√©cies, mas pelas diferen√ßas e/ou semelhan√ßas dos atributos funcionais das esp√©cies dentro e entre localidades. Assim, varia√ß√£o grau de express√£o de diferentes atributos funcionais entre diferentes popula√ß√µes, comunidades ou ecossistemas √© definida como Diversidade Funcional (sensu Garnier, Navas, Grigulis 2015). Por√©m, diversidade funcional n√£o deve ser usada como medida √∫nica, uma vez que tais diferen√ßas entre os atributos funcionais pode ser medida partir da abund√¢ncia relativa, riqueza e varia√ß√£o dos atributos funcionais. Desse modo, podemos dividir diversidade funcional em tr√™s diferentes medidas: ) riqueza funcional, ii) diverg√™ncia funcional, e iii) regularidade funcional (Vill√©ger, Mason, Mouillot 2008). Existem dezenas de m√©tricas que calculam cada uma dessas dimens√µes da diversidadade funcional, mas se destacam aquelas baseadas em dendrograma (e.g., FD: Petchey Gaston 2002) ou em medidas de dist√¢ncia (e.g., Vill√©ger, Mason, Mouillot 2008). Assim como diversidade taxon√¥mica (Cap√≠tulo 12), diversidade funcional pode ser medida em componentes alfa e beta. seguir, apresentamos diferentes maneiras de calcular dist√¢ncia entre localidades tendo como base os atributos funcionais das esp√©cies e, al√©m disso, demonstramos como calcular algumas das m√©tricas de diversidade (alfa e beta) funcional mais usadas em Ecologia. parte final deste cap√≠tulo apresenta dois exemplos de como podemos testar hip√≥teses ecol√≥gicas comparando diversidade funcional alfa e beta.","code":""},{"path":"cap14.html","id":"definindo-a-dissimilaridade-entre-esp√©cies","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.2 Definindo a dis(similaridade) entre esp√©cies","text":"Definir o qu√£o diferente ou semelhante s√£o duas esp√©cies que ocorrem em uma determinada localidade √© base para calcular diversidade alfa e beta funcional. Para isso, √© fundamental ter em mente que os atributos funcionais podem ser de v√°rios tipos como, por exemplo, cont√≠nuos (e.g., tamanho corporal em cent√≠metro), categ√≥ricos (e.g., guilda: frug√≠voro, detrit√≠voro, etc.), ordinais (e.g., 1 para organismo at√© 5 cm, 2 para organismos entre 5 e 30 cm, e 3 para organismos maiores que 30 cm), bin√°rios (e.g., presen√ßa ou aus√™ncia de espinho), entre outros [veja Figura 2.1 Cap√≠tulo 2]. Por este motivo, decis√£o m√©todo de dist√¢ncia s√≥ ser√° poss√≠vel ap√≥s o reconhecimento dos tipos de atributos funcionais escolhidos. Em linhas gerais, para vari√°veis cont√≠nuas dist√¢ncia euclideana √© melhor op√ß√£o, enquanto para os outros tipos de vari√°veis ou para conjuntos de atributos com mais de um tipo de vari√°vel, dist√¢ncia de Gower geralmente deve ser melhor op√ß√£o (Pavoine et al. 2009).Exemplo pr√°ticoExemplo1: vari√°veis cont√≠nuasVamos utilizar um conjunto de dados com atributos cont√≠nuos (e.g., √°rea foliar espec√≠fica e massa foliar seca) de 34 esp√©cies de plantas em um gradiente de aridez (Frenette-Dussault et al. 2012). Diversas an√°lises funcionais podem ser afetadas por valores extremos ou pela diferen√ßa de unidade/escala entre vari√°veis utilizadas. Por este motivo, √© importante padronizar matriz de atributos com m√©dia 0 e desvio padr√£o 1. Esta padroniza√ß√£o √© necess√°ria tanto para fazer uma PCA como para PCoA (veja Cap√≠tulo 9).PerguntaQuais s√£o esp√©cies de plantas mais semelhantes? (Neste caso, sem predi√ß√£o, pois representa uma avalia√ß√£o explorat√≥ria com caracter√≠sticas funcionais das esp√©cies).Vari√°veisDependentes: atributos funcionais (matriz de atributos cont√≠nuos por esp√©cie: trait_fren_dat)An√°lisesAqui realizamos os passos para uma ordena√ß√£o usando os atributos funcionais cont√≠nuos (Figura 14.1).\nFigura 14.1: Ordena√ß√£o usando os atributos funcionais cont√≠nuos.\nExemplo 2: vari√°veis categ√≥ricasAo contr√°rio dos dados cont√≠nuos, para dados categ√≥ricos n√£o √© poss√≠vel utilizar PCA. pr√≥ximo exemplo, utilizamos atributos funcionais de besouros distribu√≠dos na Europa (Barbaro Van Halder 2009). Esses dados s√£o categ√≥ricos e incluem atributos como per√≠odo de atividade (noturno, diurno, dioturno), tend√™ncia da popula√ß√£o na europa (est√°vel, aumentando, diminu√≠ndo) entre outros.PerguntaQuais s√£o esp√©cies de besouros mais semelhantes? (Neste caso, sem predi√ß√£o, pois representa uma avalia√ß√£o explorat√≥ria com caracter√≠sticas funcionais das esp√©cies).Vari√°veisDependentes: atributos funcionais (matriz de atributos categ√≥ricos por esp√©cie: trait_dat)An√°lisesAqui realizamos os passos para uma ordena√ß√£o usando os atributos funcionais categ√≥ricos (Figura 14.2).\nFigura 14.2: Ordena√ß√£o usando os atributos funcionais categ√≥ricos.\nExemplo 3: vari√°veis mistasEm casos mais complexos, pesquisa inclui diversos atributos funcionais com naturezas diferentes, como atributos cont√≠nuos, categ√≥ricos, ordinais, circulares, entre outros. Desse modo, √© poss√≠vel utilizar medidas como Gower (gowdis()). Por√©m, existe uma alternativa mais apropriada que generalizou o coeficiente de Gower para tratar cada conjunto de vari√°veis de acordo com sua natureza (Pavoine et al. 2009). Vamos usar o mesmo conjunto de dados que foram considerados exemplo anterior. Por√©m, ao inv√©s de utilizar somente vari√°veis categ√≥ricas, usaremos todas elas. O primeiro passo √© identificar para o programa classes apropriadas para cada tipo de vari√°vel e, al√©m disso, preparar os dados para fun√ß√£o dist.ktab().PerguntaQuais s√£o esp√©cies de besouros mais semelhantes? (Neste caso, sem predi√ß√£o, pois representa uma avalia√ß√£o explorat√≥ria com caracter√≠sticas funcionais das esp√©cies)Vari√°veisDependentes: atributos funcionais (matriz de atributos cont√≠nuos e categ√≥ricos por esp√©cie: trait_dat)An√°lisesAqui realizamos os passos para uma ordena√ß√£o usando os atributos funcionais de diversas naturezas (Figura 14.3).\nFigura 14.3: Ordena√ß√£o usando os atributos funcionais de dados mistos.\nPodemos combinar os dois gr√°ficos (baseado em vari√°veis categ√≥ricas e em vari√°veis mistas) para comparar duas medidas de dist√¢ncia, uma somente com dados categ√≥ricos (gower()) e uma com dados categ√≥ricos e ordinais (dist.ktab()) (Figura 14.4).\nFigura 14.4: Ordena√ß√µes usando os atributos funcionais categ√≥ricos e de dados mistos.\n","code":"\n## PCoA dos atributos cont√≠nuos\n\n# 1. Padroniza√ß√£o dos dados\ntrait_pad <- decostand(trait_fren_dat, \"standardize\")\neuclid_dis <- vegdist(trait_pad, \"euclidean\")\n\n# 2. PCoA\n# Resultados s√£o id√™nticos aos resultados de uma PCA.\npcoa_traits_cont <- pcoa(euclid_dis, correction = \"cailliez\") \n\n# 3. Exportandos dados para gr√°fico\n# Ao usar '[,1:2]' voc√™ ir√° selecionar os dois primeiros eixos.\neixos_cont <- as.data.frame(pcoa_traits_cont$vectors[, 1:2]) \n\n# 4. Gr√°fico de ordena√ß√£o \nplot_trait_cont <- ggplot(eixos_cont, aes(x = Axis.1, y = Axis.2)) + \n    geom_point(pch = 21, size = 4, color = \"black\", alpha = 0.7, fill = \"red2\") + \n    geom_text_repel(aes(Axis.1, Axis.2, label = rownames(eixos_cont))) +\n    geom_hline(yintercept = 0, linetype = 2) + \n    geom_vline(xintercept = 0, linetype = 2) +\n    labs(x = \"PCO 1\", y = \"PCO 2\", title = \"Dados cont√≠nuos\") + \n    tema_livro()\nplot_trait_cont\n## PCoA dos atributos categ√≥ricos\n\n# 1. Selecionar somente os atributos categ√≥ricos\ntrait_cat <- trait_dat %>% \n    dplyr::select_if(is.character)\n\n# 2. Calcular a dist√¢ncia de Gower\ndist_categ <- gowdis(trait_cat)\n\n# 3. PCoA da matriz de dist√¢ncia funcional (Gower)\npcoa_traits_cat <- pcoa(dist_categ, correction = \"cailliez\")\n\n# 4. Exportar dados (escores) para ggplot\neixos_cat <- as.data.frame(pcoa_traits_cat$vectors[,1:2]) # Selecionar os dois primeiros eixos\n\n# 5. Gr√°fico de ordena√ß√£o\nplot_trait_cat <- ggplot(eixos_cat, aes(x = Axis.1, y = Axis.2)) + \n    geom_point(pch = 21, size = 4, alpha = 0.7, color = \"black\", fill = \"cyan4\") + \n    geom_text_repel(aes(Axis.1, Axis.2, label = rownames(eixos_cat))) +\n    geom_hline(yintercept = 0, linetype = 2) + \n    geom_vline(xintercept = 0, linetype = 2) +\n    labs(x = \"PCO 1\", y = \"PCO 2\", title = \"Dados categ√≥ricos\") + \n    tema_livro()\nplot_trait_cat\n## PCoA dos atributos mistos\n\n## 1. Verifique a classe de todos os traits e veja se est√£o de acordo com sua expectativa\ntrait_dat %>% \n    dplyr::summarise_all(class) %>% \n    tidyr::gather(variable, class)\n#>    variable     class\n#> 1     trend character\n#> 2   redlist character\n#> 3     regio   integer\n#> 4      biog character\n#> 5     activ character\n#> 6      diet character\n#> 7    winter character\n#> 8     color character\n#> 9     breed character\n#> 10     body   integer\n#> 11     wing character\n#> 12   period character\n\n## 2. Neste exemplo, algumas vari√°veis que s√£o ordinais (regio e body) \n# foram reconhecidas como num√©ricas ou categ√≥ricas. \ntrait_dat$regio <- as.ordered(trait_dat$regio)\ntrait_dat$body <- as.ordered(trait_dat$body)\n\n## 3. Combinar cada conjunto de atributos de acordo com sua natureza em um \n# data.frame separado.\n# 3.1. Categ√≥ricos.\ntrait_categ <- cbind.data.frame(\n    trend = trait_dat$trend, \n    redlist = trait_dat$redlist, \n    biog = trait_dat$biog, \n    activ = trait_dat$activ,  \n    diet = trait_dat$diet, \n    winter = trait_dat$winter,\n    color = trait_dat$color, \n    breed = trait_dat$breed,\n    wing = trait_dat$wing, \n    period = trait_dat$period)\n\n# 3.2 Ordinais.\ntrait_ord <- cbind.data.frame(regio = trait_dat$regio, \n                              body = trait_dat$body)\nrownames(trait_categ) <- rownames(trait_dat)\nrownames(trait_ord) <- rownames(trait_dat)\n\n# Agora, combinar os dois data.frames em uma lista chamada \"ktab\".\nktab_list <- ktab.list.df(list(trait_categ, trait_ord))\n\n# Por fim, calcular a dist√¢ncia funcional entre as esp√©cies.\n# Em \"type\", a letra \"N\" indica vari√°vel categ√≥rica (ou nominal), \n# enquanto a letra \"O\" indica vari√°vel ordinal.\ndist_mist <- dist.ktab(ktab_list, type = c(\"N\", \"O\"))\n\n## Visualize os dados com uma PCoA\npcoa_traits_mist <- pcoa(dist_mist, correction = \"cailliez\")\neixos_mist <- as.data.frame(pcoa_traits_mist$vectors[,1:2]) \n\nplot_trait_mist <- ggplot(eixos_mist, aes(x = Axis.1, y = Axis.2)) + \n    geom_point(pch = 21, size = 4, alpha = 0.7, \n               color = \"black\", fill = \"darkorange\") + \n    geom_text_repel(aes(Axis.1, Axis.2, label = rownames(eixos_mist)))+\n    geom_hline(yintercept = 0, linetype = 2) + \n    geom_vline(xintercept = 0, linetype = 2) + \n    labs(x = \"PCO 1\", y = \"PCO 2\", title = \"Dados mistos\") + \n    tema_livro()\nplot_trait_mist\n## Gr√°ficos\ngrid.arrange(plot_trait_cat, plot_trait_mist, ncol = 2)"},{"path":"cap14.html","id":"m√©tricas-de-diversidade-funcional-alfa","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.3 M√©tricas de diversidade funcional (alfa)","text":"","code":""},{"path":"cap14.html","id":"riqueza-funcional","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.3.1 Riqueza funcional","text":"riqueza funcional mede quantidade de espa√ßo funcional preenchido pela esp√©cies de uma comunidade (Mason Mouillot 2013). estimativa desse espa√ßo pode ser calculada usando dengrogramas (Petchey Gaston 2002) ou atrav√©s m√©todo Convex Hull (Cornwell, Schwilk, Ackerly 2006) que d√£o origem, respectivamente, √†s duas m√©tricas mais usadas: ) Diversidade Funcional (FD) e ii) Riqueza Funcional (FRic). Os √≠ndices de riqueza funcional geralmente s√£o usados como indicadores espa√ßo de nicho que √© potencialmente usado ou n√£o (Schleuter et al. 2010).Exemplo pr√°ticoExplica√ß√£o dos dadosOs dados utilizados neste exemplo s√£o os mesmos exemplo com dados mistos, .e., categ√≥ricos e cont√≠nuos (objeto dist_mist).PerguntaQual rela√ß√£o entre riqueza de esp√©cies e diversidade funcional? Todos os √≠ndices s√£o correlacionados com riqueza?Vari√°veisDependentes: atributos funcionais e composi√ß√£o de esp√©cies para c√°lculo da diversidade funcional e riqueza em cada parcelaAn√°lisesOs valores da Riqueza Funcional (FRic) variam entre 0 e +‚àû, sendo o valor m√°ximo limitado pelo n√∫mero de esp√©cies em uma comunidade. Desse modo, os valores de FRic basicamente s√£o uma representa√ß√£o da riqueza de esp√©cies (e seus atributos funcionais) de uma comunidade (Vill√©ger, Mason, Mouillot 2008). Ou seja, quanto maior o n√∫mero de esp√©cies, maior ser√° o espa√ßo funcional ocupado por essas esp√©cies. pacote ‚ÄòdbFD‚Äô o valor de FRic √© dividido pelo valor de FRic global (ou seja, pela riqueza funcional de todas comunidades combinadas). Como resultado, ele limita varia√ß√£o entre 0 e 1, onde valores pr√≥ximos 1 indicam que uma determinada comunidade tem riqueza funcional t√£o alta quanto riqueza funcional de todas comunidades juntas. Neste exemplo, localidades 21 e 89 possuem, respectivamente, maior e menor Riqueza Funcional.","code":"\n## Estrutura dos dados\n# matriz de dist√¢ncia: dist√¢ncia entre as seis primeiras esp√©cies\nas.matrix(dist_mist)[1:6, 1:6]\n#>           sp1       sp2       sp3       sp4       sp5       sp6\n#> sp1 0.0000000 0.5000000 0.7107801 0.7771900 0.6107116 0.5041691\n#> sp2 0.5000000 0.0000000 0.6808389 0.8538292 0.7345988 0.6487320\n#> sp3 0.7107801 0.6808389 0.0000000 0.7179711 0.7381353 0.6527339\n#> sp4 0.7771900 0.8538292 0.7179711 0.0000000 0.5106682 0.6522593\n#> sp5 0.6107116 0.7345988 0.7381353 0.5106682 0.0000000 0.5177440\n#> sp6 0.5041691 0.6487320 0.6527339 0.6522593 0.5177440 0.0000000\n\n# composi√ß√£o de esp√©cies: seis primeiras esp√©cies nas seis primeiras localidades\nhead(comun_dat)[1:6, 1:6]\n#>    sp1 sp2 sp3 sp4 sp5 sp6\n#> 3    0  19   2   0   0   0\n#> 4    0   4   0   0   0   0\n#> 6    1  58   2   0   0   0\n#> 7    1   0   0   0   0   0\n#> 9    3   0   0   0   0   0\n#> 10   3  15   0   0   0   0\n\n## Antes de calcular as m√©tricas de diversidade funcional, vamos calcular \n# a riqueza de esp√©cies com intuito de compara√ß√£o entre m√©tricas.\nrichness <- dbFD(dist_mist, comun_dat)$nbsp \n#> FRic: Dimensionality reduction was required. The last 17 PCoA axes (out of 19 in total) were removed. \n#> FRic: Quality of the reduced-space representation = 0.3243851 \n#> CWM: When 'x' is a distance matrix, CWM cannot be calculated.\nhead(richness)\n#>  3  4  6  7  9 10 \n#> 12  3  7  7  4  7\n\n## √â preciso definir uma dist√¢ncia apropriada (veja descri√ß√£o anterior) para os c√°lculos abaixo\n\n# O √≠ndice \"Functional Richness\" s√≥ funciona para comunidades com 3 ou mais esp√©cies.\n# Caso voc√™ tenha comunidades com 1 ou 2 esp√©cies, o valor ser√° NA.\nfric <- dbFD(dist_mist, comun_dat)$FRic\n#> FRic: Dimensionality reduction was required. The last 17 PCoA axes (out of 19 in total) were removed. \n#> FRic: Quality of the reduced-space representation = 0.3243851 \n#> CWM: When 'x' is a distance matrix, CWM cannot be calculated.\nhead(fric)\n#>           3           4           6           7           9          10 \n#> 0.226236923 0.009033539 0.158760885 0.158529234 0.014290140 0.200075112\n\n## Functional Diversity \n# Passo 1: an√°lise de agrupamento para criar o dendrograma. \ndend <- hclust(dist_mist, \"average\")\n\n# Passo 2: transformar o dengrograma em um arquivo da classe phylo.\ntree_dend <- as.phylo(dend)\n\n# Passo 3: calcular o valor da diversidade funcional. \nFD <- pd(comun_dat, tree_dend)$PD\nhead(FD)\n#> [1] 3.590053 1.115574 2.255337 2.356478 1.472314 2.430329"},{"path":"cap14.html","id":"diverg√™ncia-funcional","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.3.2 Diverg√™ncia funcional","text":"diverg√™ncia funcional √© uma medida que descreve irregularidade na distribui√ß√£o dos valores dos atributos volume espa√ßo funcional ocupado por todas esp√©cies de uma certa comunidade (Garnier, Navas, Grigulis 2015). Para obter os valores de diverg√™ncia, o espa√ßo funcional √© calculado atrav√©s m√©todo Convex Hull (Functional Divergence) ou espa√ßo multidimensional calculado com um PCoA (Functional Dispersion). Nos dois casos, o valor da m√©trica representa dist√¢ncia m√©dia das esp√©cies para o centro de gravidade ou centroide espa√ßo funcional, ponderado pela abund√¢ncia relativa das esp√©cies (Vill√©ger, Mason, Mouillot 2008; Lalibert√© Legendre 2010). Desse modo, diverg√™ncia funcional √© uma medida que calcula o grau de diferencia√ß√£o em que distribui√ß√£o da abund√¢ncia maximiza diverg√™ncia entre entre os atributos funcionais (Mason Mouillot 2013). Em geral, estudos que usam esses √≠ndices buscam entender o grau de diferencia√ß√£o de recursos de esp√©cies que coexistem em uma comunidade (Garnier, Navas, Grigulis 2015).Os valores da Diverg√™ncia Funcional (FDiv) variam entre 0 e 1. Valores que se aproximam de zero indicam que esp√©cie mais abundante est√° muito pr√≥xima valor atributo m√©dio da comunidade, ao passo que valores pr√≥ximos 1 indicam que esp√©cie mais abundante est√° muito distante (ou seja, √© muito diferente) valor m√©dio da comunidade (Vill√©ger, Mason, Mouillot 2008). Neste exemplo, localidades 159 e 6 possuem, respectivamente, maior e menor Diverg√™ncia Funcional.","code":"\n\n## Aqui, iremos utilizar a matriz de dist√¢ncia obtida dos dados \n# trait_dat (vari√°veis categ√≥ricas e ordinais) e nomeada como dist_mist.\n\n## O √≠ndice \"Functional Divergence\" s√≥ √© calculado para comunidades com 3 ou mais esp√©cies\n# Caso voc√™ tenha comunidades com 1 ou 2 esp√©cies, a an√°lise ir√° retornar o valor \"NA\"\nfdiv <- dbFD(dist_mist, comun_dat)$FDiv\n#> FRic: Dimensionality reduction was required. The last 17 PCoA axes (out of 19 in total) were removed. \n#> FRic: Quality of the reduced-space representation = 0.3243851 \n#> CWM: When 'x' is a distance matrix, CWM cannot be calculated.\nhead(fdiv)\n#>         3         4         6         7         9        10 \n#> 0.9692023 0.8838557 0.4082808 0.9147644 0.9010790 0.6982640\n\n# O √≠ndice \"Functional Dispersion\" atribui valor 0 para comunidades com 1 ou 2 esp√©cies\nfdis <- dbFD(dist_mist, comun_dat)$FDis\n#> FRic: Dimensionality reduction was required. The last 17 PCoA axes (out of 19 in total) were removed. \n#> FRic: Quality of the reduced-space representation = 0.3243851 \n#> CWM: When 'x' is a distance matrix, CWM cannot be calculated.\nhead(fdis)\n#>         3         4         6         7         9        10 \n#> 0.2977975 0.3203602 0.2218237 0.3261248 0.3683898 0.3910530"},{"path":"cap14.html","id":"regularidade-funcional","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.3.3 Regularidade funcional","text":"regularidade funcional (ingl√™s Functional Evenness) mede o qu√£o regular √© distribui√ß√£o da abund√¢ncia dos valores dos atributos funcionais espa√ßo funcional. Diferente dos outros m√©todos, vers√£o multidimensional deste √≠ndice utiliza um m√©todo chamado Minimum Spanning Tree (MST) para conectar todas esp√©cies espa√ßo funcional. dist√¢ncia par apar das esp√©cies na MST √© ponderada pela abund√¢ncia relativa das esp√©cies e, desse modo, o valor final da regularidade funcional (FEve) vai variar de 0 (m√°xima irregularidade da distribui√ß√£o da abund√¢ncia ou dist√¢ncia funcional das esp√©cies) 1 (m√°xima regularidade).Os valores da Regularidade Funcional (FEve) variam entre 0 e 1 (m√°xima regularidade ou regularidade perfeita). diminui√ß√£o valor de FEve em dire√ß√£o zero indica que uma redu√ß√£o da regularidade da distribui√ß√£o da abund√¢ncia ou dist√¢ncia funcional entre esp√©cies (Vill√©ger, Mason, Mouillot 2008). Neste exemplo, localidades 197 e 175 possuem, respectivamente, maior e menor Regularidade Funcional.","code":"\n\n## Aqui, iremos utilizar a matriz de dist√¢ncia obtida dos dados trait_dat (vari√°veis categ√≥ricas e ordinais) e nomeada como dist_mist\n\n## O √≠ndice \"Functional evenness\" s√≥ funciona para comunidades com 3 ou mais esp√©cies\n# Caso voc√™ tenha comunidades com 1 ou 2 esp√©cies, a an√°lise ir√° retornar o valor NA\nfeve <- dbFD(dist_mist, comun_dat)$FEve\n#> FRic: Dimensionality reduction was required. The last 17 PCoA axes (out of 19 in total) were removed. \n#> FRic: Quality of the reduced-space representation = 0.3243851 \n#> CWM: When 'x' is a distance matrix, CWM cannot be calculated.\nhead(feve)\n#>         3         4         6         7         9        10 \n#> 0.4054808 0.5587917 0.5406140 0.6974712 0.9575697 0.6297941"},{"path":"cap14.html","id":"correla√ß√£o-entre-as-m√©tricas-de-diversidade-funcional-alfa","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.3.4 Correla√ß√£o entre as m√©tricas de diversidade funcional (alfa)","text":"Aqui vamos fazer correla√ß√£o entre m√©tricas de diversidade funcional (alfa) (Figura 14.5).\nFigura 14.5: Correla√ß√£o entre m√©tricas de diversidade funcional (alfa).\nOs resultados indicam que Diversidade Funcional de Petchey & Gaston (2002) (r = 0.985) e riqueza funcional (r = 0.813) s√£o altamente correlacionadas com riqueza de esp√©cies. Por√©m, diverg√™ncia funcional, regularidade funcional e dispers√£o funcional n√£o est√£o correlacionadas com riqueza de esp√©cies.figura obtida com o c√≥digo ggpairs(metricas) representa uma matriz de correla√ß√£o comparando cada par de vari√°veis (neste caso, os √≠ndices de diversidade). lado esquerdo da figura (abaixo da diagonal) s√£o representados scatter plots (veja Cap√≠tulo 6), lado direito (acima da diagonal) pode-se encontrar os valores das correla√ß√µes (r) entre os pares comparados. caso das correla√ß√µes, quanto mais pr√≥ximo de +1 ou -1, mais forte √© rela√ß√£o entre essas vari√°veis par comparado. O gr√°fico de linhas na diagonal demonstra densidade de cada vari√°veis individualmente (veja Cap√≠tulo 7).","code":"\n## Gr√°ficos\n## Voc√™ pode criar uma tabela com os resultados de todas as m√©tricas\nmetricas <- data.frame(richness = richness,\n                       FD_gp = FD,\n                       fric = fric,\n                       fdiv = fdiv,\n                       fdis = fdis,\n                       feve = feve)\nhead(metricas)\n#>    richness    FD_gp        fric      fdiv      fdis      feve\n#> 3        12 3.590053 0.226236923 0.9692023 0.2977975 0.4054808\n#> 4         3 1.115574 0.009033539 0.8838557 0.3203602 0.5587917\n#> 6         7 2.255337 0.158760885 0.4082808 0.2218237 0.5406140\n#> 7         7 2.356478 0.158529234 0.9147644 0.3261248 0.6974712\n#> 9         4 1.472314 0.014290140 0.9010790 0.3683898 0.9575697\n#> 10        7 2.430329 0.200075112 0.6982640 0.3910530 0.6297941\n\n## Gr√°fico para comparar o comportamento das m√©tricas\nggpairs(metricas) + tema_livro()"},{"path":"cap14.html","id":"m√©tricas-de-diversidade-funcional-beta","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.4 M√©tricas de diversidade funcional (beta)","text":"Assim como na diversidade beta taxon√¥mica (Cap√≠tulo 12) e na diversidade beta filogen√©tica (Cap√≠tulo 13), diversidade beta funcional √© uma medida que compara composi√ß√£o (e varia√ß√£o na composi√ß√£o) de atributos funcionais das esp√©cies entre duas ou mais localidades. Por√©m, assim como na medida tradicional taxon√¥mica (como Jaccard ou S√∏rensen), diferen√ßas na diversidade beta podem ser geradas pela mudan√ßa na identidade das esp√©cies (ou atributo) ou na riqueza de esp√©cies (ou de atributos) entre duas localidades (Figura 14.6). Desse modo, √© poss√≠vel particionar diversidade beta funcional em aninhamento (ingl√™s nestedness) e substitui√ß√£o (ingl√™s turnover) (veja Cap√≠tulo 12). Al√©m disso, os c√°lculos da diversidade beta funcional podem ser realizados par par (functional.beta.pair()) ou para compara√ß√µes de m√∫ltiplas localidades (funcional.beta.multi()).\nFigura 14.6: Parti√ß√£o da diversidade beta taxon√¥mica () e funcional (B). Os tr√™s cen√°rios apresentados tanto para diversidade beta taxon√¥mica como funcional representam, respectivamente, diversidade beta explicada somente por substitui√ß√£o, aninhamento e uma combina√ß√£o dos dois.\nExemplo 4Os dados exemplo seguir utilizam somente informa√ß√£o de presen√ßa (1) ou aus√™ncia (0) das esp√©cies nas localidades. Neste exemplo hipot√©tico criado por Baselga et al. (2021), foram amostradas 11 esp√©cies (sp1-sp11) em quatro localidades (-D). Para cada esp√©cie, criamos dois atributos cont√≠nuos hipot√©ticos (trait1 e trait2).PerguntaQual contribui√ß√£o relativa aninhamento e substitui√ß√£o para diversidade beta?Vari√°veisDependentes: atributos funcionais e composi√ß√£o de esp√©cies.An√°lisesVamos fazer an√°lise da parti√ß√£o da diversidade beta funcional e comparar seus componentes (Figura 14.7).\nFigura 14.7: Rela√ß√£o entre os componentes parti√ß√£o da diversidade funcional (beta).\nOs resultados da an√°lise de parti√ß√£o (fun_beta_multi()) indicam que 82,5% (0,710/0,861) da varia√ß√£o na diversidade beta √© explicada pelo componente substitui√ß√£o, enquanto 17,5% (0,151/0,861) pelo componente aninhamento. matrizes de dist√¢ncia obtidas na an√°lise par par pode ser utilizadas para testar, posteriori, rela√ß√£o entre gradientes ambientais e diversidade beta funcional (mais detalhes abaixo).","code":"\nknitr::include_graphics(path = \"img/cap14_fig01.svg\")\n## Parti√ß√£o da Diversidade beta (M√©todo Baselga)\nfun_beta_multi <- functional.beta.multi(x = comm_baselga,\n                                        trait = trait_baselga, index = \"jaccard\") \nfun_beta_multi\n#> $funct.beta.JTU\n#> [1] 0.7101449\n#> \n#> $funct.beta.JNE\n#> [1] 0.1509662\n#> \n#> $funct.beta.JAC\n#> [1] 0.8611111\n\n## Parti√ß√£o da Diversidade beta (M√©todo Baselga)\nfun_beta <- functional.beta.pair(x = comm_baselga, \n                                 trait = trait_baselga, index = \"jaccard\") \n\n# Os c√≥digos abaixo permitem extrair a matriz de dist√¢ncia (par a par) com a parti√ß√£o em substitui√ß√£o e nestedness\nfun_turnover <- fun_beta$funct.beta.jne\nfun_nestedness <- fun_beta$funct.beta.jtu\nfun_jaccard <- fun_beta$funct.beta.jac\n\n## Gr√°fico de compara√ß√£o do substitui√ß√£o e aninhamento\ndat_betapart <- data.frame(turnover = as.numeric(fun_turnover), \n                           nested = as.numeric(fun_nestedness))\n\n## Gr√°fico\nplot_betapart <- ggplot(dat_betapart, aes(x = turnover, y = nested)) + \n    geom_point(pch = 21, size = 4, alpha = 0.7, color = \"black\", fill = \"#525252\") + \n    labs(x = \"Beta Diveristy (Substitui√ß√£o)\", y = \"Beta Diveristy (Aninhamento)\") +\n    tema_livro()\nplot_betapart"},{"path":"cap14.html","id":"composi√ß√£o-funcional-community-wegihed-means---cwm","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.5 Composi√ß√£o Funcional (Community Wegihed Means - CWM)","text":"medidas de diversidade beta funcional apresentadas acima fornecem matrizes de dist√¢ncia com compara√ß√µes par par de localidades em termos da composi√ß√£o de atributos funcionais. Por√©m, muitas vezes o pesquisador quer medir o ‚Äúatributo m√©dio‚Äù da comunidade para investigar, por exemplo, se um determinado gradiente ambiental afeta express√£o (em termos de abund√¢ncia ou densidade) de dado atributo funcional. Em geral, medida utilizada √© o CWM (ingl√™s Community Wegihed Means). O CWM √© basicamente uma m√©dia ponderada de um determinado atributo (coluna m na matriz T) em rela√ß√£o abund√¢ncia de todas esp√©cies que ocorrem na localidade (linha n na matrix X). O c√°lculo R √© feito pela fun√ß√£o functcomp() e usa somente duas matrizes (T e X). Os leitores que pretendem usar essas m√©tricas devem ler cr√≠ticas em Peres-Neto et al. (2017).matriz resultante cwm_es √© formada pelas localidades (linhas) e os atributos ‚Äúm√©dios‚Äù (colunas) nestas localidades. Essa matriz pode ser utilizada em diversas an√°lises como dbRDA, RDA ou RDA parcial (veja Cap√≠tulo 9). Na sequ√™ncia, vamos utilizar testes de hip√≥teses para entender como podemos calcular diversidades funcional alfa e beta com outros testes estat√≠sticos apresentados neste livro.Exemplo 5Neste exemplo, usaremos novamente os dados de 34 esp√©cies de plantas (Frenette-Dussault et al. 2012), mas agora vamos testar o efeito de um gradiente de aridez sobre diversidade alfa funcional.PerguntaO gradiente de aridez influencia diverg√™ncia e regularidade funcional de plantas?Predi√ß√µesPredi√ß√£o 1: locais mais √°ridos possuem menor diverg√™ncia funcional de plantas (m√©trica escolhida: FDis)Predi√ß√£o 1: locais mais √°ridos possuem menor diverg√™ncia funcional de plantas (m√©trica escolhida: FDis)Predi√ß√£o 2: locais mais √∫midos possuem menor regularidade funcional de plantas (m√©trica escolhida: FEve)Predi√ß√£o 2: locais mais √∫midos possuem menor regularidade funcional de plantas (m√©trica escolhida: FEve)Vari√°veisPreditora: gradiente de aridez (matriz de vari√°veis ambientais por localidade: ambie_fren_dat)Preditora: gradiente de aridez (matriz de vari√°veis ambientais por localidade: ambie_fren_dat)Dependentes: composi√ß√£o de esp√©cies (matriz de esp√©cies por localidade: comun_fren_dat) e atributos funcionais (matriz de atributos cont√≠nuos por esp√©cie: trait_fren_dat)Dependentes: composi√ß√£o de esp√©cies (matriz de esp√©cies por localidade: comun_fren_dat) e atributos funcionais (matriz de atributos cont√≠nuos por esp√©cie: trait_fren_dat)An√°lisesVamos calcular primeiramente matrizes de Diverg√™ncia funcional (FDis) e Regularidade Funcional (FEve), depois ajustar modelos lineares, fazer o diagn√≥stico dos mesmo e por fim plotar os resultados (Figura 14.8).\nFigura 14.8: Rela√ß√£o entre composi√ß√£o funcional e o gradiente de aridez, ajustado por modelos lineares com seus diagn√≥sticos.\nOs resultados dos modelos anova(mod1) e anova(mod2) indicam que o gradiente de aridez n√£o afeta dispers√£o e regularidade funcional. Os detalhes para conferir os pressupostos das an√°lise foram descritos Cap√≠tulo 7.Exemplo 6Agora, vamos utilizar novamente os dados de 34 esp√©cies de plantas (Frenette-Dussault et al. 2012), mas agora para testar o efeito pastejo sobre diversidade beta funcional.PerguntaO pastejo determina ocorr√™ncia de esp√©cies de plantas com diferentes atributos funcionais?Predi√ß√£oA composi√ß√£o funcional de plantas √© diferente entre √°reas com e sem pastejo?Vari√°veisPreditora: √°reas com e sem pastejo de gado (vari√°vel categ√≥rica com dois n√≠veis: grazed e ungrazed: ambie_fren_dat)Preditora: √°reas com e sem pastejo de gado (vari√°vel categ√≥rica com dois n√≠veis: grazed e ungrazed: ambie_fren_dat)Dependentes: composi√ß√£o de esp√©cies (matriz de esp√©cies por localidade: comun_fren_dat) e atributos funcionais (matriz de atributos cont√≠nuos por esp√©cie: trait_fren_dat)Dependentes: composi√ß√£o de esp√©cies (matriz de esp√©cies por localidade: comun_fren_dat) e atributos funcionais (matriz de atributos cont√≠nuos por esp√©cie: trait_fren_dat)An√°lisesNesse exemplo vamos calcular CWM e depois usar uma PERMANOVA (Cap√≠tulo 9) para comparar o efeito da √°reas com e sem pastejo sobre diversidade funcional (Figura 14.9).\nFigura 14.9: Rela√ß√£o pastejo sobre composi√ß√£o funcional.\nNeste exemplo, os resultados perman_fren demonstram que composi√ß√£o funcional de plantas n√£o √© afetada pelo pastejo (P > 0,05) e que dispers√£o da composi√ß√£o (uma medida potencial de diversidade beta: M. J. Anderson, Ellingsen, McArdle 2006) de esp√©cies tamb√©m n√£o muda entre √°reas com ou sem pastejo (permutest(betad_fren)). fun√ß√£o betadisper() deve ser sempre utilizada em conjunto com PERMANOVA (adonis()) para poder interpretar quais fontes de varia√ß√£o na composi√ß√£o de esp√©cies. Sendo assim, esta an√°lise representa um m√©todo fundamental para comparar se o potencial efeito (quando houver) √© fruto de diferen√ßa na composi√ß√£o de esp√©cies (.e., diferen√ßa na posi√ß√£o dos centr√≥ides entre dois ou mais grupos) ou na varia√ß√£o da composi√ß√£o de esp√©cies entre os grupos (.e., diferen√ßa na dispers√£o dos dados em rela√ß√£o aos centr√≥ides, ver mais Cap√≠tulo 9). Esta √∫ltima informa√ß√£o, dispers√£o, √© geralmente interpretada como uma analogia homogeneidade de vari√¢ncias de uma ANOVA (.e., Teste de Levene). hip√≥tese nula betadisper() √© que dispers√£o dos grupos √© homog√™nea (ou seja, o valor de probabilidade nos casos que existem dispers√µes homog√™neas ser√° maior que 0,05). Por√©m, se esse valor de p menor que 0,05, voc√™ deve rejeitar hip√≥tese nula e concluir que dispers√µes s√£o heterog√™neas.Os gr√°ficos de PCoA s√£o uma ferramenta poderosa para interpretar os resultados da PERMANOVA + Betadisper. Quanto mais diferente composi√ß√£o de esp√©cies entre dois ou mais grupos, mais distante devem ser os centroides desses grupos. Al√©m disso, se √°reas dos pol√≠gonos que conectam todas r√©plicas de cada grupo forem diferentes em tamanho (hip√≥tese que ser√° testada com o Betadisper), √© poss√≠vel tamb√©m visualizar esta diferen√ßa. Em conclus√£o, para testar se diferen√ßas de composi√ß√£o funcional existem entre dois ou mais grupos, ser√° fundamental: ) comparar varia√ß√£o da posi√ß√£o dos centr√≥ides (fun√ß√£o adonis()) e ii) varia√ß√£o da dispers√£o da composi√ß√£o funcional entre os grupos (fun√ß√£o betadisper()).","code":"\n## Matriz T\nhead(trait_baselga)\n#>     Trait.1 Trait.2\n#> sp1       1       1\n#> sp2       1       2\n#> sp3       1       4\n#> sp4       2       1\n#> sp5       2       2\n#> sp6       3       3\n\n## Matriz X\nhead(comm_baselga)\n#>   sp1 sp2 sp3 sp4 sp5 sp6 sp7 sp8 sp9 sp10 sp11\n#> A   1   1   0   1   1   0   0   0   0    0    0\n#> B   1   0   1   0   0   0   0   1   1    0    0\n#> C   0   0   0   0   0   1   1   0   0    1    1\n#> D   0   1   0   1   0   0   1   0   1    0    0\n\n## Fun√ß√£o functcomp calcula o cwm para combinar as matrizes T e X\ncwm_ex <- functcomp(trait_baselga, as.matrix(comm_baselga))\ncwm_ex\n#>   Trait.1 Trait.2\n#> A     1.5     1.5\n#> B     2.5     2.5\n#> C     4.0     4.0\n#> D     2.5     3.0\n## Passo 1: calcular a dist√¢ncia funcional\ntrait_pad <- decostand(trait_fren_dat, \"standardize\")\neuclid_dis <- vegdist(trait_pad, \"euclidean\")\n\n## Passo 2: calcular a Diverg√™ncia funcional (FDis) e Regularidade Funcional (FEve)\nfdis <- dbFD(euclid_dis, comun_fren_dat)$FDis # Fdis=0 em locais com somente uma esp√©cie\n#> FRic: No dimensionality reduction was required. All 5 PCoA axes were kept as 'traits'. \n#> CWM: When 'x' is a distance matrix, CWM cannot be calculated.\nfeve <- dbFD(euclid_dis, comun_fren_dat)$FEve\n#> FRic: No dimensionality reduction was required. All 5 PCoA axes were kept as 'traits'. \n#> CWM: When 'x' is a distance matrix, CWM cannot be calculated.\n\n## Passo 3: Utilizar um modelo linear para comparar o efeito da aridez sobre FDis (predi√ß√£o 1) e FEve (predi√ß√£o 2)\n# Combinar dados em um data.frame.\nlm_dat <- data.frame(aridez = ambie_fren_dat$Aridity, fdis = fdis, feve = feve)\n\n# Modelo 1\nmod1 <- lm(fdis ~ aridez, data = lm_dat)\n\n# Conclus√£o: a aridez n√£o tem efeito sobre a diverg√™ncia funcional\nanova(mod1) \n#> Analysis of Variance Table\n#> \n#> Response: fdis\n#>           Df Sum Sq Mean Sq F value Pr(>F)\n#> aridez     1 0.2083 0.20834  0.9945 0.3241\n#> Residuals 44 9.2179 0.20950\n\n# Modelo 2\nmod2 <- lm(feve ~ aridez, data = lm_dat)\n\n# Conclus√£o: a aridez n√£o tem efeito sobre a regularidade funcional\nanova(mod2) \n#> Analysis of Variance Table\n#> \n#> Response: feve\n#>           Df  Sum Sq  Mean Sq F value Pr(>F)\n#> aridez     1 0.02098 0.020979  1.0447 0.3123\n#> Residuals 44 0.88353 0.020080\n\n## Passo 4: gr√°fico para visualizar os dois resultados  \n# Gr√°fico modelo 1.\nplot_pred1 <- ggplot(lm_dat, aes(x = aridez, y = fdis)) + \n    geom_point(pch = 21, size = 4, alpha = 0.7, color = \"black\", fill=\"darkorange\") +\n    labs(x = \"Aridez\", y = \"Diverg√™ncia Funcional (FDis)\") +\n    tema_livro()\n\n# Gr√°fico modelo 2.\nplot_pred2 <- ggplot(lm_dat, aes(x = aridez, y = feve)) + \n    geom_point(pch=21, size=4, alpha = 0.7, color = \"black\", fill=\"cyan4\") + \n    labs(x = \"Aridez\", y = \"Regularidade Funcional (FEve)\") + \n    tema_livro()\n\n## Visualiza√ß√£o dos dois gr√°ficos em um √∫nica janela\ngrid.arrange(plot_pred1, plot_pred2, ncol = 2)\n## Passo 1: CWM\ncwm_fren <- functcomp(trait_pad, as.matrix(comun_fren_dat))\nhead(cwm_fren)\n#>           LA        SLA        LDMC       LN15        LCC\n#> 1 -0.2411700 -0.3485515  0.19745200  0.1874003 -0.5367368\n#> 2 -0.3977371  0.2326622 -0.09093270 -0.2859777  0.1643190\n#> 3 -0.1857134  0.2010756 -0.39877265 -0.1250643 -0.4304617\n#> 4 -0.2284064  0.1604101  0.80496307 -0.3704253  0.7193853\n#> 5 -0.1664790  0.3486956  0.02232213 -0.2041931  0.2051391\n#> 6 -0.3258821  0.3664583  0.04996829 -0.3352572  0.4713089\n\n## Passo 2: calcular a dist√¢ncia funcional\ncwm_dis <- vegdist(cwm_fren, \"euclidean\")\n\n## Passo 3: testar se a composi√ß√£o funcional varia entre as √°reas com uma PERMANOVA\nperman_fren <- adonis(cwm_fren ~ Grazing, data = ambie_fren_dat)\nperman_fren\n#> \n#> Call:\n#> adonis(formula = cwm_fren ~ Grazing, data = ambie_fren_dat) \n#> \n#> Permutation: free\n#> Number of permutations: 999\n#> \n#> Terms added sequentially (first to last)\n#> \n#>           Df SumsOfSqs MeanSqs  F.Model      R2 Pr(>F)\n#> Grazing    1    -174.5 -174.46 -0.61591 -0.0142  0.547\n#> Residuals 44   12463.0  283.25           1.0142       \n#> Total     45   12288.5                   1.0000\n\n## Passo 4: comparar a varia√ß√£o dentro de cada grupo com Betadisper \nbetad_fren <- betadisper(cwm_dis, ambie_fren_dat$Grazing)\npermutest(betad_fren)\n#> \n#> Permutation test for homogeneity of multivariate dispersions\n#> Permutation: free\n#> Number of permutations: 999\n#> \n#> Response: Distances\n#>           Df  Sum Sq  Mean Sq      F N.Perm Pr(>F)\n#> Groups     1  0.0539 0.053858 0.1946    999  0.669\n#> Residuals 44 12.1763 0.276735\n\n## Passo 5: PCoA\n\ncwm_pcoa <- pcoa(D = cwm_dis, correction = \"cailliez\")\npcoa_eixos <- cwm_pcoa$vectors[, 1:2]\npcoa_dat <- data.frame(pastagem = ambie_fren_dat$Grazing, pcoa_eixos)\n\n## Passo 6: definir os grupos (\"HULL\") para serem categorizados no gr√°fico \n\ngrp.Grazed <- pcoa_dat[pcoa_dat$pastagem == \"Grazed\", ][chull(pcoa_dat[pcoa_dat$pastagem == \"Grazed\", c(\"Axis.1\", \"Axis.2\")]), ]\ngrp.Ungrazed <- pcoa_dat[pcoa_dat$pastagem == \"Ungrazed\", ][chull(pcoa_dat[pcoa_dat$pastagem == \"Ungrazed\", c(\"Axis.1\", \"Axis.2\")]), ]\nhull_cwm <- rbind(grp.Grazed, grp.Ungrazed) \n\n## Passo 7: Gr√°fico biplot\n\n100 * (cwm_pcoa$values[, 1]/cwm_pcoa$trace)[1] # % de explica√ß√£o do eixo 1\n#> [1] 53.5471\n100 * (cwm_pcoa$values[, 1]/cwm_pcoa$trace)[2] # % de explica√ß√£o do eixo 2\n#> [1] 24.56026\n\nggplot(pcoa_dat, aes(x = Axis.1, y = Axis.2, color = pastagem, shape = pastagem)) + \n  geom_point(size = 4, alpha = 0.7) + \n  geom_polygon(data = hull_cwm, aes(fill = pastagem, group = pastagem), alpha = 0.3) + \n  scale_color_manual(values = c(\"darkorange\", \"cyan4\")) +\n  scale_fill_manual(values = c(\"darkorange\", \"cyan4\")) +\n  labs(x = \"PCO 1 (53.6%)\", y = \"PCO 2 (24.6%)\") + \n  tema_livro()"},{"path":"cap14.html","id":"varia√ß√£o-intraspec√≠fica","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.6 Varia√ß√£o Intraspec√≠fica","text":"Os m√©todos discutidos anteriormente utilizam valores m√©dios dos atributos das esp√©cies para descrever estrutura funcional da comunidade e interpretar rela√ß√µes entre determinadas vari√°veis preditoras (como clima, por exemplo) com diverisdade funcional. Por√©m, ao utilizar atributos m√©dios estamos desconsiderando que varia√ß√£o deste atributo dentro da esp√©cie seja determinante para resposta da esp√©cie ao ambiente ou seu efeito sobre o ecossistema (Bolnick et al. 2011 ; Violle et al. 2012). Os estudos que usam dados m√©dios para testar hip√≥teses em ecologia funcional argumentam que varia√ß√£o dentro da esp√©cie √© menor que varia√ß√£o entre esp√©cies e, desse modo, o ru√≠do causado ao desconsiderar vari√¢ncia atributo dentro da esp√©cies √© desprez√≠vel (Siefert et al. 2015). Por√©m, diversos estudos t√™m mostrado que esse argumento √© fr√°gil e que inclus√£o da varia√ß√£o intraespec√≠fica melhora nossa capacidade preditiva em ecologia funcional (Violle et al. 2012; Siefert et al. 2015). Um abordagem geralmente utilizada √© decomposi√ß√£o da vari√¢ncia atributo em diferentes n√≠veis de organiza√ß√£o: ) varia√ß√£o dentro da popula√ß√£o da mesma esp√©cie em uma mesma unidade amostral, ii) varia√ß√£o dentro das popula√ß√µes (independente da esp√©cie) de uma comunidade em uma mesma unidade amostral, e iii) varia√ß√£o entre popula√ß√µes. Conhecida como estat√≠stica T, esta abordagem permite entender fontes (intra ou interespec√≠fica) de varia√ß√£o atributos em diferentes escalas (Violle et al. 2012). Outro m√©todo que quantifica vari√¢ncia explicada pela variabilidade intraespec√≠fica, interespec√≠fica e covari√¢ncia entre elas foi proposto por Leps et al. (2011). Este m√©todo permite calcular contribui√ß√£o da varia√ß√£o intraespec√≠fica dentro e entre comunidades. Agora, vamos entender contribui√ß√£o da varia√ß√£o de um atributo dentro da esp√©cie comparada √† varia√ß√£o entre esp√©cies.Exemplo 7Vamos utilizar os dados de 11 esp√©cies de anuros associados com 26 po√ßas Parque Nacional Lagoa Peixe (Dalmolin, Tozetti, Pereira 2020). Atributos morfol√≥gicos foram coletados em todos os indiv√≠duos coletados em cada po√ßa. Desse modo, √© poss√≠vel comparar varia√ß√£o morfol√≥gica entre indiv√≠duos da mesma esp√©cie e entre esp√©cies diferentes. Al√©m disso, √© poss√≠vel quantificar contribui√ß√£o da varia√ß√£o dentro e entre diferentes po√ßas. exemplo abaixo, criamos cinco atributos com nomes diferentes daqueles usados artigo de Dalmolin et al. (2020). Em cada po√ßa, os autores coletaram os seguintes dados das po√ßas: ) profundidade, ii) area, iii) dist√¢ncia entre po√ßas, e iv) dist√¢ncia da po√ßa para floresta mais pr√≥xima.Pergunta 1Qual contribui√ß√£o da varia√ß√£o intraespec√≠fica para varia√ß√£o total dos atributos morfol√≥gicos de anuros?Predi√ß√£oA alta plasticidade fenot√≠pica de anuros indica alta contribui√ß√£o da varia√ß√£o intraespec√≠fica comparada interespec√≠ficaVari√°veisPreditora: esp√©cies (categ√≥rica)Dependente: varia√ß√£o dos atributos morfol√≥gicosAn√°lisesAqui vamos realizar o passo passo das an√°lises para comparar contribui√ß√£o da varia√ß√£o intraespec√≠fica para varia√ß√£o total dos atributos morfol√≥gicos.Pergunta 2Qual contribui√ß√£o da varia√ß√£o entre po√ßas para varia√ß√£o total dos atributos morfol√≥gicos de anuros?Predi√ß√£oA varia√ß√£o morfol√≥gica de anuros √© afetada por mudan√ßas dentro das esp√©cies e entre diferentes esp√©cies de po√ßas distintasVari√°veisPreditoras: po√ßas e esp√©cies (ambas categ√≥ricas)Dependente: varia√ß√£o dos atributos morfol√≥gicosAn√°lisesAqui vamos realizar o teste para comparar contribui√ß√£o da varia√ß√£o entre po√ßas para varia√ß√£o total dos atributos morfol√≥gicos (Figura 14.10).\nFigura 14.10: Gr√°fico de barras mostrando contribui√ß√£o da varia√ß√£o entre po√ßas para varia√ß√£o total dos atributos morfol√≥gicos.\nPergunta 3Caracter√≠sticas ambientais das po√ßas afetam varia√ß√£o intraespec√≠fica?Predi√ß√£oA profunidade e √°rea da po√ßa aumentam contribui√ß√£o da varia√ß√£o intraespec√≠fica em rela√ß√£o varia√ß√£o interespec√≠fica.Vari√°veisPreditora: caracter√≠sticas das po√ßasDependentes: varia√ß√£o dos atributos morfol√≥gicos e contribui√ß√£o da varia√ß√£o intraespec√≠ficaAn√°lisesPara calcular contribui√ß√£o relativa da varia√ß√£o intraespec√≠fica em rela√ß√£o √† varia√ß√£o interespec√≠fica dentro de uma comunidade, por exemplo, Siefert et al. (2015) sugeriram uma m√©trica chamada de wITV (within-community Intraspecific Trait Variation). wITV representa raz√£o da varia√ß√£o intraespec√≠fica em rela√ß√£o varia√ß√£o total dentro de uma comunidade (e.g., parcela, po√ßa) que inclui: ) abund√¢ncia relativa de cada esp√©cie j ocorrendo na comunidade , ii) o valor m√©dio atributo da esp√©cie j na comunidade , e iii) o valor atributo k de cada indiv√≠duo da esp√©cie j que ocorre na comunidade . Como esta medida √© feita por unidade amostral (ou seja, sua comunidade de interesse), √© poss√≠vel testar hip√≥teses ecol√≥gicas que tentem explicar processos que aumentem ou diminuam varia√ß√£o de um determinado atributo dentro ou entre esp√©cies diferentes. fun√ß√£o wITV foi adaptada para linguagem R por de Bello et al. (2021). Para facilitar o c√°lculo wITV para cada comunidade, de Bello et al. (2021) executaram os c√≥digos com fun√ß√£o () que repete iterativamente an√°lise para gerar os valores de todas comunidades em uma forma din√¢mica. Ap√≥s executar an√°lises com o (), fun√ß√£o salva os resultados dentro objeto wITVResults. Ap√≥s obter esses resultados, √© poss√≠vel utilizar modelos lineares para testar quais vari√°veis preditoras (em nosso exemplo, caracter√≠sticas das po√ßas) afetam o aumento ou diminui√ß√£o da contribui√ß√£o relativa da varia√ß√£o intraespec√≠fica (Figura 14.10).\nFigura 14.11: Gr√°ficos diagn√≥sticos modelo linear ajustado para iWTV em fun√ß√£o de caracter√≠sticas das po√ßas.\nCombinando os resultados das tr√™s an√°lises √© poss√≠vel compreender que existem diferen√ßas morfol√≥gicas entre esp√©cies de po√ßas diferentes (componente substitui√ß√£o). Por√©m, √© evidente que varia√ß√£o dentro da esp√©cie √© bastante relevante para compreender diversidade funcional de anuros. Na primeira an√°lise, os resultados dessas quatro an√°lises indicaram que varia√ß√£o intraspecifica explica de 17% 45% da varia√ß√£o morfol√≥gica nas metacomunidades de anuros. segunda, por sua vez, demonstra que varia√ß√£o morfol√≥gica entre esp√©cies de po√ßas diferentes representa o principal componente de varia√ß√£o, mas que varia√ß√£o intraespec√≠fica n√£o pode ser ignorada. Por fim, ao combinar m√©trica wITV com modelos lineares, percebe-se que caracter√≠sticas das po√ßas n√£o determinam contribui√ß√£o da varia√ß√£o intraespec√≠fica. Al√©m disso, existe uma varia√ß√£o muito grande entre po√ßas. Ao passo que em algumas po√ßas varia√ß√£o intraespec√≠fica n√£o contribui para varia√ß√£o total (wITV = 0), em outras, este componente representou 100% da varia√ß√£o (wITV = 1). Os resultados obtidos nas an√°lises das perguntas 1 3 indicam que utilizar somente m√©dia dos atributos morfol√≥gicos pode refletir em interpreta√ß√µes incorretas em estudos que compararam diversidade funcional espa√ßo/tempo (veja discuss√£o em Dalmolin, Tozetti, Pereira 2020).","code":"\n## Dados necess√°rios\n# Matriz de traits.\nhead(traits)\n#>   pond Species body_size biomass eye_size leg_size flatness\n#> 1  DN1     Sp2     2.405   2.291    3.104    0.450    0.794\n#> 2  DN1     Sp3     1.882   2.039    2.926    0.345    1.063\n#> 3  DN1     Sp4     0.699   0.342    0.782    0.104    3.055\n#> 4  DN1     Sp4     0.725   0.598    1.120    0.136    2.759\n#> 5  DN1     Sp4     0.448   0.385    0.844    0.107    3.557\n#> 6  DN1     Sp4     0.640   0.470    0.861    0.093    3.420\n\n## Parti√ß√£o da varia√ß√£o intra e interespec√≠fica\n## Passo 1: Tamanho corporal\nmod_body_size <- aov(body_size~Species, data = traits)\nsummary(mod_body_size)\n#>              Df Sum Sq Mean Sq F value Pr(>F)    \n#> Species      10  95.91   9.591    25.5 <2e-16 ***\n#> Residuals   195  73.35   0.376                   \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Contribui√ß√£o da varia√ß√£o intra-espec√≠fica para o tamanho corporal.\nitv_BS <- 100 * (73.35/(95.92 + 73.35))\nitv_BS\n#> [1] 43.33314\n\n## Passo 2: Biomassa\nmod_biomass <- aov(biomass~Species, data = traits)\nsummary(mod_biomass)\n#>              Df Sum Sq Mean Sq F value Pr(>F)    \n#> Species      10 118.17  11.817   23.95 <2e-16 ***\n#> Residuals   195  96.22   0.493                   \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Contribui√ß√£o da varia√ß√£o intra-espec√≠fica para a biomassa.\nitv_biomass <- 100 * (96.22/(118.17 + 96.22))\nitv_biomass\n#> [1] 44.88082\n\n## Passo 3: Tamanho do olho\nmod_eye_size <- aov(eye_size ~ Species, data = traits)\nsummary(mod_eye_size)\n#>              Df Sum Sq Mean Sq F value Pr(>F)    \n#> Species      10  203.1  20.309   50.51 <2e-16 ***\n#> Residuals   195   78.4   0.402                   \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Contribui√ß√£o da varia√ß√£o intra-espec√≠fica para o tamanho do olho.\nitv_eye_size <- 100 * (78.39/(203.09 + 78.39))\nitv_eye_size\n#> [1] 27.84923\n\n## Passo 4: Achatamento dorso-ventral\nmod_flatness <- aov(flatness~Species, data = traits)\nsummary(mod_flatness)\n#>              Df Sum Sq Mean Sq F value Pr(>F)    \n#> Species      10 104.47  10.447   92.07 <2e-16 ***\n#> Residuals   195  22.13   0.113                   \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Contribui√ß√£o da varia√ß√£o intra-espec√≠fica para o achatamento dorso-ventral.\nitv_flatness <- 100 * (22.13/(104.48 + 22.13))\nitv_flatness\n#> [1] 17.47887\n\n## Passo 5: Combinar os valores de cada trait em um vetor\nvalores <- c(itv_BS, itv_biomass, itv_eye_size, itv_flatness)\n\n# Passo 6: Combinar valores e traits em um data.frame.\nitv_results <- data.frame(trait = c(\"body_size\", \"biomass\", \"eye_size\", \"flatness\"),\n                          itv_explic = valores)\n\n## Tabela com resultados da explica√ß√£o atribuida para a varia√ß√£o intraespec√≠fica\nitv_results %>%\n    mutate(\"explained intraspecific variance\" = round(itv_explic, 2)) %>% \n    dplyr::select(trait, \"explained intraspecific variance\")\n#>       trait explained intraspecific variance\n#> 1 body_size                            43.33\n#> 2   biomass                            44.88\n#> 3  eye_size                            27.85\n#> 4  flatness                            17.48\n## Dados necess√°rios\n# Matriz de traits sem nomes de esp√©cies ou localidades\ntrait_m <- traits[, c(\"body_size\", \"biomass\", \"eye_size\", \"leg_size\", \"flatness\")]\nhead(trait_m)\n#>   body_size biomass eye_size leg_size flatness\n#> 1     2.405   2.291    3.104    0.450    0.794\n#> 2     1.882   2.039    2.926    0.345    1.063\n#> 3     0.699   0.342    0.782    0.104    3.055\n#> 4     0.725   0.598    1.120    0.136    2.759\n#> 5     0.448   0.385    0.844    0.107    3.557\n#> 6     0.640   0.470    0.861    0.093    3.420\ntrait_decomp <- decompCTRE(traits = trait_m, sp = traits$Species, \n                           ind.plot = traits$pond, print = FALSE)\nbarplot.decompCTRE(trait_decomp)\n## Dados necess√°rios\n# Matriz de traits.\nhead(traits)\n#>   pond Species body_size biomass eye_size leg_size flatness\n#> 1  DN1     Sp2     2.405   2.291    3.104    0.450    0.794\n#> 2  DN1     Sp3     1.882   2.039    2.926    0.345    1.063\n#> 3  DN1     Sp4     0.699   0.342    0.782    0.104    3.055\n#> 4  DN1     Sp4     0.725   0.598    1.120    0.136    2.759\n#> 5  DN1     Sp4     0.448   0.385    0.844    0.107    3.557\n#> 6  DN1     Sp4     0.640   0.470    0.861    0.093    3.420\n\n# Matriz de comunidades e padroniza√ß√£o para abund√¢ncia relativa\nhead(anuros_comm)\n#>      Sp10 Sp11 Sp2 Sp3 Sp4 Sp6 Sp7 Sp8 Sp1 Sp9 Sp5\n#> DN1     1    8   1   1   6   8   4   0   0   0   0\n#> DN2     0    0   0   0   1   1   4   2   0   0   0\n#> DN3     1    0   0   0   0   0   0   0   0   0   0\n#> DN4     0    0   2   2   1   0   0   0   6   0   0\n#> DN5     0    0   3   0   1   0   4   1   0   0   0\n#> FIG1    0    0   1   0   0   0   1   0   0   0   0\nanuros_comm_rel <- decostand(anuros_comm, \"total\")\n\n# Vari√°veis ambientais.\nhead(env)\n#>      depth  area dits_bt_pond dist_for\n#> DN1   0.50  3800          115     2650\n#> DN2   0.60 54600          250     2500\n#> DN3   0.80 29110          150     1800\n#> DN4   1.00  1386          410      195\n#> DN5   1.00   590          770      100\n#> FIG1  0.15    30           25      135\n\n## Preara√ß√£o da matriz para receber os resultados do `for`\nwITVResults <- data.frame(ITV = matrix(ncol = 1, nrow = length(unique(traits$pond))))\nrownames(wITVResults) <- unique(traits$pond)\n\nfor(i in 1:length(unique(traits$pond))){\n    commAux <- subset(traits, traits$pond == unique(traits$pond)[i])\n    commAux$Species <- droplevels(factor(commAux$Species))\n    spNames <- unique(commAux$Species)\n    relAbund <- anuros_comm_rel[i, as.character(spNames)] \n    traitsVector <- commAux$body_size\n    spVector <- commAux$Species\n    wITVResults[i, 1] <-  wITV(spIDs = spVector, traitVals = traitsVector, relAbund = relAbund)\n}\n\nwITVResults$ITV\n#>  [1] 0.82517670 0.23326457        NaN 0.15341806 0.10298952 0.00000000 0.02338235 0.68170997 0.79275763 0.66446945\n#> [11] 0.81726278 1.00000000 0.00000000 1.00000000 1.00000000 0.99220999 1.00000000 0.55519098 0.58945126 0.55148974\n#> [21] 0.80178255 1.00000000 1.00000000        NaN 0.19621528 0.14467854\nenv$wITV <- wITVResults$ITV # NaN = locais com uma √∫nica esp√©cie\n\n## Remover NAs para executar o modelo linear\nenv2 <- na.omit(env)\nhead(env2)  \n#>      depth  area dits_bt_pond dist_for       wITV\n#> DN1   0.50  3800          115     2650 0.82517670\n#> DN2   0.60 54600          250     2500 0.23326457\n#> DN4   1.00  1386          410      195 0.15341806\n#> DN5   1.00   590          770      100 0.10298952\n#> FIG1  0.15    30           25      135 0.00000000\n#> FIG2  0.15    30           25      135 0.02338235\n\n## Modelo linear \nmod_itv <- lm(wITV ~ depth + area + dits_bt_pond + dist_for, data = env)\n\n## Testar pressuposto da an√°lise\npar(mfrow = c(2, 2))\nplot(mod_itv)\n\n## Resultado\nsummary(mod_itv)\n#> \n#> Call:\n#> lm(formula = wITV ~ depth + area + dits_bt_pond + dist_for, data = env)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -0.6298 -0.3937  0.0448  0.3387  0.5266 \n#> \n#> Coefficients:\n#>                Estimate Std. Error t value Pr(>|t|)  \n#> (Intercept)   4.555e-01  2.113e-01   2.156   0.0449 *\n#> depth         2.767e-01  3.789e-01   0.730   0.4746  \n#> area         -3.116e-06  9.276e-06  -0.336   0.7409  \n#> dits_bt_pond -3.653e-04  6.193e-04  -0.590   0.5626  \n#> dist_for      5.698e-05  1.419e-04   0.401   0.6928  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.4103 on 18 degrees of freedom\n#>   (3 observations deleted due to missingness)\n#> Multiple R-squared:  0.03155,    Adjusted R-squared:  -0.1837 \n#> F-statistic: 0.1466 on 4 and 18 DF,  p-value: 0.9621"},{"path":"cap14.html","id":"para-se-aprofundar-10","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.7 Para se aprofundar","text":"","code":""},{"path":"cap14.html","id":"livros-8","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.7.1 Livros","text":"Recomendamos leitura de dois livros: Garnier et al. (2016) e de Bello et al. (2021). Os dois livros oferecem excelente oportunidade para se aprofundar campo te√≥rico da diversidade funcional e, al√©m disso, o livro liderado pelo pesquisador Francesco de Bello fornece diversas aplica√ß√µes anal√≠ticas na linguagem R. Outro recurso excelente foi publicado por Mammola et al. (2021) e serve para se aprofundar nas diferentes medidas da diversidade funcional.","code":""},{"path":"cap14.html","id":"links-9","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.7.2 Links","text":"Um passo importante nos estudos de Diversidade Funcional √© encontrar atributos funcionais dos organismos estudados. Abaixo indicamos uma lista de potenciais bases de dados:COMADRE - Animal Matrix DatabaseCOMPADRE - Plant Matrix DatabaseElton Traits 1.0TetraDENSITY - Density estimates terrestrial vertebratesTRY - Plant Trait DatabaseWorld Spider Trait","code":""},{"path":"cap14.html","id":"exerc√≠cios-10","chapter":"Cap√≠tulo 14 Diversidade Funcional","heading":"14.8 Exerc√≠cios","text":"14.1\nUtilize os dados aviurba pacote ade4 para testar o efeito de vari√°veis ambientais na dispers√£o (FDis) e regularidade funcional (FEve). Utilize modelos lineares (LM, veja Cap√≠tulo 7) para testar quais vari√°veis ambientais s√£o mais importantes para dispers√£o e regularidade funcional. Al√©m disso, fa√ßa um boxplot (veja Cap√≠tulo 6) comparando os valores de FDis e FEve entre categorias das vari√°veis ambientais mais relevantes.14.2\nUtilize os dados mafragh pacote ade4 para teste o efeito da das vari√°veis conductivity, silt e K2O na diversidade funcional (m√©todo de Petchey e Gaston). Utilize modelos lineares (regress√£o m√∫ltipla, veja Cap√≠tulo 7) para testar rela√ß√£o entre essas vari√°veis e discuta: () qual vari√°vel mais importante (se houver) e (b) se conclus√µes s√£o coerentes tendo como base os pressupostos dos modelos lineares. Al√©m disso, caso exista alguma rela√ß√£o significativa, fa√ßa um gr√°fico (scatterplot, veja Cap√≠tulo 6) da rela√ß√£o da vari√°vel mais importante e diversidade funcional.14.3\nUtilize os dados mafragh pacote ade4 para comparar composi√ß√£o filogen√©tica e funcional em √°reas com alta e baixa concentra√ß√£o de pot√°ssio. Para fazer esta compara√ß√£o ser√° necess√°rio transformar matriz de atributos funcionais e √°rvore filogen√©tica em matrizes de dist√¢ncia e, depois, utilizar o CWM para criar uma matriz de localidades por composi√ß√£o funcional ou filogen√©tica. Depois, voc√™ poder√° usar matriz CWM para testar potenciais diferen√ßas entre concentra√ß√µes com PERMANOVA e para visualizar com PCoA.Solu√ß√µes dos exerc√≠cios.","code":""},{"path":"cap15.html","id":"cap15","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"Cap√≠tulo 15 Dados geoespaciais","text":"","code":""},{"path":"cap15.html","id":"pr√©-requisitos-do-cap√≠tulo-11","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"Pr√©-requisitos do cap√≠tulo","text":"Pacotes e dados que ser√£o utilizados nesse cap√≠tulo.","code":"\n## Pacotes\nlibrary(ecodados)\nlibrary(here)\nlibrary(tidyverse)\nlibrary(sf) \nlibrary(raster) \nlibrary(rgdal) \nlibrary(spData)\nlibrary(rnaturalearth)\nlibrary(geobr)\nlibrary(ggplot2)\nlibrary(ggspatial)\nlibrary(tmap)\nlibrary(tmaptools)\nlibrary(grid)\nlibrary(mapview)\nlibrary(leaflet)\nlibrary(viridis)\nlibrary(knitr)\nlibrary(sidrar)\nlibrary(landscapetools)\n\n## Dados\n# world <- world\n# volcano <- volcano\n# geo_anfibios_locais <- ecodados::geo_anfibios_locais\n# geo_anfibios_especies <- ecodados::geo_anfibios_especies\n# geo_vetor_nascentes <- ecodados::geo_vetor_nascentes\n# geo_vetor_hidrografia <- ecodados::geo_vetor_hidrografia\n# geo_vetor_cobertura <- ecodados::geo_vetor_cobertura\n# geo_vetor_rio_claro <- ecodados::geo_vetor_rio_claro\n# geo_vetor_brasil <- ecodados::geo_vetor_brasil\n# geo_vetor_brasil_anos <- ecodados::geo_vetor_brasil_anos\n# geo_vetor_am_sul <- ecodados::geo_vetor_am_sul\n# geo_vetor_biomas <- ecodados::geo_vetor_biomas\n# geo_vetor_mata_atlantica <- ecodados::geo_vetor_mata_atlantica\n# geo_raster_srtm <- ecodados::geo_raster_srtm\n# geo_raster_bioclim <- ecodados::geo_raster_bioclim\n# geo_raster_globcover_mata_atlantica <- ecodados::geo_raster_globcover_mata_atlantica"},{"path":"cap15.html","id":"contextualiza√ß√£o-3","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.1 Contextualiza√ß√£o","text":"Nesta se√ß√£o, vamos fazer uma breve introdu√ß√£o aos principais conceitos sobre manipula√ß√£o e visualiza√ß√£o de dados geoespaciais R. Iremos abordar temas de forma te√≥rica e pr√°tica, utilizando linguagem R, focando em: ) formatos de dados vetoriais e dados raster, ii) Sistemas de Refer√™ncias de Coordenadas e unidades (geogr√°ficas e projetadas), iii) fontes de dados, iv) importar e exportar dados, v) descri√ß√£o de objetos geoespaciais e vi) principais opera√ß√µes (atributos, espaciais e geom√©tricas). Num segundo momento, criaremos mapas com seus principais elementos como mapas principal e secund√°rio, t√≠tulo, legenda, barra de escala, indicador de orienta√ß√£o (Norte), gride de coordenadas, descri√ß√£o Sistema de Refer√™ncia de Coordenadas e informa√ß√µes de origem dos dados. Por fim, apresentaremos exemplos de aplica√ß√µes de an√°lises geoespaciais para dados ecol√≥gicos, focadas em: ) agregar informa√ß√µes sobre biodiversidade, ii) preparar dados para compor vari√°veis preditoras, e iii) como fazer predi√ß√µes espaciais de distribui√ß√£o de uma esp√©cie e riqueza de esp√©cies.Esse cap√≠tulo segue parte da estrutura organizada por Lovelace et al. (2019), principalmente os Cap√≠tulos 2 8, sendo adaptado para atender aos principais requisitos que julgamos necess√°rios estudos ecol√≥gicos. Entretanto, n√£o foi poss√≠vel cobrir todos os assuntos sobre o uso de dados geoespaciais R, sendo um tema muito extenso que requer leitura de livros especializados na √°rea como: ) Mas et al. (2019) An√°lise espacial com R, ii) Wegmann, Leutner & Dech (2016) Remote Sensing GIS Ecologists: Using Open Source Software, iii) Wegmann, Schwalb-Willmann & Dech (2020) Introduction Spatial Data Analysis Remote Sensing GIS Open Source Software, e iv) Fletcher & Fortin (2018) Spatial ecology conservation modeling: Applications R. Outros livros sobre an√°lise geoespacial R podem ser consultados Cap√≠tulo 11 - Geospatial Big Book R.","code":""},{"path":"cap15.html","id":"vetor","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.2 Vetor","text":"Dados vetoriais s√£o usados para mapear fen√¥menos ou objetos espacialmente expl√≠citos que possuem localiza√ß√£o ou dimens√µes bem definidas, representado partir de formas geom√©tricas (como pontos, linhas e pol√≠gonos) e possuem possibilidade de ter associado eles informa√ß√µes tabulares. tabela de atributos √© uma tabela que inclui dados geoespaciais e dados alfanum√©ricos. Os dados geoespaciais s√£o representados por fei√ß√µes geolocalizada espacialmente (ponto, linha ou pol√≠gono), e os dados alfanum√©ricos (tabela de dados). Dessa forma, tabela de atributos re√∫ne informa√ß√µes sobre cada fei√ß√£o e pode ser utilizada para realizar de filtros ou agrega√ß√µes dos dados de cada fei√ß√£o (Figura 15.1.\nFigura 15.1: Representa√ß√£o das geometrias de ponto, linha e pol√≠gono e atributos. Adaptado de Olaya (2020)).\n","code":""},{"path":"cap15.html","id":"sf-principal-pacote-no-r-para-dados-vetoriais","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.2.1 sf: principal pacote no R para dados vetoriais","text":"Atualmente o principal pacote para trabalhar com dados vetoriais R √© o sf, que implementou o Simple Feature (E. Pebesma 2018). Entretanto, outro pacote pode ser t√£o vers√°til quanto o sf, caso o terra, com algumas mudan√ßas na sintaxe que n√£o abordaremos nesse livro por quest√µes de redu√ß√£o de espa√ßo.Os tipos de geometrias apresentadas s√£o representadas por diferentes classes: POINT, LINESTRING e POLYGON para apenas uma fei√ß√£o de cada tipo de geometria; MULTIPOINT, MULTILINESTRING e MULTIPOLYGON para v√°rias fei√ß√µes de cada tipo de geometria e; GEOMETRYCOLLECTION para v√°rias fei√ß√µes e tipos de geometrias e classes.Ao olharmos informa√ß√µes de um objeto da classe sf, podemos notar diversas informa√ß√µes que descrevem o mesmo, numa esp√©cie de cabe√ßalho:resumo vetor: indica o n√∫mero de fei√ß√µes (linhas) e campos (colunas)tipo da geometria: umas das sete classes (ou mais outras) listadas anteriormentedimens√£o: n√∫mero de dimens√µes, geralmente duas (XY)bbox (bordas): coordenadas m√≠nimas e m√°ximas da longitude e latitudeinforma√ß√£o CRS: epsg ou proj4string indicando o CRS (Coordinate Reference System)tibble: tabela de atributos, com destaque para coluna geom ou geometry que representa cada fei√ß√£o ou geometriaPodemos fazer um mapa simples utilizando fun√ß√£o plot() desse objeto. Para facilitar, escolheremos apenas primeira coluna [1] (Figura 15.2). Caso n√£o escolhermos apenas uma coluna, um mapa para cada coluna ser√° plotado. üìù Importante \nFaremos mapas mais elaborados na se√ß√£o de visualiza√ß√£o de dados geoespaciais deste cap√≠tulo.\nFigura 15.2: Mapa vetorial mundo.\n","code":"\n## Dados vetoriais de pol√≠gonos do mundo\ndata(world)\nworld\n#> Simple feature collection with 177 features and 10 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -180 ymin: -89.9 xmax: 180 ymax: 83.64513\n#> Geodetic CRS:  WGS 84\n#> # A tibble: 177 √ó 11\n#>    iso_a2 name_long        continent region_un subregion type  area_km2     pop lifeExp gdpPercap                      geom\n#>  * <chr>  <chr>            <chr>     <chr>     <chr>     <chr>    <dbl>   <dbl>   <dbl>     <dbl>        <MULTIPOLYGON [¬∞]>\n#>  1 FJ     Fiji             Oceania   Oceania   Melanesia Sove‚Ä¶   1.93e4  8.86e5    70.0     8222. (((-180 -16.55522, -179.‚Ä¶\n#>  2 TZ     Tanzania         Africa    Africa    Eastern ‚Ä¶ Sove‚Ä¶   9.33e5  5.22e7    64.2     2402. (((33.90371 -0.95, 31.86‚Ä¶\n#>  3 EH     Western Sahara   Africa    Africa    Northern‚Ä¶ Inde‚Ä¶   9.63e4 NA         NA         NA  (((-8.66559 27.65643, -8‚Ä¶\n#>  4 CA     Canada           North Am‚Ä¶ Americas  Northern‚Ä¶ Sove‚Ä¶   1.00e7  3.55e7    82.0    43079. (((-132.71 54.04001, -13‚Ä¶\n#>  5 US     United States    North Am‚Ä¶ Americas  Northern‚Ä¶ Coun‚Ä¶   9.51e6  3.19e8    78.8    51922. (((-171.7317 63.78252, -‚Ä¶\n#>  6 KZ     Kazakhstan       Asia      Asia      Central ‚Ä¶ Sove‚Ä¶   2.73e6  1.73e7    71.6    23587. (((87.35997 49.21498, 86‚Ä¶\n#>  7 UZ     Uzbekistan       Asia      Asia      Central ‚Ä¶ Sove‚Ä¶   4.61e5  3.08e7    71.0     5371. (((55.96819 41.30864, 57‚Ä¶\n#>  8 PG     Papua New Guinea Oceania   Oceania   Melanesia Sove‚Ä¶   4.65e5  7.76e6    65.2     3709. (((141.0002 -2.600151, 1‚Ä¶\n#>  9 ID     Indonesia        Asia      Asia      South-Ea‚Ä¶ Sove‚Ä¶   1.82e6  2.55e8    68.9    10003. (((104.37 -1.084843, 104‚Ä¶\n#> 10 AR     Argentina        South Am‚Ä¶ Americas  South Am‚Ä¶ Sove‚Ä¶   2.78e6  4.30e7    76.3    18798. (((-68.63401 -52.63637, ‚Ä¶\n#> # ‚Ä¶ with 167 more rows\n## Plot dos pol√≠gonos do mundo\nplot(world[1], col = viridis::viridis(100), main = \"Mapa do mundo\")"},{"path":"cap15.html","id":"raster","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.3 Raster","text":"Os dados formato raster consistem em uma matriz (com linhas e colunas) em que os elementos representam c√©lulas, geralmente igualmente espa√ßadas (pixels; Figura 15.3. c√©lulas dos dados raster possuem duas informa√ß√µes: ) identifica√ß√£o das c√©lulas (IDs das c√©lulas) para especificar sua posi√ß√£o na matriz (Figura 15.3 ) e; ii) valores das c√©lulas (Figura 15.3 B), que geralmente s√£o coloridos para facilitar interpreta√ß√£o da varia√ß√£o dos valores espa√ßo (Figura 15.3 C). Al√©m disso, valores ausentes ou n√£o amostrados s√£o representados por NA, ou seja, available (Figura 15.3 B e C).\nFigura 15.3: Raster: () IDs das c√©lulas, (B) valores das c√©lulas, (C) c√©lulas coloridas. Adaptado de Lovelace et al. (2019)).\nPode ainda fazer uma compara√ß√£o com representa√ß√µes de dados vetoriais vistos na Figura 15.1, mas agora formato raster (Figura 15.4.\nFigura 15.4: Representa√ß√£o das geometrias de ponto, linha e pol√≠gono formato raster. Adaptado de Olaya (2020)).\n","code":""},{"path":"cap15.html","id":"raster-principal-pacote-no-r-para-dados-raster","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.3.1 raster: principal pacote no R para dados raster","text":"Atualmente, o principal pacote para trabalhar com dados raster √© o raster, apesar de existir outros dois: terra e stars, com algumas mudan√ßas na sintaxe que n√£o abordaremos neste livro.O pacote raster fornece uma ampla gama de fun√ß√µes para criar, importar, exportar, manipular e processar dados raster R. O objeto raster criado √† partir pacote raster pode assumir tr√™s classes: RasterLayer, RasterStack e RasterBrick.classe RasterLayer representa apenas uma camada raster. Para criar ou importar um raster R podemos utilizar fun√ß√£o raster::raster(). Observando essa classe, podemos notar seguintes informa√ß√µes:class: classe raster objeto rasterdimensions: n√∫mero de linhas, colunas e c√©lulasresolution: largura e altura da c√©lulaextent: coordenadas m√≠nimas e m√°ximas da longitude e latitudecrs: Sistema de Refer√™ncia de Coordenadas (CRS)source: fonte dos dados (mem√≥ria ou disco)names: nome das camadasvalues: valores m√°ximos e m√≠nimos das c√©lulasVamos utilizar os dados volcano, que possui informa√ß√µes topogr√°ficas (eleva√ß√£o) vulc√£o Maunga Whau de Auckland na Nova Zel√¢ndia.Vamos transformar essa matriz de dados em um raster com fun√ß√£o raster::raster().Um mapa simples objeto raster pode ser obtido utilizando fun√ß√£o plot(), pr√≥prio pacote raster (Figura 15.5).\nFigura 15.5: Mapa simples de um RasterLayer.\nAl√©m da classe RasterLayer, h√° mais duas classes que trabalham com m√∫ltiplas camadas: RasterBrick e RasterStack. Elas diferem em rela√ß√£o ao n√∫mero de formatos de arquivo suportados, tipo de representa√ß√£o interna e velocidade de processamento.classe RasterBrick geralmente corresponde √† importa√ß√£o de um √∫nico arquivo de imagem de sat√©lite multiespectral (multicamadas) ou um √∫nico objeto com v√°rias camadas na mem√≥ria. fun√ß√£o raster::brick() cria um objeto RasterBrick.Ao utilizarmos fun√ß√£o plot() pacote raster, podemos visualizar os raster contidos objeto RasterBrick (Figura 15.6).\nFigura 15.6: Mapas simples de um raster RasterBrick.\nJ√° classe RasterStack permite conectar v√°rios objetos raster armazenados em arquivos diferentes ou v√°rios objetos ambiente R. Um RasterStack √© uma lista de objetos RasterLayer com mesma extens√£o, resolu√ß√£o e CRS. Uma maneira de cri√°-lo √© com jun√ß√£o de v√°rios objetos geoespaciais j√° existentes ambiente R ou listar v√°rios arquivos raster em um diret√≥rio armazenado disco. fun√ß√£o raster::stack() cria um objeto RasterStack.Outra diferen√ßa √© que o tempo de processamento, para objetos RasterBrick geralmente √© menor que para objetos RasterStack. decis√£o sobre qual classe Raster deve ser usada depende principalmente car√°ter dos dados de entrada.Da mesma forma, ao utilizar fun√ß√£o plot() pacote raster, podemos visualizar os raster contidos objeto RasterStack (Figura 15.7).\nFigura 15.7: Mapas simples de um raster RasterStack.\n","code":"\n## Dados de altitude de um vulc√£o\nvolcano[1:5, 1:5]\n#>      [,1] [,2] [,3] [,4] [,5]\n#> [1,]  100  100  101  101  101\n#> [2,]  101  101  102  102  102\n#> [3,]  102  102  103  103  103\n#> [4,]  103  103  104  104  104\n#> [5,]  104  104  105  105  105\n## Rasterlayer\nraster_layer <- raster::raster(volcano)\nraster_layer\n#> class      : RasterLayer \n#> dimensions : 87, 61, 5307  (nrow, ncol, ncell)\n#> resolution : 0.01639344, 0.01149425  (x, y)\n#> extent     : 0, 1, 0, 1  (xmin, xmax, ymin, ymax)\n#> crs        : NA \n#> source     : memory\n#> names      : layer \n#> values     : 94, 195  (min, max)\n## Plot raster layers\nplot(raster_layer, col = viridis::viridis(n = 100))\n## Raster layers\nraster_layer1 <- raster_layer\nraster_layer2 <- raster_layer * raster_layer\nraster_layer3 <- sqrt(raster_layer)\nraster_layer4 <- log10(raster_layer)\n\n## Raster brick\nraster_brick <- raster::brick(raster_layer1, raster_layer2, \n                              raster_layer3, raster_layer4)\nraster_brick\n#> class      : RasterBrick \n#> dimensions : 87, 61, 5307, 4  (nrow, ncol, ncell, nlayers)\n#> resolution : 0.01639344, 0.01149425  (x, y)\n#> extent     : 0, 1, 0, 1  (xmin, xmax, ymin, ymax)\n#> crs        : NA \n#> source     : memory\n#> names      :      layer.1,      layer.2,      layer.3,      layer.4 \n#> min values :    94.000000,  8836.000000,     9.695360,     1.973128 \n#> max values :   195.000000, 38025.000000,    13.964240,     2.290035\n## Plot raster brick\nplot(raster_brick, col = viridis::viridis(n = 25), main = \"\")\n## Raster layers\nraster_layer1 <- raster_layer\nraster_layer2 <- raster_layer * raster_layer\nraster_layer3 <- sqrt(raster_layer)\nraster_layer4 <- log10(raster_layer)\n\n## Raster stack\nraster_stack <- raster::stack(raster_layer1, raster_layer2, \n                              raster_layer3, raster_layer4)\nraster_stack\n#> class      : RasterStack \n#> dimensions : 87, 61, 5307, 4  (nrow, ncol, ncell, nlayers)\n#> resolution : 0.01639344, 0.01149425  (x, y)\n#> extent     : 0, 1, 0, 1  (xmin, xmax, ymin, ymax)\n#> crs        : NA \n#> names      :      layer.1,      layer.2,      layer.3,      layer.4 \n#> min values :    94.000000,  8836.000000,     9.695360,     1.973128 \n#> max values :   195.000000, 38025.000000,    13.964240,     2.290035\n## Plot raster stack\nplot(raster_stack, col = viridis::viridis(n = 25), main = \"\")"},{"path":"cap15.html","id":"sistema-de-refer√™ncia-de-coordenadas-e-unidades","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.4 Sistema de Refer√™ncia de Coordenadas e Unidades","text":"Os dados geoespaciais (vetor e raster) possuem ainda um outro componente fundamental que √© o Sistema de Refer√™ncia de Coordenadas, ou ingl√™s Coordinate Reference System (CRS). Esse componente define refer√™ncia espacial dos elementos geoespaciais (vetor e raster) na superf√≠cie da Terra. Esse componente √© composto por dois principais conceitos: primeiro, que tipo de unidades est√£o sendo utilizadas para representa√ß√£o geogr√°fica, podendo assumir dois tipos - √¢ngulos ou metros, que definem o Sistema de Coordenadas Geogr√°ficas e o Sistema de Coordenadas Projetadas, respectivamente. O segundo componente √© o datum, que √© rela√ß√£o sistema de coordenadas (geogr√°fica ou projetada) com superf√≠cie da Terra. Esse √∫ltimo componente faz parte de uma √°rea da Cartografia denominada Geod√©sia que estuda forma e dimens√µes da Terra, campo gravitacional e localiza√ß√£o de pontos fixos e sistemas de coordenadas. O livro de Lapaine & Usery (2017) √© um excelente material para se aprofundar nesse assunto.","code":""},{"path":"cap15.html","id":"sistema-de-coordenadas-geogr√°ficas","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.4.1 Sistema de Coordenadas Geogr√°ficas","text":"O Sistema de Coordenadas Geogr√°ficas utiliza √¢ngulos (graus) para representar fei√ß√µes na superf√≠cie da Terra atrav√©s de dois valores: longitude e latitude. longitude representa o eixo Leste-Oeste e latitudeo eixo Norte-Sul. Nesse sistema, superf√≠cie da Terra √© representada geralmente por uma superf√≠cie elipsoidal, pois Terra √© ligeiramente achatada nos polos devido ao seu movimento entorno seu eixo.","code":""},{"path":"cap15.html","id":"sistema-de-coordenadas-projetadas","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.4.2 Sistema de Coordenadas Projetadas","text":"O Sistema de Coordenadas Projetadas utiliza um Sistema Cartesiano de Coordenadas em uma superf√≠cie plana. Dessa forma, partir de uma origem tra√ßam-se eixos X e Y e uma unidade linear √© utilizada, como o metro. Todos proje√ß√µes feitas de sistemas geoespaciais convertem uma superf√≠cie tridimensional em uma superf√≠cie plana bidimensional. Sendo assim, essa convers√£o traz consigo algum tipo de distor√ß√£o em rela√ß√£o √† por√ß√£o real, podendo ser distor√ß√µes em: ) formas locais, ii) √°reas, iii) dist√¢ncias, iv) flex√£o ou curvatura, v) assimetria ou vi) lacunas de continuidade. Dessa forma, um sistema de coordenadas projetadas pode preservar somente uma ou duas dessas propriedades.Existem tr√™s grandes grupos de proje√ß√µes: ) cil√≠ndricos, ii) c√¥nicos e iii) planares. Na proje√ß√£o cil√≠ndrica, superf√≠cie da Terra √© mapeada em um cilindro, criada tocando superf√≠cie da Terra ao longo de uma ou duas linhas de tang√™ncia, sendo utilizada com mais frequ√™ncia para mapear todo o globo tendo como exemplo mais conhecido Proje√ß√£o Universal Transversa de Mercator (UTM). Na proje√ß√£o c√¥nica, superf√≠cie da Terra √© projetada em um cone ao longo de uma linha ou duas linhas de tang√™ncia, de modo que distor√ß√µes s√£o minimizadas ao longo das linhas e aumentam com dist√¢ncia das mesmas, sendo portanto, mais adequada para mapear √°reas de latitudes m√©dias, tendo como exemplo mais conhecido Proje√ß√£o C√¥nica Equivalente de Albers e Proje√ß√£o C√¥nica Conforme de Lambert. E na proje√ß√£o plana, tamb√©m denominada Proje√ß√£o Azimutal, o mapeamento toca o globo em um ponto ou ao longo de uma linha de tang√™ncia, sendo normalmente utilizado mapeamento de regi√µes polares, sendo mais comum Proje√ß√£o Azimutal Equidistante, mesma utilizada na bandeira da ONU.","code":""},{"path":"cap15.html","id":"datum","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.4.3 Datum","text":"Como dito anteriormente, o datum √© rela√ß√£o sistema de coordenadas com superf√≠cie da Terra. Ele representa o ponto de intersec√ß√£o elipsoide de refer√™ncia com superf√≠cie da Terra (geoide, forma verdadeira da Terra), compensando diferen√ßas campo gravitacional da Terra. Existem dois tipos de datum: ) local e ii) geoc√™ntrico. Em um datum local, como o SAD69 - South American Datum 1969, o elipsoide de refer√™ncia √© deslocado para se alinhar com superf√≠cie em um determinado local, por exemplo, na Am√©rica Sul. J√° em um datum geoc√™ntrico, como WGS84 - World Geodetic System 1984, o centro elipsoide √© o centro de gravidade da Terra e precis√£o das proje√ß√µes n√£o √© otimizada para um local espec√≠fico globo.Brasil, desde 2015, o Instituto Brasileiro de Geografia e Estat√≠stica (IBGE) ajudou desenvolver e reafirmou o uso datum SIRGAS2000 - Sistema de Referencia Geoc√©ntrico para las Am√©ricas 2000 para todos os mapeamentos realizados Brasil, um esfor√ßo conjunto para adotar o mesmo datum em toda Am√©rica. Mais sobre esse datum pode ser lido aqui: SIRGAS2000.","code":""},{"path":"cap15.html","id":"sistema-de-refer√™ncia-de-coordenadas-crs-no-r","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.4.4 Sistema de Refer√™ncia de Coordenadas (CRS) no R","text":"R, h√° duas formas principais de representar um Sistema de Refer√™ncia de Coordenadas: ) c√≥digo epsg e ii) proj4string. O c√≥digo EPSG (European Petroleum Survey Group) √© uma sequ√™ncia de n√∫meros curta, referindo-se apenas um CRS. O site epsg.io permite consultar diversas informa√ß√µes sobre um c√≥digo, como procurar por um c√≥digo, representa√ß√£o de mapas e fazer transforma√ß√µes de CRS.J√° o proj4string permite mais flexibilidade para especificar diferentes par√¢metros, como o tipo de proje√ß√£o, datum e elipsoide. Dessa forma, √© poss√≠vel especificar muitas proje√ß√µes, ou mesmo modificar proje√ß√µes existentes, tornando representa√ß√£o proj4string mais complexa e flex√≠vel.Al√©m disso, ainda √© poss√≠vel consultar uma extensa lista de CRSs site spatialreference.org, que fornece descri√ß√µes em diversos formatos, baseados em GDAL e Proj.4. Essa abordagem permite consultar uma URL que pode produzir uma refer√™ncia espacial em um formato que seu software SIG ou o R pode utilizar como refer√™ncia.Os pacotes (geo)espaciais R suportam uma ampla variedade de CRSs e usam biblioteca PROJ. fun√ß√£o rgdal::make_EPSG() retorna um data frame das proje√ß√µes dispon√≠veis, com informa√ß√µes dos c√≥digos epsg e proj4string numa mesma tabela, facilitando busca e uso de CRSs (Tabela 15.1).\nTabela 15.1: Listagem de Sistemas de Refer√™ncias de Coordenadas dispon√≠veis R, com informa√ß√µes dos c√≥digos epsg e proj4string\n","code":"\n## Listagem dos Sistemas de Refer√™ncias de Coordenadas no R\ncrs_data <- rgdal::make_EPSG()\nhead(crs_data)"},{"path":"cap15.html","id":"principais-fontes-de-dados-geoespaciais","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.5 Principais fontes de dados geoespaciais","text":"Existem diversas fontes de dados geoespaciais em diferentes bases de dados dispon√≠veis gratuitamente. Geralmente essas bases de dados s√£o disponibilizadas separadamente em apenas dados vetoriais e dados raster. Para dados vetoriais, grande parte dos dados disponibilizados s√£o utilizados em mapas como limites pol√≠ticos, limites de biomas ou distribui√ß√£o de esp√©cies para pol√≠gonos; estradas e rios para dados lineares, ou ainda pontos de ocorr√™ncia de esp√©cies ou comunidades, ou medidas tomadas em campo sobre condi√ß√µes naturais como clima ou relevo, como pontos. Entretanto, √© sempre recomendado o uso de bases oficiais, principalmente em rela√ß√£o dados vetoriais de limites pol√≠ticos. Para tanto, √© fundamental buscar bases oficiais de cada pa√≠s, entretanto, h√° bases que podem ser utilizadas globalmente, como veremos.Sobre bases de dados raster, h√° uma infinidade de dados para diferentes objetivos, mas grande parte deles s√£o relativos condi√ß√µes ambientais, representando uma vari√°vel de interesse de forma cont√≠nua espa√ßo, como temperatura, precipita√ß√£o, eleva√ß√£o, etc.H√° uma compila√ß√£o de dados geoespaciais vetoriais e raster feita por Marcus Vin√≠cius Alves de Carvalho e Angelica Carvalho Di Maio, chamada GeoLISTA. Entretanto, como bases de dados tendem ser muito din√¢micas, √© poss√≠vel que muitas bases tenham surgido e desaparecido desde listagem realizada.Al√©m das bases de dados, h√° pacotes espec√≠ficos R que fazem o download de dados vetoriais e rasters, facilitando aquisi√ß√£o e reprodutibilidade. Para conferir uma listagem completa de pacotes para diversas an√°lises espaciais, veja CRAN Task View: Analysis Spatial Data.","code":""},{"path":"cap15.html","id":"vetor-1","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.5.1 Vetor","text":"Dentre bases vetoriais, destacamos seguintes na Tabela 15.2.\nTabela 15.2: Principais bases de dados vetoriais para o Brasil e o Mundo.\n","code":""},{"path":"cap15.html","id":"raster-1","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.5.2 Raster","text":"Dentre bases raster, destacamos seguintes na Tabela 15.3.\nTabela 15.3: Principais bases de dados raster para o Brasil e o Mundo.\n","code":""},{"path":"cap15.html","id":"pacotes-do-r","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.5.3 Pacotes do R","text":"Dentre os pacotes R para download de dados geoespaciais, destacamos os seguintes na Tabela 15.4.\nTabela 15.4: Principais pacotes R para download de dados vetoriais e raster.\n","code":""},{"path":"cap15.html","id":"importar-e-exportar-dados-geoespaciais","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.6 Importar e exportar dados geoespaciais","text":"Agora que sabemos o que s√£o dados geoespaciais e em quais bases de dados podemos buscar e baixar esses dados, veremos seus principais formatos e como import√°-los e export√°-los R.","code":""},{"path":"cap15.html","id":"principais-formatos-de-arquivos-geoespaciais","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.6.1 Principais formatos de arquivos geoespaciais","text":"H√° diversos formatos de arquivos geoespaciais, alguns espec√≠ficos para dados vetoriais e raster, e outros formato de banco de dados geoespaciais, como PostGIS, que podem armazenar ambos os formatos.Entretanto, todos os formatos para serem importados para o R usam o GDAL (Geospatial Data Abstraction Library), uma interface unificada para leitura e escrita de diversos formatos de arquivos geoespaciais, sendo utilizado tamb√©m por uma s√©rie de softwares de GIS como QGIS, GRASS GIS e ArcGIS.Dentre esses formatos, destacamos os seguintes na Tabela 15.5.\nTabela 15.5: Principais formatos de arquivos geoespaciais. Adaptado de: Lovelace et al. (2019).\nO formato mais comum para arquivos vetoriais √© o ESRI Shapefile; para arquivos raster √© o GeoTIFF; e para dados clim√°ticos em m√∫ltiplas camadas, geralmente h√° disponibiliza√ß√£o de dados formato NetCDF. Entretanto, recentemente tivemos o surgimento GeoPackage, que possui diversas vantagens em rela√ß√£o aos formatos anteriores, podendo armazenar em apenas um arquivo, dados formato vetorial, raster e tamb√©m dados n√£o-espaciais (e.g., tabelas), al√©m de possuir uma grande integra√ß√£o com diversos softwares e bancos de dados.","code":""},{"path":"cap15.html","id":"importar-dados-1","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.6.2 Importar dados","text":"principais fun√ß√µes para importar dados R s√£o: ) para vetores fun√ß√£o sf::st_read(), e ii) para raster fun√ß√£o raster::raster() e suas varia√ß√µes raster::brick() e raster::stack() para m√∫ltiplas camadas. Essas fun√ß√µes atribuem objetos ao seu espa√ßo de trabalho, armazenando-os na mem√≥ria RAM dispon√≠vel em seu hardware, sendo essa maior limita√ß√£o para trabalhar com dados geoespaciais R. Por exemplo, se um arquivo raster possui mais de 8 Gb de tamanho, e seu computador possui exatamente 8 Gb de RAM, √© muito prov√°vel que ele n√£o seja importado ou mesmo criado como um objeto dentro ambiente R. Existem solu√ß√µes para esses problemas, mas n√£o abordaremos neste cap√≠tulo.VetorComo vimos, os arquivos vetoriais s√£o disponibilizados em diversos formatos. Para sabermos se um determinado formato pode ser importado ou exportado utilizando o pacote sf, podemos utilizar fun√ß√£o sf::st_drivers(). Uma amostra desses formatos √© apresentado na Tabela 15.6.\nTabela 15.6: Alguns formatos vetoriais importados e exportados pelo pacote sf.\nImportar dados vetoriais existentesPara importar vetores existentes para o R, utilizaremos fun√ß√£o sf::st_read(). estrutura √© semelhante para todos os formatos descritos na Tabela 15.6, de modo que sempre preencheremos o argumento dsn (data source name) com o nome arquivo ser importado. Entretanto, para banco de dados, como GeoPackage, pode ser necess√°rio especificar camada que se tem interesse com um segundo argumento chamado layer, com o nome da camada.Para quase todas opera√ß√µes vetoriais nesse cap√≠tulo, usaremos os dados dispon√≠veis para o munic√≠pio de Rio Claro/SP. Primeiramente, baixaremos esses dados da FBDS (Funda√ß√£o Brasileira para o Desenvolvimento Sustent√°vel), atrav√©s desse reposit√≥rio de dados. Em 2013, FBDS deu in√≠cio ao Projeto de Mapeamento em Alta Resolu√ß√£o dos Biomas Brasileiros, mapeando cobertura da terra, hidrografia (nascentes, rios e lagos) e √Åreas de Preserva√ß√£o Permanente (APPs). O mapeamento foi conclu√≠do para os munic√≠pios dos Biomas Mata Atl√¢ntica e Cerrado, e mais recentemente para os outros biomas. Para fazer o download dos arquivos de interesse, utilizaremos o R, atrav√©s da fun√ß√£o download.file().Primeiramente, criaremos um diret√≥rio com fun√ß√£o create.dir(), usando fun√ß√£o ::() para indicar o reposit√≥rio (ver o Cap√≠tulo 5).Em seguida, vamos fazer o download de pontos de nascentes, linhas de hidrografia e pol√≠gonos de cobertura da terra para o munic√≠pio de Rio Claro/SP.Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.Agora podemos importar esses dados para o R. Primeiro vamos importar nascentes (Figura 15.8).\nFigura 15.8: Mapa de nascentes de Rio Claro/SP.\nAgora vamos importar hidrografia (Figura 15.9).\nFigura 15.9: Mapa da hidrografia de Rio Claro/SP.\nE por fim, vamos importar cobertura da terra (Figura 15.10).\nFigura 15.10: Mapa de cobertura da terra de Rio Claro/SP.\nImportar utilizando pacotesAl√©m de dados existentes, podemos importar dados vetoriais de pacotes, como listado anteriormente na Tabela 15.4. Para o Brasil, o pacote mais interessante trata-se geobr, Instituto de Pesquisa Econ√¥mica Aplicada (IPEA), que possui dados oficiais Instituto Brasileiro de Geografia e Estat√≠stica (IBGE).√â poss√≠vel listar todos os dados dispon√≠veis pacote atrav√©s da fun√ß√£o geobr::list_geobr(). Na Tabela 15.7 √© poss√≠vel ver alguns desses dados.\nTabela 15.7: Alguns dados dispon√≠veis pacote geobr.\nComo exemplo, vamos fazer o download o limite munic√≠pio de Rio Claro/SP, utilizando o c√≥digo munic√≠pio (3543907) (Figura 15.11). üìù Importante \nPara saber todos os c√≥digos dos munic√≠pios Brasil, recomendamos verifica√ß√£o site IBGE.Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.\nFigura 15.11: Limite munic√≠pio de Rio Claro/SP.\nJ√° para o mundo, o pacote mais interessante trata-se rnaturalearth, que faz o download de dados Natural Earth. Vamos fazer o download limite Brasil (Figura 15.12).Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.\nFigura 15.12: Limite Brasil.\nCriar um objeto espacial de uma tabela de coordenadas√â muito comum em coletas de campo ou bases de dados, ter coordenadas de locais de estudo ou de ocorr√™ncias de esp√©cies organizadas em tabelas. Essas tabelas devem possuir duas colunas: longitude e latitude, ou X e Y para dados UTM, por exemplo. Ao import√°-las para o R, o formato que assumem pode ser de uma das classes: matrix, data frame ou tibble, ou seja, ainda n√£o s√£o da classe vetorial sf. Nesta se√ß√£o iremos ver como fazer essa convers√£o.Para tanto, vamos usar os dados de comunidades de anf√≠bios da Mata Atl√¢ntica (Atlantic Amphibians, Vancine et al. (2018)). Faremos o download diretamente site da fonte dos dados. Antes vamos criar um diret√≥rio.Em seguida, vamos fazer o download de um arquivo .zip e vamos extrair usando fun√ß√£o unzip() nesse mesmo diret√≥rio.Agora podemos importar tabela de dados com fun√ß√£o readr::read_csv().Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.Por fim, podemos facilmente criar um objeto espacial tipo MULTIPOINT utilizando fun√ß√£o sf::st_as_sf(). Podemos ver essas coordenadas plotadas mapa simples da Figura 15.13 (Vancine et al. 2018).√â necess√°rio antes se ater ao argumento coords que deve indicar colunas de longitude e latitude, nessa ordem; e tamb√©m ao argumento crs para indicar o CRS correspondente dessas coordenadas, que aqui sabemos se tratar de coordenadas geogr√°ficas e datum WGS84. Ent√£o podemos facilmente utilizar o c√≥digo EPSG 4326. Entretanto, se coordenadas estiverem em metros, por exemplo, teremos de nos ater qual CRS mesmas foram coletadas, ou seja, se forem coordenadas de GPS, √© preciso saber como o GPS estava configurado (proje√ß√£o e datum).\nFigura 15.13: Coordenadas das comunidades Atlantic Amphibians.\nConverter dados espaciais sp para sfO pacote sf √© mais recente e mais f√°cil de manipular objetos vetoriais R. Seu predecessor, o pacote sp possui uma classe pr√≥pria e hom√¥nima. Entretanto, muitos pacotes de an√°lises espaciais ainda utilizam essa classe em suas fun√ß√µes, apesar dessa migra√ß√£o ter ocorrido rapidamente recentemente. Dessa forma, convers√£o entre essas classes pode ser necess√°ria em alguns momentos.Abaixo, veremos como podemos fazer essa convers√£o facilmente. Primeiramente, vamos importar dados sp.Agora, podemos converter facilmente com fun√ß√£o sf::st_as_sf().Podemos facilmente converter esse objeto novamente para classe sp com fun√ß√£o sf::as_Spatial().RasterPara importar dados raster R, utilizaremos fun√ß√£o raster::raster(), raster::brick() ou raster::stack(). Para apenas uma camada raster, usaremos fun√ß√£o raster::raster(), com o argumento x sendo o nome arquivo. J√° para mais camadas, usaremos raster::brick() para um arquivo que possua m√∫ltiplas camadas, ou ainda fun√ß√£o raster::stack() para v√°rios arquivos em diferentes camadas tamb√©m argumento x, sendo necess√°rio listar os arquivos diret√≥rio, geralmente utilizando fun√ß√£o dir() ou list.files(). Entretanto, para especificar uma camada, podemos utilizar o argumento band ou layer e o nome dessa camada.Raster LayerPrimeiramente, vamos criar um diret√≥rio para os dados raster que fazeremos o download.Em seguida, vamos fazer o download de dados de eleva√ß√£o, na verdade dados de Modelo Digital de Eleva√ß√£o (Digital Elevation Model - DEM), localizados tamb√©m para o munic√≠pio de Rio Claro. Utilizaremos os dados Shuttle Radar Topography Mission - SRTM. Para saber mais sobre esses dados, recomendamos leitura artigo de Farr et al. (2007).Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.Agora podemos importar essa camada para o R, e visualiz√°-la em rela√ß√£o ao limite munic√≠pio de Rio Claro/SP (Figura 15.14).\nFigura 15.14: Camada raster DEM em rela√ß√£o ao limite munic√≠pio de Rio Claro/SP.\nRaster StackAl√©m dos dados de eleva√ß√£o, dados de temperatura e precipita√ß√£o podem ser obtidos WorldClim. Para saber mais sobre esses dados, recomendamos leitura artigo Fick & Hijmans (2017).Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.Para importar essa s√©rie de camadas, primeiramente listaremos os arquivos e depois importar formato RasterStack (Figura 15.15).\nFigura 15.15: Camadas rasters WorldClim (BIO01 e BIO12) para o mundo.\n","code":"\n## Formatos vetoriais importados e exportados pelo pacote sf\nhead(sf::st_drivers())\n## Criar diret√≥rio\ndir.create(here::here(\"dados\"))\ndir.create(here::here(\"dados\", \"vetor\"))\n## Aumentar o tempo de download\noptions(timeout = 1e3)\n\n## Download\nfor(i in c(\".dbf\", \".prj\", \".shp\", \".shx\")){\n    \n    # Pontos de nascentes\n    download.file(\n        url = paste0(\"http://geo.fbds.org.br/SP/RIO_CLARO/HIDROGRAFIA/SP_3543907_NASCENTES\", i),\n        destfile = here::here(\"dados\", \"vetor\", paste0(\"SP_3543907_NASCENTES\", i)), mode = \"wb\")\n    \n    # Linhas de hidrografia\n    download.file(\n        url = paste0(\"http://geo.fbds.org.br/SP/RIO_CLARO/HIDROGRAFIA/SP_3543907_RIOS_SIMPLES\", i),\n        destfile = here::here(\"dados\", \"vetor\", paste0(\"SP_3543907_RIOS_SIMPLES\", i)), mode = \"wb\")\n    \n    # Pol√≠gonos de cobertura da terra\n    download.file(\n        url = paste0(\"http://geo.fbds.org.br/SP/RIO_CLARO/USO/SP_3543907_USO\", i),\n        destfile = here::here(\"dados\", \"vetor\", paste0(\"SP_3543907_USO\", i)), mode = \"wb\")\n}\n## Importar os dados pelo pacote ecodados\necodados::geo_vetor_nascentes\necodados::geo_vetor_hidrografia\necodados::geo_vetor_cobertura\n## Importar nascentes\ngeo_vetor_nascentes <- sf::st_read(\n    here::here(\"dados\", \"vetor\", \"SP_3543907_NASCENTES.shp\"), quiet = TRUE)\n## Plot\nplot(geo_vetor_nascentes[1], pch = 20, col = \"blue\", main = NA, \n     axes = TRUE, graticule = TRUE)\n## Importar hidrografia\ngeo_vetor_hidrografia <- sf::st_read(\n    here::here(\"dados\", \"vetor\", \"SP_3543907_RIOS_SIMPLES.shp\"), quiet = TRUE)\n## Plot\nplot(geo_vetor_hidrografia[1], col = \"steelblue\", main = NA, axes = TRUE, graticule = TRUE)\n## Importar cobertura da terra\ngeo_vetor_cobertura <- sf::st_read(\n    here::here(\"dados\", \"vetor\", \"SP_3543907_USO.shp\"), quiet = TRUE)\n## Plot\nplot(geo_vetor_cobertura[5], \n     col = c(\"blue\", \"orange\", \"gray30\", \"forestgreen\", \"green\"), \n     main = NA, axes = TRUE, graticule = TRUE)\nlegend(x = .1, y = .3, pch = 15, cex = .7, pt.cex = 2.5, \n       legend = (geo_vetor_cobertura$CLASSE_USO), \n       col = c(\"blue\", \"orange\", \"gray30\", \"forestgreen\", \"green\"))\n## Listar todos os dados do geobr\ngeobr::list_geobr()\n## Pol√≠gono do limite do munic√≠pio de Rio Claro\ngeo_vetor_rio_claro <- geobr::read_municipality(code_muni = 3543907, \n                                                year = 2020, showProgress = FALSE)\n## Importar os dados pelo pacote ecodados\necodados::geo_vetor_rio_claro\n## Plot\nplot(geo_vetor_rio_claro[1], col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\n## Pol√≠gono do limite do Brasil\ngeo_vetor_brasil <- rnaturalearth::ne_countries(scale = \"large\", \n                                                country = \"Brazil\", returnclass = \"sf\")\n## Importar os dados pelo pacote ecodados\necodados::geo_vetor_brasil\n## Plot\nplot(geo_vetor_brasil[1], col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\n## Criar diret√≥rio\ndir.create(here::here(\"dados\", \"tabelas\"))\n## Download\ndownload.file(url = \"https://esajournals.onlinelibrary.wiley.com/action/downloadSupplement?doi=10.1002%2Fecy.2392&file=ecy2392-sup-0001-DataS1.zip\",\n              destfile = here::here(\"dados\", \"tabelas\", \"atlantic_amphibians.zip\"), mode = \"wb\")\n\n## Unzip\nunzip(zipfile = here::here(\"dados\", \"tabelas\", \"atlantic_amphibians.zip\"),\n      exdir = here::here(\"dados\", \"tabelas\"))\n## Importar tabela de locais\ngeo_anfibios_locais <- readr::read_csv(\n    here::here(\"dados\", \"tabelas\", \"ATLANTIC_AMPHIBIANS_sites.csv\"),\n    locale = readr::locale(encoding = \"latin1\")\n)\ngeo_anfibios_locais\n#> # A tibble: 1,163 √ó 25\n#>    id      reference_number species_number record sampled_habitat active_methods passive_methods complementary_meth‚Ä¶ period\n#>    <chr>              <dbl>          <dbl> <chr>  <chr>           <chr>          <chr>           <chr>               <chr> \n#>  1 amp1001             1001             19 ab     fo,ll           as             pt              <NA>                mo,da‚Ä¶\n#>  2 amp1002             1002             16 co     fo,la,ll        as             pt              <NA>                mo,da‚Ä¶\n#>  3 amp1003             1002             14 co     fo,la,ll        as             pt              <NA>                mo,da‚Ä¶\n#>  4 amp1004             1002             13 co     fo,la,ll        as             pt              <NA>                mo,da‚Ä¶\n#>  5 amp1005             1003             30 co     fo,ll,br        as             <NA>            <NA>                mo,da‚Ä¶\n#>  6 amp1006             1004             42 co     tp,pp,la,ll,is  <NA>           <NA>            <NA>                <NA>  \n#>  7 amp1007             1005             23 co     sp              as             <NA>            <NA>                <NA>  \n#>  8 amp1008             1005             19 co     sp,la,sw        as,sb,tr       <NA>            <NA>                tw,ni \n#>  9 amp1009             1005             13 ab     fo              <NA>           pt              <NA>                mo,da‚Ä¶\n#> 10 amp1010             1006              1 ab     fo              <NA>           pt              <NA>                mo,da‚Ä¶\n#> # ‚Ä¶ with 1,153 more rows, and 16 more variables: month_start <dbl>, year_start <dbl>, month_finish <dbl>,\n#> #   year_finish <dbl>, effort_months <dbl>, country <chr>, state <chr>, state_abbreviation <chr>, municipality <chr>,\n#> #   site <chr>, latitude <dbl>, longitude <dbl>, coordinate_precision <chr>, altitude <dbl>, temperature <dbl>,\n#> #   precipitation <dbl>\n## Importar os dados pelo pacote ecodados\necodados::geo_anfibios_locais\n## Converter dados tabulares para sf\ngeo_anfibios_locais_vetor <- geo_anfibios_locais %>% \n    sf::st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326)\ngeo_anfibios_locais_vetor\n#> Simple feature collection with 1163 features and 23 fields\n#> Geometry type: POINT\n#> Dimension:     XY\n#> Bounding box:  xmin: -56.74194 ymin: -33.51083 xmax: -34.79667 ymax: -3.51525\n#> Geodetic CRS:  WGS 84\n#> # A tibble: 1,163 √ó 24\n#>    id      reference_number species_number record sampled_habitat active_methods passive_methods complementary_meth‚Ä¶ period\n#>  * <chr>              <dbl>          <dbl> <chr>  <chr>           <chr>          <chr>           <chr>               <chr> \n#>  1 amp1001             1001             19 ab     fo,ll           as             pt              <NA>                mo,da‚Ä¶\n#>  2 amp1002             1002             16 co     fo,la,ll        as             pt              <NA>                mo,da‚Ä¶\n#>  3 amp1003             1002             14 co     fo,la,ll        as             pt              <NA>                mo,da‚Ä¶\n#>  4 amp1004             1002             13 co     fo,la,ll        as             pt              <NA>                mo,da‚Ä¶\n#>  5 amp1005             1003             30 co     fo,ll,br        as             <NA>            <NA>                mo,da‚Ä¶\n#>  6 amp1006             1004             42 co     tp,pp,la,ll,is  <NA>           <NA>            <NA>                <NA>  \n#>  7 amp1007             1005             23 co     sp              as             <NA>            <NA>                <NA>  \n#>  8 amp1008             1005             19 co     sp,la,sw        as,sb,tr       <NA>            <NA>                tw,ni \n#>  9 amp1009             1005             13 ab     fo              <NA>           pt              <NA>                mo,da‚Ä¶\n#> 10 amp1010             1006              1 ab     fo              <NA>           pt              <NA>                mo,da‚Ä¶\n#> # ‚Ä¶ with 1,153 more rows, and 15 more variables: month_start <dbl>, year_start <dbl>, month_finish <dbl>,\n#> #   year_finish <dbl>, effort_months <dbl>, country <chr>, state <chr>, state_abbreviation <chr>, municipality <chr>,\n#> #   site <chr>, coordinate_precision <chr>, altitude <dbl>, temperature <dbl>, precipitation <dbl>, geometry <POINT [¬∞]>\n## Plot\nplot(geo_anfibios_locais_vetor[1], pch = 20, col = \"black\", \n     main = NA, axes = TRUE, graticule = TRUE)\n## Pol√≠gonos pa√≠ses sp\nco110_sp <- rnaturalearth::countries110\nclass(co110_sp)\n#> [1] \"SpatialPolygonsDataFrame\"\n#> attr(,\"package\")\n#> [1] \"sp\"\n## Pol√≠gonos pa√≠ses sf\nco110_sf <- sf::st_as_sf(co110_sp)\nclass(co110_sf)\n#> [1] \"sf\"         \"data.frame\"\n## Pol√≠gonos pa√≠ses sp\nco110_sp <- sf::as_Spatial(co110_sf)\nclass(co110_sp)\n#> [1] \"SpatialPolygonsDataFrame\"\n#> attr(,\"package\")\n#> [1] \"sp\"\n## Criar diret√≥rio\ndir.create(here::here(\"dados\", \"raster\"))\n## Aumentar o tempo de download\noptions(timeout = 1e3)\n\n## Download\ndownload.file(url = \"https://srtm.csi.cgiar.org/wp-content/uploads/files/srtm_5x5/TIFF/srtm_27_17.zip\",\n              destfile = here::here(\"dados\", \"raster\", \"srtm_27_17.zip\"), mode = \"wb\")\n\n## Unzip\nunzip(zipfile = here::here(\"dados\", \"raster\", \"srtm_27_17.zip\"),\n      exdir = here::here(\"dados\", \"raster\"))\n## Importar os dados pelo pacote ecodados\necodados::geo_raster_srtm\n## Importar raster de altitude\ngeo_raster_srtm <- raster::raster(here::here(\"dados\", \"raster\", \"srtm_27_17.tif\"))\ngeo_raster_srtm\n#> class      : RasterLayer \n#> dimensions : 6000, 6000, 3.6e+07  (nrow, ncol, ncell)\n#> resolution : 0.0008333333, 0.0008333333  (x, y)\n#> extent     : -50, -45, -25, -20  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : srtm_27_17.tif \n#> names      : srtm_27_17 \n#> values     : -32768, 32767  (min, max)\n## Plot\nplot(geo_raster_srtm, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Aumentar o tempo de download\noptions(timeout = 1e3)\n\n## Download\ndownload.file(url = \"https://biogeo.ucdavis.edu/data/worldclim/v2.1/base/wc2.1_10m_bio.zip\",\n              destfile = here::here(\"dados\", \"raster\", \"wc2.0_10m_bio.zip\"), mode = \"wb\")\n\n## Unzip\nunzip(zipfile = here::here(\"dados\", \"raster\", \"wc2.0_10m_bio.zip\"),\n      exdir = here::here(\"dados\", \"raster\"))\n## Importar os dados pelo pacote ecodados\necodados::geo_raster_bioclim\n## Listar arquivos\narquivos_raster <- dir(path = here::here(\"dados\", \"raster\"), pattern = \"wc\") %>% \n    grep(\".tif\", ., value = TRUE)\narquivos_raster\n#>  [1] \"wc2.1_10m_bio_1.tif\"  \"wc2.1_10m_bio_10.tif\" \"wc2.1_10m_bio_11.tif\" \"wc2.1_10m_bio_12.tif\" \"wc2.1_10m_bio_13.tif\"\n#>  [6] \"wc2.1_10m_bio_14.tif\" \"wc2.1_10m_bio_15.tif\" \"wc2.1_10m_bio_16.tif\" \"wc2.1_10m_bio_17.tif\" \"wc2.1_10m_bio_18.tif\"\n#> [11] \"wc2.1_10m_bio_19.tif\" \"wc2.1_10m_bio_2.tif\"  \"wc2.1_10m_bio_3.tif\"  \"wc2.1_10m_bio_4.tif\"  \"wc2.1_10m_bio_5.tif\" \n#> [16] \"wc2.1_10m_bio_6.tif\"  \"wc2.1_10m_bio_7.tif\"  \"wc2.1_10m_bio_8.tif\"  \"wc2.1_10m_bio_9.tif\"\n\n## Importar v√°rios rasters como stack\ngeo_raster_bioclim <- raster::stack(here::here(\"dados\", \"raster\", arquivos_raster))\ngeo_raster_bioclim\n#> class      : RasterStack \n#> dimensions : 1080, 2160, 2332800, 19  (nrow, ncol, ncell, nlayers)\n#> resolution : 0.1666667, 0.1666667  (x, y)\n#> extent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> names      : wc2.1_10m_bio_1, wc2.1_10m_bio_10, wc2.1_10m_bio_11, wc2.1_10m_bio_12, wc2.1_10m_bio_13, wc2.1_10m_bio_14, wc2.1_10m_bio_15, wc2.1_10m_bio_16, wc2.1_10m_bio_17, wc2.1_10m_bio_18, wc2.1_10m_bio_19, wc2.1_10m_bio_2, wc2.1_10m_bio_3, wc2.1_10m_bio_4, wc2.1_10m_bio_5, ... \n#> min values :      -54.724354,       -37.781418,       -66.311249,         0.000000,         0.000000,         0.000000,         0.000000,         0.000000,         0.000000,         0.000000,         0.000000,        1.000000,        9.131122,        0.000000,      -29.686001, ... \n#> max values :        30.98764,         38.21617,         29.15299,      11191.00000,       2381.00000,        484.00000,        229.00169,       5284.00000,       1507.00000,       5282.00000,       4467.00000,        21.14754,       100.00000,      2363.84595,        48.08275, ...\n## Plot\nplot(geo_raster_bioclim[[c(1, 4)]], col = viridis::viridis(10))"},{"path":"cap15.html","id":"exportar-dados-1","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.6.3 Exportar dados","text":"Saber melhor forma de exportar dados geoespaciais de objetos rec√©m-criados R √© fundamental, principalmente porque essa a√ß√£o depender√° tipo de dado (vetor ou raster), classe objeto (por exemplo, MULTIPOINT ou RasterLayer) e tipo e quantidade de informa√ß√µes armazenadas (por exemplo, tamanho objeto, intervalo de valores, etc.).VetorPara dados vetoriais, principal fun√ß√£o utilizada √© sf::st_write(). Essa fun√ß√£o permite gravar objetos sf em v√°rios formatos de arquivos vetoriais, como .shp, .gpkg ou .geojson. O formato ser exportado vai influenciar na velocidade processo de grava√ß√£o.Os argumentos dessa fun√ß√£o ser√° o obj que √© o objeto sf criado ambiente R, e o dsn (data source name), ou seja, o nome que o arquivo ter√° ao ser exportado R, de modo que o complemento .shp nome de sa√≠da, por exemplo, definir√° que o arquivo ter√° extens√£o ESRI Shapefile. Entretanto, essa extens√£o pode ser definida tamb√©m utilizando o argumento driver, com possibilidades listadas nesse site.Ou podemos ainda exportar o objeto vetorial na extens√£o GeoPackage. Entretanto, aqui √© interessante acrescentar um argumento chamado layer para definir o nome das camadas serem exportadas mesmo arquivo GeoPackage, por exemplo.Ainda sobre o formato GeoPackage, h√° algo muito interessante que podemos fazer: podemos acrescentar outros arquivos vetoriais ao mesmo arquivo j√° criado. Como exemplo, exportaremos o limite Brasil para o mesmo arquivo.RasterPara exportar dados raster utilizamos geralmente fun√ß√£o raster::writeRaster(). Exportar dados raster √© um pouco mais complexo que exportar dados vetoriais. Teremos de definir se exportaremos arquivos em uma ou v√°rias camadas, quantidade de informa√ß√µes por pixel, e ainda diferentes extens√µes de sa√≠da. üìù Importante \nArquivos raster escritos em discos geralmente ocupam bastante espa√ßo, e dessa forma, h√° par√¢metros espec√≠ficos para certos tipos de dados, que detalharemos seguir para contornar esse problema e comprimir os arquivos.Na fun√ß√£o raster::writeRaster(), o argumento x diz respeito ao objeto raster ambiente R. O argumento filename √© nome arquivo que ser√° exportado R, podendo ou n√£o possuir extens√£o que se pretende que o arquivo tenha. O argumento format √© o formato arquivo, sendo principais possibilidades resumidas na Tabela 15.8, e para saber das possibilidades suportadas, use fun√ß√£o raster::writeFormats(). O argumento bylayer diz se m√∫ltiplas camadas ser√£o exportada em arquivos diferentes ou em apenas um arquivo.\nTabela 15.8: Principais formatos de arquivos raster exportados R.\nDentre os argumentos adicionais, temos ainda o datatype, que faz refer√™ncia um dos nove tipos de formato de dados detalhados na Tabela 15.9, sendo que o tipo de dado determina representa√ß√£o em bits (quantidade de informa√ß√£o) na c√©lula objeto raster exportado e depende da faixa de valores objeto raster em cada pixel. Quanto mais valores um tipo de dado puder representar, maior ser√° o arquivo exportado disco. Dessa forma, √© interessante utilizar um tipo de dado que diminua o tamanho arquivo ser exportado, dependendo tipo de dado em cada pixel. Para fun√ß√£o raster::writeRaster(), o default √© FLT4S, o que pode ocupar mais espa√ßo em disco que o necess√°rio.\nTabela 15.9: Tipos de dados suportados pelo pacote raster.\nOutros argumentos de suporte s√£o: overwrite para sobrescrever um arquivo que j√° exista, progress para mostrar uma barra de progresso da exporta√ß√£o como ‚Äútext‚Äù ou ‚Äúwindow,‚Äù e options que permite op√ß√µes GDAL. Para esse √∫ltimo , quando exportar especificamente na extens√£o GeoTIFF, podemos utilizar options = c(\"COMPRESS=DEFLATE\", \"TFW=YES\") para que haja compress√£o arquivo, diminuindo consideravelmente seu tamanho (cerca de um ter√ßo), aliado √† cria√ß√£o de um arquivo auxiliar .tfw, para ser carregado em softwares espec√≠ficos de SIG, como o ArcGIS.Para exportar apenas uma camada RasterLayer, podemos utilizar fun√ß√£o raster::writeRaster() em um formato mais simples.Para mais de uma camada RasterBrick ou RasterStack, podemos utilizar fun√ß√£o raster::writeRaster() com mais s, como o bylayer = TRUE.","code":"\n## Exportar o pol√≠gono de Rio Claro na extens√£o ESRI Shapefile\nsf::st_write(obj = geo_vetor_rio_claro, \n             dsn = here::here(\"dados\", \"vetor\", \"geo_vetor_rio_claro.shp\"))\n## Exportar o pol√≠gono de Rio Claro na extens√£o Geopackage\nsf::st_write(obj = geo_vetor_rio_claro, \n             dsn = here::here(\"dados\", \"vetor\", \"vetores.gpkg\"), \n             layer = \"rio_claro\")\n## Exportar o pol√≠gono do Brasil na extens√£o Geopackage\nsf::st_write(obj = geo_vetor_brasil, \n             dsn = here::here(\"dados\", \"vetor\", \"vetores.gpkg\"), \n             layer = \"brasil\")\n## Criar diret√≥rio\ndir.create(here::here(\"dados\", \"raster\", \"exportados\"))\n\n## Exportar raster layer\nraster::writeRaster(geo_raster_srtm, \n                    filename = here::here(\"dados\", \"raster\", \"exportados\", \"elevation\"),\n                    format = \"GTiff\",\n                    datatype = \"INT2S\",\n                    options = c(\"COMPRESS=DEFLATE\", \"TFW=YES\"),\n                    progress = \"text\",\n                    overwrite = TRUE)\n## Exportar raster stack\nraster::writeRaster(x = geo_raster_bioclim, \n                    filename = here::here(\"dados\", \"raster\", \"exportados\", names(geo_raster_bioclim)),\n                    bylayer = TRUE, \n                    format = \"GTiff\",\n                    datatype = \"INT2S\",\n                    options = c(\"COMPRESS=DEFLATE\", \"TFW=YES\"),\n                    progress = \"text\",\n                    overwrite = TRUE)"},{"path":"cap15.html","id":"descri√ß√£o-de-objetos-geoespaciais","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.7 Descri√ß√£o de objetos geoespaciais","text":"Muitas vezes precisaremos verificar informa√ß√µes dos objetos geoespaciais importados para o R. Apesar de chamar o objeto trazer grande parte das informa√ß√µes que precisamos consultar, existem fun√ß√µes espec√≠ficas que nos auxiliam nesse processo de descri√ß√£o dos objetos.","code":""},{"path":"cap15.html","id":"vetor-2","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.7.1 Vetor","text":"Podemos acessar informa√ß√µes geoespaciais e tabela de atributos de um objeto importado como vetor simplesmente chamando o nome objeto R.Mas tamb√©m podemos acessar informa√ß√µes geoespaciais com fun√ß√µes espec√≠ficas, como tipo de geometria, limites geoespaciais vetor (extens√£o), sistema de refer√™ncia de coordenadas (CRS), e tabela de atributos.","code":"\n## Munic√≠pio de Rio Claro\ngeo_vetor_rio_claro\n#> Simple feature collection with 1 feature and 7 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -47.76521 ymin: -22.55203 xmax: -47.46188 ymax: -22.24368\n#> Geodetic CRS:  SIRGAS 2000\n#>     code_muni name_muni code_state abbrev_state name_state code_region name_region                           geom\n#> 493   3543907 Rio Claro         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-47.46875 -...\n## Tipo de geometria\nsf::st_geometry_type(geo_vetor_rio_claro)\n#> [1] MULTIPOLYGON\n#> 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT MULTILINESTRING MULTIPOLYGON GEOMETRYCOLLECTION ... TRIANGLE\n\n## Extens√£o\nsf::st_bbox(geo_vetor_rio_claro)\n#>      xmin      ymin      xmax      ymax \n#> -47.76521 -22.55203 -47.46188 -22.24368\n\n## CRS\nsf::st_crs(geo_vetor_rio_claro)\n#> Coordinate Reference System:\n#>   User input: SIRGAS 2000 \n#>   wkt:\n#> GEOGCRS[\"SIRGAS 2000\",\n#>     DATUM[\"Sistema de Referencia Geocentrico para las AmericaS 2000\",\n#>         ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n#>             LENGTHUNIT[\"metre\",1]]],\n#>     PRIMEM[\"Greenwich\",0,\n#>         ANGLEUNIT[\"degree\",0.0174532925199433]],\n#>     CS[ellipsoidal,2],\n#>         AXIS[\"geodetic latitude (Lat)\",north,\n#>             ORDER[1],\n#>             ANGLEUNIT[\"degree\",0.0174532925199433]],\n#>         AXIS[\"geodetic longitude (Lon)\",east,\n#>             ORDER[2],\n#>             ANGLEUNIT[\"degree\",0.0174532925199433]],\n#>     USAGE[\n#>         SCOPE[\"Horizontal component of 3D system.\"],\n#>         AREA[\"Latin America - Central America and South America - onshore and offshore. Brazil - onshore and offshore.\"],\n#>         BBOX[-59.87,-122.19,32.72,-25.28]],\n#>     ID[\"EPSG\",4674]]\n\n## Acessar a tabela de atributos\ngeo_vetor_rio_claro_tab <- sf::st_drop_geometry(geo_vetor_rio_claro)\ngeo_vetor_rio_claro_tab\n#>     code_muni name_muni code_state abbrev_state name_state code_region name_region\n#> 493   3543907 Rio Claro         35           SP  S√£o Paulo           3     Sudeste"},{"path":"cap15.html","id":"raster-2","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.7.2 Raster","text":"Da mesma forma, podemos acessar informa√ß√µes objetos raster chamando o nome objeto.Al√©m disso, podemos selecionar informa√ß√µes desse objeto com fun√ß√µes espec√≠ficas, tanto para RasterLayer, quanto para RasterBrick ou RasterStack como: classe, dimens√µes (n√∫mero de linhas, colunas e camadas), n√∫mero de camadas, n√∫mero de linhas, n√∫mero de colunas, n√∫mero de c√©lulas, resolu√ß√£o (largura e altura tamanho pixel), extens√£o (limites geoespaciais), sistema de refer√™ncia de coordenadas (CRS), nome das camadas e extrair os valores de todos os pixels.","code":"\n## Raster layer\ngeo_raster_srtm\n#> class      : RasterLayer \n#> dimensions : 6000, 6000, 3.6e+07  (nrow, ncol, ncell)\n#> resolution : 0.0008333333, 0.0008333333  (x, y)\n#> extent     : -50, -45, -25, -20  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : srtm_27_17.tif \n#> names      : srtm_27_17 \n#> values     : -32768, 32767  (min, max)\n## Classe\nclass(geo_raster_srtm)\n#> [1] \"RasterLayer\"\n#> attr(,\"package\")\n#> [1] \"raster\"\n\n## Dimens√µes\ndim(geo_raster_srtm)\n#> [1] 6000 6000    1\n\n## N√∫mero de camadas\nnlayers(geo_raster_srtm)\n#> [1] 1\n\n## N√∫mero de linhas\nnrow(geo_raster_srtm)\n#> [1] 6000\n\n## N√∫mero de colunas\nncol(geo_raster_srtm)\n#> [1] 6000\n\n## N√∫mero de c√©lulas\nncell(geo_raster_srtm)\n#> [1] 3.6e+07\n\n## Resolu√ß√£o\nres(geo_raster_srtm)\n#> [1] 0.0008333333 0.0008333333\n\n## Extens√£o\nextent(geo_raster_srtm)\n#> class      : Extent \n#> xmin       : -50 \n#> xmax       : -45 \n#> ymin       : -25 \n#> ymax       : -20\n\n## Proje√ß√£o ou CRS\nprojection(geo_raster_srtm)\n#> [1] \"+proj=longlat +datum=WGS84 +no_defs\"\n\n## Nomes\nnames(geo_raster_srtm)\n#> [1] \"srtm_27_17\"\n\n## Valores\ngetValues(geo_raster_srtm) %>% head\n#> [1] 382 379 379 379 379 383\nvalues(geo_raster_srtm) %>% head\n#> [1] 382 379 379 379 379 383\ngeo_raster_srtm[] %>% head\n#> [1] 382 379 379 379 379 383"},{"path":"cap15.html","id":"reproje√ß√£o-de-dados-geoespaciais","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.8 Reproje√ß√£o de dados geoespaciais","text":"Em algumas situa√ß√µes √© necess√°rio alterar o CRS de um objeto espacial para um novo CRS. reproje√ß√£o √© justamente transforma√ß√£o de coordenadas de um CRS para outro: geoespaciais (‚Äòlon/lat,‚Äô com unidades em graus de longitude e latitude) e projetados (normalmente com unidades de metros partir de um datum).Geralmente precisaremos fazer essa opera√ß√£o para transformar camadas vetoriais ou rasters para o mesmo CRS, de modo que possam ser exibidas conjuntamente, ou ainda que camadas possuem CRS projetado para realizar alguma opera√ß√£o espacial entre camadas, ou quando precisamos calcular √°reas, formatos ou dist√¢ncias, como m√©tricas de paisagem, por exemplo. Existe uma infinidade de proje√ß√µes e um excelente material de consulta √© o livro de Lapaine & Usery (2017).Podemos verificar o CRS de uma camada atrav√©s da fun√ß√£o sf::st_crs() ou raster::projection() e raster::crs(), ou ainda, saber se mesma possui um CRS geogr√°fico ou n√£o, com fun√ß√£o sf::st_is_longlat().J√° para reprojetar um objeto sf usamos fun√ß√£o sf::st_transform() e para um objeto raster usamos fun√ß√£o raster::projectRaster().fun√ß√µes sf::st_transform() e raster::projectRaster() possuem dois argumentos importantes: x que √© o objeto ser reprojetado e o crs que √© o CRS alvo. O argumento crs pode ser especificado de quatro maneiras: ) c√≥digo EPSG (por exemplo, 4326), ii) string PROJ4 (por exemplo, + proj = longlat + datum = WGS84 + no_defs), iii) string WKT, ou iv) objeto crs de outra camada, conforme retornado por sf::st_crs() ou raster::crs(). Esas informa√ß√µes de EPSG, PROJ4 e WKT podem ser acessadas nas bases: epsg.io e spatialreference.org.Dentre os poss√≠veis CRSs serem utilizados, alguns s√£o mais comuns para CRSs geoespaciais e projetados. Para CRSs geoespaciais, o mais comum para o mundo √© o World Geodetic System 1984 (WGS84), ou seja, geogr√°fico com datum WGS84. Para o Brasil, o CRS adotado √© o Sistema de Referencia Geoc√©ntrico para las Am√©ricas 2000 (SIRGAS 2000), ou seja, geogr√°fico com datum SIRGAS2000.Para CRSs projetados, essa escolha vai depender da extens√£o e localiza√ß√£o da √°rea de interesse globo terrestre. Aqui destacaremos os principais, para tr√™s escalas: global, regional e local. Para escala global, geralmente usa-se umas dessas proje√ß√µes, dependendo objetivo: ) Proje√ß√£o de Mollweide, ii) Proje√ß√£o de Winkel Tripel, iii) Proje√ß√£o de Eckert IV, iv) Proje√ß√£o Azimutal de Lambert. Para escala regional, como um hemisf√©rio, geralmente usa-se Proje√ß√£o C√¥nica de Albers. Por fim, para escala local, usa-se geralmente Proje√ß√£o Universal Transverse Mercator (UTM), um conjunto de CRSs que divide Terra em 60 cunhas longitudinais e 20 segmentos latitudinais, como pode ser visto neste link.Os principais CRSs s√£o descritos na Tabela 15.10.\nTabela 15.10: Principais CRSs utilizados.\n","code":"\n## Proje√ß√£o de vetores\nsf::st_crs(geo_vetor_rio_claro)\n#> Coordinate Reference System:\n#>   User input: SIRGAS 2000 \n#>   wkt:\n#> GEOGCRS[\"SIRGAS 2000\",\n#>     DATUM[\"Sistema de Referencia Geocentrico para las AmericaS 2000\",\n#>         ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n#>             LENGTHUNIT[\"metre\",1]]],\n#>     PRIMEM[\"Greenwich\",0,\n#>         ANGLEUNIT[\"degree\",0.0174532925199433]],\n#>     CS[ellipsoidal,2],\n#>         AXIS[\"geodetic latitude (Lat)\",north,\n#>             ORDER[1],\n#>             ANGLEUNIT[\"degree\",0.0174532925199433]],\n#>         AXIS[\"geodetic longitude (Lon)\",east,\n#>             ORDER[2],\n#>             ANGLEUNIT[\"degree\",0.0174532925199433]],\n#>     USAGE[\n#>         SCOPE[\"Horizontal component of 3D system.\"],\n#>         AREA[\"Latin America - Central America and South America - onshore and offshore. Brazil - onshore and offshore.\"],\n#>         BBOX[-59.87,-122.19,32.72,-25.28]],\n#>     ID[\"EPSG\",4674]]\n\n## Proje√ß√£o de raster\nraster::projection(geo_raster_srtm)\n#> [1] \"+proj=longlat +datum=WGS84 +no_defs\"\nraster::crs(geo_raster_srtm)\n#> Coordinate Reference System:\n#> Deprecated Proj.4 representation: +proj=longlat +datum=WGS84 +no_defs \n#> WKT2 2019 representation:\n#> GEOGCRS[\"WGS 84 (with axis order normalized for visualization)\",\n#>     DATUM[\"World Geodetic System 1984\",\n#>         ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n#>             LENGTHUNIT[\"metre\",1]]],\n#>     PRIMEM[\"Greenwich\",0,\n#>         ANGLEUNIT[\"degree\",0.0174532925199433]],\n#>     CS[ellipsoidal,2],\n#>         AXIS[\"geodetic longitude (Lon)\",east,\n#>             ORDER[1],\n#>             ANGLEUNIT[\"degree\",0.0174532925199433,\n#>                 ID[\"EPSG\",9122]]],\n#>         AXIS[\"geodetic latitude (Lat)\",north,\n#>             ORDER[2],\n#>             ANGLEUNIT[\"degree\",0.0174532925199433,\n#>                 ID[\"EPSG\",9122]]]]\n\n## Verificar se o CRS √© geogr√°fico\nsf::st_is_longlat(geo_vetor_rio_claro)\n#> [1] TRUE"},{"path":"cap15.html","id":"vetor-3","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.8.1 Vetor","text":"Como dissemos, para reprojetar um vetor, utilizamos fun√ß√£o sf::st_transform(), observando os argumentos x que √© camada ser reprojetada, e o crs que √© o CRS alvo.Vamos reprojetar o limite munic√≠pio de Rio Claro/SP CRS SIRGAS2000/geogr√°fico para o CRS projetado SIRGAS2000/UTM23S, com os efeitos da transforma√ß√£o podendo ser notados na Figura 15.16.\nFigura 15.16: Limites munic√≠pio de Rio Claro/SP com CRS SIRGAS2000/geogr√°fico e com CRS SIRGAS2000/UTM23S.\nPodemos ainda utilizar o formato proj4string argumento crs para fazer transforma√ß√£o. Vamos primeiramente plotar o mundo em WGS84/Geogr√°fico (Figura 15.17).\nFigura 15.17: Camada BIO01 para o mundo com CRS geogr√°fico e datum WGS84.\nAgora, reprojetaremos utilizando Proje√ß√£o de Mollweide (Figura 15.18).\nFigura 15.18: Camada BIO01 para o mundo com CRS Proje√ß√£o de Mollweide.\nOu ainda podemos utilizar Proje√ß√£o Azimutal de Lambert com alguns par√¢metros ajustados para centralizar proje√ß√£o Brasil (15.19).\nFigura 15.19: amada BIO01 para o mundo com CRS Proje√ß√£o Azimutal de Lambert centrado Brasil.\n","code":"\n## Converter CRS\ngeo_vetor_rio_claro_sirgas2000_utm23s <- sf::st_transform(x = geo_vetor_rio_claro, \n                                                          crs = 31983)\n## Plot\nplot(co110_sf[1], col = \"gray\",  main = \"WGS84/Geogr√°fio\", graticule = TRUE)\n## Proje√ß√£o de Mollweide \nco110_sf_moll <- sf::st_transform(x = co110_sf, crs = \"+proj=moll\")\n## Plot\nplot(co110_sf_moll[1], col = \"gray\", main = \"Proje√ß√£o de Mollweide\", graticule = TRUE)\n## Proje√ß√£o Azimutal de Lambert\nco110_sf_laea <- sf::st_transform(x = co110_sf, \n                                  crs = \"+proj=laea +x_0=0 +y_0=0 +lon_0=-50 +lat_0=0\")\n## Plot\nplot(co110_sf_laea[1], col = \"gray\", main = \"Proje√ß√£o Azimutal de Lambert\", graticule = TRUE)"},{"path":"cap15.html","id":"raster-3","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.8.2 Raster","text":"reproje√ß√£o de objetos raster n√£o √© uma tarefa t√£o simples quanto reproje√ß√£o de vetores. Em vetores, reproje√ß√£o altera coordenadas de cada v√©rtice. Entretanto, como rasters s√£o compostos de c√©lulas retangulares mesmo tamanho, reproje√ß√£o raster envolve cria√ß√£o de um novo objeto raster, envolvendo duas opera√ß√µes espaciais separadas: ) reproje√ß√£o vetorial dos centroides celulares para outro CRS (.e., muda posi√ß√£o e tamanho pixel) e, ii) c√°lculo de novos valores pixel por meio de reamostragem (.e., muda o valor pixel).fun√ß√£o raster::projectRaster() possui alguns par√¢metros que necessitam de algumas especifica√ß√µes. O argumento que √© o objeto raster de entrada que sofre reproje√ß√£o. O argumento √© um objeto raster qual todas propriedades dos CRSs, como extens√£o e resolu√ß√£o ser√£o associadas ao objeto raster indicado argumento . O argumento res permite ajustar resolu√ß√£o pixel de sa√≠da objeto raster reprojetado.O argumento crs aceita apenas defini√ß√µes de proj4string extensas de um CRS em vez de c√≥digos EPSG concisos. Contudo, √© poss√≠vel usar um c√≥digo EPSG em uma defini√ß√£o de proj4string com +init=epsg:EPSG. Por exemplo, pode-se usar defini√ß√£o +init=epsg:4326 para definir CRS para WGS84 (c√≥digo EPSG de 4326). biblioteca PROJ adiciona automaticamente o resto dos par√¢metros e os converte em +init=epsg:4326 +proj=longlat +datum=WGS84 + no_defs + ellps=WGS84 + towgs84=0,0,0.O argumento method permite escolher entre os m√©todos ngb (vizinho mais pr√≥ximo) ou biliniar (interpola√ß√£o bilinear), sendo o primeiro mais indicado para reproje√ß√£o de rasters categ√≥ricos, pois os valores estimados devem ser iguais aos raster original. O m√©todo ngb define cada novo valor de c√©lula para o valor da c√©lula mais pr√≥xima (centro) raster de entrada. J√° o m√©todo biliniar √© indicado para raster cont√≠nuos e calcula o valor da c√©lula de sa√≠da com base nas quatro c√©lulas mais pr√≥ximas raster original, sendo m√©dia ponderada da dist√¢ncia dos valores dessas quatro c√©lulas. Existem outras formas de interpola√ß√£o, mas n√£o abordaremos aqui.Aqui, vamos reprojetar os dados de eleva√ß√£o para Rio Claro/SP. Para que esse processo seja mais r√°pido, iremos antes ajustar extens√£o raster para o limite munic√≠pio usando fun√ß√£o raster::crop() (Figura 15.20). Essa fun√ß√£o √© melhor explicada na se√ß√£o de cortes e m√°scaras, mais adiante.\nFigura 15.20: Ajuste da extens√£o raster de eleva√ß√£o para o munic√≠pio de Rio Claro/SP.\nPrimeiramente, vamos reprojetar indicando uma proje√ß√£o e sem especificar o tamanho da c√©lula. Note que o tamanho da c√©lula vai se ajustar para valores diferentes, sendo portanto, pixels retangulares e n√£o quadrados.Agora vamos reprojetar especificando o tamanho da c√©lula (Figura 15.21). Dessa forma, todas c√©lulas ter√£o o mesmo, .e., quadrados de 90 metros.\nFigura 15.21: Reproje√ß√£o raster de eleva√ß√£o para SIRGAS2000/UTM23S especificado por um objeto e informando o tamanho da c√©lula.\nVamos tamb√©m reprojetar uma camada mundial da m√©dia de temperatura anual (BIO01), indicando o tamanho da c√©lula para 25.000 m (Figura 15.22).\nFigura 15.22: Reproje√ß√£o raster de m√©dia de temperatura anual (BIO01) para Proje√ß√£o de Mollweide informando o tamanho da c√©lula.\n","code":"\n## Ajuste do limite\ngeo_raster_srtm_rio_claro <- raster::crop(x = geo_raster_srtm, \n                                          y = geo_vetor_rio_claro)\ngeo_raster_srtm_rio_claro\n#> class      : RasterLayer \n#> dimensions : 370, 364, 134680  (nrow, ncol, ncell)\n#> resolution : 0.0008333333, 0.0008333333  (x, y)\n#> extent     : -47.765, -47.46167, -22.55167, -22.24333  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : memory\n#> names      : srtm_27_17 \n#> values     : 491, 985  (min, max)\n## Plot\nplot(geo_raster_srtm_rio_claro, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Reproje√ß√£o\ngeo_raster_srtm_rio_claro_sirgas2000_utm23s <- raster::projectRaster(\n    from = geo_raster_srtm_rio_claro, \n    crs = \"+init=epsg:31983\", \n    method = \"bilinear\")\ngeo_raster_srtm_rio_claro_sirgas2000_utm23s\n#> class      : RasterLayer \n#> dimensions : 386, 381, 147066  (nrow, ncol, ncell)\n#> resolution : 85.8, 92.3  (x, y)\n#> extent     : 214575.4, 247265.2, 7503009, 7538637  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=utm +zone=23 +south +ellps=GRS80 +units=m +no_defs \n#> source     : memory\n#> names      : srtm_27_17 \n#> values     : 491.6033, 980.4151  (min, max)\n## Reproje√ß√£o\ngeo_raster_srtm_rio_claro_sirgas2000_utm23s <- raster::projectRaster(\n    from = geo_raster_srtm_rio_claro, \n    crs = \"+init=epsg:31983\", \n    method = \"bilinear\", \n    res = 90)\ngeo_raster_srtm_rio_claro_sirgas2000_utm23s\n#> class      : RasterLayer \n#> dimensions : 396, 364, 144144  (nrow, ncol, ncell)\n#> resolution : 90, 90  (x, y)\n#> extent     : 214554.4, 247314.4, 7502985, 7538625  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=utm +zone=23 +south +ellps=GRS80 +units=m +no_defs \n#> source     : memory\n#> names      : srtm_27_17 \n#> values     : 493.2395, 986.686  (min, max)\n## Plot\nplot(geo_raster_srtm_rio_claro_sirgas2000_utm23s, \n     col = viridis::viridis(10))\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom,\n     col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Reproje√ß√£o\ngeo_raster_bioclim_moll <- raster::projectRaster(\n    from = geo_raster_bioclim[[1]], \n    crs = \"+proj=moll\",\n    res = 25000, \n    method = \"bilinear\")\ngeo_raster_bioclim_moll\n#> class      : RasterLayer \n#> dimensions : 732, 1453, 1063596  (nrow, ncol, ncell)\n#> resolution : 25000, 25000  (x, y)\n#> extent     : -18159905, 18165095, -9154952, 9145048  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=moll +lon_0=0 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs \n#> source     : memory\n#> names      : wc2.1_10m_bio_1 \n#> values     : -54.66752, 30.71805  (min, max)\n## Plot\nplot(geo_raster_bioclim_moll, col = viridis::viridis(10))\nplot(co110_sf_moll[1], col = NA, add = TRUE)"},{"path":"cap15.html","id":"principais-opera√ß√µes-com-dados-geoespaciais","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.9 Principais opera√ß√µes com dados geoespaciais","text":"Nesta se√ß√£o veremos principais fun√ß√µes para realizar opera√ß√µes com dados geoespaciais. Essas opera√ß√µes s√£o separadas conforme Lovelace et al. (2019) em: Opera√ß√µes de atributos, Opera√ß√µes espaciais, e Opera√ß√µes geom√©tricas.","code":""},{"path":"cap15.html","id":"opera√ß√µes-de-atributos","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.9.1 Opera√ß√µes de atributos","text":"S√£o modifica√ß√£o de objetos geoespaciais baseado em informa√ß√µes n√£o espaciais associadas dados geoespaciais, como tabela de atributos ou valores das c√©lulas e nome das camadas dos rasters.VetorAs principais opera√ß√µes de atributos vetoriais s√£o com respeito √† tabela de atributos, sendo principais: ) filtro, ii) jun√ß√£o, iii) agrega√ß√£o e iv) manipula√ß√£o da tabela de atributos. lista de poss√≠veis opera√ß√µes √© longa, dessa forma, apresentaremos algumas opera√ß√µes utilizando principais fun√ß√µes e listamos demais fun√ß√µes e suas opera√ß√µes, que depender√£o de objetivos espec√≠ficos.Quase todas opera√ß√µes ser√£o mesmas realizadas pelo pacote dplyr em uma tabela de dados (ver o Cap√≠tulo 5), sendo algumas opera√ß√µes espec√≠ficas para alterar apenas campos da tabela de atributos e outras que refletem opera√ß√µes nas fei√ß√µes, ou seja, alterar√£o atrav√©s da tabela de atributos caracter√≠sticas das fei√ß√µes. Essas fun√ß√µes e suas opera√ß√µes s√£o descritas com detalhes na Tabela (15.11).\nTabela 15.11: Principais fun√ß√µes para realizar opera√ß√µes de atributos e suas descri√ß√µes.\nPara exemplificar opera√ß√µes de atributos, vamos utilizar os dados de nascentes, hidrologia e cobertura da terra para o munic√≠pio de Rio Claro/SP.FiltroVamos iniciar opera√ß√µes fazendo o filtro de fei√ß√µes pela tabela de atributos, que permite selecionar fei√ß√µes pelos seus valores atribu√≠dos, utilizando fun√ß√£o dplyr::filter(). Aqui vamos selecionar fei√ß√µes de floresta mapa de cobertura da terra para Rio Claro/SP (Figura 15.23).\nFigura 15.23: Filtro da classe floresta para o mapeamento de cobertura da terra para o munic√≠pio de Rio Claro/SP.\nJun√ß√£oUma das fun√ß√µes mais √∫teis de opera√ß√µes de atributos √© jun√ß√£o, referida em ingl√™s como join, realizada atrav√©s das fun√ß√µes dplyr::*_join() (ver detalhes Cap√≠tulo 5). Nela, usamos uma coluna identificadora para atribuir dados de outra tabela de dados. Como exemplo, vamos criar uma tabela de dados com novos nomes das classes de cobertura da terra e atribuir esses novos nomes √† tabela de atributos objeto vetorial. √â fundamental destacar que para que essa fun√ß√£o funcione, precisamos de uma coluna identificadora dos valores para que jun√ß√£o seja poss√≠vel.Agrega√ß√£oOutra fun√ß√£o bastante √∫til √© agrega√ß√£o de atributos. Apesar de existir uma fun√ß√£o que realiza uni√£o de fei√ß√µes que veremos na pr√≥xima se√ß√£o, o uso conjunto das fun√ß√µes dplyr::group_by() e dplyr::summarise() realizam uma tarefa semelhante. Aqui vamos agregar nascentes para Rio Claro/SP, .e., juntar cada ponto que estava numa linha da tabela de atributos de modo que todos fiquem numa mesma linha, com o valor da quantidade de nascentes (Figura 15.24).\nFigura 15.24: Agrega√ß√£o e contagem das nascentes para o munic√≠pio de Rio Claro/SP.\nManipula√ß√£o da tabela de atributosPor fim, √© muito comum em an√°lises de softwares SIG cria√ß√£o ou atualiza√ß√£o dos valores de colunas na tabela de atributos. Aqui, podemos utilizar fun√ß√£o dplyr::mutate() para criar essas novas colunas, assim como atualizar os valores de colunas existentes. Em nosso exemplo, fazeremos uma composi√ß√£o das colunas CLASSE_USO e AREA_HA numa nova coluna chamada classe_area.Duas fun√ß√µes s√£o bastante interessantes de serem integradas junto √† manipula√ß√£o de tabelas de atributos. Elas calculam propriedades geom√©tricas num√©ricas dos vetores de linhas (comprimento) e pol√≠gonos (√°rea): sf::st_length() e sf::st_area(). Essas fun√ß√µes calculam essas propriedades em metros para comprimento e em metros quadrados para √°rea, independentemente CRS. Para tanto, vamos utilizar linhas de hidrografia e os pol√≠gonos de cobertura da terra para Rio Claro/SP, e atribuir esses valores √† tabela de atributos de ambos os objetos geoespaciais, utilizando em conjunto fun√ß√£o dplyr::mutate().RasterDevido √† estrutura espacial raster ser formada por uma ou mais superf√≠cies cont√≠nuas, manipula√ß√µes como subconjunto e outras opera√ß√µes em objetos raster funcionam de uma maneira diferente que em objetos vetoriais. Veremos aqui tr√™s principais: ) subconjunto de c√©lulas usando o operador [] ou subconjunto de camadas RasterStack ou RasterBrick utilizando os operadores [[]] e $, ii) renomear nomes das camadas, e iii) resumir informa√ß√µes de todos os pixels.SubconjuntoPodemos fazer um subconjunto de c√©lulas utilizando dentro dos operadores [] valores para indicar posi√ß√£o da linha e da coluna de um raster, ou ainda posi√ß√£o de uma c√©lula utilizando apenas um n√∫mero. Essas opera√ß√µes resultar√£o em valores diferentes para RasterLayer e RasterBrick ou RasterStack.Para selecionar uma camada de um RasterBrick ou RasterStack, podemos utilizar fun√ß√µes raster::subset() ou raster::raster() com o argumento layer indicando ordem ou o nome da camada, al√©m dos operadores [[]] e $ (Figura 15.25).\nFigura 15.25: Camada BIO01 selecionada pelas opera√ß√µes de subconjunto.\nRenomearPodemos ainda renomear camadas dos raster RasterLayer utilizando fun√ß√£o names().E essa opera√ß√£o tamb√©m funciona para RasterBrick e RasterStack.ResumirMuitas vezes queremos fazer c√°lculos para todos c√©lulas de um raster. Podemos resumir informa√ß√µes de todos os pixels fazendo c√°lculos simples com todos os pixels de cada camada com fun√ß√£o raster::cellStats(), sendo x o argumento objeto raster e stat o nome da fun√ß√£o resumo, como ‚Äúmean‚Äù ou ‚Äúsum.‚ÄùOu ainda, podemos analisar frequ√™ncia com que cada valor dos pixels ocorre, utilizando fun√ß√£o raster::freq().","code":"\n## Filtro\ngeo_vetor_cobertura_floresta <- geo_vetor_cobertura %>% \n    dplyr::filter(CLASSE_USO == \"forma√ß√£o florestal\")\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_cobertura_floresta$geometry, col = \"forestgreen\", add = TRUE)\n## Dados\ndados_classes <- tibble::tibble(\n    CLASSE_USO = geo_vetor_cobertura$CLASSE_USO, \n    classe = c(\"agua\", \"antropico\", \"edificado\", \"floresta\", \"silvicultura\"))\ndados_classes\n#> # A tibble: 5 √ó 2\n#>   CLASSE_USO         classe      \n#>   <chr>              <chr>       \n#> 1 √°gua               agua        \n#> 2 √°rea antropizada   antropico   \n#> 3 √°rea edificada     edificado   \n#> 4 forma√ß√£o florestal floresta    \n#> 5 silvicultura       silvicultura\n## Jun√ß√£o\ngeo_vetor_cobertura_classes <- dplyr::left_join(\n    x = geo_vetor_cobertura, \n    y = dados_classes, \n    by = \"CLASSE_USO\") %>% \n    sf::st_drop_geometry()\ngeo_vetor_cobertura_classes\n#>   GEOCODIGO MUNICIPIO UF CD_UF         CLASSE_USO   AREA_HA       classe\n#> 1   3543907 RIO CLARO SP    35               √°gua   357.027         agua\n#> 2   3543907 RIO CLARO SP    35   √°rea antropizada 37297.800    antropico\n#> 3   3543907 RIO CLARO SP    35     √°rea edificada  5078.330    edificado\n#> 4   3543907 RIO CLARO SP    35 forma√ß√£o florestal  7017.990     floresta\n#> 5   3543907 RIO CLARO SP    35       silvicultura   138.173 silvicultura\n## Agregar\ngeo_vetor_nascentes_n <- geo_vetor_nascentes %>% \n    dplyr::group_by(MUNICIPIO, HIDRO) %>% \n    dplyr::summarise(n = n())\ngeo_vetor_nascentes_n\n#> Simple feature collection with 1 feature and 3 fields\n#> Geometry type: MULTIPOINT\n#> Dimension:     XY\n#> Bounding box:  xmin: 217622.9 ymin: 7504132 xmax: 246367.4 ymax: 7537855\n#> Projected CRS: SIRGAS 2000 / UTM zone 23S\n#> # A tibble: 1 √ó 4\n#> # Groups:   MUNICIPIO [1]\n#>   MUNICIPIO HIDRO        n                                                                                  geometry\n#>   <chr>     <chr>    <int>                                                                          <MULTIPOINT [m]>\n#> 1 RIO CLARO nascente  1220 ((217622.9 7528315), (217836.5 7528103), (217988.9 7528203), (218288.9 7528237), (2183...\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, \n     col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_nascentes_n$geometry, pch = 20, \n     col = \"blue\", add = TRUE)\n## Criar coluna\ngeo_vetor_cobertura_cob_col_area <- geo_vetor_cobertura %>% \n    dplyr::mutate(classe_area = paste0(CLASSE_USO, \" (\", AREA_HA, \" ha)\")) %>% \n    sf::st_drop_geometry()\ngeo_vetor_cobertura_cob_col_area\n#>   GEOCODIGO MUNICIPIO UF CD_UF         CLASSE_USO   AREA_HA                     classe_area\n#> 1   3543907 RIO CLARO SP    35               √°gua   357.027               √°gua (357.027 ha)\n#> 2   3543907 RIO CLARO SP    35   √°rea antropizada 37297.800   √°rea antropizada (37297.8 ha)\n#> 3   3543907 RIO CLARO SP    35     √°rea edificada  5078.330     √°rea edificada (5078.33 ha)\n#> 4   3543907 RIO CLARO SP    35 forma√ß√£o florestal  7017.990 forma√ß√£o florestal (7017.99 ha)\n#> 5   3543907 RIO CLARO SP    35       silvicultura   138.173       silvicultura (138.173 ha)\n## Comprimento das linhas\ngeo_vetor_hidrografia_comp <- geo_vetor_hidrografia %>% \n    dplyr::mutate(comprimento = sf::st_length(.))\ngeo_vetor_hidrografia_comp\n#> Simple feature collection with 1 feature and 7 fields\n#> Geometry type: MULTILINESTRING\n#> Dimension:     XY\n#> Bounding box:  xmin: 215155.3 ymin: 7504132 xmax: 246367.4 ymax: 7537978\n#> Projected CRS: SIRGAS 2000 / UTM zone 23S\n#>   GEOCODIGO MUNICIPIO UF CD_UF                  HIDRO COMP_KM                       geometry comprimento\n#> 1   3543907 RIO CLARO SP    35 curso d'√°gua (0 - 10m) 1142.98 MULTILINESTRING ((231815.7 ... 1142981 [m]\n## √Årea dos pol√≠gonos\ngeo_vetor_cobertura_area <- geo_vetor_cobertura %>% \n    dplyr::mutate(area_m2 = sf::st_area(.))\ngeo_vetor_cobertura_area\n#> Simple feature collection with 5 features and 7 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: 215151.7 ymin: 7503723 xmax: 246582.4 ymax: 7537978\n#> Projected CRS: SIRGAS 2000 / UTM zone 23S\n#>   GEOCODIGO MUNICIPIO UF CD_UF         CLASSE_USO   AREA_HA                       geometry         area_m2\n#> 1   3543907 RIO CLARO SP    35               √°gua   357.027 MULTIPOLYGON (((235487.6 75...   3570267 [m^2]\n#> 2   3543907 RIO CLARO SP    35   √°rea antropizada 37297.800 MULTIPOLYGON (((232275 7504... 372978415 [m^2]\n#> 3   3543907 RIO CLARO SP    35     √°rea edificada  5078.330 MULTIPOLYGON (((233123.6 75...  50783283 [m^2]\n#> 4   3543907 RIO CLARO SP    35 forma√ß√£o florestal  7017.990 MULTIPOLYGON (((232355 7504...  70179895 [m^2]\n#> 5   3543907 RIO CLARO SP    35       silvicultura   138.173 MULTIPOLYGON (((243052.1 75...   1381726 [m^2]\n## Raster - linha 1 e columna 1\ngeo_raster_srtm[1, 1]\n#>     \n#> 382\n\n## Raster - c√©lula 1\ngeo_raster_srtm[1]\n#>     \n#> 382\n\n## Stack - linha 1 e columna 1\ngeo_raster_bioclim[1, 1]\n#>      wc2.1_10m_bio_1 wc2.1_10m_bio_10 wc2.1_10m_bio_11 wc2.1_10m_bio_12 wc2.1_10m_bio_13 wc2.1_10m_bio_14 wc2.1_10m_bio_15\n#> [1,]              NA               NA               NA               NA               NA               NA               NA\n#>      wc2.1_10m_bio_16 wc2.1_10m_bio_17 wc2.1_10m_bio_18 wc2.1_10m_bio_19 wc2.1_10m_bio_2 wc2.1_10m_bio_3 wc2.1_10m_bio_4\n#> [1,]               NA               NA               NA               NA              NA              NA              NA\n#>      wc2.1_10m_bio_5 wc2.1_10m_bio_6 wc2.1_10m_bio_7 wc2.1_10m_bio_8 wc2.1_10m_bio_9\n#> [1,]              NA              NA              NA              NA              NA\n\n## Stack - c√©lula 1\ngeo_raster_bioclim[1]\n#>      wc2.1_10m_bio_1 wc2.1_10m_bio_10 wc2.1_10m_bio_11 wc2.1_10m_bio_12 wc2.1_10m_bio_13 wc2.1_10m_bio_14 wc2.1_10m_bio_15\n#> [1,]              NA               NA               NA               NA               NA               NA               NA\n#>      wc2.1_10m_bio_16 wc2.1_10m_bio_17 wc2.1_10m_bio_18 wc2.1_10m_bio_19 wc2.1_10m_bio_2 wc2.1_10m_bio_3 wc2.1_10m_bio_4\n#> [1,]               NA               NA               NA               NA              NA              NA              NA\n#>      wc2.1_10m_bio_5 wc2.1_10m_bio_6 wc2.1_10m_bio_7 wc2.1_10m_bio_8 wc2.1_10m_bio_9\n#> [1,]              NA              NA              NA              NA              NA\n## Sele√ß√£o de camada num objeto stack utilizando a fun√ß√£o subset\ngeo_raster_bioclim_bio01 <- raster::subset(geo_raster_bioclim, \"wc2.1_10m_bio_1\")\ngeo_raster_bioclim_bio01\n#> class      : RasterLayer \n#> dimensions : 1080, 2160, 2332800  (nrow, ncol, ncell)\n#> resolution : 0.1666667, 0.1666667  (x, y)\n#> extent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : wc2.1_10m_bio_1.tif \n#> names      : wc2.1_10m_bio_1 \n#> values     : -54.72435, 30.98764  (min, max)\n\n## Sele√ß√£o de camada num objeto stack utilizando a fun√ß√£o raster\ngeo_raster_bioclim_bio01 <- raster::raster(geo_raster_bioclim, layer = 1)\ngeo_raster_bioclim_bio01\n#> class      : RasterLayer \n#> dimensions : 1080, 2160, 2332800  (nrow, ncol, ncell)\n#> resolution : 0.1666667, 0.1666667  (x, y)\n#> extent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : wc2.1_10m_bio_1.tif \n#> names      : wc2.1_10m_bio_1 \n#> values     : -54.72435, 30.98764  (min, max)\n\n## Sele√ß√£o de camada num objeto stack utilizando os operadores [[]] e o nome\ngeo_raster_bioclim_bio01 <- geo_raster_bioclim[[\"wc2.1_10m_bio_1\"]]\ngeo_raster_bioclim_bio01\n#> class      : RasterLayer \n#> dimensions : 1080, 2160, 2332800  (nrow, ncol, ncell)\n#> resolution : 0.1666667, 0.1666667  (x, y)\n#> extent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : wc2.1_10m_bio_1.tif \n#> names      : wc2.1_10m_bio_1 \n#> values     : -54.72435, 30.98764  (min, max)\n\n## Sele√ß√£o de camada num objeto stack utilizando os operadores [[]] e a posicao\ngeo_raster_bioclim_bio01 <- geo_raster_bioclim[[1]]\ngeo_raster_bioclim_bio01\n#> class      : RasterLayer \n#> dimensions : 1080, 2160, 2332800  (nrow, ncol, ncell)\n#> resolution : 0.1666667, 0.1666667  (x, y)\n#> extent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : wc2.1_10m_bio_1.tif \n#> names      : wc2.1_10m_bio_1 \n#> values     : -54.72435, 30.98764  (min, max)\n\n## Sele√ß√£o de camada num objeto stack utilizando o operador $\ngeo_raster_bioclim_bio01 <- geo_raster_bioclim$wc2.1_10m_bio_1\ngeo_raster_bioclim_bio01\n#> class      : RasterLayer \n#> dimensions : 1080, 2160, 2332800  (nrow, ncol, ncell)\n#> resolution : 0.1666667, 0.1666667  (x, y)\n#> extent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : wc2.1_10m_bio_1.tif \n#> names      : wc2.1_10m_bio_1 \n#> values     : -54.72435, 30.98764  (min, max)\n# Plot\nplot(geo_raster_bioclim_bio01, col = viridis::viridis(10))\n## Raster - nomes\nnames(geo_raster_srtm_rio_claro)\n#> [1] \"srtm_27_17\"\n\n## Raster - renomear\nnames(geo_raster_srtm_rio_claro) <- \"elevacao\"\n\n## Raster - nomes\nnames(geo_raster_srtm_rio_claro)\n#> [1] \"elevacao\"\n## Stack - nomes\nnames(geo_raster_bioclim)\n#>  [1] \"wc2.1_10m_bio_1\"  \"wc2.1_10m_bio_10\" \"wc2.1_10m_bio_11\" \"wc2.1_10m_bio_12\" \"wc2.1_10m_bio_13\" \"wc2.1_10m_bio_14\"\n#>  [7] \"wc2.1_10m_bio_15\" \"wc2.1_10m_bio_16\" \"wc2.1_10m_bio_17\" \"wc2.1_10m_bio_18\" \"wc2.1_10m_bio_19\" \"wc2.1_10m_bio_2\" \n#> [13] \"wc2.1_10m_bio_3\"  \"wc2.1_10m_bio_4\"  \"wc2.1_10m_bio_5\"  \"wc2.1_10m_bio_6\"  \"wc2.1_10m_bio_7\"  \"wc2.1_10m_bio_8\" \n#> [19] \"wc2.1_10m_bio_9\"\n\n## Stack - renomear\nnames(geo_raster_bioclim) <- c(\"bio01\", paste0(\"bio\", 10:19), paste0(\"bio0\", 2:9))\n\n## Stack - nomes\nnames(geo_raster_bioclim)\n#>  [1] \"bio01\" \"bio10\" \"bio11\" \"bio12\" \"bio13\" \"bio14\" \"bio15\" \"bio16\" \"bio17\" \"bio18\" \"bio19\" \"bio02\" \"bio03\" \"bio04\"\n#> [15] \"bio05\" \"bio06\" \"bio07\" \"bio08\" \"bio09\"\n## Raster - m√©dia de todas as c√©lulas de altitude\nraster::cellStats(x = geo_raster_srtm_rio_claro, stat = mean)\n#> [1] 625.8273\n\n## Stack - m√©dia de todas as c√©lulas de cada camada bioclim√°tica\nraster::cellStats(x = geo_raster_bioclim, stat = mean)\n#>       bio01       bio10       bio11       bio12       bio13       bio14       bio15       bio16       bio17       bio18 \n#>  -4.0378283   7.2035545 -13.8963286 550.0569022  93.4633916  15.3689993  74.7084151 241.6525005  55.4149542 156.4237816 \n#>       bio19       bio02       bio03       bio04       bio05       bio06       bio07       bio08       bio09 \n#> 108.8950626   9.9432120  34.5221528 880.1215546  13.9386423 -19.7938943  33.7325366  -0.9226276  -5.3774489\n## Raster - frequ√™ncia das c√©lulas\nraster::freq(x = geo_raster_srtm_rio_claro) %>% head()\n#>      value count\n#> [1,]   491     1\n#> [2,]   492     4\n#> [3,]   493     9\n#> [4,]   494    19\n#> [5,]   495    32\n#> [6,]   496    44\n\n## Stack - frequ√™ncia das c√©lulas\nraster::freq(x = geo_raster_bioclim[[1]]) %>% head()\n#>      value count\n#> [1,]   -55   319\n#> [2,]   -54  4529\n#> [3,]   -53  5778\n#> [4,]   -52  6128\n#> [5,]   -51  6090\n#> [6,]   -50  7892"},{"path":"cap15.html","id":"opera√ß√µes-espaciais","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.9.2 Opera√ß√µes espaciais","text":"opera√ß√µes espaciais s√£o modifica√ß√µes de objetos geoespaciais baseado em informa√ß√µes espaciais, como localiza√ß√£o e formato. Seria quase imposs√≠vel abordar todas opera√ß√µes realiz√°veis nesse cap√≠tulo, ent√£o demonstraremos principais para dados vetoriais e raster.VetorAs principais opera√ß√µes espaciais para dados vetoriais s√£o: ) filtro espacial, ii) jun√ß√£o espacial, iii) agrega√ß√£o espacial e iv) dist√¢ncia espacial. Apresentaremos essas opera√ß√µes utilizando principais fun√ß√µes utilizando os dados de nascentes, hidrologia e cobertura da terra para o munic√≠pio de Rio Claro/SP.Filtro espacialFiltros espaciais s√£o opera√ß√µes que realizam sele√ß√£o de fei√ß√µes espaciais entre dois objetos geoespaciais (x e y). Existe uma grande quantidade de fun√ß√µes para realizar filtros espaciais R, como podemos ver na Tabela (15.12). Essas fun√ß√µes verificam se cada fei√ß√£o em x mant√©m sua rela√ß√£o em y. Ao especificar o par√¢metro sparse = FALSE, fun√ß√µes retornam uma matriz l√≥gica (composta por TRUE e FALSE).\nTabela 15.12: Principais pacotes para composi√ß√£o de mapas R.\nEm nosso exemplo, utilizaremos fun√ß√£o sf::intersects() para filtrar nascentes dentro de floresta para Rio Claro/SP. Essa fun√ß√£o vai retornar resposta bin√°ria se nascentes est√£o (1) ou n√£o (empty) dentro dos pol√≠gonos de floresta.Podemos usar essa mesma fun√ß√£o em conjunto com fun√ß√£o dplyr::filter() para filtrar nascentes dentro de florestas, mas agora com o argumento sparse = FALSE para valores l√≥gicos funcionarem com o filtro.Ou ainda podemos utilizar o operador [] para realizar esse filtro, como podemos notar na Figura 15.26.\nFigura 15.26: Nascentes dentro de florestas munic√≠pio de Rio Claro/SP.\nEntretanto, muitas vezes queremos fazer o filtro de fei√ß√µes que est√£o fora de fei√ß√µes de outro objeto espacial. Para isso, podemos usar fun√ß√£o sf::st_disjoint() ou ainda utilizando o operador [], mas com o argumento op, nesse caso utilizando mesma fun√ß√£o sf::st_disjoint() como opera√ß√£o (Figura 15.27). Atentar o segundo vazio nesse filtro.\nFigura 15.27: Nascentes fora de florestas munic√≠pio de Rio Claro/SP.\nJun√ß√£o espacialOutra opera√ß√£o muito usada dentro de an√°lises espaciais √© jun√ß√£o espacial ou ingl√™s spatial join. ideia base √© muito semelhante com jun√ß√£o baseada em atributos, mas aqui atribuiremos o valor da tabela de atributos das fei√ß√µes de um objeto espacial y √†s fei√ß√µes que fazem intersec√ß√£o com um objeto espacial x, de modo que esses valores sejam armazenados na tabela de atributos primeiro objeto espacial.Para exemplificar, vamos atribuir os valores dos pol√≠gonos de cobertura da terra aos pontos de nascentes para Rio Claro/SP, fazendo um agrupamento pela tabela de atributos para permitir criar o mapa da Figura 15.28.\nFigura 15.28: Jun√ß√£o espacial da cobertura da terra para nascentes munic√≠pio de Rio Claro/SP.\nAgrega√ß√£o espacialMuitas vezes queremos contabilizar quantas fei√ß√µes ou agregar valores de fei√ß√µes para pol√≠gonos. Podemos realizar essa opera√ß√£o usando fun√ß√µes dplyr::group_by() e dplyr::summarise, ou utilizar fun√ß√£o aggregate(). Nesse exemplo, vamos contabilizar quantas nascentes h√° por pol√≠gono de cobertura da terra para o munic√≠pio de Rio Claro/SP (Figura 15.29).\nFigura 15.29: Agrega√ß√£o espacial contabilizando o n√∫mero de nascentes para cada classe de cobertura da terra munic√≠pio de Rio Claro/SP.\nDist√¢ncia espacialA dist√¢ncia espacial √© dist√¢ncia calculada em duas dimens√µes (2D) entre um objeto espacial x e y baseado CRS e para cada fei√ß√£o dos objetos geoespaciais. Para realizar esse c√°lculo, utilizamos fun√ß√£o sf::st_distance(). Em nosso exemplo, vamos calcular dist√¢ncia das nascentes at√© floresta mais pr√≥xima, e adicionando essa informa√ß√£o para cada ponto na tabela de atributos com fun√ß√£o dplyr::mutate(), para o munic√≠pio de Rio Claro/SP (Figura 15.30).\nFigura 15.30: Dist√¢ncia espacial das nascentes at√© o fragmento de floresta mais pr√≥xima munic√≠pio de Rio Claro/SP.\nRasterAs principais opera√ß√µes espaciais para dados raster podem ser classificas, segundo Lovelace et al. (2019), em: ) opera√ß√µes locais (por c√©lula), ii) opera√ß√µes focais (por bloco de m√∫ltiplas c√©lulas regulares - e.g.¬†3x3), iii) opera√ß√µes zonais (por bloco de m√∫ltiplas c√©lulas irregulares) e iv) opera√ß√µes globais (por um ou v√°rios rasters inteiros). Cada uma delas √© aplicada para objetivos e escalas espaciais espec√≠ficas. Para os exemplos desta se√ß√£o, utilizaremos o dado raster de eleva√ß√£o para o munic√≠pio de Rio Claro/SP.Opera√ß√µes locaisAs opera√ß√µes locais contemplam todas opera√ß√µes realizadas c√©lula c√©lula em uma ou v√°rias camadas de um objeto raster. √°lgebra de raster √© uma das mais comuns, simples e poderosas opera√ß√µes R envolvendo rasters. Com ela podemos fazer opera√ß√µes simples atrav√©s de operadores aritm√©ticos (soma, subtra√ß√£o, multiplica√ß√£o, divis√£o ou potencia√ß√£o) entre dois ou mais objetos raster, ou utilizar fun√ß√µes para alterar todos os valores dos pixels como, por exemplo, fun√ß√µes lo10() ou sqrt(), ou ainda fun√ß√£o raster::scale() para padronizar ou centralizar os valores dos rasters (Figura 15.31).\nFigura 15.31: Rasters de soma e log10 mapa de eleva√ß√£o para Rio Claro/SP.\nAl√©m das opera√ß√µes aritm√©ticas, √°lgebra de rasters tamb√©m permite opera√ß√µes l√≥gicas, como criar um raster (bin√°rio - composto por 1 quando opera√ß√£o l√≥gica √© verdadeira, e 0 quanto √© falsa). Em nosso caso, buscamos todos os pixels acima de 600 metros para o raster de eleva√ß√£o de Rio Claro/SP (Figura 15.32).\nFigura 15.32: Opera√ß√£o local l√≥gica mostrando todos os pixels acima de 600 metros de eleva√ß√£o para Rio Claro/SP.\nAl√©m dos operadores aritm√©ticos, tamb√©m podemos usar fun√ß√µes raster::calc() (uma camada) e raster::overlay() (duas ou mais camadas) para realizar opera√ß√µes em todas c√©lulas. Elas funcionam com cria√ß√£o de uma fun√ß√£o espec√≠fica atrav√©s da fun√ß√£o function() (Cap√≠tulo 4), para que esta seja aplicada em todas c√©lulas raster. Essas fun√ß√µes s√£o muito eficientes, portanto, s√£o prefer√≠veis para grandes conjuntos de dados raster. Exemplificaremos essa opera√ß√£o calculando o produto de todos os pixels por eles mesmos raster de eleva√ß√£o de Rio Claro/SP (Figura 15.33).\nFigura 15.33: Opera√ß√£o local de multiplica√ß√£o de todos os pixels por eles mesmos raster de eleva√ß√£o para Rio Claro/SP.\npredi√ß√£o de objetos raster (utilizando fun√ß√£o raster::predict()) √© outra aplica√ß√£o extremamente √∫til em opera√ß√µes locais, n√≥s veremos mais √† frente nesse cap√≠tulo. Essa fun√ß√£o possui basicamente dois argumentos: object que √© os rasters preditores e model com o modelo ajustado para o qual os valores ser√£o preditos com base nos valores dos rasters. partir da rela√ß√£o entre vari√°veis respostas (e.g, pontos espa√ßo, como ocorr√™ncia ou riqueza de esp√©cies), e vari√°veis preditoras (rasters cont√≠nuos de eleva√ß√£o, pH, precipita√ß√£o, temperatura, cobertura da terra ou classe de solo), criamos modelos usando fun√ß√µes como lm(), glm(), gam() ou uma t√©cnica de aprendizado de m√°quina, e fazemos predi√ß√µes espaciais aplicando os coeficientes estimados aos valores dos raster preditores (consulte od Cap√≠tulos 7 e 8).Por fim, reclassifica√ß√£o de rasters √© outra opera√ß√£o muito comum quando trabalhamos com rasters. Nela √© realizada classifica√ß√£o de intervalos de valores num√©ricos em grupos, e.g.¬†agrupar um modelo digital de eleva√ß√£o em classes de valores. fun√ß√£o que faz essa opera√ß√£o √© raster::reclassify(). Ela possui dois argumentos: x que √© o raster ser reclassificado, e o segundo rcl para o qual devemos construir uma matriz de reclassifica√ß√£o, onde primeira coluna √© extremidade inferior, segunda coluna √© extremidade superior, e terceira coluna representa o novo valor para os intervalos das colunas um e dois. Vamos reclassificar o raster de eleva√ß√£o de Rio Claro/SP para os intervalos 400‚Äì600, 600‚Äì800 e 800‚Äì1000 que s√£o reclassificados para os valores 1, 2 e 3, respectivamente (Figura 15.34).\nFigura 15.34: Opera√ß√£o local de reclassifica√ß√£o para tr√™s classes de eleva√ß√£o para Rio Claro/SP.\nOpera√ß√µes focaisAs opera√ß√µes focais levam em considera√ß√£o uma c√©lula central e seus vizinhos. vizinhan√ßa (tamb√©m chamada de janela m√≥vel - moving window) tipicamente √© composta de c√©lulas de 3 por 3 (c√©lula central e seus oito vizinhos), mas pode assumir outra forma. opera√ß√£o focal aplica uma fun√ß√£o de agrega√ß√£o todas c√©lulas dentro da vizinhan√ßa especificada, e usa sa√≠da correspondente como o novo valor para c√©lula central, e segue para pr√≥xima c√©lula central e seus vizinhos. Essa opera√ß√£o √© realizada atrav√©s da fun√ß√£o raster::focal(). O par√¢metro x especifica o raster de entrada, o par√¢metro w define janela m√≥vel por uma matriz cujos valores correspondem pesos, e por fim, o par√¢metro fun especifica fun√ß√£o que desejamos aplicar √†s c√©lulas, como min(), max(), sum(), mean(), sd() ou var(). Existem diversas aplica√ß√µes dessa opera√ß√£o para dados raster, como processamento de imagens de sat√©lite (ver mais em Wegmann et al. (2016)). Outra utilidade √© para o c√°lculo de caracter√≠sticas topogr√°ficas, como declividade, aspecto e dire√ß√µes de fluxo. Para calcular essas m√©tricas espec√≠ficas, podemos utilizar fun√ß√£o raster::terrain().Para nosso exemplo, vamos realizar o c√°lculo desvio padr√£o da eleva√ß√£o e m√©trica de aspecto (orienta√ß√£o da vertente) para o raster de eleva√ß√£o em Rio Claro/SP (Figura 15.35).\nFigura 15.35: C√°lculo desvio padr√£o da eleva√ß√£o para uma janela de 3x3 e aspecto para Rio Claro/SP.\nOpera√ß√µes zonaisAs opera√ß√µes zonais aplicam uma fun√ß√£o de agrega√ß√£o para v√°rias c√©lulas de um raster. Geralmente usa-se um segundo raster categ√≥rico para definir zonas, de modo que c√©lulas raster que definem zona n√£o precisam ser vizinhas, como na opera√ß√£o focal. O resultado de uma opera√ß√£o zonal √© uma tabela de resumo agrupada por zona, explicando porque essa opera√ß√£o tamb√©m √© conhecida como estat√≠stica zonal. Isso √© um contraste com opera√ß√µes focais que retornam um objeto raster.opera√ß√£o zonal √© realizada atrav√©s da fun√ß√£o raster::zonal(), que recebe de entrada x o raster cont√≠nuo, em z o raster categ√≥rico, e em fun fun√ß√£o que resumir√° c√©lulas. Em nosso exemplo, vamos calcular diversas medidas resumo da eleva√ß√£o com fun√ß√£o summary() para cada classe de eleva√ß√£o que criamos anteriormente.Opera√ß√µes globaisAs opera√ß√µes globais usam todo o conjunto de dados raster representando uma √∫nica zona. opera√ß√µes globais mais comuns s√£o estat√≠sticas descritivas para todos os pixels raster, utilizando fun√ß√£o raster::cellStats() ou raster::freq(), j√° vistas. Al√©m das estat√≠sticas descritivas, podemos gerar rasters de dist√¢ncia, que calcula dist√¢ncia de cada c√©lula uma ou um grupo c√©lulas-alvo espec√≠fica, utilizando fun√ß√£o raster::distance().Em nosso exemplo, vamos selecionar os pixels abaixo de 500 m raster de eleva√ß√£o e calcular Dist√¢ncia Euclidiana (Figura 15.36).\nFigura 15.36: Raster de dist√¢ncia Euclidiana dos pixels abaixo de 500 m de eleva√ß√£o para Rio Claro/SP.\n","code":"\n## Filtro espacial\nsf::st_intersects(x = geo_vetor_nascentes, y = geo_vetor_cobertura_floresta)\n#> Sparse geometry binary predicate list of length 1220, where the predicate was `intersects'\n#> first 10 elements:\n#>  1: 1\n#>  2: 1\n#>  3: (empty)\n#>  4: 1\n#>  5: (empty)\n#>  6: (empty)\n#>  7: (empty)\n#>  8: (empty)\n#>  9: 1\n#>  10: (empty)\n## Filtro espacial - interno\ngeo_vetor_nascentes_floresta_int <- geo_vetor_nascentes %>% \n    dplyr::filter(sf::st_intersects(x = ., y = geo_vetor_cobertura_floresta, sparse = FALSE))\n## Filtro espacial com [] - interno\ngeo_vetor_nascentes_floresta_int <- geo_vetor_nascentes[geo_vetor_cobertura_floresta, ]\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_cobertura_floresta$geometry, col = \"forestgreen\", add = TRUE)\nplot(geo_vetor_nascentes_floresta_int$geometry, col = \"blue\", pch = 20, cex = 1, add = TRUE)\n## Filtro espacial - externo\ngeo_vetor_nascentes_floresta_ext <- geo_vetor_nascentes %>% \n    dplyr::filter(sf::st_disjoint(x = ., y = geo_vetor_cobertura_floresta, sparse = FALSE))\n\n## Filtro espacial com [] - externo\ngeo_vetor_nascentes_floresta_ext <- geo_vetor_nascentes[geo_vetor_cobertura_floresta, , op = st_disjoint]\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_cobertura_floresta$geometry, col = \"forestgreen\", add = TRUE)\nplot(geo_vetor_nascentes_floresta_ext$geometry, col = \"steelblue\", pch = 20, cex = 1, add = TRUE)\n## Jun√ß√£o espacial\ngeo_vetor_nascentes_cob_jun <- geo_vetor_nascentes %>% \n    sf::st_join(x = ., y = geo_vetor_cobertura) %>% \n    dplyr::group_by(CLASSE_USO) %>% \n    dplyr::summarise(n = n())\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_nascentes_cob_jun[1], col = c(\"blue\", \"orange\", \"gray30\", \"forestgreen\", \"green\"),\n     pch = 20, add = TRUE)\nlegend(x = 209000, y = 7520000, pch = 15, cex = .7, pt.cex = 2.5, \n       legend = (geo_vetor_nascentes_cob_jun$CLASSE_USO), \n       col = c(\"blue\", \"orange\", \"gray30\", \"forestgreen\", \"green\"))\n## Agrega√ß√£o espacial\ngeo_vetor_cobertura_nas_agre <- geo_vetor_nascentes %>% \n    aggregate(x = ., by = geo_vetor_cobertura, FUN = length)\n## Plot\nplot(geo_vetor_cobertura_nas_agre[1], axes = TRUE, graticule = TRUE, main = NA)\n## Dist√¢ncia espacial\ngeo_vetor_nascentes_dist_flo <- geo_vetor_nascentes %>% \n    dplyr::mutate(dist_flo = sf::st_distance(geo_vetor_nascentes, geo_vetor_cobertura_floresta))\n## Plot\nplot(geo_vetor_nascentes_dist_flo[7], pch = 20, axes = TRUE, graticule = TRUE, main = NA)\n## Soma\ngeo_raster_srtm_rio_claro2 <- geo_raster_srtm_rio_claro + geo_raster_srtm_rio_claro\n\n## Log10\ngeo_raster_srtm_rio_claro_log10 <- log10(geo_raster_srtm_rio_claro)\n## Plot\nold_par <- par(mfrow = c(1, 2))\nplot(geo_raster_srtm_rio_claro2, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n\nplot(geo_raster_srtm_rio_claro_log10, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\npar(old_par)\n## Acima de 600\ngeo_raster_srtm_rio_claro_acima_600 <- geo_raster_srtm_rio_claro > 600\n## Plot\nplot(geo_raster_srtm_rio_claro_acima_600, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Produto dos pixel - calc\ngeo_raster_srtm_rio_claro_prod <- raster::calc(x = geo_raster_srtm_rio_claro, fun = function(x){x * x})\ngeo_raster_srtm_rio_claro_prod \n#> class      : RasterLayer \n#> dimensions : 370, 364, 134680  (nrow, ncol, ncell)\n#> resolution : 0.0008333333, 0.0008333333  (x, y)\n#> extent     : -47.765, -47.46167, -22.55167, -22.24333  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : memory\n#> names      : layer \n#> values     : 241081, 970225  (min, max)\n## Plot\nplot(geo_raster_srtm_rio_claro_prod, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Matriz de reclassifica√ß√£o\nrcl  <- matrix(c(400,600,1, \n                 600,800,2, \n                 800,1000,3), \n               ncol = 3, byrow = TRUE)\n\n## Reclassifi√ß√£o\ngeo_raster_srtm_rio_claro_rcl <- raster::reclassify(x = geo_raster_srtm_rio_claro, rcl = rcl)\n## Plot\nplot(geo_raster_srtm_rio_claro_rcl, col = viridis::viridis(3))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Janela m√≥vel - moving window\ngeo_raster_srtm_rio_claro_focal_sd <- raster::focal(\n    x = geo_raster_srtm_rio_claro, \n    w = matrix(data = 1, nrow = 3, ncol = 3), \n    fun = sd)\n\n## Declividade\ngeo_raster_srtm_rio_claro_asp <- raster::terrain(x = geo_raster_srtm_rio_claro, opt = \"aspect\")\n## Plot\nold_par <- par(mfrow = c(1, 2))\nplot(geo_raster_srtm_rio_claro_focal_sd, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n\nplot(geo_raster_srtm_rio_claro_asp, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\npar(old_par)\n## Estat√≠stica zonal\ngeo_raster_srtm_rio_claro_zonal <- data.frame(raster::zonal(geo_raster_srtm_rio_claro, geo_raster_srtm_rio_claro_rcl, fun = \"summary\"))\ncolnames(geo_raster_srtm_rio_claro_zonal) <- c(\"zona\", \"min\", \"1qt\", \"mediana\", \"media\", \"3qt\", \"max\")\ngeo_raster_srtm_rio_claro_zonal\n#>   zona min 1qt mediana    media 3qt max\n#> 1    1 491 552   574.0 567.5995 589 600\n#> 2    2 601 620   640.0 650.6829 670 800\n#> 3    3 801 817   832.5 834.2732 846 985\n## Dist√¢ncia euclidiana\ngeo_raster_srtm_rio_claro_abaixo_500 <- raster::calc(\n    x = geo_raster_srtm_rio_claro, \n    fun = function(x) ifelse(x < 500, 1, NA))\ngeo_raster_srtm_rio_claro_global_dist <- raster::distance(geo_raster_srtm_rio_claro_abaixo_500)\n## Plot\nplot(geo_raster_srtm_rio_claro_global_dist, col = viridis::viridis(10))\nplot(geo_raster_srtm_rio_claro_abaixo_500, add = TRUE, col = \"white\", legend = FALSE)\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)"},{"path":"cap15.html","id":"opera√ß√µes-geom√©tricas","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.9.3 Opera√ß√µes geom√©tricas","text":"opera√ß√µes geom√©tricas realizam modifica√ß√µes em objetos geoespaciais baseado na geometria vetor ou raster e na intera√ß√£o e convers√£o entre vetor-raster. opera√ß√µes geom√©tricas vetoriais podem ser un√°rias (funcionam em uma √∫nica geometria) ou bin√°rias (modificam uma geometria com base na forma de outra geometria). Ainda podemos fazer transforma√ß√µes para alterar os tipos vetores, que refletir√° se fei√ß√µes s√£o √∫nicas ou m√∫ltiplas, inclusive na tabela de atributos. opera√ß√µes geom√©tricas em rasters envolvem mudar posi√ß√£o, tamanho e n√∫mero dos pixels subjacentes e atribuir-lhes novos valores. Por fim, podemos ainda fazer opera√ß√µes de intera√ß√µes e convers√µes entre raster-vetor para ajustar rasters vetores, assim como converter um objeto espacial vetorial para raster e vice-versa.VetorComo dissemos, opera√ß√µes geom√©tricas em vetores criar√£o ou alterar geometria de objetos da classe sf, podendo fazer altera√ß√µes em √∫nica geometria (un√°rias): ) simplifica√ß√£o, ii) centroides, iii) pontos aleat√≥rios, iv) buffers, v) pol√≠gono convexo, vi) pol√≠gonos de Voronoi, vii) quadr√≠culas e hex√°gonos; ou modificar uma geometria com base na forma de outra geometria (bin√°rias), viii) uni√£o e ix) recortes; ou ainda fazer transforma√ß√µes de tipo de geometrias.Para exemplificar opera√ß√µes geom√©tricas com vetores, vamos utilizar os dados limite, nascentes, hidrologia e cobertura da terra para o munic√≠pio de Rio Claro/SP.Simplifica√ß√£oA simplifica√ß√£o possui o intuito de generalizar linhas ou pol√≠gonos, diminuindo assim suas complexidades em rela√ß√£o ao n√∫mero de v√©rtices. √â utilizada para representa√ß√£o em mapas menores ou mapas interativos ou ainda quando um objeto vetorial √© muito grande. fun√ß√£o utilizada √© sf::st_simplify(), que usa o argumento x para uma geometria de entrada e dTolerance para controlar o n√≠vel de generaliza√ß√£o nas unidades mapa. Em nosso exemplo, simplificaremos hidrografia de Rio Claro/SP (Figura 15.37).\nFigura 15.37: Simplifica√ß√£o da hidrografia para Rio Claro/SP.\nCentroidesA opera√ß√£o de centroides identifica o centro de objetos geoespaciais, geralmente o centro de massa das fei√ß√µes. √â utilizado para gerar um ponto simples para representa√ß√µes complexas ou para estimar dist√¢ncia entre pol√≠gonos utilizando esse centroide. Podemos calcul√°-los com fun√ß√£o sf::st_centroids() ou com fun√ß√£o sf::st_point_on_surface() para garantir que esses centroides caiam dentro das geometrias. Aqui calcularemos o centroide munic√≠pio de Rio Claro/SP (Figura 15.38).\nFigura 15.38: Centroide limite munic√≠pio de Rio Claro/SP.\nPontos aleat√≥riosPor vezes precisamos criar algum padr√£o aleat√≥rio dentro de um contexto espacial. Isso pode ser realizado de diversas formas. Uma delas √© cria√ß√£o de pontos aleat√≥rios dentro de um pol√≠gono. Podemos realizar essa opera√ß√£o com fun√ß√£o sf::st_sample(). Para essa fun√ß√£o, dois argumentos s√£o utilizados: x uma geometria de entrada e o size indicando o n√∫mero de pontos √† seres criados. Outro argumento bastante interessante √© o type, indicando o tipo de amostragem espacial (aleat√≥rio, regular ou triangular). Para nosso exemplo, vamos fixar amostragem utilizando fun√ß√£o set.seed() e sortear 30 pontos para o limite munic√≠pio de Rio Claro/SP (15.39). Para mais detalhes da fun√ß√£o set.seed(), consultar o Cap√≠tulo 4.\nFigura 15.39: Sorteio de 30 pontos aleat√≥rio para Rio Claro/SP.\nBufferBuffers s√£o pol√≠gonos que representam √°rea dentro de uma determinada dist√¢ncia de um elemento geom√©trico, independentemente de ser um ponto, linha ou pol√≠gono. O buffer √© comumente utilizado para an√°lise de dados geoespaciais, geralmente sendo entendio como uma unidade amostral, delimitando uma por√ß√£o entorno de algum elemento ou evento, como condi√ß√µes clim√°ticas ou da estrutura da paisagem para uma amostragem, ou caracter√≠sticas de cobertura da terra ao longo de um corpo d‚Äô√°gua, e.g., √Åreas de Preserva√ß√£o Permanente (APPs).fun√ß√£o utilizada para criar buffers √© sf::st_buffer(), que requer pelo menos dois argumentos: x uma geometria de entrada e o dist uma dist√¢ncia para o buffer, fornecido nas unidades CRS da geometria de entrada. Em nosso exemplo, vamos criar buffers circulares de 1000 metros para os 30 pontos aleat√≥rios criados anteriormente para o munic√≠pio de Rio Claro/SP (Figura 15.40).\nFigura 15.40: Buffers de 1000 metros para os 30 pontos aleat√≥rios munic√≠pio de Rio Claro/SP.\nPodemos ainda criar buffers quadrados acrescentando o argumento uendCapStyle = \"SQUARE\" (Figura 15.41).\nFigura 15.41: Buffers quadrados de 1000 metros para os 30 pontos aleat√≥rios munic√≠pio de Rio Claro/SP.\nPol√≠gono convexoUma an√°lise bastante comum, principalmente realizada pela IUCN, √© cria√ß√£o de pol√≠gonos convexos, para definir extens√£o de ocorr√™ncia de uma esp√©cie (Extent occurrence - EOO). Nesse sentido, essa opera√ß√£o ligar√° os pontos externos de um conjunto de pontos e cria um pol√≠gono partir deles. Podemos criar esse pol√≠gono com fun√ß√£o sf::st_convex_hull(). Um √∫nico passo que precisamos adiantar √© utilizar fun√ß√£o sf::st_union() para unir todos os pontos e criar um objeto sf MULTIPOINT, j√° iremos explicar com mais detalhes adiante. Vamos utilizar os pontos aleat√≥rios que criamos anteriormente para criar o pol√≠gono convexo (Figura 15.42).\nFigura 15.42: Pol√≠gono convexo para os 30 pontos criados aleatoriamente para Rio Claro/SP.\nPol√≠gonos de VoronoiUma outra forma de criar pol√≠gonos para resumir dados espaciais √© atrav√©s dos Pol√≠gonos de Voronoi ou Diagrama de Voronoi. Nele, pol√≠gonos irregulares s√£o criados partir da proximidade de pontos, de modo estimar uma √°rea de abrang√™ncia entorno dos mesmos (Okabe 2000). Esses pol√≠gonos podem ser criados com fun√ß√£o sf::st_voronoi(), mas precisamos novamente utilizar fun√ß√£o sf::st_union() para unir todos os pontos e criar um objeto sf tipo MULTIPOINT. Vamos utilizar os pontos aleat√≥rios que criamos anteriormente para criar o pol√≠gono de Voronoi (Figura 15.43).\nFigura 15.43: Pol√≠gonos de Voronoi para os 30 pontos criados aleatoriamente para Rio Claro/SP.\nQuadr√≠culas e hex√°gonosMuitas vezes precisamos criar unidades espaciais id√™nticas e igualmente espa√ßadas para resumir informa√ß√µes dispersas por toda nossa √°rea de estudo. Uma pr√°tica muito comum √© cria√ß√£o de um gride de pontos ou quadr√≠culas em toda √°rea de estudo, e depois utilizar essas geometrias para associar ou resumir informa√ß√µes espacializadas, como IUCN utiliza para an√°lise de √°rea de ocupa√ß√£o (occupancy - AOO). Al√©m das quadr√≠culas, uma outra geometria que se tornou bastante comum para finalidades descritas, √© cria√ß√£o de hex√°gonos, que al√©m de serem mais esteticamente atraentes, possuem uma explica√ß√£o matem√°tica de sua melhor funcionalidade para an√°lises espaciais em Ecologia (Birch, Oom, Beecham 2007).fun√ß√£o utilizada para criar esses grides √© sf::st_make_grid(), que requer pelo menos dois argumentos: x uma geometria de entrada e o cellsize indicando o tamanho gride ser criado, fornecido nas unidades CRS da geometria de entrada. H√° diversos outros argumentos, mas os mais importantes s√£o o square que definir√° se o gride ser√° de quadriculas ou de hex√°gonos, e o que definir√° se geraremos pol√≠gonos, cantos ou centroides.Em nosso exemplo, vamos criar quadr√≠culas e hex√°gonos de 2000 metros (.e.¬†4000000 metros quadrados) para o munic√≠pio de Rio Claro/SP (Figura 15.44 e Figura 15.45). Podemos ainda utilizar fun√ß√µes de filtros espaciais (Tabela 15.12) para definir como selecionaremos esses elementos para √°rea de estudo. Aqui utilizamos fun√ß√£o sf::st_intersects().\nFigura 15.44: Quadr√≠culas de 2000 metros de arestas e centroides para Rio Claro/SP.\n\nFigura 15.45: Hex√°gonos equivalentes quadr√≠culas de 2000 metros de arestas e centroides para Rio Claro/SP.\nUni√£o (‚Äúdissolver‚Äù)Como vimos, na agrega√ß√£o por atributos podemos dissolver geometrias de pol√≠gonos mesmo grupo pelos valores da tabela de atributos, onde, naquele exemplo, contabilizamos quantas nascentes haviam por pol√≠gono de cobertura da terra para o munic√≠pio de Rio Claro/SP (Figura 15.29).Nesta se√ß√£o, vamos utilizar fun√ß√£o sf::st_union() para unir diversas fei√ß√µes em uma s√≥, dissolvendo os limites entre elas. Vamos utilizar de exemplo os buffers que criamos partir dos 30 pontos aleat√≥rios (Figura 15.46).\nFigura 15.46: Uni√£o - dissolu√ß√£o - dos buffers criados partir de pontos aleat√≥rios para Rio Claro/SP.\nRecorte e apagar (‚Äúclipar‚Äù e ‚Äúerase‚Äù)O recorte realiza um subconjunto espacial envolvendo dois objetos geoespaciais. O recorte √© aplicado somente linhas e pol√≠gonos, ou seja, usaremos linhas e pol√≠gonos para recortar linhas ou pol√≠gonos. Esse recorte pode ser realizado de tr√™s formas: ) intersec√ß√£o (subconjunto das geometrias sobrepostas entre os dois objetos), ii) diferen√ßa (subconjunto das geometrias primeiro objeto sem sobreposi√ß√£o com o segundo objeto), e iii) diferen√ßa sim√©trica (apenas geometrias n√£o sobrepostas entre os dois objetos). Respectivamente para cada uma dessas opera√ß√µes temos fun√ß√µes espec√≠ficas: sf::st_intersection(), sf::st_difference() e sf::st_sym_difference().Para nosso exemplo, faremos o recorte da hidrografia em rela√ß√£o aos buffers criados e unidos para os 30 pontos aleat√≥rios em Rio Claro/SP. Primeiramente, fazeremos o recorte para dentro dos buffers com fun√ß√£o sf::st_intersection() (Figura 15.47).\nFigura 15.47: Recorte da hidrografia para dentro dos buffers dos 30 aleat√≥rios para Rio Claro/SP.\nPara nosso segundo exemplo, realizamos o recorte da hidrografia em rela√ß√£o aos buffers, mas agora para fora dos buffers utilizando fun√ß√£o sf::st_difference() (Figura 15.48), que seria semelhando opera√ß√£o de apagar (‚Äúerase‚Äù).\nFigura 15.48: Recorte da hidrografia para fora dos buffers dos 30 aleat√≥rios para Rio Claro/SP.\nTransforma√ß√µes de tipoEsse t√≥pico possui muitas funcionalidades, que s√£o exploradas t√≥pico ‚Äú5.2.7 Type transformations‚Äù de Lovelace et al. (2019). Aqui, nosso interesse principal √© em rela√ß√£o √† transforma√ß√£o dos tipos de objetos geoespaciais da classe sf: MULTIPOINT, MULTILINESTRING e MULTIPOLYGON, para POINT, LINESTRING e POLYGON. Muitas vezes fei√ß√µes de nossos objetos, .e., linhas da tabela de atributos est√£o agrupadas em apenas uma linha da tabela. Quando o objeto espacial est√° nesse formato, geralmente em alguma classe dessas (MULTIPOINT, MULTILINESTRING e MULTIPOLYGON), n√£o temos como realizar opera√ß√µes espaciais ou geom√©tricas para cada fei√ß√£o, e precisamos separ√°-las em linhas diferentes para que opera√ß√µes como o c√°lculo de comprimento ou √°rea seja poss√≠vel para cada fei√ß√£o.Dessa forma, podemos utilizar fun√ß√£o sf::st_cast() para fazer essas transforma√ß√µes e atribuir cada fei√ß√£o uma linha da tabela de atributos. Como exemplo, vamos separar os fragmentos de floresta e calcular √°rea para cada fei√ß√£o em hectares (Figura 15.49).\nFigura 15.49: Transforma√ß√£o vetor de florestas em POLYGON e c√°lculo da √°rea para cada fei√ß√£o para Rio Claro/SP.\nRasterAs opera√ß√µes geom√©tricas em rasters envolvem mudar posi√ß√£o, tamanho e n√∫mero dos pixels e atribuir novos valores, geralmente aumentando ou diminuindo o tamanho desses pixels. Essas opera√ß√µes permitem alinhar rasters de diversas fontes, fazendo com que compartilhem uma correspond√™ncia entre seus pixels, permitindo que eles sejam processados todos juntos, ou simplesmente permite realiza√ß√£o de an√°lises que demorariam muito, caso os rasters possuam um tamanho de pixel muito pequeno. üìù Importante \nEssas opera√ß√µes funcionam para tr√™s classes dos objetos raster: RasterLayer, RasterBrick e RasterStack.Para exemplificar opera√ß√µes geom√©tricas com rasters, vamos utilizar os dados de eleva√ß√£o para o munic√≠pio de Rio Claro/SP e bioclim√°ticos para o mundo.Agrega√ß√£oNa agrega√ß√£o de rasters, aumentaremos o tamanho dos pixels (diminuindo resolu√ß√£o), agregando os valores dos pixels em um pixel maior. Podemos realizar essa opera√ß√£o com fun√ß√£o raster::aggregate(), que possui tr√™s argumentos: x corresponde ao objeto raster de entrada, fact √© o fator de agrega√ß√£o e corresponde ao n√∫mero que definir√° o novo tamanho pixel (e.g.¬†se um raster tem resolu√ß√£o de 90 m, um fator de agrega√ß√£o de 10 far√° com o novo raster tenha resolu√ß√£o de 900 m), e fun √© fun√ß√£o utilizada para realizar agrega√ß√£o dos pixels (Figura 15.50).Em nosso exemplo, vamos aumentar o tamanho dos pixels para 900 metros raster de eleva√ß√£o para Rio Claro/SP.\nFigura 15.50: Agrega√ß√£o (aumento pixel para 900 metros) utilizando m√©dia para o raster de eleva√ß√£o para Rio Claro/SP.\nDesagrega√ß√£oDe modo contr√°rio, na desagrega√ß√£o de rasters, diminuiremos o tamanho dos pixels (aumentando resolu√ß√£o), preenchendo com novos valores. Podemos realizar essa opera√ß√£o com fun√ß√£o raster::desaggregate(), que assim como fun√ß√£o anterior, possui tr√™s argumentos: x corresponde ao objeto raster de entrada, fact √© o fator de desagrega√ß√£o e corresponde ao n√∫mero que definir√° o novo tamanho pixel (e.g.¬†se um raster tem resolu√ß√£o de 90 m, um fator de desagrega√ß√£o de 2 far√° com que o novo raster tenha resolu√ß√£o de 45 m), e method √© fun√ß√£o utilizada para realizar desagrega√ß√£o dos pixels (Figura 15.51).Nesse exemplo, vamos diminuir o tamanho dos pixels para 45 metros raster de eleva√ß√£o para Rio Claro/SP.\nFigura 15.51: Desagrega√ß√£o (diminui√ß√£o pixel para 45 metros) utilizando o m√©todo bilinear para o raster de eleva√ß√£o para Rio Claro/SP.\nAlinhamento de rastersMuitas vezes queremos ir al√©m de ajustar o tamanho pixel, ajustando tamb√©m extens√£o, n√∫mero e origem dos pixels para v√°rias camadas rasters, principalmente se precisamos criar objetos das classes RasterBrick ou RasterStack. Dessa forma, podemos utilizar fun√ß√£o raster::compareRaster() para comparar os rasters em rela√ß√£o extens√£o, n√∫mero de linhas e colunas, proje√ß√£o, resolu√ß√£o e origem (ou um subconjunto dessas compara√ß√µes).Podemos utilizar fun√ß√£o raster::resample() para fazer esse alinhamento, ou ainda fun√ß√£o gdalUtils::align_rasters(). Para primeira fun√ß√£o, os argumentos s√£o x para o raster de entrada, y para o raster de alinhamento e method para o m√©todo utilizado alinhamento. Para nosso exemplo, vamos ajustar uma camada bioclim√°tica (BIO01) √† camada de eleva√ß√£o para Rio Claro/SP (Figura 15.52).\nFigura 15.52: Reamostragem (alinhamento dos rasters) utilizando o m√©todo bilinear para alinhar o raster bioclim√°tico (BIO01) ao de eleva√ß√£o para Rio Claro/SP.\nIntera√ß√µes raster-vetorPodemos fazer opera√ß√µes da intera√ß√£o entre objetos vetoriais e raster, como ajustes da extens√£o e limite raster para vetores (corte e m√°scara), extra√ß√£o dos valores dos pixels para vetores (pontos, linhas e pol√≠gonos), e estat√≠sticas zonais dos valores dos pixels dos raster para um vetor (pol√≠gonos).Cortes e m√°scarasMuitas vezes precisamos ajustar o tamanho de um objeto raster uma √°rea menor de interesse, geralmente definido por um objeto vetorial. Para realizar essa opera√ß√£o, dispomos de duas fun√ß√µes: raster::crop() e raster::mask(). üìù Importante \n√â fundamental que ambos os objetos raster ser reduzido e o vetor como molde precisam estar mesmo CRS.fun√ß√£o raster::crop() ajusta o raster √† extens√£o vetor. Como exemplo, vamos retomar o raster de eleva√ß√£o original baixado e importado anteriormente (Figura 15.14). Primeiramente, vamos usar fun√ß√£o raster::crop() para ajustar esse raster √† extens√£o limite munic√≠pio de Rio Claro/SP (Figura 15.53).\nFigura 15.53: Ajuste da extens√£o raster de eleva√ß√£o para extens√£o de Rio Claro/SP.\nPara ajustar o raster ao limite munic√≠pio de Rio Claro/SP, vamos usar fun√ß√£o raster::mask(). √â importante notar que essa fun√ß√£o preenche com NAs os pixels que est√£o fora limite pol√≠gono e n√£o ajusta extens√£o (Figura 15.53).\nFigura 15.54: Ajuste raster de eleva√ß√£o para o limite de Rio Claro/SP.\nPara ajustar o raster √† extens√£o e ao limite munic√≠pio de Rio Claro/SP, precisamos utilizar conjuntamente fun√ß√µes raster::crop() e raster::mask() (Figura 15.55).\nFigura 15.55: Ajuste da extens√£o e limite raster de eleva√ß√£o para Rio Claro/SP.\nfun√ß√£o raster::mask() possui ainda um argumento chamado inverse, que cria uma m√°scara inversa ao limite, preenchendo com NA o pixels internos ao limite pol√≠gono, como podemos ver para o raster de eleva√ß√£o e o limite de Rio Claro/SP (Figura 15.56).\nFigura 15.56: Ajuste da extens√£o e limite externo raster de eleva√ß√£o para Rio Claro/SP.\nExtra√ß√£oA intera√ß√£o entre raster-vetor de extra√ß√£o √© o processo que identifica e retorna valores associados de pixels de um raster com base em um objeto vetorial. √â uma opera√ß√£o extremamente comum em an√°lises espaciais, principalmente para associar valores de raster ambientais (cont√≠nuos ou categ√≥ricos) pontos de ocorr√™ncia ou amostragem. Os valores retornados depender√£o tipo vetor (pontos, linhas ou pol√≠gonos) e de argumentos da fun√ß√£o raster::extract() que alteram o funcionamento da extra√ß√£o.Em nosso exemplo, vamos extrair os valores raster de eleva√ß√£o para nascentes munic√≠pio de Rio Claro/SP (Figura 15.57).\nFigura 15.57: Extra√ß√£o dos valores de eleva√ß√£o para nascentes de Rio Claro/SP.\nAl√©m da extra√ß√£o dos valores totais, podemos resumir os valores dos pixels com mesma opera√ß√£o de extra√ß√£o, utilizando ainda fun√ß√£o raster::extract(), mas utilizando uma outra fun√ß√£o para resumir os valores dos pixels para um pol√≠gono, opera√ß√£o tamb√©m denominada de estat√≠stica zonal (agora para vetores). J√° vimos que ela pode ser realizada entre rasters na se√ß√£o de opera√ß√µes zonais, mas aqui realizaremos para rasters e vetores.Para o exemplo, vamos calcular eleva√ß√£o m√©dia dos valores para os hex√°gonos que criamos para o limite de Rio Claro/SP( Figura 15.58).\nFigura 15.58: Extra√ß√£o dos valores de eleva√ß√£o e resumo pela m√©dia para os hex√°gonos de Rio Claro/SP.\nConvers√µes raster-vetorPor fim, podemos ainda fazer opera√ß√µes de convers√£o entre objetos vetoriais para raster e vice-versa. Nessas opera√ß√µes, podemos resumir ou transformar objetos vetoriais (pontos, linhas ou pol√≠gonos) para rasters, escolhendo um raster previamente existente, processo denominado rasteriza√ß√£o. Tamb√©m podemos realizar o processo inverso, .e., transformar o raster em um vetor, podendo esse vetor ser um gride pontos, linhas ou pol√≠gonos, opera√ß√£o chamada de vetoriza√ß√£o.Rasteriza√ß√£oA convers√£o de vetor para raster pode ser realizada de pontos, linhas ou pol√≠gonos para rasters. Nesse processo, podemos utilizar uma fun√ß√£o para resumir os dados pontuais para os pixels raster que criaremos. Para essa opera√ß√£o, podemos utilizar fun√ß√£o raster::rasterize(), com o argumento x sendo o vetor de pontos de entrada, y o raster base, field coluna ou campo da tabela de atributos objeto vetorial para os quais os valores ser√£o utilizados e fun fun√ß√£o utilizada para agrega√ß√£o dos dados.Aqui, vamos contabilizar quantidade de nascentes por pixel, utilizando como base o raster para o qual mudamos resolu√ß√£o para 900 metros (15.59).\nFigura 15.59: Rasteriza√ß√£o das nascentes, com opera√ß√£o de contabiliza√ß√£o de pontos para Rio Claro/SP.\nAl√©m de pontos, podemos tamb√©m rasterizar linhas. Aqui vamos contabilizar linhas da hidrografia simplificada para Rio Claro/SP (Figura 15.60).\nFigura 15.60: Rasteriza√ß√£o da hidrografia, com opera√ß√£o de contabiliza√ß√£o de linhas para Rio Claro/SP.\nPodemos ainda rasterizar pol√≠gonos, de modo que cada pixel raster ser criado receber√°o valor da tabela de atributos, ou uma an√°lise pelo vizinho mais pr√≥ximo caso de um campo categ√≥rico, como cobertura da terra, que tamb√©m vai depender da resolu√ß√£o raster base e tamanho da fei√ß√£o pol√≠gono. Para nosso exemplo, antes de criar o raster vamos transforma coluna de classe de cobertura da terra em factor (Figura 15.61). Entretanto, essa opera√ß√£o de rasteriza√ß√£o tende demorar muito caso de pol√≠gonos muito detalhados ou um raster com pixels muito pequenos, sendo que dois pacotes aceleram esse processamento (fasterize e gdalUtils), com suas respectivas fun√ß√µes: fasterize::fasterize() e gdalUtils::gdal_rasterize().\nFigura 15.61: Rasteriza√ß√£o da cobertura da terra para Rio Claro/SP.\nVetoriza√ß√£oA opera√ß√£o inversa √† rasteriza√ß√£o √© vetoriza√ß√£o, na qual convertemos um raster em um vetor, sendo que esse vetor receber√° os valores dos pixels. O vetor em quest√£o pode ser pontos (geralmente um gride de pontos), linhas (geralmente isolinhas ou linhas de contorno), ou pol√≠gonos (podendo esses pol√≠gonos ser ou n√£o dissolvidos pelos valores dos pixels). Existem fun√ß√µes espec√≠ficas para cada uma dessas convers√µes, sendo elas: raster::rasterToPoints(), raster::rasterToContour() e raster::rasterToPolygons(), respectivamente. Para √∫ltima fun√ß√£o, ainda dispomos de uma alternativa mais veloz spex::polygonize().Em nosso exemplo, vamos vetorizar o raster de eleva√ß√£o para Rio Claro/SP, criando um gride de pontos, sendo os pontos os centroides de cada pixels (Figura 15.62).\nFigura 15.62: Vetoriza√ß√£o raster de eleva√ß√£o criando um gride de pontos para Rio Claro/SP.\nNesse outro exemplo, vamos vetorizar o raster de eleva√ß√£o para Rio Claro/SP novamente, mas agora criando isolinhas 15.63).\nFigura 15.63: Vetoriza√ß√£o raster de eleva√ß√£o criando isolinhas para Rio Claro/SP.\nPor fim, vamos vetorizar o raster de cobertura da terra criado anteriormente para Rio Claro/SP, criando pol√≠gonos n√£o dissolvendo e dissolvidos 15.64).\nFigura 15.64: Vetoriza√ß√£o raster de cobertura da terra para Rio Claro/SP, n√£o dissolvendo e dissolvendos os pol√≠gonos gerados.\n","code":"\n## Simplifica√ß√£o\ngeo_vetor_hidrografia_simplificado <- sf::st_simplify(x = geo_vetor_hidrografia, dTolerance = 1000)\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_hidrografia$geometry, col = \"steelblue\", lwd = 2, add = TRUE)\nplot(geo_vetor_hidrografia_simplificado$geometry, col = adjustcolor(\"black\", .7), add = TRUE)\n## Centroides\ngeo_vetor_rio_claro_sirgas2000_utm23s_cent <- sf::st_centroid(geo_vetor_rio_claro_sirgas2000_utm23s)\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_cent$geom, cex = 3, pch = 20, add = TRUE)\n## Fixar amostragem\nset.seed(42)\n\n## Pontos aleat√≥rios\ngeo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios <- sf::st_sample(geo_vetor_rio_claro_sirgas2000_utm23s, size = 30)\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios, pch = 20, add = TRUE)\n## Buffer\ngeo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios_buffer <- sf::st_buffer(\n    x = geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios, dist = 1000)\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios_buffer, col = NA, lwd = 2, border = \"red\", add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios, pch = 20, cex = 1, add = TRUE)\n## Buffer\ngeo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios_buffer_quad <- sf::st_buffer(\n    x = geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios, dist = 1000, endCapStyle = \"SQUARE\")\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios_buffer_quad, col = NA, lwd = 2, border = \"red\", add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios, pch = 20, cex = 1, add = TRUE)\n## Pol√≠gono convexo\ngeo_vetor_rio_claro_sirgas2000_utm23s_convexo <- geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios %>% \n    sf::st_union() %>% \n    sf::st_convex_hull()\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_convexo, col = NA, lwd = 2, border = \"red\", add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios, pch = 20, cex = 1, add = TRUE)\n## Pol√≠gonos de Voronoi\ngeo_vetor_rio_claro_sirgas2000_utm23s_voronoi <- geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios %>% \n    sf::st_union() %>% \n    sf::st_voronoi()\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_voronoi, col = NA, lwd = 2, border = \"red\", add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios, pch = 20, cex = 1, add = TRUE)\n## Quadr√≠culas\ngeo_vetor_rio_claro_sirgas2000_utm23s_grid <- sf::st_make_grid(\n    x = geo_vetor_rio_claro_sirgas2000_utm23s, cellsize = 2000, what = \"polygons\") %>%\n    sf::st_as_sf() %>%\n    dplyr::filter(sf::st_intersects(x = ., y = geo_vetor_rio_claro_sirgas2000_utm23s, sparse = FALSE))\n\n## Centroides das quadr√≠culas\ngeo_vetor_rio_claro_sirgas2000_utm23s_grid_cent <- geo_vetor_rio_claro_sirgas2000_utm23s %>% \n    sf::st_make_grid(cellsize = 2000, what = \"centers\") %>%\n    sf::st_as_sf() %>%\n    dplyr::filter(sf::st_intersects(x = ., y = sf::st_union(geo_vetor_rio_claro_sirgas2000_utm23s_grid), sparse = FALSE))\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_grid, col = NA, border = \"red\", lwd = 2, add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_grid_cent, pch = 20, add = TRUE)\n## Hex√°gonos\ngeo_vetor_rio_claro_sirgas2000_utm23s_hex <- geo_vetor_rio_claro_sirgas2000_utm23s %>% \n    sf::st_make_grid(cellsize = 2000, square = FALSE) %>% \n    sf::st_as_sf() %>%\n    dplyr::filter(sf::st_intersects(x = ., \n                                    y = geo_vetor_rio_claro_sirgas2000_utm23s, \n                                    sparse = FALSE))\n\n## Centroides de hex√°gonos\ngeo_vetor_rio_claro_sirgas2000_utm23s_hex_cent <- geo_vetor_rio_claro_sirgas2000_utm23s %>% \n    sf::st_make_grid(cellsize = 2000, square = FALSE, what = \"centers\") %>% \n    sf::st_as_sf() %>% \n    dplyr::filter(sf::st_intersects(x = ., \n                                    y = sf::st_union(geo_vetor_rio_claro_sirgas2000_utm23s_hex),\n                                    sparse = FALSE))\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_hex, col = NA, border = \"red\", lwd = 2, add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_hex_cent, pch = 20, add = TRUE)\n## Uni√£o\ngeo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao <- sf::st_union(geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios_buffer)\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao, col = adjustcolor(\"blue\", .1), add = TRUE)\n## Recorte - intersec√ß√£o\ngeo_vetor_hidrografia_interseccao <- sf::st_intersection(x = geo_vetor_hidrografia, y = geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao)\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao, col = adjustcolor(\"blue\", .1), add = TRUE)\nplot(geo_vetor_hidrografia_interseccao$geometry, col = \"blue\", add = TRUE)\n## Recorte - diferen√ßa\ngeo_vetor_hidrografia_diferenca <- sf::st_difference(x = geo_vetor_hidrografia, y = geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao)\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao, col = adjustcolor(\"blue\", .1), add = TRUE)\nplot(geo_vetor_hidrografia_diferenca$geometry, col = \"blue\", add = TRUE)\n## Transforma√ß√£o de tipo\ngeo_vetor_cobertura_floresta_polygon <- geo_vetor_cobertura_floresta %>% \n    sf::st_cast(\"POLYGON\") %>% \n    dplyr::mutate(area_ha = sf::st_area(.)/1e4 %>% round(2))\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = \"gray\", main = NA, axes = TRUE, graticule = TRUE)\nplot(geo_vetor_cobertura_floresta_polygon[\"area_ha\"], col = viridis::viridis(100),  add = TRUE)\n## Agrega√ß√£o - aumentar o tamanho do pixel\ngeo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media <- raster::aggregate(x = geo_raster_srtm_rio_claro_sirgas2000_utm23s, fact = 10, fun = \"mean\")\ngeo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media\n#> class      : RasterLayer \n#> dimensions : 40, 37, 1480  (nrow, ncol, ncell)\n#> resolution : 900, 900  (x, y)\n#> extent     : 214554.4, 247854.4, 7502625, 7538625  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=utm +zone=23 +south +ellps=GRS80 +units=m +no_defs \n#> source     : memory\n#> names      : srtm_27_17 \n#> values     : 506.0024, 922.8709  (min, max)\n## Plot\nplot(geo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Desagrega√ß√£o - diminuir o tamanho do pixel\ngeo_raster_srtm_rio_claro_desg_bil <- raster::disaggregate(x = geo_raster_srtm_rio_claro_sirgas2000_utm23s, fact = 2, method = \"bilinear\")\ngeo_raster_srtm_rio_claro_desg_bil\n#> class      : RasterLayer \n#> dimensions : 792, 728, 576576  (nrow, ncol, ncell)\n#> resolution : 45, 45  (x, y)\n#> extent     : 214554.4, 247314.4, 7502985, 7538625  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=utm +zone=23 +south +ellps=GRS80 +units=m +no_defs \n#> source     : memory\n#> names      : srtm_27_17 \n#> values     : 493.7046, 986.5187  (min, max)\n## Plot\nplot(geo_raster_srtm_rio_claro_desg_bil, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Reamostragem\ngeo_raster_bioclim_rc <- raster::resample(x = geo_raster_bioclim$bio01, \n                                          y = geo_raster_srtm_rio_claro, \n                                          method = \"bilinear\")\ngeo_raster_bioclim_rc\n#> class      : RasterLayer \n#> dimensions : 370, 364, 134680  (nrow, ncol, ncell)\n#> resolution : 0.0008333333, 0.0008333333  (x, y)\n#> extent     : -47.765, -47.46167, -22.55167, -22.24333  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : memory\n#> names      : bio01 \n#> values     : 19.8383, 20.60492  (min, max)\n## Plot\nplot(geo_raster_bioclim, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Crop - adjuste da extens√£o\ngeo_raster_srtm_rio_claro_crop <- raster::crop(geo_raster_srtm, geo_vetor_rio_claro)\n## Plot\nplot(geo_raster_srtm_rio_claro_crop, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Mask - adjuste ao limite\ngeo_raster_srtm_rio_claro_mask <- raster::mask(geo_raster_srtm, geo_vetor_rio_claro)\n## Plot\nplot(geo_raster_srtm_rio_claro_mask, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Crop e mask - ajuste da extens√£o e do limite\ngeo_raster_srtm_rio_claro_crop_mask <- geo_raster_srtm %>% \n    raster::crop(geo_vetor_rio_claro) %>% \n    raster::mask(geo_vetor_rio_claro)\n## Plot\nplot(geo_raster_srtm_rio_claro_crop_mask, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Crop e mask inversa - ajuste da extens√£o e do limite inverso\ngeo_raster_srtm_rio_claro_crop_mask_inv <- geo_raster_srtm %>% \n    raster::crop(geo_vetor_rio_claro) %>% \n    raster::mask(geo_vetor_rio_claro, inverse = TRUE)\n## Plot\nplot(geo_raster_srtm_rio_claro_crop_mask_inv, col = viridis::viridis(10))\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Extra√ß√£o\ngeo_vetor_nascentes_ele <- geo_vetor_nascentes %>% \n    dplyr::mutate(elev = raster::extract(x = geo_raster_srtm_rio_claro_sirgas2000_utm23s, y = .))\n## Plot\nplot(geo_vetor_nascentes_ele[\"elev\"], \n     pch = 20, main = NA, axes = TRUE, graticule = TRUE)\n## Extra√ß√£o - estat√≠stica por zonas\ngeo_vetor_rio_claro_sirgas2000_utm23s_hex_alt <- geo_vetor_rio_claro_sirgas2000_utm23s_hex %>% \n    dplyr::mutate(elev_mean = raster::extract(x = geo_raster_srtm_rio_claro_sirgas2000_utm23s, \n                                              y = geo_vetor_rio_claro_sirgas2000_utm23s_hex, \n                                              fun = mean, \n                                              na.rm = TRUE))\n## Plot\nplot(geo_vetor_rio_claro_sirgas2000_utm23s_hex_alt[\"elev_mean\"], \n     pch = 20, main = NA, axes = TRUE, graticule = TRUE)\n## Rasterizar pontos\ngeo_vetor_nascentes_rasterizacao <- raster::rasterize(x = geo_vetor_nascentes, y = geo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media, field = 1, fun = \"count\")\n## Plot\nplot(geo_vetor_nascentes_rasterizacao, col = viridis::viridis(10))\nplot(geo_vetor_nascentes$geometry, pch = 20, cex = .5, col = adjustcolor(\"gray\", .5), add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Rasterizar linhas\ngeo_vetor_hidrografia_rasterizacao <- raster::rasterize(\n    x = geo_vetor_hidrografia_simplificado,\n    y = geo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media,\n    field = 1, fun = \"count\")\n## Plot\nplot(geo_vetor_hidrografia_rasterizacao, col = viridis::viridis(10))\nplot(geo_vetor_hidrografia_simplificado$geom, col = \"gray\", add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Rasterizar pol√≠gonos\ngeo_vetor_cobertura_rasterizacao <- geo_vetor_cobertura %>% \n    dplyr::mutate(classe = as.factor(CLASSE_USO)) %>% \n    raster::rasterize(x = ., y = geo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media, field = \"classe\")\n## Plot\nplot(geo_vetor_cobertura_rasterizacao, col = viridis::viridis(10))\nplot(geo_vetor_cobertura$geom, add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Vetoriza√ß√£o de pontos\ngeo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media_pontos <- raster::rasterToPoints(geo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media, spatial = TRUE) %>% \n    sf::st_as_sf()\n## Plot\nplot(geo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media, \n     col = viridis::viridis(10, alpha = .8))\nplot(geo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media_pontos, \n     pch = 20, cex = .7, main = FALSE, add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, col = NA, \n     border = \"red\", lwd = 2, add = TRUE)\n## Vetoriza√ß√£o de linhas\ngeo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media_linhas <- raster::rasterToContour(\n    x = geo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media) %>% \n    sf::st_as_sf()\n## Plot\nplot(geo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media,\n     col = viridis::viridis(10, alpha = .8))\ncontour(geo_raster_srtm_rio_claro_sirgas2000_utm23s_agre_media, \n        labcex = 1, main = FALSE, add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, \n     col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Vetoriza√ß√£o de pol√≠gonos\ngeo_vetor_cobertura_rasterizacao_poligonos <- raster::rasterToPolygons(geo_vetor_cobertura_rasterizacao) %>%\n    sf::st_as_sf()\n\n## Vetoriza√ß√£o de pol√≠gonos dissolvendo\ngeo_vetor_cobertura_rasterizacao_poligonos_dissolvidos <- raster::rasterToPolygons(geo_vetor_cobertura_rasterizacao, dissolve = TRUE) %>% \n    sf::st_as_sf()\n## Plot\nold_par <- par(mfrow = c(1, 2))\nplot(geo_vetor_cobertura_rasterizacao, col = viridis::viridis(10))\nplot(geo_vetor_cobertura_rasterizacao_poligonos$geometry, \n     col = NA, border = \"gray\", lwd = 1, main = FALSE, add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, \n     col = NA, border = \"red\", lwd = 2, add = TRUE)\n\nplot(geo_vetor_cobertura_rasterizacao, col = viridis::viridis(10))\nplot(geo_vetor_cobertura_rasterizacao_poligonos_dissolvidos$geometry, \n     col = NA, border = \"gray\", lwd = 1, main = FALSE, add = TRUE)\nplot(geo_vetor_rio_claro_sirgas2000_utm23s$geom, \n     col = NA, border = \"red\", lwd = 2, add = TRUE)\npar(old_par)"},{"path":"cap15.html","id":"visualiza√ß√£o-de-dados-geoespaciais","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.10 Visualiza√ß√£o de dados geoespaciais","text":"Um dos pontos finais de toda an√°lise envolvendo manipula√ß√£o de dados geoespaciais ser√° apresenta√ß√£o de um mapa com informa√ß√µes de interesse geoespacializadas. Mas antes, √© necess√°rio ter conhecimento de alguns dos elementos principais para composi√ß√£o de um mapa relativamente bem informativo. Al√©m disso, o R nos permite criar tipos diferentes de mapas: est√°ticos, animados e interativos. Os mais comuns s√£o os est√°ticos, mas podemos por vezes melhorar apresenta√ß√£o dos dados geoespaciais criando mapas animados e/ou interativos, com o aux√≠lio de p√°ginas web. Por fim, veremos melhores formas de exportar mapas para diferentes formatos.","code":""},{"path":"cap15.html","id":"principais-elementos-de-um-mapa","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.10.1 Principais elementos de um mapa","text":"Um mapa pode ser composto de v√°rios elementos, tendo estes o intuito de auxiliar visualiza√ß√£o e entendimento de seu conte√∫do. Apesar disso, nem todos os elementos necessitam estar presentes em todos os layouts de mapas, sendo que os mesmos devem atendem √† necessidade das representa√ß√µes, podendo ser muitas vezes omitidos ou outros podem ser acrescentados.Os principais elementos de um mapa geralmente s√£o compostos por:Mapa principal (ocupando quase toda √°rea da figura)Mapa secund√°rio (geralmente muito menor que o mapa principal e com o intuito de mostrar localiza√ß√£o mapa principal num contexto mais amplo, como pa√≠s ou continente)T√≠tulo (para resumir o intuito mapa)Legenda (apresentando informa√ß√µes detalhadas das classes ou escala de valores, geralmente identificando cores e/ou texturas),Barra de escala (representando quantas unidades mapa representam mundo real)Indicador de orienta√ß√£o (Norte) (indicando o norte geogr√°fico, podendo ser representado por uma flecha, b√∫ssola ou compasso)Gride de coordenadas (coordenadas presentes nas laterais)Descri√ß√£o CRS (indicando qual o CRS)Informa√ß√µes de origem (informa√ß√µes sobre fonte dos dados representados mapa)Al√©m de outros elementos auxiliares (como elementos textuais e figuras extras)Podemos visualizar todos esses elementos resumidos na Figura 15.65.\nFigura 15.65: Principais elementos de um mapa.\n","code":""},{"path":"cap15.html","id":"principais-pacotes-para-a-composi√ß√£o-de-mapas","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.10.2 Principais pacotes para a composi√ß√£o de mapas","text":"H√° uma grande quantidade de pacotes para composi√ß√£o de mapas R. Aqui listamos os principais (Tabela 15.13).\nTabela 15.13: Principais pacotes para composi√ß√£o de mapas R.\n","code":""},{"path":"cap15.html","id":"mapas-est√°ticos","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.10.3 Mapas est√°ticos","text":"Mapas est√°ticos s√£o mapas simples e fixos para visualiza√ß√£o de dados, sendo o tipo mais comum de sa√≠da visual. in√≠cio da composi√ß√£o de mapas R, esse era o √∫nico tipo de mapa que linguagem permitia produzir, principalmente utilizando o pacote sp (E. J. Pebesma Bivand 2005). entanto, com o advento de ferramentas de visualiza√ß√£o din√¢micas R, como componentes HTML, os mapas puderam ser compostos de forma din√¢mica (animados e interativos).Neste t√≥pico abordaremos fun√ß√µes simples para composi√ß√£o de mapas est√°ticos, como o plot(), al√©m de pacotes para composi√ß√£o de mapas mais elaborados, como os pacotes ggplot2 (Wickham et al. 2020) e tmap (Tennekes 2021).Fun√ß√£o plot()fun√ß√£o gen√©rica plot() √© maneira mais r√°pida de compor mapas est√°ticos utilizando objetos geoespaciais vetoriais e raster, funcionando para ambos os pacotes que apresentamos anteriormente (sf e raster). Apesar da simplicidade, essa fun√ß√£o geralmente tende criar mapas com relativa velocidade, nos auxiliando principalmente em fases iniciais de desenvolvimento de um projeto. Essa fun√ß√£o oferece dezenas de argumentos em Base R, permitindo alguns ajustes limitados, com resultados bastante interessantes.Como dito anteriormente, fun√ß√£o plot() vai funcionar diferentemente dependendo da classe objeto geoespacial. Para objetos geoespaciais sf, fun√ß√£o vai plotar um mapa para cada coluna da tabela de atributos. Vamos usar de exemplo nosso mapa de biomas mostrado com os principais elementos de um mapa, podendo inclusive selecionar apenas coluna de caracter√≠sticas geoespaciais (geom).Primeiramente, vamos fazer o download dos dados de limites de biomas, retirando os sistemas costeiros, usando o pacote geobr (Pereira Goncalves 2021).Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.Agora, quando utilizamos fun√ß√£o plot() para um objeto da classe sf, temos os tr√™s mapas, cada um indicando uma coluna da tabela de atritos (Figura 15.66).\nFigura 15.66: Mapa feito com fun√ß√£o plot() de um objeto sf para os Biomas Brasil.\nSelecionando colunas desse objeto, podemos escolher informa√ß√£o que queremos plotar, por exemplo, apenas geometria geom. Al√©m disso, podemos acrescentar os argumentos col para colorir e main para o t√≠tulo, al√©m dos argumentos axes e graticule para adicionar coordenadas e quadr√≠culas, respectivamente. legenda pode ser adicionada com fun√ß√£o legend() (Figura 15.67).\nFigura 15.67: Mapa feito com fun√ß√£o plot() de um objeto vetor.\nPara classe dos objetos geoespaciais raster, fun√ß√£o plot() vai plotar um mapa para o tipo RasterLayer e quantos mapas houverem objeto e couberem espa√ßo de plot para RasterBrick e RasterStack. Al√©m disso, para essas classes objeto raster, essa fun√ß√£o prov√™ tamb√©m uma legenda e uma escala de cores autom√°tica (terrain). Vamos fazer o mapa da camada raster de eleva√ß√£o para o limite munic√≠pio de Rio Claro/SP (Figura 15.68).\nFigura 15.68: Mapa feito com fun√ß√£o plot() de um objeto raster com uma camada.\nAgora vamos plotar objetos da classe RasterStack, alterando cor para viridis, usando fun√ß√£o viridis::viridis() pacote hom√¥nimo. Vamos fazer o mapa de duas camadas raster bioclim√°ticas para o mundo (Figura 15.69).\nFigura 15.69: Mapa feito com fun√ß√£o plot() de um objeto raster com v√°rias camadas.\nPara exportar esses mapas podemos utilizar fun√ß√µes png() ou pdf(), indicando os argumentos para ter configura√ß√µes que desejamos, e finalizando com fun√ß√£o dev.(). Vamos exportar, t√≠tulo de exemplo, √∫ltima figura (mais detalhes Cap√≠tulo 6).Pacotes ggplot2 e ggspatialComo discutimos Cap√≠tulo 6 sobre gr√°ficos, o pacote ggplot2 utiliza gram√°tica de gr√°ficos para composi√ß√£o de figuras R (Wilkinson Wills 2005; Wickham 2016). Para cada classe de objeto geogr√°fico h√° fun√ß√µes espec√≠ficas para os dados: para objetos sf geom_sf() e para objetos raster geom_raster() e geom_tile().Al√©m pacote ggplot2, podemos utilizar o pacote ggspatial para acrescentar elementos geoespaciais como barra de escala e o indicador de orienta√ß√£o (Norte), atrav√©s das fun√ß√µes annotation_scale() e annotation_north_arrow(), respectivamente, al√©m de outras fun√ß√µes espec√≠ficas que n√£o abordaremos nesta se√ß√£o.estrutura de composi√ß√£o das fun√ß√µes pacote ggplot2 vai funcionar parecido com estrutura√ß√£o de gr√°ficos j√° vista Cap√≠tulo 6, de modo que cada fun√ß√£o iremos utilizando o sinal de + para acrescentar outra camada. Indicaremos os dados com fun√ß√£o ggplot() e coluna da tabela de atributos que queremos representar com fun√ß√£o aes(). Em seguida, utilizamos fun√ß√£o geom_sf() para indicar que trata-se de um objeto sf.Al√©m dessas fun√ß√µes, podemos ainda fazer altera√ß√µes nos mapas atrav√©s das fun√ß√µes: scale_*() que vai alterar caracter√≠sticas indicadas em aes(), coord_*() que vai alterar constru√ß√£o mapa em rela√ß√£o √†s coordenadas, facet_*() que altera disposi√ß√£o de v√°rios mapas, e theme_*() e theme() que alterar√£o caracter√≠sticas relacionadas ao tema, como cores de fundo, fontes e legenda. Podemos ainda utilizar fun√ß√µes annotate() para adicionar textos e labs() para alterar o texto t√≠tulo, legenda e eixos.Vamos demonstrar esse funcionamento para compor o mapa de geo_vetor_biomas, apresentado in√≠cio desta se√ß√£o (Figura 15.70).\nFigura 15.70: Mapa de Biomas Brasil com o pacote ggplot2.\nPara objetos raster, o uso pacote ggplot2 para compor mapas requer um passo preliminar. Primeiramente, vamos criar um data frame com os dados raster, com linhas sendo os pixels e colunas sendo coordenadas centrais da longitude e latitude, al√©m dos valores de cada camada em cada coluna. Esse passo pode ser realizado com fun√ß√£o raster::rasterToPoints().Uma vez que temos esses dados organizados, podemos utilizar fun√ß√µes ggplot() para indicar o data frame, e colunas com fun√ß√£o aes(). Em seguida, utilizamos fun√ß√£o geom_raster() para indicar que trata-se de um objeto raster. Al√©m dessas fun√ß√µes, podemos ainda utilizar demais fun√ß√µes para alterar caracter√≠sticas mapa, como comentamos acima. Entretanto, devemos nos atentar para fun√ß√£o coord_*() e escolher aquela que vai fazer constru√ß√£o mapa em rela√ß√£o √† coordenadas e resolu√ß√£o das c√©lulas.Como exemplo, vamos compor o mapa de eleva√ß√£o para Rio Claro/SP, adicionando tamb√©m o limite munic√≠pio (Figura 15.71).\nFigura 15.71: Mapa raster com o pacote ggplot2.\nPara exportar mapas criados com o pacote ggplot2, podemos utilizar fun√ß√£o ggplot2::ggsave(), indicando os argumentos para ter configura√ß√µes que desejamos. Vamos exportar, t√≠tulo de exemplo, √∫ltima figura.Pacote tmapO pacote tmap √© um pacote direcionado √† cria√ß√£o de mapas tem√°ticos, com uma sintaxe concisa que permite cria√ß√£o de mapas com o m√≠nimo de c√≥digos, mas muito similar √† sintaxe pacote ggplot2 (Martijn 2018). Ele tamb√©m pode gerar mapas est√°ticos ou interativos usando o mesmo c√≥digo, apenas mudando forma de visualiza√ß√£o com fun√ß√£o tmap_mode(), com o argumento mode igual ‚Äúplot‚Äù para est√°tico e ‚Äúview‚Äù para interativo. Por fim, o pacote tmap aceita diversas classes espaciais, incluindo objetos raster, de forma bastante simples. Mais sobre o pacote pode ser lido aqui. üìù Importante \nAtentar para instala√ß√£o extra em Sistemas Operacionais GNU/Linux e MacOS.Todas fun√ß√µes pacote tmap iniciam-se com tm_*, facilitando seu uso. cada fun√ß√£o iremos utilizar o sinal de + para acrescentar outra camada, da mesma forma que o pacote ggplot2. principal fun√ß√£o, em que todos os objetos geoespaciais s√£o dados de entrada, √© tm_shape(). partir dela, podemos seguir com fun√ß√µes espec√≠ficas para vizualiza√ß√£o de objetos sf, como tm_polygons(), tm_borders(), tm_fill(), tm_lines(), tm_dots() ou tm_bubbles(), ou com fun√ß√µes para objetos raster como tm_raster(). Ainda h√° fun√ß√µes como tm_text() para representa√ß√£o de textos das colunas da tabela de atributos, e tm_scale_bar(), tm_compass() e tm_graticules(), para adicionar barra de escala, indicador de orienta√ß√£o (Norte) e gride de coordenadas, respectivamente. Por fim, fun√ß√£o tm_credits() adiciona um texto descritivo e fun√ß√£o tm_layout() faz diversas mudan√ßas nos detalhes e apresenta√ß√£o mapa.Uma funcionalidade muito interessante pacote tmap √© o uso da fun√ß√£o tmaptools::palette_explorer() para escolher paletas de cores dispon√≠veis. Essa fun√ß√£o requer que os pacotes shiny e shinyjs estejam instalados, e quando executada, retorna uma aba onde √© poss√≠vel editar e escolher algumas paletas de cores nativas tmap.Diversos par√¢metros podem ser acrescentados √†s fun√ß√µes de composi√ß√£o tmap, mas n√£o detalharemos aqui, pois todas s√£o descritas nos vignettes pacote: tmap: get started! e tmap: version changes.Vamos seguir com composi√ß√£o mapa de biomas para o Brasil apresentado in√≠cio dessa se√ß√£o (Figura 15.72).\nFigura 15.72: Mapa de Biomas Brasil com o pacote tmap.\nAl√©m disso, o pacote tmap nos permite adicionar de forma simples um mapa secund√°rio, provendo uma localiza√ß√£o regional de interesse (Figura 15.73).Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.\nFigura 15.73: Mapa vetorial prim√°rio e secund√°rio com o pacote tmap.\nComo exemplo de mapa raster, vamos compor novamente o mapa de eleva√ß√£o para Rio Claro/SP, adicionando tamb√©m o limite munic√≠pio (Figura 15.74).\nFigura 15.74: Mapa raster de eleva√ß√£o com o pacote tmap.\nPara exportar mapas criados com o pacote tmap podemos utilizar fun√ß√£o tmap::tmap_save(), indicando os argumentos para ter configura√ß√µes que desejamos. Vamos exportar, t√≠tulo de exemplo, √∫ltima figura.","code":"\n## Download de pol√≠gonos dos geo_vetor_biomas Brasileiros\ngeo_vetor_biomas <- geobr::read_biomes(showProgress = FALSE) %>%\n    dplyr::filter(name_biome != \"Sistema Costeiro\") %>% \n    dplyr::rename(nome_bioma = name_biome,\n                  codigo_bioma = code_biome,\n                  ano = year)\n## Importar os dados pelo pacote ecodados\necodados::geo_vetor_biomas\n## Plot\nplot(geo_vetor_biomas)\n## Plot\nplot(geo_vetor_biomas$geom, \n     col = c(\"darkgreen\", \"orange\", \"orange4\", \"forestgreen\",\n             \"yellow\", \"yellow3\"),\n     main = \"Biomas do Brasil\", axes = TRUE, graticule = TRUE)\nlegend(x = -75, y = -20, pch = 15, cex = .7, pt.cex = 2.5,\n       legend = geo_vetor_biomas$nome_bioma, \n       col = c(\"darkgreen\", \"orange\", \"orange4\", \"forestgreen\", \n               \"yellow\", \"yellow3\"))\n## Plot\nplot(geo_raster_srtm_rio_claro)\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\n## Plot\nplot(geo_raster_bioclim[[1:2]], col = viridis::viridis(10))\n## Criar diret√≥rio\ndir.create(here::here(\"dados\", \"mapas\"))\n\n## Exportar mapa\npng(filename = here::here(\"dados\", \"mapas\", \"elev_rc.png\"), \n    width = 20, height = 20, units = \"cm\", res = 300)\nplot(geo_raster_srtm_rio_claro)\nplot(geo_vetor_rio_claro$geom, col = NA, border = \"red\", lwd = 2, add = TRUE)\ndev.off()\n## Plot\nmapa_vetor_biomas_ggplot2 <- ggplot(data = geo_vetor_biomas) +\n    aes(fill = nome_bioma) +\n    geom_sf(color = \"black\") +\n    scale_fill_manual(values = c(\"darkgreen\", \"orange\", \"orange4\", \n                                 \"forestgreen\", \"yellow\", \"yellow3\")) +\n    annotation_scale(location = \"br\") +\n    annotation_north_arrow(location = \"br\", which_north = \"true\",\n                           pad_x = unit(0, \"cm\"), pad_y = unit(.5, \"cm\"),\n                           style = north_arrow_fancy_orienteering) +\n    annotate(geom = \"text\", label = \"CRS: SIRGAS2000/Geo\", x = -38, y = -31, size = 2.5) +\n    annotate(geom = \"text\", label = \"Fonte: IBGE (2019)\", x = -39, y = -32.5, size = 2.5) +\n    labs(title = \"Biomas do Brasil\", fill = \"Legenda\", x = \"Longitude\", y = \"Latitude\") +\n    theme_bw() +\n    theme(title = element_text(size = 15, face = \"bold\"),\n          legend.title = element_text(size = 10, face = \"bold\"),\n          legend.position = c(.15, .25),\n          legend.background = element_rect(colour = \"black\"),\n          axis.title = element_text(size = 10, face = \"plain\"))\nmapa_vetor_biomas_ggplot2\n## Dados\ngeo_raster_srtm_rio_claro_dados <- raster::rasterToPoints(geo_raster_srtm_rio_claro) %>% \n    tibble::as_tibble()\nhead(geo_raster_srtm_rio_claro_dados)\n#> # A tibble: 6 √ó 3\n#>       x     y elevacao\n#>   <dbl> <dbl>    <dbl>\n#> 1 -47.8 -22.2      859\n#> 2 -47.8 -22.2      856\n#> 3 -47.8 -22.2      856\n#> 4 -47.8 -22.2      856\n#> 5 -47.8 -22.2      853\n#> 6 -47.8 -22.2      852\n\n## Mapa\nmapa_srtm_rio_claro_ggplot2 <- ggplot() +\n    geom_raster(data = geo_raster_srtm_rio_claro_dados, aes(x = x, y = y, fill = elevacao)) +\n    geom_sf(data = geo_vetor_rio_claro, color = \"red\", fill = NA, size = 1.3) +\n    scale_fill_viridis_c() +\n    coord_sf() +\n    annotation_scale(location = \"br\",\n                     pad_x = unit(.5, \"cm\"), pad_y = unit(.7, \"cm\"),) +\n    annotation_north_arrow(location = \"br\", which_north = \"true\",\n                           pad_x = unit(.4, \"cm\"), pad_y = unit(1.3, \"cm\"),\n                           style = north_arrow_fancy_orienteering) +\n    annotate(geom = \"text\", label = \"CRS: WGS84/Geo\", \n             x = -47.51, y = -22.53, size = 3) +\n    labs(title = \"Eleva√ß√£o de Rio Claro/SP\", fill = \"Eleva√ß√£o (m)\", \n         x = \"Longitude\", y = \"Latitude\") +\n    theme_bw() +\n    theme(title = element_text(size = 15, face = \"bold\"),\n          legend.title = element_text(size = 10, face = \"bold\"),\n          legend.position = c(.2, .25),\n          legend.background = element_rect(colour = \"black\"),\n          axis.title = element_text(size = 10, face = \"plain\"),\n          axis.text.y = element_text(angle = 90, hjust = .4))\nmapa_srtm_rio_claro_ggplot2\n## Exportar mapa ggplot2\nggsave(filename = here::here(\"dados\", \"mapas\", \"srtm_rio_claro_ggplot2.png\"),\n       plot = mapa_srtm_rio_claro_ggplot2, width = 20, height = 20, units = \"cm\", dpi = 300)\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa\nmapa_vetor_biomas_tmap <- tm_shape(geo_vetor_biomas, bbox = c(-74, -35, -27, 10)) +\n    tm_polygons(col = \"nome_bioma\",\n                pal = c(\"darkgreen\", \"orange\", \"orange4\", \"forestgreen\", \"yellow\", \"yellow3\"),\n                border.col = \"black\",\n                title = \"Legenda\") +\n    tm_compass() +\n    tm_scale_bar(text.size = .6) +\n    tm_graticules(lines = FALSE) +\n    tm_credits(\"CRS: SIRGAS2000/Geo\", position = c(.63, .13)) +\n    tm_credits(\"Fonte: IBGE (2019)\", position = c(.63, .09)) +\n    tm_layout(title = \"Biomas do Brasil\",\n              title.position = c(.25, .95),\n              title.size = 1.8,\n              title.fontface = \"bold\",\n              legend.frame = TRUE,\n              legend.position = c(\"left\", \"bottom\"),\n              legend.title.fontface = \"bold\")\nmapa_vetor_biomas_tmap\n## Dados\ngeo_vetor_am_sul <- rnaturalearth::ne_countries(continent = \"South America\")\ngeo_vetor_brasil <- rnaturalearth::ne_countries(country = \"Brazil\")\ngeo_vetor_biomas <- geobr::read_biomes(showProgress = FALSE) %>%\n    dplyr::filter(name_biome != \"Sistema Costeiro\")\n## Importar os dados pelo pacote ecodados\necodados::geo_vetor_am_sul\necodados::geo_vetor_brasil\necodados::geo_vetor_biomas\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa secund√°rio\nmapa_am_sul <- tm_shape(geo_vetor_am_sul) +\n    tm_polygons() +\n    tm_shape(geo_vetor_brasil) +\n    tm_polygons(col = \"gray50\")\n\n## Juntando os mapas\nmapa_vetor_biomas_tmap\nprint(mapa_am_sul, vp = grid::viewport(.815, .875, wi = .2, he = .2))\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa\nmapa_srtm_rio_claro_tmap <- tm_shape(geo_raster_srtm_rio_claro) +\n    tm_raster(pal = \"viridis\", title = \"Eleva√ß√£o (m)\") +\n    tm_shape(geo_vetor_rio_claro) +\n    tm_borders(col = \"red\", lwd = 2) +\n    tm_compass(position = c(.9, .08)) +\n    tm_scale_bar(text.size = .6, position = c(.67, 0)) +\n    tm_graticules(lines = FALSE) +\n    tm_credits(\"CRS: WGS84/Geo\", position = c(.67, .06)) +\n    tm_layout(title = \"Eleva√ß√£o Rio Claro/SP\",\n              title.size = 1,\n              title.fontface = \"bold\",\n              legend.title.size = .7,\n              legend.text.size = .6,\n              legend.frame = TRUE,\n              legend.position = c(.01, .01),\n              legend.title.fontface = \"bold\")\nmapa_srtm_rio_claro_tmap\n## Exportar mapa tmap\ntmap::tmap_save(tm = mapa_srtm_rio_claro_tmap, \n                filename = here::here(\"dados\", \"mapas\", \"srtm_rio_claro_tmap.png\"),\n                width = 20, height = 20, units = \"cm\", dpi = 300)"},{"path":"cap15.html","id":"mapas-animados","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.10.4 Mapas animados","text":"Podemos montar mapas facetados para mostrar como padr√µes espaciais variam ao longo tempo, como por exemplo, os limites Brasil ao longo dos anos (Figura 15.75). Entretanto, essa abordagem possui algumas desvantagens, de modo que facetas podem ficar muito pequenas quando h√° muitas delas.Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.\nFigura 15.75: Mapa vetor facetado dos estados brasileiros ao longo tempo com o pacote tmap.\nUma solu√ß√£o √© composi√ß√£o de mapas animados. Apesar de dependerem da publica√ß√£o digital, os mapas animados podem aprimorar relat√≥rios f√≠sicos √† medida que o v√≠nculo uma p√°gina da web contendo vers√£o animada torna-se simples. Existem v√°rias maneiras de gerar anima√ß√µes em R, e uma forma √© com o pacote gganimate e ggplot2. Entretanto, aqui veremos cria√ß√£o de mapas animados com tmap.Podemos criar mapas animados alterando dois argumentos da fun√ß√£o tm_facets():trocando o = year por along = yearindicando o free.coords = FALSEPor fim, podemos exportar o mapa animado formato de .gif utilizando fun√ß√£o tmap::tmap_animation(), indicando taxa de atualiza√ß√£o com o argumento delay (Figura 15.76). Alguns pacotes extras s√£o requeridos dependendo sistema operacional utilizado.\nFigura 15.76: Mapa vetorial animado mostrando os estados brasileiros ao longo tempo com o pacote tmap.\n","code":"\n## Dados\ngeo_vetor_brasil_anos <- NULL\nfor(i in c(1872, 1900, 1911, 1920, 1933, 1940, 1950, 1960, 1970,\n           1980, 1991, 2001, 2010, 2019)){\n    geo_vetor_brasil_anos <- geobr::read_state(code_state = \"all\",\n                                               year = i, showProgress = FALSE) %>% \n        sf::st_geometry() %>% \n        sf::st_as_sf() %>%\n        dplyr::mutate(year = i) %>% \n        dplyr::bind_rows(geo_vetor_brasil_anos, .)\n}\n## Importar os dados pelo pacote ecodados\necodados::geo_vetor_brasil_anos\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa facetado\nmapa_brasil_tmap <- tm_shape(geo_vetor_brasil_anos) + \n    tm_polygons() + \n    tm_facets(by = \"year\", nrow = 4)\nmapa_brasil_tmap\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa animado\nmapa_brasil_tmap_ani <- tm_shape(geo_vetor_brasil_anos) + \n    tm_polygons() + \n    tm_facets(along = \"year\", free.coords = FALSE)\n\n## Exportar mapa tmap animado\ntmap::tmap_animation(tm = mapa_brasil_tmap_ani, \n                     filename = here::here(\"dados\", \"mapas\",\n                                           \"srtm_rio_claro_tmap_ani.gif\"), \n                     delay = 30)"},{"path":"cap15.html","id":"mapas-interativos","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.10.5 Mapas interativos","text":"Mapas interativos podem assumir muitas formas, sendo que mais comum e √∫til √© capacidade de deslocar e ampliar qualquer parte de um conjunto de dados geoespaciais sobreposto em um ‚Äúmapa da web.‚Äù Diversos pacotes nos permitem criar esse tipo de mapa, sendo os mais comuns o tmap, mapview e leaflet. üìù Importante \nDestacamos que esses mapas ir√£o ser compostos numa janela especial de ‚ÄúViewer.‚Äùpacote tmapUm recurso exclusivo tmap √© sua capacidade de criar mapas est√°ticos e interativos usando o mesmo c√≥digo. Os mapas podem ser visualizados interativamente em qualquer ponto mudando para o modo de visualiza√ß√£o, usando fun√ß√£o tmap::tmap_mode(mode = \"view\") (Figura 15.77).\nFigura 15.77: Mapa vetorial interativo com o pacote tmap.\nPara exportar mapas interativos criados com o pacote tmap, podemos utilizar novamente fun√ß√£o tmap::tmap_save(), indicando extens√£o como .html.Pacote mapviewO pacote mapview cria rapidamente mapas interativos simples com fun√ß√£o mapvew::mapview() (Figura 15.78). Entretanto, outras caracter√≠sticas podem ser mudadas para criar mapas mais elaborados, como pode ser visto atrav√©s site pacote.\nFigura 15.78: Mapa vetorial interativo com o pacote mapview.\nPara exportar mapas interativos criados com o pacote mapview, podemos utilizar fun√ß√£o mapivew::mapshot(), indicando extens√£o como .html.Pacote leafletO leaflet √© um dos pacotes de mapeamento interativo mais utilizados e completos em R. Esse pacote fornece uma interface utilizando biblioteca JavaScript e muitos argumentos podem ser compreendidos lendo documenta√ß√£o da biblioteca original.Mapas interativos usando esse pacote s√£o criados utilizando fun√ß√£o leaflet::leaflet(). O resultado dessa fun√ß√£o √© um objeto da classe leaflet, que pode ser alterado por outras fun√ß√µes deste mesmo pacote, permitindo que v√°rias camadas e configura√ß√µes de controle sejam adicionadas interativamente (Figura 15.79).Mais sobre o pacote leaflet pode ser consultado em seu site e CheatSheet.\nFigura 15.79: Mapa vetorial interativo com o pacote leaflet.\nPara exportar mapas interativos criados com o pacote leaflet, podemos utilizar novamente fun√ß√£o mapivew::mapshot(), indicando extens√£o como .html.","code":"\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"view\")\n\n## Atribuir novo mapa interativo\nmapa_srtm_rio_claro_tmap_int <- mapa_srtm_rio_claro_tmap\n## Exportar mapa tmap interativo\ntmap::tmap_save(tm = mapa_srtm_rio_claro_tmap_int, \n                filename = here::here(\"dados\", \"mapas\", \"srtm_rio_claro_tmap_int.html\"))\n## Mapa\nmapa_srtm_rio_claro_mapview_int <- mapview::mapview(\n    geo_raster_srtm_rio_claro, col.regions = viridis::viridis(100))\n## Exportar mapa mapview interativo\nmapview::mapshot(x = mapa_srtm_rio_claro_mapview_int, \n                 url = here::here(\"dados\", \"mapas\", \"srtm_rio_claro_mapview_int.html\"))\n## Paleta de cores\npal <- colorNumeric(viridis::viridis(10), raster::values(geo_raster_srtm_rio_claro))\n\n## Mapa\nmapa_srtm_rio_claro_leaflet_int <- leaflet() %>%\n    addProviderTiles(\"CartoDB.Positron\") %>% \n    addRasterImage(geo_raster_srtm_rio_claro, colors = pal, opacity = .8) %>%\n    addLegend(pal = pal, values = raster::values(geo_raster_srtm_rio_claro), \n              title = \"Eleva√ß√£o (m)\") %>% \n    addPolygons(data = geo_vetor_rio_claro, col = \"red\", fill = NA)\nknitr::include_url(\"img/cap15_fig78.png\")\n## Exportar mapa leaflet interativo\nmapview::mapshot(x = mapa_srtm_rio_claro_leaflet_int, \n                 url = here::here(\"dados\", \"mapas\", \"srtm_rio_claro_leaflet_int.html\"))"},{"path":"cap15.html","id":"exemplos-de-aplica√ß√µes-de-an√°lises-geoespaciais-para-dados-ecol√≥gicos","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.11 Exemplos de aplica√ß√µes de an√°lises geoespaciais para dados ecol√≥gicos","text":"Agora que vimos os principais conceitos e aplica√ß√µes manejo e visualiza√ß√£o de dados geoespaciais, podemos avan√ßar para realizar quatro exemplos de aplica√ß√µes para dados ecol√≥gicos. Para isso, usaremos novamente os dados de comunidades de anf√≠bios da Mata Atl√¢ntica (Vancine et al. 2018). Primeiramente, veremos como resumir informa√ß√µes de biodiversidade (n√∫mero de ocorr√™ncias e riqueza) para hex√°gonos. Num segundo momento, veremos como associar dados ambientais coordenadas de esp√©cies ou comunidades. Depois, como resumir dados de rasters para buffers. Por fim, realizaremos predi√ß√µes espaciais cont√≠nuas de adequabilidade de habitat para uma esp√©cie e n√∫mero de esp√©cies.","code":""},{"path":"cap15.html","id":"resumir-informa√ß√µes-de-biodiversidade-para-unidades-espaciais","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.11.1 Resumir informa√ß√µes de biodiversidade para unidades espaciais","text":"Resumir informa√ß√µes para unidades espaciais √© um passo muito frequente em an√°lises de Macroecologia, Biogeografia ou Ecologia da Paisagem. Nesta se√ß√£o, contabilizaremos o n√∫mero de ocorr√™ncias e riqueza de anf√≠bios para hex√°gonos na Mata Atl√¢ntica.Primeiramente, vamos importar e preparar os dados de biodiversidade que usaremos nesses exemplos. Vamos come√ßar importando os locais de amostragens de anf√≠bios na Mata Atl√¢ntica e selecionando apenas colunas de interesse.Agora vamos importar esp√©cies das comunidades, selecionando apenas esp√©cies com nomes v√°lidos e transformando coluna de indiv√≠duos para 1, para compor posteriormente uma matriz de comunidade de esp√©cies.Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.Podemos agora juntar tabela de locais, que possui coordenadas √† tabela de esp√©cies. Em seguida convertemos essa √∫nica tabela na classe vetor sf.Agora vamos baixar o limite Bioma da Mata Atl√¢ntica para o Brasil, converter o GCS para WGS84/Geo e ajustar sua extens√£o para remover ilhas Oceano Atl√¢ntico.Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.Podemos verificar se coordenadas e o limite bioma est√£o todos corretos compondo um mapa preliminar, usando o pacote tmap (Figura 15.80).\nFigura 15.80: Mapa dos locais Atlantic Amphibians e limite da Mata Atl√¢ntica.\nComo o limite utilizado para reunir informa√ß√µes das comunidades de anf√≠bios foi o mais abrangente poss√≠vel (Muylaert et al. 2018; Vancine et al. 2018), selecionaremos apenas os locais que caem dentro limite da Mata Atl√¢ntica que estamos utilizando aqui.Podemos refazer o mapa mostrando coordenadas retiradas em vermelho e que ficaram em verde (Figura 15.81).\nFigura 15.81: Mapa dos locais Atlantic Amphibians que caem dentro limite da Mata Atl√¢ntica.\nO pr√≥ximo passo √© criar um gride de hex√°gonos para o Bioma da Mata Atl√¢ntica. Usaremos fun√ß√£o sf::st_make_grid() que pode criar quadr√≠culas ou hex√°gonos. Esses hex√°gonos ter√£o √°rea equivalente √† quadr√≠culas de 1¬∫ de tamanho (aproximadamente 10000 km¬≤). Usaremos fun√ß√£o sf::st_area() para calcular √°reas dos hex√°gonos e fun√ß√£o tibble::rowid_to_column() para criar uma identifica√ß√£o para cada fei√ß√£o.Podemos conferir os hex√°gonos criados fazendo um mapa preliminar (Figura 15.82).\nFigura 15.82: Mapa dos hex√°gonos para o limite da Mata Atl√¢ntica.\nPodemos ser mais restritos e selecionar apenas os hex√°gonos dentro limite Bioma da Mata Atl√¢ntica utilizando o operador st_within() (Figura 15.83.\nFigura 15.83: Mapa dos hex√°gonos totalmente dentro limite da Mata Atl√¢ntica.\nPodemos agora associar esp√©cies aos hex√°gonos fazendo um ‚Äújoin‚Äù espacial, utilizando fun√ß√£o sf::st_join().Por fim, podemos agregar os dados para ter o n√∫mero de ocorr√™ncias e de esp√©cies por hex√°gono.Finalmente podemos compor os mapas finais, mostrando os hex√°gonos com cores e valores n√∫mero de ocorr√™ncias e de esp√©cies 15.84).\nFigura 15.84: Mapa com o n√∫mero de ocorr√™ncias e riqueza de anf√≠bios para hex√°gonos limite da Mata Atl√¢ntica.\n","code":"\n## Importar locais\ngeo_anfibios_locais <- readr::read_csv(\n    here::here(\"dados\", \"tabelas\", \"ATLANTIC_AMPHIBIANS_sites.csv\"),\n    col_types = cols()) %>%\n    dplyr::select(id, longitude, latitude, species_number)\n## Importar esp√©cies\ngeo_anfibios_especies <- readr::read_csv(\n    here::here(\"dados\", \"tabelas\", \"ATLANTIC_AMPHIBIANS_species.csv\"), \n    col_types = cols()) %>%\n    tidyr::drop_na(valid_name) %>% \n    dplyr::select(id, valid_name, individuals) %>% \n    dplyr::distinct(id, valid_name, .keep_all = TRUE) %>% \n    dplyr::mutate(individuals = tidyr::replace_na(individuals, 1),\n                  individuals = ifelse(individuals > 0, 1, 1))\n## Importar os dados pelo pacote ecodados\necodados::geo_anfibios_locais\necodados::geo_anfibios_especies\n## Jun√ß√£o das coordenadas e convers√£o para classe sf\ngeo_anfibios_especies_locais_vetor <- geo_anfibios_especies %>% \n    dplyr::left_join(geo_anfibios_locais, by = \"id\") %>% \n    dplyr::relocate(longitude, latitude, .after = 1) %>% \n    dplyr::mutate(lon = longitude, lat = latitude) %>% \n    sf::st_as_sf(coords = c(\"lon\", \"lat\"), crs = 4326)\n## Download do Bioma da Mata Atl√¢ntica\ngeo_vetor_mata_atlantica <- geobr::read_biomes(year = 2019, showProgress = FALSE) %>% \n    dplyr::filter(name_biome == \"Mata Atl√¢ntica\") %>% \n    sf::st_transform(crs = 4326) %>% \n    sf::st_crop(xmin = -55, ymin = -30, xmax = -34, ymax = -5)\n## Importar os dados pelo pacote ecodados\necodados::geo_vetor_mata_atlantica\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa\ntm_shape(geo_vetor_mata_atlantica, \n         bbox = geo_anfibios_especies_locais_vetor) +\n    tm_polygons() +\n    tm_shape(geo_anfibios_especies_locais_vetor) +\n    tm_dots(size = .1, col = \"forestgreen\")\n## Selecionar os locais dentro do limite\ngeo_anfibios_especies_locais_vetor_mata_atlantica <- geo_anfibios_especies_locais_vetor[geo_vetor_mata_atlantica, ]\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa\ntm_shape(geo_vetor_mata_atlantica,\n         bbox = geo_anfibios_especies_locais_vetor) +\n    tm_polygons() +\n    tm_shape(geo_anfibios_especies_locais_vetor) +\n    tm_bubbles(size = .1, col = \"red\") +\n    tm_shape(geo_anfibios_especies_locais_vetor_mata_atlantica) +\n    tm_bubbles(size = .1, col = \"forestgreen\")\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Criar hex√°gonos de ~110 km\ngeo_vetor_mata_atlantica_hex <- sf::st_make_grid(\n    x = geo_vetor_mata_atlantica, cellsize = 1, square = FALSE) %>% \n    sf::st_as_sf() %>% \n    dplyr::mutate(areakm2 = sf::st_area(.)/1e6) %>% \n    tibble::rowid_to_column(\"id_hex\")\n\n## Selecionar os hex√°gonos dentro do limite da Mata Atl√¢ntica\ngeo_vetor_mata_atlantica_hex <- geo_vetor_mata_atlantica_hex[geo_vetor_mata_atlantica, ]\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa\ntm_shape(geo_vetor_mata_atlantica, \n         bbox = geo_vetor_mata_atlantica_hex) +\n    tm_polygons() +\n    tm_shape(geo_vetor_mata_atlantica_hex) +\n    tm_borders()\n## Selecionar os hex√°gonos totalmente dentro do limite da Mata Atl√¢ntica\ngeo_vetor_mata_atlantica_hex_total <- geo_vetor_mata_atlantica_hex[geo_vetor_mata_atlantica, , op = st_within]\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa\ntm_shape(geo_vetor_mata_atlantica, \n         bbox = geo_vetor_mata_atlantica_hex) +\n    tm_polygons() +\n    tm_shape(geo_vetor_mata_atlantica_hex_total) +\n    tm_borders()\n## Jun√ß√£o espacial dos locais com os hex√°gonos\ngeo_vetor_mata_atlantica_hex_especies <- sf::st_join(\n    x = geo_vetor_mata_atlantica_hex, \n    y = geo_anfibios_especies_locais_vetor_mata_atlantica,\n    left = TRUE)\n## Agregar dados de ocorr√™ncias e n√∫mero de esp√©cies por hex√°gono\ngeo_vetor_mata_atlantica_hex_especies_oco_riq <- geo_vetor_mata_atlantica_hex_especies %>% \n    dplyr::group_by(id_hex) %>% \n    dplyr::summarise(ocorrencias = length(valid_name[!is.na(valid_name)]),\n                     riqueza = n_distinct(valid_name, na.rm = TRUE))\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa de ocorr√™ncias\nmapa_oco <- tm_shape(geo_vetor_mata_atlantica_hex_especies_oco_riq) +\n    tm_polygons(title = \"Ocorr√™ncia de anf√≠bios\", col = \"ocorrencias\", \n                pal = \"viridis\", style = \"pretty\") +\n    tm_text(\"ocorrencias\", size = .4) +\n    tm_graticules(lines = FALSE) +\n    tm_compass() +\n    tm_scale_bar() +\n    tm_layout(legend.title.size = 2,\n              legend.title.fontface = \"bold\",\n              legend.position = c(\"left\", \"top\"))\n\n## Mapa de riqueza\nmapa_riq <- tm_shape(geo_vetor_mata_atlantica_hex_especies_oco_riq) +\n    tm_polygons(title = \"Riqueza de anf√≠bios\", col = \"riqueza\", \n                pal = \"viridis\", style = \"pretty\") +\n    tm_text(\"riqueza\", size = .4) +\n    tm_graticules(lines = FALSE) +\n    tm_compass() +\n    tm_scale_bar() +\n    tm_layout(legend.title.size = 2,\n              legend.title.fontface = \"bold\",\n              legend.position = c(\"left\", \"top\"))\n\n## Uni√£o dos mapas\ntmap_arrange(mapa_oco, mapa_riq)"},{"path":"cap15.html","id":"extrair-dados-raster-para-pontos","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.11.2 Extrair dados raster para pontos","text":"Atribuir informa√ß√µes ambientais ocorr√™ncias √© um passo fundamental para diversas an√°lises. Nesta se√ß√£o, atribuiremos os valores das vari√°veis bioclim√°ticas aos locais de amostragem de anf√≠bios na Mata Atl√¢ntica.J√° realizamos o download das vari√°veis bioclim√°ticas na se√ß√£o de raster. Vamos importar novamente esses dados, primeiramente listando camadas e depois importando com fun√ß√£o raster:stack().Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.Da se√ß√£o anterior, j√° temos o objeto com tabela de coordenadas dos locais de amostragem das comunidades de anf√≠bios. Vamos agora criar um objeto vetorial das coordenadas e em seguida selecionar os locais dentro limite bioma da Mata Atl√¢ntica.Usaremos agora fun√ß√£o raster::extract() para extrair e associar os valores das vari√°veis bioclim√°ticas para os locais de amostragem.Podemos ver esses dados na Tabela 15.14.\nTabela 15.14: Dados extra√≠dos e atribu√≠dos aos locais\nde amostragens de comunidades de anf√≠bios na Mata Atl√¢ntica\nPodemos ainda fazer alguns mapas para espacializar essas vari√°veis (Figura 15.85).\nFigura 15.85: Mapa mostrando os valores das vari√°veis bioclim√°ticas (BIO01:BIO06) para os locais amostrados de comunidades de anf√≠bios para hex√°gonos limite da Mata Atl√¢ntica.\n","code":"\n## Listar arquivos\narquivos_raster <- dir(path = here::here(\"dados\", \"raster\"), pattern = \"wc\") %>% \n    grep(\".tif\", ., value = TRUE)\n\n## Importar rasters\ngeo_raster_bioclim <- raster::stack(here::here(\"dados\", \"raster\", arquivos_raster))\n\n## Renomear rasters\nnames(geo_raster_bioclim) <- c(\"bio01\", paste0(\"bio\", 10:19), paste0(\"bio0\", 2:9))\n## Importar os dados pelo pacote ecodados\necodados::geo_raster_bioclim\n## Importar locais e converter em sf\ngeo_anfibios_locais_vetor <- geo_anfibios_locais %>% \n    dplyr::mutate(lon = longitude, lat = latitude) %>% \n    sf::st_as_sf(coords = c(\"lon\", \"lat\"), crs = 4326)\ngeo_anfibios_locais_vetor\n#> Simple feature collection with 1163 features and 4 fields\n#> Geometry type: POINT\n#> Dimension:     XY\n#> Bounding box:  xmin: -56.74194 ymin: -33.51083 xmax: -34.79667 ymax: -3.51525\n#> Geodetic CRS:  WGS 84\n#> # A tibble: 1,163 √ó 5\n#>    id      longitude latitude species_number              geometry\n#>  * <chr>       <dbl>    <dbl>          <dbl>           <POINT [¬∞]>\n#>  1 amp1001     -43.4    -8.68             19     (-43.42194 -8.68)\n#>  2 amp1002     -38.9    -3.55             16 (-38.85783 -3.545527)\n#>  3 amp1003     -38.9    -3.57             14 (-38.88869 -3.574194)\n#>  4 amp1004     -38.9    -3.52             13   (-38.9188 -3.51525)\n#>  5 amp1005     -38.9    -4.28             30 (-38.91083 -4.280556)\n#>  6 amp1006     -36.4    -9.23             42 (-36.42806 -9.229167)\n#>  7 amp1007     -40.9    -3.85             23 (-40.89444 -3.846111)\n#>  8 amp1008     -40.9    -3.83             19 (-40.91944 -3.825833)\n#>  9 amp1009     -40.9    -3.84             13   (-40.91028 -3.8375)\n#> 10 amp1010     -35.2    -6.14              1 (-35.22944 -6.136944)\n#> # ‚Ä¶ with 1,153 more rows\n## Extrair valores das vari√°veis para os locais\ngeo_anfibios_locais_vetor_bioclim <- geo_anfibios_locais_vetor %>% \n    dplyr::mutate(raster::extract(geo_raster_bioclim, ., df = TRUE)) %>% \n    dplyr::select(-ID) %>% \n    dplyr::relocate(bio02:bio09, .after = bio01)\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa\ngeo_anfibios_locais_vetor_bioclim %>% \n    dplyr::select(bio01:bio06) %>% \n    tidyr::gather(var, val, -geometry) %>% \n    tm_shape() +\n    tm_bubbles(size = .1, col = \"val\", pal = \"viridis\") +\n    tm_facets(\"var\", free.scales = TRUE) +\n    tm_layout(legend.outside = FALSE)"},{"path":"cap15.html","id":"resumir-dados-de-rasters-para-buffers","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.11.3 Resumir dados de rasters para buffers","text":"Muitas an√°lises requerem que fa√ßamos um resumo da composi√ß√£o da paisagem para buffers, sendo o buffer uma unidade de an√°lise espacial entorno de um ponto de amostragem.Aqui, usaremos os dados GlobCover v.2.3 de 2009 (Arino et al. 2012) como raster de cobertura da terra. O arquivo √© grande (~400 Mb) e pode demorar muito, dependendo da velocidade da sua internet.Depois de fazer o download, vamos importar e ajustar esse raster para o limite da Mata Atl√¢ntica (Figura 15.86).Caso o download n√£o funcione ou haja problemas com importa√ß√£o, disponibilizamos os dados tamb√©m pacote ecodados.\nFigura 15.86: Camada raster GlobCover 2.3 para o Bioma da Mata Atl√¢ntica.\nVamos agora transformar tabela de locais em vetor, selecionar aleatoriamente 50 amostragens das comunidades de anf√≠bios e criar buffers de ~10 km.Podemos conferir mapa da Figura 15.87.\nFigura 15.87: Distribui√ß√£o de 50 localidades aleat√≥rios e buffers de ~1 km (fora de escala).\nAgora podemos utilizar fun√ß√£o raster::extract() para fazer contabiliza√ß√£o, j√° em porcentagem, de pixels de cada classe para cada buffer.Agora podemos combinar esses dados aos dados dos buffers.","code":"\n## Aumentar o tempo de download\noptions(timeout = 1e5)\n\n## Download dos dados do GlobCover\ndownload.file(url = \"http://due.esrin.esa.int/files/Globcover2009_V2.3_Global_.zip\",\n              destfile = here::here(\"dados\", \"raster\", \"Globcover2009_V2.3_Global.zip\"), \n              mode = \"wb\", extra = \"c\")\n\n## Unzip\nunzip(zipfile = here::here(\"dados\", \"raster\", \"Globcover2009_V2.3_Global.zip\"),\n      exdir = here::here(\"dados\", \"raster\"))\n## Importar raster do GlobCover\ngeo_raster_globcover <- raster::raster(\n    here::here(\"dados\", \"raster\", \"GLOBCOVER_L4_200901_200912_V2.3.tif\"))\n\n## Ajustar para o limite do bioma da Mata Atl√¢ntica\ngeo_raster_globcover_mata_atlantica <- geo_raster_globcover %>% \n    raster::crop(geo_vetor_mata_atlantica) %>% \n    raster::mask(geo_vetor_mata_atlantica)\ngeo_raster_globcover_mata_atlantica\n#> class      : RasterLayer \n#> dimensions : 8940, 7274, 65029560  (nrow, ncol, ncell)\n#> resolution : 0.002777778, 0.002777778  (x, y)\n#> extent     : -54.99861, -34.79306, -29.98194, -5.148611  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : memory\n#> names      : GLOBCOVER_L4_200901_200912_V2.3 \n#> values     : 14, 220  (min, max)\n## Importar os dados pelo pacote ecodados\necodados::geo_raster_globcover_mata_atlantica\n# Plot\nplot(geo_raster_globcover_mata_atlantica, col = viridis::viridis(n = 200))\n## Fixar a amostragem\nset.seed(42)\n\n## Pontos\ngeo_anfibios_especies_locais_vetor_mata_atlantica <- geo_anfibios_locais %>% \n    sf::st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) %>%\n    dplyr::filter(sf::st_intersects(x = ., y = geo_vetor_mata_atlantica, sparse = FALSE)) %>% \n    dplyr::slice_sample(n = 50)\n\n## Buffers de ~1 km\ngeo_anfibios_especies_locais_vetor_mata_atlantica_buffer10km <-\n    sf::st_buffer(geo_anfibios_especies_locais_vetor_mata_atlantica,\n                  dist = 1000)\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa\ntm_shape(geo_vetor_mata_atlantica) +\n    tm_polygons() +\n    tm_shape(geo_anfibios_especies_locais_vetor_mata_atlantica_buffer10km) +\n    tm_bubbles(size = .3, border.col = \"red\", alpha = 0) +\n    tm_shape(geo_anfibios_especies_locais_vetor_mata_atlantica) +\n    tm_dots(size = .01, col = \"forestgreen\")\n## Estat√≠stica zonal \ngeo_anfibios_locais_vetor_ma_buffer10km_ext <- raster::extract(\n    x = geo_raster_globcover_mata_atlantica,\n    y = geo_anfibios_especies_locais_vetor_mata_atlantica_buffer10km,\n    df = TRUE, na.rm = TRUE) %>% \n    dplyr::rename(id = ID, classe = 2) %>% \n    tidyr::drop_na(classe) %>% \n    dplyr::mutate(classe = paste0(\"classe_\", classe)) %>%\n    dplyr::group_by(id, classe) %>% \n    dplyr::summarise(n = n()) %>% \n    tidyr::pivot_wider(id_cols = id, names_from = classe, values_from = n) %>% \n    dplyr::mutate(across(everything(), ~replace_na(.x, 0))) %>% \n    janitor::adorn_totals(\"col\") %>% \n    janitor::adorn_percentages(\"row\") %>% \n    janitor::adorn_pct_formatting(rounding = \"half up\", digits = 1)\nhead(geo_anfibios_locais_vetor_ma_buffer10km_ext)\n#>  id classe_30 classe_40 classe_14 classe_20 classe_130 classe_50 classe_60 classe_190 classe_210 classe_110 classe_200\n#>   1      7.7%     92.3%      0.0%      0.0%       0.0%      0.0%      0.0%       0.0%       0.0%       0.0%       0.0%\n#>   2     21.6%     45.9%     24.3%      8.1%       0.0%      0.0%      0.0%       0.0%       0.0%       0.0%       0.0%\n#>   3     56.3%     12.5%      9.4%     21.9%       0.0%      0.0%      0.0%       0.0%       0.0%       0.0%       0.0%\n#>   4     38.9%     25.0%     27.8%      0.0%       8.3%      0.0%      0.0%       0.0%       0.0%       0.0%       0.0%\n#>   5      0.0%     66.7%      0.0%      8.3%      16.7%      5.6%      2.8%       0.0%       0.0%       0.0%       0.0%\n#>   6     31.4%      2.9%      0.0%     11.4%      37.1%      5.7%      0.0%      11.4%       0.0%       0.0%       0.0%\n#>  classe_120  Total\n#>        0.0% 100.0%\n#>        0.0% 100.0%\n#>        0.0% 100.0%\n#>        0.0% 100.0%\n#>        0.0% 100.0%\n#>        0.0% 100.0%\n## Combina√ß√£o\ngeo_anfibios_locais_vetor_ma_buffer10km_ext_bind  <- dplyr::bind_cols(\n    x = geo_anfibios_especies_locais_vetor_mata_atlantica_buffer10km,\n    y = geo_anfibios_locais_vetor_ma_buffer10km_ext[, -1]) %>% \n    sf::st_drop_geometry()\ngeo_anfibios_locais_vetor_ma_buffer10km_ext_bind\n#> # A tibble: 50 √ó 15\n#>    id      species_number classe_30 classe_40 classe_14 classe_20 classe_130 classe_50 classe_60 classe_190 classe_210\n#>  * <chr>            <dbl> <chr>     <chr>     <chr>     <chr>     <chr>      <chr>     <chr>     <chr>      <chr>     \n#>  1 amp1716             10 7.7%      92.3%     0.0%      0.0%      0.0%       0.0%      0.0%      0.0%       0.0%      \n#>  2 amp1351             16 21.6%     45.9%     24.3%     8.1%      0.0%       0.0%      0.0%      0.0%       0.0%      \n#>  3 amp1168             19 56.3%     12.5%     9.4%      21.9%     0.0%       0.0%      0.0%      0.0%       0.0%      \n#>  4 amp1085             20 38.9%     25.0%     27.8%     0.0%      8.3%       0.0%      0.0%      0.0%       0.0%      \n#>  5 amp1258              3 0.0%      66.7%     0.0%      8.3%      16.7%      5.6%      2.8%      0.0%       0.0%      \n#>  6 amp1160              9 31.4%     2.9%      0.0%      11.4%     37.1%      5.7%      0.0%      11.4%      0.0%      \n#>  7 amp1843             14 0.0%      100.0%    0.0%      0.0%      0.0%       0.0%      0.0%      0.0%       0.0%      \n#>  8 amp1060              8 0.0%      23.5%     0.0%      76.5%     0.0%       0.0%      0.0%      0.0%       0.0%      \n#>  9 amp1141              5 18.8%     0.0%      62.5%     18.8%     0.0%       0.0%      0.0%      0.0%       0.0%      \n#> 10 amp1333              7 37.8%     2.7%      0.0%      24.3%     21.6%      13.5%     0.0%      0.0%       0.0%      \n#> # ‚Ä¶ with 40 more rows, and 4 more variables: classe_110 <chr>, classe_200 <chr>, classe_120 <chr>, Total <chr>"},{"path":"cap15.html","id":"predi√ß√µes-espaciais-de-objetos-raster","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.11.4 Predi√ß√µes espaciais de objetos raster","text":"O pacote raster al√©m de permitir realizar manipula√ß√£o e visualiza√ß√£o de dados raster R, tamb√©m permite extrapola√ß√£o ajuste de an√°lises, como LMs, GLMs, GAMs dentre outras (Cap√≠tulos 7 e 8). Aqui, faremos uma pequena demostra√ß√£o utilizando fun√ß√£o raster::predict(), predizendo o resultado de dois ajustes de GLMs para presen√ßa/aus√™ncia de uma esp√©cie de anuro e extrapola√ß√£o n√∫mero de esp√©cies de anf√≠bios para o Bioma da Mata Atl√¢ntica.Para ajustar um GLM para dados de presen√ßa/aus√™ncia, podemos usar tabela j√° criada anteriormente, com esp√©cies e coordenadas, e fazer uma jun√ß√£o com √∫ltima tabela que criamos com os dados bioclim√°ticos.Agora, vamos selecionar ocorr√™ncias da esp√©cie Haddadus binotatus, atribuindo 1 quando ela ocorre e 0 quando ela n√£o ocorre. Essa esp√©cie √© relativamente comum na serrapilheira de fragmentos florestais da Mata Atl√¢ntica, e recebe esse nome em homenagem um grande pesquisador de anf√≠bios da Mata Atl√¢ntica, o Prof.¬†C√©lio Fernando Baptista Haddad.Vamos utilizar apenas vari√°veis n√£o correlacionadas para o √≠ndice de correla√ß√£o de Pearson para r < 0,7 (Cap√≠tulo 7).Agora sim, podemos ajustar um modelo simples da presen√ßa e aus√™ncia dessa esp√©cie, utilizando vari√°veis n√£o correlacionadas, atrav√©s de um GLM para fam√≠lia binomial. Nosso intuito n√£o analisar se o modelo atende √† todos os pressupostos, e sim exemplificar predi√ß√£o espacial, para esses detalhes, consulte o Cap√≠tulo 8.Antes de fazermos predi√ß√£o da distribui√ß√£o potencial da esp√©cie √© fundamental que o objeto raster esteja ajustado para o limite da Mata Atl√¢ntica. Para isso vamos utilizar fun√ß√µes raster::crop() e raster::mask() para fazer esse ajuste 15.88).\nFigura 15.88: Mapa de dois rasters (BIO01 e BIO12) ajustados ao limite da Mata Atl√¢ntica.\nAgora podemos fazer predi√ß√£o desse modelo para todo o Bioma da Mata Atl√¢ntica. Essa fun√ß√£o vai utilizar os coeficientes modelo ajustado para gerar um raster de predi√ß√£o para todos os pixels da Mata Atl√¢ntica. Vamos usar o argumento type = \"response\" para que os valores da predi√ß√£o sejam ajustados 0 1. üìù Importante \nPara que predi√ß√£o funcione, os nomes das camadas raster geo_raster_bioclim_mata_atlantica devem possuir o mesmo nome das colunas das vari√°veis preditoras ajustadas modelo modelo_pa.Por fim, √∫ltimo passo podemos tornar esse modelo bin√°rio, ou seja, apenas com valores 0 ou 1. Para isso vamos adotar arbitrariamente o valor de 0,01 como ponto de corte. partir desse valor consideraremos o pixels acima como 1 e abaixo como 0.Por fim, vamos produzir dois mapas mostrando os valores das predi√ß√µes, o mapa bin√°rio e ocorr√™ncias da esp√©cie 15.89).\nFigura 15.89: Mapa da predi√ß√£o cont√≠nua e bin√°ria modelo ajustado para presen√ßa/aus√™ncia da esp√©cie Haddadus binotatus na Mata Atl√¢ntica e suas ocorr√™ncias.\n üìù Importante \nEssa an√°lise foi realizada com o intuito de exemplificar o funcionamento da fun√ß√£o raster::predict(), para mais detalhes, consultar livros espec√≠ficos da √°rea de Modelagem de Distribui√ß√£o de Esp√©cies ou Modelagem de Nicho Ecol√≥gico Fletcher Fortin (2018).Em nossa segunda an√°lise, vamos predizer os dados de riqueza para todo o bioma da Mata Atl√¢ntica. Para isso, temos de retirar novamente vari√°veis correlacionadas.Agora sim, podemos criar os GLMs com fam√≠lias de distribui√ß√£o apropriadas para dados de contagem como Poisson e Binomial Negativa. Nosso intuito n√£o analisar se o modelo atende √† todos os pressupostos, e sim exemplificar predi√ß√£o espacial, para esses detalhes, consulte o Cap√≠tulo 8.Com os modelos ajustados, podemos fazer predi√ß√µes utilizando os objetos raster com vari√°veis ambientais.Por fim, podemos compor os dois mapas de predi√ß√µes (Figura 15.90).\nFigura 15.90: Mapa da predi√ß√£o de riqueza utilizando o modelo Poisson e Binomial Negativa para Mata Atl√¢ntica.\n üìù Importante \nEssa an√°lise foi realizada com o intuito de exemplificar o funcionamento da fun√ß√£o raster::predict(), para mais detalhes, consultar livros espec√≠ficos da √°rea de Ecologia Espacial (Fletcher Fortin 2018).","code":"\n## Jun√ß√£o dos dados ambientais aos dados de esp√©cies\ngeo_anfibios_locais_especies_vetor_bioclim <- geo_anfibios_especies %>% \n    dplyr::left_join(., sf::st_drop_geometry(geo_anfibios_locais_vetor_bioclim), by = \"id\")\n## Sele√ß√£o da esp√©cie Haddadus binotatus\ngeo_anfibios_locais_especies_vetor_bioclim_hb <- geo_anfibios_locais_especies_vetor_bioclim %>% \n    dplyr::mutate(pa = ifelse(valid_name == \"Haddadus binotatus\", 1, 0), .after = individuals) %>% \n    dplyr::distinct(id, .keep_all = TRUE)\n## Correla√ß√£o entre as vari√°veis\ncorr <- geo_anfibios_locais_especies_vetor_bioclim_hb %>% \n    dplyr::select(bio01:bio19) %>% \n    cor() %>% \n    caret::findCorrelation(.7, names = TRUE)\n\n## Sele√ß√£o das vari√°veis n√£o correlacionadas\ngeo_anfibios_locais_especies_vetor_bioclim_hb_cor <- geo_anfibios_locais_especies_vetor_bioclim_hb %>% \n    dplyr::select(pa, bio01:bio19) %>% \n    dplyr::select(-c(corr))\n## Ajustar um modelo GLM binomial\nmodelo_pa <- glm(formula = pa ~ ., \n                 data = geo_anfibios_locais_especies_vetor_bioclim_hb_cor, \n                 family = binomial(\"logit\"))\n## Ajuste da extens√£o e limite\ngeo_raster_bioclim_mata_atlantica <- geo_raster_bioclim %>% \n    raster::crop(geo_vetor_mata_atlantica) %>% \n    raster::mask(geo_vetor_mata_atlantica)\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Mapa\ntm_shape(geo_raster_bioclim_mata_atlantica[[c(1, 4)]]) +\n    tm_raster(pal = \"viridis\", title = c(\"bio01\", \"bio12\")) +\n    tm_facets(free.scales.raster = TRUE)\n## Predi√ß√µes\nmodelo_pa_pred <- raster::predict(\n    object = geo_raster_bioclim_mata_atlantica, \n    model = modelo_pa,\n    type = \"response\")\nmodelo_pa_pred\n#> class      : RasterLayer \n#> dimensions : 149, 121, 18029  (nrow, ncol, ncell)\n#> resolution : 0.1666667, 0.1666667  (x, y)\n#> extent     : -55, -34.83333, -30, -5.166667  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : memory\n#> names      : layer \n#> values     : 1.255833e-12, 0.1983049  (min, max)\n## Sele√ß√£o dos pixels de presen√ßa/aus√™ncia potencial\nmodelo_pa_pred_corte <- modelo_pa_pred >= .01\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Combinar os dois raster\nmodelo_pa_pred <- raster::stack(modelo_pa_pred, modelo_pa_pred_corte)\nnames(modelo_pa_pred) <- c(\"Cont√≠nuo\", \"Bin√°rio\")\n\n## Mapas de predi√ß√£o cont√≠nua e bin√°ria\ntm_shape(modelo_pa_pred) +\n    tm_raster(pal = \"viridis\", title = c(\"Predi√ß√£o\", \"Predi√ß√£o\"),\n              style = \"fisher\") +\n    tm_facets(free.scales.raster = TRUE)\n## Correla√ß√£o\ncorr <- geo_anfibios_locais_vetor_bioclim %>% \n    sf::st_drop_geometry() %>% \n    dplyr::select(bio01:bio19) %>% \n    cor() %>% \n    caret::findCorrelation(.7, names = TRUE)\n\n## Sele√ß√£o das vari√°veis n√£o correlacionadas\ngeo_anfibios_locais_bioclim_cor <- geo_anfibios_locais_vetor_bioclim %>% \n    sf::st_drop_geometry() %>% \n    dplyr::select(species_number, bio01:bio19) %>% \n    dplyr::select(-c(corr))\n## Modelo Poisson\nmodelo_riq_pois <- glm(\n    formula = species_number ~ ., \n    data = geo_anfibios_locais_bioclim_cor, \n    family = poisson)\n\n## Modelo Binomial Negativo\nmodelo_riq_nb <- MASS::glm.nb(\n    formula = species_number ~ .,\n    data = geo_anfibios_locais_bioclim_cor)\n## Predi√ß√£o do modelo Poisson\nmodelo_riq_pois_pred <- raster::predict(\n    object = geo_raster_bioclim_mata_atlantica,\n    model = modelo_riq_pois,\n    type = \"response\")\nmodelo_riq_pois_pred\n#> class      : RasterLayer \n#> dimensions : 149, 121, 18029  (nrow, ncol, ncell)\n#> resolution : 0.1666667, 0.1666667  (x, y)\n#> extent     : -55, -34.83333, -30, -5.166667  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : memory\n#> names      : layer \n#> values     : 8.249131, 24.76082  (min, max)\n\n## Predi√ß√£o do modelo Binomial Negativo\nmodelo_riq_nb_pred <- raster::predict(\n    object = geo_raster_bioclim_mata_atlantica,\n    model = modelo_riq_nb,\n    type = \"response\")\nmodelo_riq_nb_pred\n#> class      : RasterLayer \n#> dimensions : 149, 121, 18029  (nrow, ncol, ncell)\n#> resolution : 0.1666667, 0.1666667  (x, y)\n#> extent     : -55, -34.83333, -30, -5.166667  (xmin, xmax, ymin, ymax)\n#> crs        : +proj=longlat +datum=WGS84 +no_defs \n#> source     : memory\n#> names      : layer \n#> values     : 9.262095, 24.45297  (min, max)\n## Mudar o modo de exibi√ß√£o do tmap\ntmap::tmap_mode(mode = \"plot\")\n\n## Combinar os dois raster\nmodelo_riq_pred <- raster::stack(modelo_riq_pois_pred, modelo_riq_nb_pred)\nnames(modelo_riq_pred) <- c(\"Poisson\", \"Binomial Negativa\")\n\n## Mapas da predi√ß√£o Poisson e Binomial Negativa\ntm_shape(modelo_riq_pred) +\n    tm_raster(pal = \"viridis\", title = c(\"N√∫mero de esp√©cies\", \"N√∫mero de esp√©cies\"),\n              style = \"fisher\") +\n    tm_facets(free.scales.raster = TRUE)"},{"path":"cap15.html","id":"para-se-aprofundar-11","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.12 Para se aprofundar","text":"","code":""},{"path":"cap15.html","id":"livros-9","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.12.1 Livros","text":"Listamos aqui principais refer√™ncias sobre manipula√ß√£o, visualiza√ß√£o de dados geoespaciais e an√°lises geoespaciais R. Recomendamos aos interessados os livros: ) Lovelace, Nowosad & Muenchow (2019) Geocomputation R, ii) Mas et al. (2019) An√°lise espacial com R, iii) Olaya (2020) Sistemas de Informaci√≥n Geogr√°fica, iv) Moraga (2019) Geospatial Health Data: Modeling Visualization R-INLA Shiny, v) Brunsdon & Comber (2015) Introduction Spatial Analysis Mapping R, vi) Wegmann, Leutner & Dech (2016) Remote Sensing GIS Ecologists: Using Open Source Software, vii) Wegmann, Schwalb-Willmann & Dech (2020) Introduction Spatial Data Analysis Remote Sensing GIS Open Source Software, viii) Fletcher & Fortin (2018) Spatial ecology conservation modeling: Applications R, ix) Lapaine, Miljenko, Usery, E. Lynn (2017) Choosing Map Projection.","code":""},{"path":"cap15.html","id":"links-10","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.12.2 Links","text":"Awesome GeospatialSpatial Data ScienceIntro GIS Spatial AnalysisIntroduction Spatial Data Programming RR Geographic Data ScienceSpatial Data Science RSpatial Modelling Data ScientistsPredictive Soil Mapping R","code":""},{"path":"cap15.html","id":"exerc√≠cios-11","chapter":"Cap√≠tulo 15 Dados geoespaciais","heading":"15.13 Exerc√≠cios","text":"15.1\nImporte o limite dos estados brasileiros formato sf com o nome br. Para isso, use fun√ß√£o ne_states pacote rnaturalearth. Crie um mapa simples cinza utilizando fun√ß√£o plot(), selecionando coluna geometry com o operador $ e com os argumentos axes e graticule verdadeiros.15.2\nDados vetoriais podem ser criados com diversos erros de topologia, e.g., sobreposi√ß√£o de linhas ou pol√≠gonos ou buracos. Algumas fun√ß√µes exigem que os objetos vetoriais aos quais s√£o atribu√≠dos esses dados n√£o possuam esses wrros para que o algoritmo funcione. Para verificar se h√° erros, podemos usar fun√ß√£o st_is_valid() pacote sf. H√° diversas forma de corre√ß√µes desses erros, mas vamos usar uma corre√ß√£o simples R, com fun√ß√£o st_make_valid(). Vamos fazer essa corre√ß√£o para o br importado anteriormente e atribuindo ao objeto br_valid. Podemos conferir para saber se h√° erros e fazer um plot.15.3\nCrie um objeto RasterLayer vazio chamado ra com resolu√ß√£o de 5¬∫ (~600 km). Atribua um sistema de refer√™ncia de coordendas com o c√≥digo 4326. Atribua valores aleat√≥rios de uma distribui√ß√£o normal e plote o mesmo.15.4\nReprojete o limite dos estados brasileiros exerc√≠cio anterior para o CRS SIRGAS 2000/Brazil Polyconic, utilizando o c√≥digo EPSG:5880 e chamando de br_poly. Fa√ßa um mapa simples como exerc√≠cio 1. Atente para curvaturas das linhas.15.5\nUtilizando fun√ß√£o st_centroid pacote sf, crie um vetor chamado br_valid_cen que armazenar√° o centroide de cada estado brasileiro objeto br_valid exerc√≠cio 2 e plot o resultado.15.6\nAjuste o limite e m√°scara objeto raster criado exerc√≠cio 3 para o limite Brasil, atribuindo ao objeto ra_br. Depois reprojete esse raster para mesma proje√ß√£o utilizada exerc√≠cio 4 com o nome ra_br_poly e plote o mapa resultante.15.7\nExtraia os valores de cada pixel raster criado exerc√≠cio 6 para os centroides dos estados Brasil criado exerc√≠cio 5, atribuindo √† coluna val objeto espacial chamado br_valid_poly_cent_ra.15.8\nCrie um mapa final usando os resultados dos exerc√≠cios 4, 5 e 6. Utilize o pacote tmap e inclua todos os principais elementos de um mapa.Solu√ß√µes dos exerc√≠cios.","code":""},{"path":"gloss√°rio.html","id":"gloss√°rio","chapter":"Gloss√°rio","heading":"Gloss√°rio","text":"Nesse gloss√°rio, resumimos os principais conceitos e defini√ß√µes dos termos utilizados texto principal que possam ser desconhecidos ou pouco claros para alguns leitores().Abundance-based Coverage Estimator (ACE): estimador de riqueza de esp√©cies baseado na abund√¢ncia de esp√©cies rarasAgrega√ß√£o (raster): aumentar o tamanho dos pixels (diminuindo resolu√ß√£o) de um raster, agregando os valores dos pixels em um pixel maiorAgrupamento filogen√©tico: esp√©cies coexistindo nas comunidades s√£o mais aparentadas que esperado pelo acasoAlinhamento (raster): ajusta o tamanho pixel, extens√£o, n√∫mero e origem dos pixels para v√°rias camadas rastersAmbiente ou Environment (RStudio): por√ß√£o onde os objetos criados s√£o armazenadosAmostra: subconjunto da popula√ß√£o, selecionados por um processo adequado de amostragem, utilizado para estimar caracter√≠sticas de toda popula√ß√£oAn√°lise de covari√¢ncia (ANCOVA): √© uma extens√£o da ANOVA com adi√ß√£o de uma covari√°vel medida em todas unidades amostraisAn√°lise de vari√¢ncia (ANOVA): √© um teste estat√≠stico que avalia se h√° diferen√ßas entre m√©dias de tr√™s ou mais grupos independentes. Existem uma variedade de delineamentos experimentais como - ANOVA de um fator, ANOVA de dois fatores, ANOVA em blocos aleatorizados, ANOVA de medidas repetidas e ANOVA split-splot - que diferem na maneira que o teste estat√≠stico e os graus de liberdade s√£o calculadosAn√°lise param√©trica: assume que os dados foram amostrados de uma distribui√ß√£o de forma conhecida (e.g., gaussiana, poisson, etc) e estima os par√¢metros (e.g., m√©dia, desvio padr√£o, etc) da distribui√ß√£o partir dos dadosAn√°lise n√£o param√©trica: n√£o pressup√µe que os dados foram amostrados de uma distribui√ß√£o de forma conhecida (e.g., gaussiana, poisson, etc)Array: classe de objetos que representa elementos de um √∫nico modo formato de combina√ß√£o de tabelas, com linhas, colunas e dimens√µes√Årvore filogen√©tica: s√£o hip√≥teses que representam o rela√ß√£o de parentesco entre esp√©cies (pode ser tamb√©m indiv√≠duos, genes, etc.) com informa√ß√µes sobre quais esp√©cies compartilham um ancestral comum e dist√¢ncia (tempo, gen√©tica, ou diferen√ßas nos caracteres) que separamAtributo funcional: uma propriedade mensur√°vel dos organismos (geralmente em n√≠vel individual) que representa caracter√≠sticas morfol√≥gicas, fisiol√≥gicas ou fenol√≥gicas que afetam aptid√£o alterando aspectos crescimento, reprodu√ß√£o e sobreviv√™nciaAtributos dos objetos: s√£o o modo (natureza) e estrutura (organiza√ß√£o) dos elementos nos objetosAutovalor(Eigenvalue): n√∫mero inteiro (escalar) que multiplica um vetor, sendo portanto m√∫ltiplo deste. Esses valores representam vari√¢ncia dos eixos e, se convertidos em valores relativos, medem porcentagem de vari√¢ncia contida em cada eixo.Autovetor (Eigenvector): vetor n√£o nulo que muda somente quando √© multiplicado por um escalar. O autovetor de uma matriz √© encontrado pelo resultado da\nmultiplica√ß√£o de um vetor pela matriz, que √© igual lambda vezes o vetor. Esse vetor resultado passa ser o autovetor, e o lambda o seu respectivo autovalorBloco (ANOVA): √© uma √°rea ou per√≠odo de tempo dentro qual condi√ß√µes ambientais s√£o relativamente homog√™neas. O objetivo uso dos blocos √© controlar fontes de varia√ß√µes indesejadas na vari√°vel dependente que n√£o s√£o de interesse pesquisadorBootstrap: estimador de riqueza de esp√©cies que estima os par√¢metros de uma popula√ß√£o por reamostragensBuffer (vetor): pol√≠gono que representam √°rea dentro de uma determinada dist√¢ncia de um dado vetorial, podendo ser partir de um ponto, linha ou pol√≠gonoCamada (vetor ou raster): termo geral, mas geralmente associada √† diferentes rasters reunidos num mesmo arquivoCentroide (vetor ou raster): ponto central de uma fei√ß√£o vetorial ou o centro pixel rasterCentr√≥ide (multivariado): m√©dia ponderada de um conjunto multivariado, menor dist√¢ncia m√©dia de todos os objetos num espa√ßo multivariadoChao 1: estimador de riqueza de esp√©cies baseado na abund√¢ncia das esp√©cies singleton e doubletons dentro de uma amostraChao 2: estimador de riqueza de esp√©cies baseado na incid√™ncia (presen√ßa e aus√™ncia) das esp√©cies singleton e doubletons dentro de uma amostraClado: um grupo de esp√©cies aparentadas descendendo de um √∫nico n√≥ na filogeniaCoeficiente de correla√ß√£o: indica for√ßa da rela√ß√£o linear entre duas vari√°veisCoer√ß√£o (linguagem R): transforma√ß√£o dos modos dos elementos seguindo uma hierarquia: character > double > integer > logicalCombina√ß√£o linear: Combina√ß√£o de v√°rias vari√°veis (vetores) que s√£o multiplicadas por constantes e adicionadas outras vari√°veis. Por exemplo: combina√ß√£o linear de x, y, z pode ser escrita como ax++cz.Community Mean Nearest Taxon Distance (COMDISTNT): m√©trica de diversidade beta que calcula m√©dia da dist√¢ncia filogen√©tica/funcional entre o t√°xon mais pr√≥ximo das esp√©cies de duas comunidadesCommunity Mean Pairwise Distance (COMDIST): m√©trica de diversidade beta que calcula m√©dia da dist√¢ncia filogen√©tica/funcional entre esp√©cies de duas comunidadesConsole (RStudio): onde vers√£o da linguagem R instalada √© carregada para executar os c√≥digos RStudioConvers√£o (linguagem R): transforma√ß√£o dos modos ou estrutura dos elementos de um objeto partir de fun√ß√µes espec√≠ficasConvers√µes raster-vetor: transformar dados vetoriais em rasters (rasteriza√ß√£o) e transformar rasters em vetores (vetoriza√ß√£o)Convex Hull: medida multivariada derivada da computa√ß√£o geom√©trica que calcula o espa√ßo dos atributos de uma esp√©cie ou de v√°rias esp√©cies em uma comunidadeCorrela√ß√£o: √© um teste que mede for√ßa relativa da rela√ß√£o linear entre duas vari√°veis cont√≠nuas. an√°lise de correla√ß√£o n√£o assume que vari√°vel X influencie vari√°vel Y, ou que exista uma rela√ß√£o de causa e efeito entre elasCortes e m√°scaras (raster): ajusta o tamanho de um dado raster uma √°rea menor de interesse, geralmente definido por um dado vetorialCovari√°vel: vari√°vel cont√≠nua que potencialmente afeta vari√°vel resposta, mas n√£o √© necessariamente controlada ou manipulada pelo pesquisadorCrit√©rio de Informa√ß√£o de Akaike (Akaike Information Criterion - AIC): √© uma m√©trica para sele√ß√£o de modelos. Ele √© usado para determinar qual entre os m√∫ltiplos modelos √© o mais prov√°vel de prever os dados observados, ponderando pelo n√∫mero de par√¢metros dos modelos. Os menores valores de AIC representam modelos com memlhores ajustes aos dadosCurva de domin√¢ncia: veja Diagrama de WhittakerDados geoespaciais: s√£o dados georreferenciados que express√£o informa√ß√µes espaciais, podendo ser formato vetorial ou matricial (raster)Dados matriciais (raster): consistem em uma matriz (com linhas e colunas) em que os elementos representam c√©lulas, geralmente igualmente espa√ßadas (pixels)Dados tidy: dados organizados, com foco na limpeza e organiza√ß√£o dos mesmos, de modo que os dados est√£o tidy quando: ) vari√°veis est√£o nas colunas, ii) observa√ß√µes est√£o nas linhas e iii) valores est√£o nas c√©lulas, sendo que para esse √∫ltimo, n√£o deve haver mais de um valor por c√©lulaDados vetoriais: s√£o representa√ß√µes geom√©tricas (pontos, linhas e pol√≠gonos) usadas para mapear fen√¥menos ou objetos espacialmente expl√≠citos que possuem localiza√ß√£o ou dimens√µes bem definidas, aos quais s√£o atribu√≠das informa√ß√µes tabularesData frame: classe de objetos que representa dados formato de tabela, com linhas e colunas, mas comportam mais de um modo em suas colunasData Science: nova √°rea de conhecimento que vem se moldando partir desenvolvimento da sociedade em torno da era digital e da grande quantidade de dados gerados e dispon√≠veis pela internetDatum: simplificadamente √© rela√ß√£o sistema de coordenadas (geogr√°fica ou projetada) com superf√≠cie da TerraDendrograma: diagrama representando uma √°rvore que organiza elementos, objetos e vari√°veis por suas semelhan√ßas de maneira hier√°rquica ascendente. Desse modo, objetos mais pr√≥ximos compartilham maior semelhan√ßa que objetos distantes dendrograma.Desagrega√ß√£o (raster): diminui o tamanho dos pixels (aumentando resolu√ß√£o) de um raster, preenchendo com novos valores que depende tipo de fun√ß√£o de preenchimento utilizadaDeviance: √© um termo estat√≠stico que mede o ajuste modelo (goodness fit). Quanto menor o valor de deviance melhor o modeloDiagrama de Whittaker: m√©todo que utiliza informa√ß√µes visuais ao plotar esp√©cies ranqueadas eixo X da mais abundante para menos abundante, enquanto eixo Y abund√¢ncias relativas das esp√©cies s√£o plotadas em escala logar√≠tmicaDiret√≥rio de trabalho: endere√ßo da pasta (ou diret√≥rio) de onde o R importar√° ou exportar dadosDispers√£o filogen√©tica: esp√©cies coexistindo nas comunidades s√£o menos aparentadas que esperado pelo acasoDistribui√ß√£o de probabilidade: √© uma fun√ß√£o estat√≠stica que descreve todos os valores e probabilidades poss√≠veis que uma vari√°vel aleat√≥ria pode assumir dentro de um determinado intervaloDistribui√ß√£o Gaussiana: veja distribui√ß√£o normalDistribui√ß√£o normal: √© uma distribui√ß√£o de probabilidade em formato de sino que √© sim√©trica em torno da m√©dia, mostrando que dados pr√≥ximos √† m√©dia s√£o mais frequentes que dados distantes da m√©dia.Diversidade alfa: √© um conceito caracterizado pela diversidade dentro habitat ou unidade amostralDiversidade beta: √© um conceito caracterizado pela varia√ß√£o na diversidade entre habitats ou unidades amostraisDiversidade beta filogen√©tica: engloba m√©tricas que utilizam dados de presen√ßa e aus√™ncia ou abund√¢ncia das esp√©cies para determinar um valor que representa diferen√ßa entre comunidades em rela√ß√£o hist√≥ria evolutiva das linhagensDiversidade de esp√©cies: √© um conceito que representa o n√∫mero de esp√©cies e distribui√ß√£o de abund√¢ncia destas esp√©cies em uma comunidadeDiversidade filogen√©tica: engloba m√©tricas que capturam ancestralidade compartilhada entre esp√©cies em termos de quantidade da hist√≥ria evolutiva e o grau de parentesco entre esp√©ciesDiversidade funcional: √© um conceito que captura varia√ß√£o grau de express√£o de diferentes atributos funcionais entre diferentes popula√ß√µes, comunidades ou ecossistemasDiversidade gama: √© um conceito caracterizado pela combina√ß√£o da diversidade alfa e beta ou definido como diversidade regional englobando todos os habitat ou unidades amostraisDoubletons: n√∫mero de esp√©cies observadas com abund√¢ncia de dois indiv√≠duosDuplicate: n√∫mero de esp√©cies observadas em apenas duas amostrasEquitabilidade de Pielou: √© uma m√©trica que descreve o padr√£o de distribui√ß√£o da abund√¢ncia relativa das esp√©cies na comunidadeErro Tipo : rejeitar hip√≥tese nula de um teste estat√≠stico quando ela √© verdadeiraErro Tipo II: aceitar hip√≥tese nula de um teste estat√≠stico quando ela √© falsaEscalar: n√∫mero inteiro com o qual geralmente se faz opera√ß√µes com matrizes (e.g., multiplica√ß√£o ou adi√ß√£o)Escores: posi√ß√£o das unidades amostrais ao longo de um eixo de ordena√ß√£o. Pode se referir tanto objetvos quanto √† vari√°veis. Escores s√£o fornecidos pela substitui√ß√£o dos valores assumidos pelas vari√°veis originais nas combina√ß√µes lineares. S√£o utilizados para ordenar unidades amostrais em um diagrama uni, bi ou tridimensionalESRI Shapefile (vetor): principal formato de dados vetoriais, composto pelo menos de quatro arquivos: .shp (fei√ß√£o), .dbf (tabela de atributos), .shx (liga√ß√£o entre .shp e .dbf) e .prj (proje√ß√£o)Estat√≠stica frequentista: s√£o an√°lises param√©tricas que estimam probabilidades das frequ√™ncias observadas dos eventos e usam essas probabilidades como base para infer√™ncias.Estrutura dos objetos: diz respeito √† organiza√ß√£o dos elementos, com rela√ß√£o aos modos e dimensionalidade da disposi√ß√£o desses elementos. De modo bem simples, os elementos podem ser estruturados em seis tipos: ) vetor, ii) fator, iii) matriz, iv) array, v) data frame e vi) listasExtens√£o (vetor e raster): limites geogr√°ficos de dados geoespaciais (vetor e raster), composto por dois pares de coordenadas de longitude e de latitudeExtra√ß√£o (vetor e raster): identifica e retorna valores associados de pixels de um raster com base em um objeto vetorial (ponto, linha e pol√≠gono)Extrapola√ß√£o: √© o processo de estimar, al√©m intervalo de observa√ß√£o original, o valor de uma vari√°vel com base em sua rela√ß√£o com outra vari√°velFator: classe de objetos que representa o encadeamento de elementos de um √∫nico modo (integer) numa sequ√™ncia unidimensional, representando medidas de uma vari√°vel categ√≥rica, podendo ser nominal ou ordinalFator aleat√≥rio: pesquisador amostra aleatoriamente os n√≠veis de um fator na popula√ß√£oFator fixo: pesquisador controla todos os n√≠veis fator sobre os quais infer√™ncias devem ser feitasFator de infla√ß√£o da vari√¢ncia (VIF): √© um teste que quantifica quanto erro padr√£o dos coeficientes estimados est√£o inflados devido √† multicolinearidadeFei√ß√£o (vetor): um elemento dado vetorial associado √† cada linha da tabela de atributosFen√¥meno: Um evento, entidade ou rela√ß√£o observ√°velFun√ß√µes: classe de objetos que possui c√≥digos preparados para realizar uma tarefa espec√≠fica de modo simples, realizando opera√ß√µes em argumentosGeneralized Least Squares (GLS): √© um teste estat√≠stico utilizado para estimar coeficientes desconhecidos de um modelo de regress√£o linear quando vari√°vel independente √© correlacionada com os res√≠duosGeoPackage (vetor e raster): banco de dados geoespacial que armazena em apenas um arquivo, dados formato vetorial, raster e tamb√©m dados n√£o-espaciais (e.g., tabelas)GeoTIFF (raster): principal formato para dados raster, composto geralmente de um arquivo TIFF contendo metadados geoespaciais adicionaisGitHub: √© um resposit√≥rio de hospedagem de c√≥digo-fonte e arquivos com controle de vers√µes de projetos abertosGoodness fit: refere-se um teste estat√≠stico que determina qu√£o bem os dados da amostra se ajustam uma distribui√ß√£o de uma popula√ß√£oGrau de liberdade: √© o n√∫mero de observa√ß√µes nos dados que s√£o livres para variar quando estimamos os valores dos par√¢metros populacionais desconhecidosHip√≥tese: Afirma√ß√£o test√°vel derivada ou representando v√°rios componentes de uma teoriaHip√≥tese alternativa (H1): √© um conceito estat√≠stico que sugere que diferen√ßas entre grupos ou fen√¥menos medidos s√£o maiores que o esperado devido varia√ß√µes aleat√≥rias. H1 √© o oposto da hip√≥tese nula.Hip√≥tese nula (H0): √© um conceito estat√≠stico que sugere que diferen√ßas entre grupos ou fen√¥menos medidos n√£o s√£o maiores que o esperado devido varia√ß√µes aleat√≥rias. Presume-se que hip√≥tese nula √© verdadeira at√© que evid√™ncias indiquem o contr√°rio.Homocedasticidade: √© um dos pressupostos dos testes param√©tricos como ANOVA, Teste T e regress√£o linear simples que vari√¢ncia da vari√°vel dependente deve ser constante para os valores das vari√°veis preditoras. Sin√¥nimo de homogeneidade da vari√¢nciaHomogeneidade da vari√¢ncia: veja homocedasticidadeIndepend√™ncia estat√≠stica: dois eventos s√£o independentes se ocorr√™ncia de um evento n√£o influenciar probabilidade que o outro evento ir√° ou n√£o ocorrerIndexa√ß√£o (linguagem R): acessa elementos de objetos por sua posi√ß√£o utilizando os operadores [] e [[]] ou por seu nome com o operador $ depois nome objeto√çndice de diversidade: m√©tricas que calculam riqueza de esp√©cies e distribui√ß√£o de abund√¢ncia para cada esp√©cie dentro das comunidades.√çndice de Gini-Simpson: m√©trica que quantifica probabilidade de dois indiv√≠duos retirados ao acaso da comunidade pertencerem esp√©cies diferentes. √â o inverso √≠ndice de Simpson√çndice de Margalef: m√©trica que calcula riqueza de esp√©cies ponderando abund√¢ncia total dentro de cada comunidade√çndice de Menhinick: m√©trica que calcula riqueza de esp√©cies ponderando abund√¢ncia total dentro de cada comunidade√çndice de Shannon-Wiener: m√©trica de diversidade de esp√©cies que quantifica incerteza associada em predizer identidade de uma esp√©cie dado o n√∫mero de esp√©cies e distribui√ß√£o de abund√¢ncia para cada esp√©cie√çndice de Simpson: m√©trica que quantifica probabilidade de dois indiv√≠duos retirados ao acaso da comunidade pertencerem √† mesma esp√©cieInf (Infinito): √© um n√∫mero muito grande ou um limite matem√°ticoIntera√ß√£o raster-vetor: opera√ß√µes derivadas da intera√ß√£o entre raster-vetor, como ajuste tamanho raster ou extra√ß√£o dos valores dos pixels para dados vetoriais (pontos, linhas e pol√≠gonos)Interpola√ß√£o: √© o processo de estimar, dentro um dom√≠nio de valores conhecidos, um valor desconhecido com base em sua rela√ß√£o com outra vari√°velJackknife 1: estimador de riqueza de esp√©cies baseado n√∫mero de esp√©cies que ocorrem em somente uma amostra (uniques)Jackknife 2: estimador de riqueza de esp√©cies baseado n√∫mero de esp√©cies que ocorrem em somente uma amostra (uniques) e n√∫mero de esp√©cies ocorrem em exatamente duas amostras (duplicates)Jun√ß√£o de tabelas: combina√ß√£o de pares de conjunto de dados tabulares por uma ou mais colunas chavesLikelihood-ratio test (LRT): √© um teste estat√≠stico que mede o grau ajuste (goodness--fit) entre dois modelos aninhados. Um modelo relativamente mais complexo √© comparado um modelo mais simples para ver se ele se ajusta significativamente melhor um determinado conjunto de dados. Ele testa se h√° necessidade de se incluir uma vari√°vel extra modelo para explicar os dadosLinguagem R: ambiente de software livre para computa√ß√£o estat√≠stica e cria√ß√£o de gr√°ficosLista: classe de objetos que √© tipo especial de vetor que aceita objetos como elementosLoading: Correla√ß√µes de Pearson entre cada vari√°vel original com cada eixo. Os valores ser√£o maiores (positiva ou negativamente) para aquelas vari√°veis que forem mais importantes na forma√ß√£o de um dado eixo. Desse modo, representam o peso de uma vari√°vel para constru√ß√£o de um eixo e variam de -1 1.asLoop : fun√ß√£o em que um bloco de c√≥digos √© repetido mudando um contador de uma lista de possibilidadesMapa: representa√ß√£o bidimensional de elementos geoespaciais em uma propor√ß√£o menor, podendo representar dados vetoriais ou raster, com diversos elementos visuais e textuais que facilitam interpreta√ß√£o elemento geoespacial mapeadoMapas animados: mapas que incorporam anima√ß√µes para expressar mudan√ßas nos padr√µes espaciais ou ao longo tempoMapas est√°ticos: mapas simples e fixos para visualiza√ß√£o de dados, sendo o tipo mais comum de sa√≠da visualMapas interativos: mapas que incorporam capacidade de deslocar e ampliar qualquer parte de um conjunto de dados geoespaciais sobreposto em um ‚Äúmapa da web‚ÄùMatriz: classe de objetos que representa elementos de um √∫nico modo formato de tabela, com linhas e colunasM√°xima Verossimilhan√ßa: √© um m√©todo que determina valores para os par√¢metros de um modelo. Os valores dos par√¢metros s√£o encontrados de tal forma que maximizam probabilidade de que o processo descrito pelo modelo produza os dados que foram realmente observadosMean Pairwise Distance (MPD): √© uma m√©trica que utiliza matriz de dist√¢ncia filogen√©tica para quantificar dist√¢ncia m√©dia parentesco entre pares de esp√©cies em uma comunidadeMean Nearest Taxon Distance (MNTD): √© uma m√©trica que utiliza matriz de dist√¢ncia filogen√©tica para quantificar m√©dia dos valores m√≠nimos de parentesco entre pares de esp√©cies em uma comunidade. Ou seja, qual o valor m√©dio da dist√¢ncia para o vizinho mais pr√≥ximoMecanismo: Intera√ß√£o direta de uma rela√ß√£o causal que resulta em um fen√¥menoModo dos objetos: diz respeito √† natureza dos elementos que comp√µem os dados e que foram atribu√≠dos aos objetos. Os modos geralmente s√£o**: num√©rico tipo inteiro (integer), num√©rico tipo flutuante (double), texto (character), l√≥gico (logical) ou complexo (complex)Modelo misto: pelo menos um fator experimento √© fixo, e pelo menos um fator √© aleat√≥rio.Modelo nulo: √© um procedimento estat√≠stico que usa aleatoriza√ß√µes para gerar distribui√ß√µes de valores para uma determinada vari√°vel de interesse na aus√™ncia processo causal em quest√£oMulticolinearidade: √© um conceito estat√≠stico onde vari√°veis independentes em um modelo s√£o correlacionadasNA (Available): significa dado faltante ou indispon√≠velNaN (Number): representa indefini√ß√µes matem√°ticasNearest Relative Index (NRI): m√©trica que calcula o tamanho efeito padronizado para m√©trica Mean Pairwise Distance.Valores positivos de NRI indicam agrupamento filogen√©tico enquanto valores negativos de NRI indicam dispers√£o filogen√©ticaNearest Taxon Index (NTI): m√©trica que calcula o tamanho efeito padronizado para m√©trica Mean Nearest Taxon Distance.Valores positivos de NTI indicam agrupamento filogen√©tico enquanto valores negativos de NTI indicam dispers√£o filogen√©ticaNetCDF (raster): Network Common Data Form √© um conjunto de bibliotecas de software e formatos de dados independentes que suportam cria√ß√£o, acesso e compartilhamento de dados cient√≠ficos orientados arraysN√≥: o ponto onde uma linhagem d√° origem duas ou mais linhagens descendentesNormalidade dos res√≠duos: √© um dos pressupostos dos testes param√©tricos como ANOVA, Teste T e regress√£o linear simples que dependem que os res√≠duos modelo apresentem distribui√ß√£o normal ou gaussiana.NULL (Nulo): representa um objeto nulo, sendo √∫til para preenchimento em aplica√ß√µes de programa√ß√£oN√∫meros de Hill: √© uma m√©trica que transforma riqueza e distribui√ß√£o da abund√¢ncia das esp√©cies em n√∫meros efetivos de esp√©cies ou diversidade verdadeiraN√∫mero efetivo de esp√©cies: √© o n√∫mero de esp√©cies igualmente abundantes (.e.¬†todas esp√©cies com mesma abund√¢ncia) necess√°rias para produzir o valor observado para um determinado √≠ndiceObjetos: palavras √†s quais s√£o atribu√≠dos dados atrav√©s da atribui√ß√£o. cria√ß√£o de objetos possibilita manipula√ß√£o de dados ou armazenar os resultados de an√°lises. Em outras linguagens de programa√ß√£o s√£o denominadas vari√°veisOpera√ß√µes geoespaciais: s√£o opera√ß√µes para acessar ou alterar propriedades n√£o-espaciais, espaciais e geom√©tricas dos dados geoespaciais, divididas em**: opera√ß√µes de atributos, opera√ß√µes espaciais e opera√ß√µes geom√©tricasOpera√ß√µes geoespaciais de atributos: modifica√ß√£o de objetos geoespaciais baseado em informa√ß√µes n√£o espaciais associadas dados geoespaciais, como tabela de atributos ou valores das c√©lulas e nome das camadas dos rastersOpera√ß√µes geoespaciais espaciais: modifica√ß√µes de objetos geoespaciais baseado em informa√ß√µes espaciais, como localiza√ß√£o e formatoOpera√ß√µes geoespaciais geom√©tricas: modifica√ß√µes em objetos geoespaciais baseado na geometria vetor ou raster e na intera√ß√£o e convers√£o entre vetor-rasterOperadores: conjuntos de caracteres que realiza opera√ß√µes, agrupados em cinco tipos principais**: aritm√©ticos, relacionais, l√≥gicos, atribui√ß√£o e diversosPacotes (linguagem R): conjuntos extras de fun√ß√µes para executar tarefas espec√≠ficasPadr√£o: Eventos repetidos, entidades recorrentes ou rela√ß√µes replicadas tempo ou espa√ßoPhylogenetic Diversity (PD): √© uma m√©trica definida pela soma comprimento dos ramos conectando todas esp√©cies na comunidadePhylogenetic Endemism (PE): √© uma m√©trica que calcula fra√ß√£o dos ramos restritos regi√µes espec√≠ficasPhylogenetic index beta diversity (Phylosor): m√©trica de similaridade que determina o comprimento total dos ramos da filogenia que √© compartilhado entre pares de comunidadesPhylogenetic Species Richness (PSR): √© uma m√©trica diretamente compar√°vel ao n√∫mero de esp√©cies na comunidade, mas inclui o parentesco filogen√©tico entre esp√©ciesPhylogenetic Species Variability (PSV): √© uma m√©trica que estima quantidade relativa dos comprimentos dos ramos n√£o compartilhados entre comunidadesPipe (%>%): operador implementado por uma fun√ß√£o que faz com o que o resultado de uma fun√ß√£o seja o primeiro argumento da fun√ß√£o seguinte, permitindo o encadeamento de v√°rias fun√ß√µes eliminando necessidade de criar objetos para armazenar resultados intermedi√°riosPivotagem de dados: transporte de dados que est√£o em linhas para colunas e vice-versa, fazendo refer√™ncia cruzada ou rotacionando os dados. Partirmos de dados formato longo (long, muitas linhas e poucas colunas) e criamos dados formato largo (wide, poucas linhas e muitas colunas) e vice-versaPixel (raster): tamb√©m chamado c√©lula, √© unidade geoespacial raster, representando o elemento da matriz de dadosPol√≠gono convexo: opera√ß√£o que liga os pontos externos de um conjunto de pontos e cria um pol√≠gono partir delesPol√≠gono de Voronoi: pol√≠gonos irregulares s√£o criados partir da proximidade dos pontos, de modo estimar uma √°rea de abrang√™ncia entorno dos mesmosPolitomia: tr√™s ou mais linhagens descendendo de um √∫nico n√≥Popula√ß√£o: √© um conjunto de indiv√≠duos ou elementos semelhantes que interessa para alguma pergunta ou hip√≥tesePopula√ß√£o amostral: √© um conjunto de indiv√≠duos ou elementos semelhantes que est√£o de fato acess√≠vel para serem amostradosPredi√ß√£o espacial: utiliza os coeficientes de um modelo ajustado para gerar um raster de predi√ß√£o para todos os pixels considerando os dados preditores de entrada modelo, extrapolando predi√ß√£o da respostaPredi√ß√£o: uma declara√ß√£o de expectativa deduzida da estrutura l√≥gica ou derivada da estrutura causal de uma teoriaPressuposto: condi√ß√µes necess√°rias para sustentar uma hip√≥tese ou constru√ß√£o da teoriaPrincipais elementos de um mapa: um mapa possui diversos elementos que facilitam sua interpreta√ß√£o, dentre eles: ) mapa principal, ii) mapa secund√°rio iii) t√≠tulo, iv) legenda (apresentando informa√ß√µes detalhadas das classes ou escala de valores, v) barra de escala, vi) indicador de orienta√ß√£o (Norte), vii) gride de coordenadas e viii) descri√ß√£o CRSProcesso: um subconjunto de fen√¥menos em que os eventos seguem uns aos outros tempo ou espa√ßo, que podem ou n√£o serem causalmente conectados. √â causa, mecanismo ou limita√ß√£o explicando um padr√£oPrograma√ß√£o Funcional: organiza√ß√£o c√≥digo como fun√ß√µes e vari√°veis que trabalham de forma unificada para resolu√ß√£o de um problemaProjeto RStudio: arquivo formato .Rproj que facilita o trabalho com o RStudio, pois define o diret√≥rio automaticamente e permite o controle de vers√£oPull request: √© um m√©todo de submeter contribui√ß√µes que ser√£o revisadas pelos respons√°veis de um projeto de desenvolvimento abertoRaiz: representa o ancestral comum de todas esp√©cies na filogeniaRamo: uma linha orientada ao longo de um eixo terminais-raiz que conecta os n√≥s na filogeniaRarefa√ß√£o: √© uma m√©trica usada para calcular o n√∫mero esperado de esp√©cies em cada comunidade tendo como base comparativa um valor em que todas amostras ou n√∫mero de indiv√≠duos atinjam um tamanho padr√£o entre comunidadesRarefa√ß√£o baseada nas amostras (Sampled-based): compara√ß√µes s√£o padronizadas pela comunidade com menor n√∫mero de amostragensRarefa√ß√£o baseada na cobertura (Coverage-based): √© uma medida que determina propor√ß√£o de amostras ou n√∫mero de indiv√≠duos da comunidade que representa esp√©cies amostradasRarefa√ß√£o baseada nos indiv√≠duos (Individual-based): compara√ß√µes s√£o feitas considerando abund√¢ncia da comunidade padronizada pelo menor n√∫mero de indiv√≠duosRasteriza√ß√£o: convers√£o de dados vetoriais para raster realizada de pontos, linhas ou pol√≠gonos para rastersRegress√£o: √© um teste usado para analisar rela√ß√£o entre uma ou mais vari√°veis preditoras (Xn) e uma vari√°vel resposta (Y). regress√£o assume uma rela√ß√£o de causa e efeito entre vari√°veisReproje√ß√£o: transforma√ß√£o Sistema de Refer√™ncia de Coordenadas (CRS) de um dado geoespacial, alterando o CRS original para outro. Na reproje√ß√£o alteramos tanto unidade dado geoespacial mudando o Sistema de Coordenadas Geogr√°ficas (unidades em ‚Äòlongitude/latitude‚Äô) para Projetado (unidades de metros, e vice-versa), quando o DatumRes√≠duo: √© diferen√ßa entre os valores predito e observado dos dados. S√£o tamb√©m chamados de erroResolu√ß√£o (raster): termo amplo que pode ser usado em diversos contextos. Para dados raster, √© geralmente associado ao tamanho (dimens√£o) pixel (.e., altura e largura)RStudio: ambiente de desenvolvimento integrado (IDE) para R. Inclui um console, editor de realce de sintaxe que suporta execu√ß√£o direta de c√≥digo, bem como ferramentas para plotagem, hist√≥rico, depura√ß√£o e gerenciamento de espa√ßo de trabalhoScript (RStudio): arquivos de texto simples, criados com extens√£o (termina√ß√£o) .R onde os c√≥digos s√£o escritos e salvosSele√ß√£o de modelos: √© um processo usado para comparar o valor relativo de diferentes modelos estat√≠sticos e determinar qual deles √© o mais adequado para os dados observadosS√©rie de Hill: veja N√∫mero de HillSingleton: n√∫mero de esp√©cies observadas com abund√¢ncia de um indiv√≠duoSistema de Coordenadas: composto por dois sistemas, o Sistema de Coordenadas Geogr√°ficas e o Sistema de Coordenadas Projetadas, que utilizam duas unidades √¢ngulos ou metros, respectivamente, para representa√ß√£o geogr√°ficaSistema de Refer√™ncia de Coordenadas (CRS): tamb√©m chamada proje√ß√£o, define refer√™ncia geoespacial dos dados vetor e raster na superf√≠cie da Terra, composto pelo Sistema de Coordenadas e DatumTabela de atributos: dado tabular que inclui dados geoespaciais e dados alfanum√©ricos, geralmente associada dados vetoriaisTerminal (ingl√™s tip): o final ramo representando uma esp√©cie atual ou extinta (pode tamb√©m representar g√™neros, indiv√≠duos, genes, etc.)Teste de Levene: √© um teste estat√≠stico utilizado para verificar homogeneidade da vari√¢ncia entre dois ou mais gruposTeste de Shapiro-Wilk: √© um teste estat√≠stico utilizado para verificar se os dados apresentam distribui√ß√£o normalTeste T (de Student): √© um teste estat√≠stico que segue uma distribui√ß√£o t de Student para rejeitar ou n√£o uma hip√≥tese nula de m√©dias iguais entre dois grupos.Teste T pareado: √© um teste estat√≠stico que usa dados medidos duas vezes na mesma unidade amostral, resultando em pares de observa√ß√µes para cada amostra (amostras pareadas). Ele determina se diferen√ßa da m√©dia entre duas observa√ß√µes √© zero..Tibble: classe de objetos que √© uma vers√£o aprimorada data frame. √â classe aconselhada para que fun√ß√µes tidyverse funcionem melhor sobre conjuntos de dados tabularestidyverse: ‚Äúdialeto novo‚Äù para linguagem R, onde tidy quer dizer organizado, arrumado, ordenado, e verse √© universo. Operacionalizado R atrav√©s de uma cole√ß√£o de pacotes que atuam fluxo de trabalho comum da ci√™ncia de dados: importa√ß√£o, manipula√ß√£o, explora√ß√£o, visualiza√ß√£o, an√°lise e comunica√ß√£o de dados e an√°lises. O principal objetivo tidyverse √© aproximar linguagem para melhorar intera√ß√£o entre ser humano e computador sobre dados, de modo que os pacotes compartilham uma filosofia de design de alto n√≠vel e gram√°tica, al√©m da estrutura de dados de baixo n√≠velUltram√©trica: dist√¢ncia de todos os terminais at√© raiz s√£o id√™nticas. Caracter√≠stica requerida pela maioria dos √≠ndices de diversidade filogen√©ticaUnidade amostral: √© o indiv√≠duo (ou elemento) da popula√ß√£o amostral sobre o qual medida de interesse ser√° observadaUnique: n√∫mero de esp√©cies observadas em apenas uma amostraUnique Fraction metric (UniFrac): m√©trica de dissimilaridade que determina fra√ß√£o √∫nica da filogenia contida em cada uma das duas comunidadesValor de P: probabilidade de um teste estat√≠stico ser igual ou maior que o observado, dado que hip√≥tese nula √© verdadeira.Valores faltantes e especiais: valores reservados que representam dados faltantes, indefini√ß√µes matem√°ticas, infinitos e objetos nulosVariance Pairwise Distance (VPD): √© uma m√©trica que utiliza matriz de dist√¢ncia filogen√©tica para quantificar vari√¢ncia parentesco entre pares de esp√©cies em uma comunidadeVari√°vel categ√≥rica: s√£o vari√°veis que n√£o possuem valores quantitativos e s√£o definidas por categorias ou grupos distintosVari√°vel cont√≠nua: s√£o vari√°veis num√©ricas que t√™m um n√∫mero infinito de valores entre dois valores quaisquer. Neste caso, valores fracionais fazem sentidoVari√°vel dependente: √© uma vari√°vel mensurada ou observada de interesse pesquisador que depende valor de outra vari√°velVari√°vel discreta: √© uma vari√°vel num√©rica que t√™m um n√∫mero cont√°vel de valores inteiros.Vari√°vel explicativa: ver vari√°vel independenteVari√°vel independente: vari√°vel mensurada ou observada pelo pesquisador que prev√™ ou afeta vari√°vel dependenteVari√°vel nominal: s√£o vari√°veis categ√≥ricas que n√£o apresentam ordena√ß√£o dentre categorias (e.g., preto, branco e rosa)Vari√°vel ordinal: s√£o vari√°veis categ√≥ricas com ordena√ß√£o entre categorias (e.g., pequeno, m√©dio e grande)Vari√°vel preditora: ver vari√°vel independenteVari√°vel resposta: ver vari√°vel dependenteVariograma: √© uma descri√ß√£o da continuidade espacial dos dados. Ele mede variabilidade entre pares de pontos em v√°rias dist√¢nciasVetor: classe de objetos que representa o encadeamento de elementos de um √∫nico modo numa sequ√™ncia unidimensionalVetor (Multivariada): coluna de uma matrizVetoriza√ß√£o (vetor): convers√£o de dados rasters para vetor, sendo que esse vetor receber√° os valores dos pixels raster, podendo ser convertido em pontos, isolinhas ou pol√≠gonos","code":""},{"path":"refer√™ncias.html","id":"refer√™ncias","chapter":"Refer√™ncias","heading":"Refer√™ncias","text":"","code":""}]
