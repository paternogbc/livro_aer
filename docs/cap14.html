<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cap√≠tulo 14 Diversidade Funcional | An√°lises Ecol√≥gicas no R</title>
<meta name="author" content="Fernando Rodrigues da Silva, Thiago Gon√ßalves-Souza, Gustavo Brant Paterno,   Diogo Borges Provete, Maur√≠cio Humberto Vancine">
<meta name="description" content="Pr√©-requisitos do cap√≠tulo Pacotes, dados e fun√ß√µes que ser√£o utilizados nesse cap√≠tulo. ## Pacotes library(FD) library(ade4) library(ecodados) library(gridExtra) library(ggplot2) library(ggrepel)...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Cap√≠tulo 14 Diversidade Funcional | An√°lises Ecol√≥gicas no R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://analises-ecologicas.netlify.app/cap14.html">
<meta property="og:image" content="https://analises-ecologicas.netlify.app/img/capa.jpeg">
<meta property="og:description" content="Pr√©-requisitos do cap√≠tulo Pacotes, dados e fun√ß√µes que ser√£o utilizados nesse cap√≠tulo. ## Pacotes library(FD) library(ade4) library(ecodados) library(gridExtra) library(ggplot2) library(ggrepel)...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cap√≠tulo 14 Diversidade Funcional | An√°lises Ecol√≥gicas no R">
<meta name="twitter:description" content="Pr√©-requisitos do cap√≠tulo Pacotes, dados e fun√ß√µes que ser√£o utilizados nesse cap√≠tulo. ## Pacotes library(FD) library(ade4) library(ecodados) library(gridExtra) library(ggplot2) library(ggrepel)...">
<meta name="twitter:image" content="https://analises-ecologicas.netlify.app/img/capa.jpeg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">An√°lises Ecol√≥gicas no R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Sum√°rio"><h2>Sum√°rio</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bem-vindos</a></li>
<li><a class="" href="pref%C3%A1cio.html">Pref√°cio</a></li>
<li><a class="" href="dedicat%C3%B3ria.html">Dedicat√≥ria</a></li>
<li><a class="" href="sobre-os-autores.html">Sobre os autores</a></li>
<li><a class="" href="revisores-e-colaboradores.html">Revisores e colaboradores</a></li>
<li><a class="" href="cap1.html"><span class="header-section-number">1</span> Introdu√ß√£o</a></li>
<li><a class="" href="cap2.html"><span class="header-section-number">2</span> Voltando ao b√°sico: como dominar a arte de fazer perguntas cientificamente relevantes</a></li>
<li><a class="" href="cap3.html"><span class="header-section-number">3</span> Pr√©-requisitos</a></li>
<li><a class="" href="cap4.html"><span class="header-section-number">4</span> Introdu√ß√£o ao R</a></li>
<li><a class="" href="cap5.html"><span class="header-section-number">5</span> Tidyverse</a></li>
<li><a class="" href="cap6.html"><span class="header-section-number">6</span> Visualiza√ß√£o de dados</a></li>
<li><a class="" href="cap7.html"><span class="header-section-number">7</span> Modelos lineares</a></li>
<li><a class="" href="cap8.html"><span class="header-section-number">8</span> Modelos Lineares Generalizados</a></li>
<li><a class="" href="cap9.html"><span class="header-section-number">9</span> An√°lises Multidimensionais</a></li>
<li><a class="" href="cap10.html"><span class="header-section-number">10</span> Rarefa√ß√£o</a></li>
<li><a class="" href="cap11.html"><span class="header-section-number">11</span> Estimadores de riqueza</a></li>
<li><a class="" href="cap12.html"><span class="header-section-number">12</span> Diversidade Taxon√¥mica</a></li>
<li><a class="" href="cap13.html"><span class="header-section-number">13</span> Diversidade Filogen√©tica</a></li>
<li><a class="active" href="cap14.html"><span class="header-section-number">14</span> Diversidade Funcional</a></li>
<li><a class="" href="cap15.html"><span class="header-section-number">15</span> Dados geoespaciais</a></li>
<li><a class="" href="gloss%C3%A1rio.html">Gloss√°rio</a></li>
<li><a class="" href="refer%C3%AAncias.html">Refer√™ncias</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/paternogbc/livro_aer">Ver c√≥digo fonte <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cap14" class="section level1" number="14">
<h1>
<span class="header-section-number">Cap√≠tulo 14</span> Diversidade Funcional<a class="anchor" aria-label="anchor" href="#cap14"><i class="fas fa-link"></i></a>
</h1>
<div id="pr√©-requisitos-do-cap√≠tulo-10" class="section level2 unnumbered">
<h2>Pr√©-requisitos do cap√≠tulo<a class="anchor" aria-label="anchor" href="#pr%C3%A9-requisitos-do-cap%C3%ADtulo-10"><i class="fas fa-link"></i></a>
</h2>
<p>Pacotes, dados e fun√ß√µes que ser√£o utilizados nesse cap√≠tulo.</p>
<div class="sourceCode" id="cb529"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Pacotes </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">FD</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ecodados</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel">ggrepel</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">picante</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org">vegan</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">SYNCSA</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">FD</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">betapart</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">TPD</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adrientaudiere/cati">cati</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span>

<span class="co">## Dados e fun√ß√µes</span>
<span class="va">comun_fren_dat</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">fundiv_frenette2012a_comu</span>
<span class="va">ambie_fren_dat</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">fundiv_frenette2012a_amb</span>
<span class="va">trait_fren_dat</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">fundiv_frenette2012a_trait</span>
<span class="va">trait_dat</span>      <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">fundiv_barbaro2009a_trait</span>
<span class="va">comun_dat</span>      <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">fundiv_barbaro2009a_comu</span>
<span class="va">ambie_dat</span>      <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">fundiv_barbaro2009a_amb</span>
<span class="va">trait_baselga</span>  <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">trait_baselga</span>
<span class="va">comm_baselga</span>   <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">comm_baselga</span>
<span class="va">anuros_comm</span>    <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">anuros_comm</span>
<span class="va">traits</span>         <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">traits</span>
<span class="va">env</span>            <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">env</span>
<span class="co"># ecodados::wITV # funtion: wITV</span></code></pre></div>
</div>
<div id="aspectos-te√≥ricos-5" class="section level2" number="14.1">
<h2>
<span class="header-section-number">14.1</span> Aspectos te√≥ricos<a class="anchor" aria-label="anchor" href="#aspectos-te%C3%B3ricos-5"><i class="fas fa-link"></i></a>
</h2>
<p>At√© a d√©cada de 1990, a teoria ecol√≥gica investigava basicamente quais processos determinavam a abund√¢ncia e riqueza de esp√©cies no espa√ßo e tempo. As d√©cadas de 1980 e 1990 foram marcadas por intensos debates sobre as regras de montagem de comunidades e como intera√ß√µes e filtros ambientais determinavam a coexist√™ncia de esp√©cies <span class="citation">(<a href="refer%C3%AAncias.html#ref-strong_ecological_1984" role="doc-biblioref">Strong et al. 1984</a>)</span>. Por√©m, a d√©cada de 2000 foi marcada pelo uso mais expl√≠cito da caracter√≠sticas das esp√©cies como uma vari√°vel fundamental tanto para explicar como a distribui√ß√£o dos organismos seria afetada pelo ambiente, quanto para entender como tais esp√©cies afetariam o ecossistema <span class="citation">(<a href="refer%C3%AAncias.html#ref-diaz_vive_2001" role="doc-biblioref">Dƒ±ÃÅaz and Cabido 2001</a>; <a href="refer%C3%AAncias.html#ref-mcgill_rebuilding_2006" role="doc-biblioref">McGill et al. 2006</a>)</span>. O primeiro estudo que utilizou o termo <em>Diversidade Funcional</em> foi publicado por Williams <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson1967" role="doc-biblioref">1967</a>)</span>, que comparou esp√©cies de na√∫plios filogeneticamente relacionadas e demonstrou que elas possuem alta plasticidade funcional que favorecem ampla varia√ß√£o de comportamentos e, desse modo, permitem que sejam esp√©cies generalistas em ambientes em constante mudan√ßa. A unidade b√°sica desses estudos, o atributo funcional (do ingl√™s ‚Äú<em>functional trait</em>‚Äù), √© definido como uma propriedade mensur√°vel dos organismos (geralmente em n√≠vel individual) que represente caracter√≠sticas morfol√≥gicas, fisiol√≥gicas ou fenol√≥gicas que afetam a aptid√£o alterando aspectos do crescimento, reprodu√ß√£o e sobreviv√™ncia <span class="citation">(<a href="refer%C3%AAncias.html#ref-violle_let_2007" role="doc-biblioref">Violle et al. 2007</a>)</span>. Mais especificamente, o atributo funcional pode ser divido em <strong>atributo efeito</strong> (i.e., atributos do organismo que afetam condi√ß√µes ambientais ou propriedades do ecossistema) e <strong>atributo resposta</strong> (i.e., atributos do organismo que variam em resposta a condi√ß√µes ambientais) <span class="citation">(<a href="refer%C3%AAncias.html#ref-violle_let_2007" role="doc-biblioref">Violle et al. 2007</a>)</span>.</p>
<p>Dessa forma, as medidas de diversidade passaram a ser representadas n√£o somente por diferen√ßas no n√∫mero e na quantidade de esp√©cies, mas pelas diferen√ßas e/ou semelhan√ßas dos atributos funcionais das esp√©cies dentro e entre localidades. Assim, a varia√ß√£o no grau de express√£o de diferentes atributos funcionais entre diferentes popula√ß√µes, comunidades ou ecossistemas √© definida como <em>Diversidade Funcional</em> <span class="citation">(<em>sensu</em> <a href="refer%C3%AAncias.html#ref-garnier_plant_2015" role="doc-biblioref">Garnier, Navas, and Grigulis 2015</a>)</span>. Por√©m, a diversidade funcional n√£o deve ser usada como medida √∫nica, uma vez que tais diferen√ßas entre os atributos funcionais podem ser medida a partir da abund√¢ncia relativa, riqueza e varia√ß√£o dos atributos funcionais. Desse modo, podemos dividir a diversidade funcional em tr√™s diferentes medidas: i) riqueza funcional, ii) diverg√™ncia funcional, e iii) regularidade funcional <span class="citation">(<a href="refer%C3%AAncias.html#ref-villeger_new_2008" role="doc-biblioref">Vill√©ger, Mason, and Mouillot 2008</a>)</span>. Existem dezenas de m√©tricas que calculam cada uma dessas <em>dimens√µes</em> da diversidade funcional, mas se destacam aquelas baseadas em dendrograma <span class="citation">(e.g., FD: <a href="refer%C3%AAncias.html#ref-petchey_functional_2002" role="doc-biblioref">Petchey and Gaston 2002</a>)</span> ou em medidas de dist√¢ncia <span class="citation">(e.g., <a href="refer%C3%AAncias.html#ref-villeger_new_2008" role="doc-biblioref">Vill√©ger, Mason, and Mouillot 2008</a>)</span>. Assim como a diversidade taxon√¥mica (Cap√≠tulo <a href="cap12.html#cap12">12</a>), a diversidade funcional pode ser medida em componentes alfa e beta. A seguir, apresentamos diferentes maneiras de calcular a dist√¢ncia entre localidades tendo como base os atributos funcionais das esp√©cies e, al√©m disso, demonstramos como calcular algumas das m√©tricas de diversidade (alfa e beta) funcional mais usadas em Ecologia. A parte final deste cap√≠tulo apresenta dois exemplos de como podemos testar hip√≥teses ecol√≥gicas comparando a diversidade funcional alfa e beta.</p>
</div>
<div id="definindo-a-dissimilaridade-entre-esp√©cies" class="section level2" number="14.2">
<h2>
<span class="header-section-number">14.2</span> Definindo a dis(similaridade) entre esp√©cies<a class="anchor" aria-label="anchor" href="#definindo-a-dissimilaridade-entre-esp%C3%A9cies"><i class="fas fa-link"></i></a>
</h2>
<p>Definir o qu√£o diferente ou semelhante s√£o duas esp√©cies que ocorrem em uma determinada localidade √© a base para calcular a diversidade alfa e beta funcional. Para isso, √© fundamental ter em mente que os atributos funcionais podem ser de v√°rios tipos como, por exemplo, cont√≠nuos (e.g., tamanho corporal em cent√≠metro), categ√≥ricos (e.g., guilda: frug√≠voro, detrit√≠voro, etc.), ordinais (e.g., 1 para organismo at√© 5 cm, 2 para organismos entre 5 e 30 cm, e 3 para organismos maiores do que 30 cm), bin√°rios (e.g., presen√ßa ou aus√™ncia de espinho), entre outros [veja a Figura <a href="cap2.html#fig:fig-statistical-thinking">2.1</a> no Cap√≠tulo <a href="cap2.html#cap2">2</a>]. Por este motivo, a decis√£o do m√©todo de dist√¢ncia s√≥ ser√° poss√≠vel ap√≥s o reconhecimento dos tipos de atributos funcionais escolhidos. Em linhas gerais, para vari√°veis cont√≠nuas a dist√¢ncia euclidiana √© a melhor op√ß√£o, enquanto para os outros tipos de vari√°veis ou para conjuntos de atributos com mais de um tipo de vari√°vel, a dist√¢ncia de Gower geralmente deve ser a melhor op√ß√£o <span class="citation">(<a href="refer%C3%AAncias.html#ref-pavoine_challenge_2009" role="doc-biblioref">Pavoine et al. 2009</a>)</span>.</p>
<p><strong>Exemplo pr√°tico</strong></p>
<p><strong>Exemplo1: vari√°veis cont√≠nuas</strong></p>
<p>Vamos utilizar um conjunto de dados com atributos cont√≠nuos (e.g., √°rea foliar espec√≠fica e massa foliar seca) de 34 esp√©cies de plantas em um gradiente de aridez <span class="citation">(<a href="refer%C3%AAncias.html#ref-frenette-dussault_functional_2012" role="doc-biblioref">Frenette-Dussault et al. 2012</a>)</span>. Diversas an√°lises funcionais podem ser afetadas por valores extremos ou pela diferen√ßa de unidade/escala entre as vari√°veis utilizadas. Por este motivo, √© importante padronizar a matriz de atributos com m√©dia 0 e desvio padr√£o 1. Esta padroniza√ß√£o √© necess√°ria tanto para fazer uma PCA como para PCoA (veja Cap√≠tulo <a href="cap9.html#cap9">9</a>).</p>
<p><strong>Pergunta</strong></p>
<p>Quais s√£o as esp√©cies de plantas mais semelhantes? (Neste caso, sem predi√ß√£o, pois representa uma avalia√ß√£o explorat√≥ria com as caracter√≠sticas funcionais das esp√©cies).</p>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Dependentes: atributos funcionais (matriz de atributos cont√≠nuos por esp√©cie: <code>trait_fren_dat</code>)</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Aqui realizamos os passos para uma ordena√ß√£o usando os atributos funcionais cont√≠nuos (Figura <a href="cap14.html#fig:fig-func-pcoa-cont">14.1</a>).</p>
<div class="sourceCode" id="cb530"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## PCoA dos atributos cont√≠nuos</span>

<span class="co"># 1. Padroniza√ß√£o dos dados</span>
<span class="va">trait_pad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span><span class="va">trait_fren_dat</span>, <span class="st">"standardize"</span><span class="op">)</span>
<span class="va">euclid_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">trait_pad</span>, <span class="st">"euclidean"</span><span class="op">)</span>

<span class="co"># 2. PCoA</span>
<span class="co"># Resultados s√£o id√™nticos aos resultados de uma PCA.</span>
<span class="va">pcoa_traits_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/pcoa.html">pcoa</a></span><span class="op">(</span><span class="va">euclid_dis</span>, correction <span class="op">=</span> <span class="st">"cailliez"</span><span class="op">)</span> 

<span class="co"># 3. Exportandos dados para gr√°fico</span>
<span class="co"># Ao usar '[,1:2]' voc√™ ir√° selecionar os dois primeiros eixos.</span>
<span class="va">eixos_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">pcoa_traits_cont</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> 

<span class="co"># 4. Gr√°fico de ordena√ß√£o </span>
<span class="va">plot_trait_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">eixos_cont</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Axis.1</span>, y <span class="op">=</span> <span class="va">Axis.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">4</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, fill <span class="op">=</span> <span class="st">"red2"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Axis.1</span>, <span class="va">Axis.2</span>, label <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">eixos_cont</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"PCO 1"</span>, y <span class="op">=</span> <span class="st">"PCO 2"</span>, title <span class="op">=</span> <span class="st">"Dados cont√≠nuos"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>
<span class="va">plot_trait_cont</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-func-pcoa-cont"></span>
<img src="livro_files/figure-html/fig-func-pcoa-cont-1.png" alt="Ordena√ß√£o usando os atributos funcionais cont√≠nuos." width="100%" height="100%"><p class="caption">
Figura 14.1: Ordena√ß√£o usando os atributos funcionais cont√≠nuos.
</p>
</div>
<p><strong>Exemplo 2: vari√°veis categ√≥ricas</strong></p>
<p>No pr√≥ximo exemplo, utilizamos atributos funcionais de besouros distribu√≠dos na Europa <span class="citation">(<a href="refer%C3%AAncias.html#ref-barbaro_linking_2009" role="doc-biblioref">Barbaro and Van Halder 2009</a>)</span>. Esses dados s√£o categ√≥ricos e incluem atributos como per√≠odo de atividade (noturno, diurno, dioturno), tend√™ncia da popula√ß√£o na europa (est√°vel, aumentando, diminuindo) entre outros.</p>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
Ao contr√°rio dos dados cont√≠nuos, para dados categ√≥ricos n√£o √© poss√≠vel utilizar PCA.</p>
</div>
<p><strong>Pergunta</strong></p>
<p>Quais s√£o as esp√©cies de besouros mais semelhantes? (Neste caso, sem predi√ß√£o, pois representa uma avalia√ß√£o explorat√≥ria com as caracter√≠sticas funcionais das esp√©cies).</p>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Dependentes: atributos funcionais (matriz de atributos categ√≥ricos por esp√©cie: <code>trait_dat</code>)</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Aqui realizamos os passos para uma ordena√ß√£o usando os atributos funcionais categ√≥ricos (Figura <a href="cap14.html#fig:fig-func-pcoa-cat">14.2</a>).</p>
<div class="sourceCode" id="cb531"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## PCoA dos atributos categ√≥ricos</span>

<span class="co"># 1. Selecionar somente os atributos categ√≥ricos</span>
<span class="va">trait_cat</span> <span class="op">&lt;-</span> <span class="va">trait_dat</span> <span class="op"><a href="https://ggobi.github.io/ggally/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html">select_if</a></span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span>

<span class="co"># 2. Calcular a dist√¢ncia de Gower</span>
<span class="va">dist_categ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FD/man/gowdis.html">gowdis</a></span><span class="op">(</span><span class="va">trait_cat</span><span class="op">)</span>

<span class="co"># 3. PCoA da matriz de dist√¢ncia funcional (Gower)</span>
<span class="va">pcoa_traits_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/pcoa.html">pcoa</a></span><span class="op">(</span><span class="va">dist_categ</span>, correction <span class="op">=</span> <span class="st">"cailliez"</span><span class="op">)</span>

<span class="co"># 4. Exportar dados (escores) para ggplot</span>
<span class="va">eixos_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">pcoa_traits_cat</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="co"># Selecionar os dois primeiros eixos</span>

<span class="co"># 5. Gr√°fico de ordena√ß√£o</span>
<span class="va">plot_trait_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">eixos_cat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Axis.1</span>, y <span class="op">=</span> <span class="va">Axis.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"cyan4"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Axis.1</span>, <span class="va">Axis.2</span>, label <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">eixos_cat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"PCO 1"</span>, y <span class="op">=</span> <span class="st">"PCO 2"</span>, title <span class="op">=</span> <span class="st">"Dados categ√≥ricos"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>
<span class="va">plot_trait_cat</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-func-pcoa-cat"></span>
<img src="livro_files/figure-html/fig-func-pcoa-cat-1.png" alt="Ordena√ß√£o usando os atributos funcionais categ√≥ricos." width="100%" height="100%"><p class="caption">
Figura 14.2: Ordena√ß√£o usando os atributos funcionais categ√≥ricos.
</p>
</div>
<p><strong>Exemplo 3: vari√°veis mistas</strong></p>
<p>Em casos mais complexos, a pesquisa inclui diversos atributos funcionais com naturezas diferentes, como atributos cont√≠nuos, categ√≥ricos, ordinais, circulares, entre outros. Desse modo, √© poss√≠vel utilizar medidas como Gower (<code><a href="https://rdrr.io/pkg/FD/man/gowdis.html">gowdis()</a></code>). Por√©m, existe uma alternativa mais apropriada que generalizou o coeficiente de Gower para tratar cada conjunto de vari√°veis de acordo com sua natureza <span class="citation">(<a href="refer%C3%AAncias.html#ref-pavoine_challenge_2009" role="doc-biblioref">Pavoine et al. 2009</a>)</span>. Vamos usar o mesmo conjunto de dados que foram considerados no exemplo anterior. Por√©m, ao inv√©s de utilizar somente as vari√°veis categ√≥ricas, usaremos todas elas. O primeiro passo √© identificar para o programa as classes apropriadas para cada tipo de vari√°vel e, al√©m disso, preparar os dados para a fun√ß√£o <code><a href="https://rdrr.io/pkg/ade4/man/dist.ktab.html">dist.ktab()</a></code>.</p>
<p><strong>Pergunta</strong></p>
<p>Quais s√£o as esp√©cies de besouros mais semelhantes? (Neste caso, sem predi√ß√£o, pois representa uma avalia√ß√£o explorat√≥ria com as caracter√≠sticas funcionais das esp√©cies)</p>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Dependentes: atributos funcionais (matriz de atributos cont√≠nuos e categ√≥ricos por esp√©cie: <code>trait_dat</code>)</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Aqui realizamos os passos para uma ordena√ß√£o usando os atributos funcionais de diversas naturezas (Figura <a href="cap14.html#fig:fig-func-pcoa-mistos">14.3</a>).</p>
<div class="sourceCode" id="cb532"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## PCoA dos atributos mistos</span>

<span class="co">## 1. Verifique a classe de todos os traits e veja se est√£o de acordo com sua expectativa</span>
<span class="va">trait_dat</span> <span class="op"><a href="https://ggobi.github.io/ggally/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_all</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span> <span class="op"><a href="https://ggobi.github.io/ggally/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">class</span><span class="op">)</span>
<span class="co">#&gt;    variable     class</span>
<span class="co">#&gt; 1     trend character</span>
<span class="co">#&gt; 2   redlist character</span>
<span class="co">#&gt; 3     regio   integer</span>
<span class="co">#&gt; 4      biog character</span>
<span class="co">#&gt; 5     activ character</span>
<span class="co">#&gt; 6      diet character</span>
<span class="co">#&gt; 7    winter character</span>
<span class="co">#&gt; 8     color character</span>
<span class="co">#&gt; 9     breed character</span>
<span class="co">#&gt; 10     body   integer</span>
<span class="co">#&gt; 11     wing character</span>
<span class="co">#&gt; 12   period character</span>

<span class="co">## 2. Neste exemplo, algumas vari√°veis que s√£o ordinais (regio e body) </span>
<span class="co"># foram reconhecidas como num√©ricas ou categ√≥ricas. </span>
<span class="va">trait_dat</span><span class="op">$</span><span class="va">regio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.ordered</a></span><span class="op">(</span><span class="va">trait_dat</span><span class="op">$</span><span class="va">regio</span><span class="op">)</span>
<span class="va">trait_dat</span><span class="op">$</span><span class="va">body</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.ordered</a></span><span class="op">(</span><span class="va">trait_dat</span><span class="op">$</span><span class="va">body</span><span class="op">)</span>

<span class="co">## 3. Combinar cada conjunto de atributos de acordo com sua natureza em um </span>
<span class="co"># data.frame separado.</span>
<span class="co"># 3.1. Categ√≥ricos.</span>
<span class="va">trait_categ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span>
    trend <span class="op">=</span> <span class="va">trait_dat</span><span class="op">$</span><span class="va">trend</span>, 
    redlist <span class="op">=</span> <span class="va">trait_dat</span><span class="op">$</span><span class="va">redlist</span>, 
    biog <span class="op">=</span> <span class="va">trait_dat</span><span class="op">$</span><span class="va">biog</span>, 
    activ <span class="op">=</span> <span class="va">trait_dat</span><span class="op">$</span><span class="va">activ</span>,  
    diet <span class="op">=</span> <span class="va">trait_dat</span><span class="op">$</span><span class="va">diet</span>, 
    winter <span class="op">=</span> <span class="va">trait_dat</span><span class="op">$</span><span class="va">winter</span>,
    color <span class="op">=</span> <span class="va">trait_dat</span><span class="op">$</span><span class="va">color</span>, 
    breed <span class="op">=</span> <span class="va">trait_dat</span><span class="op">$</span><span class="va">breed</span>,
    wing <span class="op">=</span> <span class="va">trait_dat</span><span class="op">$</span><span class="va">wing</span>, 
    period <span class="op">=</span> <span class="va">trait_dat</span><span class="op">$</span><span class="va">period</span><span class="op">)</span>

<span class="co"># 3.2 Ordinais.</span>
<span class="va">trait_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span>regio <span class="op">=</span> <span class="va">trait_dat</span><span class="op">$</span><span class="va">regio</span>, 
                              body <span class="op">=</span> <span class="va">trait_dat</span><span class="op">$</span><span class="va">body</span><span class="op">)</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">trait_categ</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">trait_dat</span><span class="op">)</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">trait_ord</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">trait_dat</span><span class="op">)</span>

<span class="co"># Agora, combinar os dois data.frames em uma lista chamada "ktab".</span>
<span class="va">ktab_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/ktab.list.df.html">ktab.list.df</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">trait_categ</span>, <span class="va">trait_ord</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Por fim, calcular a dist√¢ncia funcional entre as esp√©cies.</span>
<span class="co"># Em "type", a letra "N" indica vari√°vel categ√≥rica (ou nominal), </span>
<span class="co"># enquanto a letra "O" indica vari√°vel ordinal.</span>
<span class="va">dist_mist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dist.ktab.html">dist.ktab</a></span><span class="op">(</span><span class="va">ktab_list</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="st">"O"</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Visualize os dados com uma PCoA</span>
<span class="va">pcoa_traits_mist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/pcoa.html">pcoa</a></span><span class="op">(</span><span class="va">dist_mist</span>, correction <span class="op">=</span> <span class="st">"cailliez"</span><span class="op">)</span>
<span class="va">eixos_mist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">pcoa_traits_mist</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> 

<span class="va">plot_trait_mist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">eixos_mist</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Axis.1</span>, y <span class="op">=</span> <span class="va">Axis.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, 
               color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Axis.1</span>, <span class="va">Axis.2</span>, label <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">eixos_mist</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"PCO 1"</span>, y <span class="op">=</span> <span class="st">"PCO 2"</span>, title <span class="op">=</span> <span class="st">"Dados mistos"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>
<span class="va">plot_trait_mist</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-func-pcoa-mistos"></span>
<img src="livro_files/figure-html/fig-func-pcoa-mistos-1.png" alt="Ordena√ß√£o usando os atributos funcionais de dados mistos." width="100%" height="100%"><p class="caption">
Figura 14.3: Ordena√ß√£o usando os atributos funcionais de dados mistos.
</p>
</div>
<p>Podemos combinar os dois gr√°ficos (baseado em vari√°veis categ√≥ricas e em vari√°veis mistas) para comparar as duas medidas de dist√¢ncia, uma somente com dados categ√≥ricos (<code>gower()</code>) e uma com dados categ√≥ricos e ordinais (<code><a href="https://rdrr.io/pkg/ade4/man/dist.ktab.html">dist.ktab()</a></code>) (Figura <a href="cap14.html#fig:fig-func-pcoa-cat-mistos">14.4</a>).</p>
<div class="sourceCode" id="cb533"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°ficos</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">plot_trait_cat</span>, <span class="va">plot_trait_mist</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-func-pcoa-cat-mistos"></span>
<img src="livro_files/figure-html/fig-func-pcoa-cat-mistos-1.png" alt="Ordena√ß√µes usando os atributos funcionais categ√≥ricos e de dados mistos." width="100%" height="100%"><p class="caption">
Figura 14.4: Ordena√ß√µes usando os atributos funcionais categ√≥ricos e de dados mistos.
</p>
</div>
</div>
<div id="m√©tricas-de-diversidade-funcional-alfa" class="section level2" number="14.3">
<h2>
<span class="header-section-number">14.3</span> M√©tricas de diversidade funcional (alfa)<a class="anchor" aria-label="anchor" href="#m%C3%A9tricas-de-diversidade-funcional-alfa"><i class="fas fa-link"></i></a>
</h2>
<div id="riqueza-funcional" class="section level3" number="14.3.1">
<h3>
<span class="header-section-number">14.3.1</span> Riqueza funcional<a class="anchor" aria-label="anchor" href="#riqueza-funcional"><i class="fas fa-link"></i></a>
</h3>
<p>A riqueza funcional mede a quantidade de espa√ßo funcional preenchido pelas esp√©cies de uma comunidade <span class="citation">(<a href="refer%C3%AAncias.html#ref-mason_functional_2013" role="doc-biblioref">Mason and Mouillot 2013</a>)</span>. A estimativa desse espa√ßo pode ser calculada usando dendrogramas <span class="citation">(<a href="refer%C3%AAncias.html#ref-petchey_functional_2002" role="doc-biblioref">Petchey and Gaston 2002</a>)</span> ou atrav√©s do m√©todo <strong>Convex Hull</strong> <span class="citation">(<a href="refer%C3%AAncias.html#ref-cornwell_trait-based_2006" role="doc-biblioref">Cornwell, Schwilk, and Ackerly 2006</a>)</span> que d√£o origem, respectivamente, √†s duas m√©tricas mais usadas: i) Diversidade Funcional (FD) e ii) Riqueza Funcional (FRic). Os √≠ndices de riqueza funcional geralmente s√£o usados como indicadores do espa√ßo de nicho que √© potencialmente usado ou n√£o <span class="citation">(<a href="refer%C3%AAncias.html#ref-schleuter_users_2010" role="doc-biblioref">Schleuter et al. 2010</a>)</span>.</p>
<p><strong>Exemplo pr√°tico</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Os dados utilizados neste exemplo s√£o os mesmos do exemplo com dados mistos, i.e., categ√≥ricos e cont√≠nuos (objeto <code>dist_mist</code>).</p>
<p><strong>Pergunta</strong></p>
<p>Qual a rela√ß√£o entre riqueza de esp√©cies e diversidade funcional? Todos os √≠ndices s√£o correlacionados com a riqueza?</p>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Dependentes: atributos funcionais e composi√ß√£o de esp√©cies para c√°lculo da diversidade funcional e riqueza em cada parcela</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Vamos come√ßar olhando os dados de dissimilaridade das esp√©cies (<code>dist_mist</code>) e os dados de composi√ß√£o (<code>comun_dat</code>)</p>
<div class="sourceCode" id="cb534"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Estrutura dos dados</span>
<span class="co"># matriz de dist√¢ncia: dist√¢ncia entre as seis primeiras esp√©cies</span>
<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dist_mist</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt;           sp1       sp2       sp3       sp4       sp5       sp6</span>
<span class="co">#&gt; sp1 0.0000000 0.5000000 0.7107801 0.7771900 0.6107116 0.5041691</span>
<span class="co">#&gt; sp2 0.5000000 0.0000000 0.6808389 0.8538292 0.7345988 0.6487320</span>
<span class="co">#&gt; sp3 0.7107801 0.6808389 0.0000000 0.7179711 0.7381353 0.6527339</span>
<span class="co">#&gt; sp4 0.7771900 0.8538292 0.7179711 0.0000000 0.5106682 0.6522593</span>
<span class="co">#&gt; sp5 0.6107116 0.7345988 0.7381353 0.5106682 0.0000000 0.5177440</span>
<span class="co">#&gt; sp6 0.5041691 0.6487320 0.6527339 0.6522593 0.5177440 0.0000000</span>

<span class="co"># composi√ß√£o de esp√©cies: seis primeiras esp√©cies nas seis primeiras localidades</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">comun_dat</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt;    sp1 sp2 sp3 sp4 sp5 sp6</span>
<span class="co">#&gt; 3    0  19   2   0   0   0</span>
<span class="co">#&gt; 4    0   4   0   0   0   0</span>
<span class="co">#&gt; 6    1  58   2   0   0   0</span>
<span class="co">#&gt; 7    1   0   0   0   0   0</span>
<span class="co">#&gt; 9    3   0   0   0   0   0</span>
<span class="co">#&gt; 10   3  15   0   0   0   0</span></code></pre></div>
<p>Agora vamos calcular a riqueza de esp√©cies por comunidade</p>
<div class="sourceCode" id="cb535"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Riqueza de esp√©cies</span>
<span class="va">richness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FD/man/dbFD.html">dbFD</a></span><span class="op">(</span><span class="va">dist_mist</span>, <span class="va">comun_dat</span><span class="op">)</span><span class="op">$</span><span class="va">nbsp</span> 
<span class="co">#&gt; FRic: Dimensionality reduction was required. The last 17 PCoA axes (out of 19 in total) were removed. </span>
<span class="co">#&gt; FRic: Quality of the reduced-space representation = 0.3243851 </span>
<span class="co">#&gt; CWM: When 'x' is a distance matrix, CWM cannot be calculated.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">richness</span><span class="op">)</span>
<span class="co">#&gt;  3  4  6  7  9 10 </span>
<span class="co">#&gt; 12  3  7  7  4  7</span></code></pre></div>
<p>Vamos calcular a Riqueza (<code>FRic</code>) e Diversidade funcional usando o pacote <code>dbFD</code>.</p>
<div class="sourceCode" id="cb536"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Functional Richness</span>
<span class="va">fric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FD/man/dbFD.html">dbFD</a></span><span class="op">(</span><span class="va">dist_mist</span>, <span class="va">comun_dat</span><span class="op">)</span><span class="op">$</span><span class="va">FRic</span>
<span class="co">#&gt; FRic: Dimensionality reduction was required. The last 17 PCoA axes (out of 19 in total) were removed. </span>
<span class="co">#&gt; FRic: Quality of the reduced-space representation = 0.3243851 </span>
<span class="co">#&gt; CWM: When 'x' is a distance matrix, CWM cannot be calculated.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fric</span><span class="op">)</span>
<span class="co">#&gt;           3           4           6           7           9          10 </span>
<span class="co">#&gt; 0.226236923 0.009033539 0.158760885 0.158529234 0.014290140 0.200075112</span>

<span class="co">## Functional Diversity </span>
<span class="co"># Passo 1: an√°lise de agrupamento para criar o dendrograma. </span>
<span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">dist_mist</span>, <span class="st">"average"</span><span class="op">)</span>

<span class="co"># Passo 2: transformar o dengrograma em um arquivo da classe phylo.</span>
<span class="va">tree_dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/as.phylo.html">as.phylo</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span>

<span class="co"># Passo 3: calcular o valor da diversidade funcional. </span>
<span class="va">FD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/pd.html">pd</a></span><span class="op">(</span><span class="va">comun_dat</span>, <span class="va">tree_dend</span><span class="op">)</span><span class="op">$</span><span class="va">PD</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">FD</span><span class="op">)</span>
<span class="co">#&gt; [1] 3.590053 1.115574 2.255337 2.356478 1.472314 2.430329</span></code></pre></div>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
O √≠ndice <em>Functional Richness</em> s√≥ funciona para comunidades com 3 ou mais esp√©cies. Caso voc√™ tenha comunidades com 1 ou 2 esp√©cies, o valor ser√° <code>NA</code></p>
</div>
<p>Os valores da Riqueza Funcional (FRic) variam entre 0 e +‚àû, sendo o valor m√°ximo limitado pelo n√∫mero de esp√©cies em uma comunidade. Desse modo, os valores de FRic basicamente s√£o uma representa√ß√£o da riqueza de esp√©cies (e seus atributos funcionais) de uma comunidade <span class="citation">(<a href="refer%C3%AAncias.html#ref-villeger_new_2008" role="doc-biblioref">Vill√©ger, Mason, and Mouillot 2008</a>)</span>. Ou seja, quanto maior o n√∫mero de esp√©cies, maior ser√° o espa√ßo funcional ocupado por essas esp√©cies. No pacote ‚ÄòdbFD‚Äô o valor de FRic √© dividido pelo valor de FRic global (ou seja, pela riqueza funcional de todas as comunidades combinadas). Como resultado, ele limita a varia√ß√£o entre 0 e 1, onde valores pr√≥ximos a 1 indicam que uma determinada comunidade tem riqueza funcional t√£o alta quanto a riqueza funcional de todas as comunidades juntas. Neste exemplo, as localidades 21 e 89 possuem, respectivamente, a maior e menor Riqueza Funcional.</p>
</div>
<div id="diverg√™ncia-funcional" class="section level3" number="14.3.2">
<h3>
<span class="header-section-number">14.3.2</span> Diverg√™ncia funcional<a class="anchor" aria-label="anchor" href="#diverg%C3%AAncia-funcional"><i class="fas fa-link"></i></a>
</h3>
<p>A diverg√™ncia funcional √© uma medida que descreve a irregularidade na distribui√ß√£o dos valores dos atributos no volume do espa√ßo funcional ocupado por todas as esp√©cies de uma certa comunidade <span class="citation">(<a href="refer%C3%AAncias.html#ref-garnier_plant_2015" role="doc-biblioref">Garnier, Navas, and Grigulis 2015</a>)</span>. Para obter os valores de diverg√™ncia, o espa√ßo funcional √© calculado atrav√©s do m√©todo <em>Convex Hull</em> (<em>Functional Divergence</em>) ou do espa√ßo multidimensional calculado com um PCoA (<em>Functional Dispersion</em>). Nos dois casos, o valor da m√©trica representa a dist√¢ncia m√©dia das esp√©cies para o centro de gravidade ou centroide do espa√ßo funcional, ponderado pela abund√¢ncia relativa das esp√©cies <span class="citation">(<a href="refer%C3%AAncias.html#ref-villeger_new_2008" role="doc-biblioref">Vill√©ger, Mason, and Mouillot 2008</a>; <a href="refer%C3%AAncias.html#ref-laliberte_distance-based_2010" role="doc-biblioref">Lalibert√© and Legendre 2010</a>)</span>. Desse modo, a diverg√™ncia funcional √© uma medida que calcula o grau de diferencia√ß√£o em que a distribui√ß√£o da abund√¢ncia maximiza a diverg√™ncia entre os atributos funcionais <span class="citation">(<a href="refer%C3%AAncias.html#ref-mason_functional_2013" role="doc-biblioref">Mason and Mouillot 2013</a>)</span>. Em geral, estudos que usam esses √≠ndices buscam entender o grau de diferencia√ß√£o de recursos de esp√©cies que coexistem em uma comunidade <span class="citation">(<a href="refer%C3%AAncias.html#ref-garnier_plant_2015" role="doc-biblioref">Garnier, Navas, and Grigulis 2015</a>)</span>.</p>
<p>Vamos calcular a diverg√™ncia funcional (<code>FDiv</code>) e dispers√£o funcional (<code>FDis</code>) usando o pacote dbFD. Para isso, usaremos a matriz de dist√¢ncia obtida dos dados <code>trait_dat</code> (vari√°veis categ√≥ricas e ordinais) e nomeada como <code>dist_mist</code></p>
<div class="sourceCode" id="cb537"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## "Functional Divergence" s</span>
<span class="va">fdiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FD/man/dbFD.html">dbFD</a></span><span class="op">(</span><span class="va">dist_mist</span>, <span class="va">comun_dat</span><span class="op">)</span><span class="op">$</span><span class="va">FDiv</span>
<span class="co">#&gt; FRic: Dimensionality reduction was required. The last 17 PCoA axes (out of 19 in total) were removed. </span>
<span class="co">#&gt; FRic: Quality of the reduced-space representation = 0.3243851 </span>
<span class="co">#&gt; CWM: When 'x' is a distance matrix, CWM cannot be calculated.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fdiv</span><span class="op">)</span>
<span class="co">#&gt;         3         4         6         7         9        10 </span>
<span class="co">#&gt; 0.9692023 0.8838557 0.4082808 0.9147644 0.9010790 0.6982640</span>

<span class="co"># "Functional Dispersion" </span>
<span class="va">fdis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FD/man/dbFD.html">dbFD</a></span><span class="op">(</span><span class="va">dist_mist</span>, <span class="va">comun_dat</span><span class="op">)</span><span class="op">$</span><span class="va">FDis</span>
<span class="co">#&gt; FRic: Dimensionality reduction was required. The last 17 PCoA axes (out of 19 in total) were removed. </span>
<span class="co">#&gt; FRic: Quality of the reduced-space representation = 0.3243851 </span>
<span class="co">#&gt; CWM: When 'x' is a distance matrix, CWM cannot be calculated.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fdis</span><span class="op">)</span>
<span class="co">#&gt;         3         4         6         7         9        10 </span>
<span class="co">#&gt; 0.2977975 0.3203602 0.2218237 0.3261248 0.3683898 0.3910530</span></code></pre></div>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
- O √≠ndice <em>Functional divergence</em> s√≥ funciona para comunidades com 3 ou mais esp√©cies. Caso voc√™ tenha comunidades com 1 ou 2 esp√©cies, o valor ser√° <code>NA</code></p>
<ul>
<li>O √≠ndice <em>Functional Dispersion</em> s√≥ funciona para comunidades com 3 ou mais esp√©cies. Caso voc√™ tenha comunidades com 1 ou 2 esp√©cies, o valor ser√° zero</li>
</ul>
</div>
<p>Os valores da Diverg√™ncia Funcional (<code>FDiv</code>) variam entre 0 e 1. Valores que se aproximam de zero indicam que a esp√©cie mais abundante est√° muito pr√≥xima do valor do atributo m√©dio da comunidade, ao passo que valores pr√≥ximos a 1 indicam que a esp√©cie mais abundante est√° muito distante (ou seja, √© muito diferente) do valor m√©dio da comunidade <span class="citation">(<a href="refer%C3%AAncias.html#ref-villeger_new_2008" role="doc-biblioref">Vill√©ger, Mason, and Mouillot 2008</a>)</span>. Neste exemplo, as localidades 159 e 6 possuem, respectivamente, a maior e menor Diverg√™ncia Funcional.</p>
</div>
<div id="regularidade-funcional" class="section level3" number="14.3.3">
<h3>
<span class="header-section-number">14.3.3</span> Regularidade funcional<a class="anchor" aria-label="anchor" href="#regularidade-funcional"><i class="fas fa-link"></i></a>
</h3>
<p>A regularidade funcional (do ingl√™s <em>Functional Evenness</em> - <code>FEve</code>) mede o qu√£o regular √© a distribui√ß√£o da abund√¢ncia dos valores dos atributos funcionais no espa√ßo funcional. Diferente dos outros m√©todos, a vers√£o multidimensional deste √≠ndice utiliza um m√©todo chamado <em>Minimum Spanning Tree</em> (MST) para conectar todas esp√©cies no espa√ßo funcional. A dist√¢ncia par apar das esp√©cies na MST √© ponderada pela abund√¢ncia relativa das esp√©cies e, desse modo, o valor final da regularidade funcional (FEve) vai variar de 0 (m√°xima irregularidade da distribui√ß√£o da abund√¢ncia ou dist√¢ncia funcional das esp√©cies) a 1 (m√°xima regularidade).</p>
<p>Vamos calcular a Regularidade Funcional (<code>FEve</code>) usando o pacote <code>dbFD</code>. Para isso, usaremos a matriz de dist√¢ncia obtida dos dados <code>trait_dat</code> (vari√°veis categ√≥ricas e ordinais) e nomeada como <code>dist_mist</code></p>
<div class="sourceCode" id="cb538"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## "Functional evenness" </span>
<span class="va">feve</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FD/man/dbFD.html">dbFD</a></span><span class="op">(</span><span class="va">dist_mist</span>, <span class="va">comun_dat</span><span class="op">)</span><span class="op">$</span><span class="va">FEve</span>
<span class="co">#&gt; FRic: Dimensionality reduction was required. The last 17 PCoA axes (out of 19 in total) were removed. </span>
<span class="co">#&gt; FRic: Quality of the reduced-space representation = 0.3243851 </span>
<span class="co">#&gt; CWM: When 'x' is a distance matrix, CWM cannot be calculated.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">feve</span><span class="op">)</span>
<span class="co">#&gt;         3         4         6         7         9        10 </span>
<span class="co">#&gt; 0.4054808 0.5587917 0.5406140 0.6974712 0.9575697 0.6297941</span></code></pre></div>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
O √≠ndice <em>Functional evenness</em> s√≥ funciona para comunidades com 3 ou mais esp√©cies. Caso voc√™ tenha comunidades com 1 ou 2 esp√©cies, o valor ser√° <code>NA</code></p>
</div>
<p>Os valores da Regularidade Funcional (FEve) variam entre 0 e 1 (m√°xima regularidade ou regularidade perfeita). A diminui√ß√£o do valor de FEve em dire√ß√£o a zero indica que uma redu√ß√£o da regularidade da distribui√ß√£o da abund√¢ncia ou dist√¢ncia funcional entre as esp√©cies <span class="citation">(<a href="refer%C3%AAncias.html#ref-villeger_new_2008" role="doc-biblioref">Vill√©ger, Mason, and Mouillot 2008</a>)</span>. Neste exemplo, as localidades 197 e 175 possuem, respectivamente, a maior e menor Regularidade Funcional.</p>
</div>
<div id="correla√ß√£o-entre-as-m√©tricas-de-diversidade-funcional-alfa" class="section level3" number="14.3.4">
<h3>
<span class="header-section-number">14.3.4</span> Correla√ß√£o entre as m√©tricas de diversidade funcional (alfa)<a class="anchor" aria-label="anchor" href="#correla%C3%A7%C3%A3o-entre-as-m%C3%A9tricas-de-diversidade-funcional-alfa"><i class="fas fa-link"></i></a>
</h3>
<p>Aqui vamos fazer a correla√ß√£o entre as m√©tricas de diversidade funcional (alfa) (Figura <a href="cap14.html#fig:fig-func-alfa-cor">14.5</a>).</p>
<div class="sourceCode" id="cb539"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°ficos</span>
<span class="co">## Voc√™ pode criar uma tabela com os resultados de todas as m√©tricas</span>
<span class="va">metricas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>richness <span class="op">=</span> <span class="va">richness</span>,
                       FD_gp <span class="op">=</span> <span class="va">FD</span>,
                       fric <span class="op">=</span> <span class="va">fric</span>,
                       fdiv <span class="op">=</span> <span class="va">fdiv</span>,
                       fdis <span class="op">=</span> <span class="va">fdis</span>,
                       feve <span class="op">=</span> <span class="va">feve</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">metricas</span><span class="op">)</span>
<span class="co">#&gt;    richness    FD_gp        fric      fdiv      fdis      feve</span>
<span class="co">#&gt; 3        12 3.590053 0.226236923 0.9692023 0.2977975 0.4054808</span>
<span class="co">#&gt; 4         3 1.115574 0.009033539 0.8838557 0.3203602 0.5587917</span>
<span class="co">#&gt; 6         7 2.255337 0.158760885 0.4082808 0.2218237 0.5406140</span>
<span class="co">#&gt; 7         7 2.356478 0.158529234 0.9147644 0.3261248 0.6974712</span>
<span class="co">#&gt; 9         4 1.472314 0.014290140 0.9010790 0.3683898 0.9575697</span>
<span class="co">#&gt; 10        7 2.430329 0.200075112 0.6982640 0.3910530 0.6297941</span>

<span class="co">## Gr√°fico para comparar o comportamento das m√©tricas</span>
<span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">metricas</span><span class="op">)</span> <span class="op">+</span> <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-func-alfa-cor"></span>
<img src="livro_files/figure-html/fig-func-alfa-cor-1.png" alt="Correla√ß√£o entre as m√©tricas de diversidade funcional (alfa)." width="100%" height="100%"><p class="caption">
Figura 14.5: Correla√ß√£o entre as m√©tricas de diversidade funcional (alfa).
</p>
</div>
<p>Os resultados indicam que a Diversidade Funcional de Petchey &amp; Gaston <span class="citation">(<a href="refer%C3%AAncias.html#ref-petchey_functional_2002" role="doc-biblioref">2002</a>)</span> (r = 0.985) e a riqueza funcional (r = 0.813) s√£o altamente correlacionadas com a riqueza de esp√©cies. Por√©m, a diverg√™ncia funcional, regularidade funcional e dispers√£o funcional n√£o est√£o correlacionadas com a riqueza de esp√©cies.</p>
<p>A figura obtida com o c√≥digo <code>ggpairs(metricas)</code> representa uma matriz de correla√ß√£o comparando cada par de vari√°veis (neste caso, os √≠ndices de diversidade). No lado esquerdo da figura (abaixo da diagonal) s√£o representados <em>scatter plots</em> (veja Cap√≠tulo <a href="cap6.html#cap6">6</a>), a no lado direito (acima da diagonal) pode-se encontrar os valores das correla√ß√µes (<code>r</code>) entre os pares comparados. No caso das correla√ß√µes, quanto mais pr√≥ximo de +1 ou -1, mais forte √© a rela√ß√£o entre essas vari√°veis do par comparado. O gr√°fico de linhas na diagonal demonstra a densidade de cada vari√°veis individualmente (veja Cap√≠tulo <a href="cap7.html#cap7">7</a>).</p>
</div>
</div>
<div id="m√©tricas-de-diversidade-funcional-beta" class="section level2" number="14.4">
<h2>
<span class="header-section-number">14.4</span> M√©tricas de diversidade funcional (beta)<a class="anchor" aria-label="anchor" href="#m%C3%A9tricas-de-diversidade-funcional-beta"><i class="fas fa-link"></i></a>
</h2>
<p>Assim como na diversidade beta taxon√¥mica (Cap√≠tulo <a href="cap12.html#cap12">12</a>) e na diversidade beta filogen√©tica (Cap√≠tulo <a href="cap13.html#cap13">13</a>), a diversidade beta funcional √© uma medida que compara a composi√ß√£o (e a varia√ß√£o na composi√ß√£o) de atributos funcionais das esp√©cies entre duas ou mais localidades. Por√©m, assim como na medida tradicional taxon√¥mica (como Jaccard ou S√∏rensen), diferen√ßas na diversidade beta podem ser geradas pela <strong>mudan√ßa na identidade das esp√©cies (ou do atributo)</strong> ou na <strong>riqueza de esp√©cies (ou de atributos)</strong> entre duas localidades (Figura <a href="cap14.html#fig:fig-func">14.6</a>). Desse modo, √© poss√≠vel particionar a diversidade beta funcional em aninhamento (do ingl√™s <em>nestedness</em>) e substitui√ß√£o (do ingl√™s <em>turnover</em>) (veja Cap√≠tulo <a href="cap12.html#cap12">12</a>). Al√©m disso, os c√°lculos da diversidade beta funcional podem ser realizados par a par (<code><a href="https://rdrr.io/pkg/betapart/man/functional.beta.pair.html">functional.beta.pair()</a></code>) ou para a compara√ß√µes de m√∫ltiplas localidades (<code>funcional.beta.multi()</code>).</p>
<div class="sourceCode" id="cb540"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"img/cap14_fig01.svg"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-func"></span>
<img src="img/cap14_fig01.svg" alt="Parti√ß√£o da diversidade beta taxon√¥mica (A) e funcional (B). Os tr√™s cen√°rios apresentados tanto para a diversidade beta taxon√¥mica como funcional representam, respectivamente, diversidade beta explicada somente por substitui√ß√£o, aninhamento e uma combina√ß√£o dos dois." width="100%" height="100%"><p class="caption">
Figura 14.6: Parti√ß√£o da diversidade beta taxon√¥mica (A) e funcional (B). Os tr√™s cen√°rios apresentados tanto para a diversidade beta taxon√¥mica como funcional representam, respectivamente, diversidade beta explicada somente por substitui√ß√£o, aninhamento e uma combina√ß√£o dos dois.
</p>
</div>
<p><strong>Exemplo 4</strong></p>
<p>Os dados no exemplo a seguir utilizam somente a informa√ß√£o de presen√ßa (1) ou aus√™ncia (0) das esp√©cies nas localidades. Neste exemplo hipot√©tico criado por Baselga et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-baselga_2021" role="doc-biblioref">2021</a>)</span>, foram amostradas 11 esp√©cies (sp1-sp11) em quatro localidades (A-D). Para cada esp√©cie, criamos dois atributos cont√≠nuos hipot√©ticos (trait1 e trait2).</p>
<p><strong>Pergunta</strong></p>
<p>Qual a contribui√ß√£o relativa do aninhamento e substitui√ß√£o para a diversidade beta?</p>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Dependentes: atributos funcionais e composi√ß√£o de esp√©cies.</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Vamos fazer a an√°lise da parti√ß√£o da diversidade beta funcional e comparar seus componentes (Figura <a href="cap14.html#fig:fig-func-beta-comp">14.7</a>).</p>
<div class="sourceCode" id="cb541"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Parti√ß√£o da Diversidade beta (M√©todo Baselga)</span>
<span class="va">fun_beta_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betapart/man/functional.beta.multi.html">functional.beta.multi</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comm_baselga</span>,
                                        trait <span class="op">=</span> <span class="va">trait_baselga</span>, index <span class="op">=</span> <span class="st">"jaccard"</span><span class="op">)</span> 
<span class="va">fun_beta_multi</span>
<span class="co">#&gt; $funct.beta.JTU</span>
<span class="co">#&gt; [1] 0.7101449</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $funct.beta.JNE</span>
<span class="co">#&gt; [1] 0.1509662</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $funct.beta.JAC</span>
<span class="co">#&gt; [1] 0.8611111</span>

<span class="co">## Parti√ß√£o da Diversidade beta (M√©todo Baselga)</span>
<span class="va">fun_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betapart/man/functional.beta.pair.html">functional.beta.pair</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comm_baselga</span>, 
                                 trait <span class="op">=</span> <span class="va">trait_baselga</span>, index <span class="op">=</span> <span class="st">"jaccard"</span><span class="op">)</span> 

<span class="co"># Os c√≥digos abaixo permitem extrair a matriz de dist√¢ncia (par a par) com a parti√ß√£o em substitui√ß√£o e nestedness</span>
<span class="va">fun_turnover</span> <span class="op">&lt;-</span> <span class="va">fun_beta</span><span class="op">$</span><span class="va">funct.beta.jne</span>
<span class="va">fun_nestedness</span> <span class="op">&lt;-</span> <span class="va">fun_beta</span><span class="op">$</span><span class="va">funct.beta.jtu</span>
<span class="va">fun_jaccard</span> <span class="op">&lt;-</span> <span class="va">fun_beta</span><span class="op">$</span><span class="va">funct.beta.jac</span>

<span class="co">## Gr√°fico de compara√ß√£o do substitui√ß√£o e aninhamento</span>
<span class="va">dat_betapart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>turnover <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">fun_turnover</span><span class="op">)</span>, 
                           nested <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">fun_nestedness</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Gr√°fico</span>
<span class="va">plot_betapart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_betapart</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">turnover</span>, y <span class="op">=</span> <span class="va">nested</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"#525252"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Beta Diveristy (Substitui√ß√£o)"</span>, y <span class="op">=</span> <span class="st">"Beta Diveristy (Aninhamento)"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>
<span class="va">plot_betapart</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-func-beta-comp"></span>
<img src="livro_files/figure-html/fig-func-beta-comp-1.png" alt="Rela√ß√£o entre os componentes parti√ß√£o da diversidade funcional (beta)." width="100%" height="100%"><p class="caption">
Figura 14.7: Rela√ß√£o entre os componentes parti√ß√£o da diversidade funcional (beta).
</p>
</div>
<p>Os resultados da an√°lise de parti√ß√£o (<code>fun_beta_multi()</code>) indicam que 82,5% (<code>0,710</code>/<code>0,861</code>) da varia√ß√£o na diversidade beta √© explicada pelo componente substitui√ß√£o, enquanto 17,5% (<code>0,151</code>/<code>0,861</code>) pelo componente aninhamento. As matrizes de dist√¢ncia obtidas na an√°lise par a par podem ser utilizadas para testar, <em>a posteriori</em>, a rela√ß√£o entre gradientes ambientais e diversidade beta funcional (mais detalhes abaixo).</p>
</div>
<div id="composi√ß√£o-funcional-community-wegihed-means---cwm" class="section level2" number="14.5">
<h2>
<span class="header-section-number">14.5</span> Composi√ß√£o Funcional (<em>Community Wegihed Means</em> - CWM)<a class="anchor" aria-label="anchor" href="#composi%C3%A7%C3%A3o-funcional-community-wegihed-means---cwm"><i class="fas fa-link"></i></a>
</h2>
<p>As medidas de diversidade beta funcional apresentadas acima fornecem matrizes de dist√¢ncia com compara√ß√µes par a par de localidades em termos da composi√ß√£o de atributos funcionais. Por√©m, muitas vezes o pesquisador quer medir o ‚Äúatributo m√©dio‚Äù da comunidade para investigar, por exemplo, se um determinado gradiente ambiental afeta a express√£o (em termos de abund√¢ncia ou densidade) de dado atributo funcional. Em geral, a medida utilizada √© o CWM (do ingl√™s <em>Community Wegihed Means</em>). O CWM √© basicamente uma m√©dia ponderada de um determinado atributo (coluna <em>m</em> na matriz T) em rela√ß√£o a abund√¢ncia de todas as esp√©cies que ocorrem na localidade (linha <em>n</em> na matriz X). O c√°lculo no R √© feito pela fun√ß√£o <code><a href="https://rdrr.io/pkg/FD/man/functcomp.html">functcomp()</a></code> e usa somente as duas matrizes (T e X). Os leitores que pretendem usar essas m√©tricas devem ler cr√≠ticas em Peres-Neto et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-peres-neto_linking_2017" role="doc-biblioref">2017</a>)</span>.</p>
<div class="sourceCode" id="cb542"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Matriz T</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">trait_baselga</span><span class="op">)</span>
<span class="co">#&gt;     Trait.1 Trait.2</span>
<span class="co">#&gt; sp1       1       1</span>
<span class="co">#&gt; sp2       1       2</span>
<span class="co">#&gt; sp3       1       4</span>
<span class="co">#&gt; sp4       2       1</span>
<span class="co">#&gt; sp5       2       2</span>
<span class="co">#&gt; sp6       3       3</span>

<span class="co">## Matriz X</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">comm_baselga</span><span class="op">)</span>
<span class="co">#&gt;   sp1 sp2 sp3 sp4 sp5 sp6 sp7 sp8 sp9 sp10 sp11</span>
<span class="co">#&gt; A   1   1   0   1   1   0   0   0   0    0    0</span>
<span class="co">#&gt; B   1   0   1   0   0   0   0   1   1    0    0</span>
<span class="co">#&gt; C   0   0   0   0   0   1   1   0   0    1    1</span>
<span class="co">#&gt; D   0   1   0   1   0   0   1   0   1    0    0</span>

<span class="co">## Fun√ß√£o functcomp calcula o cwm para combinar as matrizes T e X</span>
<span class="va">cwm_ex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FD/man/functcomp.html">functcomp</a></span><span class="op">(</span><span class="va">trait_baselga</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">comm_baselga</span><span class="op">)</span><span class="op">)</span>
<span class="va">cwm_ex</span>
<span class="co">#&gt;   Trait.1 Trait.2</span>
<span class="co">#&gt; A     1.5     1.5</span>
<span class="co">#&gt; B     2.5     2.5</span>
<span class="co">#&gt; C     4.0     4.0</span>
<span class="co">#&gt; D     2.5     3.0</span></code></pre></div>
<p>A matriz resultante <code>cwm_es</code> √© formada pelas localidades (linhas) e os atributos ‚Äúm√©dios‚Äù (colunas) nestas localidades. Essa matriz pode ser utilizada em diversas an√°lises como dbRDA, RDA ou RDA parcial (veja Cap√≠tulo <a href="cap9.html#cap9">9</a>). Na sequ√™ncia, vamos utilizar testes de hip√≥teses para entender como podemos calcular as diversidades funcional alfa e beta com outros testes estat√≠sticos apresentados neste livro.</p>
<p><strong>Exemplo 5</strong></p>
<p>Neste exemplo, usaremos novamente os dados de 34 esp√©cies de plantas <span class="citation">(<a href="refer%C3%AAncias.html#ref-frenette-dussault_functional_2012" role="doc-biblioref">Frenette-Dussault et al. 2012</a>)</span>, mas agora vamos testar o efeito de um gradiente de aridez sobre a diversidade alfa funcional.</p>
<p><strong>Pergunta</strong></p>
<p>O gradiente de aridez influencia a diverg√™ncia e regularidade funcional de plantas?</p>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li><p><em>Predi√ß√£o 1</em>: locais mais √°ridos possuem menor diverg√™ncia funcional de plantas (m√©trica escolhida: FDis)</p></li>
<li><p><em>Predi√ß√£o 2</em>: locais mais √∫midos possuem menor regularidade funcional de plantas (m√©trica escolhida: FEve)</p></li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li><p>Preditora: gradiente de aridez (matriz de vari√°veis ambientais por localidade: <code>ambie_fren_dat</code>)</p></li>
<li><p>Dependentes: composi√ß√£o de esp√©cies (matriz de esp√©cies por localidade: <code>comun_fren_dat</code>) e atributos funcionais (matriz de atributos cont√≠nuos por esp√©cie: <code>trait_fren_dat</code>)</p></li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Vamos calcular primeiramente as matrizes de Diverg√™ncia funcional (FDis) e Regularidade Funcional (FEve), depois ajustar modelos lineares, fazer o diagn√≥stico dos mesmo e por fim plotar os resultados (Figura <a href="cap14.html#fig:fig-func-comp-model">14.8</a>).</p>
<div class="sourceCode" id="cb543"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Passo 1: calcular a dist√¢ncia funcional</span>
<span class="va">trait_pad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span><span class="va">trait_fren_dat</span>, <span class="st">"standardize"</span><span class="op">)</span>
<span class="va">euclid_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">trait_pad</span>, <span class="st">"euclidean"</span><span class="op">)</span>

<span class="co">## Passo 2: calcular a Diverg√™ncia funcional (FDis) e Regularidade Funcional (FEve)</span>
<span class="va">fdis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FD/man/dbFD.html">dbFD</a></span><span class="op">(</span><span class="va">euclid_dis</span>, <span class="va">comun_fren_dat</span><span class="op">)</span><span class="op">$</span><span class="va">FDis</span> <span class="co"># Fdis=0 em locais com somente uma esp√©cie</span>
<span class="co">#&gt; FRic: No dimensionality reduction was required. All 5 PCoA axes were kept as 'traits'. </span>
<span class="co">#&gt; CWM: When 'x' is a distance matrix, CWM cannot be calculated.</span>
<span class="va">feve</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FD/man/dbFD.html">dbFD</a></span><span class="op">(</span><span class="va">euclid_dis</span>, <span class="va">comun_fren_dat</span><span class="op">)</span><span class="op">$</span><span class="va">FEve</span>
<span class="co">#&gt; FRic: No dimensionality reduction was required. All 5 PCoA axes were kept as 'traits'. </span>
<span class="co">#&gt; CWM: When 'x' is a distance matrix, CWM cannot be calculated.</span>

<span class="co">## Passo 3: Utilizar um modelo linear para comparar o efeito da aridez sobre FDis (predi√ß√£o 1) e FEve (predi√ß√£o 2)</span>
<span class="co"># Combinar dados em um data.frame.</span>
<span class="va">lm_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>aridez <span class="op">=</span> <span class="va">ambie_fren_dat</span><span class="op">$</span><span class="va">Aridity</span>, fdis <span class="op">=</span> <span class="va">fdis</span>, feve <span class="op">=</span> <span class="va">feve</span><span class="op">)</span>

<span class="co"># Modelo 1</span>
<span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">fdis</span> <span class="op">~</span> <span class="va">aridez</span>, data <span class="op">=</span> <span class="va">lm_dat</span><span class="op">)</span>

<span class="co"># Conclus√£o: a aridez n√£o tem efeito sobre a diverg√™ncia funcional</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> 
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: fdis</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; aridez     1 0.2083 0.20834  0.9945 0.3241</span>
<span class="co">#&gt; Residuals 44 9.2179 0.20950</span>

<span class="co"># Modelo 2</span>
<span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">feve</span> <span class="op">~</span> <span class="va">aridez</span>, data <span class="op">=</span> <span class="va">lm_dat</span><span class="op">)</span>

<span class="co"># Conclus√£o: a aridez n√£o tem efeito sobre a regularidade funcional</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span> 
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: feve</span>
<span class="co">#&gt;           Df  Sum Sq  Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; aridez     1 0.02098 0.020979  1.0447 0.3123</span>
<span class="co">#&gt; Residuals 44 0.88353 0.020080</span>

<span class="co">## Passo 4: gr√°fico para visualizar os dois resultados  </span>
<span class="co"># Gr√°fico modelo 1.</span>
<span class="va">plot_pred1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">lm_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">aridez</span>, y <span class="op">=</span> <span class="va">fdis</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill<span class="op">=</span><span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Aridez"</span>, y <span class="op">=</span> <span class="st">"Diverg√™ncia Funcional (FDis)"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="co"># Gr√°fico modelo 2.</span>
<span class="va">plot_pred2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">lm_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">aridez</span>, y <span class="op">=</span> <span class="va">feve</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>pch<span class="op">=</span><span class="fl">21</span>, size<span class="op">=</span><span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill<span class="op">=</span><span class="st">"cyan4"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Aridez"</span>, y <span class="op">=</span> <span class="st">"Regularidade Funcional (FEve)"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="co">## Visualiza√ß√£o dos dois gr√°ficos em um √∫nica janela</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">plot_pred1</span>, <span class="va">plot_pred2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-func-comp-model"></span>
<img src="livro_files/figure-html/fig-func-comp-model-1.png" alt="Rela√ß√£o entre a composi√ß√£o funcional e o gradiente de aridez, ajustado por modelos lineares com seus diagn√≥sticos." width="100%" height="100%"><p class="caption">
Figura 14.8: Rela√ß√£o entre a composi√ß√£o funcional e o gradiente de aridez, ajustado por modelos lineares com seus diagn√≥sticos.
</p>
</div>
<p>Os resultados dos modelos <code>anova(mod1)</code> e <code>anova(mod2)</code> indicam que o gradiente de aridez n√£o afeta a dispers√£o e regularidade funcional. Os detalhes para conferir os pressupostos das an√°lises foram descritos no Cap√≠tulo <a href="cap7.html#cap7">7</a>.</p>
<p><strong>Exemplo 6</strong></p>
<p>Agora, vamos utilizar novamente os dados de 34 esp√©cies de plantas <span class="citation">(<a href="refer%C3%AAncias.html#ref-frenette-dussault_functional_2012" role="doc-biblioref">Frenette-Dussault et al. 2012</a>)</span>, mas agora para testar o efeito do pastejo sobre a diversidade beta funcional.</p>
<p><strong>Pergunta</strong></p>
<p>O pastejo determina a ocorr√™ncia de esp√©cies de plantas com diferentes atributos funcionais?</p>
<p><strong>Predi√ß√£o</strong></p>
<ul>
<li>A composi√ß√£o funcional de plantas √© diferente entre √°reas com e sem pastejo?</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li><p>Preditora: √°reas com e sem pastejo de gado (vari√°vel categ√≥rica com dois n√≠veis: <em>grazed</em> e <em>ungrazed</em>: <code>ambie_fren_dat</code>)</p></li>
<li><p>Dependentes: composi√ß√£o de esp√©cies (matriz de esp√©cies por localidade: <code>comun_fren_dat</code>) e atributos funcionais (matriz de atributos cont√≠nuos por esp√©cie: <code>trait_fren_dat</code>)</p></li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Nesse exemplo vamos calcular a CWM e depois usar uma PERMANOVA (Cap√≠tulo <a href="cap9.html#cap9">9</a>) para comparar o efeito das √°reas com e sem pastejo sobre a diversidade funcional (Figura <a href="cap14.html#fig:fig-func-cwm-model">14.9</a>).</p>
<div class="sourceCode" id="cb544"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Passo 1: CWM</span>
<span class="va">cwm_fren</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FD/man/functcomp.html">functcomp</a></span><span class="op">(</span><span class="va">trait_pad</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">comun_fren_dat</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cwm_fren</span><span class="op">)</span>
<span class="co">#&gt;           LA        SLA        LDMC       LN15        LCC</span>
<span class="co">#&gt; 1 -0.2411700 -0.3485515  0.19745200  0.1874003 -0.5367368</span>
<span class="co">#&gt; 2 -0.3977371  0.2326622 -0.09093270 -0.2859777  0.1643190</span>
<span class="co">#&gt; 3 -0.1857134  0.2010756 -0.39877265 -0.1250643 -0.4304617</span>
<span class="co">#&gt; 4 -0.2284064  0.1604101  0.80496307 -0.3704253  0.7193853</span>
<span class="co">#&gt; 5 -0.1664790  0.3486956  0.02232213 -0.2041931  0.2051391</span>
<span class="co">#&gt; 6 -0.3258821  0.3664583  0.04996829 -0.3352572  0.4713089</span>

<span class="co">## Passo 2: calcular a dist√¢ncia funcional</span>
<span class="va">cwm_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">cwm_fren</span>, <span class="st">"euclidean"</span><span class="op">)</span>

<span class="co">## Passo 3: testar se a composi√ß√£o funcional varia entre as √°reas com uma PERMANOVA</span>
<span class="va">perman_fren</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/adonis.html">adonis</a></span><span class="op">(</span><span class="va">cwm_fren</span> <span class="op">~</span> <span class="va">Grazing</span>, data <span class="op">=</span> <span class="va">ambie_fren_dat</span><span class="op">)</span>
<span class="va">perman_fren</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; adonis(formula = cwm_fren ~ Grazing, data = ambie_fren_dat) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Terms added sequentially (first to last)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           Df SumsOfSqs MeanSqs  F.Model      R2 Pr(&gt;F)</span>
<span class="co">#&gt; Grazing    1    -174.5 -174.46 -0.61591 -0.0142  0.547</span>
<span class="co">#&gt; Residuals 44   12463.0  283.25           1.0142       </span>
<span class="co">#&gt; Total     45   12288.5                   1.0000</span>

<span class="co">## Passo 4: comparar a varia√ß√£o dentro de cada grupo com Betadisper </span>
<span class="va">betad_fren</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper</a></span><span class="op">(</span><span class="va">cwm_dis</span>, <span class="va">ambie_fren_dat</span><span class="op">$</span><span class="va">Grazing</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">permutest</a></span><span class="op">(</span><span class="va">betad_fren</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Permutation test for homogeneity of multivariate dispersions</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: Distances</span>
<span class="co">#&gt;           Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)</span>
<span class="co">#&gt; Groups     1  0.0539 0.053858 0.1946    999  0.669</span>
<span class="co">#&gt; Residuals 44 12.1763 0.276735</span>

<span class="co">## Passo 5: PCoA</span>

<span class="va">cwm_pcoa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/pcoa.html">pcoa</a></span><span class="op">(</span>D <span class="op">=</span> <span class="va">cwm_dis</span>, correction <span class="op">=</span> <span class="st">"cailliez"</span><span class="op">)</span>
<span class="va">pcoa_eixos</span> <span class="op">&lt;-</span> <span class="va">cwm_pcoa</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="va">pcoa_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>pastagem <span class="op">=</span> <span class="va">ambie_fren_dat</span><span class="op">$</span><span class="va">Grazing</span>, <span class="va">pcoa_eixos</span><span class="op">)</span>

<span class="co">## Passo 6: definir os grupos ("HULL") para serem categorizados no gr√°fico </span>

<span class="va">grp.Grazed</span> <span class="op">&lt;-</span> <span class="va">pcoa_dat</span><span class="op">[</span><span class="va">pcoa_dat</span><span class="op">$</span><span class="va">pastagem</span> <span class="op">==</span> <span class="st">"Grazed"</span>, <span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/grDevices/chull.html">chull</a></span><span class="op">(</span><span class="va">pcoa_dat</span><span class="op">[</span><span class="va">pcoa_dat</span><span class="op">$</span><span class="va">pastagem</span> <span class="op">==</span> <span class="st">"Grazed"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Axis.1"</span>, <span class="st">"Axis.2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">grp.Ungrazed</span> <span class="op">&lt;-</span> <span class="va">pcoa_dat</span><span class="op">[</span><span class="va">pcoa_dat</span><span class="op">$</span><span class="va">pastagem</span> <span class="op">==</span> <span class="st">"Ungrazed"</span>, <span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/grDevices/chull.html">chull</a></span><span class="op">(</span><span class="va">pcoa_dat</span><span class="op">[</span><span class="va">pcoa_dat</span><span class="op">$</span><span class="va">pastagem</span> <span class="op">==</span> <span class="st">"Ungrazed"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Axis.1"</span>, <span class="st">"Axis.2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">hull_cwm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html">rbind</a></span><span class="op">(</span><span class="va">grp.Grazed</span>, <span class="va">grp.Ungrazed</span><span class="op">)</span> 

<span class="co">## Passo 7: Gr√°fico biplot</span>

<span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">cwm_pcoa</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">cwm_pcoa</span><span class="op">$</span><span class="va">trace</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># % de explica√ß√£o do eixo 1</span>
<span class="co">#&gt; [1] 53.5471</span>
<span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">cwm_pcoa</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">cwm_pcoa</span><span class="op">$</span><span class="va">trace</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="co"># % de explica√ß√£o do eixo 2</span>
<span class="co">#&gt; [1] 24.56026</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pcoa_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Axis.1</span>, y <span class="op">=</span> <span class="va">Axis.2</span>, color <span class="op">=</span> <span class="va">pastagem</span>, shape <span class="op">=</span> <span class="va">pastagem</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hull_cwm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">pastagem</span>, group <span class="op">=</span> <span class="va">pastagem</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"PCO 1 (53.6%)"</span>, y <span class="op">=</span> <span class="st">"PCO 2 (24.6%)"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-func-cwm-model"></span>
<img src="livro_files/figure-html/fig-func-cwm-model-1.png" alt="Rela√ß√£o do pastejo sobre a composi√ß√£o funcional." width="100%" height="100%"><p class="caption">
Figura 14.9: Rela√ß√£o do pastejo sobre a composi√ß√£o funcional.
</p>
</div>
<p>Neste exemplo, os resultados <code>perman_fren</code> demonstram que a composi√ß√£o funcional de plantas n√£o √© afetada pelo pastejo (P &gt; 0,05) e que a dispers√£o da composi√ß√£o <span class="citation">(uma medida potencial de diversidade beta: <a href="refer%C3%AAncias.html#ref-anderson_multivariate_2006" role="doc-biblioref">M. J. Anderson, Ellingsen, and McArdle 2006</a>)</span> de esp√©cies tamb√©m n√£o muda entre √°reas com ou sem pastejo (<code>permutest(betad_fren)</code>). A fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper()</a></code> deve ser sempre utilizada em conjunto com a PERMANOVA (<code><a href="https://rdrr.io/pkg/vegan/man/adonis.html">adonis()</a></code>) para poder interpretar quais as fontes de varia√ß√£o na composi√ß√£o de esp√©cies. Sendo assim, esta an√°lise representa um m√©todo fundamental para comparar se o potencial efeito (quando houver) √© fruto de diferen√ßa na composi√ß√£o de esp√©cies (i.e., diferen√ßa na posi√ß√£o dos centroides entre dois ou mais grupos) ou na varia√ß√£o da composi√ß√£o de esp√©cies entre os grupos (i.e., diferen√ßa na dispers√£o dos dados em rela√ß√£o aos centroides, ver mais no Cap√≠tulo <a href="cap9.html#cap9">9</a>). Esta √∫ltima informa√ß√£o, a dispers√£o, √© geralmente interpretada como uma analogia a homogeneidade de vari√¢ncias de uma ANOVA (i.e., Teste de Levene). A hip√≥tese nula do <code><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper()</a></code> √© que a dispers√£o dos grupos √© homog√™nea (ou seja, o valor de probabilidade nos casos que existem dispers√µes homog√™neas ser√° maior do que 0,05). Por√©m, se esse valor de p for menor do que 0,05, voc√™ deve rejeitar a hip√≥tese nula e concluir que as dispers√µes s√£o heterog√™neas.</p>
<p>Os gr√°ficos de PCoA s√£o uma ferramenta poderosa para interpretar os resultados da PERMANOVA + Betadisper. Quanto mais diferente a composi√ß√£o de esp√©cies entre dois ou mais grupos, mais distante devem ser os centroides desses grupos. Al√©m disso, se as √°reas dos pol√≠gonos que conectam todas as r√©plicas de cada grupo forem diferentes em tamanho (hip√≥tese que ser√° testada com o Betadisper), √© poss√≠vel tamb√©m visualizar esta diferen√ßa. Em conclus√£o, para testar se diferen√ßas de composi√ß√£o funcional existem entre dois ou mais grupos, ser√° fundamental: i) comparar a varia√ß√£o da posi√ß√£o dos centr√≥ides (fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/adonis.html">adonis()</a></code>) e ii) a varia√ß√£o da dispers√£o da composi√ß√£o funcional entre os grupos (fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper()</a></code>).</p>
</div>
<div id="varia√ß√£o-intraespec√≠fica" class="section level2" number="14.6">
<h2>
<span class="header-section-number">14.6</span> Varia√ß√£o Intraespec√≠fica<a class="anchor" aria-label="anchor" href="#varia%C3%A7%C3%A3o-intraespec%C3%ADfica"><i class="fas fa-link"></i></a>
</h2>
<p>Os m√©todos discutidos anteriormente utilizam valores m√©dios dos atributos das esp√©cies para descrever a estrutura funcional da comunidade e interpretar as rela√ß√µes entre determinadas vari√°veis preditoras (como clima, por exemplo) com a diversidade funcional. Por√©m, ao utilizar atributos m√©dios estamos desconsiderando que a varia√ß√£o deste atributo dentro da esp√©cie seja determinante para a resposta da esp√©cie ao ambiente ou seu efeito sobre o ecossistema <span class="citation">(<a href="refer%C3%AAncias.html#ref-bolnick_why_2011" role="doc-biblioref">Bolnick et al. 2011</a> ; <a href="refer%C3%AAncias.html#ref-violle_return_2012" role="doc-biblioref">Violle et al. 2012</a>)</span>. Os estudos que usam dados m√©dios para testar hip√≥teses em ecologia funcional argumentam que a varia√ß√£o dentro das esp√©cie √© menor do que a varia√ß√£o entre esp√©cies e, desse modo, o ru√≠do causado ao desconsiderar a vari√¢ncia do atributo dentro da esp√©cies √© desprez√≠vel <span class="citation">(<a href="refer%C3%AAncias.html#ref-siefert_global_2015" role="doc-biblioref">Siefert et al. 2015</a>)</span>. Por√©m, diversos estudos t√™m mostrado que esse argumento √© fr√°gil e que a inclus√£o da varia√ß√£o intraespec√≠fica melhora nossa capacidade preditiva em ecologia funcional <span class="citation">(<a href="refer%C3%AAncias.html#ref-violle_return_2012" role="doc-biblioref">Violle et al. 2012</a>; <a href="refer%C3%AAncias.html#ref-siefert_global_2015" role="doc-biblioref">Siefert et al. 2015</a>)</span>. Uma abordagem geralmente utilizada √© a decomposi√ß√£o da vari√¢ncia do atributo em diferentes n√≠veis de organiza√ß√£o: i) varia√ß√£o dentro da popula√ß√£o da mesma esp√©cie em uma mesma unidade amostral, ii) varia√ß√£o dentro das popula√ß√µes (independente da esp√©cie) de uma comunidade em uma mesma unidade amostral, e iii) varia√ß√£o entre popula√ß√µes. Conhecida como estat√≠stica T, esta abordagem permite entender as fontes (intra ou interespec√≠fica) de varia√ß√£o nos atributos em diferentes escalas <span class="citation">(<a href="refer%C3%AAncias.html#ref-violle_return_2012" role="doc-biblioref">Violle et al. 2012</a>)</span>. Outro m√©todo que quantifica a vari√¢ncia explicada pela variabilidade intraespec√≠fica, interespec√≠fica e a covari√¢ncia entre elas foi proposto por Leps et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-leps_community_2011" role="doc-biblioref">2011</a>)</span>. Este m√©todo permite calcular a contribui√ß√£o da varia√ß√£o intraespec√≠fica dentro e entre comunidades. Agora, vamos entender a contribui√ß√£o da varia√ß√£o de um atributo dentro da esp√©cie comparada √† varia√ß√£o entre esp√©cies.</p>
<p><strong>Exemplo 7</strong></p>
<p>Vamos utilizar os dados de 11 esp√©cies de anuros associados com 26 po√ßas no Parque Nacional Lagoa do Peixe <span class="citation">(<a href="refer%C3%AAncias.html#ref-dalmolin_turnover_2020" role="doc-biblioref">Dalmolin, Tozetti, and Pereira 2020</a>)</span>. Atributos morfol√≥gicos foram coletados em todos os indiv√≠duos coletados em cada po√ßa. Desse modo, √© poss√≠vel comparar a varia√ß√£o morfol√≥gica entre indiv√≠duos da mesma esp√©cie e entre esp√©cies diferentes. Al√©m disso, √© poss√≠vel quantificar a contribui√ß√£o da varia√ß√£o dentro e entre diferentes po√ßas. No exemplo abaixo, criamos cinco atributos com nomes diferentes daqueles usados no artigo de Dalmolin et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-dalmolin_turnover_2020" role="doc-biblioref">2020</a>)</span>. Em cada po√ßa, os autores coletaram os seguintes dados das po√ßas: i) profundidade, ii) area, iii) dist√¢ncia entre po√ßas, e iv) dist√¢ncia da po√ßa para a floresta mais pr√≥xima.</p>
<p><strong>Pergunta 1</strong></p>
<p>Qual a contribui√ß√£o da varia√ß√£o intraespec√≠fica para a varia√ß√£o total dos atributos morfol√≥gicos de anuros?</p>
<p><strong>Predi√ß√£o</strong></p>
<ul>
<li>A alta plasticidade fenot√≠pica de anuros indica alta contribui√ß√£o da varia√ß√£o intraespec√≠fica comparada a interespec√≠fica</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Preditora: esp√©cies (categ√≥rica)</li>
<li>Dependente: varia√ß√£o dos atributos morfol√≥gicos</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Aqui vamos realizar o passo a passo das an√°lises para comparar a contribui√ß√£o da varia√ß√£o intraespec√≠fica para a varia√ß√£o total dos atributos morfol√≥gicos.</p>
<div class="sourceCode" id="cb545"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados necess√°rios</span>
<span class="co"># Matriz de traits.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">traits</span><span class="op">)</span>
<span class="co">#&gt;   pond Species body_size biomass eye_size leg_size flatness</span>
<span class="co">#&gt; 1  DN1     Sp2     2.405   2.291    3.104    0.450    0.794</span>
<span class="co">#&gt; 2  DN1     Sp3     1.882   2.039    2.926    0.345    1.063</span>
<span class="co">#&gt; 3  DN1     Sp4     0.699   0.342    0.782    0.104    3.055</span>
<span class="co">#&gt; 4  DN1     Sp4     0.725   0.598    1.120    0.136    2.759</span>
<span class="co">#&gt; 5  DN1     Sp4     0.448   0.385    0.844    0.107    3.557</span>
<span class="co">#&gt; 6  DN1     Sp4     0.640   0.470    0.861    0.093    3.420</span>

<span class="co">## Parti√ß√£o da varia√ß√£o intra e interespec√≠fica</span>
<span class="co">## Passo 1: Tamanho corporal</span>
<span class="va">mod_body_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">body_size</span><span class="op">~</span><span class="va">Species</span>, data <span class="op">=</span> <span class="va">traits</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_body_size</span><span class="op">)</span>
<span class="co">#&gt;              Df Sum Sq Mean Sq F value Pr(&gt;F)    </span>
<span class="co">#&gt; Species      10  95.91   9.591    25.5 &lt;2e-16 ***</span>
<span class="co">#&gt; Residuals   195  73.35   0.376                   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Contribui√ß√£o da varia√ß√£o intra-espec√≠fica para o tamanho corporal.</span>
<span class="va">itv_BS</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="fl">73.35</span><span class="op">/</span><span class="op">(</span><span class="fl">95.92</span> <span class="op">+</span> <span class="fl">73.35</span><span class="op">)</span><span class="op">)</span>
<span class="va">itv_BS</span>
<span class="co">#&gt; [1] 43.33314</span>

<span class="co">## Passo 2: Biomassa</span>
<span class="va">mod_biomass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">biomass</span><span class="op">~</span><span class="va">Species</span>, data <span class="op">=</span> <span class="va">traits</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_biomass</span><span class="op">)</span>
<span class="co">#&gt;              Df Sum Sq Mean Sq F value Pr(&gt;F)    </span>
<span class="co">#&gt; Species      10 118.17  11.817   23.95 &lt;2e-16 ***</span>
<span class="co">#&gt; Residuals   195  96.22   0.493                   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Contribui√ß√£o da varia√ß√£o intra-espec√≠fica para a biomassa.</span>
<span class="va">itv_biomass</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="fl">96.22</span><span class="op">/</span><span class="op">(</span><span class="fl">118.17</span> <span class="op">+</span> <span class="fl">96.22</span><span class="op">)</span><span class="op">)</span>
<span class="va">itv_biomass</span>
<span class="co">#&gt; [1] 44.88082</span>

<span class="co">## Passo 3: Tamanho do olho</span>
<span class="va">mod_eye_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">eye_size</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">traits</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_eye_size</span><span class="op">)</span>
<span class="co">#&gt;              Df Sum Sq Mean Sq F value Pr(&gt;F)    </span>
<span class="co">#&gt; Species      10  203.1  20.309   50.51 &lt;2e-16 ***</span>
<span class="co">#&gt; Residuals   195   78.4   0.402                   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Contribui√ß√£o da varia√ß√£o intra-espec√≠fica para o tamanho do olho.</span>
<span class="va">itv_eye_size</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="fl">78.39</span><span class="op">/</span><span class="op">(</span><span class="fl">203.09</span> <span class="op">+</span> <span class="fl">78.39</span><span class="op">)</span><span class="op">)</span>
<span class="va">itv_eye_size</span>
<span class="co">#&gt; [1] 27.84923</span>

<span class="co">## Passo 4: Achatamento dorso-ventral</span>
<span class="va">mod_flatness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">flatness</span><span class="op">~</span><span class="va">Species</span>, data <span class="op">=</span> <span class="va">traits</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_flatness</span><span class="op">)</span>
<span class="co">#&gt;              Df Sum Sq Mean Sq F value Pr(&gt;F)    </span>
<span class="co">#&gt; Species      10 104.47  10.447   92.07 &lt;2e-16 ***</span>
<span class="co">#&gt; Residuals   195  22.13   0.113                   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Contribui√ß√£o da varia√ß√£o intra-espec√≠fica para o achatamento dorso-ventral.</span>
<span class="va">itv_flatness</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="fl">22.13</span><span class="op">/</span><span class="op">(</span><span class="fl">104.48</span> <span class="op">+</span> <span class="fl">22.13</span><span class="op">)</span><span class="op">)</span>
<span class="va">itv_flatness</span>
<span class="co">#&gt; [1] 17.47887</span>

<span class="co">## Passo 5: Combinar os valores de cada trait em um vetor</span>
<span class="va">valores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">itv_BS</span>, <span class="va">itv_biomass</span>, <span class="va">itv_eye_size</span>, <span class="va">itv_flatness</span><span class="op">)</span>

<span class="co"># Passo 6: Combinar valores e traits em um data.frame.</span>
<span class="va">itv_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"body_size"</span>, <span class="st">"biomass"</span>, <span class="st">"eye_size"</span>, <span class="st">"flatness"</span><span class="op">)</span>,
                          itv_explic <span class="op">=</span> <span class="va">valores</span><span class="op">)</span>

<span class="co">## Tabela com resultados da explica√ß√£o atribuida para a varia√ß√£o intraespec√≠fica</span>
<span class="va">itv_results</span> <span class="op"><a href="https://ggobi.github.io/ggally/reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="st">"explained intraspecific variance"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">itv_explic</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://ggobi.github.io/ggally/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">trait</span>, <span class="st">"explained intraspecific variance"</span><span class="op">)</span>
<span class="co">#&gt;       trait explained intraspecific variance</span>
<span class="co">#&gt; 1 body_size                            43.33</span>
<span class="co">#&gt; 2   biomass                            44.88</span>
<span class="co">#&gt; 3  eye_size                            27.85</span>
<span class="co">#&gt; 4  flatness                            17.48</span></code></pre></div>
<p><strong>Pergunta 2</strong></p>
<p>Qual a contribui√ß√£o da varia√ß√£o entre po√ßas para a varia√ß√£o total dos atributos morfol√≥gicos de anuros?</p>
<p><strong>Predi√ß√£o</strong></p>
<ul>
<li>A varia√ß√£o morfol√≥gica de anuros √© afetada por mudan√ßas dentro das esp√©cies e entre diferentes esp√©cies de po√ßas distintas</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Preditoras: po√ßas e esp√©cies (ambas categ√≥ricas)</li>
<li>Dependente: varia√ß√£o dos atributos morfol√≥gicos</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Aqui vamos realizar o teste para comparar a contribui√ß√£o da varia√ß√£o entre po√ßas para a varia√ß√£o total dos atributos morfol√≥gicos (Figura <a href="cap14.html#fig:fig-func-intra">14.10</a>).</p>
<div class="sourceCode" id="cb546"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados necess√°rios</span>
<span class="co"># Matriz de traits sem nomes de esp√©cies ou localidades</span>
<span class="va">trait_m</span> <span class="op">&lt;-</span> <span class="va">traits</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"body_size"</span>, <span class="st">"biomass"</span>, <span class="st">"eye_size"</span>, <span class="st">"leg_size"</span>, <span class="st">"flatness"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">trait_m</span><span class="op">)</span>
<span class="co">#&gt;   body_size biomass eye_size leg_size flatness</span>
<span class="co">#&gt; 1     2.405   2.291    3.104    0.450    0.794</span>
<span class="co">#&gt; 2     1.882   2.039    2.926    0.345    1.063</span>
<span class="co">#&gt; 3     0.699   0.342    0.782    0.104    3.055</span>
<span class="co">#&gt; 4     0.725   0.598    1.120    0.136    2.759</span>
<span class="co">#&gt; 5     0.448   0.385    0.844    0.107    3.557</span>
<span class="co">#&gt; 6     0.640   0.470    0.861    0.093    3.420</span>
<span class="va">trait_decomp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cati/man/decompCTRE.html">decompCTRE</a></span><span class="op">(</span>traits <span class="op">=</span> <span class="va">trait_m</span>, sp <span class="op">=</span> <span class="va">traits</span><span class="op">$</span><span class="va">Species</span>, 
                           ind.plot <span class="op">=</span> <span class="va">traits</span><span class="op">$</span><span class="va">pond</span>, print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/cati/man/decompCTRE.html">barplot.decompCTRE</a></span><span class="op">(</span><span class="va">trait_decomp</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-func-intra"></span>
<img src="livro_files/figure-html/fig-func-intra-1.png" alt="Gr√°fico de barras mostrando a contribui√ß√£o da varia√ß√£o entre po√ßas para a varia√ß√£o total dos atributos morfol√≥gicos." width="100%" height="100%"><p class="caption">
Figura 14.10: Gr√°fico de barras mostrando a contribui√ß√£o da varia√ß√£o entre po√ßas para a varia√ß√£o total dos atributos morfol√≥gicos.
</p>
</div>
<p><strong>Pergunta 3</strong></p>
<p>Caracter√≠sticas ambientais das po√ßas afetam a varia√ß√£o intraespec√≠fica?</p>
<p><strong>Predi√ß√£o</strong></p>
<ul>
<li>A profundidade e √°rea da po√ßa aumentam a contribui√ß√£o da varia√ß√£o intraespec√≠fica em rela√ß√£o a varia√ß√£o interespec√≠fica.</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li>Preditora: caracter√≠sticas das po√ßas</li>
<li>Dependentes: varia√ß√£o dos atributos morfol√≥gicos e contribui√ß√£o da varia√ß√£o intraespec√≠fica</li>
</ul>
<p><strong>An√°lises</strong></p>
<p>Para calcular a contribui√ß√£o relativa da varia√ß√£o intraespec√≠fica em rela√ß√£o √† varia√ß√£o interespec√≠fica dentro de uma comunidade, por exemplo, Siefert et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-siefert_global_2015" role="doc-biblioref">2015</a>)</span> sugeriram uma m√©trica chamada de wITV (<em>within-community Intraspecific Trait Variation</em>). A wITV representa a raz√£o da varia√ß√£o intraespec√≠fica em rela√ß√£o a varia√ß√£o total dentro de uma comunidade (e.g., parcela, po√ßa) que inclui: i) a abund√¢ncia relativa de cada esp√©cie <em>j</em> ocorrendo na comunidade <em>i</em>, ii) o valor m√©dio do atributo da esp√©cie <em>j</em> na comunidade <em>i</em>, e iii) o valor do atributo <em>k</em> de cada indiv√≠duo da esp√©cie <em>j</em> que ocorre na comunidade <em>i</em>. Como esta medida √© feita por unidade amostral (ou seja, sua comunidade de interesse), √© poss√≠vel testar hip√≥teses ecol√≥gicas que tentem explicar processos que aumentem ou diminuam a varia√ß√£o de um determinado atributo dentro ou entre esp√©cies diferentes. A fun√ß√£o wITV foi adaptada para a linguagem R por de Bello et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-de_bello_handbook_2021" role="doc-biblioref">2021</a>)</span>. Para facilitar o c√°lculo do wITV para cada comunidade, de Bello et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-de_bello_handbook_2021" role="doc-biblioref">2021</a>)</span> executaram os c√≥digos com a fun√ß√£o <code>for()</code> que repete iterativamente a an√°lise para gerar os valores de todas as comunidades em uma forma din√¢mica. Ap√≥s executar as an√°lises com o <code>for()</code>, a fun√ß√£o salva os resultados dentro do objeto <code>wITVResults</code>. Ap√≥s obter esses resultados, √© poss√≠vel utilizar modelos lineares para testar quais vari√°veis preditoras (em nosso exemplo, caracter√≠sticas das po√ßas) afetam o aumento ou diminui√ß√£o da contribui√ß√£o relativa da varia√ß√£o intraespec√≠fica (Figura <a href="cap14.html#fig:fig-func-witv">14.11</a>).</p>
<div class="sourceCode" id="cb547"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados necess√°rios</span>
<span class="co"># Matriz de traits.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">traits</span><span class="op">)</span>
<span class="co">#&gt;   pond Species body_size biomass eye_size leg_size flatness</span>
<span class="co">#&gt; 1  DN1     Sp2     2.405   2.291    3.104    0.450    0.794</span>
<span class="co">#&gt; 2  DN1     Sp3     1.882   2.039    2.926    0.345    1.063</span>
<span class="co">#&gt; 3  DN1     Sp4     0.699   0.342    0.782    0.104    3.055</span>
<span class="co">#&gt; 4  DN1     Sp4     0.725   0.598    1.120    0.136    2.759</span>
<span class="co">#&gt; 5  DN1     Sp4     0.448   0.385    0.844    0.107    3.557</span>
<span class="co">#&gt; 6  DN1     Sp4     0.640   0.470    0.861    0.093    3.420</span>

<span class="co"># Matriz de comunidades e padroniza√ß√£o para abund√¢ncia relativa</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">anuros_comm</span><span class="op">)</span>
<span class="co">#&gt;      Sp10 Sp11 Sp2 Sp3 Sp4 Sp6 Sp7 Sp8 Sp1 Sp9 Sp5</span>
<span class="co">#&gt; DN1     1    8   1   1   6   8   4   0   0   0   0</span>
<span class="co">#&gt; DN2     0    0   0   0   1   1   4   2   0   0   0</span>
<span class="co">#&gt; DN3     1    0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; DN4     0    0   2   2   1   0   0   0   6   0   0</span>
<span class="co">#&gt; DN5     0    0   3   0   1   0   4   1   0   0   0</span>
<span class="co">#&gt; FIG1    0    0   1   0   0   0   1   0   0   0   0</span>
<span class="va">anuros_comm_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span><span class="va">anuros_comm</span>, <span class="st">"total"</span><span class="op">)</span>

<span class="co"># Vari√°veis ambientais.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span>
<span class="co">#&gt;      depth  area dits_bt_pond dist_for</span>
<span class="co">#&gt; DN1   0.50  3800          115     2650</span>
<span class="co">#&gt; DN2   0.60 54600          250     2500</span>
<span class="co">#&gt; DN3   0.80 29110          150     1800</span>
<span class="co">#&gt; DN4   1.00  1386          410      195</span>
<span class="co">#&gt; DN5   1.00   590          770      100</span>
<span class="co">#&gt; FIG1  0.15    30           25      135</span>

<span class="co">## Preara√ß√£o da matriz para receber os resultados do `for`</span>
<span class="va">wITVResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ITV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">traits</span><span class="op">$</span><span class="va">pond</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">wITVResults</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">traits</span><span class="op">$</span><span class="va">pond</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">traits</span><span class="op">$</span><span class="va">pond</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">commAux</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">traits</span>, <span class="va">traits</span><span class="op">$</span><span class="va">pond</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">traits</span><span class="op">$</span><span class="va">pond</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
    <span class="va">commAux</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">commAux</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span>
    <span class="va">spNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">commAux</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
    <span class="va">relAbund</span> <span class="op">&lt;-</span> <span class="va">anuros_comm_rel</span><span class="op">[</span><span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">spNames</span><span class="op">)</span><span class="op">]</span> 
    <span class="va">traitsVector</span> <span class="op">&lt;-</span> <span class="va">commAux</span><span class="op">$</span><span class="va">body_size</span>
    <span class="va">spVector</span> <span class="op">&lt;-</span> <span class="va">commAux</span><span class="op">$</span><span class="va">Species</span>
    <span class="va">wITVResults</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="fu">wITV</span><span class="op">(</span>spIDs <span class="op">=</span> <span class="va">spVector</span>, traitVals <span class="op">=</span> <span class="va">traitsVector</span>, relAbund <span class="op">=</span> <span class="va">relAbund</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">wITVResults</span><span class="op">$</span><span class="va">ITV</span>
<span class="co">#&gt;  [1] 0.82517670 0.23326457        NaN 0.15341806 0.10298952 0.00000000 0.02338235 0.68170997 0.79275763 0.66446945</span>
<span class="co">#&gt; [11] 0.81726278 1.00000000 0.00000000 1.00000000 1.00000000 0.99220999 1.00000000 0.55519098 0.58945126 0.55148974</span>
<span class="co">#&gt; [21] 0.80178255 1.00000000 1.00000000        NaN 0.19621528 0.14467854</span>
<span class="va">env</span><span class="op">$</span><span class="va">wITV</span> <span class="op">&lt;-</span> <span class="va">wITVResults</span><span class="op">$</span><span class="va">ITV</span> <span class="co"># NaN = locais com uma √∫nica esp√©cie</span>

<span class="co">## Remover NAs para executar o modelo linear</span>
<span class="va">env2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">env2</span><span class="op">)</span>  
<span class="co">#&gt;      depth  area dits_bt_pond dist_for       wITV</span>
<span class="co">#&gt; DN1   0.50  3800          115     2650 0.82517670</span>
<span class="co">#&gt; DN2   0.60 54600          250     2500 0.23326457</span>
<span class="co">#&gt; DN4   1.00  1386          410      195 0.15341806</span>
<span class="co">#&gt; DN5   1.00   590          770      100 0.10298952</span>
<span class="co">#&gt; FIG1  0.15    30           25      135 0.00000000</span>
<span class="co">#&gt; FIG2  0.15    30           25      135 0.02338235</span>

<span class="co">## Modelo linear </span>
<span class="va">mod_itv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">wITV</span> <span class="op">~</span> <span class="va">depth</span> <span class="op">+</span> <span class="va">area</span> <span class="op">+</span> <span class="va">dits_bt_pond</span> <span class="op">+</span> <span class="va">dist_for</span>, data <span class="op">=</span> <span class="va">env</span><span class="op">)</span>

<span class="co">## Testar pressuposto da an√°lise</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">mod_itv</span><span class="op">)</span>

<span class="co">## Resultado</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_itv</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = wITV ~ depth + area + dits_bt_pond + dist_for, data = env)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -0.6298 -0.3937  0.0448  0.3387  0.5266 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)  </span>
<span class="co">#&gt; (Intercept)   4.555e-01  2.113e-01   2.156   0.0449 *</span>
<span class="co">#&gt; depth         2.767e-01  3.789e-01   0.730   0.4746  </span>
<span class="co">#&gt; area         -3.116e-06  9.276e-06  -0.336   0.7409  </span>
<span class="co">#&gt; dits_bt_pond -3.653e-04  6.193e-04  -0.590   0.5626  </span>
<span class="co">#&gt; dist_for      5.698e-05  1.419e-04   0.401   0.6928  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.4103 on 18 degrees of freedom</span>
<span class="co">#&gt;   (3 observations deleted due to missingness)</span>
<span class="co">#&gt; Multiple R-squared:  0.03155,    Adjusted R-squared:  -0.1837 </span>
<span class="co">#&gt; F-statistic: 0.1466 on 4 and 18 DF,  p-value: 0.9621</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-func-witv"></span>
<img src="livro_files/figure-html/fig-func-witv-1.png" alt="Gr√°ficos diagn√≥sticos do modelo linear ajustado para iWTV em fun√ß√£o de caracter√≠sticas das po√ßas." width="100%" height="100%"><p class="caption">
Figura 14.11: Gr√°ficos diagn√≥sticos do modelo linear ajustado para iWTV em fun√ß√£o de caracter√≠sticas das po√ßas.
</p>
</div>
<p>Combinando os resultados das tr√™s an√°lises √© poss√≠vel compreender que existem diferen√ßas morfol√≥gicas entre as esp√©cies de po√ßas diferentes (componente substitui√ß√£o). Por√©m, √© evidente que a varia√ß√£o dentro da esp√©cie √© bastante relevante para compreender a diversidade funcional de anuros. Na primeira an√°lise, os resultados dessas quatro an√°lises indicaram que a varia√ß√£o intraespec√≠fica explica de 17% a 45% da varia√ß√£o morfol√≥gica nas metacomunidades de anuros. A segunda, por sua vez, demonstra que a varia√ß√£o morfol√≥gica entre esp√©cies de po√ßas diferentes representa o principal componente de varia√ß√£o, mas que a varia√ß√£o intraespec√≠fica n√£o pode ser ignorada. Por fim, ao combinar a m√©trica wITV com modelos lineares, percebe-se que as caracter√≠sticas das po√ßas n√£o determinam a contribui√ß√£o da varia√ß√£o intraespec√≠fica. Al√©m disso, existe uma varia√ß√£o muito grande entre po√ßas. Ao passo que em algumas po√ßas a varia√ß√£o intraespec√≠fica n√£o contribui para a varia√ß√£o total (wITV = 0), em outras, este componente representou 100% da varia√ß√£o (wITV = 1). Os resultados obtidos nas an√°lises das perguntas 1 a 3 indicam que utilizar somente a m√©dia dos atributos morfol√≥gicos pode refletir em interpreta√ß√µes incorretas em estudos que compararam a diversidade funcional no espa√ßo/tempo <span class="citation">(veja discuss√£o em <a href="refer%C3%AAncias.html#ref-dalmolin_turnover_2020" role="doc-biblioref">Dalmolin, Tozetti, and Pereira 2020</a>)</span>.</p>
</div>
<div id="para-se-aprofundar-10" class="section level2" number="14.7">
<h2>
<span class="header-section-number">14.7</span> Para se aprofundar<a class="anchor" aria-label="anchor" href="#para-se-aprofundar-10"><i class="fas fa-link"></i></a>
</h2>
<div id="livros-9" class="section level3" number="14.7.1">
<h3>
<span class="header-section-number">14.7.1</span> Livros<a class="anchor" aria-label="anchor" href="#livros-9"><i class="fas fa-link"></i></a>
</h3>
<p>Recomendamos a leitura dos livros: i) Garnier et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-garnier_plant_2016" role="doc-biblioref">2016</a>)</span> <em>Plant Functional Diversity: Organism Traits, Community Structure, and Ecosystem Properties</em>, e ii) de Bello et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-de_bello_handbook_2021" role="doc-biblioref">2021</a>)</span> <em>Handbook of Trait-Based Ecology</em>. Esses livros oferecem excelente oportunidade para se aprofundar no campo te√≥rico da diversidade funcional e, al√©m disso, o livro liderado pelo pesquisador Francesco de Bello fornece diversas aplica√ß√µes anal√≠ticas na linguagem R. Outro recurso excelente foi publicado por Mammola et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-mammola_concepts_2021" role="doc-biblioref">2021</a>)</span> <em>Concepts and Applications in Functional Diversity</em> e serve para se aprofundar nas diferentes medidas da diversidade funcional.</p>
</div>
<div id="links-9" class="section level3" number="14.7.2">
<h3>
<span class="header-section-number">14.7.2</span> Links<a class="anchor" aria-label="anchor" href="#links-9"><i class="fas fa-link"></i></a>
</h3>
<p>Um passo importante nos estudos de Diversidade Funcional √© encontrar atributos funcionais dos organismos estudados. Abaixo indicamos uma lista de potenciais bases de dados:</p>
<ul>
<li><a href="https://compadre-db.org/">COMADRE - Animal Matrix Database</a></li>
<li><a href="https://compadre-db.org/">COMPADRE - Plant Matrix Database</a></li>
<li><a href="https://esajournals.onlinelibrary.wiley.com/doi/10.1890/13-1917.1">Elton Traits 1.0</a></li>
<li><a href="https://figshare.com/articles/dataset/TetraDENSITY_Population_Density_dataset/5371633?file=11358218">TetraDENSITY - Density estimates in terrestrial vertebrates</a></li>
<li><a href="https://www.try-db.org/TryWeb/Home.php">TRY - Plant Trait Database</a></li>
<li><a href="https://spidertraits.sci.muni.cz/">World Spider Trait</a></li>
</ul>
</div>
</div>
<div id="exerc√≠cios-10" class="section level2" number="14.8">
<h2>
<span class="header-section-number">14.8</span> Exerc√≠cios<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcios-10"><i class="fas fa-link"></i></a>
</h2>
<p><strong>14.1</strong>
Utilize os dados <code>aviurba</code> do pacote <code>ade4</code> para testar o efeito de vari√°veis ambientais na dispers√£o (FDis) e regularidade funcional (FEve). Utilize modelos lineares (LM, veja Cap√≠tulo <a href="cap7.html#cap7">7</a>) para testar quais vari√°veis ambientais s√£o as mais importantes para a dispers√£o e regularidade funcional. Al√©m disso, fa√ßa um boxplot (veja Cap√≠tulo <a href="cap6.html#cap6">6</a>) comparando os valores de FDis e FEve entre as categorias das vari√°veis ambientais mais relevantes.</p>
<p><strong>14.2</strong>
Utilize os dados <code>mafragh</code> do pacote <code>ade4</code> para teste o efeito da das vari√°veis <code>conductivity</code>, <code>silt</code> e <code>K2O</code> na diversidade funcional (m√©todo de Petchey e Gaston). Utilize modelos lineares (regress√£o m√∫ltipla, veja Cap√≠tulo <a href="cap7.html#cap7">7</a>) para testar a rela√ß√£o entre essas vari√°veis e discuta: (a) qual vari√°vel mais importante (se houver) e (b) se as conclus√µes s√£o coerentes tendo como base os pressupostos dos modelos lineares. Al√©m disso, caso exista alguma rela√ß√£o significativa, fa√ßa um gr√°fico (<em>scatterplot</em>, veja Cap√≠tulo <a href="cap6.html#cap6">6</a>) da rela√ß√£o da vari√°vel mais importante e a diversidade funcional.</p>
<p><strong>14.3</strong>
Utilize os dados <code>mafragh</code> do pacote <code>ade4</code> para comparar a composi√ß√£o filogen√©tica e funcional em √°reas com alta e baixa concentra√ß√£o de pot√°ssio. Para fazer esta compara√ß√£o ser√° necess√°rio transformar a matriz de atributos funcionais e a √°rvore filogen√©tica em matrizes de dist√¢ncia e, depois, utilizar o CWM para criar uma matriz de localidades por composi√ß√£o funcional ou filogen√©tica. Depois, voc√™ poder√° usar a matriz CWM para testar potenciais diferen√ßas entre concentra√ß√µes com PERMANOVA e para visualizar com PCoA.</p>
<p><a href="https://exercicios-livro-aer.netlify.app/cap.-14---diversidade-funcional.html">Solu√ß√µes dos exerc√≠cios</a>.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="cap13.html"><span class="header-section-number">13</span> Diversidade Filogen√©tica</a></div>
<div class="next"><a href="cap15.html"><span class="header-section-number">15</span> Dados geoespaciais</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Neste cap√≠tulo"><h2>Nesta p√°gina</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cap14"><span class="header-section-number">14</span> Diversidade Funcional</a></li>
<li><a class="nav-link" href="#pr%C3%A9-requisitos-do-cap%C3%ADtulo-10">Pr√©-requisitos do cap√≠tulo</a></li>
<li><a class="nav-link" href="#aspectos-te%C3%B3ricos-5"><span class="header-section-number">14.1</span> Aspectos te√≥ricos</a></li>
<li><a class="nav-link" href="#definindo-a-dissimilaridade-entre-esp%C3%A9cies"><span class="header-section-number">14.2</span> Definindo a dis(similaridade) entre esp√©cies</a></li>
<li>
<a class="nav-link" href="#m%C3%A9tricas-de-diversidade-funcional-alfa"><span class="header-section-number">14.3</span> M√©tricas de diversidade funcional (alfa)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#riqueza-funcional"><span class="header-section-number">14.3.1</span> Riqueza funcional</a></li>
<li><a class="nav-link" href="#diverg%C3%AAncia-funcional"><span class="header-section-number">14.3.2</span> Diverg√™ncia funcional</a></li>
<li><a class="nav-link" href="#regularidade-funcional"><span class="header-section-number">14.3.3</span> Regularidade funcional</a></li>
<li><a class="nav-link" href="#correla%C3%A7%C3%A3o-entre-as-m%C3%A9tricas-de-diversidade-funcional-alfa"><span class="header-section-number">14.3.4</span> Correla√ß√£o entre as m√©tricas de diversidade funcional (alfa)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#m%C3%A9tricas-de-diversidade-funcional-beta"><span class="header-section-number">14.4</span> M√©tricas de diversidade funcional (beta)</a></li>
<li><a class="nav-link" href="#composi%C3%A7%C3%A3o-funcional-community-wegihed-means---cwm"><span class="header-section-number">14.5</span> Composi√ß√£o Funcional (Community Wegihed Means - CWM)</a></li>
<li><a class="nav-link" href="#varia%C3%A7%C3%A3o-intraespec%C3%ADfica"><span class="header-section-number">14.6</span> Varia√ß√£o Intraespec√≠fica</a></li>
<li>
<a class="nav-link" href="#para-se-aprofundar-10"><span class="header-section-number">14.7</span> Para se aprofundar</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#livros-9"><span class="header-section-number">14.7.1</span> Livros</a></li>
<li><a class="nav-link" href="#links-9"><span class="header-section-number">14.7.2</span> Links</a></li>
</ul>
</li>
<li><a class="nav-link" href="#exerc%C3%ADcios-10"><span class="header-section-number">14.8</span> Exerc√≠cios</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/paternogbc/livro_aer/blob/master/14_diversidade_funcional.Rmd">Ver fonte <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/paternogbc/livro_aer/edit/master/14_diversidade_funcional.Rmd">Edite esta p√°gina <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>An√°lises Ecol√≥gicas no R</strong>" foi escrito por Fernando Rodrigues da Silva, Thiago Gon√ßalves-Souza, Gustavo Brant Paterno, <br> Diogo Borges Provete, Maur√≠cio Humberto Vancine. √öltima atualiza√ß√£o: 2022-02-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
        <p>Este livro foi compilado com o pacote <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
