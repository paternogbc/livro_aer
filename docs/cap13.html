<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cap√≠tulo 13 Diversidade Filogen√©tica | An√°lises Ecol√≥gicas no R</title>
<meta name="author" content="Fernando Rodrigues da Silva, Thiago Gon√ßalves-Souza, Gustavo Brant Paterno,   Diogo Borges Provete, Maur√≠cio Humberto Vancine">
<meta name="description" content="Pr√©-requisitos do cap√≠tulo Pacotes e dados que ser√£o utilizados neste cap√≠tulo. ## Pacotes library(devtools) library(ecodados) library(V.PhyloMaker) library(vegan) library(ggplot2) library(GGally)...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Cap√≠tulo 13 Diversidade Filogen√©tica | An√°lises Ecol√≥gicas no R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://analises-ecologicas.netlify.app/cap13.html">
<meta property="og:image" content="https://analises-ecologicas.netlify.app/img/capa.jpeg">
<meta property="og:description" content="Pr√©-requisitos do cap√≠tulo Pacotes e dados que ser√£o utilizados neste cap√≠tulo. ## Pacotes library(devtools) library(ecodados) library(V.PhyloMaker) library(vegan) library(ggplot2) library(GGally)...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cap√≠tulo 13 Diversidade Filogen√©tica | An√°lises Ecol√≥gicas no R">
<meta name="twitter:description" content="Pr√©-requisitos do cap√≠tulo Pacotes e dados que ser√£o utilizados neste cap√≠tulo. ## Pacotes library(devtools) library(ecodados) library(V.PhyloMaker) library(vegan) library(ggplot2) library(GGally)...">
<meta name="twitter:image" content="https://analises-ecologicas.netlify.app/img/capa.jpeg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-23BB46Y290"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-23BB46Y290');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">An√°lises Ecol√≥gicas no R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Procurar" aria-label="Procurar">
</form>

      <nav aria-label="Sum√°rio"><h2><b>Sum√°rio</b></h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bem-vindos</a></li>
<li><a class="" href="pref%C3%A1cio.html">Pref√°cio</a></li>
<li><a class="" href="dedicat%C3%B3ria.html">Dedicat√≥ria</a></li>
<li><a class="" href="sobre-os-autores.html">Sobre os autores</a></li>
<li><a class="" href="revisores-e-colaboradores.html">Revisores e colaboradores</a></li>
<li><a class="" href="cap1.html"><span class="header-section-number">1</span> Introdu√ß√£o</a></li>
<li><a class="" href="cap2.html"><span class="header-section-number">2</span> Voltando ao b√°sico: como dominar a arte de fazer perguntas cientificamente relevantes</a></li>
<li><a class="" href="cap3.html"><span class="header-section-number">3</span> Pr√©-requisitos</a></li>
<li><a class="" href="cap4.html"><span class="header-section-number">4</span> Introdu√ß√£o ao R</a></li>
<li><a class="" href="cap5.html"><span class="header-section-number">5</span> Tidyverse</a></li>
<li><a class="" href="cap6.html"><span class="header-section-number">6</span> Visualiza√ß√£o de dados</a></li>
<li><a class="" href="cap7.html"><span class="header-section-number">7</span> Modelos lineares</a></li>
<li><a class="" href="cap8.html"><span class="header-section-number">8</span> Modelos Lineares Generalizados</a></li>
<li><a class="" href="cap9.html"><span class="header-section-number">9</span> An√°lises Multidimensionais</a></li>
<li><a class="" href="cap10.html"><span class="header-section-number">10</span> Rarefa√ß√£o</a></li>
<li><a class="" href="cap11.html"><span class="header-section-number">11</span> Estimadores de riqueza</a></li>
<li><a class="" href="cap12.html"><span class="header-section-number">12</span> Diversidade Taxon√¥mica</a></li>
<li><a class="active" href="cap13.html"><span class="header-section-number">13</span> Diversidade Filogen√©tica</a></li>
<li><a class="" href="cap14.html"><span class="header-section-number">14</span> Diversidade Funcional</a></li>
<li><a class="" href="cap15.html"><span class="header-section-number">15</span> Dados geoespaciais</a></li>
<li><a class="" href="gloss%C3%A1rio.html">Gloss√°rio</a></li>
<li><a class="" href="refer%C3%AAncias.html">Refer√™ncias</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/paternogbc/livro_aer">Ver c√≥digo fonte <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cap13" class="section level1" number="13">
<h1>
<span class="header-section-number">Cap√≠tulo 13</span> Diversidade Filogen√©tica<a class="anchor" aria-label="anchor" href="#cap13"><i class="fas fa-link"></i></a>
</h1>
<div id="pr√©-requisitos-do-cap√≠tulo-9" class="section level2 unnumbered">
<h2>Pr√©-requisitos do cap√≠tulo<a class="anchor" aria-label="anchor" href="#pr%C3%A9-requisitos-do-cap%C3%ADtulo-9"><i class="fas fa-link"></i></a>
</h2>
<p>Pacotes e dados que ser√£o utilizados neste cap√≠tulo.</p>
<div class="sourceCode" id="cb486"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Pacotes</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/">devtools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ecodados</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">V.PhyloMaker</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan">vegan</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">picante</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/liamrevell/phytools">phytools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">geiger</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/darunabas/phyloregion">phyloregion</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pez</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">betapart</span><span class="op">)</span>

<span class="co">## Dados</span>
<span class="va">minha_arvore</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/filogenia_aves.html">filogenia_aves</a></span>
<span class="va">especies_plantas</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/sp_list.html">sp_list</a></span>
<span class="va">comunidade</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/comm.html">comm</a></span>
<span class="va">composicao_especies</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/composicao_aves_filogenetica.html">composicao_aves_filogenetica</a></span>
<span class="va">filogenia_aves</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ecodados/man/filogenia_aves.html">filogenia_aves</a></span>
<span class="va">precipitacao</span> <span class="op">&lt;-</span> <span class="va">precipitacao_filogenetica</span></code></pre></div>
</div>
<div id="aspectos-te√≥ricos-4" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> Aspectos te√≥ricos<a class="anchor" aria-label="anchor" href="#aspectos-te%C3%B3ricos-4"><i class="fas fa-link"></i></a>
</h2>
<p>A diversidade filogen√©tica captura a ancestralidade compartilhada entre as esp√©cies em termos de quantidade da hist√≥ria evolutiva e o grau de parentesco entre as esp√©cies. Pesquisadores t√™m utilizado diferentes m√©tricas de diversidade filogen√©tica em duas linhas de investiga√ß√µes principais: i) incorporar a hist√≥ria evolutiva das esp√©cies na sele√ß√£o das √°reas priorit√°rias para conserva√ß√£o visando minimizar a perda da diversidade evolutiva <span class="citation">(<a href="refer%C3%AAncias.html#ref-vane-wright1991" role="doc-biblioref">Vane-Wright, Humphries, and Williams 1991</a>; <a href="refer%C3%AAncias.html#ref-faith1992" role="doc-biblioref">Faith 1992</a>; <a href="refer%C3%AAncias.html#ref-v%C3%A9ron2019" role="doc-biblioref">V√©ron et al. 2019</a>)</span>, e ii) produzir explica√ß√µes sobre os processos atuando na montagem das comunidades <span class="citation">(<a href="refer%C3%AAncias.html#ref-webb2002" role="doc-biblioref">Webb et al. 2002</a>; <a href="refer%C3%AAncias.html#ref-helmus2007" role="doc-biblioref">Helmus et al. 2007</a>)</span>. A quantidade de artigos abordando ecologia, macroecologia e conserva√ß√£o com diversidade filogen√©tica cresceram exponencialmente nas √∫ltimas d√©cadas <span class="citation">(<a href="refer%C3%AAncias.html#ref-v%C3%A9ron2019" role="doc-biblioref">V√©ron et al. 2019</a>)</span>. Seguindo esta tend√™ncia, o n√∫mero de m√©tricas de diversidade filogen√©tica propostas n√£o param de aumentar. Tucker et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-tucker2016" role="doc-biblioref">2017</a>)</span> revisaram 70 m√©tricas de diversidade filogen√©tica e classificaram estas m√©tricas em tr√™s dimens√µes: i) <strong>riqueza</strong> - representa a soma da diferen√ßa filogen√©tica acumulada entre t√°xons, ii) <strong>diverg√™ncia</strong> - representa o padr√£o de diferen√ßa filogen√©tica entre t√°xons de uma assembleia, e iii) <strong>regularidade</strong> - representa o grau de varia√ß√£o das diferen√ßas filogen√©ticas entre t√°xons em uma assembleia. Outros autores utilizaram diferentes classifica√ß√µes <span class="citation">(<a href="refer%C3%AAncias.html#ref-pavoine2010" role="doc-biblioref">Pavoine and Bonsall 2011</a>; <a href="refer%C3%AAncias.html#ref-vellend2011" role="doc-biblioref">Vellend et al. 2011</a>; <a href="refer%C3%AAncias.html#ref-garamszegi2014" role="doc-biblioref">Garamszegi 2014</a>)</span>. Neste cap√≠tulo, iremos seguir a classifica√ß√£o de Tucker et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-tucker2016" role="doc-biblioref">2017</a>)</span> e mostrar algumas das principais m√©tricas dentro de cada uma dessas dimens√µes.</p>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
Alguns autores recomendam que os pesquisadores n√£o foquem em apenas uma dimens√£o, mas comparem m√©tricas de diferentes dimens√µes <span class="citation">(<a href="refer%C3%AAncias.html#ref-tucker2016" role="doc-biblioref">Tucker et al. 2017</a>)</span>.</p>
</div>
</div>
<div id="manipula√ß√£o-de-filogenias" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> Manipula√ß√£o de filogenias<a class="anchor" aria-label="anchor" href="#manipula%C3%A7%C3%A3o-de-filogenias"><i class="fas fa-link"></i></a>
</h2>
<p>Nesta se√ß√£o, iremos descrever os c√≥digos em R para carregar, plotar, acessar os dados, e excluir e adicionar esp√©cies em filogenias. Estes s√£o c√≥digos introdut√≥rios e necess√°rios para realizarmos as an√°lises de diversidade filogen√©tica. N√£o iremos descrever os comandos necess√°rios para construir uma filogenia. Estamos assumindo que j√° existe uma filogenia dispon√≠vel para os organismos de interesse.</p>
<p>Mas antes, vamos entender as principais terminologias de uma filogenia e analis√°-las graficamente (Figura <a href="cap13.html#fig:fig-filo">13.1</a>).</p>
<div class="alert alert-info">
<ul>
<li><p><strong>√Årvore filogen√©tica</strong>: s√£o hip√≥teses que representam a rela√ß√£o de parentesco entre as esp√©cies (pode ser tamb√©m indiv√≠duos, genes, etc.) com informa√ß√µes sobre quais esp√©cies compartilham um ancestral comum e a dist√¢ncia (tempo, gen√©tica, ou diferen√ßas nos caracteres) que as separam</p></li>
<li><p><strong>N√≥</strong>: o ponto onde uma linhagem d√° origem a duas ou mais linhagens descendentes</p></li>
<li><p><strong>Politomia</strong>: tr√™s ou mais linhagens descendendo de um √∫nico n√≥</p></li>
<li><p><strong>Ramo</strong>: uma linha orientada ao longo de um eixo terminais-raiz que conecta os n√≥s na filogenia</p></li>
<li><p><strong>Terminal (do ingl√™s <em>tip</em>)</strong>: o final do ramo representando uma esp√©cie atual ou extinta (pode tamb√©m representar g√™neros, indiv√≠duos, genes, etc.)</p></li>
<li><p><strong>Raiz</strong>: representa o ancestral comum de todas as esp√©cies na filogenia</p></li>
<li><p><strong>Clado</strong>: um grupo de esp√©cies aparentadas descendendo de um √∫nico n√≥ na filogenia</p></li>
<li><p><strong>Ultram√©trica</strong>: a dist√¢ncia de todos os terminais at√© a raiz s√£o id√™nticas. Caracter√≠stica requerida pela maioria dos √≠ndices de diversidade filogen√©tica</p></li>
</ul>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo"></span>
<img src="img/cap13_fig1.jpg" alt="Ilustra√ß√µes de diferentes √°rvores filogen√©ticas. A) √Årvore enraizada e ultram√©trica indicando a raiz da √°rvore, n√≥s, ramos, comprimento do ramo, politomias e terminais. B) √Årvore n√£o enraizada que mostra as rela√ß√µes entre as esp√©cies, mas n√£o define a hist√≥ria evolutiva. C) √Årvore n√£o ultram√©trica onde as esp√©cies apresentam diferentes dist√¢ncias at√© a raiz." width="100%" height="100%"><p class="caption">
Figura 13.1: Ilustra√ß√µes de diferentes √°rvores filogen√©ticas. A) √Årvore enraizada e ultram√©trica indicando a raiz da √°rvore, n√≥s, ramos, comprimento do ramo, politomias e terminais. B) √Årvore n√£o enraizada que mostra as rela√ß√µes entre as esp√©cies, mas n√£o define a hist√≥ria evolutiva. C) √Årvore n√£o ultram√©trica onde as esp√©cies apresentam diferentes dist√¢ncias at√© a raiz.
</p>
</div>
<p>Agora vamos plotar a filogenia para visualizar as rela√ß√µes entre as 37 esp√©cies de aves end√™micas da Mata Atl√¢ntica. Essa filogenia foi extra√≠da de Jetz et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-jetz2012" role="doc-biblioref">2012</a>)</span>. Os dados est√£o dispon√≠veis no pacote <em>ecodados</em> (Figura <a href="cap13.html#fig:fig-filo-aves">13.2</a>).</p>
<div class="sourceCode" id="cb487"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html">plot.phylo</a></span> <span class="op">(</span><span class="va">minha_arvore</span>, type <span class="op">=</span> <span class="st">"phylogram"</span>, show.tip.label <span class="op">=</span> <span class="cn">TRUE</span>, 
            show.node.label <span class="op">=</span> <span class="cn">TRUE</span>, edge.color <span class="op">=</span> <span class="st">"black"</span>, edge.width <span class="op">=</span> <span class="fl">1.5</span>, 
            tip.color <span class="op">=</span> <span class="st">"black"</span>, cex <span class="op">=</span> <span class="fl">0.45</span>, label.offset <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-aves"></span>
<img src="livro_files/figure-html/fig-filo-aves-1.png" alt="Filogenia de 37 esp√©cies de aves end√™micas da Mata Atl√¢ntica." width="100%" height="100%"><p class="caption">
Figura 13.2: Filogenia de 37 esp√©cies de aves end√™micas da Mata Atl√¢ntica.
</p>
</div>
<p>Podemos alterar o formato de apresenta√ß√£o da filogenia usando o argumento <code>type</code> e a cor dos ramos usando o argumento <code>edge.color</code> (Figura <a href="cap13.html#fig:fig-filo-aves-col">13.3</a>).</p>
<div class="sourceCode" id="cb488"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html">plot.phylo</a></span> <span class="op">(</span><span class="va">minha_arvore</span>, type <span class="op">=</span> <span class="st">"fan"</span>, show.tip.label <span class="op">=</span> <span class="cn">TRUE</span>, 
            show.node.label <span class="op">=</span> <span class="cn">TRUE</span>, edge.color <span class="op">=</span> <span class="st">"blue"</span>, edge.width <span class="op">=</span> <span class="fl">1.5</span>, 
            tip.color <span class="op">=</span> <span class="st">"black"</span>, cex <span class="op">=</span> <span class="fl">0.45</span>, label.offset <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-aves-col"></span>
<img src="livro_files/figure-html/fig-filo-aves-col-1.png" alt="Filogenia de 37 esp√©cies de aves end√™micas da Mata Atl√¢ntica, com altera√ß√µes de parametros de visualiza√ß√£o." width="100%" height="100%"><p class="caption">
Figura 13.3: Filogenia de 37 esp√©cies de aves end√™micas da Mata Atl√¢ntica, com altera√ß√µes de parametros de visualiza√ß√£o.
</p>
</div>
<p>Percebam que existem v√°rios argumentos para modificar a largura e cor dos ramos, tamanho da fonte, dist√¢ncia entre a filogenia e os nomes das esp√©cies e muito mais. Uma sugest√£o √© visitar o blog do professor Liam Revell (<a href="http://blog.phytools.org/" class="uri">http://blog.phytools.org/</a>) que √© o criador e mantenedor do pacote <code>phytools</code> no R.</p>
<p><strong>Acessar informa√ß√µes da filogenia</strong></p>
<p>Uma das caracter√≠sticas mais interessantes do R √© que podemos acessar as informa√ß√µes do objeto que cont√©m a filogenia. Neste caso, o nosso objeto √© a filogenia e, muitas vezes, temos interesse nas informa√ß√µes que est√£o inseridas dentro da filogenia. Para sabermos quais s√£o as informa√ß√µes que podemos acessar na filogenia, vamos usar a fun√ß√£o <code><a href="https://rdrr.io/r/base/names.html">names()</a></code>.</p>
<div class="sourceCode" id="cb489"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Nomes</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">minha_arvore</span><span class="op">)</span>
<span class="co">#&gt; [1] "edge"        "edge.length" "Nnode"       "tip.label"</span></code></pre></div>
<p>Temos acesso a quatro componentes da filogenia: i) ramo (<code>edge</code>), ii) comprimento do ramo (<code>edge.length</code>), iii) n√∫mero de n√≥s (<code>Nnode</code>), e iv) nome das esp√©cies (<code>tip.label</code>). Podemos usar o operador <code>$</code> para acessar estes componentes. Veja abaixo como acessar o nome das 37 esp√©cies de aves na filogenia ou o comprimento de cada um dos ramos da filogenia.</p>
<div class="sourceCode" id="cb490"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Nome das esp√©cies</span>
<span class="va">minha_arvore</span><span class="op">$</span><span class="va">tip.label</span>
<span class="co">#&gt;  [1] "Cranioleuca_pallida"          "Synallaxis_ruficapilla"       "Phacellodomus_ferrugineigula" "Cinclodes_pabsti"            </span>
<span class="co">#&gt;  [5] "Conopophaga_melanops"         "Herpsilochmus_pileatus"       "Pyriglena_leucoptera"         "Formicivora_serrana"         </span>
<span class="co">#&gt;  [9] "Chiroxiphia_caudata"          "Neopelma_aurifrons"           "Carpornis_cucullata"          "Mionectes_rufiventris"       </span>
<span class="co">#&gt; [13] "Phylloscartes_kronei"         "Dacnis_nigripes"              "Ramphocelus_bresilius"        "Sporophila_frontalis"        </span>
<span class="co">#&gt; [17] "Tangara_seledon"              "Euphonia_pectoralis"          "Cyanocorax_caeruleus"         "Brotogeris_tirica"           </span>
<span class="co">#&gt; [21] "Pionopsitta_pileata"          "Pyrrhura_frontalis"           "Ramphastos_dicolorus"         "Pteroglossus_bailloni"       </span>
<span class="co">#&gt; [25] "Veniliornis_maculifrons"      "Melanerpes_flavifrons"        "Malacoptila_striata"          "Strix_hylophila"             </span>
<span class="co">#&gt; [29] "Pulsatrix_koeniswaldiana"     "Megascops_sanctaecatarinae"   "Leucopternis_polionotus"      "Buteogallus_lacernulatus"    </span>
<span class="co">#&gt; [33] "Thalurania_glaucopis"         "Stephanoxis_lalandi"          "Aramides_saracura"            "Ortalis_guttata"             </span>
<span class="co">#&gt; [37] "Tinamus_solitarius"</span>

<span class="co">## Comprimento dos ramos</span>
<span class="va">minha_arvore</span><span class="op">$</span><span class="va">edge.length</span>
<span class="co">#&gt;  [1]   8.3802647  18.8669712   1.7333865   3.6642170  10.6732942  15.2239228  11.0917270   1.7755983  28.3607791   2.9678911</span>
<span class="co">#&gt; [11]   1.7546545   8.0910030   8.0910030   9.8456576  12.8135486  41.1743278  25.4606915   0.5546030  16.9346316  16.9346316</span>
<span class="co">#&gt; [21]  17.4892346  18.4363079   4.6581580  13.5498048  17.3960309  17.3960309  30.9471871  12.4567724  23.1472214  23.1472214</span>
<span class="co">#&gt; [31]  17.4065182  24.1723764  12.4712971   2.4600303  12.6082491  12.5529673  12.6146793  15.2153841  27.6866812  51.8590576</span>
<span class="co">#&gt; [41]  50.4721698   1.0975337  28.3691666  28.3691666  29.4667004   0.4805624   1.9967144   2.7687118  17.0272986  23.4955884</span>
<span class="co">#&gt; [51]  20.5338341  17.3003772  17.3003772  22.2636579  15.5705534  15.5705534  61.3297997  50.6621138   5.3479249  22.3470597</span>
<span class="co">#&gt; [61]  22.3470597  27.6949846  66.5513507  14.5744595  14.5744595  67.7448719  15.3776527  15.3776527  85.3364736 104.2034448</span>
<span class="co">#&gt; [71] 112.5837095</span></code></pre></div>
<p><strong>Remover esp√©cies da filogenia</strong></p>
<p>Nas an√°lises de diversidade filogen√©tica, as esp√©cies que estar√£o presentes na filogenia normalmente s√£o aquelas que foram amostradas no seu estudo. Contudo, muitas vezes utilizamos filogenias contendo esp√©cies que n√£o est√£o presentes no nosso estudo. Neste caso, precisamos excluir essas esp√©cies da filogenia. A fun√ß√£o <code><a href="https://rdrr.io/pkg/ape/man/drop.tip.html">drop.tip()</a></code> faz essa tarefa.</p>
<div class="sourceCode" id="cb491"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Remover esp√©cies da filogenia</span>
<span class="co"># Vamos criar um novo nome para o objeto e excluir as esp√©cies Leucopternis polionotus e Aramides saracura da filogenia</span>
<span class="va">filogenia_cortada</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/drop.tip.html">drop.tip</a></span><span class="op">(</span><span class="va">minha_arvore</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Leucopternis_polionotus"</span>, <span class="st">"Aramides_saracura"</span><span class="op">)</span><span class="op">)</span>
<span class="va">filogenia_cortada</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Phylogenetic tree with 35 tips and 33 internal nodes.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Tip labels:</span>
<span class="co">#&gt;   Cranioleuca_pallida, Synallaxis_ruficapilla, Phacellodomus_ferrugineigula, Cinclodes_pabsti, Conopophaga_melanops, Herpsilochmus_pileatus, ...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Rooted; includes branch lengths.</span></code></pre></div>
<p>Vejam que agora a filogenia tem 35 esp√©cies de aves. As duas esp√©cies que selecionamos foram exclu√≠das da filogenia.</p>
<p><strong>Adicionar esp√©cies na filogenia</strong></p>
<p>Outra situa√ß√£o bem comum √© quando precisamos inserir esp√©cies que foram amostradas no nosso estudo, mas n√£o est√£o presente na filogenia. Para isso, vamos usar a fun√ß√£o <code><a href="https://rdrr.io/pkg/phytools/man/add.species.to.genus.html">add.species.to.genus()</a></code>. A fun√ß√£o <code><a href="https://rdrr.io/pkg/phytools/man/force.ultrametric.html">force.ultrametric()</a></code> √© usada para que a filogenia continue sendo ultram√©trica (sem essa fun√ß√£o a √°rvore perde os comprimentos dos ramos)</p>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
O comprimento do ramo que a esp√©cie ir√° receber depender√° de onde voc√™ indicar a inser√ß√£o da esp√©cie.</p>
<p>As op√ß√µes s√£o:
- <code>root</code>: insere a esp√©cie no ancestral comum mais recente (MRCA) de todas as esp√©cies do g√™nero (<em>default</em>)
- <code>random</code>: insere a esp√©cie aleatoriamente dentro do clado do MRCA contendo todos as esp√©cies do g√™nero</p>
</div>
<div class="sourceCode" id="cb492"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Adicionar esp√©cies √† filogenia</span>
<span class="co"># Vamos inserir as esp√©cies Megascops_sp1, Carponis_sp, Strix_sp1, Strix_sp2 e</span>
<span class="co"># Strix_sp3 na filogenia</span>
<span class="va">Megascops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Megascops_sp1"</span><span class="op">)</span>
<span class="va">Carpornis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Carpornis_sp1"</span><span class="op">)</span>
<span class="va">Strix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Strix_sp1"</span>, <span class="st">"Strix_sp2"</span>, <span class="st">"Strix_sp3"</span><span class="op">)</span>

<span class="co"># Inserindo esp√©cies como politomias</span>
<span class="va">filogenia_nova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phytools/man/add.species.to.genus.html">add.species.to.genus</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phytools/man/force.ultrametric.html">force.ultrametric</a></span><span class="op">(</span><span class="va">minha_arvore</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="va">Megascops</span><span class="op">)</span>
<span class="va">filogenia_nova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phytools/man/add.species.to.genus.html">add.species.to.genus</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phytools/man/force.ultrametric.html">force.ultrametric</a></span><span class="op">(</span><span class="va">filogenia_nova</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="va">Carpornis</span><span class="op">)</span></code></pre></div>
<p>Agora vamos inserir v√°rias esp√©cies dentro do mesmo g√™nero.</p>
<div class="sourceCode" id="cb493"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Adicionar v√°rias esp√©cies √† filogenia</span>
<span class="co"># Para inserir mais de uma esp√©cie dentro do g√™nero, vamos utilizar um loop.  </span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Strix</span><span class="op">)</span><span class="op">)</span> 
    <span class="va">filogenia_nova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phytools/man/add.species.to.genus.html">add.species.to.genus</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phytools/man/force.ultrametric.html">force.ultrametric</a></span><span class="op">(</span><span class="va">filogenia_nova</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
                                           <span class="va">Strix</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, where <span class="op">=</span> <span class="st">"root"</span><span class="op">)</span></code></pre></div>
<p>Vamos plotar essa nova filogenia (Figura <a href="cap13.html#fig:fig-filo-aves-add">13.4</a>).</p>
<div class="sourceCode" id="cb494"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">filogenia_nova</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, no.margin <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-aves-add"></span>
<img src="livro_files/figure-html/fig-filo-aves-add-1.png" alt="Filogenia de esp√©cies de aves end√™micas da Mata Atl√¢ntica, com adi√ß√£o de esp√©cies." width="100%" height="100%"><p class="caption">
Figura 13.4: Filogenia de esp√©cies de aves end√™micas da Mata Atl√¢ntica, com adi√ß√£o de esp√©cies.
</p>
</div>
<p>Vamos fazer outro exemplo usando a fun√ß√£o <code><a href="https://rdrr.io/pkg/V.PhyloMaker/man/phylo.maker.html">phylo.maker()</a></code> do pacote <code>V.PhyloMaker</code> que adiciona as esp√©cies nos g√™neros ou os g√™neros nas fam√≠lias usando uma filog√™nia <em>backbone</em>.</p>
<p>Essa fun√ß√£o permite a adi√ß√£o dos g√™neros ou esp√©cies considerando tr√™s cen√°rios diferentes:</p>
<ul>
<li>
<strong>Cen√°rio 1</strong>: adiciona g√™neros ou esp√©cies como politomias basais dentro das fam√≠lias ou g√™neros da filogenia respectivamente</li>
<li>
<strong>Cen√°rio 2</strong>: adiciona g√™neros e esp√©cies aleatoriamente nas fam√≠lias ou g√™neros da filogenia respectivamente</li>
<li>
<strong>Cen√°rio 3</strong>: adiciona g√™neros e esp√©cies nas fam√≠lias ou g√™neros da filogenia respectivamente usando as abordagens implementadas no <em>Phylomatic</em> e <em>BLADJ</em>
</li>
</ul>
<div class="sourceCode" id="cb495"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## phylo.maker</span>
<span class="co"># A fun√ß√£o phylo.maker usa uma filogenia default de plantas (i.e. GBOTB.extended).</span>
<span class="co"># Caso voc√™ queira utilizar outra filogenia, √© s√≥ alterar o argumento tree</span>
<span class="va">novas_filogenias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/V.PhyloMaker/man/phylo.maker.html">phylo.maker</a></span><span class="op">(</span><span class="va">especies_plantas</span>,
                                tree <span class="op">=</span> <span class="va">GBOTB.extended</span>,
                                scenarios <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S1"</span>,<span class="st">"S2"</span>,<span class="st">"S3"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "Note: 2 taxa fail to be binded to the tree,"</span>
<span class="co">#&gt; [1] "Genus7_sp1" "Genus8_sp1"</span></code></pre></div>
<p>Vamos essa filogenia criada pelo pacote <code>V.PhyloMaker</code> (Figura <a href="cap13.html#fig:fig-filo-phylomaker">13.5</a>).</p>
<div class="sourceCode" id="cb496"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html">plot.phylo</a></span><span class="op">(</span><span class="va">novas_filogenias</span><span class="op">$</span><span class="va">scenario.1</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, main <span class="op">=</span> <span class="st">"Cen√°rio 1"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html">plot.phylo</a></span><span class="op">(</span><span class="va">novas_filogenias</span><span class="op">$</span><span class="va">scenario.3</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, main <span class="op">=</span> <span class="st">"Cen√°rio 3"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; null device </span>
<span class="co">#&gt;           1</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-phylomaker"></span>
<img src="livro_files/figure-html/fig-filo-phylomaker-1.png" alt="Filogenia de esp√©cies de plantas criada pelo pacote `V.PhyloMaker`." width="100%" height="100%"><p class="caption">
Figura 13.5: Filogenia de esp√©cies de plantas criada pelo pacote <code>V.PhyloMaker</code>.
</p>
</div>
</div>
<div id="m√©tricas-de-diversidade-alfa-filogen√©tica" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> M√©tricas de diversidade alfa filogen√©tica<a class="anchor" aria-label="anchor" href="#m%C3%A9tricas-de-diversidade-alfa-filogen%C3%A9tica"><i class="fas fa-link"></i></a>
</h2>
<p>M√©tricas de diversidade alfa utilizam os dados de incid√™ncia (presen√ßa e aus√™ncia) ou abund√¢ncia das esp√©cies para determinar um valor de diversidade para cada comunidade ou s√≠tio de interesse.</p>
<p><strong>Exemplo pr√°tico 1</strong></p>
<p><strong>Explica√ß√£o dos dados</strong></p>
<p>Avaliaremos a diversidade filogen√©tica de 10 comunidades de aves amostradas ao longo de um gradiente de precipita√ß√£o. Utilizaremos este conjunto de dados para todos os exemplos deste cap√≠tulo.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>A varia√ß√£o na distribui√ß√£o espacial dos valores de diversidade filogen√©tica das comunidades est√° associada com o gradiente de precipita√ß√£o?</li>
</ul>
<p><strong>Predi√ß√µes</strong></p>
<ul>
<li>Os valores de diversidade filogen√©tica ser√£o maiores nas comunidades localizadas em regi√µes com altas precipita√ß√µes do que em regi√µes mais secas</li>
</ul>
<p><strong>Vari√°veis</strong></p>
<ul>
<li><p>Data frame com as comunidades (unidade amostral) nas linhas e as esp√©cies de aves nas colunas (vari√°vel resposta)</p></li>
<li><p>Data frame com as comunidades (unidade amostral) nas linhas e a vari√°vel precipita√ß√£o anual na coluna (vari√°vel preditora)</p></li>
<li><p>Arquivo com a filogenia das 37 esp√©cies de aves (vari√°vel resposta)</p></li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Verificar se os data frames de composi√ß√£o de esp√©cies e vari√°veis ambientais est√£o com as unidades amostrais nas linhas e vari√°veis preditoras nas colunas</p></li>
<li><p>Verificar se as comunidades nos data frames de composi√ß√£o de esp√©cies e vari√°veis ambientais est√£o distribu√≠dos na mesma sequ√™ncia/ordem nos dois arquivos.</p></li>
<li><p>Verificar se o nome das esp√©cies de aves no data frame de composi√ß√£o de esp√©cies √© id√™ntico ao nome das esp√©cies na filogenia.</p></li>
</ul>
<div id="riqueza-da-diversidade-alfa-filogen√©tica" class="section level3" number="13.3.1">
<h3>
<span class="header-section-number">13.3.1</span> Riqueza da diversidade alfa filogen√©tica<a class="anchor" aria-label="anchor" href="#riqueza-da-diversidade-alfa-filogen%C3%A9tica"><i class="fas fa-link"></i></a>
</h3>
<p>As m√©tricas de riqueza somam a quantidade da diferen√ßa filogen√©tica presente em uma comunidade <span class="citation">(<a href="refer%C3%AAncias.html#ref-tucker2016" role="doc-biblioref">Tucker et al. 2017</a>)</span>.</p>
<p><strong>Phylogenetic diversity (PD)</strong></p>
<p>Esta m√©trica √© definida pela soma do comprimento dos ramos conectando todas as esp√©cies na comunidade. √â a m√©trica mais conhecida e usada nos estudos de conserva√ß√£o e comunidade <span class="citation">(<a href="refer%C3%AAncias.html#ref-faith1992" role="doc-biblioref">Faith 1992</a>)</span>.</p>
<p>Vamos conferir se os nomes das esp√©cies de aves no data frame de composi√ß√£o s√£o os mesmos da filogenia. O resultado <code>OK</code> indica que os nomes est√£o corretos. Caso contr√°rio, voc√™ deve verificar e arrumar.</p>
<div class="sourceCode" id="cb497"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Conferir os nomes das esp√©cies</span>
<span class="fu"><a href="https://rdrr.io/pkg/geiger/man/name.check.html">name.check</a></span><span class="op">(</span><span class="va">filogenia_aves</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">composicao_especies</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "OK"</span></code></pre></div>
<p>Agora vamos colocar os nomes das esp√©cies do data frame na mesma ordem que os nomes aparecem na filogenia. Isso √© obrigat√≥rio para algumas fun√ß√µes.</p>
<div class="sourceCode" id="cb498"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Colocar os nomes das esp√©cies do data frame na mesma ordem que aparecem na filogenia</span>
<span class="va">composicao_especies_P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/data.checking.html">match.phylo.comm</a></span><span class="op">(</span>phy <span class="op">=</span> <span class="va">filogenia_aves</span>, comm <span class="op">=</span> <span class="va">composicao_especies</span><span class="op">)</span><span class="op">$</span><span class="va">comm</span></code></pre></div>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo de PD para as comunidades de aves.</p>
<div class="sourceCode" id="cb499"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Phylogenetic diversity (PD)</span>
<span class="co"># Calculando a m√©trica de diversidade filogen√©tica proposta por Faith (1992).</span>
<span class="va">resultados_PD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/pd.html">pd</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, <span class="va">filogenia_aves</span><span class="op">)</span>

<span class="co"># Mostra o valor de PD e riqueza de esp√©cies para cada comunidade.</span>
<span class="va">resultados_PD</span>
<span class="co">#&gt;               PD SR</span>
<span class="co">#&gt; Com_1  1259.3151 27</span>
<span class="co">#&gt; Com_2  1293.1521 26</span>
<span class="co">#&gt; Com_3  1222.3102 25</span>
<span class="co">#&gt; Com_4  1254.5410 25</span>
<span class="co">#&gt; Com_5  1021.9670 22</span>
<span class="co">#&gt; Com_6   856.7810 18</span>
<span class="co">#&gt; Com_7   930.6452 15</span>
<span class="co">#&gt; Com_8   678.9394 12</span>
<span class="co">#&gt; Com_9   673.6288 13</span>
<span class="co">#&gt; Com_10  599.6924  9</span></code></pre></div>
<p>A comunidade 2 abriga a maior diversidade filogen√©tica com a composi√ß√£o de esp√©cies contemplando <code>1293,15</code> milh√µes de anos (i.e.¬†soma do comprimento dos ramos ligando todas as esp√©cies da comunidade). Por outro lado, a comunidade 10 abriga a menor diversidade filogen√©tica contemplando <code>599,69</code> milh√µes de anos.</p>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
Este √≠ndice √© correlacionado com a riqueza de esp√©cies. Discutiremos essa quest√£o na se√ß√£o de modelos nulos.</p>
</div>
<p><strong>Phylogenetic Species Richness (PSR)</strong></p>
<p>Esta m√©trica √© calculada multiplicando a riqueza de esp√©cies registrada na comunidade pela <em>Phylogenetic Species Variability</em> (PSV) da comunidade <span class="citation">(<a href="refer%C3%AAncias.html#ref-helmus2007" role="doc-biblioref">Helmus et al. 2007</a>)</span>. PSR √© diretamente compar√°vel ao n√∫mero de esp√©cies na comunidade, mas inclui o parentesco filogen√©tico entre as esp√©cies.</p>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo do PSR utilizando os dados das comunidades de aves.</p>
<div class="sourceCode" id="cb500"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Phylogenetic Species Richness (PSR)</span>
<span class="co"># An√°lise com dados de composi√ß√£o das esp√©cies nas comunidades.</span>
<span class="va">resultados_PSR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/psd.html">psr</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>,<span class="va">filogenia_aves</span><span class="op">)</span>

<span class="co"># Mostra os valores de PSR para cada comunidade.</span>
<span class="va">resultados_PSR</span> 
<span class="co">#&gt;              PSR SR       vars</span>
<span class="co">#&gt; Com_1  18.084236 27 0.04537904</span>
<span class="co">#&gt; Com_2  18.167183 26 0.04881734</span>
<span class="co">#&gt; Com_3  16.230938 25 0.05205832</span>
<span class="co">#&gt; Com_4  17.153972 25 0.05205832</span>
<span class="co">#&gt; Com_5  13.981597 22 0.06060866</span>
<span class="co">#&gt; Com_6  11.287030 18 0.06933707</span>
<span class="co">#&gt; Com_7  10.279983 15 0.07398666</span>
<span class="co">#&gt; Com_8   7.538134 12 0.07721118</span>
<span class="co">#&gt; Com_9   8.060933 13 0.07627517</span>
<span class="co">#&gt; Com_10  5.720063  9 0.07948474</span></code></pre></div>
<p>A comunidade 2 abriga o maior valor de PSR enquanto a comunidade 10 abriga o menor valor. Vejam que PSR √© fortemente correlacionado com n√∫mero de esp√©cies nas comunidades (r = 0.99, p &lt;0.0001). Contudo, existe uma variabilidade residual no PSR em rela√ß√£o ao n√∫mero de esp√©cies que afeta o ranqueamento das comunidades quando utilizando PSR ou n√∫mero de esp√©cies. Consequentemente, a escolha da m√©trica pode gerar diferentes delineamentos de √°reas priorit√°rias para conserva√ß√£o <span class="citation">(<a href="refer%C3%AAncias.html#ref-helmus2007" role="doc-biblioref">Helmus et al. 2007</a>)</span>.</p>
<p><strong>Phylogenetic Endemism (PE)</strong></p>
<p>Esta m√©trica calcula a fra√ß√£o dos ramos restritas a regi√µes espec√≠ficas. PE identifica √°reas ou comunidades que abrigam componentes restritos da diversidade filogen√©tica. PE √© uma m√©trica proposta para auxiliar estudos de conserva√ß√£o estabelecendo crit√©rios para priorizar regi√µes a serem conservadas com base na import√¢ncia evolutiva (i.e.¬†partes da filog√™nia com distribui√ß√£o espacial limitada) das esp√©cies que ocorrem nestes locais <span class="citation">(<a href="refer%C3%AAncias.html#ref-rosauer2009" role="doc-biblioref">Rosauer et al. 2009</a>)</span>.</p>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo do PE utilizando os dados das comunidades de aves.</p>
<div class="sourceCode" id="cb501"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Phylogenetic Endemism (PE)</span>
<span class="co"># Transformando data.frame em matriz.</span>
<span class="va">dados_matriz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">composicao_especies_P</span><span class="op">)</span>

<span class="co"># An√°lise.</span>
<span class="va">resultados_PE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloregion/man/phylo_endemism.html">phylo_endemism</a></span><span class="op">(</span><span class="va">dados_matriz</span>, <span class="va">filogenia_aves</span>, 
                                weighted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Mostra os valores de PE para cada comunidade.</span>
<span class="va">resultados_PE</span> 
<span class="co">#&gt;     Com_1     Com_2     Com_3     Com_4     Com_5     Com_6     Com_7     Com_8     Com_9    Com_10 </span>
<span class="co">#&gt; 232.09145 272.60106 210.22647 218.89037 146.99281 135.06423 148.65234  79.22402  77.95458  68.50266</span></code></pre></div>
<p>O √≠ndice PE considera as 10 comunidades como o range espacial m√°ximo. Se todas as esp√©cies ocorressem nas 10 comunidades, o valor de PE seria 1, indicando baixo endemismo filogen√©tico. A comunidade 2 abriga um conjunto de esp√©cies cujo os ramos com distribui√ß√£o espacial restrita contemplam <code>272,6</code> milh√µes de anos. Por outro lado, a comunidade 10 abriga um conjunto de esp√©cies cujo os ramos com distribui√ß√£o espacial restrita contemplam <code>68,5</code> milh√µes de anos. Assim, as comunidades 1, 2 e 4 s√£o as √°reas que abrigam os maiores endemismo filogen√©ticos.</p>
<p><strong>Species Evolutionary Distinctiveness (ED)</strong></p>
<p>Esta m√©trica calcula qual √© a fra√ß√£o da √°rvore filogen√©tica que √© atribu√≠da para uma esp√©cie. ED reflete qu√£o evolutivamente isolada uma esp√©cie √© comparada com as outras esp√©cies na filogenia <span class="citation">(<a href="refer%C3%AAncias.html#ref-redding2006" role="doc-biblioref">Redding and Mooers 2006</a>)</span>. ED √© uma m√©trica proposta para auxiliar estudos de conserva√ß√£o estabelecendo crit√©rios para priorizar as esp√©cies a serem conservadas com base na sua import√¢ncia evolutiva (exclusividade do comprimento do ramo) que n√£o √© compartilhada com outras esp√©cies. Portanto, apenas as informa√ß√µes da filogenia s√£o utilizadas para o c√°lculo de ED.</p>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo do ED utilizando os dados das comunidades de aves.</p>
<div class="sourceCode" id="cb502"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Species Evolutionary Distinctiveness (ED)</span>
<span class="co"># An√°lise.</span>
<span class="va">resultados_ED</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/evol.distinct.html">evol.distinct</a></span><span class="op">(</span><span class="va">filogenia_aves</span><span class="op">)</span>

<span class="co"># Mostra os valores de ED para cada esp√©cie.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">resultados_ED</span><span class="op">)</span>
<span class="co">#&gt;                        Species        w</span>
<span class="co">#&gt; 1          Cranioleuca_pallida 14.07447</span>
<span class="co">#&gt; 2       Synallaxis_ruficapilla 14.07447</span>
<span class="co">#&gt; 3 Phacellodomus_ferrugineigula 20.05793</span>
<span class="co">#&gt; 4             Cinclodes_pabsti 30.27020</span>
<span class="co">#&gt; 5         Conopophaga_melanops 47.72685</span>
<span class="co">#&gt; 6       Herpsilochmus_pileatus 26.40947</span></code></pre></div>
<p>Com base na filogenia estudada, <em>Tinamus solitarius</em> (<code>112,58</code> milh√µes de anos), <em>Ortalis guttata</em> (<code>108,39</code> m.a.) e <em>Aramides saracura</em> (<code>96,86</code> m.a.) s√£o as esp√©cies com maior distin√ß√£o evolutiva devido a elevada fra√ß√£o dos ramos n√£o compartilhado com as outras esp√©cies.</p>
</div>
<div id="diverg√™ncia-da-diversidade-alfa-filogen√©tica" class="section level3" number="13.3.2">
<h3>
<span class="header-section-number">13.3.2</span> Diverg√™ncia da diversidade alfa filogen√©tica<a class="anchor" aria-label="anchor" href="#diverg%C3%AAncia-da-diversidade-alfa-filogen%C3%A9tica"><i class="fas fa-link"></i></a>
</h3>
<p>As m√©tricas de diverg√™ncia utilizam a m√©dia da distribui√ß√£o das unidades extra√≠das da √°rvore filogen√©tica <span class="citation">(<a href="refer%C3%AAncias.html#ref-tucker2016" role="doc-biblioref">Tucker et al. 2017</a>)</span>.</p>
<p><strong>Mean Pairwise Distance (MPD)</strong></p>
<p>Esta m√©trica utiliza a matriz de dist√¢ncia filogen√©tica para quantificar a dist√¢ncia m√©dia do parentesco entre pares de esp√©cies em uma comunidade. Este √≠ndice pode ser calculado considerando dados de incid√™ncia ou considerando dados de abund√¢ncia das esp√©cies. Importante, o MPD √© uma m√©trica que pesa a estrutura interna da filogenia (e.g., rela√ß√µes entre esp√©cies de fam√≠lias diferentes) <span class="citation">(<a href="refer%C3%AAncias.html#ref-webb2002" role="doc-biblioref">Webb et al. 2002</a>)</span>.</p>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo do MPD utilizando os dados das comunidades de aves.</p>
<p>Vamos iniciar com dados de incid√™ncia (presen√ßa e aus√™ncia) das esp√©cies nas comunidades. A fun√ß√£o <code><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic()</a></code> gera uma matriz com as dist√¢ncias par a par entre as esp√©cies. Essas dist√¢ncias s√£o utilizadas para computar a dist√¢ncia m√©dia do parentesco das esp√©cies dentro das comunidades.</p>
<div class="sourceCode" id="cb503"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mean Pairwise Distance (MPD)</span>
<span class="co"># An√°lise com dados de incid√™ncia das esp√©cies nas comunidades.</span>
<span class="va">resultados_MPD_PA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/mpd.html">mpd</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">filogenia_aves</span><span class="op">)</span>, 
                         abundance.weighted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Mostra os valores de MPD para cada comunidade.</span>
<span class="va">resultados_MPD_PA</span> 
<span class="co">#&gt;  [1] 150.7914 157.3158 146.1622 154.5005 143.0727 141.1926 154.3145 141.4292 139.6198 143.0862</span></code></pre></div>
<p>A comunidade 9 abriga a composi√ß√£o de esp√©cies mais aparentada (i.e.¬†menor diversidade filogen√©tica) com dist√¢ncia m√©dia entre as esp√©cies de <code>139,62</code> milh√µes de anos. Por outro lado, a comunidade 2 abriga a composi√ß√£o de esp√©cies menos aparentada (i.e.¬†maior diversidade filogen√©tica) com dist√¢ncia m√©dia de <code>157,31</code> milh√µes anos.</p>
<p>Vamos refazer a an√°lise do MPD, mas desta vez, considerando a abund√¢ncia das esp√©cies de aves nas comunidades. Para isso, alteramos o argumento <code>abundance.weighted = TRUE</code>.</p>
<div class="sourceCode" id="cb504"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mean Pairwise Distance (MPD)</span>
<span class="co"># An√°lise com dados de abund√¢ncia das esp√©cies nas comunidades.</span>
<span class="va">resultados_MPD_AB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/mpd.html">mpd</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">filogenia_aves</span><span class="op">)</span>, 
                         abundance.weighted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Mostra os valores de MPD para cada comunidade.</span>
<span class="va">resultados_MPD_AB</span> 
<span class="co">#&gt;  [1] 135.0704 143.3156 129.1940 142.8127 131.4027 128.7733 134.0380 132.6389 133.4041 117.8787</span></code></pre></div>
<p>Percebam que pesando o comprimento do ramo pela abund√¢ncia das esp√©cies altera-se os valores do √≠ndice de diversidade filogen√©tica. Neste caso, a comunidade 10 passa a ser a comunidade que abriga a composi√ß√£o de esp√©cies mais aparentada (i.e.¬†menor diversidade filogen√©tica) com dist√¢ncia m√©dia entre as esp√©cies de <code>117,88</code> milh√µes de anos.</p>
<p><strong>Mean Nearest Taxon Distance (MNTD)</strong></p>
<p>Esta m√©trica utiliza a matriz de dist√¢ncia filogen√©tica para quantificar a m√©dia dos valores m√≠nimos de parentesco entre pares de esp√©cies em uma comunidade. Ou seja, qual o valor m√©dio da dist√¢ncia para o vizinho mais pr√≥ximo. Este √≠ndice pode ser calculado considerando dados de incid√™ncia (presen√ßa e aus√™ncia) ou considerando dados de abund√¢ncia das esp√©cies. Diferente do MPD, o MNTD √© uma m√©trica terminal que pesa as rela√ß√µes nas pontas da filogenia (e.g.¬†esp√©cies dentro do mesmo g√™nero) <span class="citation">(<a href="refer%C3%AAncias.html#ref-webb2002" role="doc-biblioref">Webb et al. 2002</a>)</span>.</p>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo do MNTD utilizando os dados das comunidades de aves.</p>
<div class="sourceCode" id="cb505"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mean Nearest Taxon Distance (MNTD)</span>
<span class="co"># An√°lise com dados de presen√ßa e aus√™ncia das esp√©cies nas comunidades.</span>
<span class="va">resultados_MNTD_PA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/mntd.html">mntd</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">filogenia_aves</span><span class="op">)</span>, 
                           abundance.weighted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Mostra os valores de MPD para cada comunidade.</span>
<span class="va">resultados_MNTD_PA</span> 
<span class="co">#&gt;  [1]  63.89727  66.15828  72.96912  67.67170  64.93477  63.72337  93.54980  78.24876  62.34565 112.23127</span></code></pre></div>
<p>A comunidade 9 abriga a composi√ß√£o de esp√©cies com dist√¢ncia m√©dia do vizinho mais pr√≥ximo de <code>62,34</code> milh√µes de anos. Esse resultado indica que as esp√©cies terminais s√£o mais aparentadas (e.g.¬†esp√©cies do mesmo g√™nero) do que a composi√ß√£o de esp√©cies da comunidade 10 onde a dist√¢ncia m√©dia do vizinho mais pr√≥ximo √© <code>112,23</code> milh√µes de anos (e.g.¬†esp√©cies de g√™neros diferentes).</p>
<p>Vamos refazer a an√°lise do MNTD, mas desta vez, considerando a abund√¢ncia das esp√©cies de aves nas comunidades.</p>
<div class="sourceCode" id="cb506"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># An√°lise com dados de abund√¢ncia das esp√©cies nas comunidades.</span>
<span class="va">resultados_MNTD_AB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/mntd.html">mntd</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">filogenia_aves</span><span class="op">)</span>, 
                           abundance.weighted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Mostra os valores de MPD para cada comunidade.</span>
<span class="va">resultados_MNTD_AB</span> 
<span class="co">#&gt;  [1]  57.11745  53.02212  70.47864  59.12049  61.23225  60.26180 110.13043  97.35404  82.12099 127.70084</span></code></pre></div>
<p>Como nos resultados do MPD, pesar o comprimento do ramo pela abund√¢ncia das esp√©cies altera os valores do MNTD. Neste caso, ao inv√©s da comunidade 9, a comunidade 2 passa a ser a comunidade que abriga a composi√ß√£o de esp√©cies com a menor dist√¢ncia m√©dia do vizinho mais pr√≥ximo (53,02 milh√µes de anos).</p>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
Perceba que ao determinar as an√°lises com base na incid√™ncia ou abund√¢ncia das esp√©cies, voc√™ pode tamb√©m alterar a interpreta√ß√£o dos padr√µes encontrados.</p>
</div>
<p><strong>Phylogenetic Species Variability (PSV)</strong></p>
<p>Esta m√©trica estima a quantidade relativa dos comprimentos dos ramos n√£o compartilhados entre as comunidades. Quando todas as esp√©cies em uma amostra n√£o s√£o aparentadas (i.e.¬†filogenia em estrela), o valor do PSV √© 1 (um), indicando m√°xima variabilidade. Quando as esp√©cies tornam-se mais aparentadas, o valor de PSV aproxima-se de 0 (zero), indicando reduzida variabilidade. Os valores esperados de PSV s√£o estatisticamente independentes da riqueza de esp√©cies <span class="citation">(<a href="refer%C3%AAncias.html#ref-helmus2007" role="doc-biblioref">Helmus et al. 2007</a>)</span>.</p>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br>
Os valores de PSV s√£o id√™nticos ao MPD quando a filogenia √© ultram√©trica.</p>
</div>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo do PSV utilizando os dados das comunidades de aves.</p>
<div class="sourceCode" id="cb507"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Phylogenetic Species Variability (PSV)</span>
<span class="co"># An√°lise com dados de presen√ßa e aus√™ncia das esp√©cies nas comunidades.</span>
<span class="va">resultados_PSV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/psd.html">psv</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>,<span class="va">filogenia_aves</span><span class="op">)</span>

<span class="co"># Mostra os valores de PSV para cada comunidade.</span>
<span class="va">resultados_PSV</span> 
<span class="co">#&gt;             PSVs SR         vars</span>
<span class="co">#&gt; Com_1  0.6697865 27 6.224834e-05</span>
<span class="co">#&gt; Com_2  0.6987378 26 7.221499e-05</span>
<span class="co">#&gt; Com_3  0.6492375 25 8.329332e-05</span>
<span class="co">#&gt; Com_4  0.6861589 25 8.329332e-05</span>
<span class="co">#&gt; Com_5  0.6355271 22 1.252245e-04</span>
<span class="co">#&gt; Com_6  0.6270572 18 2.140033e-04</span>
<span class="co">#&gt; Com_7  0.6853322 15 3.288296e-04</span>
<span class="co">#&gt; Com_8  0.6281778 12 5.361887e-04</span>
<span class="co">#&gt; Com_9  0.6200717 13 4.513324e-04</span>
<span class="co">#&gt; Com_10 0.6355626  9 9.812931e-04</span></code></pre></div>
<p>A comunidade 2 abriga a maior variabilidade filogen√©tica (<code>0,69</code>) enquanto a comunidade 9 abriga a menor variabilidade (<code>0,62</code>). Perceba que os valores de PSV n√£o s√£o correlacionados com n√∫mero de esp√©cies nas comunidades (r = 0,59, p = 0,07).</p>
</div>
<div id="regularidade-da-diversidade-alfa-filogen√©tica" class="section level3" number="13.3.3">
<h3>
<span class="header-section-number">13.3.3</span> Regularidade da diversidade alfa filogen√©tica<a class="anchor" aria-label="anchor" href="#regularidade-da-diversidade-alfa-filogen%C3%A9tica"><i class="fas fa-link"></i></a>
</h3>
<p>As m√©tricas de regularidade caracterizam a varia√ß√£o das dist√¢ncias entre as esp√©cies em uma comunidade <span class="citation">(<a href="refer%C3%AAncias.html#ref-tucker2016" role="doc-biblioref">Tucker et al. 2017</a>)</span>.</p>
<p><strong>Variance of Pairwise Distance (VPD)</strong></p>
<p>Esta m√©trica utiliza a matriz de dist√¢ncia filogen√©tica para quantificar a vari√¢ncia do parentesco entre pares de esp√©cies em uma comunidade <span class="citation">(<a href="refer%C3%AAncias.html#ref-clarke2001" role="doc-biblioref">Clarke and Warwick 2001</a>)</span>.</p>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo do VPD utilizando os dados das comunidades de aves.</p>
<div class="sourceCode" id="cb508"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Variance of Pairwise Distance (VPD)</span>
<span class="co"># Transformando data frame em matriz.</span>
<span class="va">dados_matriz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">composicao_especies_P</span><span class="op">)</span>

<span class="co"># Transformar os dados para o formato requerido pelo pacote pez.</span>
<span class="va">dados</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pez/man/comparative.comm.html">comparative.comm</a></span><span class="op">(</span><span class="va">filogenia_aves</span>, <span class="va">dados_matriz</span><span class="op">)</span>

<span class="co"># An√°lise.</span>
<span class="va">resultados_VPD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pez/man/pez.metrics.html">.vpd</a></span><span class="op">(</span><span class="va">dados</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">filogenia_aves</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Mostra os valores de VPD para cada comunidade.</span>
<span class="va">resultados_VPD</span> 
<span class="co">#&gt;     Com_1    Com_10     Com_2     Com_3     Com_4     Com_5     Com_6     Com_7     Com_8     Com_9 </span>
<span class="co">#&gt; 1619.4697 1031.8887 1828.1930 1630.4026 1317.9919 1465.1728 1519.6115  825.5349 1278.0076 1508.0495</span></code></pre></div>
<p>A comunidade 2 abriga a maior vari√¢ncia na dist√¢ncia filogen√©tica entre pares de esp√©cies dentro da comunidade (<code>1828,19</code> milh√µes de anos) enquanto a comunidade 7 abriga a menor vari√¢ncia entre os pares de esp√©cies (<code>825,53</code> m.a.).</p>
</div>
<div id="correla√ß√£o-entre-as-m√©tricas-de-diversidade-alfa-filogen√©tica" class="section level3" number="13.3.4">
<h3>
<span class="header-section-number">13.3.4</span> Correla√ß√£o entre as m√©tricas de diversidade alfa filogen√©tica<a class="anchor" aria-label="anchor" href="#correla%C3%A7%C3%A3o-entre-as-m%C3%A9tricas-de-diversidade-alfa-filogen%C3%A9tica"><i class="fas fa-link"></i></a>
</h3>
<p>Vamos avaliar a correla√ß√£o entre os valores das m√©tricas de diversidade alfa filogen√©tica. Vamos criar um data frame com os resultados das m√©tricas separados para as dimens√µes de riqueza e diverg√™ncia. N√£o iremos fazer para regularidade, pois s√≥ apresentamos uma m√©trica de diversidade filogen√©tica nesta dimens√£o (Figura <a href="cap13.html#fig:fig-filo-alfa-cor-metricas-riq">13.6</a>).</p>
<div class="sourceCode" id="cb509"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Data frame</span>
<span class="co"># Vamos criar um data.frame com os resultados das m√©tricas da dimens√£o riqueza.</span>
<span class="va">metricas_riqueza</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>riqueza <span class="op">=</span> <span class="va">resultados_PD</span><span class="op">$</span><span class="va">SR</span>,
                               PD <span class="op">=</span> <span class="va">resultados_PD</span><span class="op">$</span><span class="va">PD</span>,
                               PSR <span class="op">=</span> <span class="va">resultados_PSR</span><span class="op">$</span><span class="va">PSR</span>,
                               PE <span class="op">=</span> <span class="va">resultados_PE</span><span class="op">)</span>

<span class="co">## Gr√°fico</span>
<span class="co"># Gr√°fico mostrando na parte:</span>
<span class="co"># i) inferior a distribui√ß√£o dos pontos considerando as m√©tricas pareadas</span>
<span class="co"># ii) superior o valor da correla√ß√£o de pearson</span>
<span class="co"># iii) diagonal a curva de densidade</span>
<span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">metricas_riqueza</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="fu"><a href="https://ggobi.github.io/ggally/reference/wrap.html">wrap</a></span><span class="op">(</span><span class="st">"cor"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-alfa-cor-metricas-riq"></span>
<img src="livro_files/figure-html/fig-filo-alfa-cor-metricas-riq-1.png" alt="Correla√ß√£o entre as m√©tricas de riqueza da diversidade alfa filogen√©tica." width="100%" height="100%"><p class="caption">
Figura 13.6: Correla√ß√£o entre as m√©tricas de riqueza da diversidade alfa filogen√©tica.
</p>
</div>
<p>Percebam que as tr√™s m√©tricas apresentam correla√ß√µes pareadas acima de 94%. Isso indica que as m√©tricas s√£o redundantes. Portanto, n√£o h√° necessidade de calcular mais de uma m√©trica dentro da dimens√£o da riqueza filogen√©tica. Al√©m disso, as tr√™s m√©tricas de diversidade alfa filogen√©tica tamb√©m apresentam alta correla√ß√£o com a riqueza de esp√©cies. Veja abaixo na se√ß√£o de modelos nulos como controlar o efeito da riqueza de esp√©cies nas m√©tricas de diversidade filogen√©tica.</p>
<p>Vamos avaliar a correla√ß√£o entre os valores das m√©tricas de diversidade alfa filogen√©tica para a dimens√£o diverg√™ncia (Figura <a href="cap13.html#fig:fig-filo-alfa-cor-metricas-div">13.7</a>).</p>
<div class="sourceCode" id="cb510"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Data frame</span>
<span class="co"># Vamos criar um data.frame com os resultados das m√©tricas da dimens√£o diverg√™ncia.</span>
<span class="va">metricas_divergencia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>riqueza <span class="op">=</span> <span class="va">resultados_PD</span><span class="op">$</span><span class="va">SR</span>,
                                   MPD <span class="op">=</span> <span class="va">resultados_MPD_PA</span>,
                                   MPD_AB <span class="op">=</span> <span class="va">resultados_MPD_AB</span>,
                                   MNTD <span class="op">=</span> <span class="va">resultados_MNTD_PA</span>,
                                   MNTD_AB <span class="op">=</span> <span class="va">resultados_MNTD_AB</span>,
                                   PSV <span class="op">=</span> <span class="va">resultados_PSV</span><span class="op">$</span><span class="va">PSVs</span><span class="op">)</span>

<span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">metricas_divergencia</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="fu"><a href="https://ggobi.github.io/ggally/reference/wrap.html">wrap</a></span><span class="op">(</span><span class="st">"cor"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-alfa-cor-metricas-div"></span>
<img src="livro_files/figure-html/fig-filo-alfa-cor-metricas-div-1.png" alt="Correla√ß√£o entre as m√©tricas de diverg√™ncia da diversidade alfa filogen√©tica." width="100%" height="100%"><p class="caption">
Figura 13.7: Correla√ß√£o entre as m√©tricas de diverg√™ncia da diversidade alfa filogen√©tica.
</p>
</div>
<p>Como mencionado, as m√©tricas MPD e PSV s√£o id√™nticas quando usamos uma filogenia ultram√©trica. Contudo, as m√©tricas de diverg√™ncia n√£o apresentam correla√ß√µes t√£o altas como as m√©tricas da dimens√£o riqueza, com exce√ß√£o do MNTD usando dados de incid√™ncia e abund√¢ncia que foram fortemente correlacionados (r = 0,9). Al√©m disso, estas m√©tricas n√£o s√£o t√£o afetadas pela riqueza de esp√©cies das comunidades como as m√©tricas da dimens√£o riqueza.</p>
</div>
<div id="associa√ß√£o-entre-a-diversidade-alfa-filogen√©tica-e-o-ambiente" class="section level3" number="13.3.5">
<h3>
<span class="header-section-number">13.3.5</span> Associa√ß√£o entre a diversidade alfa filogen√©tica e o ambiente<a class="anchor" aria-label="anchor" href="#associa%C3%A7%C3%A3o-entre-a-diversidade-alfa-filogen%C3%A9tica-e-o-ambiente"><i class="fas fa-link"></i></a>
</h3>
<p>Vamos avaliar e plotar a rela√ß√£o entre os valores de algumas m√©trica de diversidade alfa filogen√©tica (vari√°vel resposta) e os valores de precipita√ß√£o (vari√°vel preditora) (Figura <a href="cap13.html#fig:fig-filo-alfa-metricas-amb">13.8</a>).</p>
<div class="sourceCode" id="cb511"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="co"># Vamos inserir os dados de precipita√ß√£o na planilha metrica_divergencia.</span>
<span class="va">metricas_divergencia</span><span class="op">$</span><span class="va">precipitacao</span> <span class="op">&lt;-</span> <span class="va">precipitacao_filogenetica</span><span class="op">$</span><span class="va">prec</span>

<span class="co">## Gr√°ficos</span>
<span class="va">MPD_PA_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_divergencia</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">precipitacao</span>, <span class="va">MPD</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"Mean Pairwise Distance\n (MPD - Aus√™ncia e Presen√ßa)"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="va">MPD_AB_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_divergencia</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">precipitacao</span>, <span class="va">MPD_AB</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"Mean Pairwise Distance\n (MPD - Abund√¢ncia)"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> 

<span class="va">MNTD_AP_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_divergencia</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">precipitacao</span>, <span class="va">MNTD</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"Mean Nearest Taxon Distance\n (MNTD - Aus√™ncia e Presen√ßa)"</span>, 
         size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> 

<span class="va">MNTD_AB_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_divergencia</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">precipitacao</span>, <span class="va">MNTD_AB</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"Mean Nearest Taxon Distance\n (MNTD - Abund√¢ncia)"</span>, 
         size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">MPD_PA_plot</span>, <span class="va">MPD_AB_plot</span>, <span class="va">MNTD_AP_plot</span>, <span class="va">MNTD_AB_plot</span>,
          ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-alfa-metricas-amb"></span>
<img src="livro_files/figure-html/fig-filo-alfa-metricas-amb-1.png" alt="Rela√ß√£o de algumas m√©trica de diversidade alfa filogen√©tica e valores de precipita√ß√£o." width="100%" height="100%"><p class="caption">
Figura 13.8: Rela√ß√£o de algumas m√©trica de diversidade alfa filogen√©tica e valores de precipita√ß√£o.
</p>
</div>
<p>O MPD, que avalia as rela√ß√µes de parentesco mais internas da filogenia (i.e., rela√ß√µes entre esp√©cies de fam√≠lias diferentes) n√£o apresentou associa√ß√£o com o gradiente de precipita√ß√£o. Por outro lado, o MNTD que avalia as rela√ß√µes mais terminais da filogenia (i.e., esp√©cies dentro do mesmo g√™nero) apresentou uma rela√ß√£o negativa com o gradiente de precipita√ß√£o. Interessante que a associa√ß√£o s√≥ foi significativa quando pesamos a an√°lise pela abund√¢ncia das esp√©cies nas comunidades. Esses resultados demonstram a import√¢ncia da sele√ß√£o das m√©tricas de diversidade filogen√©tica e tipos de dados (e.g., incid√™ncia ou abund√¢ncia) utilizados na interpreta√ß√£o dos padr√µes observados na natureza.</p>
<p>Vamos ver os gr√°ficos das m√©tricas da dimens√£o riqueza da diversidade alfa filogen√©tica (Figura <a href="cap13.html#fig:fig-filo-alfa-metricas-riq-amb">13.9</a>).</p>
<div class="sourceCode" id="cb512"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="co"># Vamos inserir os dados de precipita√ß√£o na planilha metrica_riqueza.</span>
<span class="va">metricas_riqueza</span><span class="op">$</span><span class="va">precipitacao</span> <span class="op">&lt;-</span> <span class="va">precipitacao</span><span class="op">$</span><span class="va">prec</span>

<span class="co">## Gr√°ficos</span>
<span class="va">Riqueza_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_riqueza</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">precipitacao</span>, <span class="va">riqueza</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Precipita√ß√£o (mm)"</span>, y <span class="op">=</span> <span class="st">"Riqueza de esp√©cies"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> 

<span class="va">PD_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_riqueza</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">precipitacao</span>, <span class="va">PD</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"Diversidade Filogen√©tica\n (Faith)"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="va">PSR_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_riqueza</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">precipitacao</span>, <span class="va">PSR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span>  <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"Phylogenetic Species Richness\n (PSR)"</span>, 
         size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="va">PE_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_riqueza</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">precipitacao</span>, <span class="va">PE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span>  <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"Phylogenetic Endemism\n (PE)"</span>, 
         size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> 

<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">Riqueza_plot</span>, <span class="va">PD_plot</span>, <span class="va">PSR_plot</span>, <span class="va">PE_plot</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-alfa-metricas-riq-amb"></span>
<img src="livro_files/figure-html/fig-filo-alfa-metricas-riq-amb-1.png" alt="Rela√ß√£o de algumas m√©trica de diversidade alfa filogen√©tica e valores de precipita√ß√£o." width="100%" height="100%"><p class="caption">
Figura 13.9: Rela√ß√£o de algumas m√©trica de diversidade alfa filogen√©tica e valores de precipita√ß√£o.
</p>
</div>
<p>As tr√™s m√©tricas de diversidade filogen√©tica foram relacionadas com o gradiente de precipita√ß√£o. Esse resultado indica que comunidades localizadas em √°reas com maior precipita√ß√£o anual abrigaram maior diversidade filogen√©tica do que comunidades localizadas em √°reas mais secas. Contudo, estas m√©tricas s√£o dependentes da riqueza de esp√©cies nas comunidades. Veja abaixo a se√ß√£o de modelos nulos para entender como lidar com essa depend√™ncia.</p>
</div>
</div>
<div id="m√©tricas-de-diversidade-beta-filogen√©tica" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> M√©tricas de diversidade beta filogen√©tica<a class="anchor" aria-label="anchor" href="#m%C3%A9tricas-de-diversidade-beta-filogen%C3%A9tica"><i class="fas fa-link"></i></a>
</h2>
<p>M√©tricas de diversidade beta filogen√©tica utilizam dados de presen√ßa e aus√™ncia ou abund√¢ncia das esp√©cies para determinar um valor que representa a diferen√ßa entre comunidades em rela√ß√£o a hist√≥ria evolutiva das linhagens (para detalhes de diversidade beta, consulte o Cap√≠tulo <a href="cap12.html#cap12">12</a>).</p>
<div id="diverg√™ncia-da-diversidade-beta-filogen√©tica" class="section level3" number="13.4.1">
<h3>
<span class="header-section-number">13.4.1</span> Diverg√™ncia da diversidade beta filogen√©tica<a class="anchor" aria-label="anchor" href="#diverg%C3%AAncia-da-diversidade-beta-filogen%C3%A9tica"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Community Mean Pairwise Distance (COMDIST)</strong></p>
<p>Esta m√©trica √© uma extens√£o do MPD. COMDIST calcula a m√©dia da dist√¢ncia filogen√©tica entre as esp√©cies de duas comunidades <span class="citation">(<a href="refer%C3%AAncias.html#ref-webb2008" role="doc-biblioref">Webb, Ackerly, and Kembel 2008</a>)</span>. COMDIST pode ser calculada usando dados de incid√™ncia (presen√ßa e aus√™ncia) ou abund√¢ncia das esp√©cies. Esta extens√£o do MPD tamb√©m √© conhecida na literatura como Dpw <span class="citation">(<a href="refer%C3%AAncias.html#ref-swenson2011" role="doc-biblioref">Swenson 2011</a>, <a href="refer%C3%AAncias.html#ref-swenson2014" role="doc-biblioref">2014</a>)</span>.</p>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo do COMDIST utilizando os dados das comunidades de aves.</p>
<div class="sourceCode" id="cb513"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Community Mean Pairwise Distance (COMDIST)</span>
<span class="co"># An√°lise com dados de presen√ßa e aus√™ncia das esp√©cies nas comunidades.</span>
<span class="va">resultados_Comdist_PA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/comdist.html">comdist</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, 
                                 <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">filogenia_aves</span><span class="op">)</span>, 
                                 abundance.weighted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">resultados_Comdist_PA</span>
<span class="co">#&gt;           Com_1    Com_2    Com_3    Com_4    Com_5    Com_6    Com_7    Com_8    Com_9</span>
<span class="co">#&gt; Com_2  150.5242                                                                        </span>
<span class="co">#&gt; Com_3  144.3300 148.7436                                                               </span>
<span class="co">#&gt; Com_4  149.4782 153.2992 147.5838                                                      </span>
<span class="co">#&gt; Com_5  141.8435 146.9829 139.9606 145.8746                                             </span>
<span class="co">#&gt; Com_6  142.6019 148.3160 140.0376 143.1340 137.9527                                    </span>
<span class="co">#&gt; Com_7  147.7189 150.2248 147.1703 150.3418 144.1481 145.2975                           </span>
<span class="co">#&gt; Com_8  141.3083 145.6684 138.5875 145.3897 137.0034 137.7062 144.4818                  </span>
<span class="co">#&gt; Com_9  141.6018 146.4697 138.3515 144.3480 136.9036 136.3453 144.3257 130.7628         </span>
<span class="co">#&gt; Com_10 140.8810 145.9333 136.9978 145.1400 136.5394 137.2350 144.3660 130.0691 130.2321</span></code></pre></div>
<p>As comunidades 8 e 10 apresentaram a menor m√©dia na dist√¢ncia filogen√©tica (<code>130,06</code> m.a. - esp√©cies de linhagens mais pr√≥ximas) entre as esp√©cies presente em cada comunidade, enquanto as comunidades 2 e 4 apresentaram a maior m√©dia na dist√¢ncia filogen√©tica (<code>153.29</code> m.a. - esp√©cies de linhagens mais distintas).</p>
<p>Vamos refazer a an√°lise do COMDIST, mas desta vez, considerando a abund√¢ncia das esp√©cies de aves nas comunidades.</p>
<div class="sourceCode" id="cb514"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Community Mean Pairwise Distance (COMDIST)</span>
<span class="co"># An√°lise com dados de abund√¢ncia das esp√©cies nas comunidades.</span>
<span class="va">resultados_Comdist_AB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/comdist.html">comdist</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, 
                                 <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">filogenia_aves</span><span class="op">)</span>, 
                                 abundance.weighted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Como no caso do MPD, pensar a abund√¢ncia das esp√©cies altera o padr√£o de distribui√ß√£o dos valores de COMDIST. Neste caso, ao inv√©s das comunidades 2 e 4, as comunidades 2 e 10 apresentam a maior m√©dia na dist√¢ncia filogen√©tica (<code>155,85</code> m.a.).</p>
<p><strong>Community Mean Nearest Taxon Distance (COMDISTNT)</strong></p>
<p>Esta m√©trica √© uma extens√£o do MNTD. COMDISTNT calcula a m√©dia da dist√¢ncia filogen√©tica entre o t√°xon mais pr√≥ximo das esp√©cies de duas comunidades <span class="citation">(<a href="refer%C3%AAncias.html#ref-webb2008" role="doc-biblioref">Webb, Ackerly, and Kembel 2008</a>)</span>. COMDISTNT pode ser calculada usando dados de incid√™ncia ou abund√¢ncia das esp√©cies. Esta extens√£o do MNTD tamb√©m √© conhecida na literatura como Dnn <span class="citation">(<a href="refer%C3%AAncias.html#ref-swenson2011" role="doc-biblioref">Swenson 2011</a>)</span>.</p>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo do COMDISTNT utilizando os dados das comunidades de aves.</p>
<div class="sourceCode" id="cb515"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Community Mean Nearest Taxon Distance (COMDISTNT)</span>
<span class="co"># An√°lise com dados de presen√ßa e aus√™ncia das esp√©cies nas comunidades.</span>
<span class="va">resultados_Comdistnt_PA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/comdistnt.html">comdistnt</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, 
                                     <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">filogenia_aves</span><span class="op">)</span>, 
                                     abundance.weighted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">resultados_Comdistnt_PA</span>
<span class="co">#&gt;           Com_1    Com_2    Com_3    Com_4    Com_5    Com_6    Com_7    Com_8    Com_9</span>
<span class="co">#&gt; Com_2  24.65946                                                                        </span>
<span class="co">#&gt; Com_3  18.56953 22.22310                                                               </span>
<span class="co">#&gt; Com_4  26.85806 24.04505 17.87073                                                      </span>
<span class="co">#&gt; Com_5  13.15074 34.14223 18.82684 25.54000                                             </span>
<span class="co">#&gt; Com_6  35.43332 49.33726 33.82511 24.59980 28.50505                                    </span>
<span class="co">#&gt; Com_7  30.37968 29.22411 39.89649 34.06858 29.27588 47.69536                           </span>
<span class="co">#&gt; Com_8  38.16628 48.17376 38.46830 51.02029 32.52846 50.37593 54.37647                  </span>
<span class="co">#&gt; Com_9  42.58727 54.09441 41.83792 46.29635 36.35245 46.18264 49.85495 10.69759         </span>
<span class="co">#&gt; Com_10 45.71452 56.82713 40.39642 60.17935 40.74857 59.63770 60.24556 10.87162 16.12367</span></code></pre></div>
<p>As comunidades 8 e 9 apresentaram a menor m√©dia na dist√¢ncia do vizinho mais pr√≥ximo (<code>10,69</code> m.a. - esp√©cies do mesmo g√™nero ou g√™neros irm√£os) entre as esp√©cies presente em cada comunidade, enquanto as comunidades 7 e 10 apresentaram a maior m√©dia na dist√¢ncia entre vizinhos (<code>60,24</code> m.a. - esp√©cies de linhagens distintas).</p>
<p>Vamos refazer a an√°lise do COMDISTNT, mas desta vez, considerando a abund√¢ncia das esp√©cies de aves nas comunidades.</p>
<div class="sourceCode" id="cb516"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Community Mean Nearest Taxon Distance (COMDISTNT)</span>
<span class="co"># An√°lise com dados de abund√¢ncia das esp√©cies nas comunidades.</span>
<span class="va">resultados_Comdistnt_AB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/comdistnt.html">comdistnt</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, 
                                     <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">filogenia_aves</span><span class="op">)</span>, 
                                     abundance.weighted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>As comunidades 8 e 10 apresentaram a menor m√©dia na dist√¢ncia do vizinho mais pr√≥ximo (<code>5,64</code> m.a.) entre as esp√©cies presente em cada comunidade, enquanto as comunidades 6 e 10 apresentaram a maior m√©dia na dist√¢ncia entre vizinhos (<code>82,62</code> m.a.).</p>
</div>
<div id="correla√ß√£o-entre-as-m√©tricas-de-diversidade-beta-filogen√©tica" class="section level3" number="13.4.2">
<h3>
<span class="header-section-number">13.4.2</span> Correla√ß√£o entre as m√©tricas de diversidade beta filogen√©tica<a class="anchor" aria-label="anchor" href="#correla%C3%A7%C3%A3o-entre-as-m%C3%A9tricas-de-diversidade-beta-filogen%C3%A9tica"><i class="fas fa-link"></i></a>
</h3>
<p>Vamos avaliar a correla√ß√£o entre os valores das m√©tricas da diversidade beta filogen√©tica para a dimens√£o diverg√™ncia (Figura <a href="cap13.html#fig:fig-filo-beta-cor-metricas-div">13.10</a>).</p>
<div class="sourceCode" id="cb517"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="co"># Vamos criar um data frame com os resultados das m√©tricas da dimens√£o diverg√™ncia.</span>
<span class="va">metricas_divergencia_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    COMDIST_PA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">resultados_Comdist_PA</span><span class="op">)</span>,
    COMDIST_AB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">resultados_Comdist_AB</span><span class="op">)</span>,
    COMDISTNT_PA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">resultados_Comdistnt_PA</span><span class="op">)</span>,
    COMDISTNT_AB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">resultados_Comdistnt_AB</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">metricas_divergencia_beta</span>,
        upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="fu"><a href="https://ggobi.github.io/ggally/reference/wrap.html">wrap</a></span><span class="op">(</span><span class="st">"cor"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-beta-cor-metricas-div"></span>
<img src="livro_files/figure-html/fig-filo-beta-cor-metricas-div-1.png" alt="Correla√ß√£o entre as m√©tricas de diverg√™ncia da diversidade beta filogen√©tica." width="100%" height="100%"><p class="caption">
Figura 13.10: Correla√ß√£o entre as m√©tricas de diverg√™ncia da diversidade beta filogen√©tica.
</p>
</div>
<p>Os valores das m√©tricas de diverg√™ncia filogen√©tica beta apresentam correla√ß√µes mais baixas do que as m√©tricas da dimens√£o riqueza. Lembrem-se que COMDIST e COMDISTNT d√£o pesos diferentes para as rela√ß√µes de parentesco. COMDIST pesa as rela√ß√µes mais basais e internas da filogenia, enquanto COMDISTNT pesa as rela√ß√µes nas partes terminais da filogenia. Portanto, elas podem trazer informa√ß√µes complementares.</p>
</div>
<div id="associa√ß√£o-entre-a-diverg√™ncia-da-diversidade-beta-filogen√©tica-e-o-ambiente" class="section level3" number="13.4.3">
<h3>
<span class="header-section-number">13.4.3</span> Associa√ß√£o entre a diverg√™ncia da diversidade beta filogen√©tica e o ambiente<a class="anchor" aria-label="anchor" href="#associa%C3%A7%C3%A3o-entre-a-diverg%C3%AAncia-da-diversidade-beta-filogen%C3%A9tica-e-o-ambiente"><i class="fas fa-link"></i></a>
</h3>
<p>Vamos avaliar e plotar a rela√ß√£o entre os valores de algumas m√©tricas de diverg√™ncia da diversidade beta filogen√©tica (vari√°vel resposta) e os valores de precipita√ß√£o (vari√°vel preditora) (Figura <a href="cap13.html#fig:fig-filo-beta-metricas-div-amb">13.11</a>).</p>
<div class="sourceCode" id="cb518"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="co"># Precisamos calcular a dissimilaridade par a par da precipita√ß√£o entre as comunidades.</span>
<span class="va">dis_prec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">precipitacao</span>, <span class="st">"euclidian"</span><span class="op">)</span>

<span class="co"># Vamos inserir estes dados na planilha metrica_divergencia_beta.</span>
<span class="va">metricas_divergencia_beta</span><span class="op">$</span><span class="va">dis_prec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dis_prec</span><span class="op">)</span>

<span class="co"># Gr√°ficos.</span>
<span class="va">COMDIST_PA_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_divergencia_beta</span>, 
                          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">dis_prec</span>, <span class="va">COMDIST_PA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Diferen√ßa na precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"COMDIST\n (Presen√ßa e Aus√™ncia)"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> 

<span class="va">COMDIST_AB_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_divergencia_beta</span>, 
                          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">dis_prec</span>, <span class="va">COMDIST_AB</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Diferen√ßa na precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"COMDIST\n (Abund√¢ncia)"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="va">COMDISTNT_PA_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_divergencia_beta</span>, 
                            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">dis_prec</span>, <span class="va">COMDISTNT_PA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Diferen√ßa na precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"COMDISTNT\n (Aus√™ncia e Presen√ßa)"</span>, 
         size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="va">COMDISTNT_AB_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_divergencia_beta</span>, 
                            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">dis_prec</span>, <span class="va">COMDISTNT_AB</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Diferen√ßa na precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">" COMDISTNT\n (Abund√¢ncia)"</span>, 
         size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span> 

<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">COMDIST_PA_plot</span>, <span class="va">COMDIST_AB_plot</span>, <span class="va">COMDISTNT_PA_plot</span>, 
          <span class="va">COMDISTNT_AB_plot</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-beta-metricas-div-amb"></span>
<img src="livro_files/figure-html/fig-filo-beta-metricas-div-amb-1.png" alt="Rela√ß√£o de algumas m√©trica de diverg√™ncia diversidade beta filogen√©tica e valores de precipita√ß√£o." width="100%" height="100%"><p class="caption">
Figura 13.11: Rela√ß√£o de algumas m√©trica de diverg√™ncia diversidade beta filogen√©tica e valores de precipita√ß√£o.
</p>
</div>
<p>O COMDIST que avalia as rela√ß√µes de parentesco mais internas da filogenia (i.e., rela√ß√µes entre esp√©cies de fam√≠lias diferentes) apresentou associa√ß√£o com o gradiente de precipita√ß√£o quando avaliado pesado pela abund√¢ncia das esp√©cies. Por outro lado, o COMDISTNT que avalia as rela√ß√µes mais terminais da filogenia (i.e., esp√©cies dentro do mesmo g√™nero) apresentou uma rela√ß√£o negativa com o gradiente de precipita√ß√£o quando avaliado usando a incid√™ncia das esp√©cies.</p>
</div>
<div id="riqueza-da-diversidade-beta-filogen√©tica" class="section level3" number="13.4.4">
<h3>
<span class="header-section-number">13.4.4</span> Riqueza da diversidade beta filogen√©tica<a class="anchor" aria-label="anchor" href="#riqueza-da-diversidade-beta-filogen%C3%A9tica"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Phylogenetic index of beta diversity (Phylosor)</strong></p>
<p>Phylosor √© uma m√©trica de similaridade e determina o comprimento total dos ramos da filogenia que √© compartilhado entre pares de comunidades <span class="citation">(<a href="refer%C3%AAncias.html#ref-bryant2008" role="doc-biblioref">Bryant et al. 2008</a>)</span>.</p>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo do Phylosor utilizando os dados das comunidades de aves.</p>
<div class="sourceCode" id="cb519"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Phylogenetic index of beta diversity (Phylosor)</span>
<span class="co"># An√°lise com dados de presen√ßa e aus√™ncia das esp√©cies nas comunidades.</span>
<span class="va">resultados_Phylosor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/phylosor.html">phylosor</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, <span class="va">filogenia_aves</span><span class="op">)</span>

<span class="co"># Mostra uma matriz triangular com a similaridade entre a fra√ß√£o dos ramos </span>
<span class="co"># compartilahdos entre duas comunidades</span>
<span class="va">resultados_Phylosor</span> 
<span class="co">#&gt;            Com_1     Com_2     Com_3     Com_4     Com_5     Com_6     Com_7     Com_8     Com_9</span>
<span class="co">#&gt; Com_2  0.7856828                                                                                </span>
<span class="co">#&gt; Com_3  0.8052839 0.7794964                                                                      </span>
<span class="co">#&gt; Com_4  0.7831520 0.8066793 0.8595462                                                            </span>
<span class="co">#&gt; Com_5  0.8586780 0.6919478 0.8083230 0.7930266                                                  </span>
<span class="co">#&gt; Com_6  0.6717414 0.5827551 0.6977734 0.7494945 0.7383098                                        </span>
<span class="co">#&gt; Com_7  0.7414284 0.7325727 0.6836231 0.7289449 0.7384561 0.6425717                              </span>
<span class="co">#&gt; Com_8  0.6826177 0.6283918 0.6443193 0.6404373 0.7123197 0.5928097 0.6146854                    </span>
<span class="co">#&gt; Com_9  0.6789983 0.6074676 0.6405220 0.6727656 0.7082867 0.6169977 0.6506880 0.9016007          </span>
<span class="co">#&gt; Com_10 0.6264594 0.5709671 0.6422800 0.5823317 0.6493935 0.5362575 0.6015983 0.9106658 0.8607104</span></code></pre></div>
<p>As esp√©cies presentes nas comunidades 6 e 10 compartilham a menor por√ß√£o do comprimento dos ramos da filogenia (53% - menor similaridade entre os pares de comunidades), enquanto as esp√©cies presentes nas comunidades 8 e 10 compartilham grande parte dos comprimentos dos ramos da filogenia (91% - maior similaridade entre os pares de comunidades).</p>
<p><strong>Unique Fraction metric (UniFrac)</strong></p>
<p>UniFrac √© uma m√©trica de dissimilaridade e determina a fra√ß√£o √∫nica da filogenia contida em cada uma das duas comunidades <span class="citation">(<a href="refer%C3%AAncias.html#ref-lozupone2005" role="doc-biblioref">Lozupone and Knight 2005</a>)</span>.</p>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo da UniFrac utilizando os dados das comunidades de aves.</p>
<div class="sourceCode" id="cb520"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Unique Fraction metric (UniFrac)</span>
<span class="co"># An√°lise com dados de presen√ßa e aus√™ncia das esp√©cies nas comunidades.</span>
<span class="va">resultados_UniFrac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/unifrac.html">unifrac</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, <span class="va">filogenia_aves</span><span class="op">)</span></code></pre></div>
<p>As esp√©cies presentes nas comunidades 6 e 10 apresentam a menor dissimilaridade (16,4 % - maior fra√ß√£o √∫nica da filogenia em cada comunidade), enquanto as esp√©cies presentes nas comunidades 8 e 10 apresentam a maior dissimilaridade (63,36 % - maior compartilhamento de ramos da filogenia entre os pares de comunidades).</p>
</div>
<div id="correla√ß√£o-entre-phylosor-e-unifrac" class="section level3" number="13.4.5">
<h3>
<span class="header-section-number">13.4.5</span> Correla√ß√£o entre Phylosor e Unifrac<a class="anchor" aria-label="anchor" href="#correla%C3%A7%C3%A3o-entre-phylosor-e-unifrac"><i class="fas fa-link"></i></a>
</h3>
<p>Vamos calcula a correla√ß√£o entre as duas m√©tricas de Riqueza da diversidade beta filogen√©tica: Phylosor e Unifrac (Figura <a href="cap13.html#fig:fig-filo-beta-cor-metricas-riq">13.12</a>).</p>
<div class="sourceCode" id="cb521"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="co"># Vamos criar um data.frame com os resultados das m√©tricas separados </span>
<span class="co"># para as dimens√µes de riqueza e diverg√™ncia.</span>
<span class="va">metricas_riqueza_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Phylosor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">resultados_Phylosor</span><span class="op">)</span>,
                                    UniFrac <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">resultados_UniFrac</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Gr√°fico</span>
<span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">metricas_riqueza_beta</span>, upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="fu"><a href="https://ggobi.github.io/ggally/reference/wrap.html">wrap</a></span><span class="op">(</span><span class="st">"cor"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-beta-cor-metricas-riq"></span>
<img src="livro_files/figure-html/fig-filo-beta-cor-metricas-riq-1.png" alt="Correla√ß√£o entre as m√©tricas de riqueza da diversidade beta filogen√©tica." width="100%" height="100%"><p class="caption">
Figura 13.12: Correla√ß√£o entre as m√©tricas de riqueza da diversidade beta filogen√©tica.
</p>
</div>
<div class="alert alert-info">
<p><strong> üìù Importante </strong><br></p>
<p>Os valores de Phylosor e UniFrac apresenta 99% de correla√ß√£o entre eles. Portanto, essas duas m√©tricas identificam padr√µes id√™nticos e n√£o devem ser utilizadas simultaneamente.</p>
</div>
</div>
<div id="associa√ß√£o-entre-a-riqueza-da-diversidade-beta-filogen√©tica-e-o-ambiente" class="section level3" number="13.4.6">
<h3>
<span class="header-section-number">13.4.6</span> Associa√ß√£o entre a riqueza da diversidade beta filogen√©tica e o ambiente<a class="anchor" aria-label="anchor" href="#associa%C3%A7%C3%A3o-entre-a-riqueza-da-diversidade-beta-filogen%C3%A9tica-e-o-ambiente"><i class="fas fa-link"></i></a>
</h3>
<p>Vamos avaliar e plotar a rela√ß√£o entre os valores de algumas m√©tricas de riqueza da diversidade beta filogen√©tica (vari√°vel resposta) e os valores de precipita√ß√£o (vari√°vel preditora) (Figura <a href="cap13.html#fig:fig-filo-beta-metricas-riq-amb">13.13</a>).</p>
<div class="sourceCode" id="cb522"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="co"># Vamos inserir os dados de precipita√ß√£o na planilha metrica_riqueza_beta.</span>
<span class="va">metricas_riqueza_beta</span><span class="op">$</span><span class="va">dis_prec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dis_prec</span><span class="op">)</span>

<span class="co">## Gr√°ficos</span>
<span class="co"># Phylosor.</span>
<span class="va">plot_phylosor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_riqueza_beta</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">dis_prec</span>, <span class="va">Phylosor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Diferen√ßa na precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"Phylosor"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="co"># Unifrag.</span>
<span class="va">plot_unifrac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">metricas_riqueza_beta</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">dis_prec</span>, <span class="va">UniFrac</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Diferen√ßa na precipita√ß√£o (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"UniFrac"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">plot_phylosor</span>, <span class="va">plot_unifrac</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-beta-metricas-riq-amb"></span>
<img src="livro_files/figure-html/fig-filo-beta-metricas-riq-amb-1.png" alt="Rela√ß√£o de algumas m√©trica de riqeuza diversidade beta filogen√©tica e valores de precipita√ß√£o." width="100%" height="100%"><p class="caption">
Figura 13.13: Rela√ß√£o de algumas m√©trica de riqeuza diversidade beta filogen√©tica e valores de precipita√ß√£o.
</p>
</div>
<p>Phylosor (similaridade) e UniFrac (dissimilaridade) foram relacionadas com o gradiente de precipita√ß√£o. Comunidades com quantidade de precipita√ß√£o parecidas abrigaram linhagens similares enquanto comunidades que recebem quantidade de precipita√ß√£o diferentes abrigam linhagens mais distintas.</p>
</div>
<div id="parti√ß√£o-da-diversidade-beta-filogen√©tica" class="section level3" number="13.4.7">
<h3>
<span class="header-section-number">13.4.7</span> Parti√ß√£o da diversidade beta filogen√©tica<a class="anchor" aria-label="anchor" href="#parti%C3%A7%C3%A3o-da-diversidade-beta-filogen%C3%A9tica"><i class="fas fa-link"></i></a>
</h3>
<p>As m√©tricas, Phylosor e UniFrac, podem ser particionadas em dois componentes <span class="citation">(<a href="refer%C3%AAncias.html#ref-baselga2009" role="doc-biblioref">Baselga 2010</a>; <a href="refer%C3%AAncias.html#ref-leprieur2012" role="doc-biblioref">Leprieur et al. 2012</a>)</span>: i) substitui√ß√£o (do ingl√™s <em>turnover</em>) de esp√©cies entre as comunidades; e ii) componente de aninhamento (do ingl√™s <em>nestedness</em>) que representa a perda ou ganho de esp√©cies entre comunidades atribu√≠dos a diferen√ßa na riqueza de esp√©cies. A parti√ß√£o da diversidade beta nestes componentes permite avaliar diferentes hip√≥teses sobre os processos e mecanismos atuando na montagem de comunidades.</p>
<p>Abaixo, demonstramos os c√≥digos no R para o c√°lculo da parti√ß√£o da diversidade beta filogen√©tica utilizando os dados das comunidades de aves.</p>
<div class="sourceCode" id="cb523"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Parti√ß√£o</span>
<span class="co"># Temos que transformar os dados para presen√ßa e aus√™ncia das esp√©cies nas comunidades.</span>
<span class="va">dados_PA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, <span class="st">"pa"</span><span class="op">)</span>

<span class="co"># Parti√ß√£o dos componentes do Phylosor.</span>
<span class="va">resultados_Phylosor_particao</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betapart/man/phylo.beta.pair.html">phylo.beta.pair</a></span><span class="op">(</span><span class="va">dados_PA</span>,
                                                <span class="va">filogenia_aves</span>, 
                                                index.family <span class="op">=</span> <span class="st">"sorensen"</span><span class="op">)</span></code></pre></div>
<p>Vamos refazer a an√°lise para UniFrac.</p>
<div class="sourceCode" id="cb524"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Parti√ß√£o dos componentes do UniFrac.</span>
<span class="va">resultados_UniFrac_particao</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betapart/man/phylo.beta.pair.html">phylo.beta.pair</a></span><span class="op">(</span><span class="va">dados_PA</span>,
                                               <span class="va">filogenia_aves</span>, 
                                               index.family <span class="op">=</span> <span class="st">"jaccard"</span><span class="op">)</span>
<span class="co"># Resultado tem tr√™s matrizes: </span>
<span class="co"># i) dissimilaridade total (phylo.beta.jac); </span>
<span class="co"># ii) componente substitui√ß√£o de esp√©cies (phylo.beta.jtu); e </span>
<span class="co"># iii) componente aninhamento (phylo.beta.jne).</span>
<span class="co"># resultados_UniFrac_particao (para ver os resultados corra este comando)</span></code></pre></div>
<p>Gr√°fico com os resultados dos componentes substitui√ß√£o e aninhamento da diversidade beta filogen√©tica - Phylosor (Figura <a href="cap13.html#fig:fig-filo-beta-part-amb">13.14</a>).</p>
<div class="sourceCode" id="cb525"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="co"># Vamos preparar os dados para o gr√°fico.</span>
<span class="va">particao_phylosor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    substituicao <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">resultados_Phylosor_particao</span><span class="op">$</span><span class="va">phylo.beta.sim</span><span class="op">)</span>,
    aninhamento <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">resultados_Phylosor_particao</span><span class="op">$</span><span class="va">phylo.beta.sne</span><span class="op">)</span>,
    sorensen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">resultados_Phylosor_particao</span><span class="op">$</span><span class="va">phylo.beta.sor</span><span class="op">)</span>,
    dis_prec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dis_prec</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Gr√°ficos</span>
<span class="va">sorensen_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">particao_phylosor</span>, 
                        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">dis_prec</span>, <span class="va">sorensen</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Sorensen"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="va">subst_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">particao_phylosor</span>, 
                     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">dis_prec</span>, <span class="va">substituicao</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Diferen√ßa na precipita√ß√£o\n (mm)"</span>, 
         y <span class="op">=</span> <span class="st">"Componente Substitui√ß√£o"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="va">aninha_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">particao_phylosor</span>, 
                      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">dis_prec</span>, <span class="va">aninhamento</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Componente aninhamento"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">sorensen_plot</span>, <span class="va">subst_plot</span>, <span class="va">aninha_plot</span>, 
          ncol <span class="op">=</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-filo-beta-part-amb"></span>
<img src="livro_files/figure-html/fig-filo-beta-part-amb-1.png" alt="Rela√ß√£o dos componentes substitui√ß√£o e aninhamento da diversidade beta filogen√©tica - Phylosor e valores de precipita√ß√£o." width="100%" height="100%"><p class="caption">
Figura 13.14: Rela√ß√£o dos componentes substitui√ß√£o e aninhamento da diversidade beta filogen√©tica - Phylosor e valores de precipita√ß√£o.
</p>
</div>
<p>Percebam que o componente substitui√ß√£o √© maior entre comunidades que apresentam diferen√ßas altas na quantidade de precipita√ß√£o, enquanto o componente aninhamento √© maior entre as comunidades que apresentam quantidade similar de precipita√ß√£o.</p>
</div>
</div>
<div id="modelos-nulos" class="section level2" number="13.5">
<h2>
<span class="header-section-number">13.5</span> Modelos Nulos<a class="anchor" aria-label="anchor" href="#modelos-nulos"><i class="fas fa-link"></i></a>
</h2>
<p>Em muitos casos, os valores de diversidade filogen√©tica s√£o correlacionados com a riqueza de esp√©cies nas comunidades. Por exemplo, se um pesquisador relata que duas comunidades apresentam diferentes valores de PD, √© imposs√≠vel saber se esta diferen√ßa √© simplesmente porque elas t√™m diferentes valores de riqueza de esp√©cies ou se h√° algum fator fundamental sobre a informa√ß√£o filogen√©tica que √© importante. Outra quest√£o abordada nos estudos de montagem das comunidades √© saber se os valores observados para as m√©tricas (e.g.¬†MPD ou MNTD) relacionadas com a estrutura filogen√©tica das comunidades seriam diferentes se a coloniza√ß√£o das esp√©cies do <em>pool</em> regional fosse aleat√≥ria? Os modelos nulos respondem a estas perguntas. Contudo, a defini√ß√£o do <em>pool</em> regional n√£o √© uma tarefa trivial <span class="citation">(<a href="refer%C3%AAncias.html#ref-lessard2012" role="doc-biblioref">Lessard et al. 2012</a>; <a href="refer%C3%AAncias.html#ref-carstensen2013" role="doc-biblioref">Carstensen et al. 2013</a>)</span>.</p>
<p>Os modelos nulos s√£o constru√≠dos considerando processos ecol√≥gicos ou evolutivos de interesse. Eles geram padr√µes que s√£o baseados na aleatoriza√ß√£o dos dados ecol√≥gicos ou amostragens aleat√≥rias de uma distribui√ß√£o conhecida ou hipot√©tica <span class="citation">(<a href="refer%C3%AAncias.html#ref-gotelli1996" role="doc-biblioref">Gotelli and Graves 1996</a>)</span>. Neste caso, alguns elementos dos dados (como colunas ou linhas) s√£o mantidos constantes, e outros s√£o permitidos variar aleatoriamente para criar novos padr√µes. O principal motivo para a constru√ß√£o de modelos nulos √© produzir um padr√£o que seria esperado na aus√™ncia de um mecanismo ecol√≥gico espec√≠fico <span class="citation">(<a href="refer%C3%AAncias.html#ref-gotelli1996" role="doc-biblioref">Gotelli and Graves 1996</a>)</span>. Contudo, ressaltamos que os modelos nulos podem revelar padr√µes n√£o comuns, mas eles n√£o podem determinar os mecanismos respons√°veis por gerar estes padr√µes <span class="citation">(<a href="refer%C3%AAncias.html#ref-gotelli1996" role="doc-biblioref">Gotelli and Graves 1996</a>)</span>.</p>
<p>Os modelos nulos empregados para contrapor os padr√µes observados pelas m√©tricas de diversidade filogen√©tica utilizam a aleatoriza√ß√£o dos dados de duas formas principais: i) aleatorizando o nome das esp√©cies na √°rvore filogen√©tica mantendo a estrutura e composi√ß√£o da matriz de co-ocorr√™ncia das esp√©cies e o comprimento dos ramos da √°rvore inalterados; e ii) aleatorizando as linhas e/ou colunas da matriz de co-ocorr√™ncia das esp√©cies <span class="citation">(<a href="refer%C3%AAncias.html#ref-gotelli2000" role="doc-biblioref">Gotelli 2000</a>; <a href="refer%C3%AAncias.html#ref-ulrich2010" role="doc-biblioref">Ulrich and Gotelli 2010</a>)</span>. De forma geral, nas an√°lises de diversidade filogen√©tica as aleatoriza√ß√µes s√£o repetidas 999 vezes (pode ser mais ou menos, a crit√©rio do pesquisador) e calcula-se a m√©dia e o desvio padr√£o dos valores gerados pelos modelos. Com estes dados, calcula-se o tamanho do efeito padronizado (do ingl√™s <em>Standardized Effect Size</em> - SES) utilizando a seguinte f√≥rmula:</p>
<ul>
<li>SES = (valor observado - m√©dia dos valores gerados na aleatoriza√ß√£o)/ desvio padr√£o dos valores gerados na aleatoriza√ß√£o</li>
</ul>
<p>Os valores de SES s√£o utilizados para rejeitar ou n√£o a hip√≥tese nula de que o padr√£o observado difere do esperado ao acaso. Contudo, tenha em mente que a defini√ß√£o do esquema de aleatoriza√ß√£o dos modelos nulos n√£o √© meramente uma quest√£o t√©cnica <span class="citation">(<a href="refer%C3%AAncias.html#ref-g%C3%B6tzenberger2011" role="doc-biblioref">G√∂tzenberger et al. 2012</a>)</span>. A defini√ß√£o do esquema de aleatoriza√ß√£o ir√° determinar quais os mecanismos ecol√≥gicos s√£o permitidos ou exclu√≠dos no modelo nulo <span class="citation">(<a href="refer%C3%AAncias.html#ref-g%C3%B6tzenberger2011" role="doc-biblioref">G√∂tzenberger et al. 2012</a>)</span>. Consequentemente, ele estar√° avaliando diferentes hip√≥teses nulas.</p>
<p>Abaixo, demonstramos os c√≥digos no R para calcular os modelos nulos para as m√©tricas de diversidade filogen√©tica.</p>
<p><strong>Nearest Relative Index (NRI) ou Standardized Effect Size of MPD</strong></p>
<p>Esta m√©trica calcula o tamanho do efeito padronizado para a m√©trica MPD. Contudo, NRI √© calculado multiplicando os resultados do SES por -1. Valores positivos de NRI indicam agrupamento filogen√©tico e valores negativos de NRI indicam dispers√£o filogen√©tica <span class="citation">(<a href="refer%C3%AAncias.html#ref-webb2008" role="doc-biblioref">Webb, Ackerly, and Kembel 2008</a>)</span>.</p>
<p>Veja a ajuda desta fun√ß√£o usando <code>?ses.mpd()</code> para ver todas as possibilidades de modelos nulos dispon√≠veis.</p>
<div class="sourceCode" id="cb526"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## NRI ou SES_MPD</span>
<span class="va">resultados_SES_MPD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/ses.mpd.html">ses.mpd</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">filogenia_aves</span><span class="op">)</span>,
                              null.model <span class="op">=</span> <span class="st">"taxa.labels"</span>, 
                              abundance.weighted <span class="op">=</span> <span class="cn">FALSE</span>,
                              runs <span class="op">=</span> <span class="fl">999</span><span class="op">)</span> 

<span class="co"># Mostra a riqueza de esp√©ices, MPD observado, m√©dia e desvio padr√£o dos </span>
<span class="co"># valores de MPD das aleatoriza√ß√µes, SES e o valor de p.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">resultados_SES_MPD</span><span class="op">)</span>
<span class="co">#&gt;       ntaxa  mpd.obs mpd.rand.mean mpd.rand.sd mpd.obs.rank  mpd.obs.z mpd.obs.p runs</span>
<span class="co">#&gt; Com_1    27 150.7914      153.9953    3.891718          215 -0.8232597     0.215  999</span>
<span class="co">#&gt; Com_2    26 157.3158      153.5833    4.367399          770  0.8546215     0.770  999</span>
<span class="co">#&gt; Com_3    25 146.1622      153.9931    4.476428           52 -1.7493791     0.052  999</span>
<span class="co">#&gt; Com_4    25 154.5005      153.5113    4.720348          551  0.2095591     0.551  999</span>
<span class="co">#&gt; Com_5    22 143.0727      153.7490    5.294432           24 -2.0165115     0.024  999</span>
<span class="co">#&gt; Com_6    18 141.1926      153.9709    6.951990           34 -1.8380846     0.034  999</span></code></pre></div>
<p>Somente as comunidades 5 e 6 apresentaram valores de p &lt; 0.05 indicando que os resultados observados de MPD s√£o menores que o esperado ao acaso (i.e., valores simulados). Neste caso, a composi√ß√£o de esp√©cies presentes nessas duas comunidades apresenta agrupamento filogen√©tico. Por outro lado, os valores de MPD observados para as outras comunidades s√£o similares aos valores obtidos para comunidades simuladas com a redistribui√ß√£o dos nomes das esp√©cies na filogenia.</p>
<p><strong>Nearest Taxon Index (NTI) ou Standardized Effect Size of MNTD</strong></p>
<p>Esta m√©trica calcula o tamanho do efeito padronizado para a m√©trica MNTD. Contudo, NTI √© calculado multiplicando os resultados do SES por -1. Valores positivos de NTI indicam agrupamento filogen√©tico e valores negativos de NTI indicam dispers√£o filogen√©tica <span class="citation">(<a href="refer%C3%AAncias.html#ref-webb2008" role="doc-biblioref">Webb, Ackerly, and Kembel 2008</a>)</span>.</p>
<div class="sourceCode" id="cb527"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## NTI ou SES_MNTD</span>
<span class="va">resultados_SES_MNTD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/ses.mntd.html">ses.mntd</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">filogenia_aves</span><span class="op">)</span>,
                                null.model <span class="op">=</span> <span class="st">"taxa.labels"</span>, 
                                abundance.weighted <span class="op">=</span> <span class="cn">FALSE</span>,
                                runs <span class="op">=</span> <span class="fl">999</span><span class="op">)</span> 

<span class="co"># Mostra a riqueza de esp√©ices,MNTD observado, m√©dia e desvio padr√£o dos </span>
<span class="co"># valores de MNTD das aleatoriza√ß√µes, SES e o valor de p.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">resultados_SES_MNTD</span><span class="op">)</span>
<span class="co">#&gt;       ntaxa mntd.obs mntd.rand.mean mntd.rand.sd mntd.obs.rank  mntd.obs.z mntd.obs.p runs</span>
<span class="co">#&gt; Com_1    27 63.89727       63.30504     6.864478           518  0.08627467      0.518  999</span>
<span class="co">#&gt; Com_2    26 66.15828       64.81499     7.217753           575  0.18610860      0.575  999</span>
<span class="co">#&gt; Com_3    25 72.96912       65.76333     7.754651           811  0.92922217      0.811  999</span>
<span class="co">#&gt; Com_4    25 67.67170       65.70886     7.752673           600  0.25318258      0.600  999</span>
<span class="co">#&gt; Com_5    22 64.93477       69.46545     9.133114           305 -0.49607138      0.305  999</span>
<span class="co">#&gt; Com_6    18 63.72337       76.12099    11.819687           162 -1.04889562      0.162  999</span></code></pre></div>
<p>Somente a comunidade 9 apresentou valor de p &lt; 0.05 indicando que o resultado observado de MNTD foi menor que o esperado ao acaso (i.e., valores simulados). Neste caso, a composi√ß√£o de esp√©cies presente nessa comunidade apresenta agrupamento filogen√©tico. Por outro lado, os valores de MNTD observados para as outras comunidades s√£o similares aos valores obtidos para comunidades simuladas com a redistribui√ß√£o dos nomes das esp√©cies na filogenia.</p>
<p><strong>Standardized Effect Size of PD</strong></p>
<p>Esta m√©trica calcula o tamanho do efeito padronizado para a m√©trica PD <span class="citation">(<a href="refer%C3%AAncias.html#ref-webb2008" role="doc-biblioref">Webb, Ackerly, and Kembel 2008</a>)</span>.</p>
<div class="sourceCode" id="cb528"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## SES_PD</span>
<span class="va">resultados_SES_PD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/ses.pd.html">ses.pd</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, <span class="va">filogenia_aves</span>,
                            null.model <span class="op">=</span> <span class="st">"independentswap"</span>, 
                            runs <span class="op">=</span> <span class="fl">999</span><span class="op">)</span> 

<span class="co"># Mostra a riqueza de esp√©ices,MNTD observado, m√©dia e desvio padr√£o dos </span>
<span class="co"># valores de PD das aleatoriza√ß√µes, SES e o valor de p.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">resultados_SES_PD</span><span class="op">)</span> 
<span class="co">#&gt;       ntaxa   pd.obs pd.rand.mean pd.rand.sd pd.obs.rank   pd.obs.z pd.obs.p runs</span>
<span class="co">#&gt; Com_1    27 1259.315     1272.480   66.74674         429 -0.1972372    0.429  999</span>
<span class="co">#&gt; Com_2    26 1293.152     1238.690   68.04238         799  0.8004172    0.799  999</span>
<span class="co">#&gt; Com_3    25 1222.310     1201.471   65.51971         624  0.3180526    0.624  999</span>
<span class="co">#&gt; Com_4    25 1254.541     1205.879   68.34858         750  0.7119674    0.750  999</span>
<span class="co">#&gt; Com_5    22 1021.967     1096.024   67.73466         129 -1.0933409    0.129  999</span>
<span class="co">#&gt; Com_6    18  856.781      950.239   64.54864          76 -1.4478696    0.076  999</span></code></pre></div>
<p>Nenhuma comunidade apresentou valor de p &lt; 0.05. Neste caso, os valores observados de PD s√£o similares aos valores obtidos para comunidades simuladas com a redistribui√ß√£o dos nomes das esp√©cies na filogenia.</p>
<p><strong>Standardized effect size do Phylosor</strong></p>
<p>N√£o h√° pacotes que calculam o SES para a m√©trica Phylosor. Assim, iremos usar a fun√ß√£o <code><a href="https://rdrr.io/pkg/picante/man/phylosor.rnd.html">phylosor.rnd()</a></code> para criar modelos nulos para o Physolor, e em seguida, iremos usar uma fun√ß√£o criada por Pedro Braga &amp; Katherine H√©bert (dispon√≠vel em <a href="https://pedrohbraga.github.io/CommunityPhylogenetics-Workshop/CommunityPhylogenetics-Workshop.html" class="uri">https://pedrohbraga.github.io/CommunityPhylogenetics-Workshop/CommunityPhylogenetics-Workshop.html</a>) para calcular os valores de SES e os valores de P.</p>
<div class="sourceCode" id="cb529"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Standardized effect size do Phylosor</span>
<span class="co"># Modelo nulo que rearranja o nome das esp√©cies na filogenia. </span>
<span class="va">modelos_nulo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/picante/man/phylosor.rnd.html">phylosor.rnd</a></span><span class="op">(</span><span class="va">composicao_especies_P</span>, <span class="va">filogenia_aves</span>, 
                             null.model <span class="op">=</span> <span class="st">"taxa.labels"</span>, runs <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>

<span class="co"># Fun√ß√£o para calcular o SES eo valor de P.</span>
<span class="va">ses.physo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">obs</span>, <span class="va">nulo_phylosor</span><span class="op">)</span><span class="op">{</span>
    <span class="va">nulo_phylosor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>
                                     <span class="op">(</span><span class="va">nulo_phylosor</span>, <span class="va">as.vector</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="va">physo.obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span>
    <span class="va">physo.mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">nulo_phylosor</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, 
                        FUN <span class="op">=</span> <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="va">physo.sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">nulo_phylosor</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, 
                      FUN <span class="op">=</span> <span class="va">sd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="va">physo.ses</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">physo.obs</span> <span class="op">-</span> <span class="va">physo.mean</span><span class="op">)</span><span class="op">/</span><span class="va">physo.sd</span>
    <span class="va">physo.obs.rank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html">rbind</a></span><span class="op">(</span><span class="va">physo.obs</span>, 
                                      <span class="va">nulo_phylosor</span><span class="op">)</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, 
                            FUN <span class="op">=</span> <span class="va">rank</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>
    <span class="va">physo.obs.rank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">physo.mean</span><span class="op">)</span>, <span class="cn">NA</span>, 
                             <span class="va">physo.obs.rank</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">physo.obs</span>, <span class="va">physo.mean</span>, <span class="va">physo.sd</span>, 
               <span class="va">physo.obs.rank</span>, <span class="va">physo.ses</span>, 
               physo.obs.p <span class="op">=</span> <span class="va">physo.obs.rank</span><span class="op">/</span>
                   <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">nulo_phylosor</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co">## Resultados</span>
<span class="va">resultados</span> <span class="op">&lt;-</span> <span class="fu">ses.physo</span> <span class="op">(</span><span class="va">resultados_Phylosor</span>, <span class="va">modelos_nulo</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">resultados</span><span class="op">)</span>
<span class="co">#&gt;   physo.obs physo.mean   physo.sd physo.obs.rank  physo.ses physo.obs.p</span>
<span class="co">#&gt; 1 0.7856828  0.7915561 0.04011508              6 -0.1464099         0.6</span>
<span class="co">#&gt; 2 0.8052839  0.8813422 0.03356047              1 -2.2663056         0.1</span>
<span class="co">#&gt; 3 0.7831520  0.8174306 0.04545519              2 -0.7541175         0.2</span>
<span class="co">#&gt; 4 0.8586780  0.8687616 0.03659588              5 -0.2755416         0.5</span>
<span class="co">#&gt; 5 0.6717414  0.7460991 0.02806215              1 -2.6497526         0.1</span>
<span class="co">#&gt; 6 0.7414284  0.6904007 0.04842748              9  1.0536941         0.9</span></code></pre></div>
<p>Nenhum valor de similaridade entre pares comunidade apresentou valor de p &lt; 0.05. Neste caso, os valores de Phylosor observados s√£o similares aos valores obtidos para as comunidades simuladas com a redistribui√ß√£o dos nomes das esp√©cies na filogenia.</p>
</div>
<div id="para-se-aprofundar-9" class="section level2" number="13.6">
<h2>
<span class="header-section-number">13.6</span> Para se aprofundar<a class="anchor" aria-label="anchor" href="#para-se-aprofundar-9"><i class="fas fa-link"></i></a>
</h2>
<div id="livros-8" class="section level3" number="13.6.1">
<h3>
<span class="header-section-number">13.6.1</span> Livros<a class="anchor" aria-label="anchor" href="#livros-8"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Recomendamos aos interessados(as) os livros: i) Swenson <span class="citation">(<a href="refer%C3%AAncias.html#ref-swenson2014" role="doc-biblioref">2014</a>)</span> <em>Functional and Phylogenetic Ecology in R</em>; ii) Paradis <span class="citation">(<a href="refer%C3%AAncias.html#ref-paradis2012" role="doc-biblioref">2012</a>)</span> <em>Analysis of Phylogenetics and Evolution in R</em>; iii) Cadotte &amp; Davies <span class="citation">(<a href="refer%C3%AAncias.html#ref-cadotte2016" role="doc-biblioref">2016</a>)</span> <em>Phylogenies in Ecology</em>, iv) Gotelli &amp; Graves <span class="citation">(<a href="refer%C3%AAncias.html#ref-gotelli1996" role="doc-biblioref">1996</a>)</span> <em>Null Models in Ecology</em>; e v) Magurran &amp; McGill <span class="citation">(<a href="refer%C3%AAncias.html#ref-magurran_biological_2011" role="doc-biblioref">2011</a>)</span> <em>Biological Diversity Frontiers in Measurement and Assessment</em>.</li>
</ul>
</div>
<div id="links-8" class="section level3" number="13.6.2">
<h3>
<span class="header-section-number">13.6.2</span> Links<a class="anchor" aria-label="anchor" href="#links-8"><i class="fas fa-link"></i></a>
</h3>
<p>O blog <a href="http://blog.phytools.org/">Ferramentas filogen√©ticas para biologia comparada</a> do pesquisador Liam Revell √© uma ferramenta excelente para obter informa√ß√µes e aplica√ß√µes das an√°lises filogen√©ticas diretamente no R.</p>
</div>
</div>
<div id="exerc√≠cios-9" class="section level2" number="13.7">
<h2>
<span class="header-section-number">13.7</span> Exerc√≠cios<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcios-9"><i class="fas fa-link"></i></a>
</h2>
<p><strong>13.1</strong>
Carregue os dados - <code>anuros_composicao</code> (i.e., 211 esp√©cies de anuros coletados em 44 localidades na Mata Atl√¢ntica), <code>anuros_ambientais</code> (i.e., vari√°veis clim√°ticas, topogr√°ficas e coordenadas geogr√°ficas) e <code>filogenia_anuros</code> (filogenia das 211 esp√©cies) - que est√£o no pacote <code>ecodados</code>. Use a fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/varpart.html">varpart()</a></code> do pacote <code>vegan</code> para testar a import√¢ncia relativa dos efeitos da precipita√ß√£o anual, range altitudinal e temperatura anual na distribui√ß√£o espacial da diversidade filogen√©tica (PD) e Endemismo filogen√©tico (PE). Calcule o SES para verificar se os resultados da diversidade filogen√©tica (PD) diferem do esperado ao acaso devido ao n√∫mero de esp√©cies em cada comunidade. Qual a sua interpreta√ß√£o sobre os resultados?</p>
<p><strong>13.2</strong>
Carregue os dados - <code>anuros_composicao</code> (i.e., 211 esp√©cies de anuros coletados em 44 localidades na Mata Atl√¢ntica), <code>anuros_ambientais</code> (i.e., vari√°veis clim√°ticas, topogr√°ficas e coordenadas geogr√°ficas) e <code>filogenia_anuros</code> (filogenia das 211 esp√©cies) - que est√£o no pacote ecodados. Use a fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/varpart.html">varpart()</a></code> do pacote <code>vegan</code> para testar a import√¢ncia relativa dos efeitos da precipita√ß√£o anual, range altitudinal e temperatura anual na distribui√ß√£o espacial do NRI e NTI. Qual a sua interpreta√ß√£o sobre os resultados?</p>
<p><strong>13.3</strong>
Carregue os dados - <code>anuros_composicao</code> (i.e., 211 esp√©cies de anuros coletados em 44 localidades na Mata Atl√¢ntica), <code>anuros_ambientais</code> (i.e., vari√°veis clim√°ticas, topogr√°ficas e coordenadas geogr√°ficas) e <code>filogenia_anuros</code> (filogenia das 211 esp√©cies) - que est√£o no pacote ecodados. Use a fun√ß√£o <code><a href="https://rdrr.io/pkg/vegan/man/varpart.html">varpart()</a></code> do pacote <code>vegan</code> para testar a import√¢ncia relativa dos efeitos da precipita√ß√£o anual, range altitudinal e dist√¢ncia geogr√°fica na distribui√ß√£o espacial dos diferentes componentes da diversidade beta filogen√©tica (Phylosor). Qual a sua interpreta√ß√£o sobre os resultados?</p>
<p><a href="https://exercicios-livro-aer.netlify.app/cap.-13---diversidade-filogen%C3%A9tica.html">Solu√ß√µes dos exerc√≠cios</a>.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="cap12.html"><span class="header-section-number">12</span> Diversidade Taxon√¥mica</a></div>
<div class="next"><a href="cap14.html"><span class="header-section-number">14</span> Diversidade Funcional</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Nesta p√°gina"><h2><b>Nesta p√°gina</b></h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cap13"><span class="header-section-number">13</span> Diversidade Filogen√©tica</a></li>
<li><a class="nav-link" href="#pr%C3%A9-requisitos-do-cap%C3%ADtulo-9">Pr√©-requisitos do cap√≠tulo</a></li>
<li><a class="nav-link" href="#aspectos-te%C3%B3ricos-4"><span class="header-section-number">13.1</span> Aspectos te√≥ricos</a></li>
<li><a class="nav-link" href="#manipula%C3%A7%C3%A3o-de-filogenias"><span class="header-section-number">13.2</span> Manipula√ß√£o de filogenias</a></li>
<li>
<a class="nav-link" href="#m%C3%A9tricas-de-diversidade-alfa-filogen%C3%A9tica"><span class="header-section-number">13.3</span> M√©tricas de diversidade alfa filogen√©tica</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#riqueza-da-diversidade-alfa-filogen%C3%A9tica"><span class="header-section-number">13.3.1</span> Riqueza da diversidade alfa filogen√©tica</a></li>
<li><a class="nav-link" href="#diverg%C3%AAncia-da-diversidade-alfa-filogen%C3%A9tica"><span class="header-section-number">13.3.2</span> Diverg√™ncia da diversidade alfa filogen√©tica</a></li>
<li><a class="nav-link" href="#regularidade-da-diversidade-alfa-filogen%C3%A9tica"><span class="header-section-number">13.3.3</span> Regularidade da diversidade alfa filogen√©tica</a></li>
<li><a class="nav-link" href="#correla%C3%A7%C3%A3o-entre-as-m%C3%A9tricas-de-diversidade-alfa-filogen%C3%A9tica"><span class="header-section-number">13.3.4</span> Correla√ß√£o entre as m√©tricas de diversidade alfa filogen√©tica</a></li>
<li><a class="nav-link" href="#associa%C3%A7%C3%A3o-entre-a-diversidade-alfa-filogen%C3%A9tica-e-o-ambiente"><span class="header-section-number">13.3.5</span> Associa√ß√£o entre a diversidade alfa filogen√©tica e o ambiente</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#m%C3%A9tricas-de-diversidade-beta-filogen%C3%A9tica"><span class="header-section-number">13.4</span> M√©tricas de diversidade beta filogen√©tica</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#diverg%C3%AAncia-da-diversidade-beta-filogen%C3%A9tica"><span class="header-section-number">13.4.1</span> Diverg√™ncia da diversidade beta filogen√©tica</a></li>
<li><a class="nav-link" href="#correla%C3%A7%C3%A3o-entre-as-m%C3%A9tricas-de-diversidade-beta-filogen%C3%A9tica"><span class="header-section-number">13.4.2</span> Correla√ß√£o entre as m√©tricas de diversidade beta filogen√©tica</a></li>
<li><a class="nav-link" href="#associa%C3%A7%C3%A3o-entre-a-diverg%C3%AAncia-da-diversidade-beta-filogen%C3%A9tica-e-o-ambiente"><span class="header-section-number">13.4.3</span> Associa√ß√£o entre a diverg√™ncia da diversidade beta filogen√©tica e o ambiente</a></li>
<li><a class="nav-link" href="#riqueza-da-diversidade-beta-filogen%C3%A9tica"><span class="header-section-number">13.4.4</span> Riqueza da diversidade beta filogen√©tica</a></li>
<li><a class="nav-link" href="#correla%C3%A7%C3%A3o-entre-phylosor-e-unifrac"><span class="header-section-number">13.4.5</span> Correla√ß√£o entre Phylosor e Unifrac</a></li>
<li><a class="nav-link" href="#associa%C3%A7%C3%A3o-entre-a-riqueza-da-diversidade-beta-filogen%C3%A9tica-e-o-ambiente"><span class="header-section-number">13.4.6</span> Associa√ß√£o entre a riqueza da diversidade beta filogen√©tica e o ambiente</a></li>
<li><a class="nav-link" href="#parti%C3%A7%C3%A3o-da-diversidade-beta-filogen%C3%A9tica"><span class="header-section-number">13.4.7</span> Parti√ß√£o da diversidade beta filogen√©tica</a></li>
</ul>
</li>
<li><a class="nav-link" href="#modelos-nulos"><span class="header-section-number">13.5</span> Modelos Nulos</a></li>
<li>
<a class="nav-link" href="#para-se-aprofundar-9"><span class="header-section-number">13.6</span> Para se aprofundar</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#livros-8"><span class="header-section-number">13.6.1</span> Livros</a></li>
<li><a class="nav-link" href="#links-8"><span class="header-section-number">13.6.2</span> Links</a></li>
</ul>
</li>
<li><a class="nav-link" href="#exerc%C3%ADcios-9"><span class="header-section-number">13.7</span> Exerc√≠cios</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/paternogbc/livro_aer/blob/master/13_diversidade_filogenetica.Rmd">Ver fonte <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/paternogbc/livro_aer/edit/master/13_diversidade_filogenetica.Rmd">Editar esta p√°gina <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>An√°lises Ecol√≥gicas no R</strong>" foi escrito por Fernando Rodrigues da Silva, Thiago Gon√ßalves-Souza, Gustavo Brant Paterno, <br> Diogo Borges Provete, Maur√≠cio Humberto Vancine. √öltima atualiza√ß√£o 2022-05-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este livro foi compilado com o pacote R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
